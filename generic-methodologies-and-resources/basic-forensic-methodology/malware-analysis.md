# Malware Analysis

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Forensics CheatSheets

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/)

## Online Services

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)
* [Any.Run](https://any.run/)

## Offline Antivirus and Detection Tools

### Yara

#### Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
```bash
sudo apt-get install -y yara
```
#### Î•Ï„Î¿Î¹Î¼Î¬ÏƒÏ„Îµ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚

Use this script to download and merge all the yara malware rules from github: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
Create the _**ÎºÎ±Î½ÏŒÎ½ÎµÏ‚**_ directory and execute it. This will create a file called _**malware\_rules.yar**_ which contains all the yara rules for malware.
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
#### Î£Î¬ÏÏ‰ÏƒÎ·
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
#### YaraGen: ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î³Î¹Î± ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ ÎºÎ±Î¹ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎºÎ±Î½ÏŒÎ½Ï‰Î½

ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿ ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ [**YaraGen**](https://github.com/Neo23x0/yarGen) Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÏ„Îµ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ yara Î±Ï€ÏŒ Î­Î½Î± Î´Ï…Î±Î´Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿. Î”ÎµÎ¯Ï„Îµ Î±Ï…Ï„Î¬ Ï„Î± ÏƒÎµÎ¼Î¹Î½Î¬ÏÎ¹Î±: [**ÎœÎ­ÏÎ¿Ï‚ 1**](https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/), [**ÎœÎ­ÏÎ¿Ï‚ 2**](https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/), [**ÎœÎ­ÏÎ¿Ï‚ 3**](https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
python3 yarGen.py --update
python3.exe yarGen.py --excludegood -m  ../../mals/
```
### ClamAV

#### Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
```
sudo apt-get install -y clamav
```
#### Î£Î¬ÏÏ‰ÏƒÎ·
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
### [Capa](https://github.com/mandiant/capa)

**Capa** Î±Î½Î¹Ï‡Î½ÎµÏÎµÎ¹ Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»ÎµÏ‚ **Î¹ÎºÎ±Î½ÏŒÏ„Î·Ï„ÎµÏ‚** ÏƒÎµ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î±: PE, ELF, .NET. ÎˆÏ„ÏƒÎ¹ Î¸Î± Î²ÏÎµÎ¹ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± ÏŒÏ€Ï‰Ï‚ Ï„Î±ÎºÏ„Î¹ÎºÎ­Ï‚ Att\&ck Î® ÏÏ€Î¿Ï€Ï„ÎµÏ‚ Î¹ÎºÎ±Î½ÏŒÏ„Î·Ï„ÎµÏ‚ ÏŒÏ€Ï‰Ï‚:

* Î­Î»ÎµÎ³Ï‡Î¿Ï‚ Î³Î¹Î± ÏƒÏ†Î¬Î»Î¼Î± OutputDebugString
* ÎµÎºÏ„Î­Î»ÎµÏƒÎ· Ï‰Ï‚ Ï…Ï€Î·ÏÎµÏƒÎ¯Î±
* Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î±Ï‚

Î‘Ï€Î¿ÎºÏ„Î®ÏƒÏ„Îµ Ï„Î¿ ÏƒÏ„Î¿ [**Github repo**](https://github.com/mandiant/capa).

### IOCs

IOC ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Î£Ï…Î¼Î²Î¹Î²Î±ÏƒÎ¼Î¿Ï. ÎˆÎ½Î± IOC ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ **ÏƒÏ…Î½Î¸Î·ÎºÏÎ½ Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯Î¶Î¿Ï…Î½** ÎºÎ¬Ï€Î¿Î¹Î¿ Î´Ï…Î½Î·Ï„Î¹ÎºÎ¬ Î±Î½ÎµÏ€Î¹Î¸ÏÎ¼Î·Ï„Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Î® ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹Ï‰Î¼Î­Î½Î¿ **ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ**. ÎŸÎ¹ Î¿Î¼Î¬Î´ÎµÏ‚ Blue Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Î¿ÏÎ¹ÏƒÎ¼Î¿Ï Î³Î¹Î± Î½Î± **Î±Î½Î±Î¶Î·Ï„Î¿ÏÎ½ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ Ï„ÏÏ€Î¿ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½** ÏƒÏ„Î± **ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î±** ÎºÎ±Î¹ **Î´Î¯ÎºÏ„Ï…Î¬** Ï„Î¿Ï…Ï‚.\
Î— ÎºÎ¿Î¹Î½Î® Ï‡ÏÎ®ÏƒÎ· Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ Î¿ÏÎ¹ÏƒÎ¼ÏÎ½ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï‡ÏÎ®ÏƒÎ¹Î¼Î· ÎºÎ±Î¸ÏÏ‚ ÏŒÏ„Î±Î½ ÎµÎ½Ï„Î¿Ï€Î¯Î¶ÎµÏ„Î±Î¹ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ ÏƒÎµ Î­Î½Î±Î½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÏ„Î® ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î­Î½Î± IOC Î³Î¹Î± Î±Ï…Ï„ÏŒ Ï„Î¿ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ, Î¬Î»Î»ÎµÏ‚ Î¿Î¼Î¬Î´ÎµÏ‚ Blue Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï„Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î½ Î³Î¹Î± Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎ¿Ï…Î½ Ï„Î¿ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ±.

ÎˆÎ½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î® Ï„Î·Î½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· IOCs ÎµÎ¯Î½Î±Î¹ Ï„Î¿ [**IOC Editor**](https://www.fireeye.com/services/freeware/ioc-editor.html)**.**\
ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [**Redline**](https://www.fireeye.com/services/freeware/redline.html) Î³Î¹Î± Î½Î± **Î±Î½Î±Î¶Î·Ï„Î®ÏƒÎµÏ„Îµ ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÎ¼Î­Î½Î± IOCs ÏƒÎµ Î¼Î¹Î± ÏƒÏ…ÏƒÎºÎµÏ…Î®**.

### Loki

[**Loki**](https://github.com/Neo23x0/Loki) ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ Î³Î¹Î± Î‘Ï€Î»Î¿ÏÏ‚ Î”ÎµÎ¯ÎºÏ„ÎµÏ‚ Î£Ï…Î¼Î²Î¹Î²Î±ÏƒÎ¼Î¿Ï.\
Î— Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Î²Î±ÏƒÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÎµ Ï„Î­ÏƒÏƒÎµÏÎ¹Ï‚ Î¼ÎµÎ¸ÏŒÎ´Î¿Ï…Ï‚ Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚:
```
1. File Name IOC
Regex match on full file path/name

2. Yara Rule Check
Yara signature matches on file data and process memory

3. Hash Check
Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files

4. C2 Back Connect Check
Compares process connection endpoints with C2 IOCs (new since version v.10)
```
### Linux Malware Detect

[**Linux Malware Detect (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/) ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ ÏƒÎ±ÏÏ‰Ï„Î®Ï‚ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿Ï… Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï Î³Î¹Î± Linux Ï€Î¿Ï… ÎºÏ…ÎºÎ»Î¿Ï†Î¿ÏÎµÎ¯ Ï…Ï€ÏŒ Ï„Î·Î½ Î¬Î´ÎµÎ¹Î± GNU GPLv2, ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î­Î½Î¿Ï‚ Î³ÏÏÏ‰ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î±Ï€ÎµÎ¹Î»Î­Ï‚ Ï€Î¿Ï… Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎµ ÎºÎ¿Î¹Î½Î­Ï‚ Ï†Î¹Î»Î¿Î¾ÎµÎ½Î¿ÏÎ¼ÎµÎ½ÎµÏ‚ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î±. Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÎµÎ¹Î»ÏÎ½ Î±Ï€ÏŒ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚ ÎµÎ¹ÏƒÎ²Î¿Î»ÏÎ½ ÏƒÏ„Î¿ Î´Î¯ÎºÏ„Ï…Î¿ Î³Î¹Î± Î½Î± ÎµÎ¾Î¬Î³ÎµÎ¹ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÎ½ÎµÏÎ³Î¬ ÏƒÎµ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Ï…Ï€Î¿Î³ÏÎ±Ï†Î­Ï‚ Î³Î¹Î± Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·. Î•Ï€Î¹Ï€Î»Î­Î¿Î½, Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÎµÎ¹Î»ÏÎ½ Ï€ÏÎ¿Î­ÏÏ‡Î¿Î½Ï„Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î±Ï€ÏŒ Ï…Ï€Î¿Î²Î¿Î»Î­Ï‚ Ï‡ÏÎ·ÏƒÏ„ÏÎ½ Î¼Îµ Ï„Î· Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± checkout Ï„Î¿Ï… LMD ÎºÎ±Î¹ Ï€ÏŒÏÎ¿Ï…Ï‚ Ï„Î·Ï‚ ÎºÎ¿Î¹Î½ÏŒÏ„Î·Ï„Î±Ï‚ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿Ï… Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï.

### rkhunter

Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ [**rkhunter**](http://rkhunter.sourceforge.net) Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Î½Î± ÎµÎ»Î­Î³Î¾Î¿Ï…Î½ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î³Î¹Î± Ï€Î¹Î¸Î±Î½Î¬ **rootkits** ÎºÎ±Î¹ ÎºÎ±ÎºÏŒÎ²Î¿Ï…Î»Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ.
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
### FLOSS

[**FLOSS**](https://github.com/mandiant/flare-floss) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Ï€Î¿Ï… Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± Î²ÏÎµÎ¹ ÎºÏÏ…Î¼Î¼Î­Î½ÎµÏ‚ ÏƒÏ…Î¼Î²Î¿Î»Î¿ÏƒÎµÎ¹ÏÎ­Ï‚ Î¼Î­ÏƒÎ± ÏƒÎµ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î± Î±ÏÏ‡ÎµÎ¯Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Î´Î¹Î¬Ï†Î¿ÏÎµÏ‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚.

### PEpper

[PEpper ](https://github.com/Th3Hurrican3/PEpper) ÎµÎ»Î­Î³Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î¿ (Î´Ï…Î±Î´Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, ÎµÎ½Ï„ÏÎ¿Ï€Î¯Î±, URLs ÎºÎ±Î¹ IPs, ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ ÎºÎ±Î½ÏŒÎ½ÎµÏ‚ yara).

### PEstudio

[PEstudio](https://www.winitor.com/download) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Ï€ÏŒÎºÏ„Î·ÏƒÎ· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ Î³Î¹Î± ÎµÎºÏ„ÎµÎ»Î­ÏƒÎ¹Î¼Î± Windows ÏŒÏ€Ï‰Ï‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î­Ï‚, ÎµÎ¾Î±Î³Ï‰Î³Î­Ï‚, ÎºÎµÏ†Î±Î»Î¯Î´ÎµÏ‚, Î±Î»Î»Î¬ Î¸Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Ï„Î¿ virus total ÎºÎ±Î¹ Î¸Î± Î²ÏÎµÎ¹ Ï€Î¹Î¸Î±Î½Î­Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Att\&ck.

### Detect It Easy(DiE)

[**DiE**](https://github.com/horsicq/Detect-It-Easy/) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î¿ Î³Î¹Î± Î½Î± Î±Î½Î¹Ï‡Î½ÎµÏÎµÎ¹ Î±Î½ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ ÎµÎ¯Î½Î±Î¹ **ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î¿** ÎºÎ±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Î²ÏÎ¯ÏƒÎºÎµÎ¹ **Ï€Î±ÎºÎµÏ„Î¬ÏÎ¹ÏƒÎ¼Î±**.

### NeoPI

[**NeoPI** ](https://github.com/CiscoCXSecurity/NeoPI) ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÏƒÎµÎ½Î¬ÏÎ¹Î¿ Python Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î¼Î¹Î± Ï€Î¿Î¹ÎºÎ¹Î»Î¯Î± **ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÏÎ½ Î¼ÎµÎ¸ÏŒÎ´Ï‰Î½** Î³Î¹Î± Î½Î± Î±Î½Î¹Ï‡Î½ÎµÏÎµÎ¹ **ÎºÏÏ…Î¼Î¼Î­Î½Î¿** ÎºÎ±Î¹ **ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ±Ï†Î·Î¼Î­Î½Î¿** Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Î¼Î­ÏƒÎ± ÏƒÎµ Î±ÏÏ‡ÎµÎ¯Î± ÎºÎµÎ¹Î¼Î­Î½Î¿Ï…/ÏƒÎµÎ½Î±ÏÎ¯Ï‰Î½. ÎŸ Ï€ÏÎ¿Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„Î¿Ï… NeoPI ÎµÎ¯Î½Î±Î¹ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÏƒÏ„Î·Î½ **Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· ÎºÏÎ´Î¹ÎºÎ± ÎºÏÏ…Î¼Î¼Î­Î½Î¿Ï… web shell**.

### **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder) ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î´Ï…Î½Î±Ï„ÏŒ Î³Î¹Î± Î½Î± Î±Î½Î¹Ï‡Î½ÎµÏÏƒÎµÎ¹ **ÎºÏÏ…Î¼Î¼Î­Î½Î¿**/**ÏÏ€Î¿Ï€Ï„Î¿ ÎºÏÎ´Î¹ÎºÎ±** ÎºÎ±Î¸ÏÏ‚ ÎºÎ±Î¹ Î±ÏÏ‡ÎµÎ¯Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ ÏƒÏ…Î½Î±ÏÏ„Î®ÏƒÎµÎ¹Ï‚ **PHP** Ï€Î¿Ï… ÏƒÏ…Ï‡Î½Î¬ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ **malwares**/webshells.

### Apple Binary Signatures

ÎŒÏ„Î±Î½ ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ **Î´ÎµÎ¯Î³Î¼Î± malware** Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Ï€Î¬Î½Ï„Î± Î½Î± **ÎµÎ»Î­Î³Ï‡ÎµÏ„Îµ Ï„Î·Î½ Ï…Ï€Î¿Î³ÏÎ±Ï†Î®** Ï„Î¿Ï… Î´Ï…Î±Î´Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÎºÎ±Î¸ÏÏ‚ Î¿ **Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÏ„Î®Ï‚** Ï€Î¿Ï… Ï„Î¿ Ï…Ï€Î­Î³ÏÎ±ÏˆÎµ Î¼Ï€Î¿ÏÎµÎ¯ Î®Î´Î· Î½Î± ÎµÎ¯Î½Î±Î¹ **ÏƒÏ‡ÎµÏ„Î¹ÎºÏŒÏ‚** Î¼Îµ **malware.**
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
## Î¤ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚

### Î£Ï…ÏƒÏƒÏÏÎµÏ…ÏƒÎ· Î‘ÏÏ‡ÎµÎ¯Ï‰Î½

Î‘Î½ Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ ÏŒÏ„Î¹ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï†Î¬ÎºÎµÎ»Î¿ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î± **Î±ÏÏ‡ÎµÎ¯Î±** ÎµÎ½ÏŒÏ‚ web server **ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î± Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±**. **Î•Î»Î­Î³Î¾Ï„Îµ** Ï„Î·Î½ **Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±** Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎ±Î½ ÎºÎ±Î¹ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎ±Î½ ÏŒÎ»Î± Ï„Î± **Î±ÏÏ‡ÎµÎ¯Î±** ÏƒÏ„Î¿Î½ **web server** ÎºÎ±Î¹ Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î± Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎµÎ¯Î½Î±Î¹ **ÏÏ€Î¿Ï€Ï„Î·**, ÎµÎ»Î­Î³Î¾Ï„Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿.

### Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î“ÏÎ±Î¼Î¼Î­Ï‚

Î‘Î½ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎµÎ½ÏŒÏ‚ Ï†Î±ÎºÎ­Î»Î¿Ï… **Î´ÎµÎ½ Î­Ï€ÏÎµÏ€Îµ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯**, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï…Ï€Î¿Î»Î¿Î³Î¯ÏƒÎµÏ„Îµ Ï„Î¿ **hash** Ï„Ï‰Î½ **Î±ÏÏ‡Î¹ÎºÏÎ½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½** Ï„Î¿Ï… Ï†Î±ÎºÎ­Î»Î¿Ï… ÎºÎ±Î¹ Î½Î± Ï„Î± **ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÏ„Îµ** Î¼Îµ Ï„Î± **Ï„ÏÎ­Ï‡Î¿Î½Ï„Î±**. ÎŸÏ„Î¹Î´Î®Ï€Î¿Ï„Îµ Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î¸Î± ÎµÎ¯Î½Î±Î¹ **ÏÏ€Î¿Ï€Ï„Î¿**.

### Î£Ï„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ® Î‘Î½Î¬Î»Ï…ÏƒÎ·

ÎŒÏ„Î±Î½ Î¿Î¹ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ ÏƒÎµ logs Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± **ÎµÎ»Î­Î³Î¾ÎµÏ„Îµ ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ ÏŒÏ€Ï‰Ï‚ Ï€ÏŒÏƒÎµÏ‚ Ï†Î¿ÏÎ­Ï‚ ÎºÎ¬Î¸Îµ Î±ÏÏ‡ÎµÎ¯Î¿ ÎµÎ½ÏŒÏ‚ web server Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÏ„Î·ÎºÎµ ÎºÎ±Î¸ÏÏ‚ Î­Î½Î± web shell Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï€Î¹Î¿**.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
