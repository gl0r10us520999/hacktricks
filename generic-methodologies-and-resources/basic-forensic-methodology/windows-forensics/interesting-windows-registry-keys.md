# –¶—ñ–∫–∞–≤—ñ –∫–ª—é—á—ñ —Ä–µ—î—Å—Ç—Ä—É Windows

### –¶—ñ–∫–∞–≤—ñ –∫–ª—é—á—ñ —Ä–µ—î—Å—Ç—Ä—É Windows

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}


### **–í–µ—Ä—Å—ñ—è Windows —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤–ª–∞—Å–Ω–∏–∫–∞**
- –†–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é **`Software\Microsoft\Windows NT\CurrentVersion`**, –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –≤–µ—Ä—Å—ñ—é Windows, Service Pack, —á–∞—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞ —ñ–º'—è –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–≥–æ –≤–ª–∞—Å–Ω–∏–∫–∞ —É –∑—Ä–æ–∑—É–º—ñ–ª—ñ–π —Ñ–æ—Ä–º—ñ.

### **–Ü–º'—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞**
- –Ü–º'—è —Ö–æ—Å—Ç–∞ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø—ñ–¥ **`System\ControlSet001\Control\ComputerName\ComputerName`**.

### **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å—É**
- –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å —Å–∏—Å—Ç–µ–º–∏ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ **`System\ControlSet001\Control\TimeZoneInformation`**.

### **–í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —á–∞—Å—É –¥–æ—Å—Ç—É–ø—É**
- –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —á–∞—Å—É –¥–æ—Å—Ç—É–ø—É –≤–∏–º–∫–Ω–µ–Ω–æ (**`NtfsDisableLastAccessUpdate=1`**). –©–æ–± —É–≤—ñ–º–∫–Ω—É—Ç–∏ –π–æ–≥–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
`fsutil behavior set disablelastaccess 0`

### –í–µ—Ä—Å—ñ—ó Windows —Ç–∞ Service Packs
- **–í–µ—Ä—Å—ñ—è Windows** –≤–∫–∞–∑—É—î –Ω–∞ –≤–∏–¥ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Home, Pro) —Ç–∞ –π–æ–≥–æ –≤–∏–ø—É—Å–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Windows 10, Windows 11), —Ç–æ–¥—ñ —è–∫ **Service Packs** —î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç–∞, —ñ–Ω–æ–¥—ñ, –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó.

### –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —á–∞—Å—É –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø—É
- –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —á–∞—Å—É –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ–∑–≤–æ–ª—è—î –±–∞—á–∏—Ç–∏, –∫–æ–ª–∏ —Ñ–∞–π–ª–∏ –±—É–ª–∏ –≤–æ—Å—Ç–∞–Ω–Ω—î –≤—ñ–¥–∫—Ä–∏—Ç—ñ, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è —Å—É–¥–æ–≤–æ—ó –µ–∫—Å–ø–µ—Ä—Ç–∏–∑–∏ –∞–±–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —Å–∏—Å—Ç–µ–º–∏.

### –î–µ—Ç–∞–ª—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –º–µ—Ä–µ–∂—É
- –†–µ—î—Å—Ç—Ä –º—ñ—Å—Ç–∏—Ç—å –æ–±—à–∏—Ä–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –≤–∫–ª—é—á–∞—é—á–∏ **—Ç–∏–ø–∏ –º–µ—Ä–µ–∂ (–±–µ–∑–¥—Ä–æ—Ç–æ–≤—ñ, –∫–∞–±–µ–ª—å–Ω—ñ, 3G)** —Ç–∞ **–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –º–µ—Ä–µ–∂ (–ü—É–±–ª—ñ—á–Ω–∞, –ü—Ä–∏–≤–∞—Ç–Ω–∞/–î–æ–º–∞—à–Ω—è, –î–æ–º–µ–Ω–Ω–∞/–†–æ–±–æ—á–∞)**, —è–∫—ñ —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –±–µ–∑–ø–µ–∫–∏ –º–µ—Ä–µ–∂—ñ —Ç–∞ –¥–æ–∑–≤–æ–ª—ñ–≤.

### –ö–µ—à—É–≤–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞ (CSC)
- **CSC** –ø–æ–∫—Ä–∞—â—É—î –¥–æ—Å—Ç—É–ø –¥–æ –æ—Ñ–ª–∞–π–Ω-—Ñ–∞–π–ª—ñ–≤, –∫–µ—à—É—é—á–∏ –∫–æ–ø—ñ—ó —Å–ø—ñ–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤. –†—ñ–∑–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è **CSCFlags** –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å, —è–∫ —ñ —è–∫—ñ —Ñ–∞–π–ª–∏ –∫–µ—à—É—é—Ç—å—Å—è, –≤–ø–ª–∏–≤–∞—é—á–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞ –¥–æ—Å–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –æ—Å–æ–±–ª–∏–≤–æ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö –∑ –ø–µ—Ä–µ—Ä–∏–≤—á–∞—Å—Ç–∏–º –∑'—î–¥–Ω–∞–Ω–Ω—è–º.

### –ü—Ä–æ–≥—Ä–∞–º–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫—É
- –ü—Ä–æ–≥—Ä–∞–º–∏, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤–∞–Ω—ñ –≤ —Ä—ñ–∑–Ω–∏—Ö –∫–ª—é—á–∞—Ö —Ä–µ—î—Å—Ç—Ä—É `Run` —Ç–∞ `RunOnce`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –≤–ø–ª–∏–≤–∞—é—á–∏ –Ω–∞ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –±—É–¥—É—á–∏ —Ç–æ—á–∫–∞–º–∏ —ñ–Ω—Ç–µ—Ä–µ—Å—É –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∞–±–æ –Ω–µ–±–∞–∂–∞–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è.

### Shellbags
- **Shellbags** –Ω–µ –ª–∏—à–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–∞–ø–æ–∫, –∞–ª–µ –π –Ω–∞–¥–∞—é—Ç—å —Å—É–¥–æ–≤—É –µ–∫—Å–ø–µ—Ä—Ç–∏–∑—É –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–∞–ø–æ–∫, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –ø–∞–ø–∫–∞ –±—ñ–ª—å—à–µ –Ω–µ —ñ—Å–Ω—É—î. –í–æ–Ω–∏ —î –±–µ–∑—Ü—ñ–Ω–Ω–∏–º–∏ –¥–ª—è —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω—å, –≤–∏—è–≤–ª—è—é—á–∏ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∞ –Ω–µ —î –æ—á–µ–≤–∏–¥–Ω–æ—é —á–µ—Ä–µ–∑ —ñ–Ω—à—ñ –∑–∞—Å–æ–±–∏.

### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ USB —Ç–∞ —Å—É–¥–æ–≤–∞ –µ–∫—Å–ø–µ—Ä—Ç–∏–∑–∞
- –î–µ—Ç–∞–ª—ñ, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ —Ä–µ—î—Å—Ç—Ä—ñ –ø—Ä–æ USB-–ø—Ä–∏—Å—Ç—Ä–æ—ó, –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏, —è–∫—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó –±—É–ª–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø–æ–≤'—è–∑—É—é—á–∏ –ø—Ä–∏—Å—Ç—Ä—ñ–π –∑ —á—É—Ç–ª–∏–≤–∏–º–∏ –ø–µ—Ä–µ–¥–∞—á–∞–º–∏ —Ñ–∞–π–ª—ñ–≤ –∞–±–æ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.

### –°–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–æ–º—É
- **–°–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–æ–º—É** –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏, –∫–æ—Ä–∏—Å–Ω–∏–º —É —Å—É–¥–æ–≤–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –¥–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö.

### **–î–µ—Ç–∞–ª—ñ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏**
- –ß–∞—Å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å (–æ—Å—Ç–∞–Ω–Ω—è –ª–∏—à–µ –¥–ª—è XP) –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ **`System\ControlSet001\Control\Windows`** —Ç–∞ **`System\ControlSet001\Control\Watchdog\Display`**.

### **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –º–µ—Ä–µ–∂—ñ**
- –î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ **`System\ControlSet001\Services\Tcpip\Parameters\Interfaces{GUID_INTERFACE}`**.
- –ü–µ—Ä—à—ñ —Ç–∞ –æ—Å—Ç–∞–Ω–Ω—ñ —á–∞—Å–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –º–µ—Ä–µ–∂—ñ, –≤–∫–ª—é—á–∞—é—á–∏ VPN-–∑'—î–¥–Ω–∞–Ω–Ω—è, —Ä–µ—î—Å—Ç—Ä—É—é—Ç—å—Å—è –ø—ñ–¥ —Ä—ñ–∑–Ω–∏–º–∏ —à–ª—è—Ö–∞–º–∏ –≤ **`Software\Microsoft\Windows NT\CurrentVersion\NetworkList`**.

### **–°–ø—ñ–ª—å–Ω—ñ –ø–∞–ø–∫–∏**
- –°–ø—ñ–ª—å–Ω—ñ –ø–∞–ø–∫–∏ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –ø—ñ–¥ **`System\ControlSet001\Services\lanmanserver\Shares`**. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–µ—à—É–≤–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞ (CSC) –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –æ—Ñ–ª–∞–π–Ω-—Ñ–∞–π–ª—ñ–≤.

### **–ü—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ**
- –®–ª—è—Ö–∏, —Ç–∞–∫—ñ —è–∫ **`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run`** —Ç–∞ –ø–æ–¥—ñ–±–Ω—ñ –∑–∞–ø–∏—Å–∏ –ø—ñ–¥ `Software\Microsoft\Windows\CurrentVersion`, –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—é—Ç—å –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ –∑–∞–ø—É—Å–∫ –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

### **–ü–æ—à—É–∫–∏ —Ç–∞ –≤–≤–µ–¥–µ–Ω—ñ —à–ª—è—Ö–∏**
- –ü–æ—à—É–∫–∏ –≤ –ü—Ä–æ–≤—ñ–¥–Ω–∏–∫—É —Ç–∞ –≤–≤–µ–¥–µ–Ω—ñ —à–ª—è—Ö–∏ –≤—ñ–¥—Å—Ç–µ–∂—É—é—Ç—å—Å—è –≤ —Ä–µ—î—Å—Ç—Ä—ñ –ø—ñ–¥ **`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer`** –¥–ª—è WordwheelQuery —Ç–∞ TypedPaths –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.

### **–ù–µ–¥–∞–≤–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–∞ —Ñ–∞–π–ª–∏ Office**
- –ù–µ–¥–∞–≤–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–∞ —Ñ–∞–π–ª–∏ Office, –¥–æ —è–∫–∏—Ö –±—É–ª–æ –æ—Ç—Ä–∏–º–∞–Ω–æ –¥–æ—Å—Ç—É–ø, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ `NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs` —Ç–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö —à–ª—è—Ö–∞—Ö –≤–µ—Ä—Å—ñ—ó Office.

### **–ù–∞–π–±—ñ–ª—å—à –Ω–µ—â–æ–¥–∞–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ (MRU) –µ–ª–µ–º–µ–Ω—Ç–∏**
- –°–ø–∏—Å–∫–∏ MRU, —â–æ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –Ω–µ—â–æ–¥–∞–≤–Ω—ñ —à–ª—è—Ö–∏ —Ñ–∞–π–ª—ñ–≤ —Ç–∞ –∫–æ–º–∞–Ω–¥–∏, –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–∞—Ö `ComDlg32` —Ç–∞ `Explorer` –ø—ñ–¥ `NTUSER.DAT`.

### **–í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**
- –§—É–Ω–∫—Ü—ñ—è User Assist —Ä–µ—î—Å—Ç—Ä—É—î –¥–µ—Ç–∞–ª—å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º, –≤–∫–ª—é—á–∞—é—á–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫—ñ–≤ —Ç–∞ —á–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∑–∞–ø—É—Å–∫—É, –∑–∞ –∞–¥—Ä–µ—Å–æ—é **`NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count`**.

### **–ê–Ω–∞–ª—ñ–∑ Shellbags**
- Shellbags, —â–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—é—Ç—å –¥–µ—Ç–∞–ª—ñ –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–∞–ø–æ–∫, –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ `USRCLASS.DAT` —Ç–∞ `NTUSER.DAT` –ø—ñ–¥ `Software\Microsoft\Windows\Shell`. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **[Shellbag Explorer](https://ericzimmerman.github.io/#!index.md)** –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.

### **–Ü—Å—Ç–æ—Ä—ñ—è USB-–ø—Ä–∏—Å—Ç—Ä–æ—ó–≤**
- **`HKLM\SYSTEM\ControlSet001\Enum\USBSTOR`** —Ç–∞ **`HKLM\SYSTEM\ControlSet001\Enum\USB`** –º—ñ—Å—Ç—è—Ç—å –±–∞–≥–∞—Ç—ñ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ USB-–ø—Ä–∏—Å—Ç—Ä–æ—ó, –≤–∫–ª—é—á–∞—é—á–∏ –≤–∏—Ä–æ–±–Ω–∏–∫–∞, –Ω–∞–∑–≤—É –ø—Ä–æ–¥—É–∫—Ç—É —Ç–∞ —á–∞—Å–æ–≤—ñ –º—ñ—Ç–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø–æ–≤'—è–∑–∞–Ω–æ–≥–æ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º USB-–ø—Ä–∏—Å—Ç—Ä–æ—î–º, –º–æ–∂–Ω–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —à—É–∫–∞—é—á–∏ –≤ —Ö—ñ–≤–∞—Ö `NTUSER.DAT` –¥–ª—è **{GUID}** –ø—Ä–∏—Å—Ç—Ä–æ—é.
- –û—Å—Ç–∞–Ω–Ω—ñ–π –∑–º–æ–Ω—Ç–æ–≤–∞–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π —Ç–∞ –π–æ–≥–æ —Å–µ—Ä—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–æ–º—É –º–æ–∂–Ω–∞ –≤—ñ–¥—Å—Ç–µ–∂–∏—Ç–∏ —á–µ—Ä–µ–∑ `System\MountedDevices` —Ç–∞ `Software\Microsoft\Windows NT\CurrentVersion\EMDMgmt` –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.

–¶–µ–π –ø–æ—Å—ñ–±–Ω–∏–∫ —É–∑–∞–≥–∞–ª—å–Ω—é—î –∫–ª—é—á–æ–≤—ñ —à–ª—è—Ö–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å–∏—Å—Ç–µ–º—É, –º–µ—Ä–µ–∂—É —Ç–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö Windows, –ø—Ä–∞–≥–Ω—É—á–∏ –¥–æ —è—Å–Ω–æ—Å—Ç—ñ —Ç–∞ –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.



{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
