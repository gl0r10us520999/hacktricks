{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}


# Teoria b√°sica do IPv6

## Redes

Os endere√ßos IPv6 s√£o estruturados para melhorar a organiza√ß√£o da rede e a intera√ß√£o dos dispositivos. Um endere√ßo IPv6 √© dividido em:

1. **Prefixo da Rede**: Os primeiros 48 bits, determinando o segmento da rede.
2. **ID da Sub-rede**: Os 16 bits seguintes, usados para definir sub-redes espec√≠ficas dentro da rede.
3. **Identificador de Interface**: Os 64 bits finais, identificando exclusivamente um dispositivo dentro da sub-rede.

Enquanto o IPv6 omite o protocolo ARP encontrado no IPv4, ele introduz o **ICMPv6** com duas mensagens principais:
- **Solicita√ß√£o de Vizinhan√ßa (NS)**: Mensagens multicast para resolu√ß√£o de endere√ßos.
- **An√∫ncio de Vizinhan√ßa (NA)**: Respostas unicast ao NS ou an√∫ncios espont√¢neos.

O IPv6 tamb√©m incorpora tipos de endere√ßos especiais:
- **Endere√ßo de Loopback (`::1`)**: Equivalente ao `127.0.0.1` do IPv4, para comunica√ß√£o interna dentro do host.
- **Endere√ßos Link-Local (`FE80::/10`)**: Para atividades de rede local, n√£o para roteamento na internet. Dispositivos na mesma rede local podem se descobrir usando esse intervalo.

### Uso Pr√°tico do IPv6 em Comandos de Rede

Para interagir com redes IPv6, voc√™ pode usar v√°rios comandos:
- **Ping Endere√ßos Link-Local**: Verifique a presen√ßa de dispositivos locais usando `ping6`.
- **Descoberta de Vizinhan√ßa**: Use `ip neigh` para visualizar dispositivos descobertos na camada de link.
- **alive6**: Uma ferramenta alternativa para descobrir dispositivos na mesma rede.

Abaixo est√£o alguns exemplos de comandos:
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6 addresses podem ser derivados do endere√ßo MAC de um dispositivo para comunica√ß√£o local. Aqui est√° um guia simplificado sobre como derivar o endere√ßo IPv6 Link-local a partir de um endere√ßo MAC conhecido, e uma breve vis√£o geral dos tipos de endere√ßos IPv6 e m√©todos para descobrir endere√ßos IPv6 dentro de uma rede.

## **Derivando Link-local IPv6 do Endere√ßo MAC**

Dado um endere√ßo MAC **`12:34:56:78:9a:bc`**, voc√™ pode construir o endere√ßo IPv6 Link-local da seguinte forma:

1. Converta MAC para o formato IPv6: **`1234:5678:9abc`**
2. Adicione `fe80::` e insira `fffe` no meio: **`fe80::1234:56ff:fe78:9abc`**
3. Inverta o s√©timo bit da esquerda, mudando `1234` para `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **Tipos de Endere√ßos IPv6**

- **Endere√ßo Local √önico (ULA)**: Para comunica√ß√µes locais, n√£o destinado ao roteamento na internet p√∫blica. Prefixo: **`FEC00::/7`**
- **Endere√ßo Multicast**: Para comunica√ß√£o de um-para-muitos. Entregue a todas as interfaces no grupo multicast. Prefixo: **`FF00::/8`**
- **Endere√ßo Anycast**: Para comunica√ß√£o de um-para-o-mais-perto. Enviado para a interface mais pr√≥xima conforme o protocolo de roteamento. Parte do intervalo global unicast **`2000::/3`**.

## **Prefixos de Endere√ßo**
- **fe80::/10**: Endere√ßos Link-Local (semelhante a 169.254.x.x)
- **fc00::/7**: Unicast Local √önico (semelhante a intervalos privados de IPv4 como 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Unicast Global
- **ff02::1**: Multicast Todos os N√≥s
- **ff02::2**: Multicast N√≥s Roteadores

## **Descobrindo Endere√ßos IPv6 dentro de uma Rede**

### Modo 1: Usando Endere√ßos Link-local
1. Obtenha o endere√ßo MAC de um dispositivo dentro da rede.
2. Derive o endere√ßo IPv6 Link-local a partir do endere√ßo MAC.

### Modo 2: Usando Multicast
1. Envie um ping para o endere√ßo multicast `ff02::1` para descobrir endere√ßos IPv6 na rede local.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## IPv6 Man-in-the-Middle (MitM) Attacks
V√°rias t√©cnicas existem para executar ataques MitM em redes IPv6, como:

- Falsifica√ß√£o de an√∫ncios de vizinhos ou roteadores ICMPv6.
- Usar mensagens de redirecionamento ICMPv6 ou "Pacote Muito Grande" para manipular o roteamento.
- Atacar o IPv6 m√≥vel (geralmente requer que o IPSec esteja desativado).
- Configurar um servidor DHCPv6 malicioso.


# Identifying IPv6 Addresses in the eild

## Exploring Subdomains
Um m√©todo para encontrar subdom√≠nios que est√£o potencialmente ligados a endere√ßos IPv6 envolve aproveitar motores de busca. Por exemplo, empregar um padr√£o de consulta como `ipv6.*` pode ser eficaz. Especificamente, o seguinte comando de busca pode ser usado no Google:
```bash
site:ipv6./
```
## Utilizando Consultas DNS
Para identificar endere√ßos IPv6, certos tipos de registros DNS podem ser consultados:
- **AXFR**: Solicita uma transfer√™ncia completa de zona, potencialmente revelando uma ampla gama de registros DNS.
- **AAAA**: Busca diretamente endere√ßos IPv6.
- **ANY**: Uma consulta ampla que retorna todos os registros DNS dispon√≠veis.

## Probing com Ping6
Ap√≥s identificar endere√ßos IPv6 associados a uma organiza√ß√£o, a ferramenta `ping6` pode ser usada para sondagem. Esta ferramenta ajuda a avaliar a capacidade de resposta dos endere√ßos IPv6 identificados e tamb√©m pode auxiliar na descoberta de dispositivos IPv6 adjacentes.

## Refer√™ncias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
