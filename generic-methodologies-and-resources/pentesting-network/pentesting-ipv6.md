{% hint style="success" %}
Aprenda e pratique AWS Hacking: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Treinamento AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Treinamento GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoie o HackTricks</summary>

* Verifique os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}


# Teoria B√°sica do IPv6

## Redes

Os endere√ßos IPv6 s√£o estruturados para melhorar a organiza√ß√£o de redes e a intera√ß√£o de dispositivos. Um endere√ßo IPv6 √© dividido em:

1. **Prefixo de Rede**: Os primeiros 48 bits, determinando o segmento de rede.
2. **ID de Sub-rede**: Seguintes 16 bits, usados para definir sub-redes espec√≠ficas dentro da rede.
3. **Identificador de Interface**: Os √∫ltimos 64 bits, identificando de forma √∫nica um dispositivo dentro da sub-rede.

Enquanto o IPv6 omite o protocolo ARP encontrado no IPv4, ele introduz o **ICMPv6** com duas mensagens principais:
- **Solicita√ß√£o de Vizinhan√ßa (NS)**: Mensagens de multicast para resolu√ß√£o de endere√ßos.
- **An√∫ncio de Vizinhan√ßa (NA)**: Respostas unicast para NS ou an√∫ncios espont√¢neos.

O IPv6 tamb√©m incorpora tipos de endere√ßos especiais:
- **Endere√ßo de Loopback (`::1`)**: Equivalente ao `127.0.0.1` do IPv4, para comunica√ß√£o interna dentro do host.
- **Endere√ßos Link-Local (`FE80::/10`)**: Para atividades de rede local, n√£o para roteamento na internet. Dispositivos na mesma rede local podem se descobrir usando este intervalo.

### Uso Pr√°tico do IPv6 em Comandos de Rede

Para interagir com redes IPv6, voc√™ pode usar v√°rios comandos:
- **Ping em Endere√ßos Link-Local**: Verifique a presen√ßa de dispositivos locais usando `ping6`.
- **Descoberta de Vizinhan√ßa**: Use `ip neigh` para visualizar dispositivos descobertos na camada de link.
- **alive6**: Uma ferramenta alternativa para descobrir dispositivos na mesma rede.

Abaixo est√£o alguns exemplos de comandos:
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
## **Derivando o Link-local IPv6 a partir do Endere√ßo MAC**

Dado um endere√ßo MAC **`12:34:56:78:9a:bc`**, voc√™ pode construir o endere√ßo IPv6 Link-local da seguinte forma:

1. Converter o MAC para o formato IPv6: **`1234:5678:9abc`**
2. Adicionar `fe80::` e inserir `fffe` no meio: **`fe80::1234:56ff:fe78:9abc`**
3. Inverter o s√©timo bit da esquerda, alterando `1234` para `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **Tipos de Endere√ßos IPv6**

- **Endere√ßo √önico Local (ULA)**: Para comunica√ß√µes locais, n√£o destinado ao roteamento p√∫blico na internet. Prefixo: **`FEC00::/7`**
- **Endere√ßo de Multicast**: Para comunica√ß√£o de um para muitos. Entregue a todas as interfaces no grupo de multicast. Prefixo: **`FF00::/8`**
- **Endere√ßo de Anycast**: Para comunica√ß√£o de um para o mais pr√≥ximo. Enviado para a interface mais pr√≥xima de acordo com o protocolo de roteamento. Parte do intervalo unicast global **`2000::/3`**.

## **Prefixos de Endere√ßo**
- **fe80::/10**: Endere√ßos Link-Local (semelhante a 169.254.x.x)
- **fc00::/7**: √önico Local-Unicast (semelhante aos intervalos IPv4 privados como 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Unicast Global
- **ff02::1**: Multicast Todos os N√≥s
- **ff02::2**: Multicast N√≥s Roteadores

## **Descobrindo Endere√ßos IPv6 dentro de uma Rede**

### Forma 1: Usando Endere√ßos Link-local
1. Obter o endere√ßo MAC de um dispositivo dentro da rede.
2. Derivar o endere√ßo IPv6 Link-local a partir do endere√ßo MAC.

### Forma 2: Usando Multicast
1. Enviar um ping para o endere√ßo de multicast `ff02::1` para descobrir endere√ßos IPv6 na rede local.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## Ataques de Man-in-the-Middle (MitM) em IPv6
Existem v√°rias t√©cnicas para executar ataques MitM em redes IPv6, tais como:

- Falsifica√ß√£o de an√∫ncios de vizinho ou roteador ICMPv6.
- Utiliza√ß√£o de mensagens de redirecionamento ICMPv6 ou "Packet Too Big" para manipular o roteamento.
- Atacar o IPv6 m√≥vel (geralmente requer que o IPSec esteja desativado).
- Configurar um servidor DHCPv6 falso.


# Identifica√ß√£o de Endere√ßos IPv6 na rede

## Explorando Subdom√≠nios
Um m√©todo para encontrar subdom√≠nios potencialmente vinculados a endere√ßos IPv6 envolve o uso de mecanismos de busca. Por exemplo, empregar um padr√£o de consulta como `ipv6.*` pode ser eficaz. Especificamente, o seguinte comando de pesquisa pode ser usado no Google:
```bash
site:ipv6./
```
## Utilizando Consultas DNS
Para identificar endere√ßos IPv6, certos tipos de registros DNS podem ser consultados:
- **AXFR**: Solicita uma transfer√™ncia completa de zona, potencialmente revelando uma ampla gama de registros DNS.
- **AAAA**: Busca diretamente por endere√ßos IPv6.
- **ANY**: Uma consulta ampla que retorna todos os registros DNS dispon√≠veis.

## Sondagem com Ping6
Ap√≥s identificar os endere√ßos IPv6 associados a uma organiza√ß√£o, a utilidade `ping6` pode ser usada para sondagem. Essa ferramenta ajuda a avaliar a responsividade dos endere√ßos IPv6 identificados e tamb√©m pode auxiliar na descoberta de dispositivos IPv6 adjacentes.


## Refer√™ncias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Treinamento HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Treinamento HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Suporte ao HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
