{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Th√©orie de base de l'IPv6

## R√©seaux

Les adresses IPv6 sont structur√©es pour am√©liorer l'organisation du r√©seau et l'interaction des appareils. Une adresse IPv6 est divis√©e en :

1. **Pr√©fixe de r√©seau** : Les 48 premiers bits, d√©terminant le segment de r√©seau.
2. **ID de sous-r√©seau** : Les 16 bits suivants, utilis√©s pour d√©finir des sous-r√©seaux sp√©cifiques au sein du r√©seau.
3. **Identifiant d'interface** : Les 64 derniers bits, identifiant de mani√®re unique un appareil au sein du sous-r√©seau.

Bien que l'IPv6 omette le protocole ARP trouv√© dans l'IPv4, il introduit **ICMPv6** avec deux messages principaux :
- **Solicitation de voisin (NS)** : Messages multicast pour la r√©solution d'adresse.
- **Annonce de voisin (NA)** : R√©ponses unicast aux NS ou annonces spontan√©es.

L'IPv6 incorpore √©galement des types d'adresses sp√©ciaux :
- **Adresse de boucle locale (`::1`)** : √âquivalente √† `127.0.0.1` de l'IPv4, pour la communication interne au sein de l'h√¥te.
- **Adresses Link-Local (`FE80::/10`)** : Pour les activit√©s de r√©seau local, non pour le routage Internet. Les appareils sur le m√™me r√©seau local peuvent se d√©couvrir en utilisant cette plage.

### Utilisation pratique de l'IPv6 dans les commandes r√©seau

Pour interagir avec les r√©seaux IPv6, vous pouvez utiliser diverses commandes :
- **Ping des adresses Link-Local** : V√©rifiez la pr√©sence d'appareils locaux en utilisant `ping6`.
- **D√©couverte de voisin** : Utilisez `ip neigh` pour voir les appareils d√©couverts au niveau de la couche de liaison.
- **alive6** : Un outil alternatif pour d√©couvrir des appareils sur le m√™me r√©seau.

Voici quelques exemples de commandes :
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6 addresses can be derived from a device's MAC address for local communication. Here's a simplified guide on how to derive the Link-local IPv6 address from a known MAC address, and a brief overview of IPv6 address types and methods to discover IPv6 addresses within a network.

## **D√©rivation de l'IPv6 Link-local √† partir de l'adresse MAC**

Given a MAC address **`12:34:56:78:9a:bc`**, you can construct the Link-local IPv6 address as follows:

1. Convert MAC to IPv6 format: **`1234:5678:9abc`**
2. Prepend `fe80::` and insert `fffe` in the middle: **`fe80::1234:56ff:fe78:9abc`**
3. Invert the seventh bit from the left, changing `1234` to `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **Types d'adresses IPv6**

- **Adresse locale unique (ULA)**: Pour les communications locales, non destin√©e au routage sur Internet public. Pr√©fixe: **`FEC00::/7`**
- **Adresse multicast**: Pour la communication un-√†-plusieurs. Livr√©e √† toutes les interfaces du groupe multicast. Pr√©fixe: **`FF00::/8`**
- **Adresse anycast**: Pour la communication un-√†-le-plus-proche. Envoy√©e √† l'interface la plus proche selon le protocole de routage. Partie de la plage unicast globale **`2000::/3`**.

## **Pr√©fixes d'adresses**
- **fe80::/10**: Adresses Link-Local (similaire √† 169.254.x.x)
- **fc00::/7**: Unicast local unique (similaire aux plages IPv4 priv√©es comme 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Unicast global
- **ff02::1**: Multicast Tous les N≈ìuds
- **ff02::2**: Multicast N≈ìuds Routeurs

## **D√©couverte des adresses IPv6 au sein d'un r√©seau**

### M√©thode 1: Utilisation des adresses Link-local
1. Obtenez l'adresse MAC d'un appareil au sein du r√©seau.
2. D√©rivez l'adresse IPv6 Link-local √† partir de l'adresse MAC.

### M√©thode 2: Utilisation du multicast
1. Envoyez un ping √† l'adresse multicast `ff02::1` pour d√©couvrir les adresses IPv6 sur le r√©seau local.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## Attaques Man-in-the-Middle (MitM) IPv6
Plusieurs techniques existent pour ex√©cuter des attaques MitM dans des r√©seaux IPv6, telles que :

- Usurpation des annonces de voisins ou de routeurs ICMPv6.
- Utilisation de messages de redirection ICMPv6 ou "Packet Too Big" pour manipuler le routage.
- Attaque sur IPv6 mobile (n√©cessite g√©n√©ralement que l'IPSec soit d√©sactiv√©).
- Mise en place d'un serveur DHCPv6 malveillant.


# Identification des adresses IPv6 dans le champ

## Exploration des sous-domaines
Une m√©thode pour trouver des sous-domaines potentiellement li√©s √† des adresses IPv6 consiste √† tirer parti des moteurs de recherche. Par exemple, utiliser un mod√®le de requ√™te comme `ipv6.*` peut √™tre efficace. Plus pr√©cis√©ment, la commande de recherche suivante peut √™tre utilis√©e dans Google :
```bash
site:ipv6./
```
## Utilisation des requ√™tes DNS
Pour identifier les adresses IPv6, certains types d'enregistrements DNS peuvent √™tre interrog√©s :
- **AXFR** : Demande un transfert complet de zone, pouvant r√©v√©ler un large √©ventail d'enregistrements DNS.
- **AAAA** : Recherche directement des adresses IPv6.
- **ANY** : Une requ√™te large qui renvoie tous les enregistrements DNS disponibles.

## Exploration avec Ping6
Apr√®s avoir identifi√© les adresses IPv6 associ√©es √† une organisation, l'utilitaire `ping6` peut √™tre utilis√© pour l'exploration. Cet outil aide √† √©valuer la r√©activit√© des adresses IPv6 identifi√©es et peut √©galement aider √† d√©couvrir des dispositifs IPv6 adjacents.

## R√©f√©rences

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
