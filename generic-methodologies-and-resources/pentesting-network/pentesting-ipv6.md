{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Podstawowa teoria IPv6

## Sieci

Adresy IPv6 s zorganizowane w celu poprawy organizacji sieci i interakcji urzdze. Adres IPv6 dzieli si na:

1. **Prefiks sieciowy**: Pierwsze 48 bit贸w, okrelajce segment sieci.
2. **ID podsieci**: Nastpne 16 bit贸w, u偶ywane do definiowania konkretnych podsieci w sieci.
3. **Identyfikator interfejsu**: Ostatnie 64 bity, unikalnie identyfikujce urzdzenie w podsieci.

Podczas gdy IPv6 pomija protok贸 ARP znany z IPv4, wprowadza **ICMPv6** z dwoma g贸wnymi komunikatami:
- **Zapytanie ssiedztwa (NS)**: Wiadomoci multicastowe do rozwizywania adres贸w.
- **Ogoszenie ssiedztwa (NA)**: Odpowiedzi unicastowe na NS lub spontaniczne ogoszenia.

IPv6 wprowadza r贸wnie偶 specjalne typy adres贸w:
- **Adres loopback (`::1`)**: Odpowiednik IPv4 `127.0.0.1`, do komunikacji wewntrznej w hocie.
- **Adresy lokalne (`FE80::/10`)**: Do lokalnych dziaa sieciowych, nie do routingu w internecie. Urzdzenia w tej samej lokalnej sieci mog si nawzajem odkrywa, u偶ywajc tego zakresu.

### Praktyczne zastosowanie IPv6 w poleceniach sieciowych

Aby interagowa z sieciami IPv6, mo偶na u偶ywa r贸偶nych polece:
- **Ping adresy lokalne**: Sprawd藕 obecno lokalnych urzdze, u偶ywajc `ping6`.
- **Odkrywanie ssiedztwa**: U偶yj `ip neigh`, aby zobaczy urzdzenia odkryte na warstwie cza.
- **alive6**: Alternatywne narzdzie do odkrywania urzdze w tej samej sieci.

Poni偶ej znajduj si przykady polece:
```bash
ping6 I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6 addresses can be derived from a device's MAC address for local communication. Here's a simplified guide on how to derive the Link-local IPv6 address from a known MAC address, and a brief overview of IPv6 address types and methods to discover IPv6 addresses within a network.

## **Deriving Link-local IPv6 from MAC Address**

Given a MAC address **`12:34:56:78:9a:bc`**, you can construct the Link-local IPv6 address as follows:

1. Convert MAC to IPv6 format: **`1234:5678:9abc`**
2. Prepend `fe80::` and insert `fffe` in the middle: **`fe80::1234:56ff:fe78:9abc`**
3. Invert the seventh bit from the left, changing `1234` to `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **IPv6 Address Types**

- **Unique Local Address (ULA)**: Do lokalnej komunikacji, nie przeznaczony do routingu w Internecie. Prefiks: **`FEC00::/7`**
- **Multicast Address**: Do komunikacji jeden-do-wielu. Dostarczany do wszystkich interfejs贸w w grupie multicast. Prefiks: **`FF00::/8`**
- **Anycast Address**: Do komunikacji jeden-do-najbli偶szego. Wysyany do najbli偶szego interfejsu zgodnie z protokoem routingu. Cz globalnego zakresu unicast **`2000::/3`**.

## **Address Prefixes**
- **fe80::/10**: Adresy Link-Local (podobne do 169.254.x.x)
- **fc00::/7**: Unikalny Local-Unicast (podobne do prywatnych zakres贸w IPv4, takich jak 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Global Unicast
- **ff02::1**: Multicast Wszystkie Wzy
- **ff02::2**: Multicast Wzy Routera

## **Discovering IPv6 Addresses within a Network**

### Way 1: Using Link-local Addresses
1. Uzyskaj adres MAC urzdzenia w sieci.
2. Wyprowad藕 adres Link-local IPv6 z adresu MAC.

### Way 2: Using Multicast
1. Wylij ping do adresu multicast `ff02::1`, aby odkry adresy IPv6 w lokalnej sieci.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## Ataki typu Man-in-the-Middle (MitM) w IPv6
Istnieje kilka technik wykonywania atak贸w MitM w sieciach IPv6, takich jak:

- Faszowanie reklam ssiedztwa lub routera ICMPv6.
- U偶ywanie komunikat贸w ICMPv6 redirect lub "Packet Too Big" do manipulacji trasowaniem.
- Atakowanie mobilnego IPv6 (zwykle wymaga wyczenia IPSec).
- Ustawienie nieautoryzowanego serwera DHCPv6.


# Identyfikacja adres贸w IPv6 w terenie

## Badanie subdomen
Metoda znajdowania subdomen, kt贸re mog by powizane z adresami IPv6, polega na wykorzystaniu wyszukiwarek. Na przykad, zastosowanie wzoru zapytania takiego jak `ipv6.*` mo偶e by skuteczne. Konkretnie, mo偶na u偶y nastpujcego polecenia wyszukiwania w Google:
```bash
site:ipv6./
```
## Wykorzystanie zapyta DNS
Aby zidentyfikowa adresy IPv6, mo偶na zapyta o okrelone typy rekord贸w DNS:
- **AXFR**: 呕da penego transferu strefy, co mo偶e ujawni szeroki zakres rekord贸w DNS.
- **AAAA**: Bezporednio poszukuje adres贸w IPv6.
- **ANY**: Szerokie zapytanie, kt贸re zwraca wszystkie dostpne rekordy DNS.

## Badanie za pomoc Ping6
Po zidentyfikowaniu adres贸w IPv6 zwizanych z organizacj, mo偶na u偶y narzdzia `ping6` do badania. To narzdzie pomaga oceni responsywno zidentyfikowanych adres贸w IPv6 i mo偶e r贸wnie偶 pom贸c w odkrywaniu ssiednich urzdze IPv6.

## Odniesienia

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the**  [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter**  [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
