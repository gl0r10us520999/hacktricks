{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Teoria di base dell'IPv6

## Reti

Gli indirizzi IPv6 sono strutturati per migliorare l'organizzazione della rete e l'interazione dei dispositivi. Un indirizzo IPv6 √® diviso in:

1. **Prefisso di rete**: I primi 48 bit, che determinano il segmento di rete.
2. **ID sottorete**: I successivi 16 bit, utilizzati per definire sottoreti specifiche all'interno della rete.
3. **Identificatore dell'interfaccia**: Gli ultimi 64 bit, che identificano un dispositivo in modo univoco all'interno della sottorete.

Mentre l'IPv6 omette il protocollo ARP presente nell'IPv4, introduce **ICMPv6** con due messaggi principali:
- **Richiesta di vicinato (NS)**: Messaggi multicast per la risoluzione degli indirizzi.
- **Annuncio di vicinato (NA)**: Risposte unicast a NS o annunci spontanei.

L'IPv6 incorpora anche tipi di indirizzi speciali:
- **Indirizzo di loopback (`::1`)**: Equivalente a `127.0.0.1` di IPv4, per comunicazioni interne all'host.
- **Indirizzi link-local (`FE80::/10`)**: Per attivit√† di rete locali, non per il routing su internet. I dispositivi sulla stessa rete locale possono scoprire l'uno l'altro utilizzando questo intervallo.

### Utilizzo pratico dell'IPv6 nei comandi di rete

Per interagire con le reti IPv6, puoi utilizzare vari comandi:
- **Ping indirizzi link-local**: Controlla la presenza di dispositivi locali utilizzando `ping6`.
- **Scoperta dei vicini**: Usa `ip neigh` per visualizzare i dispositivi scoperti a livello di link.
- **alive6**: Uno strumento alternativo per scoprire dispositivi sulla stessa rete.

Di seguito alcuni esempi di comandi:
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6 gli indirizzi possono essere derivati dall'indirizzo MAC di un dispositivo per la comunicazione locale. Ecco una guida semplificata su come derivare l'indirizzo IPv6 Link-local da un indirizzo MAC noto e una breve panoramica dei tipi di indirizzi IPv6 e dei metodi per scoprire gli indirizzi IPv6 all'interno di una rete.

## **Derivazione dell'IPv6 Link-local dall'indirizzo MAC**

Dato un indirizzo MAC **`12:34:56:78:9a:bc`**, puoi costruire l'indirizzo IPv6 Link-local come segue:

1. Converti il MAC nel formato IPv6: **`1234:5678:9abc`**
2. Prependi `fe80::` e inserisci `fffe` nel mezzo: **`fe80::1234:56ff:fe78:9abc`**
3. Inverti il settimo bit da sinistra, cambiando `1234` in `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **Tipi di indirizzi IPv6**

- **Indirizzo Locale Unico (ULA)**: Per comunicazioni locali, non destinato al routing su Internet pubblico. Prefisso: **`FEC00::/7`**
- **Indirizzo Multicast**: Per comunicazione uno-a-molti. Consegnato a tutte le interfacce nel gruppo multicast. Prefisso: **`FF00::/8`**
- **Indirizzo Anycast**: Per comunicazione uno-a-pi√π-vicina. Inviato all'interfaccia pi√π vicina secondo il protocollo di routing. Parte dell'intervallo unicast globale **`2000::/3`**.

## **Prefissi degli indirizzi**
- **fe80::/10**: Indirizzi Link-Local (simile a 169.254.x.x)
- **fc00::/7**: Unicast Locale Unico (simile a intervalli IPv4 privati come 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Unicast Globale
- **ff02::1**: Multicast Tutti i Nodi
- **ff02::2**: Multicast Nodi Router

## **Scoprire indirizzi IPv6 all'interno di una rete**

### Modo 1: Utilizzando indirizzi Link-local
1. Ottieni l'indirizzo MAC di un dispositivo all'interno della rete.
2. Deriva l'indirizzo IPv6 Link-local dall'indirizzo MAC.

### Modo 2: Utilizzando Multicast
1. Invia un ping all'indirizzo multicast `ff02::1` per scoprire indirizzi IPv6 sulla rete locale.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## IPv6 Man-in-the-Middle (MitM) Attacks
Esistono diverse tecniche per eseguire attacchi MitM nelle reti IPv6, come:

- Spoofing delle pubblicit√† dei vicini o dei router ICMPv6.
- Utilizzo di messaggi ICMPv6 di reindirizzamento o "Pacchetto Troppo Grande" per manipolare il routing.
- Attacco a mobile IPv6 (di solito richiede che IPSec sia disabilitato).
- Configurazione di un server DHCPv6 malevolo.


# Identifying IPv6 Addresses in the eild

## Exploring Subdomains
Un metodo per trovare sottodomini che sono potenzialmente collegati a indirizzi IPv6 implica l'uso di motori di ricerca. Ad esempio, utilizzare un modello di query come `ipv6.*` pu√≤ essere efficace. In particolare, il seguente comando di ricerca pu√≤ essere utilizzato in Google:
```bash
site:ipv6./
```
## Utilizzo delle Query DNS
Per identificare gli indirizzi IPv6, √® possibile interrogare determinati tipi di record DNS:
- **AXFR**: Richiede un trasferimento completo della zona, potenzialmente rivelando un'ampia gamma di record DNS.
- **AAAA**: Cerca direttamente indirizzi IPv6.
- **ANY**: Una query ampia che restituisce tutti i record DNS disponibili.

## Probing con Ping6
Dopo aver individuato gli indirizzi IPv6 associati a un'organizzazione, l'utilit√† `ping6` pu√≤ essere utilizzata per il probing. Questo strumento aiuta a valutare la reattivit√† degli indirizzi IPv6 identificati e potrebbe anche assistere nella scoperta di dispositivi IPv6 adiacenti.

## Riferimenti

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
