# Nmap Zusammenfassung (ESP)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parameter

### Zu scannende IPs

* **`<ip>,<net/mask>`:** Geben Sie die IPs direkt an
* **`-iL <ips_file>`:** list\_IPs
* **`-iR <number>`**: Anzahl der zuf√§lligen IPs, Sie k√∂nnen m√∂gliche IPs mit `--exclude <Ips>` oder `--excludefile <file>` ausschlie√üen.

### Ger√§tesuche

Standardm√§√üig startet Nmap eine Entdeckungsphase, die aus Folgendem besteht: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Es ist nicht invasiv, es listet die Ziele auf, indem es **DNS**-Anfragen zur Namensaufl√∂sung stellt. Es ist n√ºtzlich zu wissen, ob zum Beispiel www.prueba.es/24 alle IPs unsere Ziele sind.
* **`-Pn`**: **Kein Ping**. Dies ist n√ºtzlich, wenn Sie wissen, dass alle aktiv sind (ansonsten k√∂nnten Sie viel Zeit verlieren, aber diese Option produziert auch falsche Negative, die besagen, dass sie nicht aktiv sind), es verhindert die Entdeckungsphase.
* **`-sn`** : **Kein Portscan**. Nach Abschluss der Aufkl√§rungsphase scannt es keine Ports. Es ist relativ stealthy und erm√∂glicht einen kleinen Netzwerkscan. Mit Rechten sendet es ein ACK (-PA) an 80, ein SYN(-PS) an 443 und eine Echo-Anfrage sowie eine Zeitstempel-Anfrage, ohne Rechte schlie√üt es immer Verbindungen ab. Wenn das Ziel das Netzwerk ist, verwendet es nur ARP(-PR). Wenn es mit einer anderen Option verwendet wird, werden nur die Pakete der anderen Option verworfen.
* **`-PR`**: **Ping ARP**. Es wird standardm√§√üig verwendet, wenn Computer in unserem Netzwerk analysiert werden, es ist schneller als die Verwendung von Pings. Wenn Sie ARP-Pakete nicht verwenden m√∂chten, verwenden Sie `--send-ip`.
* **`-PS <ports>`**: Es sendet SYN-Pakete, auf die, wenn sie mit SYN/ACK antworten, offen sind (auf die mit RST geantwortet wird, um die Verbindung nicht zu beenden), wenn sie mit RST antworten, sind sie geschlossen, und wenn sie nicht antworten, sind sie unerreichbar. Im Falle von fehlenden Rechten wird automatisch eine vollst√§ndige Verbindung verwendet. Wenn keine Ports angegeben sind, wird es auf 80 geworfen.
* **`-PA <ports>`**: Wie das vorherige, aber mit ACK, die Kombination beider ergibt bessere Ergebnisse.
* **`-PU <ports>`**: Das Ziel ist das Gegenteil, sie werden an Ports gesendet, von denen erwartet wird, dass sie geschlossen sind. Einige Firewalls √ºberpr√ºfen nur TCP-Verbindungen. Wenn es geschlossen ist, wird mit Port unerreichbar geantwortet, wenn es mit einem anderen ICMP oder nicht geantwortet wird, bleibt es als Ziel unerreichbar.
* **`-PE, -PP, -PM`** : ICMP PINGS: Echo-Antwort, Zeitstempel und Adressmaske. Sie werden gestartet, um herauszufinden, ob das Ziel aktiv ist.
* **`-PY<ports>`**: Sendet SCTP INIT-Proben standardm√§√üig an 80, INIT-ACK(offen) oder ABORT(geschlossen) oder nichts oder ICMP unerreichbar(inaktiv) kann geantwortet werden.
* **`-PO <protocols>`**: Ein Protokoll wird in den Headern angegeben, standardm√§√üig 1(ICMP), 2(IGMP) und 4(Encap IP). F√ºr ICMP, IGMP, TCP (6) und UDP (17) Protokolle werden die Protokoll-Header gesendet, f√ºr den Rest wird nur der IP-Header gesendet. Der Zweck davon ist, dass aufgrund der Fehlbildung der Header, Protokoll unerreichbar oder Antworten des gleichen Protokolls beantwortet werden, um zu wissen, ob es aktiv ist.
* **`-n`**: Kein DNS
* **`-R`**: DNS immer

### Port-Scan-Techniken

* **`-sS`**: Schlie√üt die Verbindung nicht ab, sodass keine Spur hinterlassen wird, sehr gut, wenn es verwendet werden kann. (Rechte) Es ist die standardm√§√üig verwendete Methode.
* **`-sT`**: Schlie√üt die Verbindung ab, sodass eine Spur hinterlassen wird, aber es kann sicher verwendet werden. Standardm√§√üig ohne Rechte.
* **`-sU`**: Langsam, f√ºr UDP. Haupts√§chlich: DNS(53), SNMP(161,162), DHCP(67 und 68), (-sU53,161,162,67,68): offen(Antwort), geschlossen(Port unerreichbar), gefiltert (ein anderes ICMP), offen/gefiltert (nichts). Im Falle von offen/gefiltert sendet -sV zahlreiche Anfragen, um eine der Versionen zu erkennen, die nmap unterst√ºtzt und kann den tats√§chlichen Zustand erkennen. Es erh√∂ht die Zeit erheblich.
* **`-sY`**: SCTP-Protokoll kann die Verbindung nicht herstellen, sodass keine Protokolle vorhanden sind, funktioniert wie -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, sie k√∂nnen einige Firewalls durchdringen und Informationen extrahieren. Sie basieren auf der Tatsache, dass standardkonforme Maschinen auf alle Anfragen, die keine SYN, RST oder ACK-Flags haben, mit RST antworten sollten: offen/gefiltert(nichts), geschlossen(RST), gefiltert (ICMP unerreichbar). Unzuverl√§ssig unter Windows, Cisco, BSDI und OS/400. Unter Unix ja.
* **`-sM`**: Maimon-Scan: Sendet FIN- und ACK-Flags, verwendet f√ºr BSD, wird derzeit alles als geschlossen zur√ºckgeben.
* **`-sA, sW`**: ACK und Window, wird verwendet, um Firewalls zu erkennen, um zu wissen, ob die Ports gefiltert sind oder nicht. Das -sW unterscheidet zwischen offen/geschlossen, da die offenen mit einem anderen Fensterwert antworten: offen (RST mit Fenster ungleich 0), geschlossen (RST Fenster = 0), gefiltert (ICMP unerreichbar oder nichts). Nicht alle Computer funktionieren so, also wenn alles geschlossen ist, funktioniert es nicht, wenn einige offen sind, funktioniert es gut, und wenn viele offen und wenige geschlossen sind, funktioniert es umgekehrt.
* **`-sI`:** Idle-Scan. F√ºr die F√§lle, in denen es eine aktive Firewall gibt, aber wir wissen, dass sie nicht zu einer bestimmten IP filtert (oder wenn wir einfach Anonymit√§t wollen), k√∂nnen wir den Zombie-Scanner verwenden (er funktioniert f√ºr alle Ports), um m√∂gliche Zombies zu suchen, k√∂nnen wir das Skript ipidseq oder den Exploit auxiliary/scanner/ip/ipidseq verwenden. Dieser Scanner basiert auf der IPID-Nummer der IP-Pakete.
* **`--badsum`:** Es sendet die Summe falsch, die Computer w√ºrden die Pakete verwerfen, aber die Firewalls k√∂nnten etwas antworten, es wird verwendet, um Firewalls zu erkennen.
* **`-sZ`:** "Seltsamer" SCTP-Scanner, beim Senden von Proben mit Cookie-Echo-Fragmenten sollten sie verworfen werden, wenn sie offen sind, oder mit ABORT geantwortet werden, wenn sie geschlossen sind. Es kann durch Firewalls gelangen, die init nicht durchlassen, das Schlechte ist, dass es nicht zwischen gefiltert und offen unterscheidet.
* **`-sO`:** Protokoll-IP-Scan. Sendet fehlerhafte und leere Header, bei denen manchmal nicht einmal das Protokoll unterschieden werden kann. Wenn ein ICMP unerreichbares Protokoll ankommt, ist es geschlossen, wenn ein unerreichbarer Port ankommt, ist es offen, wenn ein anderer Fehler ankommt, gefiltert, wenn nichts ankommt, offen|gefiltert.
* **`-b <server>`:** FTPhost--> Es wird verwendet, um einen Host von einem anderen zu scannen, dies geschieht, indem man das FTP einer anderen Maschine verbindet und sie bittet, Dateien an die Ports zu senden, die Sie von einer anderen Maschine scannen m√∂chten, je nach den Antworten wissen wir, ob sie offen sind oder nicht. \[\<user>:\<password>@]\<server>\[:\<port>] Fast alle FTP-Server erlauben dies nicht mehr und daher hat es wenig praktische Anwendung.

### **Zentralanalyse**

**-p:** Dient dazu, die zu scannenden Ports anzugeben. Um die 65335 auszuw√§hlen: **-p-** oder **-p all**. Nmap hat eine interne Klassifizierung nach Beliebtheit. Standardm√§√üig verwendet es die 1000 Hauptports. Mit **-F** (schneller Scan) analysiert es die 100 Hauptports. Mit **--top-ports \<nummer>** analysiert es diese Anzahl von Hauptports (von 1 bis 65335). Es √ºberpr√ºft die Ports in zuf√§lliger Reihenfolge, um zu verhindern, dass dies passiert, verwenden Sie **-r**. Wir k√∂nnen auch Ports ausw√§hlen: 20-30,80,443,1024- Dies bedeutet, dass es ab 1024 schaut. Wir k√∂nnen die Ports auch nach Protokollen gruppieren: U:53,T:21-25,80,139,S:9. Wir k√∂nnen auch einen Bereich innerhalb der beliebten Ports von nmap ausw√§hlen: -p \[-1024] analysiert bis 1024 der in nmap-services enthaltenen. **--port-ratio \<ratio>** Analysiert die h√§ufigsten Ports, die ein Verh√§ltnis haben m√ºssen, das zwischen 0 und 1 liegt.

**-sV** Versionsscan, die Intensit√§t kann von 0 bis 9 reguliert werden, standardm√§√üig 7.

**--version-intensity \<nummer>** Reguliert die Intensit√§t, sodass je niedriger, desto wahrscheinlicher nur die wahrscheinlichsten Sonden gesendet werden, aber nicht alle. Damit k√∂nnen wir die Zeit des UDP-Scans erheblich verk√ºrzen.

**-O** OS-Erkennung

**--osscan-limit** Um einen Host gut zu scannen, muss mindestens ein Port offen und ein anderer geschlossen sein, wenn diese Bedingung nicht erf√ºllt ist und wir dies gesetzt haben, versucht es nicht, eine OS-Vorhersage zu machen (spart Zeit).

**--osscan-guess** Wenn die OS-Erkennung nicht perfekt ist, sorgt dies daf√ºr, dass sie sich mehr anstrengt.

**Skripte**

\--script _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_\[,...]

Um die Standard-Skripte zu verwenden, reicht -sC oder --script=default.

Die verf√ºgbaren Typen sind: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version und vuln.

* **Auth:** F√ºhrt alle verf√ºgbaren _Skripte_ zur Authentifizierung aus.
* **Default:** F√ºhrt die grundlegenden Standard-_Skripte_ des Tools aus.
* **Discovery:** Ruft Informationen vom _Ziel_ oder Opfer ab.
* **External:** _Skript_ zur Verwendung externer Ressourcen.
* **Intrusive:** Verwendet _Skripte_, die als invasiv f√ºr das Opfer oder _Ziel_ gelten.
* **Malware:** √úberpr√ºft, ob es offene Verbindungen durch b√∂sartige Codes oder _Backdoors_ gibt.
* **Safe:** F√ºhrt _Skripte_ aus, die nicht invasiv sind.
* **Vuln:** Entdeckt die bekanntesten Schwachstellen.
* **All:** F√ºhrt absolut alle verf√ºgbaren _Skripte_ mit der Erweiterung NSE aus.

Um Skripte zu suchen:

**nmap --script-help="http-\*" -> Die, die mit http- beginnen**

**nmap --script-help="not intrusive" -> Alle au√üer diesen**

**nmap --script-help="default or safe" -> Die, die in einem oder dem anderen oder in beiden sind**

**nmap --script-help="default and safe" --> Die, die in beiden sind**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<filename>_

\--script-help _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_|all\[,...]

\--script-trace ---> Gibt Informationen dar√ºber, wie das Skript l√§uft.

\--script-updatedb

**Um ein Skript zu verwenden, muss man nur Folgendes eingeben: namp --script Name\_des\_Skripts Ziel** --> Beim Eingeben des Skripts wird sowohl das Skript als auch der Scanner ausgef√ºhrt, sodass auch Optionen des Scanners angegeben werden k√∂nnen, wir k√∂nnen **‚Äúsafe=1‚Äù** hinzuf√ºgen, damit nur die sicheren ausgef√ºhrt werden.

**Zeitkontrolle**

**Nmap kann die Zeit in Sekunden, Minuten, ms √§ndern:** --host-timeout arguments 900000ms, 900, 900s und 15m tun alle dasselbe.

Nmap teilt die Gesamtzahl der zu scannenden Hosts in Gruppen auf und analysiert diese Gruppen in Bl√∂cken, sodass, bis nicht alle analysiert wurden, nicht zum n√§chsten Block √ºbergegangen wird (und der Benutzer auch keine Aktualisierung erh√§lt, bis der Block analysiert wurde), auf diese Weise ist es f√ºr nmap optimal, gro√üe Gruppen zu verwenden. Standardm√§√üig verwendet es in Klasse C 256.

Es kann ge√§ndert werden mit **--min-hostgroup** _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Passen Sie die Gr√∂√üen der parallelen Scan-Gruppen an).

Die Anzahl der parallelen Scanner kann kontrolliert werden, aber es ist besser, dies nicht zu tun (nmap hat bereits eine automatische Kontrolle basierend auf dem Zustand des Netzwerks): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

Wir k√∂nnen das RTT-Timeout √§ndern, aber das ist normalerweise nicht notwendig: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

Wir k√∂nnen die Anzahl der Versuche √§ndern:**--max-retries** _**\<numtries>**_

Wir k√∂nnen die Scan-Zeit eines Hosts √§ndern: **--host-timeout** _**\<time>**_

Wir k√∂nnen die Zeit zwischen jedem Test √§ndern, damit es langsamer geht: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

Wir k√∂nnen die Anzahl der Pakete pro Sekunde √§ndern: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

Viele Ports ben√∂tigen lange, um auf gefilterte oder geschlossene Anfragen zu antworten. Wenn uns nur die offenen interessieren, k√∂nnen wir schneller vorgehen mit: **--defeat-rst-ratelimit**.

Um zu definieren, wie aggressiv wir nmap haben m√∂chten: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> Es wird nur 1 Port gleichzeitig gescannt und 5 Minuten bis zum n√§chsten gewartet.

\-T1 und T2 --> Sehr √§hnlich, aber warten nur 15 und 0,4 Sekunden zwischen jedem Test.

\-T3 --> Standardbetrieb, schlie√üt parallel ein.

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**Firewall/IDS**

Lassen keine Ports durch und analysieren Pakete.

**-f** Um Pakete zu fragmentieren, fragmentiert es standardm√§√üig in 8 Bytes nach dem Header. Um diese Gr√∂√üe anzugeben, verwenden wir ..mtu (damit, nicht -f verwenden), der Offset muss ein Vielfaches von 8 sein. **Versionsscanner und Skripte unterst√ºtzen keine Fragmentierung.**

**-D decoy1,decoy2,ME** Nmap sendet Scanner, aber mit anderen IP-Adressen als Ursprung, auf diese Weise verstecken sie Sie. Wenn Sie ME in die Liste setzen, wird nmap Sie dort platzieren, es ist besser, 5 oder 6 vor Ihnen zu setzen, um Sie vollst√§ndig zu maskieren. Es k√∂nnen zuf√§llige IPs mit RND:\<nummer> generiert werden, um \<nummer> zuf√§llige IPs zu generieren. Sie funktionieren nicht mit Versionsdetektoren ohne TCP-Verbindung. Wenn Sie sich in einem Netzwerk befinden, ist es besser, aktive IPs zu verwenden, da es sonst sehr einfach sein wird, herauszufinden, dass Sie die einzige aktive sind.

Um zuf√§llige IPs zu verwenden: nmap-D RND: 10 Ziel\_IP

**-S IP** Wenn Nmap Ihre IP-Adresse nicht erfasst, m√ºssen Sie sie damit angeben. Es dient auch dazu, den Eindruck zu erwecken, dass ein anderes Ziel sie scannt.

**-e \<interface>** Um die Schnittstelle auszuw√§hlen.

Viele Administratoren lassen Eingangsports offen, damit alles ordnungsgem√§√ü funktioniert, und es ist einfacher f√ºr sie, als eine andere L√∂sung zu suchen. Dies k√∂nnen die DNS-Ports oder die FTP-Ports sein... um diese Schwachstelle zu suchen, integriert nmap: **--source-port** _**\<portnumber>**_**;-g** _**\<portnumber>**_ _Sind √§quivalent._

**--data** _**\<hex string>**_ Um hexadezimalen Text zu senden: --data 0xdeadbeef und --data \xCA\xFE\x09

**--data-string** _**\<string>**_ Um normalen Text zu senden: --data-string "Scan durchgef√ºhrt von Security Ops, Durchwahl 7192"

**--data-length** _**\<number>**_ Nmap sendet nur Header, mit diesem erreichen wir, dass eine bestimmte Anzahl von Bytes mehr hinzugef√ºgt wird (die zuf√§llig generiert werden).

Um das IP-Paket vollst√§ndig zu konfigurieren, verwenden Sie **--ip-options**.

Wenn Sie die Optionen in gesendeten und empfangenen Paketen sehen m√∂chten, geben Sie --packet-trace an. F√ºr weitere Informationen und Beispiele zur Verwendung von IP-Optionen mit Nmap siehe [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<value>**_

**--randomize-hosts** Damit der Angriff weniger offensichtlich ist.

**--spoof-mac** _**\<MAC-Adresse, Pr√§fix oder Herstellername>**_ Um die MAC zu √§ndern, Beispiele: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 und Cisco.

**--proxies** _**\<Komma-getrennte Liste von Proxy-URLs>**_ Um Proxys zu verwenden, manchmal h√§lt ein Proxy nicht so viele Verbindungen offen, wie nmap m√∂chte, daher m√ºsste das Parallelismus ge√§ndert werden: --max-parallelism.

**-sP** Um Hosts im Netzwerk, in dem wir uns befinden, √ºber ARP zu entdecken.

Viele Administratoren erstellen eine Regel in der Firewall, die es erlaubt, alle Pakete, die von einem bestimmten Port stammen (wie 20, 53 und 67), durchzulassen. Wir k√∂nnen nmap anweisen, unsere Pakete von diesen Ports zu senden: **nmap --source-port 53 IP**

**Ausgaben**

**-oN file** Normale Ausgabe

**-oX file** XML-Ausgabe

**-oS file** Ausgabe von Skript-Kiddies

**-oG file** Grepbare Ausgabe

**-oA file** Alle au√üer -oS

**-v level** Ausf√ºhrlichkeit

**-d level** Debugging

**--reason** Warum des Hosts und Status

**--stats-every time** Alle diese Zeit sagt uns, wie es l√§uft.

**--packet-trace** Um zu sehen, welche Pakete ausgehen, k√∂nnen Filter wie: --version-trace oder --script-trace angegeben werden.

**--open** zeigt die offenen, offenen|gefilterten und die nicht gefilterten an.

**--resume file** Gibt eine Zusammenfassung aus.

**Verschiedenes**

**-6** Erlaubt IPv6.

**-A** ist dasselbe wie -O -sV -sC --traceroute.

**Laufzeit**

W√§hrend nmap l√§uft, k√∂nnen wir Optionen √§ndern:

v / V Erh√∂hen / verringern Sie den Ausf√ºhrlichkeitsgrad.

d / D Erh√∂hen / verringern Sie den Debugging-Level.

p / P Aktivieren / Deaktivieren Sie die Paketverfolgung.

? Drucken Sie einen Hilfe-Bildschirm zur Laufzeitinteraktion.

**Vulscan**

Nmap-Skript, das die Versionen der Dienste in einer Offline-Datenbank √ºberpr√ºft (die von anderen sehr wichtigen heruntergeladen wird) und die m√∂glichen Schwachstellen zur√ºckgibt.

Die verwendeten Datenbanken sind:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Um es herunterzuladen und im Nmap-Ordner zu installieren:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Au√üerdem m√ºssten die Pakete der Datenbanken heruntergeladen und zu /usr/share/nmap/scripts/vulscan/ hinzugef√ºgt werden.

Verwendung:

Um alle zu verwenden: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

Um eine spezifische Datenbank zu verwenden: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR

## Nmap-Dienst-Scan um das 16-fache beschleunigen

Laut [**diesem Beitrag**](https://joshua.hu/nmap-speedup-service-scanning-16x) k√∂nnen Sie die Nmap-Dienstanalyse beschleunigen, indem Sie alle **`totalwaitms`**-Werte in **`/usr/share/nmap/nmap-service-probes`** auf **300** und **`tcpwrappedms`** auf **200** √§ndern.

Dar√ºber hinaus verwenden Proben, die keinen speziell definierten **`servicewaitms`** haben, einen Standardwert von **`5000`**. Daher k√∂nnen wir entweder Werte zu jeder der Proben hinzuf√ºgen oder wir k√∂nnen **nmap selbst kompilieren** und den Standardwert in [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79) √§ndern.

Wenn Sie die Werte von **`totalwaitms`** und **`tcpwrappedms`** im Datei `/usr/share/nmap/nmap-service-probes` √ºberhaupt nicht √§ndern m√∂chten, k√∂nnen Sie den [Parsing-Code](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) so √§ndern, dass diese Werte in der Datei `nmap-service-probes` vollst√§ndig ignoriert werden.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Lernen & √ºben Sie AWS-Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP-Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden. 

</details>
{% endhint %}
