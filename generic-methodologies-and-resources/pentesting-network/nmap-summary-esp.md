# Nmap Ã–zeti (ESP)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parametreler

### TarayÄ±cÄ± IP'leri

* **`<ip>,<net/mask>`:** IP'leri doÄŸrudan belirtir
* **`-iL <ips_file>`:** list\_IPs
* **`-iR <number>`**: Rastgele IP sayÄ±sÄ±, `--exclude <Ips>` veya `--excludefile <file>` ile olasÄ± IP'leri hariÃ§ tutabilirsiniz.

### Ekipman keÅŸfi

VarsayÄ±lan olarak Nmap, `-PA80 -PS443 -PE -PP` iÃ§eren bir keÅŸif aÅŸamasÄ± baÅŸlatÄ±r.

* **`-sL`**: Ä°nvaziv deÄŸildir, isimleri Ã§Ã¶zmek iÃ§in **DNS** istekleri yaparak hedefleri listeler. Ã–rneÄŸin www.prueba.es/24'te tÃ¼m IP'lerin hedeflerimiz olup olmadÄ±ÄŸÄ±nÄ± bilmek iÃ§in faydalÄ±dÄ±r.
* **`-Pn`**: **Ping yok**. Hepsinin aktif olduÄŸunu biliyorsanÄ±z faydalÄ±dÄ±r (deÄŸilse, Ã§ok zaman kaybedebilirsiniz, ancak bu seÃ§enek aynÄ± zamanda aktif olmadÄ±klarÄ±nÄ± sÃ¶yleyerek yanlÄ±ÅŸ negatifler de Ã¼retebilir), keÅŸif aÅŸamasÄ±nÄ± engeller.
* **`-sn`** : **Port taramasÄ± yok**. KeÅŸif aÅŸamasÄ±nÄ± tamamladÄ±ktan sonra portlarÄ± taramaz. GÃ¶receli olarak gizlidir ve kÃ¼Ã§Ã¼k bir aÄŸ taramasÄ±na izin verir. Yetkilerle 80'e bir ACK (-PA), 443'e bir SYN(-PS) ve bir yankÄ± isteÄŸi ve bir Zaman damgasÄ± isteÄŸi gÃ¶nderir, yetkisizse her zaman baÄŸlantÄ±larÄ± tamamlar. Hedef aÄŸsa, yalnÄ±zca ARP(-PR) kullanÄ±r. BaÅŸka bir seÃ§enekle kullanÄ±ldÄ±ÄŸÄ±nda, yalnÄ±zca diÄŸer seÃ§eneÄŸin paketleri dÃ¼ÅŸer.
* **`-PR`**: **Ping ARP**. AÄŸÄ±mÄ±zdaki bilgisayarlarÄ± analiz ederken varsayÄ±lan olarak kullanÄ±lÄ±r, ping kullanmaktan daha hÄ±zlÄ±dÄ±r. ARP paketlerini kullanmak istemiyorsanÄ±z `--send-ip` kullanÄ±n.
* **`-PS <ports>`**: SYN paketleri gÃ¶nderir, eÄŸer SYN/ACK ile yanÄ±t verirse aÃ§Ä±ktÄ±r (baÄŸlantÄ±yÄ± sonlandÄ±rmamak iÃ§in RST ile yanÄ±t verir), eÄŸer RST ile yanÄ±t verirse kapalÄ±dÄ±r ve eÄŸer yanÄ±t vermezse ulaÅŸÄ±lamazdÄ±r. Yetkiler yoksa, otomatik olarak tam bir baÄŸlantÄ± kullanÄ±lÄ±r. HiÃ§ port verilmezse, 80'e atar.
* **`-PA <ports>`**: Ã–ncekine benzer ama ACK ile, ikisini birleÅŸtirmek daha iyi sonuÃ§lar verir.
* **`-PU <ports>`**: AmaÃ§ tam tersidir, kapalÄ± olmasÄ± beklenen portlara gÃ¶nderilir. BazÄ± gÃ¼venlik duvarlarÄ± yalnÄ±zca TCP baÄŸlantÄ±larÄ±nÄ± kontrol eder. KapalÄ±ysa port ulaÅŸÄ±lamaz ile yanÄ±t verilir, baÅŸka bir icmp ile yanÄ±tlanÄ±rsa veya yanÄ±t verilmezse hedef ulaÅŸÄ±lamaz olarak bÄ±rakÄ±lÄ±r.
* **`-PE, -PP, -PM`** : ICMP PING'leri: yankÄ± yanÄ±tÄ±, zaman damgasÄ± ve adres maskesi. Hedefin aktif olup olmadÄ±ÄŸÄ±nÄ± Ã¶ÄŸrenmek iÃ§in gÃ¶nderilir.
* **`-PY<ports>`**: VarsayÄ±lan olarak 80'e SCTP INIT probeleri gÃ¶nderir, yanÄ±t olarak INIT-ACK(aÃ§Ä±k) veya ABORT(kapalÄ±) veya hiÃ§bir ÅŸey veya ICMP ulaÅŸÄ±lamaz (pasif) dÃ¶nebilir.
* **`-PO <protocols>`**: BaÅŸlÄ±klarda bir protokol belirtilir, varsayÄ±lan olarak 1(ICMP), 2(IGMP) ve 4(Encap IP). ICMP, IGMP, TCP (6) ve UDP (17) protokolleri iÃ§in protokol baÅŸlÄ±klarÄ± gÃ¶nderilir, diÄŸerleri iÃ§in yalnÄ±zca IP baÅŸlÄ±ÄŸÄ± gÃ¶nderilir. Bunun amacÄ±, baÅŸlÄ±klarÄ±n bozulmasÄ± nedeniyle, Protokol ulaÅŸÄ±lamaz veya aynÄ± protokolÃ¼n yanÄ±tlarÄ± ile yanÄ±t vererek aktif olup olmadÄ±ÄŸÄ±nÄ± bilmektir.
* **`-n`**: DNS yok
* **`-R`**: Her zaman DNS

### Port tarama teknikleri

* **`-sS`**: BaÄŸlantÄ±yÄ± tamamlamaz, bu nedenle iz bÄ±rakmaz, kullanÄ±lmasÄ± Ã§ok iyi. (yetkiler) VarsayÄ±lan olarak kullanÄ±lÄ±r.
* **`-sT`**: BaÄŸlantÄ±yÄ± tamamlar, bu nedenle iz bÄ±rakÄ±r, ancak kesinlikle kullanÄ±labilir. VarsayÄ±lan olarak yetkisizdir.
* **`-sU`**: Daha yavaÅŸ, UDP iÃ§in. Genellikle: DNS(53), SNMP(161,162), DHCP(67 ve 68), (-sU53,161,162,67,68): aÃ§Ä±k(yanÄ±t), kapalÄ±(port ulaÅŸÄ±lamaz), filtrelenmiÅŸ (baÅŸka bir ICMP), aÃ§Ä±k/filtrelenmiÅŸ (hiÃ§bir ÅŸey). AÃ§Ä±k/filtrelenmiÅŸ durumunda, -sV, nmap'in desteklediÄŸi herhangi bir sÃ¼rÃ¼mÃ¼ tespit etmek iÃ§in Ã§ok sayÄ±da istek gÃ¶nderir ve gerÃ§ek durumu tespit edebilir. ZamanÄ± Ã§ok artÄ±rÄ±r.
* **`-sY`**: SCTP protokolÃ¼ baÄŸlantÄ±yÄ± kurmada baÅŸarÄ±sÄ±z olur, bu nedenle gÃ¼nlÃ¼k kaydÄ± yoktur, -PY gibi Ã§alÄ±ÅŸÄ±r.
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, bazÄ± gÃ¼venlik duvarlarÄ±nÄ± geÃ§ebilir ve bilgi Ã§Ä±karabilir. Standart uyumlu makinelerin SYN, RST veya ACK gecikmesi olmayan tÃ¼m isteklere RST ile yanÄ±t vermesi gerektiÄŸi esasÄ±na dayanÄ±r: aÃ§Ä±k/filtrelenmiÅŸ(hiÃ§bir ÅŸey), kapalÄ±(RST), filtrelenmiÅŸ (ICMP ulaÅŸÄ±lamaz). Windows, Cisco, BSDI ve OS/400 Ã¼zerinde gÃ¼venilir deÄŸildir. Unix'te evet.
* **`-sM`**: Maimon taramasÄ±: FIN ve ACK bayraklarÄ± gÃ¶nderir, BSD iÃ§in kullanÄ±lÄ±r, ÅŸu anda hepsini kapalÄ± olarak dÃ¶necektir.
* **`-sA, sW`**: ACK ve Pencere, gÃ¼venlik duvarlarÄ±nÄ± tespit etmek iÃ§in kullanÄ±lÄ±r, portlarÄ±n filtrelenip filtrelenmediÄŸini bilmek iÃ§in. -sW, aÃ§Ä±k/kapalÄ± arasÄ±nda ayrÄ±m yapar Ã§Ã¼nkÃ¼ aÃ§Ä±k olanlar farklÄ± bir pencere deÄŸeri ile yanÄ±t verir: aÃ§Ä±k (0'dan farklÄ± bir pencere ile RST), kapalÄ± (RST pencere = 0), filtrelenmiÅŸ (ICMP ulaÅŸÄ±lamaz veya hiÃ§bir ÅŸey). TÃ¼m bilgisayarlar bu ÅŸekilde Ã§alÄ±ÅŸmaz, bu nedenle hepsi kapalÄ±ysa Ã§alÄ±ÅŸmÄ±yor demektir, az sayÄ±da aÃ§Ä±k varsa iyi Ã§alÄ±ÅŸÄ±yor demektir, ve Ã§ok sayÄ±da aÃ§Ä±k ve az sayÄ±da kapalÄ± varsa, tam tersi Ã§alÄ±ÅŸÄ±yor demektir.
* **`-sI`:** Idle taramasÄ±. Aktif bir gÃ¼venlik duvarÄ± varsa ancak belirli bir IP'yi filtrelemediÄŸini biliyorsak (veya sadece anonimlik istiyorsak) zombi tarayÄ±cÄ±yÄ± kullanabiliriz (tÃ¼m portlar iÃ§in Ã§alÄ±ÅŸÄ±r), olasÄ± zombileri aramak iÃ§in ipidseq veya exploit auxiliary/scanner/ip/ipidseq kullanabiliriz. Bu tarayÄ±cÄ±, IP paketlerinin IPID numarasÄ±na dayanÄ±r.
* **`--badsum`:** YanlÄ±ÅŸ toplam gÃ¶nderir, bilgisayarlar paketleri atar, ancak gÃ¼venlik duvarlarÄ± bir ÅŸey yanÄ±tlayabilir, gÃ¼venlik duvarlarÄ±nÄ± tespit etmek iÃ§in kullanÄ±lÄ±r.
* **`-sZ`:** "Garip" SCTP tarayÄ±cÄ±, cookie echo parÃ§alarÄ± ile probeler gÃ¶nderdiÄŸinde, aÃ§Ä±k olduÄŸunda atÄ±lmalÄ± veya kapalÄ± olduÄŸunda ABORT ile yanÄ±t verilmelidir. GeÃ§emediÄŸi gÃ¼venlik duvarlarÄ±ndan geÃ§ebilir, kÃ¶tÃ¼ olanÄ± ise filtrelenmiÅŸ ve aÃ§Ä±k arasÄ±nda ayrÄ±m yapmamaktadÄ±r.
* **`-sO`:** Protokol IP taramasÄ±. Bazen protokolÃ¼n bile ayÄ±rt edilemediÄŸi kÃ¶tÃ¼ ve boÅŸ baÅŸlÄ±klar gÃ¶nderir. ICMP ulaÅŸÄ±lamaz protokol gelirse kapalÄ±dÄ±r, ulaÅŸÄ±lamaz port gelirse aÃ§Ä±ktÄ±r, baÅŸka bir hata gelirse filtrelenmiÅŸ, hiÃ§bir ÅŸey gelmezse aÃ§Ä±k|filtrelenmiÅŸ.
* **`-b <server>`:** FTPhost--> BaÅŸka bir makineden bir hostu taramak iÃ§in kullanÄ±lÄ±r, bu, baÅŸka bir makinenin ftp'sine baÄŸlanarak ve taramak istediÄŸiniz portlara dosyalar gÃ¶ndermesini istemekle yapÄ±lÄ±r, yanÄ±tlarÄ±na gÃ¶re aÃ§Ä±k olup olmadÄ±klarÄ±nÄ± bileceÄŸiz. \[\<user>:\<password>@]\<server>\[:\<port>] Neredeyse tÃ¼m ftp sunucularÄ± artÄ±k bunu yapmanÄ±za izin vermiyor ve bu nedenle pratikte pek bir kullanÄ±mÄ± yok.

### **Analizi Merkezleme**

**-p:** Tarayacak portlarÄ± belirtmek iÃ§in kullanÄ±lÄ±r. 65335'i seÃ§mek iÃ§in: **-p-** veya **-p all**. Nmap, popÃ¼laritesine gÃ¶re dahili bir sÄ±ralama yapar. VarsayÄ±lan olarak 1000 ana portu kullanÄ±r. **-F** (hÄ±zlÄ± tarama) ile 100 ana portu analiz eder. **--top-ports \<sayÄ±>** Bu sayÄ±da ana portu analiz eder (1 ile 65335 arasÄ±nda). PortlarÄ± rastgele kontrol eder, bunun olmamasÄ± iÃ§in **-r** kullanÄ±lÄ±r. AyrÄ±ca portlarÄ± seÃ§ebiliriz: 20-30,80,443,1024- Bu sonuncusu 1024'ten itibaren bakmasÄ±nÄ± ifade eder. PortlarÄ± protokollere gÃ¶re gruplandÄ±rabiliriz: U:53,T:21-25,80,139,S:9. AyrÄ±ca nmap'in popÃ¼ler portlarÄ± arasÄ±nda bir aralÄ±k seÃ§ebiliriz: -p \[-1024] nmap-services'de dahil olan 1024'e kadar analiz eder. **--port-ratio \<oran>** 0 ile 1 arasÄ±nda olmalÄ±dÄ±r.

**-sV** SÃ¼rÃ¼m taramasÄ±, yoÄŸunluÄŸu 0'dan 9'a kadar ayarlayabiliriz, varsayÄ±lan 7'dir.

**--version-intensity \<sayÄ±>** YoÄŸunluÄŸu ayarlÄ±yoruz, daha dÃ¼ÅŸÃ¼k olduÄŸunda yalnÄ±zca en olasÄ± probeleri gÃ¶nderecektir, ancak hepsini deÄŸil. Bu, UDP tarama sÃ¼resini Ã¶nemli Ã¶lÃ§Ã¼de kÄ±saltabilir.

**-O** OS tespiti

**--osscan-limit** Bir hostu iyi taramak iÃ§in en az 1 aÃ§Ä±k ve 1 kapalÄ± port olmasÄ± gerekir, bu koÅŸul saÄŸlanmazsa ve bunu ayarladÄ±ysak, OS tahmini yapmaz (zaman tasarrufu saÄŸlar).

**--osscan-guess** OS tespiti mÃ¼kemmel olmadÄ±ÄŸÄ±nda daha fazla Ã§aba sarf etmesini saÄŸlar.

**Scriptler**

\--script _\<dosya adÄ±>_|_\<kategori>_|_\<dizin>_|_\<ifade>_\[,...]

VarsayÄ±lan olanlarÄ± kullanmak iÃ§in -sC veya --script=default yeterlidir.

Mevcut tÃ¼rler: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version ve vuln

* **Auth:** Kimlik doÄŸrulama iÃ§in mevcut tÃ¼m _script_leri Ã§alÄ±ÅŸtÄ±rÄ±r.
* **Default:** AraÃ§ iÃ§in varsayÄ±lan temel _script_leri Ã§alÄ±ÅŸtÄ±rÄ±r.
* **Discovery:** Hedef veya kurban hakkÄ±nda bilgi toplar.
* **External:** DÄ±ÅŸ kaynaklarÄ± kullanmak iÃ§in _script_.
* **Intrusive:** Kurban veya hedef iÃ§in mÃ¼dahaleci olarak kabul edilen _script_leri kullanÄ±r.
* **Malware:** KÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlar veya arka kapÄ±lar (backdoors) tarafÄ±ndan aÃ§Ä±k baÄŸlantÄ±larÄ± kontrol eder.
* **Safe:** MÃ¼dahale etmeyen _script_leri Ã§alÄ±ÅŸtÄ±rÄ±r.
* **Vuln:** En bilinen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± keÅŸfeder.
* **All:** Mevcut tÃ¼m NSE uzantÄ±lÄ± _script_leri Ã§alÄ±ÅŸtÄ±rÄ±r.

Script aramak iÃ§in:

**nmap --script-help="http-\*" -> http- ile baÅŸlayanlar**

**nmap --script-help="not intrusive" -> Bunlar hariÃ§ hepsi**

**nmap --script-help="default or safe" -> Birinde veya diÄŸerinde veya her ikisinde olanlar**

**nmap --script-help="default and safe" --> Her ikisinde olanlar**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<dosya adÄ±>_

\--script-help _\<dosya adÄ±>_|_\<kategori>_|_\<dizin>_|_\<ifade>_|all\[,...]

\--script-trace ---> Script'in nasÄ±l gittiÄŸine dair bilgi verir.

\--script-updatedb

**Bir script kullanmak iÃ§in sadece ÅŸunu yazmak yeterlidir: namp --script Script\_AdÄ± hedef** --> Script yazÄ±ldÄ±ÄŸÄ±nda hem script hem de tarayÄ±cÄ± Ã§alÄ±ÅŸtÄ±rÄ±lacak, bu nedenle tarayÄ±cÄ± seÃ§enekleri de eklenebilir, yalnÄ±zca gÃ¼venli olanlarÄ±n Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ± iÃ§in **â€œsafe=1â€** ekleyebiliriz.

**Zaman KontrolÃ¼**

**Nmap, zamanÄ± saniye, dakika, ms cinsinden deÄŸiÅŸtirebilir:** --host-timeout arguments 900000ms, 900, 900s ve 15m hepsi aynÄ± ÅŸeyi yapar.

Nmap, taranacak toplam host sayÄ±sÄ±nÄ± gruplara ayÄ±rÄ±r ve bu gruplarÄ± bloklar halinde analiz eder, bÃ¶ylece tÃ¼m gruplar analiz edilmeden bir sonraki bloÄŸa geÃ§mez (ve kullanÄ±cÄ± da bir blok analiz edilene kadar herhangi bir gÃ¼ncelleme almaz) bu ÅŸekilde, nmap'in bÃ¼yÃ¼k gruplar kullanmasÄ± daha optimaldir. VarsayÄ±lan olarak sÄ±nÄ±f C'de 256 kullanÄ±r.

**--min-hostgroup** _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Paralel tarama grup boyutlarÄ±nÄ± ayarlayÄ±n)

Paralel tarayÄ±cÄ± sayÄ±sÄ±nÄ± kontrol edebiliriz ama bunu yapmamak daha iyidir (nmap, aÄŸ durumuna gÃ¶re otomatik kontrol iÃ§erir): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

RTT zaman aÅŸÄ±mÄ±nÄ± deÄŸiÅŸtirebiliriz, ancak genellikle gerekli deÄŸildir: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

Deneme sayÄ±sÄ±nÄ± deÄŸiÅŸtirebiliriz:**--max-retries** _**\<numtries>**_

Bir hostun tarama sÃ¼resini deÄŸiÅŸtirebiliriz: **--host-timeout** _**\<time>**_

Her deneme arasÄ±nda yavaÅŸ gitmesi iÃ§in sÃ¼reyi deÄŸiÅŸtirebiliriz: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

Saniyede gÃ¶nderilen paket sayÄ±sÄ±nÄ± deÄŸiÅŸtirebiliriz: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

BirÃ§ok port, filtrelenmiÅŸ veya kapalÄ± olduÄŸunda yanÄ±t vermekte uzun sÃ¼rer, eÄŸer yalnÄ±zca aÃ§Ä±k olanlarla ilgileniyorsak, daha hÄ±zlÄ± gidebiliriz: **--defeat-rst-ratelimit**

Nmap'in ne kadar agresif olmasÄ±nÄ± istediÄŸimizi tanÄ±mlamak iÃ§in: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> Sadece 1 port taranÄ±r ve bir sonraki iÃ§in 5 dakika beklenir.

\-T1 ve T2 --> Ã‡ok benzerler ama her deneme arasÄ±nda sÄ±rasÄ±yla 15 ve 0,4 saniye beklerler.

\-T3 --> VarsayÄ±lan Ã§alÄ±ÅŸma, paralel iÃ§erir.

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**GÃ¼venlik DuvarÄ±/IDS**

PortlarÄ± geÃ§iÅŸine izin vermez ve paketleri analiz eder.

**-f** Paketleri parÃ§alara ayÄ±rmak iÃ§in, varsayÄ±lan olarak baÅŸlÄ±ktan sonra 8 baytlÄ±k parÃ§alara ayÄ±rÄ±r, bu boyutu belirtmek iÃ§in ..mtu kullanÄ±rÄ±z (bunu yaparken -f kullanmayÄ±n), offset 8'in katÄ± olmalÄ±dÄ±r. **SÃ¼rÃ¼m tarayÄ±cÄ±larÄ± ve scriptler parÃ§alamayÄ± desteklemez.**

**-D decoy1,decoy2,ME** Nmap tarayÄ±cÄ±larÄ± gÃ¶nderir ancak baÅŸka IP adresleri ile kaynak olarak, bu ÅŸekilde sizi gizler. Listede ME'yi eklerseniz, nmap sizi oraya yerleÅŸtirir, tamamen gizlenmek iÃ§in Ã¶nÃ¼nÃ¼ze 5 veya 6 tane koymak daha iyidir. Rastgele IP'ler oluÅŸturmak iÃ§in RND:\<sayÄ±> kullanabilirsiniz. \<sayÄ±> kadar rastgele IP oluÅŸturur. TCP baÄŸlantÄ±sÄ± olmadan sÃ¼rÃ¼m tespit cihazlarÄ± ile Ã§alÄ±ÅŸmaz. EÄŸer bir aÄŸ iÃ§indeyseniz, aktif olan IP'leri kullanmak Ã¶nemlidir, aksi takdirde tek aktif olduÄŸunuzu anlamak Ã§ok kolay olacaktÄ±r.

Rastgele IP'ler kullanmak iÃ§in: nmap-D RND: 10 Hedef\_IP

**-S IP** Nmap IP adresinizi yakalayamazsa vermeniz gereken ÅŸeydir. AyrÄ±ca baÅŸka bir hedefin tarandÄ±ÄŸÄ± izlenimini vermek iÃ§in de kullanÄ±lÄ±r.

**-e \<arayÃ¼z>** ArayÃ¼zÃ¼ seÃ§mek iÃ§in.

BirÃ§ok yÃ¶netici, her ÅŸeyin dÃ¼zgÃ¼n Ã§alÄ±ÅŸmasÄ± iÃ§in aÃ§Ä±k giriÅŸ portlarÄ± bÄ±rakÄ±r ve baÅŸka bir Ã§Ã¶zÃ¼m aramaktan daha kolaydÄ±r. Bunlar DNS veya FTP portlarÄ± olabilir... Bu gÃ¼venlik aÃ§Ä±ÄŸÄ±nÄ± aramak iÃ§in nmap ÅŸunlarÄ± iÃ§erir: **--source-port** _**\<portnumber>**_**;-g** _**\<portnumber>**_ _EÅŸdeÄŸerdir._

**--data** _**\<hex string>**_ Hexadecimal metin gÃ¶ndermek iÃ§in: --data 0xdeadbeef ve --data \xCA\xFE\x09

**--data-string** _**\<string>**_ Normal metin gÃ¶ndermek iÃ§in: --data-string "GÃ¼venlik OperasyonlarÄ± tarafÄ±ndan gerÃ§ekleÅŸtirilen tarama, uzantÄ± 7192"

**--data-length** _**\<sayÄ±>**_ Nmap yalnÄ±zca baÅŸlÄ±klar gÃ¶nderir, bununla birlikte, buna ek olarak rastgele olarak oluÅŸturulacak bir bayt sayÄ±sÄ± ekler.

IP paketini tamamen yapÄ±landÄ±rmak iÃ§in **--ip-options** kullanÄ±n.

GÃ¶nderilen ve alÄ±nan paketlerdeki seÃ§enekleri gÃ¶rmek istiyorsanÄ±z, --packet-trace belirtin. Nmap ile IP seÃ§eneklerini kullanma hakkÄ±nda daha fazla bilgi ve Ã¶rnekler iÃ§in [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52) adresine bakÄ±n.

**--ttl** _**\<deÄŸer>**_

**--randomize-hosts** SaldÄ±rÄ±nÄ±n daha az belirgin olmasÄ± iÃ§in.

**--spoof-mac** _**\<MAC adresi, Ã¶n ek veya satÄ±cÄ± adÄ±>**_ MAC'i deÄŸiÅŸtirmek iÃ§in Ã¶rnekler: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 ve Cisco.

**--proxies** _**\<VirgÃ¼lle ayrÄ±lmÄ±ÅŸ proxy URL'leri listesi>**_ Proxy kullanmak iÃ§in, bazen bir proxy nmap'in istediÄŸi kadar aÃ§Ä±k baÄŸlantÄ± tutmaz, bu nedenle paralelliÄŸi deÄŸiÅŸtirmek gerekebilir: --max-parallelism.

**-sP** ARP ile bulunduÄŸumuz aÄŸdaki hostlarÄ± keÅŸfetmek iÃ§in.

BirÃ§ok yÃ¶netici, belirli bir porttan (20, 53 ve 67 gibi) gelen tÃ¼m paketlerin geÃ§mesine izin veren bir gÃ¼venlik duvarÄ± kuralÄ± oluÅŸturur, nmap'e bu portlardan paket gÃ¶ndermesini sÃ¶yleyebiliriz: **nmap --source-port 53 Hedef_IP**

**Ã‡Ä±ktÄ±lar**

**-oN dosya** Normal Ã§Ä±ktÄ±.

**-oX dosya** XML Ã§Ä±ktÄ±sÄ±.

**-oS dosya** Script kiddie Ã§Ä±ktÄ±sÄ±.

**-oG dosya** Grep'lenebilir Ã§Ä±ktÄ±.

**-oA dosya** Hepsi -oS hariÃ§.

**-v seviye** ayrÄ±ntÄ± seviyesi.

**-d seviye** hata ayÄ±klama.

**--reason** Host ve durumun nedeni.

**--stats-every zaman** Bu sÃ¼re zarfÄ±nda ne durumda olduÄŸumuzu sÃ¶yler.

**--packet-trace** Hangi paketlerin Ã§Ä±ktÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in, --version-trace veya --script-trace gibi filtreler belirtilebilir.

**--open** aÃ§Ä±k olanlarÄ±, aÃ§Ä±k|filtrelenmiÅŸ ve filtrelenmemiÅŸ olanlarÄ± gÃ¶sterir.

**--resume dosya** Bir Ã¶zet Ã§Ä±karÄ±r.

**Ã‡eÅŸitli**

**-6** IPv6'yÄ± etkinleÅŸtirir.

**-A** -O -sV -sC --traceroute ile aynÄ±dÄ±r.

**Ã‡alÄ±ÅŸma SÃ¼resi**

Nmap Ã§alÄ±ÅŸÄ±rken seÃ§enekleri deÄŸiÅŸtirebiliriz:

v / V AyrÄ±ntÄ± seviyesini artÄ±rma / azaltma.

d / D Hata ayÄ±klama seviyesini artÄ±rma / azaltma.

p / P Paket izlemeyi aÃ§ma / kapama.

? Ã‡alÄ±ÅŸma zamanÄ± etkileÅŸimi yardÄ±m ekranÄ±nÄ± yazdÄ±rÄ±r.

**Vulscan**

Nmap script'i, elde edilen hizmetlerin sÃ¼rÃ¼mlerini Ã§evrimdÄ±ÅŸÄ± bir veritabanÄ±nda (diÄŸer Ã¶nemli veritabanlarÄ±ndan indirir) kontrol eder ve olasÄ± gÃ¼venlik aÃ§Ä±klarÄ±nÄ± dÃ¶ndÃ¼rÃ¼r.

KullandÄ±ÄŸÄ± veritabanlarÄ±:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Bunu indirmek ve Nmap klasÃ¶rÃ¼ne kurmak iÃ§in:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

AyrÄ±ca veritabanlarÄ±nÄ±n paketlerini indirip /usr/share/nmap/scripts/vulscan/ dizinine eklemek gerekir.

KullanÄ±m:

Hepsini kullanmak iÃ§in: sudo nmap -sV --script=vulscan TARANACAK\_HOST

Belirli bir veritabanÄ±nÄ± kullanmak iÃ§in: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv TARANACAK\_HOST

## Nmap Servis TaramasÄ±nÄ± x16 HÄ±zlandÄ±rma

[**Bu gÃ¶nderiye**](https://joshua.hu/nmap-speedup-service-scanning-16x) gÃ¶re, nmap servis analizini hÄ±zlandÄ±rmak iÃ§in **`/usr/share/nmap/nmap-service-probes`** dosyasÄ±ndaki tÃ¼m **`totalwaitms`** deÄŸerlerini **300** ve **`tcpwrappedms`** deÄŸerini **200** olarak deÄŸiÅŸtirebilirsiniz.

AyrÄ±ca, belirli bir **`servicewaitms`** tanÄ±mlanmamÄ±ÅŸ probeler varsayÄ±lan olarak **`5000`** deÄŸerini kullanÄ±r. Bu nedenle, her bir probeye deÄŸer ekleyebiliriz veya **nmap'i** kendimiz derleyip [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79) dosyasÄ±ndaki varsayÄ±lan deÄŸeri deÄŸiÅŸtirebiliriz.

EÄŸer **`totalwaitms`** ve **`tcpwrappedms`** deÄŸerlerini `/usr/share/nmap/nmap-service-probes` dosyasÄ±nda hiÃ§ deÄŸiÅŸtirmek istemiyorsanÄ±z, bu deÄŸerlerin `nmap-service-probes` dosyasÄ±nda tamamen gÃ¶z ardÄ± edilmesi iÃ§in [parsing kodunu](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) dÃ¼zenleyebilirsiniz.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n veya **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
