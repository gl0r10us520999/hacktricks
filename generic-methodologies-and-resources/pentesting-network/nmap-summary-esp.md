# Nmap Summary (ESP)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Παράμετροι

### IPs προς σάρωση

* **`<ip>,<net/mask>`:** Υποδεικνύει τις ips άμεσα
* **`-iL <ips_file>`:** list\_IPs
* **`-iR <number>`**: Αριθμός τυχαίων Ips, μπορείτε να εξαιρέσετε πιθανές Ips με `--exclude <Ips>` ή `--excludefile <file>`.

### Ανακάλυψη εξοπλισμού

Από προεπιλογή, το Nmap εκκινεί μια φάση ανακάλυψης που αποτελείται από: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Δεν είναι επεμβατικό, καταγράφει τους στόχους κάνοντας **DNS** αιτήσεις για την επίλυση ονομάτων. Είναι χρήσιμο για να γνωρίζετε αν για παράδειγμα www.prueba.es/24 όλες οι Ips είναι οι στόχοι μας.
* **`-Pn`**: **Χωρίς ping**. Αυτό είναι χρήσιμο αν γνωρίζετε ότι όλοι είναι ενεργοί (αν όχι, θα μπορούσατε να χάσετε πολύ χρόνο, αλλά αυτή η επιλογή παράγει επίσης ψευδώς αρνητικά λέγοντας ότι δεν είναι ενεργοί), αποτρέπει τη φάση ανακάλυψης.
* **`-sn`** : **Χωρίς σάρωση θυρών**. Μετά την ολοκλήρωση της φάσης αναγνώρισης, δεν σαρώνει τις θύρες. Είναι σχετικά αθόρυβο και επιτρέπει μια μικρή σάρωση δικτύου. Με προνόμια στέλνει ένα ACK (-PA) σε 80, ένα SYN(-PS) σε 443 και ένα αίτημα echo και ένα αίτημα Timestamp, χωρίς προνόμια ολοκληρώνει πάντα τις συνδέσεις. Αν ο στόχος είναι το δίκτυο, χρησιμοποιεί μόνο ARP(-PR). Αν χρησιμοποιηθεί με άλλη επιλογή, μόνο τα πακέτα της άλλης επιλογής απορρίπτονται.
* **`-PR`**: **Ping ARP**. Χρησιμοποιείται από προεπιλογή κατά την ανάλυση υπολογιστών στο δίκτυό μας, είναι ταχύτερο από τη χρήση pings. Αν δεν θέλετε να χρησιμοποιήσετε πακέτα ARP, χρησιμοποιήστε `--send-ip`.
* **`-PS <ports>`**: Στέλνει SYN πακέτα στα οποία αν απαντήσει SYN/ACK είναι ανοιχτό (σε αυτό που απαντά με RST ώστε να μην τερματίσει τη σύνδεση), αν απαντήσει RST είναι κλειστό και αν δεν απαντήσει είναι μη προσβάσιμο. Σε περίπτωση που δεν έχετε προνόμια, χρησιμοποιείται αυτόματα μια συνολική σύνδεση. Αν δεν δοθούν θύρες, το ρίχνει σε 80.
* **`-PA <ports>`**: Όπως το προηγούμενο αλλά με ACK, συνδυάζοντας και τα δύο δίνει καλύτερα αποτελέσματα.
* **`-PU <ports>`**: Ο στόχος είναι το αντίθετο, αποστέλλονται σε θύρες που αναμένονται να είναι κλειστές. Ορισμένα τείχη προστασίας ελέγχουν μόνο τις TCP συνδέσεις. Αν είναι κλειστό απαντά με μη προσβάσιμη θύρα, αν απαντηθεί με άλλο icmp ή δεν απαντηθεί, μένει ως μη προσβάσιμος προορισμός.
* **`-PE, -PP, -PM`** : ICMP PINGS: echo replay, timestamp και addresmask. Εκτοξεύονται για να διαπιστωθεί αν ο στόχος είναι ενεργός.
* **`-PY<ports>`**: Στέλνει SCTP INIT probes σε 80 από προεπιλογή, INIT-ACK(ανοιχτό) ή ABORT(κλειστό) ή τίποτα ή ICMP μη προσβάσιμο (ανενεργό) μπορεί να απαντηθεί.
* **`-PO <protocols>`**: Υποδεικνύεται ένα πρωτόκολλο στα headers, από προεπιλογή 1(ICMP), 2(IGMP) και 4(Encap IP). Για τα πρωτόκολλα ICMP, IGMP, TCP (6) και UDP (17) αποστέλλονται τα headers του πρωτοκόλλου, για τα υπόλοιπα αποστέλλεται μόνο το IP header. Ο σκοπός αυτού είναι ότι λόγω της κακής μορφοποίησης των headers, απαντώνται μη προσβάσιμα πρωτόκολλα ή απαντήσεις του ίδιου πρωτοκόλλου για να γνωρίζουμε αν είναι ενεργό.
* **`-n`**: Χωρίς DNS
* **`-R`**: DNS πάντα

### Τεχνικές σάρωσης θυρών

* **`-sS`**: Δεν ολοκληρώνει τη σύνδεση, οπότε δεν αφήνει ίχνη, πολύ καλό αν μπορεί να χρησιμοποιηθεί.(προνόμια) Είναι αυτό που χρησιμοποιείται από προεπιλογή.
* **`-sT`**: Ολοκληρώνει τη σύνδεση, οπότε αφήνει ίχνη, αλλά μπορεί να χρησιμοποιηθεί σίγουρα. Από προεπιλογή χωρίς προνόμια.
* **`-sU`**: Αργότερα, για UDP. Κυρίως: DNS(53), SNMP(161,162), DHCP(67 και 68), (-sU53,161,162,67,68): ανοιχτό(απάντηση), κλειστό(μη προσβάσιμη θύρα), φιλτραρισμένο (άλλο ICMP), ανοιχτό/φιλτραρισμένο (τίποτα). Σε περίπτωση ανοιχτού/φιλτραρισμένου, -sV στέλνει πολλές αιτήσεις για να ανιχνεύσει οποιαδήποτε από τις εκδόσεις που υποστηρίζει το nmap και μπορεί να ανιχνεύσει την πραγματική κατάσταση. Αυξάνει πολύ τον χρόνο.
* **`-sY`**: Το πρωτόκολλο SCTP αποτυγχάνει να καθιερώσει τη σύνδεση, οπότε δεν υπάρχουν αρχεία καταγραφής, λειτουργεί όπως το -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, μπορούν να διεισδύσουν σε ορισμένα τείχη προστασίας και να εξάγουν πληροφορίες. Βασίζονται στο γεγονός ότι οι μηχανές που συμμορφώνονται με τα πρότυπα θα πρέπει να απαντούν με RST σε όλα τα αιτήματα που δεν έχουν SYN, RST ή ACK καθυστερήσεις: ανοιχτό/φιλτραρισμένο(τίποτα), κλειστό(RST), φιλτραρισμένο (ICMP μη προσβάσιμο). Αναξιόπιστο σε Windows, Cisco, BSDI και OS/400. Σε unix ναι.
* **`-sM`**: Maimon scan: Στέλνει FIN και ACK flags, χρησιμοποιείται για BSD, αυτή τη στιγμή θα επιστρέψει όλα ως κλειστά.
* **`-sA, sW`**: ACK και Window, χρησιμοποιείται για την ανίχνευση τειχών προστασίας, για να γνωρίζουμε αν οι θύρες είναι φιλτραρισμένες ή όχι. Το -sW διακρίνει μεταξύ ανοιχτών/κλειστών καθώς οι ανοιχτές απαντούν με διαφορετική τιμή παραθύρου: ανοιχτό (RST με παράθυρο διαφορετικό από 0), κλειστό (RST παράθυρο = 0), φιλτραρισμένο (ICMP μη προσβάσιμο ή τίποτα). Όλοι οι υπολογιστές δεν λειτουργούν με αυτόν τον τρόπο, οπότε αν είναι όλα κλειστά, δεν λειτουργεί, αν είναι λίγα ανοιχτά, λειτουργεί καλά, και αν είναι πολλά ανοιχτά και λίγα κλειστά, λειτουργεί αντίστροφα.
* **`-sI`:** Idle scan. Για τις περιπτώσεις στις οποίες υπάρχει ένα ενεργό τείχος προστασίας αλλά γνωρίζουμε ότι δεν φιλτράρει σε μια συγκεκριμένη Ip (ή όταν απλά θέλουμε ανωνυμία) μπορούμε να χρησιμοποιήσουμε τον zombie scanner (λειτουργεί για όλες τις θύρες), για να αναζητήσουμε πιθανά zombies μπορούμε να χρησιμοποιήσουμε το scrpit ipidseq ή το exploit auxiliary/scanner/ip/ipidseq. Αυτός ο σαρωτής βασίζεται στον αριθμό IPID των πακέτων IP.
* **`--badsum`:** Στέλνει τη λανθασμένη αθροιστική τιμή, οι υπολογιστές θα απορρίψουν τα πακέτα, αλλά τα τείχη προστασίας θα μπορούσαν να απαντήσουν κάτι, χρησιμοποιείται για την ανίχνευση τειχών προστασίας.
* **`-sZ`:** "Weird" SCTP scanner, όταν στέλνει probes με cookie echo fragments θα πρέπει να απορριφθούν αν είναι ανοιχτά ή να απαντηθούν με ABORT αν είναι κλειστά. Μπορεί να περάσει μέσα από τείχη προστασίας που δεν περνάει το init, το κακό είναι ότι δεν διακρίνει μεταξύ φιλτραρισμένων και ανοιχτών.
* **`-sO`:** Σάρωση πρωτοκόλλου Ip. Στέλνει κακά και κενά headers στα οποία μερικές φορές δεν μπορεί να διακριθεί ούτε το πρωτόκολλο. Αν φτάσει μη προσβάσιμο πρωτόκολλο ICMP είναι κλειστό, αν φτάσει μη προσβάσιμη θύρα είναι ανοιχτό, αν φτάσει άλλο σφάλμα, φιλτραρισμένο, αν δεν φτάσει τίποτα, ανοιχτό|φιλτραρισμένο.
* **`-b <server>`:** FTPhost--> Χρησιμοποιείται για να σαρώσει έναν host από έναν άλλο, αυτό γίνεται συνδέοντας το ftp μιας άλλης μηχανής και ζητώντας της να στείλει αρχεία στις θύρες που θέλετε να σαρώσετε από μια άλλη μηχανή, ανάλογα με τις απαντήσεις θα γνωρίζουμε αν είναι ανοιχτές ή όχι. \[\<user>:\<password>@]\<server>\[:\<port>] Σχεδόν όλοι οι ftps servers δεν σας επιτρέπουν πλέον να το κάνετε αυτό και επομένως είναι ελάχιστα πρακτικό.

### **Κεντρική ανάλυση**

**-p:** Χρησιμεύει για να δώσει τις θύρες προς σάρωση. Για να επιλέξετε τις 65335: **-p-** ή **-p all**. Το nmap έχει μια εσωτερική κατάταξη σύμφωνα με τη δημοτικότητα του. Από προεπιλογή χρησιμοποιεί τις 1000 κύριες. Με **-F** (γρήγορη σάρωση) αναλύει τις 100 κύριες. Με **--top-ports \<number>** αναλύει αυτόν τον αριθμό κύριων (από 1 έως 65335). Ελέγχει τις θύρες με τυχαία σειρά, για να μην συμβαίνει αυτό **-r**. Μπορούμε επίσης να επιλέξουμε θύρες: 20-30,80,443,1024- Αυτό το τελευταίο σημαίνει ότι κοιτάζει μπροστά από το 1024. Μπορούμε επίσης να ομαδοποιήσουμε τις θύρες κατά πρωτόκολλα: U:53,T:21-25,80,139,S:9. Μπορούμε επίσης να επιλέξουμε ένα εύρος μέσα από τις δημοφιλείς θύρες του nmap: -p \[-1024] αναλύει μέχρι το 1024 από τις συμπεριλαμβανόμενες στο nmap-services. **--port-ratio \<ratio>** αναλύει τις πιο κοινές θύρες που έχουν ένα ποσοστό που πρέπει να είναι μεταξύ 0 και 1.

**-sV** Σάρωση έκδοσης, μπορεί να ρυθμιστεί η ένταση από 0 έως 9, από προεπιλογή 7.

**--version-intensity \<number>** Ρυθμίζουμε την ένταση, έτσι ώστε όσο πιο χαμηλή είναι, θα εκτοξεύει μόνο τις πιο πιθανές sondas, αλλά όχι όλες. Με αυτό μπορούμε να μειώσουμε σημαντικά τον χρόνο σάρωσης UDP.

**-O** Ανίχνευση os.

**--osscan-limit** Για να σαρώσετε σωστά έναν host χρειάζεται τουλάχιστον 1 ανοιχτή και άλλη κλειστή θύρα, αν δεν πληρείται αυτή η προϋπόθεση και έχουμε βάλει αυτό, δεν προσπαθεί να κάνει πρόβλεψη os (εξοικονομεί χρόνο).

**--osscan-guess** Όταν η ανίχνευση os δεν είναι τέλεια, αυτό το κάνει να προσπαθήσει περισσότερο.

**Scripts**

\--script _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_\[,...]

Για να χρησιμοποιήσετε τα προεπιλεγμένα, αρκεί το -sC ή --script=default.

Οι τύποι που υπάρχουν είναι: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, και vuln.

* **Auth:** εκτελεί όλα τα διαθέσιμα _scripts_ για αυθεντικοποίηση.
* **Default:** εκτελεί τα βασικά _scripts_ προεπιλογής του εργαλείου.
* **Discovery:** ανακτά πληροφορίες από το _target_ ή θύμα.
* **External:** _script_ για τη χρήση εξωτερικών πόρων.
* **Intrusive:** χρησιμοποιεί _scripts_ που θεωρούνται επεμβατικά για το θύμα ή _target_.
* **Malware:** ελέγχει αν υπάρχουν ανοιχτές συνδέσεις από κακόβουλους κωδικούς ή _backdoors_ (πίσω πόρτες).
* **Safe:** εκτελεί _scripts_ που δεν είναι επεμβατικά.
* **Vuln:** ανακαλύπτει τις πιο γνωστές ευπάθειες.
* **All:** εκτελεί απολύτως όλα τα _scripts_ με επέκταση NSE διαθέσιμα.

Για να αναζητήσετε scripts:

**nmap --script-help="http-\*" -> Αυτά που αρχίζουν με http-**

**nmap --script-help="not intrusive" -> Όλα εκτός από αυτά**

**nmap --script-help="default or safe" -> Αυτά που είναι σε ένα ή σε άλλο ή και στα δύο**

**nmap --script-help="default and safe" --> Αυτά που είναι και στα δύο**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<filename>_

\--script-help _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_|all\[,...]

\--script-trace ---> Δίνει πληροφορίες για το πώς πηγαίνει το script.

\--script-updatedb

**Για να χρησιμοποιήσετε ένα script, απλά πρέπει να βάλετε: namp --script Όνομα\_του\_script στόχος** --> Όταν βάλετε το script, θα εκτελούνται τόσο το script όσο και ο σαρωτής, οπότε μπορείτε επίσης να βάλετε επιλογές του σαρωτή, μπορούμε να προσθέσουμε **“safe=1”** ώστε να εκτελούνται μόνο αυτά που είναι ασφαλή.

**Έλεγχος χρόνου**

**Το Nmap μπορεί να τροποποιήσει το χρόνο σε δευτερόλεπτα, λεπτά, ms:** --host-timeout arguments 900000ms, 900, 900s, και 15m όλα κάνουν το ίδιο πράγμα.

Το Nmap διαιρεί τον συνολικό αριθμό των hosts προς σάρωση σε ομάδες και αναλύει αυτές τις ομάδες σε μπλοκ, έτσι ώστε μέχρι να έχουν αναλυθεί όλοι, να μην περνά στο επόμενο μπλοκ (και ο χρήστης δεν λαμβάνει καμία ενημέρωση μέχρι να έχει αναλυθεί το μπλοκ) με αυτόν τον τρόπο, είναι πιο βέλτιστο για το nmap να χρησιμοποιεί μεγάλες ομάδες. Από προεπιλογή στην κλάση C χρησιμοποιεί 256.

Μπορείτε να το αλλάξετε με **--min-hostgroup** _**\<numhosts>**_; **--max-hostgroup** _**\<numhosts>**_ (Ρυθμίστε τα μεγέθη ομάδας παράλληλης σάρωσης).

Μπορείτε να ελέγξετε τον αριθμό των σαρωτών σε παράλληλη λειτουργία, αλλά είναι καλύτερα να μην το κάνετε (το nmap ήδη ενσωματώνει αυτόματο έλεγχο με βάση την κατάσταση του δικτύου): **--min-parallelism** _**\<numprobes>**_; **--max-parallelism** _**\<numprobes>**_.

Μπορούμε να τροποποιήσουμε το rtt timeout, αλλά συνήθως δεν είναι απαραίτητο: **--min-rtt-timeout** _**\<time>**_, **--max-rtt-timeout** _**\<time>**_, **--initial-rtt-timeout** _**\<time>**_.

Μπορούμε να τροποποιήσουμε τον αριθμό των προσπαθειών:**--max-retries** _**\<numtries>**_.

Μπορούμε να τροποποιήσουμε το χρόνο σάρωσης ενός host: **--host-timeout** _**\<time>**_.

Μπορούμε να τροποποιήσουμε το χρόνο μεταξύ κάθε δοκιμής για να πηγαίνει αργά: **--scan-delay** _**\<time>**_; **--max-scan-delay** _**\<time>**_.

Μπορούμε να τροποποιήσουμε τον αριθμό πακέτων ανά δευτερόλεπτο: **--min-rate** _**\<number>**_; **--max-rate** _**\<number>**_.

Πολλές θύρες αργούν πολύ να απαντήσουν λόγω φιλτραρίσματος ή κλεισίματος, αν μας ενδιαφέρουν μόνο οι ανοιχτές, μπορούμε να πάμε πιο γρήγορα με: **--defeat-rst-ratelimit**.

Για να καθορίσουμε πόσο επιθετικό θέλουμε να είναι το nmap: -T paranoid|sneaky|polite|normal|aggressive|insane.

\-T (0-1).

\-T0 --> Σαρώνονται μόνο 1 θύρα τη φορά και περιμένει 5 λεπτά μέχρι την επόμενη.

\-T1 και T2 --> Πολύ παρόμοια αλλά περιμένουν μόνο 15 και 0,4 δευτερόλεπτα αντίστοιχα μεταξύ κάθε δοκιμής.

\-T3 --> Λειτουργία προεπιλογής, περιλαμβάνει παράλληλα.

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms.

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms.

**Τείχος προστασίας/IDS**

Δεν επιτρέπουν την πρόσβαση σε θύρες και αναλύουν πακέτα.

**-f** Για να θραύσει πακέτα, από προεπιλογή τα θραύει σε 8bytes μετά από την κεφαλίδα, για να καθορίσετε αυτό το μέγεθος χρησιμοποιούμε ..mtu (με αυτό, μην χρησιμοποιείτε -f), η απόσταση πρέπει να είναι πολλαπλάσιο του 8. **Οι σαρωτές έκδοσης και τα scripts δεν υποστηρίζουν τη θραύση.**

**-D decoy1,decoy2,ME** Το Nmap στέλνει σαρωτές αλλά με άλλες διευθύνσεις IP ως προέλευση, με αυτόν τον τρόπο σας κρύβει. Αν βάλετε το ME στη λίστα, το nmap θα σας τοποθετήσει εκεί, καλύτερα να βάλετε 5 ή 6 πριν από εσάς για να σας καλύψουν εντελώς. Μπορούν να παραχθούν τυχαίες iPs με RND:\<number> Για να παραχθούν \<number> τυχαίες Ips. Δεν λειτουργούν με ανιχνευτές εκδόσεων χωρίς σύνδεση TCP. Αν είστε μέσα σε ένα δίκτυο, σας ενδιαφέρει να χρησιμοποιήσετε Ips που είναι ενεργές, αλλιώς θα είναι πολύ εύκολο να ανακαλύψουν ότι είστε ο μόνος ενεργός.

Για να χρησιμοποιήσετε τυχαίες Ips: nmap-D RND: 10 Ip\_στόχος.

**-S IP** Για όταν το Nmap δεν πιάνει τη διεύθυνση Ip σας, πρέπει να της δώσετε με αυτό. Χρησιμεύει επίσης για να κάνει να φαίνεται ότι υπάρχει άλλος στόχος που σας σαρώσει.

**-e \<interface>** Για να επιλέξετε τη διεπαφή.

Πολλοί διαχειριστές αφήνουν ανοιχτές θύρες εισόδου για να λειτουργούν όλα σωστά και τους είναι πιο εύκολο από το να αναζητήσουν άλλη λύση. Αυτές μπορεί να είναι οι θύρες DNS ή οι FTP... για να αναζητήσουν αυτήν την ευπάθεια, το nmap ενσωματώνει: **--source-port** _**\<portnumber>**_**;-g** _**\<portnumber>**_ _Είναι ισοδύναμα._

**--data** _**\<hex string>**_ Για να στείλετε κείμενο σε δεκαεξαδική μορφή: --data 0xdeadbeef και --data \xCA\xFE\x09.

**--data-string** _**\<string>**_ Για να στείλετε κανονικό κείμενο: --data-string "Scan conducted by Security Ops, extension 7192".

**--data-length** _**\<number>**_ Το Nmap στέλνει μόνο κεφαλίδες, με αυτό επιτυγχάνουμε να προσθέσει σε αυτόν έναν αριθμό bytes παραπάνω (που θα παραχθούν τυχαία).

Για να ρυθμίσετε πλήρως το πακέτο IP χρησιμοποιήστε **--ip-options**.

Αν θέλετε να δείτε τις επιλογές στα πακέτα που αποστέλλονται και λαμβάνονται, καθορίστε --packet-trace. Για περισσότερες πληροφορίες και παραδείγματα χρήσης επιλογών IP με το Nmap, δείτε [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<value>**_.

**--randomize-hosts** Για να είναι η επίθεση λιγότερο προφανής.

**--spoof-mac** _**\<MAC address, prefix, or vendor name>**_ Για να αλλάξετε τη mac παραδείγματα: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, και Cisco.

**--proxies** _**\<Comma-separated list of proxy URLs>**_ Για να χρησιμοποιήσετε proxies, μερικές φορές ένα proxy δεν διατηρεί τόσες πολλές ανοιχτές συνδέσεις όσο θέλει το nmap, οπότε θα πρέπει να τροποποιήσετε τον παραλληλισμό: --max-parallelism.

**-sP** Για να ανακαλύψετε hosts στο δίκτυο στο οποίο βρισκόμαστε μέσω ARP.

Πολλοί διαχειριστές δημιουργούν έναν κανόνα στο τείχος προστασίας που επιτρέπει την πρόσβαση σε όλα τα πακέτα που προέρχονται από μια συγκεκριμένη θύρα (όπως το 20,53 και 67), μπορούμε να πούμε στο nmap να στείλει τα πακέτα μας από αυτές τις θύρες: **nmap --source-port 53 Ip**.

**Έξοδοι**

**-oN file** Κανονική έξοδος.

**-oX file** Έξοδος XML.

**-oS file** Έξοδος από script kidies.

**-oG file** Έξοδος grepable.

**-oA file** Όλα εκτός από -oS.

**-v level** verbosity.

**-d level** debugging.

**--reason** Γιατί του host και κατάσταση.

**--stats-every time** Κάθε αυτό το χρόνο μας λέει πώς πάει.

**--packet-trace** Για να δείτε ποια πακέτα βγαίνουν, μπορείτε να καθορίσετε φίλτρα όπως: --version-trace ή --script-trace.

**--open** δείχνει τα ανοιχτά, ανοιχτά|φιλτραρισμένα και τα μη φιλτραρισμένα.

**--resume file** Βγάζει μια σύνοψη.

**Μικτές πληροφορίες**

**-6** Επιτρέπει ipv6.

**-A** είναι το ίδιο με -O -sV -sC --traceroute.

**Χρόνος εκτέλεσης**

Ενώ τρέχει το nmap μπορούμε να αλλάξουμε επιλογές:

v / V Αυξήστε / μειώστε το επίπεδο verbosity.

d / D Αυξήστε / μειώστε το επίπεδο debugging.

p / P Ενεργοποιήστε / απενεργοποιήστε την παρακολούθηση πακέτων.

? Εκτυπώστε μια οθόνη βοήθειας αλληλεπίδρασης χρόνου εκτέλεσης.

**Vulscan**

Script του nmap που ελέγχει τις εκδόσεις των υπηρεσιών που αποκτώνται σε μια offline βάση δεδομένων (που κατεβάζει από άλλες πολύ σημαντικές) και επιστρέφει τις πιθανές ευπάθειες.

Οι βάσεις δεδομένων που χρησιμοποιεί είναι:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Για να το κατεβάσετε και να το εγκαταστήσετε στον φάκελο του Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Πρέπει επίσης να κατεβάσετε τα πακέτα από τις βάσεις δεδομένων και να τα προσθέσετε στο /usr/share/nmap/scripts/vulscan/.

Χρήση:

Για να χρησιμοποιήσετε όλα: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR.

Για να χρησιμοποιήσετε μια συγκεκριμένη βάση δεδομένων: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR.

## Επιτάχυνση της σάρωσης υπηρεσιών Nmap x16

Σύμφωνα με [**αυτήν την ανάρτηση**](https://joshua.hu/nmap-speedup-service-scanning-16x) μπορείτε να επιταχύνετε την ανάλυση υπηρεσιών nmap τροποποιώντας όλες τις τιμές **`totalwaitms`** στο **`/usr/share/nmap/nmap-service-probes`** σε **300** και **`tcpwrappedms`** σε **200**.

Επιπλέον, οι probes που δεν έχουν συγκεκριμένα καθορισμένο **`servicewaitms`** χρησιμοποιούν μια προεπιλεγμένη τιμή **`5000`**. Επομένως, μπορούμε είτε να προσθέσουμε τιμές σε κάθε probe, είτε να **συγκεντρώσουμε το nmap** μόνοι μας και να αλλάξουμε την προεπιλεγμένη τιμή στο [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

Αν δεν θέλετε να αλλάξετε καθόλου τις τιμές **`totalwaitms`** και **`tcpwrappedms`** στο αρχείο **`/usr/share/nmap/nmap-service-probes`**, μπορείτε να επεξεργαστείτε τον [κώδικα ανάλυσης](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) έτσι ώστε αυτές οι τιμές στο αρχείο `nmap-service-probes` να αγνοούνται εντελώς.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
