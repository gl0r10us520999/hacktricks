# Nmap Podsumowanie (ESP)

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Szkolenie AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Szkolenie GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Dziel siÄ™ trikami hackingowymi, przesyÅ‚ajÄ…c PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parametry

### IP do skanowania

* **`<ip>,<net/mask>`:** Wskazuje bezpoÅ›rednio adresy IP
* **`-iL <ips_file>`:** lista_IPs
* **`-iR <number>`**: Liczba losowych adresÃ³w IP, moÅ¼esz wykluczyÄ‡ moÅ¼liwe adresy IP za pomocÄ… `--exclude <Ips>` lub `--excludefile <file>`.

### Odkrywanie sprzÄ™tu

DomyÅ›lnie Nmap uruchamia fazÄ™ odkrywania skÅ‚adajÄ…cÄ… siÄ™ z: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Nie jest inwazyjne, wymienia cele, wykonujÄ…c **DNS** zapytania w celu rozwiÄ…zania nazw. Jest przydatne, aby wiedzieÄ‡, czy na przykÅ‚ad www.prueba.es/24 wszystkie adresy IP sÄ… naszymi celami.
* **`-Pn`**: **Brak ping**. Jest to przydatne, jeÅ›li wiesz, Å¼e wszystkie sÄ… aktywne (jeÅ›li nie, moÅ¼esz straciÄ‡ duÅ¼o czasu, ale ta opcja rÃ³wnieÅ¼ produkuje faÅ‚szywe negatywy mÃ³wiÄ…ce, Å¼e nie sÄ… aktywne), zapobiega fazie odkrywania.
* **`-sn`** : **Brak skanowania portÃ³w**. Po zakoÅ„czeniu fazy rozpoznania, nie skanuje portÃ³w. Jest stosunkowo ukryte i pozwala na maÅ‚e skanowanie sieci. Z uprawnieniami wysyÅ‚a ACK (-PA) do 80, SYN(-PS) do 443 oraz Å¼Ä…danie echa i Å¼Ä…danie znacznika czasu, bez uprawnieÅ„ zawsze koÅ„czy poÅ‚Ä…czenia. JeÅ›li celem jest sieÄ‡, uÅ¼ywa tylko ARP(-PR). JeÅ›li uÅ¼ywane z innÄ… opcjÄ…, tylko pakiety innej opcji sÄ… odrzucane.
* **`-PR`**: **Ping ARP**. Jest uÅ¼ywane domyÅ›lnie podczas analizy komputerÃ³w w naszej sieci, jest szybsze niÅ¼ uÅ¼ywanie pingÃ³w. JeÅ›li nie chcesz uÅ¼ywaÄ‡ pakietÃ³w ARP, uÅ¼yj `--send-ip`.
* **`-PS <ports>`**: WysyÅ‚a pakiety SYN, na ktÃ³re jeÅ›li odpowiada SYN/ACK, jest otwarty (na ktÃ³re odpowiada RST, aby nie zakoÅ„czyÄ‡ poÅ‚Ä…czenia), jeÅ›li odpowiada RST, jest zamkniÄ™ty, a jeÅ›li nie odpowiada, jest niedostÄ™pny. W przypadku braku uprawnieÅ„ automatycznie uÅ¼ywa peÅ‚nego poÅ‚Ä…czenia. JeÅ›li nie podano portÃ³w, wysyÅ‚a do 80.
* **`-PA <ports>`**: Jak poprzednia, ale z ACK, Å‚Ä…czÄ…c je daje lepsze wyniki.
* **`-PU <ports>`**: Cel jest przeciwny, sÄ… wysyÅ‚ane do portÃ³w, ktÃ³re majÄ… byÄ‡ zamkniÄ™te. NiektÃ³re zapory ogniowe sprawdzajÄ… tylko poÅ‚Ä…czenia TCP. JeÅ›li jest zamkniÄ™ty, odpowiada portem niedostÄ™pnym, jeÅ›li odpowiada innym ICMP lub nie odpowiada, pozostaje jako niedostÄ™pny.
* **`-PE, -PP, -PM`** : ICMP PINGS: echo replay, timestamp i addresmask. SÄ… uruchamiane, aby dowiedzieÄ‡ siÄ™, czy cel jest aktywny.
* **`-PY<ports>`**: WysyÅ‚a SCTP INIT proby do 80 domyÅ›lnie, INIT-ACK(open) lub ABORT(closed) lub nic lub ICMP unreachable(inactive) mogÄ… byÄ‡ odpowiedziÄ….
* **`-PO <protocols>`**: Wskazuje protokÃ³Å‚ w nagÅ‚Ã³wkach, domyÅ›lnie 1(ICMP), 2(IGMP) i 4(Encap IP). Dla protokoÅ‚Ã³w ICMP, IGMP, TCP (6) i UDP (17) nagÅ‚Ã³wki protokoÅ‚Ã³w sÄ… wysyÅ‚ane, dla pozostaÅ‚ych tylko nagÅ‚Ã³wek IP jest wysyÅ‚any. Celem tego jest to, Å¼e z powodu znieksztaÅ‚cenia nagÅ‚Ã³wkÃ³w, odpowiada siÄ™ na protokÃ³Å‚ unreachable lub odpowiedzi tego samego protokoÅ‚u, aby wiedzieÄ‡, czy jest aktywny.
* **`-n`**: Brak DNS
* **`-R`**: DNS zawsze

### Techniki skanowania portÃ³w

* **`-sS`**: Nie koÅ„czy poÅ‚Ä…czenia, wiÄ™c nie pozostawia Å›ladÃ³w, bardzo dobrze, jeÅ›li moÅ¼na to uÅ¼yÄ‡. (uprawnienia) Jest to domyÅ›lnie uÅ¼ywane.
* **`-sT`**: KoÅ„czy poÅ‚Ä…czenie, wiÄ™c pozostawia Å›lad, ale moÅ¼na to uÅ¼yÄ‡ na pewno. DomyÅ›lnie bez uprawnieÅ„.
* **`-sU`**: Wolniejsze, dla UDP. GÅ‚Ã³wnie: DNS(53), SNMP(161,162), DHCP(67 i 68), (-sU53,161,162,67,68): otwarte(odpowiedÅº), zamkniÄ™te(port niedostÄ™pny), filtrowane (inne ICMP), otwarte/filtrowane (nic). W przypadku otwarte/filtrowane, -sV wysyÅ‚a liczne zapytania, aby wykryÄ‡ dowolnÄ… z wersji, ktÃ³re nmap obsÅ‚uguje i moÅ¼e wykryÄ‡ prawdziwy stan. ZwiÄ™ksza to znacznie czas.
* **`-sY`**: ProtokÃ³Å‚ SCTP nie udaje siÄ™ nawiÄ…zaÄ‡ poÅ‚Ä…czenia, wiÄ™c nie ma logÃ³w, dziaÅ‚a jak -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, mogÄ… przenikaÄ‡ przez niektÃ³re zapory ogniowe i wydobywaÄ‡ informacje. OpierajÄ… siÄ™ na tym, Å¼e standardowe maszyny zgodne powinny odpowiadaÄ‡ RST na wszystkie zapytania, ktÃ³re nie majÄ… SYN, RST lub ACK. Odpowiedzi: otwarte/filtrowane(nic), zamkniÄ™te(RST), filtrowane (ICMP unreachable). Niezawodne na Windows, Cisco, BSDI i OS/400. Na unixie tak.
* **`-sM`**: Skanowanie Maimon: WysyÅ‚a flagi FIN i ACK, uÅ¼ywane dla BSD, obecnie zwrÃ³ci wszystko jako zamkniÄ™te.
* **`-sA, sW`**: ACK i Window, uÅ¼ywane do wykrywania zapÃ³r ogniowych, aby wiedzieÄ‡, czy porty sÄ… filtrowane, czy nie. -sW rozrÃ³Å¼nia miÄ™dzy otwartymi/zamkniÄ™tymi, poniewaÅ¼ otwarte odpowiadajÄ… innÄ… wartoÅ›ciÄ… okna: otwarte (RST z oknem innym niÅ¼ 0), zamkniÄ™te (RST okno = 0), filtrowane (ICMP unreachable lub nic). Nie wszystkie komputery dziaÅ‚ajÄ… w ten sposÃ³b, wiÄ™c jeÅ›li wszystko jest zamkniÄ™te, to nie dziaÅ‚a, jeÅ›li jest kilka otwartych, dziaÅ‚a dobrze, a jeÅ›li jest wiele otwartych i maÅ‚o zamkniÄ™tych, dziaÅ‚a odwrotnie.
* **`-sI`:** Skanowanie Idle. W przypadkach, gdy istnieje aktywna zapora ogniowa, ale wiemy, Å¼e nie filtruje do okreÅ›lonego adresu IP (lub gdy po prostu chcemy anonimowoÅ›ci), moÅ¼emy uÅ¼yÄ‡ skanera zombie (dziaÅ‚a dla wszystkich portÃ³w), aby szukaÄ‡ moÅ¼liwych zombie, moÅ¼emy uÅ¼yÄ‡ skryptu ipidseq lub exploita auxiliary/scanner/ip/ipidseq. Ten skaner opiera siÄ™ na numerze IPID pakietÃ³w IP.
* **`--badsum`:** WysyÅ‚a zÅ‚Ä… sumÄ™, komputery odrzucÄ… pakiety, ale zapory ogniowe mogÄ… odpowiedzieÄ‡ czymÅ›, jest uÅ¼ywane do wykrywania zapÃ³r ogniowych.
* **`-sZ`:** "Dziwny" skaner SCTP, podczas wysyÅ‚ania prÃ³b z fragmentami cookie echo powinny byÄ‡ odrzucane, jeÅ›li sÄ… otwarte lub odpowiadaÄ‡ ABORT, jeÅ›li zamkniÄ™te. MoÅ¼e przejÅ›Ä‡ przez zapory ogniowe, przez ktÃ³re init nie przechodzi, zÅ‚e jest to, Å¼e nie rozrÃ³Å¼nia miÄ™dzy filtrowanymi a otwartymi.
* **`-sO`:** Skanowanie protokoÅ‚u IP. WysyÅ‚a zÅ‚e i puste nagÅ‚Ã³wki, w ktÃ³rych czasami nie moÅ¼na nawet rozrÃ³Å¼niÄ‡ protokoÅ‚u. JeÅ›li przychodzi protokÃ³Å‚ ICMP unreachable, jest zamkniÄ™ty, jeÅ›li przychodzi port unreachable, jest otwarty, jeÅ›li przychodzi inny bÅ‚Ä…d, filtrowany, jeÅ›li nic nie przychodzi, otwarty|filtrowany.
* **`-b <server>`:** FTPhost--> UÅ¼ywane do skanowania hosta z innego, odbywa siÄ™ to przez poÅ‚Ä…czenie z ftp innej maszyny i poproszenie jej o wysÅ‚anie plikÃ³w do portÃ³w, ktÃ³re chcesz zeskanowaÄ‡ z innej maszyny, w zaleÅ¼noÅ›ci od odpowiedzi bÄ™dziemy wiedzieÄ‡, czy sÄ… otwarte, czy nie. \[\<user>:\<password>@]\<server>\[:\<port>] Prawie wszystkie serwery ftps juÅ¼ nie pozwalajÄ… na to i dlatego ma to maÅ‚e praktyczne zastosowanie.

### **Centrar analiza**

**-p:** SÅ‚uÅ¼y do podania portÃ³w do skanowania. Aby wybraÄ‡ 65335: **-p-** lub **-p all**. Nmap ma wewnÄ™trznÄ… klasyfikacjÄ™ wedÅ‚ug popularnoÅ›ci. DomyÅ›lnie uÅ¼ywa 1000 gÅ‚Ã³wnych. Z **-F** (szybkie skanowanie) analizuje 100 gÅ‚Ã³wnych. Z **--top-ports \<numer>** Analizuje tÄ™ liczbÄ™ gÅ‚Ã³wnych (od 1 do 65335). Sprawdza porty w losowej kolejnoÅ›ci, aby to nie miaÅ‚o miejsca **-r**. MoÅ¼emy rÃ³wnieÅ¼ wybraÄ‡ porty: 20-30,80,443,1024- To ostatnie oznacza, Å¼e patrzy na porty powyÅ¼ej 1024. MoÅ¼emy rÃ³wnieÅ¼ grupowaÄ‡ porty wedÅ‚ug protokoÅ‚Ã³w: U:53,T:21-25,80,139,S:9. MoÅ¼emy rÃ³wnieÅ¼ wybraÄ‡ zakres w popularnych portach nmap: -p \[-1024] analizuje do 1024 z uwzglÄ™dnieniem nmap-services. **--port-ratio \<ratio>** Analizuje najczÄ™Å›ciej uÅ¼ywane porty, ktÃ³re majÄ… wspÃ³Å‚czynnik miÄ™dzy 0 a 1.

**-sV** Skanowanie wersji, moÅ¼na regulowaÄ‡ intensywnoÅ›Ä‡ od 0 do 9, domyÅ›lnie 7.

**--version-intensity \<numer>** Regulujemy intensywnoÅ›Ä‡, w ten sposÃ³b im niÅ¼sza, tym tylko najprawdopodobniej uruchomi sondy, ale nie wszystkie. DziÄ™ki temu moÅ¼emy znacznie skrÃ³ciÄ‡ czas skanowania UDP.

**-O** Wykrywanie systemu operacyjnego.

**--osscan-limit** Aby dobrze zeskanowaÄ‡ hosta, potrzebny jest przynajmniej 1 port otwarty i inny zamkniÄ™ty, jeÅ›li nie speÅ‚niona jest ta warunek i ustawiliÅ›my to, nie prÃ³buje przewidywaÄ‡ systemu operacyjnego (oszczÄ™dza czas).

**--osscan-guess** Gdy wykrywanie systemu operacyjnego nie jest doskonaÅ‚e, to sprawia, Å¼e bardziej siÄ™ stara.

**Skrypty**

\--script _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_\[,...]

Aby uÅ¼yÄ‡ domyÅ›lnych, wystarczy -sC lub --script=default.

Typy, ktÃ³re istniejÄ… to: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, i vuln.

* **Auth:** uruchamia wszystkie dostÄ™pne _skrypty_ do autoryzacji.
* **Default:** uruchamia podstawowe _skrypty_ domyÅ›lne narzÄ™dzia.
* **Discovery:** odzyskuje informacje o _celu_ lub ofierze.
* **External:** _skrypt_ do korzystania z zasobÃ³w zewnÄ™trznych.
* **Intrusive:** uÅ¼ywa _skryptÃ³w_, ktÃ³re sÄ… uwaÅ¼ane za inwazyjne dla ofiary lub _celu_.
* **Malware:** sprawdza, czy sÄ… otwarte poÅ‚Ä…czenia przez zÅ‚oÅ›liwe kody lub _backdoory_ (drzwi tylne).
* **Safe:** uruchamia _skrypty_, ktÃ³re nie sÄ… inwazyjne.
* **Vuln:** odkrywa najbardziej znane luki.
* **All:** uruchamia absolutnie wszystkie _skrypty_ z rozszerzeniem NSE dostÄ™pne.

Aby wyszukaÄ‡ skrypty:

**nmap --script-help="http-\*" -> Te, ktÃ³re zaczynajÄ… siÄ™ od http-**

**nmap --script-help="not intrusive" -> Wszystkie oprÃ³cz tych**

**nmap --script-help="default or safe" -> Te, ktÃ³re sÄ… w jednym lub drugim lub w obu**

**nmap --script-help="default and safe" --> Te, ktÃ³re sÄ… w obu**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<filename>_

\--script-help _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_|all\[,...]

\--script-trace ---> Daje informacje o tym, jak dziaÅ‚a skrypt.

\--script-updatedb

**Aby uÅ¼yÄ‡ skryptu, wystarczy wpisaÄ‡: namp --script Nazwa\_skryptu cel** --> Po wpisaniu skryptu uruchomi siÄ™ zarÃ³wno skrypt, jak i skaner, wiÄ™c moÅ¼na rÃ³wnieÅ¼ podaÄ‡ opcje skanera, moÅ¼emy dodaÄ‡ **â€œsafe=1â€**, aby uruchomiÄ‡ tylko te, ktÃ³re sÄ… bezpieczne.

**Kontrola czasu**

**Nmap moÅ¼e modyfikowaÄ‡ czas w sekundach, minutach, ms:** --host-timeout arguments 900000ms, 900, 900s, i 15m wszystko robi to samo.

Nmap dzieli caÅ‚kowitÄ… liczbÄ™ hostÃ³w do zeskanowania na grupy i analizuje te grupy w blokach, tak Å¼e dopÃ³ki wszystkie nie zostaÅ‚y przeanalizowane, nie przechodzi do nastÄ™pnego bloku (a uÅ¼ytkownik rÃ³wnieÅ¼ nie otrzymuje Å¼adnej aktualizacji, dopÃ³ki blok nie zostanie przeanalizowany), w ten sposÃ³b jest bardziej optymalne dla nmap uÅ¼ywaÄ‡ duÅ¼ych grup. DomyÅ›lnie w klasie C uÅ¼ywa 256.

MoÅ¼na to zmieniÄ‡ za pomocÄ… **--min-hostgroup** _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Dostosuj rozmiary grup skanowania rÃ³wnolegÅ‚ego).

MoÅ¼na kontrolowaÄ‡ liczbÄ™ skanerÃ³w w rÃ³wnolegÅ‚ym, ale lepiej tego nie robiÄ‡ (nmap juÅ¼ wprowadza automatycznÄ… kontrolÄ™ na podstawie stanu sieci): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

MoÅ¼emy zmodyfikowaÄ‡ czas oczekiwania RTT, ale zazwyczaj nie jest to konieczne: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

MoÅ¼emy zmodyfikowaÄ‡ liczbÄ™ prÃ³b:**--max-retries** _**\<numtries>**_

MoÅ¼emy zmodyfikowaÄ‡ czas skanowania hosta: **--host-timeout** _**\<time>**_

MoÅ¼emy zmodyfikowaÄ‡ czas miÄ™dzy kaÅ¼dym testem, aby dziaÅ‚aÅ‚ wolniej: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

MoÅ¼emy zmodyfikowaÄ‡ liczbÄ™ pakietÃ³w na sekundÄ™: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

Wiele portÃ³w dÅ‚ugo odpowiada na bycie filtrowanymi lub zamkniÄ™tymi, jeÅ›li interesujÄ… nas tylko otwarte, moÅ¼emy dziaÅ‚aÄ‡ szybciej z: **--defeat-rst-ratelimit**.

Aby okreÅ›liÄ‡, jak agresywny ma byÄ‡ nmap: -T paranoid|sneaky|polite|normal|aggressive|insane.

\-T (0-1)

\-T0 --> Skanuje tylko 1 port na raz i czeka 5 minut do nastÄ™pnego.

\-T1 i T2 --> Bardzo podobne, ale czekajÄ… tylko 15 i 0,4 sekundy odpowiednio miÄ™dzy kaÅ¼dym testem.

\-T3 --> DomyÅ›lne dziaÅ‚anie, obejmuje rÃ³wnolegle.

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms.

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms.

**Zapora/IDS**

Nie przepuszczajÄ… portÃ³w i analizujÄ… pakiety.

**-f** Aby fragmentowaÄ‡ pakiety, domyÅ›lnie fragmentuje je na 8 bajtÃ³w po nagÅ‚Ã³wku, aby okreÅ›liÄ‡ ten rozmiar, uÅ¼ywamy ..mtu (z tym, nie uÅ¼ywaj -f), offset musi byÄ‡ wielokrotnoÅ›ciÄ… 8. **Skanery wersji i skrypty nie obsÅ‚ugujÄ… fragmentacji.**

**-D decoy1,decoy2,ME** Nmap wysyÅ‚a skanery, ale z innymi adresami IP jako ÅºrÃ³dÅ‚o, w ten sposÃ³b ukrywajÄ… Ciebie. JeÅ›li umieÅ›cisz ME na liÅ›cie, nmap umieÅ›ci CiÄ™ tam, lepiej umieÅ›ciÄ‡ 5 lub 6 przed TobÄ…, aby caÅ‚kowicie CiÄ™ zamaskowaÄ‡. MoÅ¼na generowaÄ‡ losowe adresy IP z RND:\<numer> Aby wygenerowaÄ‡ \<numer> losowych adresÃ³w IP. Nie dziaÅ‚ajÄ… z detektorem wersji bez poÅ‚Ä…czenia TCP. JeÅ›li jesteÅ› w sieci, warto uÅ¼ywaÄ‡ adresÃ³w IP, ktÃ³re sÄ… aktywne, poniewaÅ¼ w przeciwnym razie bÄ™dzie bardzo Å‚atwo ustaliÄ‡, Å¼e jesteÅ› jedynym aktywnym.

Aby uÅ¼yÄ‡ losowych adresÃ³w IP: nmap-D RND: 10 Ip\_cel.

**-S IP** Gdy Nmap nie uchwyci Twojego adresu IP, musisz go podaÄ‡. MoÅ¼e rÃ³wnieÅ¼ sÅ‚uÅ¼yÄ‡ do sprawienia, Å¼e wydaje siÄ™, Å¼e inny cel skanuje.

**-e \<interface>** Aby wybraÄ‡ interfejs.

Wielu administratorÃ³w pozostawia otwarte porty wejÅ›ciowe, aby wszystko dziaÅ‚aÅ‚o poprawnie i jest im Å‚atwiej niÅ¼ szukaÄ‡ innego rozwiÄ…zania. MogÄ… to byÄ‡ porty DNS lub FTP... aby znaleÅºÄ‡ tÄ™ lukÄ™, nmap wprowadza: **--source-port** _**\<portnumber>**_**;-g** _**\<portnumber>**_ _SÄ… rÃ³wnowaÅ¼ne._

**--data** _**\<hex string>**_ Aby wysÅ‚aÄ‡ tekst szesnastkowy: --data 0xdeadbeef i --data \xCA\xFE\x09.

**--data-string** _**\<string>**_ Aby wysÅ‚aÄ‡ zwykÅ‚y tekst: --data-string "Skanowanie przeprowadzone przez Security Ops, rozszerzenie 7192".

**--data-length** _**\<number>**_ Nmap wysyÅ‚a tylko nagÅ‚Ã³wki, dziÄ™ki temu osiÄ…gamy, Å¼e dodaje do tego dodatkowÄ… liczbÄ™ bajtÃ³w (ktÃ³re bÄ™dÄ… generowane losowo).

Aby caÅ‚kowicie skonfigurowaÄ‡ pakiet IP, uÅ¼yj **--ip-options**.

JeÅ›li chcesz zobaczyÄ‡ opcje w wysyÅ‚anych i odbieranych pakietach, okreÅ›l --packet-trace. Aby uzyskaÄ‡ wiÄ™cej informacji i przykÅ‚adÃ³w uÅ¼ycia opcji IP z Nmap, zobacz [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<value>**_

**--randomize-hosts** Aby atak byÅ‚ mniej oczywisty.

**--spoof-mac** _**\<adres MAC, prefiks lub nazwa dostawcy>**_ Aby zmieniÄ‡ MAC, przykÅ‚ady: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, i Cisco.

**--proxies** _**\<Lista adresÃ³w URL proxy oddzielona przecinkami>**_ Aby uÅ¼ywaÄ‡ proxy, czasami proxy nie utrzymuje tylu otwartych poÅ‚Ä…czeÅ„, ile chce nmap, wiÄ™c trzeba by zmodyfikowaÄ‡ rÃ³wnolegÅ‚oÅ›Ä‡: --max-parallelism.

**-sP** Aby odkryÄ‡ hosty w sieci, w ktÃ³rej jesteÅ›my, za pomocÄ… ARP.

Wielu administratorÃ³w tworzy reguÅ‚Ä™ w zaporze, ktÃ³ra pozwala przechodziÄ‡ wszystkim pakietom pochodzÄ…cym z okreÅ›lonego portu (takiego jak 20,53 i 67), moÅ¼emy powiedzieÄ‡ nmap, aby wysÅ‚aÅ‚ nasze pakiety z tych portÃ³w: **nmap --source-port 53 Ip**.

**WyjÅ›cia**

**-oN file** Normalne wyjÅ›cie.

**-oX file** WyjÅ›cie XML.

**-oS file** WyjÅ›cie skryptÃ³w dzieciÄ™cych.

**-oG file** WyjÅ›cie do grepowania.

**-oA file** Wszystko oprÃ³cz -oS.

**-v level** poziom szczegÃ³Å‚owoÅ›ci.

**-d level** poziom debugowania.

**--reason** Dlaczego host i stan.

**--stats-every time** Co ten czas mÃ³wi nam, jak idzie.

**--packet-trace** Aby zobaczyÄ‡, jakie pakiety wychodzÄ…, moÅ¼na okreÅ›liÄ‡ filtry, takie jak: --version-trace lub --script-trace.

**--open** pokazuje otwarte, otwarte|filtrowane i nie filtrowane.

**--resume file** WyciÄ…ga podsumowanie.

**Miscellaneous**

**-6** UmoÅ¼liwia ipv6.

**-A** to to samo co -O -sV -sC --traceroute.

**Czas dziaÅ‚ania**

Podczas dziaÅ‚ania nmap moÅ¼emy zmieniaÄ‡ opcje:

v / V ZwiÄ™ksz / zmniejsz poziom szczegÃ³Å‚owoÅ›ci.

d / D ZwiÄ™ksz / zmniejsz poziom debugowania.

p / P WÅ‚Ä…cz / wyÅ‚Ä…cz Å›ledzenie pakietÃ³w.

? WyÅ›wietl ekran pomocy interakcji w czasie rzeczywistym.

**Vulscan**

Skrypt nmap, ktÃ³ry sprawdza wersje usÅ‚ug uzyskanych w bazie danych offline (pobieranej z innych bardzo waÅ¼nych) i zwraca moÅ¼liwe luki.

Bazy danych, ktÃ³re uÅ¼ywa to:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Aby pobraÄ‡ i zainstalowaÄ‡ w folderze Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

NaleÅ¼y rÃ³wnieÅ¼ pobraÄ‡ pakiety z baz danych i dodaÄ‡ je do /usr/share/nmap/scripts/vulscan/.

UÅ¼ycie:

Aby uÅ¼yÄ‡ wszystkich: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR.

Aby uÅ¼yÄ‡ konkretnej bazy danych: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR.

## Przyspieszenie skanowania usÅ‚ug Nmap x16

Zgodnie z [**tym postem**](https://joshua.hu/nmap-speedup-service-scanning-16x) moÅ¼esz przyspieszyÄ‡ analizÄ™ usÅ‚ug nmap, modyfikujÄ…c wszystkie wartoÅ›ci **`totalwaitms`** w **`/usr/share/nmap/nmap-service-probes`** na **300** i **`tcpwrappedms`** na **200**.

Ponadto, prÃ³by, ktÃ³re nie majÄ… okreÅ›lonej wartoÅ›ci **`servicewaitms`**, uÅ¼ywajÄ… domyÅ›lnej wartoÅ›ci **`5000`**. Dlatego moÅ¼emy dodaÄ‡ wartoÅ›ci do kaÅ¼dej z prÃ³b lub moÅ¼emy **skompilowaÄ‡ nmap** samodzielnie i zmieniÄ‡ domyÅ›lnÄ… wartoÅ›Ä‡ w [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

JeÅ›li nie chcesz w ogÃ³le zmieniaÄ‡ wartoÅ›ci **`totalwaitms`** i **`tcpwrappedms`** w pliku `/usr/share/nmap/nmap-service-probes`, moÅ¼esz edytowaÄ‡ [kod analizy](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) tak, aby te wartoÅ›ci w pliku `nmap-service-probes` byÅ‚y caÅ‚kowicie ignorowane.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Ucz siÄ™ i Ä‡wicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz siÄ™ i Ä‡wicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* SprawdÅº [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **DoÅ‚Ä…cz do** ğŸ’¬ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **Å›ledÅº** nas na **Twitterze** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel siÄ™ sztuczkami hackingowymi, przesyÅ‚ajÄ…c PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriÃ³w github.

</details>
{% endhint %}
