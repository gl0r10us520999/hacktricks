# WebRTC DoS

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Hierdie probleem is gevind in hierdie blogpos:** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

Die beskryfde kwesbaarheid in WebRTC media bedieners ontstaan uit 'n **wedlooptoestand** tydens die inisialisering van media sessies, spesifiek tussen die **ICE media toestemming verifikasie** en die **DTLS verkeer inisi√´ring**. Hier is 'n gedetailleerde ontleding:

### Kwesbaarheid Oorsprong

1. **UDP Poort Toewysing:** Wanneer 'n gebruiker 'n WebRTC oproep begin, toewys die media bediener UDP poorte vir die hantering van die media strome, met die IP en poort wat via sein kommunikeer.
2. **ICE en STUN Prosesse:** Die gebruiker se blaaiert gebruik ICE vir media toestemming verifikasie, wat STUN benut om die verbindingspad na die media bediener te bepaal.
3. **DTLS Sessie:** Na suksesvolle STUN verifikasie, begin 'n DTLS sessie om SRTP meester sleutels te vestig, wat oorgeskakel word na SRTP vir die media stroom.

### Exploitasiemeganisme

* **Wedlooptoestand Exploitatie:** 'n Aanvaller kan 'n wedlooptoestand benut deur 'n DTLS ClientHello boodskap te stuur voordat die wettige gebruiker, moontlik met 'n ongeldige cipher suite soos `TLS_NULL_WITH_NULL_NULL`. Dit veroorsaak 'n DTLS fout by die bediener, wat verhoed dat die SRTP sessie gevestig word.

### Aanval Proses

* **Poort Skandering:** Die aanvaller moet raai watter UDP poorte inkomende media sessies hanteer, en stuur ClientHello boodskappe met die null cipher suite na hierdie poorte om die kwesbaarheid te aktiveer.
* **Diagram van Aanval:** Die volgorde behels verskeie ClientHello boodskappe wat deur die aanvaller na die bediener gestuur word, tussenleg met wettige sein en DTLS boodskappe, wat lei tot 'n handdruk mislukking weens die foutiewe cipher suite.

### Toetsing en Versagting

* **Veilige Toetsing:** Deur gereedskap soos Scapy te gebruik, herhaal aanvallers DTLS ClientHello boodskappe wat spesifieke media poorte teiken. Vir etiese toetsing is wysigings aan Chromium (bv. `JsepTransport::AddRemoteCandidates`) gebruik om die slagoffer se gedrag veilig na te boots.
* **Versagtingsmaatre√´ls:** Oplossings behels die laat val van pakkette van onverifieerde adresse, soos ge√Ømplementeer in nuwer weergawes van biblioteke soos libnice. Die prim√™re oplossing beklemtoon die vertroue in die ICE verifikasie proses en slegs die verwerking van pakkette van gevalideerde IP en poort kombinasies.

### Nie-Kwesbare Scenario's

* **DTLS Bediener Konfigurasies:** Gevalle waar die blaaiert as 'n DTLS bediener optree of wanneer die media bediener nie ephemerale poorte vir media sessies gebruik nie, is nie vatbaar vir hierdie kwesbaarheid nie.

### Gevolgtrekking

Hierdie kwesbaarheid beklemtoon die delikate balans in media sessie inisialisering prosesse en die behoefte aan presiese tydsberekening en verifikasie meganismes om eksploitatie te voorkom. Ontwikkelaars word aangeraai om aanbevole sekuriteitsoplossings te implementeer en te verseker dat robuuste verifikasie prosesse gevolg word om sulke kwesbaarhede te versag.

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
