# WebRTC DoS

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

**Tatizo hili lilipatikana katika chapisho hili la blog:** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

Uthibitisho ulioelezewa katika seva za media za WebRTC unatokana na **hali ya mbio** wakati wa kuanzisha vikao vya media, hasa kati ya **uthibitishaji wa idhini ya media ya ICE** na **kuanzishwa kwa trafiki ya DTLS**. Hapa kuna ufafanuzi wa kina:

### Chanzo cha Uthibitisho

1. **Ugawaji wa Bandari za UDP:** Wakati mtumiaji anaanzisha simu ya WebRTC, seva ya media inagawanya bandari za UDP kwa ajili ya kushughulikia mitiririko ya media, huku IP na bandari zik komunikwa kupitia ishara.
2. **Mchakato wa ICE na STUN:** Kivinjari cha mtumiaji kinatumia ICE kwa uthibitishaji wa idhini ya media, kikitumia STUN kubaini njia ya muunganisho hadi seva ya media.
3. **Kikao cha DTLS:** Baada ya uthibitishaji wa STUN kufanikiwa, kikao cha DTLS kinaanza kuanzisha funguo kuu za SRTP, kikibadilisha kuwa SRTP kwa ajili ya mtiririko wa media.

### Mekanism ya Ukatili

* **Ukatili wa Hali ya Mbio:** Mshambuliaji anaweza kutumia hali ya mbio kwa kutuma ujumbe wa DTLS ClientHello kabla ya mtumiaji halali, akitumia suite ya cipher isiyo sahihi kama `TLS_NULL_WITH_NULL_NULL`. Hii husababisha kosa la DTLS kwenye seva, ikizuia kikao cha SRTP kuanzishwa.

### Mchakato wa Shambulio

* **Kuchunguza Bandari:** Mshambuliaji anahitaji kukisia ni bandari zipi za UDP zinazosimamia vikao vya media vinavyokuja, akituma ujumbe wa ClientHello na suite ya cipher isiyo na kitu kwa bandari hizi ili kuchochea uthibitisho.
* **Mchoro wa Shambulio:** Mfuatano unajumuisha ujumbe wengi wa ClientHello wanaotumwa na mshambuliaji kwa seva, ukichanganywa na ishara halali na ujumbe wa DTLS, ukisababisha kushindwa kwa mkono kutokana na suite ya cipher isiyo sahihi.

### Upimaji na Kupunguza

* **Upimaji Salama:** Kwa kutumia zana kama Scapy, washambuliaji wanarejelea ujumbe wa DTLS ClientHello wakilenga bandari maalum za media. Kwa ajili ya upimaji wa kimaadili, marekebisho kwa Chromium (mfano, `JsepTransport::AddRemoteCandidates`) yalitumika kuiga tabia ya mwathirika kwa usalama.
* **Hatua za Kupunguza:** Suluhisho zinajumuisha kuangusha pakiti kutoka kwa anwani zisizothibitishwa, kama ilivyotekelezwa katika matoleo mapya ya maktaba kama libnice. Suluhisho kuu linasisitiza kuamini mchakato wa uthibitishaji wa ICE na kushughulikia pakiti tu kutoka kwa mchanganyiko wa IP na bandari zilizothibitishwa.

### Mifano Isiyo na Uthibitisho

* **Mikakati ya Seva za DTLS:** Matukio ambapo kivinjari kinatenda kama seva ya DTLS au wakati seva ya media haitumii bandari za muda kwa vikao vya media hayahusiki na uthibitisho huu.

### Hitimisho

Uthibitisho huu unaonyesha usawa mwembamba katika michakato ya kuanzisha vikao vya media na hitaji la wakati sahihi na mekanism za uthibitishaji ili kuzuia ukatili. Wanakuza wanashauriwa kutekeleza marekebisho ya usalama yaliyopendekezwa na kuhakikisha michakato thabiti ya uthibitishaji ili kupunguza uthibitisho kama huu.

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
