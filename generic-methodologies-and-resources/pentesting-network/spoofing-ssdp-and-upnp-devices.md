# Spoofing SSDP рдФрд░ UPnP Devices with EvilSSDP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Check [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) for further information.**

## **SSDP & UPnP Overview**

SSDP (Simple Service Discovery Protocol) рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдФрд░ рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ DHCP рдпрд╛ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ UDP рдкреЛрд░реНрдЯ 1900 рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ UPnP (Universal Plug and Play) рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдореМрд▓рд┐рдХ рд╣реИ, рдЬреЛ PCs, рдкреНрд░рд┐рдВрдЯрд░реНрд╕ рдФрд░ рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдЬреИрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХреЗрдб рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмреАрдЪ рдирд┐рд░реНрдмрд╛рдз рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИред UPnP рдХрд╛ рдЬреАрд░реЛ-рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдбрд┐рд╡рд╛рдЗрд╕ рдЦреЛрдЬ, IP рдкрддрд╛ рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдФрд░ рд╕реЗрд╡рд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

## **UPnP Flow & Structure**

UPnP рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдЫрд╣ рдкрд░рддреЗрдВ рд╣реЛрддреА рд╣реИрдВ: рдкрддрд╛ рд▓рдЧрд╛рдирд╛, рдЦреЛрдЬ, рд╡рд┐рд╡рд░рдг, рдирд┐рдпрдВрддреНрд░рдг, рдЗрд╡реЗрдВрдЯрд┐рдВрдЧ, рдФрд░ рдкреНрд░рд╕реНрддреБрддрд┐ред рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдбрд┐рд╡рд╛рдЗрд╕ рдПрдХ IP рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдпрд╛ рдПрдХ рдХреЛ рд╕реНрд╡-рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ (AutoIP) рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдЦреЛрдЬ рдЪрд░рдг рдореЗрдВ SSDP рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ M-SEARCH рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреЗ рд╣реИрдВ рдпрд╛ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ NOTIFY рд╕рдВрджреЗрд╢ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдирд┐рдпрдВрддреНрд░рдг рдкрд░рдд, рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ-рдбрд┐рд╡рд╛рдЗрд╕ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, XML рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рд╡рд┐рд╡рд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП SOAP рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред

## **IGD & Tools Overview**

IGD (Internet Gateway Device) NAT рд╕реЗрдЯрдЕрдк рдореЗрдВ рдЕрд╕реНрдерд╛рдпреА рдкреЛрд░реНрдЯ рдореИрдкрд┐рдВрдЧ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдорд╛рдирдХ WAN рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдЦреБрд▓реЗ SOAP рдирд┐рдпрдВрддреНрд░рдг рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдорд╛рдВрдб рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред **Miranda** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг UPnP рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдФрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рддреЗ рд╣реИрдВред **Umap** WAN-рд╕реБрд▓рдн UPnP рдХрдорд╛рдВрдб рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ **upnp-arsenal** рдЬреИрд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред **Evil SSDP** рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкреВрдл рдХрд┐рдП рдЧрдП UPnP рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рд╡реИрдз рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреА рдореЗрдЬрд╝рдмрд╛рдиреА рдХрд░рддрд╛ рд╣реИред

## **Evil SSDP Practical Usage**

Evil SSDP рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдирдХрд▓реА UPnP рдЙрдкрдХрд░рдг рдмрдирд╛рддрд╛ рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рддреАрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛, рдЬреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдзреЛрдЦрд╛ рдЦрд╛ рдЬрд╛рддреЗ рд╣реИрдВ, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЬреИрд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрдкрдХрд░рдг рдХреА рдмрд╣реБрдкрд░рдХрд╛рд░реАрддрд╛ рд╡рд┐рднрд┐рдиреНрди рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рддрдХ рдлреИрд▓реА рд╣реБрдИ рд╣реИ, рдЬреЛ рд╕реНрдХреИрдирд░, Office365, рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдкрд╛рд╕рд╡рд░реНрдб рд╡реЙрд▓реНрдЯ рдЬреИрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХрд░рддреА рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рджреГрд╢реНрдпрддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреА рд╣реИред рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░ рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рддреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ URL рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдзреЛрдЦреЗ рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдмрдирд╛рдП рд░рдЦрддреЗ рд╣реБрдПред

## **Mitigation Strategies**

рдЗрди рдЦрддрд░реЛрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдиреБрд╢рдВрд╕рд┐рдд рдЙрдкрд╛рдпреЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдЬрдм рдЖрд╡рд╢реНрдпрдХ рди рд╣реЛ, рддреЛ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ UPnP рдХреЛ рдмрдВрдж рдХрд░рдирд╛ред
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдлрд╝рд┐рд╢рд┐рдВрдЧ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдирд╛ред
- рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛ред

рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдЬрдмрдХрд┐ UPnP рд╕реБрд╡рд┐рдзрд╛ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рддрд░рд▓рддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рджрд░рд╡рд╛рдЬреЗ рднреА рдЦреЛрд▓рддрд╛ рд╣реИред рдЬрд╛рдЧрд░реВрдХрддрд╛ рдФрд░ рд╕рдХреНрд░рд┐рдп рд░рдХреНрд╖рд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдЕрдЦрдВрдбрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдВрдЬреА рд╣реИрдВред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
