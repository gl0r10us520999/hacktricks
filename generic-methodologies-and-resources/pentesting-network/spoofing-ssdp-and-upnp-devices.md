# Spoofing SSDP and UPnP Devices with EvilSSDP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Check [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) for further information.**

## **SSDP & UPnP ê°œìš”**

SSDP (Simple Service Discovery Protocol)ëŠ” ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ ê´‘ê³  ë° ê²€ìƒ‰ì— ì‚¬ìš©ë˜ë©°, DHCP ë˜ëŠ” DNS êµ¬ì„± ì—†ì´ UDP í¬íŠ¸ 1900ì—ì„œ ì‘ë™í•©ë‹ˆë‹¤. ì´ëŠ” UPnP (Universal Plug and Play) ì•„í‚¤í…ì²˜ì˜ ê¸°ë³¸ ìš”ì†Œë¡œ, PC, í”„ë¦°í„° ë° ëª¨ë°”ì¼ ì¥ì¹˜ì™€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ì¥ì¹˜ ê°„ì˜ ì›í™œí•œ ìƒí˜¸ì‘ìš©ì„ ì´‰ì§„í•©ë‹ˆë‹¤. UPnPì˜ ì œë¡œ êµ¬ì„± ë„¤íŠ¸ì›Œí‚¹ì€ ì¥ì¹˜ ê²€ìƒ‰, IP ì£¼ì†Œ í• ë‹¹ ë° ì„œë¹„ìŠ¤ ê´‘ê³ ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

## **UPnP íë¦„ ë° êµ¬ì¡°**

UPnP ì•„í‚¤í…ì²˜ëŠ” ì£¼ì†Œ ì§€ì •, ê²€ìƒ‰, ì„¤ëª…, ì œì–´, ì´ë²¤íŠ¸ ë° í”„ë ˆì  í…Œì´ì…˜ì˜ ì—¬ì„¯ ê°€ì§€ ê³„ì¸µìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì²˜ìŒì— ì¥ì¹˜ëŠ” IP ì£¼ì†Œë¥¼ ì–»ê±°ë‚˜ ìë™ìœ¼ë¡œ í• ë‹¹í•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤ (AutoIP). ê²€ìƒ‰ ë‹¨ê³„ëŠ” SSDPë¥¼ í¬í•¨í•˜ë©°, ì¥ì¹˜ëŠ” M-SEARCH ìš”ì²­ì„ ì ê·¹ì ìœ¼ë¡œ ì „ì†¡í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ì•Œë¦¬ê¸° ìœ„í•´ NOTIFY ë©”ì‹œì§€ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë°©ì†¡í•©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸-ì¥ì¹˜ ìƒí˜¸ì‘ìš©ì— ì¤‘ìš”í•œ ì œì–´ ê³„ì¸µì€ XML íŒŒì¼ì˜ ì¥ì¹˜ ì„¤ëª…ì„ ê¸°ë°˜ìœ¼ë¡œ ëª…ë ¹ ì‹¤í–‰ì„ ìœ„í•´ SOAP ë©”ì‹œì§€ë¥¼ í™œìš©í•©ë‹ˆë‹¤.

## **IGD ë° ë„êµ¬ ê°œìš”**

IGD (Internet Gateway Device)ëŠ” NAT ì„¤ì •ì—ì„œ ì„ì‹œ í¬íŠ¸ ë§¤í•‘ì„ ì´‰ì§„í•˜ì—¬ í‘œì¤€ WAN ì¸í„°í˜ì´ìŠ¤ ì œí•œì—ë„ ë¶ˆêµ¬í•˜ê³  ì—´ë¦° SOAP ì œì–´ ì§€ì ì„ í†µí•´ ëª…ë ¹ ìˆ˜ë½ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. **Miranda**ì™€ ê°™ì€ ë„êµ¬ëŠ” UPnP ì„œë¹„ìŠ¤ ê²€ìƒ‰ ë° ëª…ë ¹ ì‹¤í–‰ì„ ì§€ì›í•©ë‹ˆë‹¤. **Umap**ì€ WANì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ UPnP ëª…ë ¹ì„ ë…¸ì¶œí•˜ë©°, **upnp-arsenal**ê³¼ ê°™ì€ ì €ì¥ì†ŒëŠ” ë‹¤ì–‘í•œ UPnP ë„êµ¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. **Evil SSDP**ëŠ” ìŠ¤í‘¸í•‘ëœ UPnP ì¥ì¹˜ë¥¼ í†µí•´ í”¼ì‹±ì„ ì „ë¬¸ìœ¼ë¡œ í•˜ë©°, í•©ë²•ì ì¸ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë°©í•˜ëŠ” í…œí”Œë¦¿ì„ í˜¸ìŠ¤íŒ…í•©ë‹ˆë‹¤.

## **Evil SSDP ì‹¤ìš© ì‚¬ìš©ë²•**

Evil SSDPëŠ” ì„¤ë“ë ¥ ìˆëŠ” ê°€ì§œ UPnP ì¥ì¹˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ì‚¬ìš©ìê°€ ê²‰ë³´ê¸°ì—ëŠ” ì§„ì§œ ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•˜ë„ë¡ ì¡°ì‘í•©ë‹ˆë‹¤. ì§„ì§œì²˜ëŸ¼ ë³´ì´ëŠ” ì™¸ê´€ì— ì†ì€ ì‚¬ìš©ìëŠ” ìê²© ì¦ëª…ê³¼ ê°™ì€ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë„êµ¬ì˜ ë‹¤ì¬ë‹¤ëŠ¥í•¨ì€ ìŠ¤ìºë„ˆ, Office365 ë° ë¹„ë°€ë²ˆí˜¸ ê¸ˆê³ ì™€ ê°™ì€ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë°©í•˜ëŠ” ë‹¤ì–‘í•œ í…œí”Œë¦¿ìœ¼ë¡œ í™•ì¥ë˜ì–´ ì‚¬ìš©ì ì‹ ë¢°ì™€ ë„¤íŠ¸ì›Œí¬ ê°€ì‹œì„±ì„ í™œìš©í•©ë‹ˆë‹¤. ìê²© ì¦ëª…ì´ ìº¡ì²˜ëœ í›„, ê³µê²©ìëŠ” í”¼í•´ìë¥¼ ì§€ì •ëœ URLë¡œ ë¦¬ë””ë ‰ì…˜í•˜ì—¬ ì†ì„ìˆ˜ì˜ ì‹ ë¢°ì„±ì„ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## **ì™„í™” ì „ëµ**

ì´ëŸ¬í•œ ìœ„í˜‘ì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ ê¶Œì¥ë˜ëŠ” ì¡°ì¹˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

- í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ ì¥ì¹˜ì—ì„œ UPnP ë¹„í™œì„±í™”.
- í”¼ì‹± ë° ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆì— ëŒ€í•œ ì‚¬ìš©ì êµìœ¡.
- ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ë¯¼ê°í•œ ë°ì´í„°ì— ëŒ€í•œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ëª¨ë‹ˆí„°ë§.

ë³¸ì§ˆì ìœ¼ë¡œ, UPnPëŠ” í¸ë¦¬í•¨ê³¼ ë„¤íŠ¸ì›Œí¬ ìœ ë™ì„±ì„ ì œê³µí•˜ì§€ë§Œ, ì ì¬ì ì¸ ì•…ìš©ì˜ ë¬¸ë„ ì—´ì–´ì¤ë‹ˆë‹¤. ì¸ì‹ê³¼ ì ê·¹ì ì¸ ë°©ì–´ê°€ ë„¤íŠ¸ì›Œí¬ ë¬´ê²°ì„±ì„ ë³´ì¥í•˜ëŠ” í•µì‹¬ì…ë‹ˆë‹¤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
