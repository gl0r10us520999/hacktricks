# Spoofing SSDP and UPnP Devices with EvilSSDP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Check [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) for further information.**

## **SSDP & UPnP Overview**

Το SSDP (Πρωτόκολλο Απλής Ανακάλυψης Υπηρεσιών) χρησιμοποιείται για την διαφήμιση και ανακάλυψη δικτυακών υπηρεσιών, λειτουργώντας στην θύρα UDP 1900 χωρίς να απαιτεί ρυθμίσεις DHCP ή DNS. Είναι θεμελιώδες στην αρχιτεκτονική UPnP (Universal Plug and Play), διευκολύνοντας την απρόσκοπτη αλληλεπίδραση μεταξύ δικτυωμένων συσκευών όπως υπολογιστές, εκτυπωτές και κινητές συσκευές. Η δικτύωση μηδενικής ρύθμισης του UPnP υποστηρίζει την ανακάλυψη συσκευών, την εκχώρηση διευθύνσεων IP και την διαφήμιση υπηρεσιών.

## **UPnP Flow & Structure**

Η αρχιτεκτονική UPnP περιλαμβάνει έξι επίπεδα: διεύθυνση, ανακάλυψη, περιγραφή, έλεγχος, εκδηλώσεις και παρουσίαση. Αρχικά, οι συσκευές προσπαθούν να αποκτήσουν μια διεύθυνση IP ή να αυτο-εκχωρήσουν μία (AutoIP). Η φάση ανακάλυψης περιλαμβάνει το SSDP, με τις συσκευές να στέλνουν ενεργά αιτήματα M-SEARCH ή παθητικά να εκπέμπουν μηνύματα NOTIFY για να ανακοινώσουν υπηρεσίες. Το επίπεδο ελέγχου, ζωτικής σημασίας για την αλληλεπίδραση πελάτη-συσκευής, αξιοποιεί μηνύματα SOAP για την εκτέλεση εντολών βάσει περιγραφών συσκευών σε αρχεία XML.

## **IGD & Tools Overview**

Το IGD (Συσκευή Πύλης Διαδικτύου) διευκολύνει προσωρινές χαρτογραφήσεις θυρών σε ρυθμίσεις NAT, επιτρέποντας την αποδοχή εντολών μέσω ανοιχτών σημείων ελέγχου SOAP παρά τους περιορισμούς της τυπικής διεπαφής WAN. Εργαλεία όπως το **Miranda** βοηθούν στην ανακάλυψη υπηρεσιών UPnP και στην εκτέλεση εντολών. Το **Umap** εκθέτει εντολές UPnP προσβάσιμες από το WAN, ενώ αποθετήρια όπως το **upnp-arsenal** προσφέρουν μια ποικιλία εργαλείων UPnP. Το **Evil SSDP** ειδικεύεται στην phishing μέσω πλαστών συσκευών UPnP, φιλοξενώντας πρότυπα για να μιμούνται νόμιμες υπηρεσίες.

## **Evil SSDP Practical Usage**

Το Evil SSDP δημιουργεί αποτελεσματικά πειστικές ψεύτικες συσκευές UPnP, χειραγωγώντας τους χρήστες να αλληλεπιδρούν με φαινομενικά αυθεντικές υπηρεσίες. Οι χρήστες, παραπλανημένοι από την γνήσια εμφάνιση, μπορεί να παρέχουν ευαίσθητες πληροφορίες όπως διαπιστευτήρια. Η ευελιξία του εργαλείου εκτείνεται σε διάφορα πρότυπα, μιμούμενα υπηρεσίες όπως σαρωτές, Office365 και ακόμη και θησαυροφυλάκια κωδικών πρόσβασης, εκμεταλλευόμενοι την εμπιστοσύνη των χρηστών και την ορατότητα του δικτύου. Μετά την καταγραφή διαπιστευτηρίων, οι επιτιθέμενοι μπορούν να ανακατευθύνουν τα θύματα σε καθορισμένες διευθύνσεις URL, διατηρώντας την αξιοπιστία της απάτης.

## **Mitigation Strategies**

Για να καταπολεμήσουν αυτές τις απειλές, οι προτεινόμενες ενέργειες περιλαμβάνουν:

- Απενεργοποίηση του UPnP σε συσκευές όταν δεν είναι απαραίτητο.
- Εκπαίδευση χρηστών σχετικά με την phishing και την ασφάλεια δικτύου.
- Παρακολούθηση της δικτυακής κίνησης για μη κρυπτογραφημένα ευαίσθητα δεδομένα.

Στην ουσία, ενώ το UPnP προσφέρει ευκολία και ρευστότητα στο δίκτυο, ανοίγει επίσης πόρτες σε πιθανή εκμετάλλευση. Η ευαισθητοποίηση και η προληπτική άμυνα είναι το κλειδί για την εξασφάλιση της ακεραιότητας του δικτύου.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
