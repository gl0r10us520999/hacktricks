# Spoofing SSDP i UPnP Devices z EvilSSDP

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się trikami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
{% endhint %}

**Sprawdź [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) po więcej informacji.**

## **Przegląd SSDP i UPnP**

SSDP (Simple Service Discovery Protocol) jest wykorzystywany do reklamowania i odkrywania usług sieciowych, działając na porcie UDP 1900 bez potrzeby konfiguracji DHCP lub DNS. Jest kluczowy w architekturze UPnP (Universal Plug and Play), umożliwiając bezproblemową interakcję między urządzeniami w sieci, takimi jak komputery, drukarki i urządzenia mobilne. Zero-konfiguracyjna sieć UPnP wspiera odkrywanie urządzeń, przypisywanie adresów IP i reklamowanie usług.

## **Przepływ i struktura UPnP**

Architektura UPnP składa się z sześciu warstw: adresowania, odkrywania, opisu, kontroli, zdarzeń i prezentacji. Na początku urządzenia próbują uzyskać adres IP lub przypisać go samodzielnie (AutoIP). Faza odkrywania obejmuje SSDP, w której urządzenia aktywnie wysyłają żądania M-SEARCH lub pasywnie nadają wiadomości NOTIFY, aby ogłosić usługi. Warstwa kontroli, kluczowa dla interakcji klient-urządzenie, wykorzystuje wiadomości SOAP do wykonywania poleceń na podstawie opisów urządzeń w plikach XML.

## **Przegląd IGD i narzędzi**

IGD (Internet Gateway Device) ułatwia tymczasowe mapowanie portów w konfiguracjach NAT, umożliwiając akceptację poleceń przez otwarte punkty kontrolne SOAP mimo standardowych ograniczeń interfejsu WAN. Narzędzia takie jak **Miranda** pomagają w odkrywaniu usług UPnP i wykonywaniu poleceń. **Umap** ujawnia polecenia UPnP dostępne przez WAN, podczas gdy repozytoria takie jak **upnp-arsenal** oferują szereg narzędzi UPnP. **Evil SSDP** specjalizuje się w phishingu za pomocą sfałszowanych urządzeń UPnP, hostując szablony do naśladowania legalnych usług.

## **Praktyczne zastosowanie Evil SSDP**

Evil SSDP skutecznie tworzy przekonujące fałszywe urządzenia UPnP, manipulując użytkownikami, aby wchodzili w interakcje z pozornie autentycznymi usługami. Użytkownicy, oszukani przez autentyczny wygląd, mogą podać wrażliwe informacje, takie jak dane logowania. Wszechstronność narzędzia obejmuje różne szablony, naśladujące usługi takie jak skanery, Office365, a nawet sejfy haseł, wykorzystując zaufanie użytkowników i widoczność w sieci. Po przechwyceniu danych logowania, atakujący mogą przekierować ofiary do wyznaczonych adresów URL, utrzymując wiarygodność oszustwa.

## **Strategie łagodzenia**

Aby zwalczać te zagrożenia, zalecane środki obejmują:

- Wyłączanie UPnP na urządzeniach, gdy nie jest potrzebne.
- Edukowanie użytkowników na temat phishingu i bezpieczeństwa sieci.
- Monitorowanie ruchu sieciowego w poszukiwaniu niezaszyfrowanych wrażliwych danych.

W istocie, podczas gdy UPnP oferuje wygodę i płynność sieci, otwiera również drzwi do potencjalnej eksploatacji. Świadomość i proaktywna obrona są kluczowe dla zapewnienia integralności sieci.

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się trikami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
{% endhint %}
