# Spoofing SSDP e Dispositivos UPnP com EvilSSDP

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}

**Verifique [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para mais informa√ß√µes.**

## **Vis√£o Geral do SSDP & UPnP**

SSDP (Protocolo Simples de Descoberta de Servi√ßos) √© utilizado para publicidade e descoberta de servi√ßos de rede, operando na porta UDP 1900 sem precisar de configura√ß√µes DHCP ou DNS. √â fundamental na arquitetura UPnP (Universal Plug and Play), facilitando a intera√ß√£o sem costura entre dispositivos em rede, como PCs, impressoras e dispositivos m√≥veis. A rede de zero configura√ß√£o do UPnP suporta descoberta de dispositivos, atribui√ß√£o de endere√ßos IP e publicidade de servi√ßos.

## **Fluxo e Estrutura do UPnP**

A arquitetura UPnP √© composta por seis camadas: endere√ßamento, descoberta, descri√ß√£o, controle, eventos e apresenta√ß√£o. Inicialmente, os dispositivos tentam obter um endere√ßo IP ou autoatribuir um (AutoIP). A fase de descoberta envolve o SSDP, com dispositivos enviando ativamente solicita√ß√µes M-SEARCH ou transmitindo passivamente mensagens NOTIFY para anunciar servi√ßos. A camada de controle, vital para a intera√ß√£o cliente-dispositivo, utiliza mensagens SOAP para execu√ß√£o de comandos com base nas descri√ß√µes dos dispositivos em arquivos XML.

## **Vis√£o Geral do IGD & Ferramentas**

IGD (Dispositivo de Gateway de Internet) facilita mapeamentos de porta tempor√°rios em configura√ß√µes NAT, permitindo a aceita√ß√£o de comandos atrav√©s de pontos de controle SOAP abertos, apesar das restri√ß√µes padr√£o da interface WAN. Ferramentas como **Miranda** ajudam na descoberta de servi√ßos UPnP e execu√ß√£o de comandos. **Umap** exp√µe comandos UPnP acess√≠veis pela WAN, enquanto reposit√≥rios como **upnp-arsenal** oferecem uma variedade de ferramentas UPnP. **Evil SSDP** se especializa em phishing atrav√©s de dispositivos UPnP falsificados, hospedando modelos para imitar servi√ßos leg√≠timos.

## **Uso Pr√°tico do Evil SSDP**

Evil SSDP cria efetivamente dispositivos UPnP falsos convincentes, manipulando usu√°rios para interagir com servi√ßos aparentemente aut√™nticos. Usu√°rios, enganados pela apar√™ncia genu√≠na, podem fornecer informa√ß√µes sens√≠veis, como credenciais. A versatilidade da ferramenta se estende a v√°rios modelos, imitando servi√ßos como scanners, Office365 e at√© cofres de senhas, capitalizando a confian√ßa do usu√°rio e a visibilidade da rede. Ap√≥s a captura de credenciais, os atacantes podem redirecionar as v√≠timas para URLs designadas, mantendo a credibilidade da engana√ß√£o.

## **Estrat√©gias de Mitiga√ß√£o**

Para combater essas amea√ßas, as medidas recomendadas incluem:

- Desabilitar UPnP em dispositivos quando n√£o necess√°rio.
- Educar os usu√°rios sobre phishing e seguran√ßa de rede.
- Monitorar o tr√°fego da rede em busca de dados sens√≠veis n√£o criptografados.

Em ess√™ncia, enquanto o UPnP oferece conveni√™ncia e fluidez na rede, tamb√©m abre portas para potenciais explora√ß√µes. A conscientiza√ß√£o e a defesa proativa s√£o fundamentais para garantir a integridade da rede.

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}
