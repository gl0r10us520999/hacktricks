# Spoofing SSDP and UPnP Devices with EvilSSDP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Check [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) for further information.**

## **SSDP & UPnP Overview**

SSDP (Simple Service Discovery Protocol) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ä–µ–∫–ª–∞–º–∏ —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–∏—Ö –ø–æ—Å–ª—É–≥, –ø—Ä–∞—Ü—é—é—á–∏ –Ω–∞ UDP –ø–æ—Ä—Ç—É 1900 –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö DHCP –∞–±–æ DNS. –¶–µ –æ—Å–Ω–æ–≤–æ–ø–æ–ª–æ–∂–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ UPnP (Universal Plug and Play), —â–æ –ø–æ–ª–µ–≥—à—É—î –±–µ–∑–ø–µ—Ä–µ—à–∫–æ–¥–Ω—É –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –º–µ—Ä–µ–∂–µ–≤–∏–º–∏ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ –ü–ö, –ø—Ä–∏–Ω—Ç–µ—Ä–∏ —Ç–∞ –º–æ–±—ñ–ª—å–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó. –ù—É–ª—å–æ–≤–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –º–µ—Ä–µ–∂—ñ UPnP –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è IP-–∞–¥—Ä–µ—Å —Ç–∞ —Ä–µ–∫–ª–∞–º—É –ø–æ—Å–ª—É–≥.

## **UPnP Flow & Structure**

–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ UPnP —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ —à–µ—Å—Ç–∏ —Ä—ñ–≤–Ω—ñ–≤: –∞–¥—Ä–µ—Å–∞—Ü—ñ—è, –≤–∏—è–≤–ª–µ–Ω–Ω—è, –æ–ø–∏—Å, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è, –ø–æ–¥—ñ—ó —Ç–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è. –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–∏—Å—Ç—Ä–æ—ó –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –∞–±–æ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ —ó—ó (AutoIP). –§–∞–∑–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤–∫–ª—é—á–∞—î SSDP, –ø—Ä–∏ —Ü—å–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó –∞–∫—Ç–∏–≤–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å –∑–∞–ø–∏—Ç–∏ M-SEARCH –∞–±–æ –ø–∞—Å–∏–≤–Ω–æ —Ç—Ä–∞–Ω—Å–ª—é—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è NOTIFY –¥–ª—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –ø–æ—Å–ª—É–≥. –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å, –≤–∞–∂–ª–∏–≤–∏–π –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∫–ª—ñ—î–Ω—Ç–∞ –∑ –ø—Ä–∏—Å—Ç—Ä–æ—î–º, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î SOAP-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –æ–ø–∏—Å—ñ–≤ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ —É XML-—Ñ–∞–π–ª–∞—Ö.

## **IGD & Tools Overview**

IGD (Internet Gateway Device) –ø–æ–ª–µ–≥—à—É—î —Ç–∏–º—á–∞—Å–æ–≤–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ —É NAT-–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø—Ä–∏–π–º–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ —á–µ—Ä–µ–∑ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ —Ç–æ—á–∫–∏ SOAP, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É WAN. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ **Miranda**, –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å —É –≤–∏—è–≤–ª–µ–Ω–Ω—ñ –ø–æ—Å–ª—É–≥ UPnP —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –∫–æ–º–∞–Ω–¥. **Umap** –≤—ñ–¥–∫—Ä–∏–≤–∞—î –∫–æ–º–∞–Ω–¥–∏ UPnP, –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ WAN, —Ç–æ–¥—ñ —è–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó, —Ç–∞–∫—ñ —è–∫ **upnp-arsenal**, –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ UPnP. **Evil SSDP** —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –Ω–∞ —Ñ—ñ—à–∏–Ω–≥—É —á–µ—Ä–µ–∑ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó UPnP, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ —à–∞–±–ª–æ–Ω–∏ –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó –ª–µ–≥—ñ—Ç–∏–º–Ω–∏—Ö –ø–æ—Å–ª—É–≥.

## **Evil SSDP Practical Usage**

Evil SSDP –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Å—Ç–≤–æ—Ä—é—î –ø–µ—Ä–µ–∫–æ–Ω–ª–∏–≤—ñ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó UPnP, –º–∞–Ω—ñ–ø—É–ª—é—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏, —â–æ–± –≤–æ–Ω–∏ –≤–∑–∞—î–º–æ–¥—ñ—è–ª–∏ –∑ –Ω–∞ –≤–∏–≥–ª—è–¥ –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω–∏–º–∏ –ø–æ—Å–ª—É–≥–∞–º–∏. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, –æ–±–º–∞–Ω—É—Ç—ñ —Å–ø—Ä–∞–≤–∂–Ω—ñ–º –≤–∏–≥–ª—è–¥–æ–º, –º–æ–∂—É—Ç—å –Ω–∞–¥–∞—Ç–∏ —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ. –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ—Å—Ç—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –ø–æ—à–∏—Ä—é—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω—ñ —à–∞–±–ª–æ–Ω–∏, —ñ–º—ñ—Ç—É—é—á–∏ –ø–æ—Å–ª—É–≥–∏, —Ç–∞–∫—ñ —è–∫ —Å–∫–∞–Ω–µ—Ä–∏, Office365 —ñ –Ω–∞–≤—ñ—Ç—å —Å—Ö–æ–≤–∏—â–∞ –ø–∞—Ä–æ–ª—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–æ–≤—ñ—Ä—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –≤–∏–¥–∏–º—ñ—Å—Ç—å –º–µ—Ä–µ–∂—ñ. –ü—ñ—Å–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∂–µ—Ä—Ç–≤ –Ω–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ URL-–∞–¥—Ä–µ—Å–∏, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å –æ–±–º–∞–Ω—É.

## **Mitigation Strategies**

–©–æ–± –ø—Ä–æ—Ç–∏—Å—Ç–æ—è—Ç–∏ —Ü–∏–º –∑–∞–≥—Ä–æ–∑–∞–º, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—å—Å—è —Ç–∞–∫—ñ –∑–∞—Ö–æ–¥–∏:

- –í–∏–º–∫–Ω–µ–Ω–Ω—è UPnP –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö, –∫–æ–ª–∏ —Ü–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ.
- –û—Å–≤—ñ—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø—Ä–æ —Ñ—ñ—à–∏–Ω–≥ —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—É –±–µ–∑–ø–µ–∫—É.
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–µ–∑–∞—Ö–∏—â–µ–Ω–∏—Ö —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö.

–£ —Å—É—Ç—ñ, —Ö–æ—á–∞ UPnP –ø—Ä–æ–ø–æ–Ω—É—î –∑—Ä—É—á–Ω—ñ—Å—Ç—å —ñ –≥–Ω—É—á–∫—ñ—Å—Ç—å –º–µ—Ä–µ–∂—ñ, –≤—ñ–Ω —Ç–∞–∫–æ–∂ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –¥–≤–µ—Ä—ñ –¥–ª—è –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ—ó –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó. –û–±—ñ–∑–Ω–∞–Ω—ñ—Å—Ç—å —ñ –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–∏–π –∑–∞—Ö–∏—Å—Ç —î –∫–ª—é—á–æ–≤–∏–º–∏ –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –º–µ—Ä–µ–∂—ñ.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
