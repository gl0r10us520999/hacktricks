# Spoofing SSDP et UPnP Devices avec EvilSSDP

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

**Consultez [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) pour plus d'informations.**

## **Aper√ßu de SSDP & UPnP**

SSDP (Simple Service Discovery Protocol) est utilis√© pour la publicit√© et la d√©couverte de services r√©seau, fonctionnant sur le port UDP 1900 sans n√©cessiter de configurations DHCP ou DNS. Il est fondamental dans l'architecture UPnP (Universal Plug and Play), facilitant l'interaction transparente entre les appareils en r√©seau comme les PC, les imprimantes et les appareils mobiles. Le r√©seau sans configuration d'UPnP prend en charge la d√©couverte des appareils, l'attribution d'adresses IP et la publicit√© des services.

## **Flux et Structure UPnP**

L'architecture UPnP se compose de six couches : adressage, d√©couverte, description, contr√¥le, √©v√©nements et pr√©sentation. Au d√©part, les appareils tentent d'obtenir une adresse IP ou d'en auto-attribuer une (AutoIP). La phase de d√©couverte implique le SSDP, les appareils envoyant activement des requ√™tes M-SEARCH ou diffusant passivement des messages NOTIFY pour annoncer des services. La couche de contr√¥le, essentielle pour l'interaction client-appareil, utilise des messages SOAP pour l'ex√©cution de commandes bas√©es sur les descriptions des appareils dans des fichiers XML.

## **Aper√ßu IGD & Outils**

IGD (Internet Gateway Device) facilite les mappages de ports temporaires dans les configurations NAT, permettant l'acceptation de commandes via des points de contr√¥le SOAP ouverts malgr√© les restrictions de l'interface WAN standard. Des outils comme **Miranda** aident √† la d√©couverte de services UPnP et √† l'ex√©cution de commandes. **Umap** expose des commandes UPnP accessibles depuis WAN, tandis que des d√©p√¥ts comme **upnp-arsenal** offrent une gamme d'outils UPnP. **Evil SSDP** se sp√©cialise dans le phishing via des appareils UPnP usurp√©s, h√©bergeant des mod√®les pour imiter des services l√©gitimes.

## **Utilisation Pratique d'Evil SSDP**

Evil SSDP cr√©e efficacement de faux appareils UPnP convaincants, manipulant les utilisateurs pour interagir avec des services apparemment authentiques. Les utilisateurs, tromp√©s par l'apparence authentique, peuvent fournir des informations sensibles comme des identifiants. La polyvalence de l'outil s'√©tend √† divers mod√®les, imitant des services comme des scanners, Office365, et m√™me des coffres-forts de mots de passe, capitalisant sur la confiance des utilisateurs et la visibilit√© du r√©seau. Apr√®s la capture des identifiants, les attaquants peuvent rediriger les victimes vers des URL d√©sign√©es, maintenant la cr√©dibilit√© de la tromperie.

## **Strat√©gies d'Att√©nuation**

Pour lutter contre ces menaces, les mesures recommand√©es incluent :

- D√©sactiver UPnP sur les appareils lorsqu'il n'est pas n√©cessaire.
- √âduquer les utilisateurs sur le phishing et la s√©curit√© r√©seau.
- Surveiller le trafic r√©seau pour des donn√©es sensibles non chiffr√©es.

En essence, bien qu'UPnP offre commodit√© et fluidit√© r√©seau, il ouvre √©galement la porte √† une exploitation potentielle. La sensibilisation et la d√©fense proactive sont essentielles pour garantir l'int√©grit√© du r√©seau.

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
