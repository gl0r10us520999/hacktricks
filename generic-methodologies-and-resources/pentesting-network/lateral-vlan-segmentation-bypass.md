# Lateral VLAN Segmentation Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

рдпрджрд┐ рд╕реНрд╡рд┐рдЪ рддрдХ рд╕реАрдзреА рдкрд╣реБрдБрдЪ рдЙрдкрд▓рдмреНрдз рд╣реИ, рддреЛ VLAN рд╡рд┐рднрд╛рдЬрди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдЬреБрдбрд╝реЗ рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛, рд▓рдХреНрд╖рд┐рдд VLANs рдХреЗ рд▓рд┐рдП рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛, рдФрд░ IP рдкрддреЗ рд╕реЗрдЯ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдпрд╛ рддреЛ рдЧрддрд┐рд╢реАрд▓ (DHCP) рдпрд╛ рд╕реНрдереИрддрд┐рдХ, рдкрд░рд┐рджреГрд╢реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░ (**рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)).**

рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬреБрдбрд╝реЗ рдкреЛрд░реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ CDP рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ **include** рдорд╛рд╕реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреЛрд░реНрдЯ рдХреА рдЦреЛрдЬ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдпрджрд┐ CDP рдХрд╛рд░реНрдпрд╢реАрд▓ рдирд╣реАрдВ рд╣реИ, рддреЛ MAC рдкрддреЗ рдХреА рдЦреЛрдЬ рдХрд░рдХреЗ рдкреЛрд░реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдореМрдЬреВрджрд╛ VLANs рдХреА рдПрдХ рд╕реВрдЪреА рддреИрдпрд╛рд░ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЙрдирдХреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдлрд┐рд░ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд╕реМрдВрдкреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рднрд┐рдиреНрди VLANs рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреНрд╖рдо рд╣реЛрддреА рд╣реИред рдЙрдкрдпреЛрдЧ рдореЗрдВ рдкреЛрд░реНрдЯ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, VLAN 10 рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред
```
SW1# show vlan brief
```
**рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХрд░рдиреЗ рдХрд╛ рдЕрд░реНрде рд╣реИ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЛрдб рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдирд╛**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рдмрджрд▓рдиреЗ рд╕реЗ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдмрд╛рдзрд┐рдд рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдмрд╛рдж рдореЗрдВ рдмрд╣рд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдлрд┐рд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, VLAN ID рд╕реМрдВрдкреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рд╕рдХреНрд░рд┐рдп рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
рдЗрд╕рдХреЗ рдмрд╛рдж, DHCP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдкрддрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ DHCP рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдкрддреЛрдВ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
VLAN 10 рдкрд░ рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ рд╕реНрдерд┐рд░ IP рдкрддрд╛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг VLANs 10, 20, 50, рдФрд░ 60 рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдкрд░ ICMP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЖрд░рдВрдн рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЕрдВрддрддрдГ, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ VLAN рд╡рд┐рднрд╛рдЬрди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА VLAN рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдХреА рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдордВрдЪ рддреИрдпрд╛рд░ рд╣реЛрддрд╛ рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
