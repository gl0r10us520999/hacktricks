{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Profundiza tu experiencia en **Mobile Security** con 8kSec Academy. Domina la seguridad de iOS y Android a trav칠s de nuestros cursos autoguiados y obt칠n certificaci칩n:

{% embed url="https://academy.8ksec.io/" %}

# **Manipulaci칩n de TTL**

Env칤a algunos paquetes con un TTL suficiente para llegar al IDS/IPS pero no lo suficiente para llegar al sistema final. Y luego, env칤a otros paquetes con las mismas secuencias que los anteriores para que el IPS/IDS piense que son repeticiones y no los verifique, pero en realidad est치n llevando el contenido malicioso.

**Opci칩n de Nmap:** `--ttlvalue <value>`

# Evitando firmas

Simplemente agrega datos basura a los paquetes para evitar la firma del IPS/IDS.

**Opci칩n de Nmap:** `--data-length 25`

# **Paquetes fragmentados**

Simplemente fragmenta los paquetes y env칤alos. Si el IDS/IPS no tiene la capacidad de reensamblarlos, llegar치n al host final.

**Opci칩n de Nmap:** `-f`

# **Checksum** _**inv치lido**_

Los sensores generalmente no calculan el checksum por razones de rendimiento. As칤 que un atacante puede enviar un paquete que ser치 **interpretado por el sensor pero rechazado por el host final.** Ejemplo:

Env칤a un paquete con la bandera RST y un checksum inv치lido, entonces, el IPS/IDS puede pensar que este paquete va a cerrar la conexi칩n, pero el host final descartar치 el paquete ya que el checksum es inv치lido.

# **Opciones IP y TCP poco comunes**

Un sensor podr칤a ignorar paquetes con ciertas banderas y opciones establecidas dentro de los encabezados IP y TCP, mientras que el host de destino acepta el paquete al recibirlo.

# **Superposici칩n**

Es posible que al fragmentar un paquete, exista alg칰n tipo de superposici칩n entre paquetes (quiz치s los primeros 8 bytes del paquete 2 se superponen con los 칰ltimos 8 bytes del paquete 1, y los 칰ltimos 8 bytes del paquete 2 se superponen con los primeros 8 bytes del paquete 3). Entonces, si el IDS/IPS los reensambla de una manera diferente a la del host final, se interpretar치 un paquete diferente.\
O tal vez, 2 paquetes con el mismo desplazamiento llegan y el host tiene que decidir cu치l toma.

* **BSD**: Tiene preferencia por paquetes con _offset_ m치s peque침o. Para paquetes con el mismo offset, elegir치 el primero.
* **Linux**: Al igual que BSD, pero prefiere el 칰ltimo paquete con el mismo offset.
* **Primero** (Windows): Primer valor que llega, valor que se queda.
* **칔ltimo** (cisco): 칔ltimo valor que llega, valor que se queda.

# Herramientas

* [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Profundiza tu experiencia en **Mobile Security** con 8kSec Academy. Domina la seguridad de iOS y Android a trav칠s de nuestros cursos autoguiados y obt칠n certificaci칩n:

{% embed url="https://academy.8ksec.io/" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
