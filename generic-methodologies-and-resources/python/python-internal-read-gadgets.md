# Python рдЖрдВрддрд░рд┐рдХ рдкрдарди рдЧреИрдЬреЗрдЯреНрд╕

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
{% endhint %}

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рд╡рд┐рднрд┐рдиреНрди рд╕реБрд░рдХреНрд╖рд╛ рдЧрдВрднреАрд░рддрд╛рдПрдВ рдЬреИрд╕реЗ рдХрд┐ [**Python Format Strings**](bypass-python-sandboxes/#python-format-string) рдпрд╛ [**Class Pollution**](class-pollution-pythons-prototype-pollution.md) рдЖрдкрдХреЛ **Python рдЖрдВрддрд░рд┐рдХ рдбреЗрдЯрд╛ рдкрдарди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдХреЛрдб рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛рдиреЗ рджреЗрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдПрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдХреЛ рдЗрди рдкрдарди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдВрднреАрд░рддрд╛ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдПред

### Flask - рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдкрдарди

рдПрдХ Flask рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдореБрдЦреНрдп рдкреГрд╖реНрда рд╢рд╛рдпрдж **`app`** рдЧреНрд▓реЛрдмрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрдЧрд╛ рдЬрд╣рд╛рдБ рдпрд╣ **рдЧреБрдкреНрдд рдХреВрдЯ рд╕рдорд╛рдХреГрдд рд╣реЛрддрд╛ рд╣реИ**ред
```python
app = Flask(__name__, template_folder='templates')
app.secret_key = '(:secret:)'
```
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдХрд┐рд╕реА рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ **рдЧреНрд▓реЛрдмрд▓ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП [**рдмрд╛рдЗрдкрд╛рд╕ рдкрд╛рдпрдерди рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреЗрдЬ**](bypass-python-sandboxes/) рд╕реЗред

рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрд╣рд╛рдВ **рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдкрд╛рдпрдерди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИ**, рдЖрдкрдХреЛ рдореБрдЦреНрдп рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧреИрдЬреЗрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдЧреНрд▓реЛрдмрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ `app.secret_key`** рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВ рдФрд░ рдлреНрд▓рд╛рд╕реНрдХ рд╕реАрдХреНрд░реЗрдЯ рдХреБрдВрдЬреА рдХреЛ рдмрджрд▓ рд╕рдХреЗрдВ рдФрд░ [**рдЗрд╕ рдХреБрдВрдЬреА рдХреЛ рдЬрд╛рдирдХрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ**](../../network-services-pentesting/pentesting-web/flask.md#flask-unsign) рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВред

рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рдПрдХ рдРрд╕рд╛ рдкреЗрд▓реЛрдб:

{% code overflow="wrap" %}
```python
__init__.__globals__.__loader__.__init__.__globals__.sys.modules.__main__.app.secret_key
```
{% endcode %}

рдЗрд╕ payload рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ **`app.secret_key` рдХреЛ рдмрджрд▓рдиреЗ** рдХреЗ рд▓рд┐рдП (рдЖрдкрдХреЗ рдРрдк рдореЗрдВ рдирд╛рдо рдЕрд▓рдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ) рддрд╛рдХрд┐ рдЖрдк рдирдП рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡рд╛рд▓реЗ flask cookies рдХреЛ рд╕рд╛рдЗрди рдХрд░ рд╕рдХреЗрдВред

### Werkzeug - machine\_id рдФрд░ node uuid

[**рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рдЗрди payload рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ**](https://vozec.fr/writeups/tweedle-dum-dee/) рдЖрдк **machine\_id** рдФрд░ **uuid** рдиреЛрдб рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗрдВрдЧреЗ, рдЬреЛ рд╣реИрдВ **рдореБрдЦреНрдп рд░рд╣рд╕реНрдп** рдЬрд┐рдирдХреА рдЖрдкрдХреЛ [**Werkzeug рдкрд┐рди рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](../../network-services-pentesting/pentesting-web/werkzeug.md) рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдк `/console` рдореЗрдВ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ **рдбреАрдмрдЧ рдореЛрдб рд╕рдХреНрд╖рдо рд╣реИ:**
```python
{ua.__class__.__init__.__globals__[t].sys.modules[werkzeug.debug]._machine_id}
{ua.__class__.__init__.__globals__[t].sys.modules[werkzeug.debug].uuid._node}
```
{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **`app.py`** рдХреЗ **рд╕рд░реНрд╡рд░ рдХрд╛ рд╕реНрдерд╛рдиреАрдп рдкрде** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рдХреБрдЫ **рддреНрд░реБрдЯрд┐** рдЙрддреНрдкрдиреНрди рдХрд░рдХреЗ рдЬреЛ рдЖрдкрдХреЛ **рдкрде рджреЗрдЧреА**ред
{% endhint %}

рдпрджрд┐ рдХрдордЬреЛрд░реА рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдкрд╛рдпрдерди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИ, рддреЛ рдореБрдЦреНрдп рдкрд╛рдпрдерди рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд┐рдЫрд▓реЗ рдлреНрд▓рд╛рд╕реНрдХ рдЯреНрд░рд┐рдХ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

{% hint style="success" %}
рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рдЬреАрд╕реАрдкреА рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЬреАрд╕реАрдкреА рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}
