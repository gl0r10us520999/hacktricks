# Kötü İkiz EAP-TLS

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR gönderin.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Ödül avcılığı ipucu**: **Intigriti'ye kaydolun**, hackerlar tarafından oluşturulan bir premium **ödül avcılığı platformu**! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresinde bize katılın ve **$100,000**'a kadar ödüller kazanmaya başlayın!

{% embed url="https://go.intigriti.com/hacktricks" %}

Bir noktada, aşağıdaki yazıda önerilen çözümü kullanmam gerekiyordu ancak [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) adımları modern kali (2019v3) üzerinde artık çalışmıyordu.\
Neyse ki, onları çalışır hale getirmek kolaydı.\
Sadece buradan hostapd-2.6'yı indirmeniz gerekiyor: [https://w1.fi/releases/](https://w1.fi/releases) ve hostapd-wpe'yi tekrar derlemeden önce şunları yükleyin: `apt-get install libssl1.0-dev`

### Kablosuz Ağlarda EAP-TLS'in Analizi ve Sömürülmesi

#### Arka Plan: Kablosuz Ağlarda EAP-TLS
EAP-TLS, sertifikaları kullanarak istemci ve sunucu arasında karşılıklı kimlik doğrulaması sağlayan bir güvenlik protokolüdür. Bağlantı, yalnızca istemci ve sunucunun birbirlerinin sertifikalarını doğrulaması durumunda kurulur.

#### Karşılaşılan Zorluk
Bir değerlendirme sırasında, `hostapd-wpe` aracını kullanırken ilginç bir hata ile karşılaşıldı. Aracın, istemcinin sertifikasının bilinmeyen bir Sertifika Yetkilisi (CA) tarafından imzalanmış olmasından dolayı istemcinin bağlantısını reddetti. Bu, istemcinin sahte sunucunun sertifikasına güvendiğini göstererek, istemci tarafındaki gevşek güvenlik yapılandırmalarını işaret etti.

#### Amaç: Orta Adam Saldırısı (MiTM) Kurulumu
Amacımız, aracı herhangi bir istemci sertifikasını kabul edecek şekilde değiştirmekti. Bu, kötü niyetli kablosuz ağ ile bağlantı kurmaya ve MiTM saldırısını etkinleştirmeye olanak tanıyacak, potansiyel olarak düz metin kimlik bilgilerini veya diğer hassas verileri yakalamaya olanak sağlayacaktı.

#### Çözüm: `hostapd-wpe`'yi Değiştirme
`hostapd-wpe`'nin kaynak kodunun incelenmesi, istemci sertifikası doğrulamasının OpenSSL işlevi `SSL_set_verify` içindeki bir parametre (`verify_peer`) tarafından kontrol edildiğini ortaya koydu. Bu parametrenin değerini 1'den (doğrulama) 0'a (doğrulama yapma) değiştirerek, aracın herhangi bir istemci sertifikasını kabul etmesi sağlandı.

#### Saldırının Yürütülmesi
1. **Ortam Kontrolü:** Kablosuz ağları izlemek ve hedefleri belirlemek için `airodump-ng` kullanın.
2. **Sahte AP Kurulumu:** Değiştirilmiş `hostapd-wpe`'yi çalıştırarak, hedef ağı taklit eden sahte bir Erişim Noktası (AP) oluşturun.
3. **Tutsak Portalı Özelleştirme:** Tutsak portalının giriş sayfasını hedef kullanıcı için meşru ve tanıdık görünmesi için özelleştirin.
4. **De-authentication Saldırısı:** İsteğe bağlı olarak, istemciyi meşru ağdan ayırmak ve onları sahte AP'ye bağlamak için bir de-auth saldırısı gerçekleştirin.
5. **Kimlik Bilgilerinin Yakalanması:** İstemci sahte AP'ye bağlandığında ve tutsak portalı ile etkileşime geçtiğinde, kimlik bilgileri yakalanır.

#### Saldırıdan Gözlemler
- Windows makinelerinde, sistem web gezintisi denendiğinde sahte AP'ye otomatik olarak bağlanabilir ve tutsak portalı sunulabilir.
- iPhone'da, kullanıcıya yeni bir sertifika kabul etmesi gerektiği ve ardından tutsak portalının sunulacağı bildirilebilir.

#### Sonuç
EAP-TLS güvenli kabul edilse de, etkinliği doğru yapılandırmaya ve son kullanıcıların dikkatli davranışlarına bağlıdır. Yanlış yapılandırılmış cihazlar veya habersiz kullanıcılar, EAP-TLS korumalı bir ağın güvenliğini zayıflatabilir.

Daha fazla ayrıntı için https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/ adresini kontrol edin.

## Referanslar
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Ödül avcılığı ipucu**: **Intigriti'ye kaydolun**, hackerlar tarafından oluşturulan bir premium **ödül avcılığı platformu**! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresinde bize katılın ve **$100,000**'a kadar ödüller kazanmaya başlayın!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve uygulayın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**Abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarını paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR gönderin.

</details>
{% endhint %}
