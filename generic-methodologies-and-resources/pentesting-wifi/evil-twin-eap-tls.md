# Κακόβουλο Δίκτυο EAP-TLS

{% hint style="success" %}
Μάθε & εξάσκησε στο Hacking του AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθε & εξάσκησε στο Hacking του GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξε το HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Συμμετέχετε** 💬 στην [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs** στα αποθετήρια [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Συμβουλή για bug bounty**: **Εγγραφείτε** στο **Intigriti**, μια προηγμένη **πλατφόρμα bug bounty δημιουργημένη από χάκερς, για χάκερς**! Γίνετε μέλος στο [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) σήμερα, και αρχίστε να κερδίζετε αμοιβές έως **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Σε κάποιο σημείο χρειάστηκε να χρησιμοποιήσω την προτεινόμενη λύση από την ανάρτηση παρακάτω, αλλά τα βήματα στο [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) δεν λειτουργούσαν πλέον στο σύγχρονο kali (2019v3).\
Πάντως, είναι εύκολο να τα κάνετε να λειτουργήσουν.\
Χρειάζεται μόνο να κατεβάσετε το hostapd-2.6 από εδώ: [https://w1.fi/releases/](https://w1.fi/releases) και πριν τη σύνθεση ξανά του hostapd-wpe εγκαταστήστε: `apt-get install libssl1.0-dev`

### Ανάλυση και Εκμετάλλευση του EAP-TLS σε Ασύρματα Δίκτυα

#### Υπόβαθρο: EAP-TLS σε Ασύρματα Δίκτυα
Το EAP-TLS είναι ένα πρωτόκολλο ασφαλείας που παρέχει αμοιβαία πιστοποίηση μεταξύ πελάτη και διακομιστή χρησιμοποιώντας πιστοποιητικά. Η σύνδεση καθορίζεται μόνο εάν τόσο ο πελάτης όσο και ο διακομιστής πιστοποιούν τα πιστοποιητικά τους.

#### Πρόκληση που Αντιμετωπίστηκε
Κατά τη διάρκεια μιας αξιολόγησης, συναντήθηκε ένα ενδιαφέρον σφάλμα κατά τη χρήση του εργαλείου `hostapd-wpe`. Το εργαλείο απέρριψε τη σύνδεση του πελάτη επειδή το πιστοποιητικό του πελάτη ήταν υπογεγραμμένο από μια άγνωστη Αρχή Πιστοποίησης (CA). Αυτό υποδήλωνε ότι ο πελάτης δεν εμπιστευόταν το πλαστό πιστοποιητικό του διακομιστή, δείχνοντας ανεπαρκείς ρυθμίσεις ασφαλείας στην πλευρά του πελάτη.

#### Στόχος: Δημιουργία Επίθεσης Man-in-the-Middle (MiTM)
Ο στόχος ήταν να τροποποιηθεί το εργαλείο ώστε να δέχεται οποιοδήποτε πιστοποιητικό πελάτη. Αυτό θα επέτρεπε την καθιέρωση μιας σύνδεσης με το κακόβουλο ασύρματο δίκτυο και θα ενεργοποιούσε μια επίθεση MiTM, πιθανόν καταγράφοντας κείμενο κωδικών πρόσβασης ή άλλα ευαίσθητα δεδομένα.

#### Λύση: Τροποποίηση του `hostapd-wpe`
Η ανάλυση του πηγαίου κώδικα του `hostapd-wpe` έδειξε ότι η επικύρωση του πιστοποιητικού του πελάτη ελέγχεται από ένα παράμετρο (`verify_peer`) στη λειτουργία OpenSSL `SSL_set_verify`. Αλλάζοντας την τιμή αυτής της παραμέτρου από 1 (επικύρωση) σε 0 (μην επικυρώνεται), το εργαλείο έγινε να δέχεται οποιοδήποτε πιστοποιητικό πελάτη.

#### Εκτέλεση της Επίθεσης
1. **Έλεγχος Περιβάλλοντος:** Χρησιμοποιήστε το `airodump-ng` για την παρακολούθηση ασύρματων δικτύων και την αναγνώριση στόχων.
2. **Δημιουργία Ψεύτικου AP:** Εκτελέστε το τροποποιημένο `hostapd-wpe` για να δημιουργήσετε ένα Ϩεύτικο Σημείο Πρόσβασης (AP) που μιμείται το δίκτυο στόχο.
3. **Προσαρμογή Προσωρινής Σελίδας:** Προσαρμόστε τη σελίδα σύνδεσης της προσωρινής σελίδας ώστε να φαίνεται νόμιμη και γνώριμη στον χρήστη στόχο.
4. **Επίθεση De-authentication:** Προαιρετικά, εκτελέστε μια επίθεση απο-πιστοποίησης για να αποσυνδέσετε τον πελάτη από το νόμιμο δίκτυο και να τον συνδέσετε στο Ϩεύτικο AP.
5. **Καταγραφή Διαπιστευτικών:** Μόλις ο πελάτης συνδεθεί στο ψεύτικο AP και αλληλεπιδράσει με την προσωρινή σελίδα, τα διαπιστευτήριά του καταγράφονται.

#### Παρατηρήσεις από την Επίθεση
- Σε μηχανήματα με Windows, το σύστημα ενδέχεται να συνδεθεί αυτόματα στο Ϩεύτικο AP, παρουσιάζοντας την προσωρινή σελίδα όταν προσπαθείται πλοήγηση στον ιστό.
- Σε ένα iPhone, ο χρήστης ενδέχεται να κληθεί να αποδεχτεί ένα νέο πιστοποιητικό και στη συνέχεια να παρουσιαστεί με την προσωρινή σελίδα.

#### Συμπέρασμα
Ενώ το EAP-TLS θεωρείται ασφαλές, η αποτελεσματικότητά του εξαρτάται σε μεγάλο βαθμό από τη σωστή ρύθμιση και την προσεκτική συμπεριφορά των τελικών χρηστών. Μη σωστά ρυθμισμένες συσκευές ή αφελείς χρήστες που αποδέχονται ψευδείς πιστοποιητικά μπορούν να υπονομεύσουν την ασφάλεια ενός δικτύου που προστατεύεται με EAP-TLS.

Για περισσότερες λεπτομέρειες ελέγξτε το https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Αναφορές
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Συμβουλή για bug bounty**: **Εγγραφείτε** στο **Intigriti**, μια προηγμένη **πλατφόρμα bug bounty δημιουργημένη από χάκερς, για χάκερς**! Γίνετε μέλος στο [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) σήμερα, και αρχίστε να κερδίζετε αμοιβές έως **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Μάθε & εξάσκησε στο Hacking του AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Εκπαίδευση HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθε & εξάσκησε στο Hacking του GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Εκπαίδευση HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξ
