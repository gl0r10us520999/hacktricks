# Evil Twin EAP-TLS

{% hint style="success" %}
Jifunze na zoezi la AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Mafunzo ya HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na zoezi la GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Mafunzo ya HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Mwongozo wa tuzo ya mdudu**: **Jisajili** kwa **Intigriti**, jukwaa la **tuzo za mdudu za malipo lililoundwa na wadukuzi, kwa wadukuzi**! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na anza kupata tuzo hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Kwa wakati fulani nilihitaji kutumia suluhisho lililopendekezwa na chapisho hapa chini lakini hatua katika [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) haikufanya kazi tena katika kali ya kisasa (2019v3).\
Lakini, ni rahisi kufanya kazi.\
Unahitaji tu kupakua hostapd-2.6 kutoka hapa: [https://w1.fi/releases/](https://w1.fi/releases/) na kabla ya kusanikisha tena hostapd-wpe: `apt-get install libssl1.0-dev`

### Uchambuzi na Kutumia EAP-TLS katika Mitandao ya Wireless

#### Msingi: EAP-TLS katika Mitandao ya Wireless
EAP-TLS ni itifaki ya usalama inayotoa uwakilishaji wa pande zote kati ya mteja na seva kwa kutumia vyeti. Uunganisho unafanywa tu ikiwa mteja na seva wanathibitisha vyeti vya kila mmoja.

#### Changamoto Iliyokutana
Wakati wa tathmini, kosa la kuvutia lilikutwa wakati wa kutumia zana ya `hostapd-wpe`. Zana ilikataa uunganisho wa mteja kwa sababu cheti cha mteja kilikuwa kimesainiwa na Mamlaka ya Cheti (CA) isiyojulikana. Hii ilionyesha kuwa mteja hakuthibitisha cheti bandia cha seva, ikionyesha mipangilio dhaifu ya usalama upande wa mteja.

#### lengo: Kuweka Mashambulizi ya Kati-kati (MiTM)
Lengo lilikuwa kurekebisha zana ili kukubali cheti chochote cha mteja. Hii ingewezesha kuunganisha kwenye mtandao wa wireless wenye nia mbaya na kuruhusu shambulio la MiTM, ambalo linaweza kukamata nywila za maandishi wazi au data nyingine nyeti.

#### Suluhisho: Kubadilisha `hostapd-wpe`
Uchambuzi wa msimbo wa chanzo wa `hostapd-wpe` ulifunua kuwa uthibitishaji wa cheti cha mteja ulidhibitiwa na parameter (`verify_peer`) katika kazi ya OpenSSL `SSL_set_verify`. Kwa kubadilisha thamani ya parameter hii kutoka 1 (kuthibitisha) hadi 0 (kutokuthibitisha), zana ilifanywa kukubali cheti chochote cha mteja.

#### Utekelezaji wa Shambulio
1. **Uchunguzi wa Mazingira:** Tumia `airodump-ng` kufuatilia mitandao ya wireless na kutambua malengo.
2. **Sanidi AP Bandia:** Anzisha `hostapd-wpe` iliyorekebishwa kuunda Kituo cha Kufikia Bandia (AP) kinachofanana na mtandao wa lengo.
3. **Uboreshaji wa Ukurasa wa Kuingia wa Kizuizi:** Boresha ukurasa wa kuingia wa kizuizi cha kufanya uonekane halali na wa kawaida kwa mtumiaji wa lengo.
4. **Shambulio la Kufuta Uthibitisho:** Hiari, fanya shambulio la kufuta uthibitisho ili kumtoa mteja kwenye mtandao halali na kumwunganisha kwenye AP bandia.
5. **Kukamata Nywila:** Mara tu mteja anapounganisha kwenye AP bandia na kuingiliana na ukurasa wa kuingia wa kizuizi, nywila zao zinakamatwa.

#### Uchunguzi kutoka kwa Shambulio
- Kwenye mashine za Windows, mfumo unaweza kuunganisha moja kwa moja kwenye AP bandia, ukionyesha ukurasa wa kuingia wa kizuizi wakati ujaribu kuvinjari wavuti.
- Kwenye iPhone, mtumiaji anaweza kuombwa kukubali cheti kipya na kisha kuonyeshwa na ukurasa wa kuingia wa kizuizi.

#### Hitimisho
Ingawa EAP-TLS inachukuliwa kuwa salama, ufanisi wake unategemea sana mipangilio sahihi na tabia ya waendeshaji wa mwisho. Vifaa vilivyo na mipangilio mibovu au watumiaji wasio na shaka kukubali vyeti bandia wanaweza kudhoofisha usalama wa mtandao uliolindwa na EAP-TLS.

Kwa maelezo zaidi angalia https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Marejeo
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Mwongozo wa tuzo ya mdudu**: **Jisajili** kwa **Intigriti**, jukwaa la **tuzo za mdudu za malipo lililoundwa na wadukuzi, kwa wadukuzi**! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na anza kupata tuzo hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Jifunze na zoezi la AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Mafunzo ya HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na zoezi la GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Mafunzo ya HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
