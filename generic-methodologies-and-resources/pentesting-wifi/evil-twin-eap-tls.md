# Zli blizanac EAP-TLS

{% hint style="success" %}
Naučite i vežbajte hakovanje AWS-a:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks obuka AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Naučite i vežbajte hakovanje GCP-a: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks obuka GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! Pridružite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i počnite da zarađujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

U jednom trenutku morao sam da koristim predloženo rešenje iz posta ispod, ali koraci na [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) više nisu radili na modernom kali (2019v3).\
U svakom slučaju, lako je da ih prilagodite da rade.\
Samo trebate preuzeti hostapd-2.6 odavde: [https://w1.fi/releases/](https://w1.fi/releases/) i pre ponovnog kompajliranja hostapd-wpe instalirati: `apt-get install libssl1.0-dev`

### Analiza i iskorišćavanje EAP-TLS u bežičnim mrežama

#### Pozadina: EAP-TLS u bežičnim mrežama
EAP-TLS je sigurnosni protokol koji omogućava međusobnu autentikaciju između klijenta i servera korišćenjem sertifikata. Veza se uspostavlja samo ako se klijent i server međusobno autentiču putem svojih sertifikata.

#### Izazov koji je naišao
Tokom procene, naišla je zanimljiva greška prilikom korišćenja alata `hostapd-wpe`. Alat je odbio povezivanje klijenta zbog toga što je sertifikat klijenta potpisan od strane nepoznatog sertifikacionog tela (CA). To je ukazalo na to da klijent nije verovao lažnom serverovom sertifikatu, što ukazuje na nepažljive sigurnosne konfiguracije na strani klijenta.

#### Cilj: Postavljanje napada čovek-u-sredini (MiTM)
Cilj je bio da se izmeni alat kako bi prihvatao bilo koji klijentski sertifikat. Ovo bi omogućilo uspostavljanje veze sa zlonamernom bežičnom mrežom i omogućilo napad čovek-u-sredini, potencijalno hvatanje tekstualnih lozinki ili drugih osetljivih podataka.

#### Rešenje: Modifikacija `hostapd-wpe`
Analiza izvornog koda `hostapd-wpe` otkrila je da je validacija klijentskog sertifikata kontrolisana parametrom (`verify_peer`) u OpenSSL funkciji `SSL_set_verify`. Menjanjem vrednosti ovog parametra sa 1 (validacija) na 0 (ne validacija), alat je napravljen da prihvata bilo koji klijentski sertifikat.

#### Izvršenje napada
1. **Provera okoline:** Koristite `airodump-ng` da pratite bežične mreže i identifikujete ciljeve.
2. **Postavljanje lažne AP:** Pokrenite modifikovani `hostapd-wpe` da kreirate lažnu pristupnu tačku (AP) imitirajući ciljnu mrežu.
3. **Prilagođavanje zarobljeničkog portala:** Prilagodite stranicu za prijavu zarobljeničkog portala da izgleda legitimno i poznato ciljnom korisniku.
4. **Napad deautentikacije:** Opciono, izvedite napad deautentikacije da odvojite klijenta sa legitimne mreže i povežete ga sa lažnom AP.
5. **Hvatanje lozinki:** Kada se klijent poveže sa lažnom AP i interaguje sa zarobljeničkim portalom, njegove lozinke se hvataju.

#### Opservacije iz napada
- Na Windows mašinama, sistem može automatski da se poveže sa lažnom AP, prikazujući zarobljenički portal kada se pokuša sa web navigacijom.
- Na iPhone-u, korisnik može biti zamoljen da prihvati novi sertifikat, a zatim mu se prikazuje zarobljenički portal.

#### Zaključak
Iako se EAP-TLS smatra sigurnim, njegova efikasnost u velikoj meri zavisi od ispravne konfiguracije i opreznog ponašanja krajnjih korisnika. Pogrešno konfigurisani uređaji ili nesumnjivi korisnici koji prihvataju lažne sertifikate mogu ugroziti sigurnost mreže zaštićene EAP-TLS-om.

Za više detalja pogledajte https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Reference
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Savet za bug bounty**: **Prijavite se** za **Intigriti**, premium **platformu za bug bounty kreiranu od hakera, za hakere**! Pridružite nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i počnite da zarađujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Naučite & vežbajte hakovanje AWS-a:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks obuka AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Naučite & vežbajte hakovanje GCP-a: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks obuka GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakovanje trikova slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
