# Boosaard EAP-TLS

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **teken aan** vir **Intigriti**, 'n premium **bug bounty platform geskep deur hackers, vir hackers**! Sluit by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) vandag, en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

Op 'n sekere punt moes ek die voorgestelde oplossing deur die onderstaande pos gebruik, maar die stappe in [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) het nie meer in moderne kali (2019v3) gewerk nie.\
Hoe dan ook, dit is maklik om hulle te laat werk.\
Jy hoef net die hostapd-2.6 van hier af te laai: [https://w1.fi/releases/](https://w1.fi/releases/) en voordat jy weer hostapd-wpe installeer: `apt-get install libssl1.0-dev`

### Analiseer en Exploiteer EAP-TLS in Draadlose Netwerke

#### Agtergrond: EAP-TLS in Draadlose Netwerke
EAP-TLS is 'n sekuriteitsprotokol wat wedersydse outentifisering tussen klient en bediener bied deur sertifikate te gebruik. Die verbinding word slegs tot stand gebring as beide die klient en die bediener mekaar se sertifikate outentiseer.

#### Uitdaging te√´gekom
Tydens 'n assessering is 'n interessante fout te√´gekom toe die `hostapd-wpe`-werktuig gebruik is. Die werktuig het die klient se verbinding verwerp omdat die klient se sertifikaat deur 'n onbekende Sertifiseringsowerheid (CA) onderteken is. Dit het aangedui dat die klient die vals bediener se sertifikaat vertrou het, wat op lakse sekuriteitskonfigurasies aan die klientkant gedui het.

#### Doel: Opstel van 'n Man-in-die-Middel (MiTM) Aanval
Die doel was om die werktuig te wysig om enige klient sertifikaat te aanvaar. Dit sou die totstandkoming van 'n verbinding met die boosaardige draadlose netwerk moontlik maak en 'n MiTM-aanval moontlik maak, wat moontlik platte teks-gedagtes of ander sensitiewe data kan vasvang.

#### Oplossing: Wysiging van `hostapd-wpe`
'n Analise van die bronkode van `hostapd-wpe` het aan die lig gebring dat die klient sertifikaatvalidering beheer is deur 'n parameter (`verify_peer`) in die OpenSSL-funksie `SSL_set_verify`. Deur hierdie parameter se waarde van 1 (valideer) na 0 (moet nie valideer nie) te verander, is die werktuig gemaak om enige klient sertifikaat te aanvaar.

#### Uitvoering van die Aanval
1. **Omgewingskontrole:** Gebruik `airodump-ng` om draadlose netwerke te monitor en te identifiseer.
2. **Stel Vals AP op:** Voer die gewysigde `hostapd-wpe` uit om 'n vals Toegangspunt (AP) te skep wat die teikenetwerk naboots.
3. **Gekapte Portal Aanpassing:** Pas die aanmeldingsbladsy van die gekapte portal aan om legitiem en bekend aan die teikengebruiker te lyk.
4. **De-autentiseringsaanval:** Opsioneel, voer 'n de-autentiseringsaanval uit om die klient van die regte netwerk af te koppel en hulle met die vals AP te verbind.
5. **Vasvang van Geldele:** Sodra die klient met die vals AP verbind en met die gekapte portal interaksie het, word hul geldele vasgevang.

#### Waarnemings van die Aanval
- Op Windows-masjiene kan die stelsel outomaties met die vals AP verbind, en die gekapte portal aanbied wanneer webnavigasie probeer word.
- Op 'n iPhone kan die gebruiker versoek word om 'n nuwe sertifikaat te aanvaar en dan met die gekapte portal voorgel√™ word.

#### Gevolgtrekking
Alhoewel EAP-TLS as veilig beskou word, hang sy doeltreffendheid sterk af van die korrekte konfigurasie en versigtige gedrag van eindgebruikers. Verkeerd gekonfigureerde toestelle of argeloos gebruikers wat bedrieglike sertifikate aanvaar, kan die sekuriteit van 'n EAP-TLS-beskermde netwerk ondermyn.

Vir verdere besonderhede, besoek https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Verwysings
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **teken aan** vir **Intigriti**, 'n premium **bug bounty platform geskep deur hackers, vir hackers**! Sluit by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) vandag, en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Leer & oefen AWS-hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP-hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kontroleer die [**inskrywingsplanne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
{% endhint %}
