# Evil Twin EAP-TLS

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Nasaha ya bug bounty**: **jiandikishe** kwa **Intigriti**, jukwaa la **bug bounty la kiwango cha juu lililotengenezwa na hackers, kwa hackers**! Jiunge nasi [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na uanze kupata zawadi hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Wakati fulani nilihitaji kutumia suluhisho lililopendekezwa na chapisho lililo chini lakini hatua katika [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) hazikufanya kazi katika kali ya kisasa (2019v3) tena.\
Hata hivyo, ni rahisi kufanya zifanye kazi.\
Unahitaji tu kupakua hostapd-2.6 kutoka hapa: [https://w1.fi/releases/](https://w1.fi/releases/) na kabla ya kuunda tena hostapd-wpe install: `apt-get install libssl1.0-dev`

### Kuchambua na Kutumia EAP-TLS katika Mitandao ya Wireless

#### Muktadha: EAP-TLS katika Mitandao ya Wireless
EAP-TLS ni itifaki ya usalama inayotoa uthibitisho wa pamoja kati ya mteja na seva kwa kutumia vyeti. Muunganisho unaundwa tu ikiwa mteja na seva wanathibitisha vyeti vya kila mmoja.

#### Changamoto Iliyokutana
Wakati wa tathmini, makosa ya kuvutia yalikutana wakati wa kutumia zana ya `hostapd-wpe`. Zana hiyo ilikataa muunganisho wa mteja kwa sababu cheti cha mteja kilikuwa kimeandikwa na Mamlaka ya Cheti (CA) isiyojulikana. Hii ilionyesha kwamba mteja aliamini cheti cha seva bandia, ikionyesha mipangilio ya usalama dhaifu upande wa mteja.

#### Lengo: Kuweka Shambulio la Man-in-the-Middle (MiTM)
Lengo lilikuwa kubadilisha zana hiyo ili kukubali cheti chochote cha mteja. Hii ingekuwa na uwezo wa kuanzisha muunganisho na mtandao wa wireless mbaya na kuwezesha shambulio la MiTM, ikitegemea kukamata akidi za maandiko au data nyeti nyingine.

#### Suluhisho: Kubadilisha `hostapd-wpe`
Uchambuzi wa msimbo wa chanzo wa `hostapd-wpe` ulibaini kwamba uthibitishaji wa cheti cha mteja ulikuwa unadhibitiwa na parameter (`verify_peer`) katika kazi ya OpenSSL `SSL_set_verify`. Kwa kubadilisha thamani ya parameter hii kutoka 1 (thibitisha) hadi 0 (usithibitisha), zana hiyo ilifanywa kukubali cheti chochote cha mteja.

#### Utekelezaji wa Shambulio
1. **Ukaguzi wa Mazingira:** Tumia `airodump-ng` kufuatilia mitandao ya wireless na kubaini malengo.
2. **Kuweka AP Bandia:** Endesha `hostapd-wpe` iliyobadilishwa ili kuunda Ndugu ya Upatikanaji (AP) inayofanana na mtandao wa lengo.
3. **Uboreshaji wa Portal ya Captive:** Boresha ukurasa wa kuingia wa portal ya captive ili kuonekana halali na wa kawaida kwa mtumiaji wa lengo.
4. **Shambulio la De-authentication:** Ikiwa inahitajika, fanya shambulio la de-auth ili kumkatisha mteja kutoka kwenye mtandao halali na kuwachanganya na AP bandia.
5. **Kukamata Akidi:** Mara tu mteja anapounganisha na AP bandia na kuingiliana na portal ya captive, akidi zao zinakamatwa.

#### Maoni Kutoka kwa Shambulio
- Kwenye mashine za Windows, mfumo unaweza kuunganishwa moja kwa moja na AP bandia, ukionyesha portal ya captive wakati wa kujaribu kuvinjari mtandao.
- Kwenye iPhone, mtumiaji anaweza kuombwa kukubali cheti kipya na kisha kuonyeshwa portal ya captive.

#### Hitimisho
Ingawa EAP-TLS inachukuliwa kuwa salama, ufanisi wake unategemea sana mipangilio sahihi na tabia ya tahadhari ya watumiaji wa mwisho. Vifaa vilivyopangwa vibaya au watumiaji wasiojua wakikubali vyeti vya uasi vinaweza kudhoofisha usalama wa mtandao uliohifadhiwa na EAP-TLS.

Kwa maelezo zaidi angalia https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Marejeleo
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Nasaha ya bug bounty**: **jiandikishe** kwa **Intigriti**, jukwaa la **bug bounty la kiwango cha juu lililotengenezwa na hackers, kwa hackers**! Jiunge nasi [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na uanze kupata zawadi hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
