# Evil Twin EAP-TLS

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **meld aan** vir **Intigriti**, 'n premium **bug bounty platform geskep deur hackers, vir hackers**! Sluit by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) vandag, en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

Op 'n stadium moes ek die voorgestelde oplossing in die pos hieronder gebruik, maar die stappe in [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) het nie meer in moderne kali (2019v3) gewerk nie.\
In elk geval, dit is maklik om hulle aan die gang te kry.\
Jy moet net die hostapd-2.6 hier aflaai: [https://w1.fi/releases/](https://w1.fi/releases/) en voordat jy weer hostapd-wpe compileer, installeer: `apt-get install libssl1.0-dev`

### Analysering en Exploitering van EAP-TLS in Draadlose Netwerke

#### Agtergrond: EAP-TLS in Draadlose Netwerke
EAP-TLS is 'n sekuriteitsprotokol wat wedersydse verifikasie tussen kliënt en bediener bied deur middel van sertifikate. Die verbinding word slegs gevestig as beide die kliënt en die bediener mekaar se sertifikate verifieer.

#### Uitdaging Ontmoet
Tydens 'n assessering is 'n interessante fout ondervind toe die `hostapd-wpe` hulpmiddel gebruik is. Die hulpmiddel het die kliënt se verbinding verwerp weens die kliënt se sertifikaat wat deur 'n onbekende Sertifikaatowerheid (CA) onderteken is. Dit het aangedui dat die kliënt die vals bediener se sertifikaat vertrou het, wat dui op los sekuriteitskonfigurasies aan die kliënt se kant.

#### Doel: Stel 'n Man-in-the-Middle (MiTM) Aanval in
Die doel was om die hulpmiddel te wysig om enige kliënt sertifikaat te aanvaar. Dit sou die vestiging van 'n verbinding met die kwaadwillige draadlose netwerk moontlik maak en 'n MiTM-aanval moontlik maak, wat die vang van platte teks geloofsbriewe of ander sensitiewe data kan insluit.

#### Oplossing: Wysig `hostapd-wpe`
Analise van die bronkode van `hostapd-wpe` het onthul dat die kliënt sertifikaat validasie beheer is deur 'n parameter (`verify_peer`) in die OpenSSL funksie `SSL_set_verify`. Deur die waarde van hierdie parameter van 1 (verifieer) na 0 (nie verifieer nie) te verander, is die hulpmiddel gemaak om enige kliënt sertifikaat te aanvaar.

#### Uitvoering van die Aanval
1. **Omgewing Kontrole:** Gebruik `airodump-ng` om draadlose netwerke te monitor en te identifiseer.
2. **Stel Vals AP op:** Voer die gewysigde `hostapd-wpe` uit om 'n vals Toegangspunt (AP) te skep wat die teiken netwerk naboots.
3. **Kaptiewe Portaal Aangepas:** Pas die aanmeldbladsy van die kaptiewe portaal aan om legitiem en bekend te lyk vir die teiken gebruiker.
4. **De-authentikasie Aanval:** Opsioneel, voer 'n de-auth aanval uit om die kliënt van die legitieme netwerk af te skakel en hulle aan die vals AP te verbind.
5. **Vang Geloofsbriewe:** Sodra die kliënt aan die vals AP verbind en met die kaptiewe portaal interaksie het, word hulle geloofsbriewe gevang.

#### Waarnemings van die Aanval
- Op Windows masjiene kan die stelsel outomaties aan die vals AP verbind, wat die kaptiewe portaal aanbied wanneer web navigasie probeer word.
- Op 'n iPhone kan die gebruiker gevra word om 'n nuwe sertifikaat te aanvaar en dan met die kaptiewe portaal voorgelê word.

#### Gevolgtrekking
Terwyl EAP-TLS as veilig beskou word, hang die doeltreffendheid daarvan sterk af van die korrekte konfigurasie en versigtige gedrag van eindgebruikers. Foutief geconfigureerde toestelle of onskuldige gebruikers wat rogue sertifikate aanvaar, kan die sekuriteit van 'n EAP-TLS beskermde netwerk ondermyn.

Vir verdere besonderhede, kyk na https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Verwysings
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **meld aan** vir **Intigriti**, 'n premium **bug bounty platform geskep deur hackers, vir hackers**! Sluit by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) vandag, en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** 💬 [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
