# Evil Twin EAP-TLS

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **prijavite se** za **Intigriti**, premium **bug bounty platformu koju su kreirali hakeri, za hakere**! Pridru쬴te nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i po캜nite da zara캠ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

U nekom trenutku sam morao da koristim predlo쬰no re코enje iz posta ispod, ali koraci u [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) vi코e nisu radili u modernom kali (2019v3).\
U svakom slu캜aju, lako je naterati ih da rade.\
Samo treba da preuzmete hostapd-2.6 odavde: [https://w1.fi/releases/](https://w1.fi/releases/) i pre nego 코to ponovo kompajlirate hostapd-wpe instalirajte: `apt-get install libssl1.0-dev`

### Analiza i iskori코캖avanje EAP-TLS u be쬴캜nim mre쬬ma

#### Pozadina: EAP-TLS u be쬴캜nim mre쬬ma
EAP-TLS je bezbednosni protokol koji pru쬬 uzajamnu autentifikaciju izme캠u klijenta i servera koriste캖i sertifikate. Veza se uspostavlja samo ako klijent i server autentifikuju sertifikate jedni drugih.

#### Izazov na koji se nai코lo
Tokom procene, nai코ao sam na zanimljivu gre코ku prilikom kori코캖enja alata `hostapd-wpe`. Alat je odbio vezu klijenta zbog toga 코to je sertifikat klijenta potpisan od strane nepoznate sertifikacione vlasti (CA). To je ukazalo na to da klijent nije verovao sertifikatu la쬹og servera, 코to ukazuje na labave bezbednosne konfiguracije na strani klijenta.

#### Cilj: Postavljanje napada Man-in-the-Middle (MiTM)
Cilj je bio modifikovati alat da prihvati bilo koji sertifikat klijenta. To bi omogu캖ilo uspostavljanje veze sa zlo캖udnom be쬴캜nom mre쬺m i omogu캖ilo MiTM napad, potencijalno hvataju캖i plaintext akreditive ili druge osetljive podatke.

#### Re코enje: Modifikacija `hostapd-wpe`
Analiza izvornog koda `hostapd-wpe` otkrila je da je validacija sertifikata klijenta kontrolisana parametrima (`verify_peer`) u OpenSSL funkciji `SSL_set_verify`. Promenom vrednosti ovog parametra sa 1 (validiraj) na 0 (ne validiraj), alat je bio pode코en da prihvati bilo koji sertifikat klijenta.

#### Izvr코enje napada
1. **Provera okru쬰nja:** Koristite `airodump-ng` za pra캖enje be쬴캜nih mre쬬 i identifikaciju ciljeva.
2. **Postavljanje la쬹og AP-a:** Pokrenite modifikovani `hostapd-wpe` da kreirate la쬹i pristupni ta캜ku (AP) koji imitira ciljanju mre쬿.
3. **Prilago캠avanje captive portala:** Prilagodite stranicu za prijavu captive portala da izgleda legitimno i poznato ciljanom korisniku.
4. **Napad de-autentifikacije:** Opcionalno, izvr코ite de-autentifikacijski napad da biste isklju캜ili klijenta iz legitimne mre쬰 i povezali ga sa la쬹im AP-om.
5. **Hvatanje akreditiva:** Kada se klijent pove쬰 na la쬹i AP i interaguje sa captive portalom, njihovi akreditivi se hvataju.

#### Zapa쬬nja iz napada
- Na Windows ma코inama, sistem mo쬰 automatski da se pove쬰 na la쬹i AP, prikazuju캖i captive portal kada se poku코a web navigacija.
- Na iPhone-u, korisnik mo쬰 biti upitan da prihvati novi sertifikat, a zatim mu se prikazuje captive portal.

#### Zaklju캜ak
Iako se EAP-TLS smatra sigurnim, njegova efikasnost u velikoj meri zavisi od ispravne konfiguracije i opreznog pona코anja krajnjih korisnika. Pogre코no konfigurisani ure캠aji ili nesvesni korisnici koji prihvataju la쬹e sertifikate mogu oslabiti bezbednost mre쬰 za코ti캖ene EAP-TLS-om.

Za vi코e detalja proverite https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Reference
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty savet**: **prijavite se** za **Intigriti**, premium **bug bounty platformu koju su kreirali hakeri, za hakere**! Pridru쬴te nam se na [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) danas, i po캜nite da zara캠ujete nagrade do **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
U캜ite i ve쬭ajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
U캜ite i ve쬭ajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr쬴te HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru쬴te se** 游눫 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
