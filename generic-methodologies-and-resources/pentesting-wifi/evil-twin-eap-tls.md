# Evil Twin EAP-TLS

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, **hackers tarafından, hackers için oluşturulmuş premium bir bug bounty platformu**! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katılın ve **$100,000**'a kadar ödüller kazanmaya başlayın!

{% embed url="https://go.intigriti.com/hacktricks" %}

Bir noktada aşağıdaki gönderide önerilen çözümü kullanmam gerekti ama [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) adresindeki adımlar modern kali (2019v3) üzerinde artık çalışmıyordu.\
Neyse ki, bunları çalıştırmak kolay.\
Sadece buradan hostapd-2.6'yı indirmeniz gerekiyor: [https://w1.fi/releases/](https://w1.fi/releases/) ve hostapd-wpe'yi tekrar derlemeden önce: `apt-get install libssl1.0-dev` komutunu çalıştırın.

### Kablosuz Ağlarda EAP-TLS'yi Analiz Etme ve Sömürme

#### Arka Plan: Kablosuz Ağlarda EAP-TLS
EAP-TLS, istemci ve sunucu arasında karşılıklı kimlik doğrulama sağlayan bir güvenlik protokolüdür. Bağlantı, yalnızca istemci ve sunucu birbirlerinin sertifikalarını doğruladıysa kurulur.

#### Karşılaşılan Zorluk
Bir değerlendirme sırasında, `hostapd-wpe` aracını kullanırken ilginç bir hata ile karşılaşıldı. Araç, istemcinin sertifikasının bilinmeyen bir Sertifika Otoritesi (CA) tarafından imzalanması nedeniyle istemcinin bağlantısını reddetti. Bu, istemcinin sahte sunucunun sertifikasına güvenmediğini gösteriyordu ve istemci tarafındaki güvenlik yapılandırmalarının gevşek olduğunu işaret ediyordu.

#### Amaç: Adam Ortada (MiTM) Saldırısı Kurma
Amaç, aracı herhangi bir istemci sertifikasını kabul edecek şekilde değiştirmekti. Bu, kötü niyetli kablosuz ağ ile bağlantı kurulmasını sağlayacak ve bir MiTM saldırısını mümkün kılacak, muhtemelen düz metin kimlik bilgilerini veya diğer hassas verileri yakalayabilecekti.

#### Çözüm: `hostapd-wpe`'yi Değiştirme
`hostapd-wpe` kaynak kodunun analizi, istemci sertifikası doğrulamasının OpenSSL fonksiyonu `SSL_set_verify` içindeki bir parametre (`verify_peer`) tarafından kontrol edildiğini ortaya koydu. Bu parametrenin değerini 1 (doğrula) yerine 0 (doğrulama) olarak değiştirerek, aracın herhangi bir istemci sertifikasını kabul etmesi sağlandı.

#### Saldırının Uygulanması
1. **Ortam Kontrolü:** Kablosuz ağları izlemek ve hedefleri tanımlamak için `airodump-ng` kullanın.
2. **Sahte AP Kurulumu:** Hedef ağı taklit eden sahte bir Erişim Noktası (AP) oluşturmak için değiştirilmiş `hostapd-wpe`'yi çalıştırın.
3. **Kapsayıcı Portal Özelleştirmesi:** Kapsayıcı portalın giriş sayfasını hedef kullanıcıya tanıdık ve meşru görünmesi için özelleştirin.
4. **De-authentication Saldırısı:** İsteğe bağlı olarak, istemciyi meşru ağdan ayırmak ve sahte AP'ye bağlamak için bir de-auth saldırısı gerçekleştirin.
5. **Kimlik Bilgilerini Yakalama:** İstemci sahte AP'ye bağlandığında ve kapsayıcı portal ile etkileşime geçtiğinde, kimlik bilgileri yakalanır.

#### Saldırıdan Gözlemler
- Windows makinelerinde, sistem sahte AP'ye otomatik olarak bağlanabilir ve web gezintisi denendiğinde kapsayıcı portalı sunabilir.
- Bir iPhone'da, kullanıcıdan yeni bir sertifikayı kabul etmesi istenebilir ve ardından kapsayıcı portal sunulabilir.

#### Sonuç
EAP-TLS güvenli kabul edilse de, etkinliği doğru yapılandırma ve son kullanıcıların dikkatli davranışına büyük ölçüde bağlıdır. Yanlış yapılandırılmış cihazlar veya sahte sertifikaları kabul eden dikkatsiz kullanıcılar, EAP-TLS korumalı ağın güvenliğini zayıflatabilir.

Daha fazla detay için https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/ adresini kontrol edin.

## Referanslar
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, **hackers tarafından, hackers için oluşturulmuş premium bir bug bounty platformu**! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katılın ve **$100,000**'a kadar ödüller kazanmaya başlayın!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
