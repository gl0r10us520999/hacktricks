# Evil Twin EAP-TLS

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Astuce bug bounty** : **inscrivez-vous** sur **Intigriti**, une **plateforme de bug bounty premium cr√©√©e par des hackers, pour des hackers** ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des r√©compenses allant jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

√Ä un moment donn√©, j'ai eu besoin d'utiliser la solution propos√©e par le post ci-dessous, mais les √©tapes dans [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) ne fonctionnaient plus sur Kali moderne (2019v3).\
Quoi qu'il en soit, il est facile de les faire fonctionner.\
Vous devez simplement t√©l√©charger le hostapd-2.6 ici : [https://w1.fi/releases/](https://w1.fi/releases/) et avant de recompiler √† nouveau hostapd-wpe, installez : `apt-get install libssl1.0-dev`

### Analyser et exploiter EAP-TLS dans les r√©seaux sans fil

#### Contexte : EAP-TLS dans les r√©seaux sans fil
EAP-TLS est un protocole de s√©curit√© fournissant une authentification mutuelle entre le client et le serveur √† l'aide de certificats. La connexion n'est √©tablie que si le client et le serveur authentifient les certificats de l'autre.

#### D√©fi rencontr√©
Lors d'une √©valuation, une erreur int√©ressante a √©t√© rencontr√©e lors de l'utilisation de l'outil `hostapd-wpe`. L'outil a rejet√© la connexion du client en raison du certificat du client √©tant sign√© par une Autorit√© de Certification (CA) inconnue. Cela indiquait que le client ne faisait pas confiance au certificat du faux serveur, pointant vers des configurations de s√©curit√© laxistes du c√¥t√© du client.

#### Objectif : Mettre en place une attaque Man-in-the-Middle (MiTM)
L'objectif √©tait de modifier l'outil pour accepter n'importe quel certificat client. Cela permettrait d'√©tablir une connexion avec le r√©seau sans fil malveillant et d'activer une attaque MiTM, capturant potentiellement des identifiants en clair ou d'autres donn√©es sensibles.

#### Solution : Modification de `hostapd-wpe`
L'analyse du code source de `hostapd-wpe` a r√©v√©l√© que la validation du certificat client √©tait contr√¥l√©e par un param√®tre (`verify_peer`) dans la fonction OpenSSL `SSL_set_verify`. En changeant la valeur de ce param√®tre de 1 (valider) √† 0 (ne pas valider), l'outil a √©t√© modifi√© pour accepter n'importe quel certificat client.

#### Ex√©cution de l'attaque
1. **V√©rification de l'environnement :** Utilisez `airodump-ng` pour surveiller les r√©seaux sans fil et identifier les cibles.
2. **Configurer un faux AP :** Ex√©cutez le `hostapd-wpe` modifi√© pour cr√©er un faux Point d'Acc√®s (AP) imitant le r√©seau cible.
3. **Personnalisation du portail captif :** Personnalisez la page de connexion du portail captif pour qu'elle apparaisse l√©gitime et famili√®re √† l'utilisateur cible.
4. **Attaque de d√©sauthentification :** Optionnellement, effectuez une attaque de d√©sauthentification pour d√©connecter le client du r√©seau l√©gitime et le connecter au faux AP.
5. **Capture des identifiants :** Une fois que le client se connecte au faux AP et interagit avec le portail captif, ses identifiants sont captur√©s.

#### Observations de l'attaque
- Sur les machines Windows, le syst√®me peut se connecter automatiquement au faux AP, pr√©sentant le portail captif lorsque la navigation web est tent√©e.
- Sur un iPhone, l'utilisateur peut √™tre invit√© √† accepter un nouveau certificat, puis pr√©sent√© avec le portail captif.

#### Conclusion
Bien que EAP-TLS soit consid√©r√© comme s√©curis√©, son efficacit√© d√©pend fortement de la configuration correcte et du comportement prudent des utilisateurs finaux. Des appareils mal configur√©s ou des utilisateurs sans m√©fiance acceptant des certificats ind√©sirables peuvent compromettre la s√©curit√© d'un r√©seau prot√©g√© par EAP-TLS.

Pour plus de d√©tails, consultez https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## R√©f√©rences
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Astuce bug bounty** : **inscrivez-vous** sur **Intigriti**, une **plateforme de bug bounty premium cr√©√©e par des hackers, pour des hackers** ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des r√©compenses allant jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
