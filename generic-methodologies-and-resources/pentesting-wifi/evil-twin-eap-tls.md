# Evil Twin EAP-TLS

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Conseil de prime de bug** : **inscrivez-vous** √† **Intigriti**, une plateforme de prime de bug premium cr√©√©e par des pirates informatiques, pour les pirates informatiques ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des primes allant jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

√Ä un moment donn√©, j'ai d√ª utiliser la solution propos√©e par le post ci-dessous mais les √©tapes sur [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) ne fonctionnaient plus dans le kali moderne (2019v3).\
Quoi qu'il en soit, il est facile de les faire fonctionner.\
Vous devez simplement t√©l√©charger le hostapd-2.6 d'ici : [https://w1.fi/releases/](https://w1.fi/releases) et avant de recompiler √† nouveau hostapd-wpe, installez : `apt-get install libssl1.0-dev`

### Analyse et exploitation de l'EAP-TLS dans les r√©seaux sans fil

#### Contexte : EAP-TLS dans les r√©seaux sans fil
EAP-TLS est un protocole de s√©curit√© assurant une authentification mutuelle entre le client et le serveur √† l'aide de certificats. La connexion n'est √©tablie que si le client et le serveur s'authentifient mutuellement √† l'aide de leurs certificats.

#### D√©fi rencontr√©
Lors d'une √©valuation, une erreur int√©ressante a √©t√© rencontr√©e lors de l'utilisation de l'outil `hostapd-wpe`. L'outil a rejet√© la connexion du client en raison du certificat du client √©tant sign√© par une autorit√© de certification (CA) inconnue. Cela indiquait que le client ne faisait pas confiance au certificat du serveur factice, pointant vers des configurations de s√©curit√© laxistes du c√¥t√© du client.

#### Objectif : Configuration d'une attaque de l'homme du milieu (MiTM)
L'objectif √©tait de modifier l'outil pour accepter n'importe quel certificat client. Cela permettrait d'√©tablir une connexion avec le r√©seau sans fil malveillant et de permettre une attaque MiTM, capturant potentiellement des informations d'identification en clair ou d'autres donn√©es sensibles.

#### Solution : Modification de `hostapd-wpe`
L'analyse du code source de `hostapd-wpe` a r√©v√©l√© que la validation du certificat client √©tait contr√¥l√©e par un param√®tre (`verify_peer`) dans la fonction OpenSSL `SSL_set_verify`. En changeant la valeur de ce param√®tre de 1 (valider) √† 0 (ne pas valider), l'outil a √©t√© modifi√© pour accepter n'importe quel certificat client.

#### Ex√©cution de l'attaque
1. **V√©rification de l'environnement :** Utilisez `airodump-ng` pour surveiller les r√©seaux sans fil et identifier les cibles.
2. **Mise en place d'un faux AP :** Ex√©cutez le `hostapd-wpe` modifi√© pour cr√©er un faux point d'acc√®s (AP) imitant le r√©seau cible.
3. **Personnalisation du portail captif :** Personnalisez la page de connexion du portail captif pour qu'elle paraisse l√©gitime et famili√®re √† l'utilisateur cibl√©.
4. **Attaque de d√©connexion :** Facultativement, effectuez une attaque de d√©connexion pour d√©connecter le client du r√©seau l√©gitime et le connecter au faux AP.
5. **Capture des informations d'identification :** Une fois que le client se connecte au faux AP et interagit avec le portail captif, ses informations d'identification sont captur√©es.

#### Observations de l'attaque
- Sur les machines Windows, le syst√®me peut se connecter automatiquement au faux AP, pr√©sentant le portail captif lorsqu'une navigation web est tent√©e.
- Sur un iPhone, l'utilisateur peut √™tre invit√© √† accepter un nouveau certificat, puis pr√©sent√© avec le portail captif.

#### Conclusion
Bien que l'EAP-TLS soit consid√©r√© comme s√©curis√©, son efficacit√© d√©pend fortement de la configuration correcte et du comportement prudent des utilisateurs finaux. Des appareils mal configur√©s ou des utilisateurs inconscients acceptant des certificats frauduleux peuvent compromettre la s√©curit√© d'un r√©seau prot√©g√© par EAP-TLS.

Pour plus de d√©tails, consultez https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## R√©f√©rences
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Conseil de prime de bug** : **inscrivez-vous** √† **Intigriti**, une plateforme de prime de bug premium cr√©√©e par des pirates informatiques, pour les pirates informatiques ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des primes allant jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
