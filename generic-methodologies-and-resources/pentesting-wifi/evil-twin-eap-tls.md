# Evil Twin EAP-TLS

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**æ¼æ´èµé‡‘æç¤º**ï¼š**æ³¨å†Œ** **Intigriti**ï¼Œä¸€ä¸ªç”±é»‘å®¢ä¸ºé»‘å®¢åˆ›å»ºçš„é«˜çº§**æ¼æ´èµé‡‘å¹³å°**ï¼ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾ **$100,000** çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

åœ¨æŸä¸ªæ—¶å€™ï¼Œæˆ‘éœ€è¦ä½¿ç”¨ä¸‹é¢å¸–å­ä¸­æå‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œä½† [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) ä¸­çš„æ­¥éª¤åœ¨ç°ä»£ Kali (2019v3) ä¸­ä¸å†æœ‰æ•ˆã€‚\
ä¸è¿‡ï¼Œè®©å®ƒä»¬å·¥ä½œå¾ˆç®€å•ã€‚\
æ‚¨åªéœ€ä»è¿™é‡Œä¸‹è½½ hostapd-2.6ï¼š[https://w1.fi/releases/](https://w1.fi/releases/)ï¼Œå¹¶åœ¨é‡æ–°ç¼–è¯‘ hostapd-wpe ä¹‹å‰å®‰è£…ï¼š`apt-get install libssl1.0-dev`

### åˆ†æå’Œåˆ©ç”¨æ— çº¿ç½‘ç»œä¸­çš„ EAP-TLS

#### èƒŒæ™¯ï¼šæ— çº¿ç½‘ç»œä¸­çš„ EAP-TLS
EAP-TLS æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œé€šè¿‡ä½¿ç”¨è¯ä¹¦æä¾›å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ç›¸äº’è®¤è¯ã€‚åªæœ‰åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç›¸äº’éªŒè¯å¯¹æ–¹çš„è¯ä¹¦åï¼Œè¿æ¥æ‰ä¼šå»ºç«‹ã€‚

#### é‡åˆ°çš„æŒ‘æˆ˜
åœ¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ `hostapd-wpe` å·¥å…·æ—¶é‡åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„é”™è¯¯ã€‚è¯¥å·¥å…·æ‹’ç»äº†å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„è¯ä¹¦æ˜¯ç”±æœªçŸ¥çš„è¯ä¹¦é¢å‘æœºæ„ (CA) ç­¾åçš„ã€‚è¿™è¡¨æ˜å®¢æˆ·ç«¯ç¡®å®ä¿¡ä»»å‡æœåŠ¡å™¨çš„è¯ä¹¦ï¼ŒæŒ‡å‘å®¢æˆ·ç«¯ä¾§çš„å®‰å…¨é…ç½®æ¾æ‡ˆã€‚

#### ç›®æ ‡ï¼šè®¾ç½®ä¸­é—´äººæ”»å‡» (MiTM)
ç›®æ ‡æ˜¯ä¿®æ”¹è¯¥å·¥å…·ä»¥æ¥å—ä»»ä½•å®¢æˆ·ç«¯è¯ä¹¦ã€‚è¿™å°†å…è®¸ä¸æ¶æ„æ— çº¿ç½‘ç»œå»ºç«‹è¿æ¥ï¼Œå¹¶å¯ç”¨ MiTM æ”»å‡»ï¼Œå¯èƒ½æ•è·æ˜æ–‡å‡­æ®æˆ–å…¶ä»–æ•æ„Ÿæ•°æ®ã€‚

#### è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹ `hostapd-wpe`
å¯¹ `hostapd-wpe` æºä»£ç çš„åˆ†ææ˜¾ç¤ºï¼Œå®¢æˆ·ç«¯è¯ä¹¦éªŒè¯ç”± OpenSSL å‡½æ•° `SSL_set_verify` ä¸­çš„ä¸€ä¸ªå‚æ•° (`verify_peer`) æ§åˆ¶ã€‚é€šè¿‡å°†è¯¥å‚æ•°çš„å€¼ä» 1ï¼ˆéªŒè¯ï¼‰æ›´æ”¹ä¸º 0ï¼ˆä¸éªŒè¯ï¼‰ï¼Œè¯¥å·¥å…·è¢«ä¿®æ”¹ä¸ºæ¥å—ä»»ä½•å®¢æˆ·ç«¯è¯ä¹¦ã€‚

#### æ”»å‡»æ‰§è¡Œ
1. **ç¯å¢ƒæ£€æŸ¥ï¼š** ä½¿ç”¨ `airodump-ng` ç›‘æ§æ— çº¿ç½‘ç»œå¹¶è¯†åˆ«ç›®æ ‡ã€‚
2. **è®¾ç½®å‡ APï¼š** è¿è¡Œä¿®æ”¹åçš„ `hostapd-wpe` åˆ›å»ºä¸€ä¸ªæ¨¡ä»¿ç›®æ ‡ç½‘ç»œçš„å‡æ¥å…¥ç‚¹ (AP)ã€‚
3. **æ•è·é—¨æˆ·å®šåˆ¶ï¼š** å®šåˆ¶æ•è·é—¨æˆ·çš„ç™»å½•é¡µé¢ï¼Œä½¿å…¶çœ‹èµ·æ¥åˆæ³•ä¸”ç†Ÿæ‚‰ç›®æ ‡ç”¨æˆ·ã€‚
4. **å»è®¤è¯æ”»å‡»ï¼š** å¯é€‰åœ°æ‰§è¡Œå»è®¤è¯æ”»å‡»ï¼Œä»¥å°†å®¢æˆ·ç«¯ä»åˆæ³•ç½‘ç»œæ–­å¼€å¹¶è¿æ¥åˆ°å‡ APã€‚
5. **æ•è·å‡­æ®ï¼š** ä¸€æ—¦å®¢æˆ·ç«¯è¿æ¥åˆ°å‡ AP å¹¶ä¸æ•è·é—¨æˆ·äº¤äº’ï¼Œä»–ä»¬çš„å‡­æ®å°†è¢«æ•è·ã€‚

#### æ”»å‡»è§‚å¯Ÿ
- åœ¨ Windows æœºå™¨ä¸Šï¼Œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨è¿æ¥åˆ°å‡ APï¼Œå½“å°è¯•è¿›è¡Œç½‘é¡µå¯¼èˆªæ—¶ä¼šå‘ˆç°æ•è·é—¨æˆ·ã€‚
- åœ¨ iPhone ä¸Šï¼Œç”¨æˆ·å¯èƒ½ä¼šè¢«æç¤ºæ¥å—æ–°è¯ä¹¦ï¼Œç„¶åå‘ˆç°æ•è·é—¨æˆ·ã€‚

#### ç»“è®º
è™½ç„¶ EAP-TLS è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œä½†å…¶æœ‰æ•ˆæ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæ­£ç¡®çš„é…ç½®å’Œç”¨æˆ·çš„è°¨æ…è¡Œä¸ºã€‚é…ç½®é”™è¯¯çš„è®¾å¤‡æˆ–ä¸çŸ¥æƒ…çš„ç”¨æˆ·æ¥å—æ¶æ„è¯ä¹¦å¯èƒ½ä¼šç ´å EAP-TLS ä¿æŠ¤ç½‘ç»œçš„å®‰å…¨æ€§ã€‚

æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## å‚è€ƒæ–‡çŒ®
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**æ¼æ´èµé‡‘æç¤º**ï¼š**æ³¨å†Œ** **Intigriti**ï¼Œä¸€ä¸ªç”±é»‘å®¢ä¸ºé»‘å®¢åˆ›å»ºçš„é«˜çº§**æ¼æ´èµé‡‘å¹³å°**ï¼ä»Šå¤©å°±åŠ å…¥æˆ‘ä»¬ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)ï¼Œå¼€å§‹èµšå–é«˜è¾¾ **$100,000** çš„èµé‡‘ï¼

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
