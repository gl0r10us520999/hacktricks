# Evil Twin EAP-TLS

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, **hackers tarafÄ±ndan, hackers iÃ§in oluÅŸturulmuÅŸ premium bir bug bounty platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **$100,000**'a kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

Bir noktada aÅŸaÄŸÄ±daki gÃ¶nderide Ã¶nerilen Ã§Ã¶zÃ¼mÃ¼ kullanmam gerekti ama [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) adresindeki adÄ±mlar modern kali (2019v3) Ã¼zerinde artÄ±k Ã§alÄ±ÅŸmÄ±yordu.\
Neyse ki, bunlarÄ± Ã§alÄ±ÅŸtÄ±rmak kolay.\
Sadece buradan hostapd-2.6'yÄ± indirmeniz gerekiyor: [https://w1.fi/releases/](https://w1.fi/releases/) ve hostapd-wpe'yi tekrar derlemeden Ã¶nce: `apt-get install libssl1.0-dev` komutunu Ã§alÄ±ÅŸtÄ±rÄ±n.

### Kablosuz AÄŸlarda EAP-TLS'yi Analiz Etme ve SÃ¶mÃ¼rme

#### Arka Plan: Kablosuz AÄŸlarda EAP-TLS
EAP-TLS, istemci ve sunucu arasÄ±nda karÅŸÄ±lÄ±klÄ± kimlik doÄŸrulama saÄŸlayan bir gÃ¼venlik protokolÃ¼dÃ¼r. BaÄŸlantÄ±, yalnÄ±zca istemci ve sunucu birbirlerinin sertifikalarÄ±nÄ± doÄŸruladÄ±ysa kurulur.

#### KarÅŸÄ±laÅŸÄ±lan Zorluk
Bir deÄŸerlendirme sÄ±rasÄ±nda, `hostapd-wpe` aracÄ±nÄ± kullanÄ±rken ilginÃ§ bir hata ile karÅŸÄ±laÅŸÄ±ldÄ±. AraÃ§, istemcinin sertifikasÄ±nÄ±n bilinmeyen bir Sertifika Otoritesi (CA) tarafÄ±ndan imzalanmasÄ± nedeniyle istemcinin baÄŸlantÄ±sÄ±nÄ± reddetti. Bu, istemcinin sahte sunucunun sertifikasÄ±na gÃ¼venmediÄŸini gÃ¶steriyordu ve istemci tarafÄ±ndaki gÃ¼venlik yapÄ±landÄ±rmalarÄ±nÄ±n gevÅŸek olduÄŸunu iÅŸaret ediyordu.

#### AmaÃ§: Adam Ortada (MiTM) SaldÄ±rÄ±sÄ± Kurma
AmaÃ§, aracÄ± herhangi bir istemci sertifikasÄ±nÄ± kabul edecek ÅŸekilde deÄŸiÅŸtirmekti. Bu, kÃ¶tÃ¼ niyetli kablosuz aÄŸ ile baÄŸlantÄ± kurulmasÄ±nÄ± saÄŸlayacak ve bir MiTM saldÄ±rÄ±sÄ±nÄ± mÃ¼mkÃ¼n kÄ±lacak, muhtemelen dÃ¼z metin kimlik bilgilerini veya diÄŸer hassas verileri yakalayabilecekti.

#### Ã‡Ã¶zÃ¼m: `hostapd-wpe`'yi DeÄŸiÅŸtirme
`hostapd-wpe` kaynak kodunun analizi, istemci sertifikasÄ± doÄŸrulamasÄ±nÄ±n OpenSSL fonksiyonu `SSL_set_verify` iÃ§indeki bir parametre (`verify_peer`) tarafÄ±ndan kontrol edildiÄŸini ortaya koydu. Bu parametrenin deÄŸerini 1 (doÄŸrula) yerine 0 (doÄŸrulama) olarak deÄŸiÅŸtirerek, aracÄ±n herhangi bir istemci sertifikasÄ±nÄ± kabul etmesi saÄŸlandÄ±.

#### SaldÄ±rÄ±nÄ±n UygulanmasÄ±
1. **Ortam KontrolÃ¼:** Kablosuz aÄŸlarÄ± izlemek ve hedefleri tanÄ±mlamak iÃ§in `airodump-ng` kullanÄ±n.
2. **Sahte AP Kurulumu:** Hedef aÄŸÄ± taklit eden sahte bir EriÅŸim NoktasÄ± (AP) oluÅŸturmak iÃ§in deÄŸiÅŸtirilmiÅŸ `hostapd-wpe`'yi Ã§alÄ±ÅŸtÄ±rÄ±n.
3. **KapsayÄ±cÄ± Portal Ã–zelleÅŸtirmesi:** KapsayÄ±cÄ± portalÄ±n giriÅŸ sayfasÄ±nÄ± hedef kullanÄ±cÄ±ya tanÄ±dÄ±k ve meÅŸru gÃ¶rÃ¼nmesi iÃ§in Ã¶zelleÅŸtirin.
4. **De-authentication SaldÄ±rÄ±sÄ±:** Ä°steÄŸe baÄŸlÄ± olarak, istemciyi meÅŸru aÄŸdan ayÄ±rmak ve sahte AP'ye baÄŸlamak iÃ§in bir de-auth saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirin.
5. **Kimlik Bilgilerini Yakalama:** Ä°stemci sahte AP'ye baÄŸlandÄ±ÄŸÄ±nda ve kapsayÄ±cÄ± portal ile etkileÅŸime geÃ§tiÄŸinde, kimlik bilgileri yakalanÄ±r.

#### SaldÄ±rÄ±dan GÃ¶zlemler
- Windows makinelerinde, sistem sahte AP'ye otomatik olarak baÄŸlanabilir ve web gezintisi denendiÄŸinde kapsayÄ±cÄ± portalÄ± sunabilir.
- Bir iPhone'da, kullanÄ±cÄ±dan yeni bir sertifikayÄ± kabul etmesi istenebilir ve ardÄ±ndan kapsayÄ±cÄ± portal sunulabilir.

#### SonuÃ§
EAP-TLS gÃ¼venli kabul edilse de, etkinliÄŸi doÄŸru yapÄ±landÄ±rma ve son kullanÄ±cÄ±larÄ±n dikkatli davranÄ±ÅŸÄ±na bÃ¼yÃ¼k Ã¶lÃ§Ã¼de baÄŸlÄ±dÄ±r. YanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ cihazlar veya sahte sertifikalarÄ± kabul eden dikkatsiz kullanÄ±cÄ±lar, EAP-TLS korumalÄ± aÄŸÄ±n gÃ¼venliÄŸini zayÄ±flatabilir.

Daha fazla detay iÃ§in https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/ adresini kontrol edin.

## Referanslar
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty ipucu**: **Intigriti'ye kaydolun**, **hackers tarafÄ±ndan, hackers iÃ§in oluÅŸturulmuÅŸ premium bir bug bounty platformu**! BugÃ¼n [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katÄ±lÄ±n ve **$100,000**'a kadar Ã¶dÃ¼ller kazanmaya baÅŸlayÄ±n!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
