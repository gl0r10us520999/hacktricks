# Heap Fonksiyonları Güvenlik Kontrolleri

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>

## unlink

Bu fonksiyon, bir parçayı çift yönlü bağlı listeden kaldırır. Parçaları ayırırken bağlı liste yapısının tutarlı kalmasını sağlayan yaygın kontroller bulunmaktadır.

* **Tutarlılık Kontrolleri**:
* `P->fd->bk == P` ve `P->bk->fd == P` koşullarını kontrol edin.
* Hata mesajı: `corrupted double-linked list`

## \_int\_malloc

Bu fonksiyon, heap'ten bellek ayırmaktan sorumludur. Buradaki kontroller, belleğin ayırma sırasında bozulmadığından emin olur.

* **Fastbin Boyut Kontrolü**:
* Bir parçayı fastbin'den kaldırırken, parçanın boyutunun fastbin aralığında olduğundan emin olun.
* Hata mesajı: `malloc(): memory corruption (fast)`
* **Smallbin Tutarlılık Kontrolü**:
* Bir parçayı smallbin'den kaldırırken, çift yönlü bağlı listedeki önceki ve sonraki bağlantıların tutarlı olduğundan emin olun.
* Hata mesajı: `malloc(): smallbin double linked list corrupted`
* **Unsorted Bin Bellek Aralığı Kontrolü**:
* Karışık kutulardaki parçaların boyutunun minimum ve maksimum sınırlar arasında olduğundan emin olun.
* Hata mesajı: `malloc(): memory corruption | malloc(): invalid next size (unsorted)`
* **Unsorted Bin Tutarlılık Kontrolü (İlk Senaryo)**:
* Kalan bir parçayı karışık kutuya eklerken, `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` koşulunu kontrol edin.
* Hata mesajı: `malloc(): corrupted unsorted chunks`
* **Unsorted Bin Tutarlılık Kontrolü (İkinci Senaryo)**:
* Önceki kontrolle aynıdır, ancak hızlı veya küçük bir parçayı böldükten sonra ekleme yapıldığında tetiklenir.
* Hata mesajı: `malloc(): corrupted unsorted chunks 2`

## \_int\_free

Bu fonksiyon önceden ayrılmış belleği serbest bırakır. Buradaki kontroller, uygun bellek serbest bırakma ve bellek bozulmasını önlemeye yardımcı olur.

* **İşaretçi Sınır Kontrolü**:
* Serbest bırakılan işaretçinin belleği sarmadığından emin olun.
* Hata mesajı: `free(): invalid pointer`
* **Boyut Kontrolü**:
* Serbest bırakılan parçanın boyutunun en az `MINSIZE` veya `MALLOC_ALIGNMENT`'ın katlarından biri olduğundan emin olun.
* Hata mesajı: `free(): invalid size`
* **Fastbin Boyut Kontrolü**:
* Fastbin parçaları için, bir sonraki parçanın boyutunun minimum ve maksimum sınırlar arasında olduğundan emin olun.
* Hata mesajı: `free(): invalid next size (fast)`
* **Fastbin Çift Serbest Bırakma Kontrolü**:
* Bir parçayı fastbin'e eklerken, baştaki parçanın eklenen parça ile aynı olmadığından emin olun.
* Hata mesajı: `double free or corruption (fasttop)`
* **Fastbin Tutarlılık Kontrolü**:
* Fastbin'e ekleme yaparken, baştaki parça ile eklenen parçanın boyutlarının aynı olduğundan emin olun.
* Hata mesajı: `invalid fastbin entry (free)`
* **Üst Parça Tutarlılık Kontrolü**:
* Hızlı olmayan fastbin parçaları için, parçanın üst parça ile aynı olmadığından emin olun.
* Hata mesajı: `double free or corruption (top)`
* **Bellek Sınırları Kontrolü**:
* Belleği saran bir sonraki parçanın arenanın sınırları içinde olduğundan emin olun.
* Hata mesajı: `double free or corruption (out)`
* **Prev\_inuse Bit Kontrolü**:
* Bir sonraki parçadaki önceki kullanımda bitin işaretlendiğinden emin olun.
* Hata mesajı: `double free or corruption (!prev)`
* **Normal Boyut Kontrolü**:
* Bir sonraki parçanın boyutunun geçerli aralıklarda olduğundan emin olun.
* Hata mesajı: `free(): invalid next size (normal)`
* **Unsorted Bin Tutarlılık Kontrolü**:
* Bir birleştirilmiş parçayı karışık kutuya eklerken, `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` koşulunu kontrol edin.
* Hata mesajı: `free(): corrupted unsorted chunks`

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>
