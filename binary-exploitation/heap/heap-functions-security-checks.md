# Heap Funksies Sekuriteitskontroles

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## unlink

Hierdie funksie verwyder 'n brokkie uit 'n dubbelgekoppelde lys. Gewone kontroles verseker dat die gekoppelde lysstruktuur konsekwent bly wanneer brokkies ontkoppel word.

* **Konsistensie Kontroles**:
* Kontroleer of `P->fd->bk == P` en `P->bk->fd == P`.
* Foutboodskap: `corrupted double-linked list`

## \_int\_malloc

Hierdie funksie is verantwoordelik vir die toekenning van geheue uit die heap. Kontroles hier verseker dat geheue nie tydens toekenning gekorrupreer word nie.

* **Fastbin Grootte Kontrole**:
* Wanneer 'n brokkie uit 'n fastbin verwyder word, verseker dat die grootte van die brokkie binne die fastbin-reeks is.
* Foutboodskap: `malloc(): memory corruption (fast)`
* **Smallbin Konsistensie Kontrole**:
* Wanneer 'n brokkie uit 'n smallbin verwyder word, verseker dat die vorige en volgende skakels in die dubbelgekoppelde lys konsekwent is.
* Foutboodskap: `malloc(): smallbin double linked list corrupted`
* **Ongeordende Bin Geheue-reeks Kontrole**:
* Verseker dat die grootte van brokkies in die ongeordende bin binne minimum- en maksimumgrense is.
* Foutboodskap: `malloc(): memory corruption | malloc(): invalid next size (unsorted)`
* **Ongeordende Bin Konsistensie Kontrole (Eerste Scenario)**:
* Wanneer 'n oorblywende brokkie in die ongeordende bin ingevoeg word, kontroleer of `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Foutboodskap: `malloc(): corrupted unsorted chunks`
* **Ongeordende Bin Konsistensie Kontrole (Tweede Scenario)**:
* Dieselfde as die vorige kontrole, maar geaktiveer wanneer ingevoeg word na die opsplit van 'n vinnige of klein brokkie.
* Foutboodskap: `malloc(): corrupted unsorted chunks 2`

## \_int\_free

Hierdie funksie vrygemaakte voorheen toegedeelde geheue. Die kontroles hier help om behoorlike geheuevrymaking te verseker en geheuekorrupsie te voorkom.

* **Puntgrens Kontrole**:
* Verseker dat die punt wat vrygemaak word nie om die geheue heen wikkel nie.
* Foutboodskap: `free(): invalid pointer`
* **Grootte Kontrole**:
* Verseker dat die grootte van die brokkie wat vrygemaak word minstens `MINSIZE` of 'n veelvoud van `MALLOC_ALIGNMENT` is.
* Foutboodskap: `free(): invalid size`
* **Fastbin Grootte Kontrole**:
* Vir fastbin-brokkies, verseker dat die grootte van die volgende brokkie binne die minimum- en maksimumgrense is.
* Foutboodskap: `free(): invalid next size (fast)`
* **Vinnige Bin Dubbelvry Kontrole**:
* Wanneer 'n brokkie in 'n fastbin ingevoeg word, verseker dat die brokkie aan die kop nie dieselfde is as die een wat ingevoeg word nie.
* Foutboodskap: `double free or corruption (fasttop)`
* **Vinnige Bin Konsistensie Kontrole**:
* Wanneer ingevoeg word in 'n fastbin, verseker dat die groottes van die kopbrokkie en die ingevoegde brokkie dieselfde is.
* Foutboodskap: `invalid fastbin entry (free)`
* **Boppebrokkie Konsistensie Kontrole**:
* Vir nie-fastbin-brokkies, verseker dat die brokkie nie dieselfde is as die boppebrokkie nie.
* Foutboodskap: `double free or corruption (top)`
* **Geheuegrense Kontrole**:
* Verseker dat die volgende brokkie volgens geheue binne die grense van die arena is.
* Foutboodskap: `double free or corruption (out)`
* **Prev\_inuse Bit Kontrole**:
* Verseker dat die vorige-in-gebruik-bit in die volgende brokkie gemerk is.
* Foutboodskap: `double free or corruption (!prev)`
* **Normale Grootte Kontrole**:
* Verseker dat die grootte van die volgende brokkie binne geldige reekse is.
* Foutboodskap: `free(): invalid next size (normal)`
* **Ongeordende Bin Konsistensie Kontrole**:
* Wanneer 'n gekolekteerde brokkie in die ongeordende bin ingevoeg word, kontroleer of `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`.
* Foutboodskap: `free(): corrupted unsorted chunks`

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
