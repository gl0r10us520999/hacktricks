# Ganzzahl√ºberlauf

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## Grundinformationen

Im Kern eines **Ganzzahl√ºberlaufs** steht die Einschr√§nkung, die durch die **Gr√∂√üe** der Datentypen in der Computerprogrammierung und die **Interpretation** der Daten auferlegt wird.

Zum Beispiel kann eine **8-Bit-unsigned Ganzzahl** Werte von **0 bis 255** darstellen. Wenn Sie versuchen, den Wert 256 in einer 8-Bit-unsigned Ganzzahl zu speichern, wird er aufgrund der Begrenzung seiner Speicherkapazit√§t auf 0 zur√ºckgesetzt. √Ñhnlich verh√§lt es sich bei einer **16-Bit-unsigned Ganzzahl**, die Werte von **0 bis 65.535** halten kann; das Hinzuf√ºgen von 1 zu 65.535 wird den Wert wieder auf 0 zur√ºcksetzen.

Dar√ºber hinaus kann eine **8-Bit-signierte Ganzzahl** Werte von **-128 bis 127** darstellen. Dies liegt daran, dass ein Bit verwendet wird, um das Vorzeichen (positiv oder negativ) darzustellen, wodurch 7 Bits zur Darstellung der Gr√∂√üe verbleiben. Die negativste Zahl wird als **-128** (bin√§r `10000000`) dargestellt, und die positivste Zahl ist **127** (bin√§r `01111111`).

### Maximalwerte

F√ºr potenzielle **Web-Sicherheitsanf√§lligkeiten** ist es sehr interessant, die maximal unterst√ºtzten Werte zu kennen:

{% tabs %}
{% tab title="Rust" %}
```rust
fn main() {

let mut quantity = 2147483647;

let (mul_result, _) = i32::overflowing_mul(32767, quantity);
let (add_result, _) = i32::overflowing_add(1, quantity);

println!("{}", mul_result);
println!("{}", add_result);
}
```
{% endtab %}

{% tab title="C" %}
```c
#include <stdio.h>
#include <limits.h>

int main() {
int a = INT_MAX;
int b = 0;
int c = 0;

b = a * 100;
c = a + 1;

printf("%d\n", INT_MAX);
printf("%d\n", b);
printf("%d\n", c);
return 0;
}
```
{% endtab %}
{% endtabs %}

## Beispiele

### Reiner √úberlauf

Das gedruckte Ergebnis wird 0 sein, da wir das char √ºberlaufen haben:
```c
#include <stdio.h>

int main() {
unsigned char max = 255; // 8-bit unsigned integer
unsigned char result = max + 1;
printf("Result: %d\n", result); // Expected to overflow
return 0;
}
```
### Signed to Unsigned Conversion

Betrachten Sie eine Situation, in der eine signierte Ganzzahl aus der Benutzereingabe gelesen und dann in einem Kontext verwendet wird, der sie als unsignierte Ganzzahl behandelt, ohne ordnungsgem√§√üe Validierung:
```c
#include <stdio.h>

int main() {
int userInput; // Signed integer
printf("Enter a number: ");
scanf("%d", &userInput);

// Treating the signed input as unsigned without validation
unsigned int processedInput = (unsigned int)userInput;

// A condition that might not work as intended if userInput is negative
if (processedInput > 1000) {
printf("Processed Input is large: %u\n", processedInput);
} else {
printf("Processed Input is within range: %u\n", processedInput);
}

return 0;
}
```
In diesem Beispiel wird eine negative Zahl als gro√üe unsigned Ganzzahl interpretiert, was auf die Art und Weise zur√ºckzuf√ºhren ist, wie bin√§re Werte interpretiert werden, was potenziell zu unerwartetem Verhalten f√ºhren kann.

### Weitere Beispiele

* [https://guyinatuxedo.github.io/35-integer\_exploitation/int\_overflow\_post/index.html](https://guyinatuxedo.github.io/35-integer\_exploitation/int\_overflow\_post/index.html)
* Es wird nur 1B verwendet, um die Gr√∂√üe des Passworts zu speichern, sodass es m√∂glich ist, es zu √ºberlaufen und es glauben zu lassen, dass es eine L√§nge von 4 hat, w√§hrend es tats√§chlich 260 ist, um den Schutz der L√§ngen√ºberpr√ºfung zu umgehen.
* [https://guyinatuxedo.github.io/35-integer\_exploitation/puzzle/index.html](https://guyinatuxedo.github.io/35-integer\_exploitation/puzzle/index.html)
*   Gegeben ein paar Zahlen, finde mit z3 eine neue Zahl, die multipliziert mit der ersten die zweite ergibt:&#x20;

```
(((argv[1] * 0x1064deadbeef4601) & 0xffffffffffffffff) == 0xD1038D2E07B42569)
```
* [https://8ksec.io/arm64-reversing-and-exploitation-part-8-exploiting-an-integer-overflow-vulnerability/](https://8ksec.io/arm64-reversing-and-exploitation-part-8-exploiting-an-integer-overflow-vulnerability/)
* Es wird nur 1B verwendet, um die Gr√∂√üe des Passworts zu speichern, sodass es m√∂glich ist, es zu √ºberlaufen und es glauben zu lassen, dass es eine L√§nge von 4 hat, w√§hrend es tats√§chlich 260 ist, um den Schutz der L√§ngen√ºberpr√ºfung zu umgehen und die n√§chste lokale Variable im Stack zu √ºberschreiben und beide Schutzma√ünahmen zu umgehen.

## ARM64

Dies **√§ndert sich nicht in ARM64**, wie Sie in [**diesem Blogbeitrag**](https://8ksec.io/arm64-reversing-and-exploitation-part-8-exploiting-an-integer-overflow-vulnerability/) sehen k√∂nnen.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
