# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–µ–∑–ø–µ–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–π –∫—É–ø–∏

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è AWS Red Team Expert (ARTE) –≤—ñ–¥ HackTricks**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è GCP Red Team Expert (GRTE) –≤—ñ–¥ HackTricks**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## unlink

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="unlink.md" %}
[unlink.md](unlink.md)
{% endcontent-ref %}

–û—Å—å –ø—ñ–¥—Å—É–º–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫:

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤–∫–∞–∑–∞–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Å–ø—ñ–≤–ø–∞–¥–∞—î –∑ `prev_size`, –≤–∫–∞–∑–∞–Ω–∏–º —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `corrupted size vs. prev_size`
* –¢–∞–∫–æ–∂ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ `P->fd->bk == P` —Ç–∞ `P->bk->fw == P`
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `corrupted double-linked list`
* –Ø–∫—â–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ —î –º–∞–ª–∏–º, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ `P->fd_nextsize->bk_nextsize == P` —Ç–∞ `P->bk_nextsize->fd_nextsize == P`
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `corrupted double-linked list (not small)`

## \_int\_malloc

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="malloc-and-sysmalloc.md" %}
[malloc-and-sysmalloc.md](malloc-and-sysmalloc.md)
{% endcontent-ref %}

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É —à–≤–∏–¥–∫–æ–≥–æ –±—ñ–Ω–∞:**
* –Ø–∫—â–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): unaligned fastbin chunk detected 2`
* –Ø–∫—â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): unaligned fastbin chunk detected`
* –Ø–∫—â–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –º–∞—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —á–µ—Ä–µ–∑ –π–æ–≥–æ —ñ–Ω–¥–µ–∫—Å —É —à–≤–∏–¥–∫–æ–º—É –±—ñ–Ω—ñ:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): memory corruption (fast)`
* –Ø–∫—â–æ –±—É–¥—å-—è–∫–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è tcache, –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): unaligned fastbin chunk detected 3`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É –º–∞–ª–æ–≥–æ –±—ñ–Ω–∞:**
* –Ø–∫—â–æ `victim->bk->fd != victim`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): smallbin double linked list corrupted`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –∫–æ–Ω—Å–æ–ª—ñ–¥–∞—Ü—ñ—ó** –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —à–≤–∏–¥–∫–æ–≥–æ –±—ñ–Ω—É:&#x20;
* –Ø–∫—â–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π, –≤–∏–∫–ª–∏—á—Ç–µ:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc_consolidate(): unaligned fastbin chunk detected`
* –Ø–∫—â–æ —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫–∏–π –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ —á–µ—Ä–µ–∑ —ñ–Ω–¥–µ–∫—Å:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc_consolidate(): invalid chunk size`
* –Ø–∫—â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –º–∞—î —Ä–æ–∑–º—ñ—Ä, –≤—ñ–¥–º—ñ–Ω–Ω–∏–π –≤—ñ–¥ –≤–∫–∞–∑–∞–Ω–æ–≥–æ prev\_chunk:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `corrupted size vs. prev_size in fastbins`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É –Ω–µ—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ–≥–æ –±—ñ–Ω–∞**:
* –Ø–∫—â–æ —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –¥–∏–≤–Ω–∏–π (–∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–∏–π –∞–±–æ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π):&#x20;
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): invalid size (unsorted)`
* –Ø–∫—â–æ —Ä–æ–∑–º—ñ—Ä –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –¥–∏–≤–Ω–∏–π (–∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–∏–π –∞–±–æ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π):
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): invalid next size (unsorted)`
* –Ø–∫—â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–º—ñ—Ä, –≤–∫–∞–∑–∞–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º, –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): mismatching next->prev_size (unsorted)`
* –Ø–∫—â–æ –Ω–µ `victim->bck->fd == victim` –∞–±–æ –Ω–µ `victim->fd == av (arena)`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): unsorted double linked list corrupted`
* –û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –∑–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π, –π–æ–≥–æ fd –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞—Ä–µ–Ω–∏.
* –Ø–∫—â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∫–∞–∑—É—î, —â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): invalid next->prev_inuse (unsorted)`
* –Ø–∫—â–æ `fwd->bk_nextsize->fd_nextsize != fwd`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): largebin double linked list corrupted (nextsize)`
* –Ø–∫—â–æ `fwd->bk->fd != fwd`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): largebin double linked list corrupted (bk)`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É –≤–µ–ª–∏–∫–æ–≥–æ –±—ñ–Ω–∞ (–∑–∞ —ñ–Ω–¥–µ–∫—Å–æ–º):**
* `bck->fd-> bk != bck`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): corrupted unsorted chunks`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—à—É–∫—É –≤–µ–ª–∏–∫–æ–≥–æ –±—ñ–Ω–∞ (–Ω–∞—Å—Ç—É–ø–Ω–∏–π –±—ñ–ª—å—à–∏–π):**
* `bck->fd-> bk != bck`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): corrupted unsorted chunks2`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Ö–Ω—å–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞:**
* `chunksize(av->top) > av->system_mem`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): corrupted top size`

## `tcache_get_n`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `tcache_get_n`:**
* –Ø–∫—â–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc(): unaligned tcache chunk detected`

## `tcache_thread_shutdown`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `tcache_thread_shutdown`:**
* –Ø–∫—â–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `tcache_thread_shutdown(): unaligned tcache chunk detected`

## `__libc_realloc`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `__libc_realloc`:**
* –Ø–∫—â–æ —Å—Ç–∞—Ä–∏–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π –∞–±–æ —Ä–æ–∑–º—ñ—Ä –±—É–≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `realloc(): invalid pointer`

## `_int_free`

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="free.md" %}
[free.md](free.md)
{% endcontent-ref %}

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É `_int_free`:**
* –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): invalid pointer`
* –†–æ–∑–º—ñ—Ä –±—ñ–ª—å—à–µ, –Ω—ñ–∂ `MINSIZE`, —ñ —Ä–æ–∑–º—ñ—Ä —Ç–∞–∫–æ–∂ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): invalid size`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `_int_free` tcache:**
* –Ø–∫—â–æ –∑–∞–ø–∏—Å—ñ–≤ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ `mp_.tcache_count`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): too many chunks detected in tcache`
* –Ø–∫—â–æ –∑–∞–ø–∏—Å –Ω–µ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): unaligned chunk detected in tcache 2`
* –Ø–∫—â–æ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤–∂–µ –±—É–≤ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–∏–π —ñ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π —è–∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç —É tcache:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): double free detected in tcache 2`
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `_int_free` fast bin:**
* –Ø–∫—â–æ —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –Ω–µ–¥—ñ–π—Å–Ω–∏–π (–∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π –∞–±–æ –º–∞–ª–∏–π), –≤–∏–∫–ª–∏—á—Ç–µ:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): invalid next size (fast)`
* –Ø–∫—â–æ –¥–æ–¥–∞–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤–∂–µ –±—É–≤ –Ω–∞ –≤–µ—Ä—à–∏–Ω—ñ —à–≤–∏–¥–∫–æ–≥–æ –±—ñ–Ω–∞:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `double free or corruption (fasttop)`
* –Ø–∫—â–æ —Ä–æ–∑–º—ñ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –Ω–∞ –≤–µ—Ä—à–∏–Ω—ñ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞, —è–∫–∏–π –º–∏ –¥–æ–¥–∞—î–º–æ:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `invalid fastbin entry (free)`
## **`_int_free_merge_chunk`**

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `_int_free_merge_chunk`:**
* –Ø–∫—â–æ –±–ª–æ–∫ - –≤–µ—Ä—Ö–Ω—ñ–π –±–ª–æ–∫:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `–ø–æ–¥–≤—ñ–π–Ω–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –∞–±–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è (–≤–µ—Ä—Ö–Ω—ñ–π –±–ª–æ–∫)`
* –Ø–∫—â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –±–ª–æ–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ –º–µ–∂–∞–º–∏ –∞—Ä–µ–Ω–∏:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `–ø–æ–¥–≤—ñ–π–Ω–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –∞–±–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è (–∑–æ–≤–Ω—ñ)`
* –Ø–∫—â–æ –±–ª–æ–∫ –Ω–µ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π (–≤ prev\_inuse –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –±–ª–æ–∫—É):
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `–ø–æ–¥–≤—ñ–π–Ω–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è –∞–±–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è (!prev)`
* –Ø–∫—â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –±–ª–æ–∫ –º–∞—î –∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–µ–Ω—å–∫–∏–π –∞–±–æ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π —Ä–æ–∑–º—ñ—Ä:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): –Ω–µ–¥—ñ–π—Å–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–º—ñ—Ä (–∑–≤–∏—á–∞–π–Ω–∏–π)`
* –Ø–∫—â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –±–ª–æ–∫ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, —Å–ø—Ä–æ–±—É—î —Å–∫–æ–Ω—Å–æ–ª—ñ–¥—É–≤–∞—Ç–∏. –ê–ª–µ, —è–∫—â–æ `prev_size` –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É, –≤–∫–∞–∑–∞–Ω–æ–≥–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –±–ª–æ–∫—É:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `–ø–æ—à–∫–æ–¥–∂–µ–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –ø—Ä–æ—Ç–∏ prev_size –ø—ñ–¥ —á–∞—Å –∫–æ–Ω—Å–æ–ª—ñ–¥–∞—Ü—ñ—ó`

## **`_int_free_create_chunk`**

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `_int_free_create_chunk`:**
* –î–æ–¥–∞–≤–∞–Ω–Ω—è –±–ª–æ–∫—É –≤ –Ω–µ—É–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–∏–π –±—ñ–Ω, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `free(): –ø–æ—à–∫–æ–¥–∂–µ–Ω—ñ –Ω–µ—É–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω—ñ –±–ª–æ–∫–∏`

## `do_check_malloc_state`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `do_check_malloc_state`:**
* –Ø–∫—â–æ –Ω–µ–≤—ñ—Ä–Ω–æ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π —à–≤–∏–¥–∫–∏–π –±—ñ–Ω-–±–ª–æ–∫:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `do_check_malloc_state(): –≤–∏—è–≤–ª–µ–Ω–æ –Ω–µ–≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π —à–≤–∏–¥–∫–∏–π –±—ñ–Ω-–±–ª–æ–∫`

## `malloc_consolidate`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `malloc_consolidate`:**
* –Ø–∫—â–æ –Ω–µ–≤—ñ—Ä–Ω–æ –≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π —à–≤–∏–¥–∫–∏–π –±—ñ–Ω-–±–ª–æ–∫:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc_consolidate(): –≤–∏—è–≤–ª–µ–Ω–æ –Ω–µ–≤–∏—Ä—ñ–≤–Ω—è–Ω–∏–π —à–≤–∏–¥–∫–∏–π –±—ñ–Ω-–±–ª–æ–∫`
* –Ø–∫—â–æ –Ω–µ–≤—ñ—Ä–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —à–≤–∏–¥–∫–æ–≥–æ –±—ñ–Ω-–±–ª–æ–∫—É:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `malloc_consolidate(): –Ω–µ–¥—ñ–π—Å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä –±–ª–æ–∫—É`

## `_int_realloc`

* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ `_int_realloc`:**
* –†–æ–∑–º—ñ—Ä –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π –∞–±–æ –∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `realloc(): –Ω–µ–¥—ñ–π—Å–Ω–∏–π —Å—Ç–∞—Ä–∏–π —Ä–æ–∑–º—ñ—Ä`
* –†–æ–∑–º—ñ—Ä –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –±–ª–æ–∫—É –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π –∞–±–æ –∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–∏–π:
* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É: `realloc(): –Ω–µ–¥—ñ–π—Å–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–º—ñ—Ä`
