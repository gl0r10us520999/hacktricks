# Heap Functions Security Checks

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## unlink

For more info check:

{% content-ref url="unlink.md" %}
[unlink.md](unlink.md)
{% endcontent-ref %}

‡§Ø‡§π ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ö‡•á‡§ï ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§π‡•à:

* ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§Æ‡•á‡§Ç `prev_size` ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§® ‡§π‡•à
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `corrupted size vs. prev_size`
* ‡§Ø‡§π ‡§≠‡•Ä ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø `P->fd->bk == P` ‡§î‡§∞ `P->bk->fw == P`
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `corrupted double-linked list`
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§§‡•ã ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø `P->fd_nextsize->bk_nextsize == P` ‡§î‡§∞ `P->bk_nextsize->fd_nextsize == P`
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `corrupted double-linked list (not small)`

## \_int\_malloc

For more info check:

{% content-ref url="malloc-and-sysmalloc.md" %}
[malloc-and-sysmalloc.md](malloc-and-sysmalloc.md)
{% endcontent-ref %}

* **‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): unaligned fastbin chunk detected 2`
* ‡§Ø‡§¶‡§ø ‡§Ü‡§ó‡•á ‡§ï‡§æ ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): unaligned fastbin chunk detected`
* ‡§Ø‡§¶‡§ø ‡§≤‡•å‡§ü‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§ö‡§Ç‡§ï ‡§â‡§∏‡§ï‡§æ ‡§á‡§Ç‡§°‡•á‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£ ‡§∏‡§π‡•Ä ‡§Ü‡§ï‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): memory corruption (fast)`
* ‡§Ø‡§¶‡§ø tcache ‡§ï‡•ã ‡§≠‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§ï‡•ã‡§à ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): unaligned fastbin chunk detected 3`
* **‡§õ‡•ã‡§ü‡•á ‡§¨‡§ø‡§® ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø `victim->bk->fd != victim`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): smallbin double linked list corrupted`
* **‡§ï‡§Ç‡§∏‡•ã‡§≤‡§ø‡§°‡•á‡§ü ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç** ‡§ú‡•ã ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à:&#x20;
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à ‡§§‡•ã ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡•á‡§Ç:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc_consolidate(): unaligned fastbin chunk detected`
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§â‡§∏ ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à ‡§ú‡•ã ‡§á‡§∏‡•á ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc_consolidate(): invalid chunk size`
* ‡§Ø‡§¶‡§ø ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à ‡§î‡§∞ ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ `prev_chunk` ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `corrupted size vs. prev_size in fastbins`
* **‡§Ö‡§®‡§∏‡•â‡§∞‡•ç‡§ü‡•á‡§° ‡§¨‡§ø‡§® ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç**:
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§Ö‡§ú‡•Ä‡§¨ ‡§π‡•à (‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§Ø‡§æ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ):&#x20;
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): invalid size (unsorted)`
* ‡§Ø‡§¶‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§Ö‡§ú‡•Ä‡§¨ ‡§π‡•à (‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§Ø‡§æ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ):
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): invalid next size (unsorted)`
* ‡§Ø‡§¶‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§™‡§ø‡§õ‡§≤‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): mismatching next->prev_size (unsorted)`
* ‡§Ø‡§¶‡§ø `victim->bck->fd == victim` ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§Ø‡§æ `victim->fd == av (arena)` ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): unsorted double linked list corrupted`
* ‡§ö‡•Ç‡§Ç‡§ï‡§ø ‡§π‡§Æ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§è‡§ï ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§á‡§∏‡§ï‡§æ fd ‡§π‡§Æ‡•á‡§∂‡§æ arena ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§∂‡§æ‡§∞‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§
* ‡§Ø‡§¶‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§ï‡§ø ‡§™‡§ø‡§õ‡§≤‡•á ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): invalid next->prev_inuse (unsorted)`
* ‡§Ø‡§¶‡§ø `fwd->bk_nextsize->fd_nextsize != fwd`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): largebin double linked list corrupted (nextsize)`
* ‡§Ø‡§¶‡§ø `fwd->bk->fd != fwd`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): largebin double linked list corrupted (bk)`
* **‡§¨‡§°‡§º‡•á ‡§¨‡§ø‡§® (‡§á‡§Ç‡§°‡•á‡§ï‡•ç‡§∏ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ) ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* `bck->fd-> bk != bck`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): corrupted unsorted chunks`
* **‡§¨‡§°‡§º‡•á ‡§¨‡§ø‡§® (‡§Ö‡§ó‡§≤‡•á ‡§¨‡§°‡§º‡•á) ‡§ñ‡•ã‡§ú ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* `bck->fd-> bk != bck`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): corrupted unsorted chunks2`
* **‡§ü‡•â‡§™ ‡§ö‡§Ç‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* `chunksize(av->top) > av->system_mem`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): corrupted top size`

## `tcache_get_n`

* **`tcache_get_n` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc(): unaligned tcache chunk detected`

## `tcache_thread_shutdown`

* **`tcache_thread_shutdown` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `tcache_thread_shutdown(): unaligned tcache chunk detected`

## `__libc_realloc`

* **`__libc_realloc` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à ‡§Ø‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§ó‡§≤‡§§ ‡§•‡§æ:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `realloc(): invalid pointer`

## `_int_free`

For more info check:

{% content-ref url="free.md" %}
[free.md](free.md)
{% endcontent-ref %}

* **`_int_free` ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): invalid pointer`
* ‡§Ü‡§ï‡§æ‡§∞ `MINSIZE` ‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§î‡§∞ ‡§Ü‡§ï‡§æ‡§∞ ‡§≠‡•Ä ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): invalid size`
* **`_int_free` tcache ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø `mp_.tcache_count` ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø‡§Ø‡§æ‡§Å ‡§π‡•à‡§Ç:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): too many chunks detected in tcache`
* ‡§Ø‡§¶‡§ø ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): unaligned chunk detected in tcache 2`
* ‡§Ø‡§¶‡§ø ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ö‡§Ç‡§ï ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ tcache ‡§Æ‡•á‡§Ç ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): double free detected in tcache 2`
* **`_int_free` ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à (‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ ‡§Ø‡§æ ‡§õ‡•ã‡§ü‡§æ) ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡•á‡§Ç:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): invalid next size (fast)`
* ‡§Ø‡§¶‡§ø ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ ‡§ö‡§Ç‡§ï ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ï‡§æ ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§•‡§æ:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `double free or corruption (fasttop)`
* ‡§Ø‡§¶‡§ø ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§™‡§∞ ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§â‡§∏ ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à ‡§ú‡§ø‡§∏‡•á ‡§π‡§Æ ‡§ú‡•ã‡§°‡§º ‡§∞‡§π‡•á ‡§π‡•à‡§Ç:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `invalid fastbin entry (free)`

## **`_int_free_merge_chunk`**

* **`_int_free_merge_chunk` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§ö‡§Ç‡§ï ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `double free or corruption (top)`
* ‡§Ø‡§¶‡§ø ‡§Ö‡§ó‡§≤‡§æ ‡§ö‡§Ç‡§ï ‡§è‡§∞‡•á‡§®‡§æ ‡§ï‡•Ä ‡§∏‡•Ä‡§Æ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `double free or corruption (out)`
* ‡§Ø‡§¶‡§ø ‡§ö‡§Ç‡§ï ‡§ï‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§ö‡§ø‡§π‡•ç‡§®‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à (‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡•á prev_inuse ‡§Æ‡•á‡§Ç):
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `double free or corruption (!prev)`
* ‡§Ø‡§¶‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§Ø‡§æ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): invalid next size (normal)`
* ‡§Ø‡§¶‡§ø ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§ï‡§Ç‡§∏‡•ã‡§≤‡§ø‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§≤‡•á‡§ï‡§ø‡§®, ‡§Ø‡§¶‡§ø `prev_size` ‡§™‡§ø‡§õ‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `corrupted size vs. prev_size while consolidating`

## **`_int_free_create_chunk`**

* **`_int_free_create_chunk` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ö‡§®‡§∏‡•â‡§∞‡•ç‡§ü‡•á‡§° ‡§¨‡§ø‡§® ‡§Æ‡•á‡§Ç ‡§ö‡§Ç‡§ï ‡§ú‡•ã‡§°‡§º‡§§‡•á ‡§∏‡§Æ‡§Ø, ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)`:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `free(): corrupted unsorted chunks`

## `do_check_malloc_state`

* **`do_check_malloc_state` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ö‡§Ç‡§ï:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `do_check_malloc_state(): unaligned fastbin chunk detected`

## `malloc_consolidate`

* **`malloc_consolidate` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ø‡§¶‡§ø ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§ø‡§§ ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ö‡§Ç‡§ï:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc_consolidate(): unaligned fastbin chunk detected`
* ‡§Ø‡§¶‡§ø ‡§ó‡§≤‡§§ ‡§´‡§æ‡§∏‡•ç‡§ü ‡§¨‡§ø‡§® ‡§ö‡§Ç‡§ï ‡§Ü‡§ï‡§æ‡§∞:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `malloc_consolidate(): invalid chunk size`

## `_int_realloc`

* **`_int_realloc` ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç:**
* ‡§Ü‡§ï‡§æ‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ ‡§Ø‡§æ ‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `realloc(): invalid old size`
* ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ ‡§Ø‡§æ ‡§¨‡§π‡•Å‡§§ ‡§õ‡•ã‡§ü‡§æ ‡§π‡•à:
* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂: `realloc(): invalid next size`

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
