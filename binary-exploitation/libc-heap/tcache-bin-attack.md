# Tcache Bin Attack

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

## Basic Information

Tcache рдмрд┐рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="bins-and-memory-allocations.md" %}
[bins-and-memory-allocations.md](bins-and-memory-allocations.md)
{% endcontent-ref %}

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Tcache рдХреЛ Glibc рд╕рдВрд╕реНрдХрд░рдг 2.26 рдореЗрдВ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

**Tcache рд╣рдорд▓рд╛** (рдЬрд┐рд╕реЗ **Tcache рд╡рд┐рд╖рд╛рдХреНрддрддрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ) [**guyinatuxido рдкреГрд╖реНрда**](https://guyinatuxedo.github.io/29-tcache/tcache\_explanation/index.html) рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рддреЗрдЬ рдмрд┐рди рд╣рдорд▓реЗ рдХреЗ рд╕рдорд╛рди рд╣реИ рдЬрд╣рд╛рдБ рд▓рдХреНрд╖реНрдп рдПрдХ рдореБрдХреНрдд рдЪрдВрдХ рдХреЗ рдЕрдВрджрд░ рдмрд┐рди рдореЗрдВ рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдПрдХ рдордирдорд╛рдиреЗ рдкрддреЗ рдкрд░ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рдмрд╛рдж рдореЗрдВ рдЙрд╕ рд╡рд┐рд╢реЗрд╖ рдкрддреЗ рдХреЛ **рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдЬрдХрд▓, рдпрджрд┐ рдЖрдк рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдХреЛрдб рдЪрд▓рд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рддреНрд░реБрдЯрд┐ рдорд┐рд▓реЗрдЧреА: **`malloc(): unaligned tcache chunk detected`**ред рдЗрд╕рд▓рд┐рдП, рдирдП рдкреЙрдЗрдВрдЯрд░ рдореЗрдВ рдПрдХ рд╕рдВрд░реЗрдЦрд┐рдд рдкрддрд╛ (рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рдмрд╛рд░ рдЪрд▓рд╛рдирд╛ рддрд╛рдХрд┐ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдкрддрд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдВрд░реЗрдЦрд┐рдд рд╣реЛ) рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд┐рдЦрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

### Tcache indexes attack

рдЖрдорддреМрд░ рдкрд░, рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд╣реАрдк рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдПрдХ рдЪрдВрдХ рд╣реЛ рдЬрд┐рд╕рдореЗрдВ **tcache рдХреЗ рдЕрдВрджрд░ рдкреНрд░рддрд┐ рдЗрдВрдбреЗрдХреНрд╕ рдЪрдВрдХреЛрдВ рдХреА рдорд╛рддреНрд░рд╛** рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ tcache рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд╣реЗрдб рдЪрдВрдХ рдХрд╛ рдкрддрд╛** рд╣реЛред рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдпрд╣ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ рдХрд┐ **рдХреБрдЫ рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рд╣реЗрдб рдЪрдВрдХ рдХреЛ рдПрдХ рдЗрдЪреНрдЫрд┐рдд рдкрддреЗ рдкрд░ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП** (рдЬреИрд╕реЗ `__malloc_hook`) рддрд╛рдХрд┐ рдлрд┐рд░ рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ `__malloc_hook` рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

## Examples

* CTF [https://guyinatuxedo.github.io/29-tcache/dcquals19\_babyheap/index.html](https://guyinatuxedo.github.io/29-tcache/dcquals19\_babyheap/index.html)
* **Libc рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ**: рдпрд╣ tcaches рдХреЛ рднрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдПрдХ рдЪрдВрдХ рдХреЛ рдЕрд╕рдВрд░рдЪрд┐рдд рд╕реВрдЪреА рдореЗрдВ рдЬреЛрдбрд╝рдирд╛, tcache рдХреЛ рдЦрд╛рд▓реА рдХрд░рдирд╛ рдФрд░ **рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ 8B рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдХреЗ рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рд╕реЗ рдЪрдВрдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛** рд╕рдВрднрд╡ рд╣реИ, рдЬрд┐рд╕рд╕реЗ **рдЪрдВрдХ рд╕реЗ libc рдХреЗ рджреВрд╕рд░реЗ рдкрддреЗ рдХреЛ рдмрд░рдХрд░рд╛рд░ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ рддрд╛рдХрд┐ рд╣рдо рдЗрд╕реЗ рдкрдврд╝ рд╕рдХреЗрдВ**ред
* **Tcache рд╣рдорд▓рд╛**: рдмрд╛рдЗрдирд░реА рдПрдХ 1B рд╣реАрдк рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ **рдЖрд╡рдВрдЯрд┐рдд рдЪрдВрдХ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╣реЗрдбрд░** рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдмрдбрд╝рд╛ рд╣реЛ рдЬрд╛рдПред рдлрд┐рд░, рдЗрд╕ рдЪрдВрдХ рдХреЛ **рдореБрдХреНрдд** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рдирдХрд▓реА рдЖрдХрд╛рд░ рдХреЗ рдЪрдВрдХреЛрдВ рдХреЗ tcache рдореЗрдВ рдЬреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдлрд┐рд░, рд╣рдо рдирдХрд▓реА рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдкрд┐рдЫрд▓реЗ рдЪрдВрдХ рдХреЛ **рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╣ рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдпрд╣ рдЪрдВрдХ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЫреЛрдЯрд╛ рдерд╛** рдФрд░ рдпрд╣ рд╣рдореЗрдВ **рдореЗрдореЛрд░реА рдореЗрдВ рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред\
рд╣рдо рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ **рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ FD рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рддрд╛рдХрд┐ рдпрд╣ **`malloc_hook`** рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗ, рддрд╛рдХрд┐ рдлрд┐рд░ 2 рдкреЙрдЗрдВрдЯрд░реНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ: рдкрд╣рд▓реЗ рд╡реИрдз рдкреЙрдЗрдВрдЯрд░ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЕрднреА рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛, рдФрд░ рдлрд┐рд░ рджреВрд╕рд░рд╛ рдЖрд╡рдВрдЯрди **`malloc_hook`** рдореЗрдВ рдПрдХ рдЪрдВрдХ рд▓реМрдЯрд╛рдПрдЧрд╛ рдЬрд┐рд╕реЗ **one gadget** рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* CTF [https://guyinatuxedo.github.io/29-tcache/plaid19\_cpp/index.html](https://guyinatuxedo.github.io/29-tcache/plaid19\_cpp/index.html)
* **Libc рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ**: рдпрд╣рд╛рдБ рдПрдХ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж рдореБрдХреНрдд рдФрд░ рдПрдХ рдбрдмрд▓ рдлреНрд░реА рд╣реИред рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд▓реЗрдЦрдХ рдиреЗ рдПрдХ рдЫреЛрдЯреЗ рдмрд┐рди рдореЗрдВ рд░рдЦреЗ рдЧрдП рдЪрдВрдХ рдХреЗ рдкрддреЗ рдХреЛ рдкрдврд╝рдХрд░ libc рдХрд╛ рдПрдХ рдкрддрд╛ рд▓реАрдХ рдХрд┐рдпрд╛ (рдЬреИрд╕реЗ рдЗрд╕реЗ рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ рд▓реЗрдХрд┐рди рдЫреЛрдЯреЗ рдмрд┐рди рд╕реЗ)ред
* **Tcache рд╣рдорд▓рд╛**: рдПрдХ Tcache **рдбрдмрд▓ рдлреНрд░реА** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рд╣реА рдЪрдВрдХ рдХреЛ рджреЛ рдмрд╛рд░ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП Tcache рдХреЗ рдЕрдВрджрд░ рдЪрдВрдХ рд╕реНрд╡рдпрдВ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧрд╛ред рдлрд┐рд░, рдЗрд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ FD рдкреЙрдЗрдВрдЯрд░ **рдлреНрд░реА рд╣реБрдХ** рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реВрдЪреА рдореЗрдВ рдЕрдЧрд▓рд╛ рдЪрдВрдХ рдлреНрд░реА рд╣реБрдХ рдореЗрдВ рд╣реЛред рдлрд┐рд░, рдЗрд╕реЗ рднреА рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣рд╛рдБ `system` рдХрд╛ рдкрддрд╛ рд▓рд┐рдЦрдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ рдЬрдм `"/bin/sh"` рд╡рд╛рд▓рд╛ malloc рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдП рддреЛ рд╣рдореЗрдВ рдПрдХ рд╢реЗрд▓ рдорд┐рд▓ рд╕рдХреЗред
* CTF [https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps0/index.html](https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps0/index.html)
* рдпрд╣рд╛рдБ рдореБрдЦреНрдп рдХрдордЬреЛрд░реА рдпрд╣ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рднреА рдкрддреЗ рдХреЛ рд╣реАрдк рдореЗрдВ `free` рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред
* **Tcache indexes attack**: рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рдРрд╕реЗ рдЖрдХрд╛рд░ рдХрд╛ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдФрд░ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬреЛ рдЬрдм tcache рдЪрдВрдХ (tcache рдмрд┐рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╡рд╛рд▓рд╛ рдЪрдВрдХ) рдХреЗ рдЕрдВрджрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ **0x100** рдХреЗ рдорд╛рди рд╡рд╛рд▓рд╛ рдПрдХ рдкрддрд╛ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ tcache рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рди рдореЗрдВ рдЪрдВрдХреЛрдВ рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рдПрдХ рдЪрдВрдХ 0x100 рдХрд╛ рдорд╛рди рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред
* рдлрд┐рд░, рдпрд╣ рдорд╛рди рдРрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ рдЬреИрд╕реЗ 0x100 рдХрд╛ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдЪрдВрдХ рд╣реИред рдЗрд╕реЗ `free` рдХрд░рдХреЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ **рдЙрд╕ рдкрддреЗ рдХреЛ tcache рдореЗрдВ рдЖрдХрд╛рд░ 0x100 рдХреЗ рдЪрдВрдХреЛрдВ рдХреЗ рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛**ред
* рдлрд┐рд░, **0x100** рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдЪрдВрдХ **рдЖрд╡рдВрдЯрд┐рдд** рдХрд░рддреЗ рд╕рдордп, рдкрд┐рдЫрд▓реЗ рдкрддреЗ рдХреЛ рдПрдХ рдЪрдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдЕрдиреНрдп tcache рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, malloc рд╣реБрдХ рдХрд╛ рдкрддрд╛ рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рдбрд╛рд▓рдХрд░ рдФрд░ рдЙрд╕ рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдХреЗ calloc рд╣реБрдХ рдореЗрдВ рдПрдХ рдЪрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛, рдЬреЛ рдПрдХ **one gadget** рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╣рдореЗрдВ рдПрдХ рд╢реЗрд▓ рдорд┐рд▓ рд╕рдХреЗред
* CTF [https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps1/index.html](https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps1/index.html)
* рдкрд╣рд▓реЗ рдЬреИрд╕рд╛ рд╣реА рдХрдордЬреЛрд░, рд▓реЗрдХрд┐рди рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ рд╕рд╛рдеред
* **Tcache indexes attack**: рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЗ рд╕рдорд╛рди рд╣рдорд▓рд╛ рд▓реЗрдХрд┐рди рдХрдо рдЪрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **tcache рдЬрд╛рдирдХрд╛рд░реА рд╡рд╛рд▓рд╛ рдЪрдВрдХ рдореБрдХреНрдд рдХрд░рдХреЗ** рддрд╛рдХрд┐ рдЗрд╕рдХрд╛ рдкрддрд╛ рдЙрд╕рдХреЗ рдЖрдХрд╛рд░ рдХреЗ tcache рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХреЗ рддрд╛рдХрд┐ рдЙрд╕ рдЖрдХрд╛рд░ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдФрд░ tcache рдЪрдВрдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХ рдЪрдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬреЛ рдПрдХ рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рдкрддреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдлреНрд░реА рд╣реБрдХ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЗрд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВ, рдФрд░ рдЙрд╕ рдкрд░ рдПрдХ **one gadget** рд▓рд┐рдЦреЗрдВред
* [**Math Door. HTB Cyber Apocalypse CTF 2023**](https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/math-door/)
* `fd` рдкреЙрдЗрдВрдЯрд░ рдореЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП **Write After Free**ред
* рдЗрд╕ рдЪреБрдиреМрддреА рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реЗ **heap feng-shui** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ **Tcache** рдлреНрд░реА-рд▓рд┐рд╕реНрдЯ рдХреЗ рд╣реЗрдб рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ рдХрд┐рддрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИред
* `stdout` (FSOP) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **Glibc рд▓реАрдХ**ред
* рдордирдорд╛рдиреЗ рд▓рд┐рдЦрдиреЗ рдХреА рдкреНрд░рд╛рдЗрдорд┐рдЯрд┐рд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **Tcache рд╡рд┐рд╖рд╛рдХреНрддрддрд╛**ред

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
