# –ê—Ç–∞–∫–∞ –Ω–∞ Tcache Bin

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –•–∞–∫—ñ–Ω–≥ AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è AWS Red Team Expert (ARTE) –≤—ñ–¥ HackTricks**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –•–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è GCP Red Team Expert (GRTE) –≤—ñ–¥ HackTricks**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —â–æ —Ç–∞–∫–µ Tcache bin, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É:

{% content-ref url="bins-and-memory-allocations.md" %}
[bins-and-memory-allocations.md](bins-and-memory-allocations.md)
{% endcontent-ref %}

–ü–æ-–ø–µ—Ä—à–µ, —Å–ª—ñ–¥ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ Tcache –±—É–≤ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–∏–π —É –≤–µ—Ä—Å—ñ—ó Glibc 2.26.

**–ê—Ç–∞–∫–∞ –Ω–∞ Tcache** (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∞ —è–∫ **–∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è Tcache**) –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [**guyinatuxido**](https://guyinatuxedo.github.io/29-tcache/tcache\_explanation/index.html) –¥—É–∂–µ —Å—Ö–æ–∂–∞ –Ω–∞ –∞—Ç–∞–∫—É –Ω–∞ —à–≤–∏–¥–∫–∏–π –±—ñ–Ω, –¥–µ –º–µ—Ç–æ—é —î –ø–µ—Ä–µ–∑–∞–ø–∏—Å –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —á–∞–Ω–∫ —É –±—ñ–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–æ–≥–æ —á–∞–Ω–∫—É –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω—É –∞–¥—Ä–µ—Å—É, —â–æ–± –ø—ñ–∑–Ω—ñ—à–µ –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ **–≤–∏–¥—ñ–ª–∏—Ç–∏ —Ü—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –∞–¥—Ä–µ—Å—É —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏**.

–û–¥–Ω–∞–∫ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π –¥–µ–Ω—å, —è–∫—â–æ –≤–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–≥–∞–¥–∞–Ω–∏–π –∫–æ–¥, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –ø–æ–º–∏–ª–∫—É: **`malloc(): unaligned tcache chunk detected`**. –¢–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø–∏—Å–∞—Ç–∏ —è–∫ –∞–¥—Ä–µ—Å—É –≤ –Ω–æ–≤–∏–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –≤–∏—Ä—ñ–≤–Ω—è–Ω—É –∞–¥—Ä–µ—Å—É (–∞–±–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, —â–æ–± –∑–∞–ø–∏—Å–∞–Ω–∞ –∞–¥—Ä–µ—Å–∞ —Ñ–∞–∫—Ç–∏—á–Ω–æ –±—É–ª–∞ –≤–∏—Ä—ñ–≤–Ω—è–Ω–æ—é).

### –ê—Ç–∞–∫–∏ –Ω–∞ —ñ–Ω–¥–µ–∫—Å–∏ Tcache

–ó–∞–∑–≤–∏—á–∞–π –Ω–∞ –ø–æ—á–∞—Ç–∫—É –∫—É–ø–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —á–∞–Ω–∫, —â–æ –º—ñ—Å—Ç–∏—Ç—å **–∫—ñ–ª—å–∫—ñ—Å—Ç—å —á–∞–Ω–∫—ñ–≤ –Ω–∞ –∫–æ–∂–Ω–∏–π —ñ–Ω–¥–µ–∫—Å** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ tcache —Ç–∞ –∞–¥—Ä–µ—Å—É **–≥–æ–ª–æ–≤–Ω–æ–≥–æ —á–∞–Ω–∫—É –∫–æ–∂–Ω–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É tcache**. –Ø–∫—â–æ –∑ —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏ –º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –±—É–¥–µ –º–æ–∂–ª–∏–≤–æ **–∑—Ä–æ–±–∏—Ç–∏ –≥–æ–ª–æ–≤–Ω–∏–π —á–∞–Ω–∫ –¥–µ—è–∫–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –±–∞–∂–∞–Ω—É –∞–¥—Ä–µ—Å—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `__malloc_hook`), –∞ –ø–æ—Ç—ñ–º –≤–∏–¥—ñ–ª–∏—Ç–∏ —á–∞–Ω–∫ —Ä–æ–∑–º—ñ—Ä—É —ñ–Ω–¥–µ–∫—Å—É —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–º—ñ—Å—Ç `__malloc_hook` —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É.

## –ü—Ä–∏–∫–ª–∞–¥–∏

* CTF [https://guyinatuxedo.github.io/29-tcache/dcquals19\_babyheap/index.html](https://guyinatuxedo.github.io/29-tcache/dcquals19\_babyheap/index.html)
* **–í–∏—Ç—ñ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ Libc**: –ú–æ–∂–ª–∏–≤–æ –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ tcaches, –¥–æ–¥–∞—Ç–∏ —á–∞–Ω–∫ —É –Ω–µ—É–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫, –æ—á–∏—Å—Ç–∏—Ç–∏ tcache —Ç–∞ **–ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–¥—ñ–ª–∏—Ç–∏ —á–∞–Ω–∫ –∑ –Ω–µ—É–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–æ–≥–æ –±—ñ–Ω–∞**, –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ –ª–∏—à–µ –ø–µ—Ä—à—ñ 8 –±–∞–π—Ç, –∑–∞–ª–∏—à–∞—é—á–∏ **–¥—Ä—É–≥—É –∞–¥—Ä–µ—Å—É –¥–æ libc –∑ —á–∞–Ω–∫—É –Ω–µ–¥–æ—Ç–æ—Ä–∫–∞–Ω–æ—é, —â–æ–± –º–∏ –º–æ–≥–ª–∏ —ó—ó –ø—Ä–æ—á–∏—Ç–∞—Ç–∏**.
* **–ê—Ç–∞–∫–∞ –Ω–∞ Tcache**: –ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–Ω—è –∫—É–ø–∏ 1 –±–∞–π—Ç. –¶–µ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –∑–º—ñ–Ω–∏ **–∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ä–æ–∑–º—ñ—Ä—É** –≤–∏–¥—ñ–ª–µ–Ω–æ–≥–æ —á–∞–Ω–∫—É, –∑—Ä–æ–±–∏–≤—à–∏ –π–æ–≥–æ –±—ñ–ª—å—à–∏–º. –ü–æ—Ç—ñ–º —Ü–µ–π —á–∞–Ω–∫ –±—É–¥–µ **–≤–∏–≤—ñ–ª—å–Ω–µ–Ω–æ**, –¥–æ–¥–∞—é—á–∏ –π–æ–≥–æ –¥–æ tcache —á–∞–Ω–∫—ñ–≤ —Ñ–∞–ª—å—à–∏–≤–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É. –ü–æ—Ç—ñ–º –º–∏ –≤–∏–¥—ñ–ª–∏–º–æ —á–∞–Ω–∫ —ñ–∑ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–º —Ä–æ–∑–º—ñ—Ä–æ–º, —ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —á–∞–Ω–∫ –±—É–¥–µ **–ø–æ–≤–µ—Ä–Ω—É—Ç–æ –∑–Ω–∞–≤—à–∏, —â–æ —Ü–µ–π —á–∞–Ω–∫ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –±—É–≤ –º–µ–Ω—à–∏–º**, —ñ —Ü–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —á–∞–Ω–∫ –≤ –ø–∞–º'—è—Ç—ñ**.\
–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —Ü–µ –¥–ª—è **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ FD –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —á–∞–Ω–∫**, —â–æ–± –≤–∫–∞–∑—É–≤–∞–≤ –Ω–∞ **`malloc_hook`**, —Ç–æ–º—É –ø–æ—Ç—ñ–º –º–æ–∂–Ω–∞ –≤–∏–¥—ñ–ª–∏—Ç–∏ 2 –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏: —Å–ø–æ—á–∞—Ç–∫—É –∑–∞–∫–æ–Ω–Ω–∏–π –≤–∫–∞–∑—ñ–≤–Ω–∏–∫, —è–∫–∏–π –º–∏ —â–æ–π–Ω–æ –∑–º—ñ–Ω–∏–ª–∏, –∞ –ø–æ—Ç—ñ–º –¥—Ä—É–≥–µ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –ø–æ–≤–µ—Ä–Ω–µ —á–∞–Ω–∫ —É **`malloc_hook`**, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è **one gadget**.
* CTF [https://guyinatuxedo.github.io/29-tcache/plaid19\_cpp/index.html](https://guyinatuxedo.github.io/29-tcache/plaid19\_cpp/index.html)
* **–í–∏—Ç—ñ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ Libc**: –Ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—ñ—Å–ª—è –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è —Ç–∞ –ø–æ–¥–≤—ñ–π–Ω–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è. –£ —Ü—å–æ–º—É –æ–ø–∏—Å—ñ –∞–≤—Ç–æ—Ä –≤–∏—Ç—ñ–∫ –∞–¥—Ä–µ—Å–∏ libc, –ø—Ä–æ—á–∏—Ç–∞–≤—à–∏ –∞–¥—Ä–µ—Å—É —á–∞–Ω–∫—É, —Ä–æ–∑–º—ñ—â–µ–Ω–æ–≥–æ –≤ –º–∞–ª–æ–º—É –±—ñ–Ω—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏—Ç—ñ–∫ –∑ –Ω–µ—É–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–æ–≥–æ –±—ñ–Ω–∞, –∞–ª–µ –∑ –º–∞–ª–æ–≥–æ).
* **–ê—Ç–∞–∫–∞ –Ω–∞ Tcache**: –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è Tcache —á–µ—Ä–µ–∑ **–ø–æ–¥–≤—ñ–π–Ω–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è**. –¢–æ–π —Å–∞–º–∏–π —á–∞–Ω–∫ –≤–∏–≤—ñ–ª—å–Ω—é—î—Ç—å—Å—è –¥–≤—ñ—á—ñ, —Ç–æ–º—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ Tcache —á–∞–Ω–∫ –±—É–¥–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —Å–µ–±–µ. –ü–æ—Ç—ñ–º –π–æ–≥–æ –≤–∏–¥—ñ–ª—è—Ç—å, –π–æ–≥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ FD –±—É–¥–µ –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ **free hook**, —ñ –ø–æ—Ç—ñ–º –π–æ–≥–æ –∑–Ω–æ–≤—É –≤–∏–¥—ñ–ª—è—Ç—å, —Ç–æ–º—É –Ω–∞—Å—Ç—É–ø–Ω–∏–π —á–∞–Ω–∫ —É —Å–ø–∏—Å–∫—É –±—É–¥–µ –≤ free hook. –ü–æ—Ç—ñ–º –π–æ–≥–æ —Ç–∞–∫–æ–∂ –≤–∏–¥—ñ–ª—è—Ç—å —ñ –±—É–¥–µ –º–æ–∂–ª–∏–≤–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –∞–¥—Ä–µ—Å—É `system` —Ç—É—Ç, —Ç–æ–º—É –∫–æ–ª–∏ –≤–∏–¥—ñ–ª–µ–Ω–∏–π malloc, —â–æ –º—ñ—Å—Ç–∏—Ç—å `"/bin/sh"`, –±—É–¥–µ –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–∏–π, –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –æ–±–æ–ª–æ–Ω–∫—É.
* CTF [https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps0/index.html](https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps0/index.html)
* –û—Å–Ω–æ–≤–Ω–∞ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —Ç—É—Ç - –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å `–≤–∏–≤—ñ–ª—å–Ω–∏—Ç–∏` –±—É–¥—å-—è–∫—É –∞–¥—Ä–µ—Å—É –≤ –∫—É–ø—ñ, –≤–∫–∞–∑–∞–≤—à–∏ —ó—ó –∑–º—ñ—â–µ–Ω–Ω—è
* **–ê—Ç–∞–∫–∏ –Ω–∞ —ñ–Ω–¥–µ–∫—Å–∏ Tcache**: –ú–æ–∂–ª–∏–≤–æ –≤–∏–¥—ñ–ª–∏—Ç–∏ —Ç–∞ –≤–∏–≤—ñ–ª—å–Ω–∏—Ç–∏ —á–∞–Ω–∫ —Ä–æ–∑–º—ñ—Ä—É, —è–∫–∏–π, –∫–æ–ª–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ tcache —á–∞–Ω–∫—É (—á–∞–Ω–∫—É –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –±—ñ–Ω–∏ tcache), –∑–≥–µ–Ω–µ—Ä—É—î **–∞–¥—Ä–µ—Å—É –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º 0x100**. –¶–µ —Ç–æ–º—É, —â–æ tcache –∑–±–µ—Ä—ñ–≥–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —á–∞–Ω–∫—ñ–≤ —É –∫–æ–∂–Ω–æ–º—É –±—ñ–Ω—ñ —É —Ä—ñ–∑–Ω–∏—Ö –±–∞–π—Ç–∞—Ö, —Ç–æ–º—É –æ–¥–∏–Ω —á–∞–Ω–∫ —É –æ–¥–Ω–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —ñ–Ω–¥–µ–∫—Å—ñ –≥–µ–Ω–µ—Ä—É—î –∑–Ω–∞—á–µ–Ω–Ω—è 0x100.
* –ü–æ—Ç—ñ–º —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫, –Ω—ñ–±–∏ —î —á–∞–Ω–∫ —Ä–æ–∑–º—ñ—Ä—É 0x100. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º, `–≤–∏–≤—ñ–ª—å–Ω–∏–≤—à–∏` —Ü—é –∞–¥—Ä–µ—Å—É. –¶–µ –¥–æ–¥–∞—Å—Ç—å —Ü—é –∞–¥—Ä–µ—Å—É –¥–æ —ñ–Ω–¥–µ–∫—Å—É —á–∞–Ω–∫—ñ–≤ —Ä–æ–∑–º—ñ—Ä–æ–º 0x100 –≤ tcache.
* –ü–æ—Ç—ñ–º, **–≤–∏–¥—ñ–ª–∏–≤—à–∏** —á–∞–Ω–∫ —Ä–æ–∑–º—ñ—Ä–æ–º **0x100**, –ø–æ–ø–µ—Ä–µ–¥–Ω—è –∞–¥—Ä–µ—Å–∞ –±—É–¥–µ –ø–æ–≤–µ—Ä–Ω–µ–Ω–∞ —è–∫ —á–∞–Ω–∫, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —ñ–Ω—à—ñ —ñ–Ω–¥–µ–∫—Å–∏ tcache.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—Å—Ç–∞–≤–ª—è—é—á–∏ –∞–¥—Ä–µ—Å—É malloc hook –≤ –æ–¥–∏–Ω –∑ –Ω–∏—Ö —Ç–∞ –≤–∏–¥—ñ–ª—è—é—á–∏ —á–∞–Ω–∫ —Ä–æ–∑–º—ñ—Ä—É —Ü—å–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É, –¥–æ–∑–≤–æ–ª–∏—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ —á–∞–Ω–∫ —É calloc hook, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–ø–∏—Å–∞—Ç–∏ one gadget –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –æ–±–æ–ª–æ–Ω–∫–∏.
* CTF [https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps1/index.html](https://guyinatuxedo.github.io/44-more\_tcache/csaw19\_popping\_caps1/index.html)
* –¢–∞ –∂ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, —â–æ –π —Ä–∞–Ω—ñ—à–µ –∑ –æ–¥–Ω–∏–º –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º –æ–±–º–µ–∂–µ–Ω–Ω—è–º
* **–ê—Ç–∞–∫–∏ –Ω–∞ —ñ–Ω–¥–µ–∫—Å–∏ Tcache**: –°—Ö–æ–∂–∞ –∞—Ç–∞–∫–∞ –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—é, –∞–ª–µ –∑ –º–µ–Ω—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∫—Ä–æ–∫—ñ–≤, **–≤–∏–≤—ñ–ª—å–Ω–∏–≤—à–∏ —á–∞–Ω–∫, —â–æ –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ tcache**, —Ç–æ–º—É –π–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ —ñ–Ω–¥–µ–∫—Å—É tcache –π–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É, —Ç–æ–º—É –º–æ–∂–ª–∏–≤–æ –≤–∏–¥—ñ–ª–∏—Ç–∏ —Ü–µ–π —Ä–æ–∑–º—ñ—Ä —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —á–∞–Ω–∫ tcache —è–∫ —á–∞–Ω–∫, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∏ free hook —è–∫ –∞–¥—Ä–µ—Å—É –æ–¥–Ω–æ–≥–æ —ñ–Ω–¥–µ–∫—Å—É, –≤–∏–¥—ñ–ª–∏—Ç–∏ –π–æ–≥–æ —Ç–∞ –Ω–∞–ø–∏—Å–∞—Ç–∏ one gadget –Ω–∞ –Ω—å–æ–º—É.
* [**Math Door. HTB Cyber Apocalypse CTF 2023**](https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse/math-door/)
* **–ó–∞–ø–∏—Å –ø—ñ—Å–ª—è –≤–∏–≤—ñ–ª—å–Ω–µ–Ω–Ω—è**, —â–æ–± –¥–æ–¥–∞—Ç–∏ —á–∏—Å–ª–æ –¥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ `fd`.
* –î–ª—è —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ –±–∞–≥–∞—Ç–æ **heap feng-shui**. –£ –æ–ø–∏—Å—ñ –ø–æ–∫–∞–∑–∞–Ω–æ, —è–∫ **–∫–µ—Ä—É–≤–∞–Ω–Ω—è –≥–æ–ª–æ–≤–æ—é —Å–ø–∏—Å–∫—É –≤—ñ–ª—å–Ω–∏—Ö —á–∞–Ω–∫—ñ–≤ Tcache** –¥–æ—Å–∏—Ç—å –∑—Ä—É—á–Ω–æ.
* **–í–∏—Ç—ñ–∫ Glibc** —á–µ—Ä–µ–∑ `stdout` (FSOP).
* **–ó–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è Tcache** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–∏–º—ñ—Ç–∏–≤—É –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É.
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.**
