# Sobrescribiendo un fragmento liberado

{% hint style="success" %}
Aprende y practica Hacking en AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ayuda a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

Varias de las t칠cnicas de explotaci칩n de mont칩n propuestas necesitan poder sobrescribir punteros dentro de fragmentos liberados. El objetivo de esta p치gina es resumir las posibles vulnerabilidades que podr칤an otorgar este acceso:

### Uso Simple Despu칠s de Liberar

Si es posible para el atacante **escribir informaci칩n en un fragmento liberado**, podr칤an abusar de esto para sobrescribir los punteros necesarios.

### Doble Liberaci칩n

Si el atacante puede **`liberar` dos veces el mismo fragmento** (liberar otros fragmentos entre ellos potencialmente) y lograr que est칠 **2 veces en el mismo bin**, ser칤a posible para el usuario **asignar el fragmento m치s tarde**, **escribir los punteros necesarios** y luego **asignarlo nuevamente** desencadenando las acciones de asignaci칩n del fragmento (por ejemplo, ataque de fast bin, ataque de tcache...)

### Desbordamiento de Mont칩n

Podr칤a ser posible **desbordar un fragmento asignado teniendo al lado un fragmento liberado** y modificar algunos encabezados/punteros de este.

### Desbordamiento por uno

En este caso ser칤a posible **modificar el tama침o** del fragmento siguiente en memoria. Un atacante podr칤a abusar de esto para **hacer que un fragmento asignado tenga un tama침o mayor**, luego **`liberarlo`**, haciendo que el fragmento sea **agregado a un bin de un tama침o diferente** (mayor), luego asignar el **tama침o falso**, y el ataque tendr치 acceso a un **fragmento con un tama침o que es mayor** de lo que realmente es, **concediendo as칤 una situaci칩n de fragmentos superpuestos**, que es explotable de la misma manera que un **desbordamiento de mont칩n** (ver secci칩n anterior).

{% hint style="success" %}
Aprende y practica Hacking en AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ayuda a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
