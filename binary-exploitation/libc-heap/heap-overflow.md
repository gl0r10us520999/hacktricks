# Heap Overflow

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Heap overflow ‡§è‡§ï [**stack overflow**](../stack-overflow/) ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® heap ‡§Æ‡•á‡§Ç‡•§ ‡§Æ‡•Ç‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø heap ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§õ ‡§∏‡•ç‡§•‡§æ‡§® ‡§Ü‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ ‡§î‡§∞ **‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§Ü‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§•‡§æ‡•§**

Stack overflows ‡§Æ‡•á‡§Ç ‡§π‡§Æ ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§á‡§Ç‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§® ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§Ø‡§æ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§´‡•ç‡§∞‡•á‡§Æ ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡•á ‡§™‡•Å‡§®‡§∞‡•ç‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§î‡§∞ ‡§á‡§∏‡•á ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ Heap overflows ‡§ï‡•á ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç, **‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡•Ä ‡§ó‡§à ‡§ï‡•ã‡§à ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä** ‡§ú‡•ã overflow ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§ ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø, ‡§Ø‡§π ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡§æ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏ ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡•Ä **‡§ó‡§Ç‡§≠‡•Ä‡§∞‡§§‡§æ** **‡§á‡§∏ ‡§™‡§∞ ‡§®‡§ø‡§∞‡•ç‡§≠‡§∞ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‡§ï‡§ø** **‡§ï‡•å‡§® ‡§∏‡§æ ‡§°‡•á‡§ü‡§æ ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à** ‡§î‡§∞ ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§á‡§∏‡•á ‡§ï‡•à‡§∏‡•á ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

{% hint style="success" %}
Overflow offsets ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ [**stack overflows**](../stack-overflow/#finding-stack-overflows-offsets) ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§æ‡§® ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
{% endhint %}

### Stack Overflows vs Heap Overflows

Stack overflows ‡§Æ‡•á‡§Ç ‡§â‡§∏ ‡§∏‡§Æ‡§Ø ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§°‡•á‡§ü‡§æ ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ ‡§ú‡§¨ ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡•ã ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§ï‡§æ‡§´‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡§æ ‡§ï‡§æ‡§∞‡§£ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∞‡•à‡§ñ‡§ø‡§ï ‡§π‡•à, ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ü‡§ï‡§∞‡§æ‡§§‡•á ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§¨‡§¢‡§º‡§§‡§æ ‡§π‡•à, **‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•á ‡§ö‡§≤‡§®‡•á ‡§ï‡•á ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§∏‡•ç‡§•‡§æ‡§®‡•ã‡§Ç ‡§™‡§∞ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§∏‡§Æ‡§æ‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à** ‡§î‡§∞ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∏‡•ç‡§ü‡•à‡§ï ‡§≠‡§æ‡§ó ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•Å‡§õ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§

‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, heap overflow ‡§ï‡•á ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç, ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ó‡§à ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∞‡•à‡§ñ‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® **‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡•á ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∏‡•ç‡§•‡§æ‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç** (‡§è‡§ï ‡§ï‡•á ‡§¨‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç) ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **‡§Ü‡§ï‡§æ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ü‡§µ‡§Ç‡§ü‡§® ‡§ï‡•ã ‡§Ö‡§≤‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§ø‡§® ‡§î‡§∞ ‡§ú‡§º‡•ã‡§®** ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **‡§™‡§ø‡§õ‡§≤‡•Ä ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à** ‡§®‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§ï‡•ã ‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á‡•§ ‡§Ø‡§π **‡§ú‡§æ‡§®‡§®‡§æ ‡§ú‡§ü‡§ø‡§≤ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•å‡§® ‡§∏‡§æ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§â‡§∏ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ü‡§ï‡§∞‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§π‡•à** ‡§ú‡•ã heap overflow ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§ú‡§¨ ‡§è‡§ï heap overflow ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à ‡§ï‡§ø **‡§µ‡§æ‡§Ç‡§õ‡§ø‡§§ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§Ö‡§ó‡§≤‡•á ‡§∏‡•ç‡§•‡§æ‡§® ‡§™‡§∞ ‡§≤‡§æ‡§®‡•á ‡§ï‡§æ ‡§è‡§ï ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ‡§è** ‡§ú‡•ã ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏‡§ï‡§æ ‡§è‡§ï ‡§§‡§ï‡§®‡•Ä‡§ï **Heap Grooming** ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è [**‡§á‡§∏ ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç**](https://azeria-labs.com/grooming-the-ios-kernel-heap/) ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§ï‡§ø ‡§ú‡§¨ iOS ‡§ï‡§∞‡•ç‡§®‡•á‡§≤ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§ú‡§º‡•ã‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ñ‡§§‡•ç‡§Æ ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§á‡§∏‡•á ‡§è‡§ï ‡§ï‡§∞‡•ç‡§®‡•á‡§≤ ‡§™‡•É‡§∑‡•ç‡§† ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¨‡§¢‡§º‡§æ‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ø‡§π ‡§™‡•É‡§∑‡•ç‡§† ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§æ‡§ú‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ï‡•ç‡§∞‡§Æ ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á (iOS ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 9.2 ‡§§‡§ï, ‡§´‡§ø‡§∞ ‡§Ø‡•á ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§á‡§® ‡§π‡§Æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•ã ‡§ï‡§†‡§ø‡§® ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§æ‡§¶‡•É‡§ö‡•ç‡§õ‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç)‡•§

‡§á‡§∏‡§≤‡§ø‡§è, ‡§™‡§ø‡§õ‡§≤‡•á ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§ú‡§π‡§æ‡§Ç heap overflow ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à, ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã ‡§è‡§ï ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ü‡§ï‡§∞‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§ú‡§¨‡•Ç‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§ï‡§à **`kallocs` ‡§ï‡•ã ‡§ï‡§à ‡§•‡•ç‡§∞‡•á‡§°‡•ç‡§∏ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Æ‡§ú‡§¨‡•Ç‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§ï‡§ø ‡§∏‡§≠‡•Ä ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§≠‡§∞‡•á ‡§π‡•Å‡§è ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§™‡•É‡§∑‡•ç‡§† ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à**‡•§

‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§∏‡§æ‡§• ‡§á‡§∏ ‡§≠‡§∞‡§®‡•á ‡§ï‡•ã ‡§Æ‡§ú‡§¨‡•Ç‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, **iOS mach ‡§™‡•ã‡§∞‡•ç‡§ü ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§Ü‡§â‡§ü-‡§ë‡§´-‡§≤‡§æ‡§á‡§® ‡§Ü‡§µ‡§Ç‡§ü‡§®** ‡§è‡§ï ‡§Ü‡§¶‡§∞‡•ç‡§∂ ‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶‡§µ‡§æ‡§∞ ‡§π‡•à‡•§ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•ã ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§ï‡•á, `kalloc` ‡§Ü‡§µ‡§Ç‡§ü‡§® ‡§ï‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•ã ‡§∏‡§ü‡•Ä‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§î‡§∞ ‡§ú‡§¨ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ mach ‡§™‡•ã‡§∞‡•ç‡§ü ‡§®‡§∑‡•ç‡§ü ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§Ü‡§µ‡§Ç‡§ü‡§® ‡§§‡•Å‡§∞‡§Ç‡§§ `kfree` ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§∞‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§

‡§´‡§ø‡§∞, ‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•Å‡§õ ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞‡•ç‡§∏ ‡§ï‡•ã **‡§Æ‡•Å‡§ï‡•ç‡§§** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ **`kalloc.4096` ‡§´‡•ç‡§∞‡•Ä ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§§‡§§‡•ç‡§µ‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§Æ‡•á‡§Ç ‡§™‡§π‡§≤‡•á ‡§¨‡§æ‡§π‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§ï‡•ç‡§∞‡§Æ ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§∞‡•Ä ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à**, ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡•Ç‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§¶‡§ø ‡§ï‡•Å‡§õ ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§Æ‡•Å‡§ï‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§à ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§¨‡§ï‡§ø ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã ‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§π ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§è‡§ï ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§®‡•Å‡§∏‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§

### Example libc

[**‡§á‡§∏ ‡§™‡•É‡§∑‡•ç‡§† ‡§Æ‡•á‡§Ç**](https://guyinatuxedo.github.io/27-edit\_free\_chunk/heap\_consolidation\_explanation/index.html) ‡§è‡§ï ‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä Heap overflow ‡§Ö‡§®‡•Å‡§ï‡§∞‡§£ ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§ï‡•á ‡§™‡•Ç‡§∞‡•ç‡§µ ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§¨‡§ø‡§ü ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§µ ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§ï‡•á **‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§ï‡•ã ‡§∏‡§Æ‡•á‡§ï‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ** (‡§á‡§∏‡•á ‡§Ö‡§®‡§Ø‡•Ç‡§ú‡•ç‡§° ‡§∏‡§Æ‡§ù‡§æ‡§®‡§æ) ‡§î‡§∞ **‡§´‡§ø‡§∞ ‡§∏‡•á ‡§á‡§∏‡•á ‡§Ü‡§µ‡§Ç‡§ü‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ** ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ø‡§π ‡§°‡•á‡§ü‡§æ ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§ú‡•ã ‡§è‡§ï ‡§Ö‡§≤‡§ó ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§

[**protostar heap 0**](https://guyinatuxedo.github.io/24-heap\_overflow/protostar\_heap0/index.html) ‡§∏‡•á ‡§è‡§ï ‡§î‡§∞ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§è‡§ï ‡§¨‡§π‡•Å‡§§ ‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä CTF ‡§ï‡§æ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡§ø‡§ñ‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡§π‡§æ‡§Ç ‡§è‡§ï **heap overflow** ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§µ‡§ø‡§ú‡•á‡§§‡§æ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø **‡§´‡•ç‡§≤‡•à‡§ó ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á**‡•§

[**protostar heap 1**](https://guyinatuxedo.github.io/24-heap\_overflow/protostar\_heap1/index.html) ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§¶‡•á‡§ñ‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï ‡§¨‡§´‡§∞ ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á **‡§è‡§ï ‡§®‡§ø‡§ï‡§ü‡§§‡§Æ ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§™‡§§‡§æ ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§®‡§æ** ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡§π‡§æ‡§Ç **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡•á ‡§Æ‡§®‡§Æ‡§æ‡§®‡§æ ‡§°‡•á‡§ü‡§æ** ‡§≤‡§ø‡§ñ‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§

### Example ARM64

‡§™‡•É‡§∑‡•ç‡§† [https://8ksec.io/arm64-reversing-and-exploitation-part-1-arm-instruction-set-simple-heap-overflow/](https://8ksec.io/arm64-reversing-and-exploitation-part-1-arm-instruction-set-simple-heap-overflow/) ‡§Æ‡•á‡§Ç ‡§Ü‡§™ ‡§è‡§ï heap overflow ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§è‡§ï ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ú‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§π‡•à, ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§∏‡•á ‡§Ö‡§ó‡§≤‡•á ‡§ü‡•Å‡§ï‡§°‡§º‡•á ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§á‡§∏‡•á ‡§è‡§ï ‡§Ü‡§∏‡§æ‡§® ‡§∂‡•ã‡§∑‡§£ ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
python3 -c 'print("/"*0x400+"/bin/ls\x00")' > hax.txt
```
### Other examples

* [**Auth-or-out. Hack The Box**](https://7rocky.github.io/en/ctf/htb-challenges/pwn/auth-or-out/)
* ‡§π‡§Æ ‡§è‡§ï Integer Overflow vulnerability ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§è‡§ï Heap Overflow ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç‡•§
* ‡§π‡§Æ overflowed chunk ‡§ï‡•á `struct` ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§è‡§ï function ‡§ï‡•á pointers ‡§ï‡•ã corrupt ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø `system` ‡§ú‡•à‡§∏‡•á function ‡§ï‡•ã ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç ‡§î‡§∞ code execution ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç‡•§

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
