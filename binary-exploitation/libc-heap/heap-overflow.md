# Heap Overflow

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

ÎœÎ¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ‰ÏÎ¿Ï ÎµÎ¯Î½Î±Î¹ ÏŒÏ€Ï‰Ï‚ Î¼Î¹Î± [**Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ„Î¿Î¯Î²Î±Ï‚**](../stack-overflow/) Î±Î»Î»Î¬ ÏƒÏ„Î¿Î½ ÏƒÏ‰ÏÏŒ. Î’Î±ÏƒÎ¹ÎºÎ¬ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÎºÎ¬Ï€Î¿Î¹Î¿Ï‚ Ï‡ÏÏÎ¿Ï‚ ÎµÎ¯Ï‡Îµ ÎºÏÎ±Ï„Î·Î¸ÎµÎ¯ ÏƒÏ„Î¿Î½ ÏƒÏ‰ÏÏŒ Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ **Ï„Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î®Ï„Î±Î½ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ± Î±Ï€ÏŒ Ï„Î¿Î½ ÎºÏÎ±Ï„Î·Î¼Î­Î½Î¿ Ï‡ÏÏÎ¿.**

Î£Ï„Î¹Ï‚ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ ÏŒÏ„Î¹ Î¼ÎµÏÎ¹ÎºÎ¿Î¯ ÎºÎ±Ï„Î±Ï‡Ï‰ÏÎ·Ï„Î­Ï‚ ÏŒÏ€Ï‰Ï‚ Î¿ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ ÎµÎ½Ï„Î¿Î»ÏÎ½ Î® Ï„Î¿ Ï€Î»Î±Î¯ÏƒÎ¹Î¿ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ Î¸Î± Î±Ï€Î¿ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸Î¿ÏÎ½ Î±Ï€ÏŒ Ï„Î· ÏƒÏ„Î¿Î¯Î²Î± ÎºÎ±Î¹ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î³Î¯Î½ÎµÎ¹ ÎºÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· Î±Ï…Ï„Î¿Ï. Î£Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Ï„Ï‰Î½ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎµÏ‰Î½ ÏƒÏ‰ÏÎ¿Ï, **Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î· Î±Ï€ÏŒ Ï€ÏÎ¿ÎµÏ€Î¹Î»Î¿Î³Î®** ÏƒÏ„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï„Î¿Ï… ÏƒÏ‰ÏÎ¿Ï Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€ÎµÏÏ‡Ï…Î¸ÎµÎ¯. Î©ÏƒÏ„ÏŒÏƒÎ¿, Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Î· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Î® Î´ÎµÎ¯ÎºÏ„ÎµÏ‚, Î¿Ï€ÏŒÏ„Îµ Î· **ÎºÏÎ¹Ï„Î¹ÎºÎ® ÏƒÎ·Î¼Î±ÏƒÎ¯Î±** Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ **ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹** Î±Ï€ÏŒ **Ï€Î¿Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸Î¿ÏÎ½** ÎºÎ±Î¹ Ï€ÏÏ‚ Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎµ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î±Ï…Ï„ÏŒ.

{% hint style="success" %}
Î“Î¹Î± Î½Î± Î²ÏÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î± Î¯Î´Î¹Î± Î¼Î¿Ï„Î¯Î²Î± ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¹Ï‚ [**Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚**](../stack-overflow/#finding-stack-overflows-offsets).
{% endhint %}

### Stack Overflows vs Heap Overflows

Î£Ï„Î¹Ï‚ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ Î· Î´Î¹Î¬Ï„Î±Î¾Î· ÎºÎ±Î¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÏŒÎ½Ï„Î± ÏƒÏ„Î· ÏƒÏ„Î¿Î¯Î²Î± Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î· ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± ÎµÎ¯Î½Î±Î¹ Î±ÏÎºÎµÏ„Î¬ Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î±. Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® Î· ÏƒÏ„Î¿Î¯Î²Î± ÎµÎ¯Î½Î±Î¹ Î³ÏÎ±Î¼Î¼Î¹ÎºÎ®, Ï€Î¬Î½Ï„Î± Î±Ï…Î¾Î±Î½ÏŒÎ¼ÎµÎ½Î· ÏƒÎµ ÏƒÏ…Î³ÎºÏÎ¿Ï…ÏŒÎ¼ÎµÎ½Î· Î¼Î½Î®Î¼Î·, ÏƒÎµ **ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚ Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚ Î· Î¼Î½Î®Î¼Î· ÏƒÏ„Î¿Î¯Î²Î±Ï‚ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î¿ ÎµÎ¯Î´Î¿Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½** ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î· Î´Î¿Î¼Î® Î¼Îµ ÎºÎ¬Ï€Î¿Î¹Î¿Ï…Ï‚ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Î¿Ï… Î¼Î­ÏÎ¿Ï…Ï‚ Ï„Î·Ï‚ ÏƒÏ„Î¿Î¯Î²Î±Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ·.

Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏƒÏ„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î¼Î¹Î±Ï‚ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ·Ï‚ ÏƒÏ‰ÏÎ¿Ï, Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î· Î¼Î½Î®Î¼Î· Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î³ÏÎ±Î¼Î¼Î¹ÎºÎ® Î±Î»Î»Î¬ **Î¿Î¹ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·Î¼Î­Î½Î¿Î¹ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Î¹ ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÎµ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ Î¸Î­ÏƒÎµÎ¹Ï‚ Î¼Î½Î®Î¼Î·Ï‚** (ÏŒÏ‡Î¹ Î¿ Î­Î½Î±Ï‚ Î´Î¯Ï€Î»Î± ÏƒÏ„Î¿Î½ Î¬Î»Î»Î¿) Î»ÏŒÎ³Ï‰ Ï„Ï‰Î½ **Î´Î¿Ï‡ÎµÎ¯Ï‰Î½ ÎºÎ±Î¹ Î¶Ï‰Î½ÏÎ½** Ï€Î¿Ï… Î´Î¹Î±Ï‡Ï‰ÏÎ¯Î¶Î¿Ï…Î½ Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î½Î¿Î¼Î­Ï‚ ÎºÎ±Ï„Î¬ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ ÎºÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® **Î· Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ»ÎµÏÎ¸ÎµÏÎ· Î¼Î½Î®Î¼Î· Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹** Ï€ÏÎ¹Î½ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Î½Î­Ï‰Î½ Î¸ÏÏŒÎ¹ÏƒÎºÏ‰Î½. Î•Î¯Î½Î±Î¹ **Ï€ÎµÏÎ¯Ï€Î»Î¿ÎºÎ¿ Î½Î± Î³Î½Ï‰ÏÎ¯Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… Î¸Î± ÏƒÏ…Î³ÎºÏÎ¿ÏÎµÏ„Î±Î¹ Î¼Îµ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿** ÏƒÎµ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ‰ÏÎ¿Ï. ÎˆÏ„ÏƒÎ¹, ÏŒÏ„Î±Î½ Î²ÏÎµÎ¸ÎµÎ¯ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ‰ÏÎ¿Ï, ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î½Î± Î²ÏÎµÎ¸ÎµÎ¯ Î­Î½Î±Ï‚ **Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î¿Ï‚ Ï„ÏÏŒÏ€Î¿Ï‚ Î³Î¹Î± Î½Î± Î³Î¯Î½ÎµÎ¹ Ï„Î¿ ÎµÏ€Î¹Î¸Ï…Î¼Î·Ï„ÏŒ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÏƒÏ„Î· Î¼Î½Î®Î¼Î·** Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï…Ï€ÎµÏÏ‡Ï…Î¸ÎµÎ¯.

ÎœÎ¯Î± Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î³Î¹Î± Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ **Heap Grooming** Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± [**ÏƒÎµ Î±Ï…Ï„Î®Î½ Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ·**](https://azeria-labs.com/grooming-the-ios-kernel-heap/). Î£Ï„Î·Î½ Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¾Î·Î³ÎµÎ¯Ï„Î±Î¹ Ï€ÏÏ‚ ÏŒÏ„Î±Î½ ÏƒÏ„Î¿Î½ Ï€Ï…ÏÎ®Î½Î± iOS ÏŒÏ„Î±Î½ Î¼Î¹Î± Î¶ÏÎ½Î· ÎµÎ¾Î±Î½Ï„Î»ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÏŒ Î¼Î½Î®Î¼Î· Î³Î¹Î± Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Ï…Ï‚ Î¼Î½Î®Î¼Î·Ï‚, Ï„Î·Î½ ÎµÏ€ÎµÎºÏ„ÎµÎ¯Î½ÎµÎ¹ ÎºÎ±Ï„Î¬ Î¼Î¹Î± ÏƒÎµÎ»Î¯Î´Î± Ï€Ï…ÏÎ®Î½Î±, ÎºÎ±Î¹ Î±Ï…Ï„Î® Î· ÏƒÎµÎ»Î¯Î´Î± Ï‡Ï‰ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÎµ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Ï…Ï‚ Ï„Ï‰Î½ Î±Î½Î±Î¼ÎµÎ½ÏŒÎ¼ÎµÎ½Ï‰Î½ Î¼ÎµÎ³ÎµÎ¸ÏÎ½ Ï€Î¿Ï… Î¸Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î¼Îµ ÏƒÎµÎ¹ÏÎ¬ (Î¼Î­Ï‡ÏÎ¹ Ï„Î·Î½ Î­ÎºÎ´Î¿ÏƒÎ· iOS 9.2, Ï„ÏŒÏ„Îµ Î±Ï…Ï„Î¿Î¯ Î¿Î¹ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î¼Îµ Ï„Ï…Ï‡Î±Î¯Î¿ Ï„ÏÏŒÏ€Î¿ Î³Î¹Î± Î½Î± Î´Ï…ÏƒÎºÎ¿Î»Î­ÏˆÎ¿Ï…Î½ Ï„Î·Î½ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ ÎµÏ€Î¹Î¸Î­ÏƒÎµÏ‰Î½).

Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, ÏƒÏ„Î·Î½ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î· Î±Î½Î¬ÏÏ„Î·ÏƒÎ· ÏŒÏ€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ‰ÏÎ¿Ï, Ï€ÏÎ¿ÎºÎµÎ¹Î¼Î­Î½Î¿Ï… Î½Î± Î±Î½Î±Î³ÎºÎ±ÏƒÏ„ÎµÎ¯ Ï„Î¿ Ï…Ï€ÎµÏÏ‡Ï…Î¸Î­Î½ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î½Î± ÏƒÏ…Î³ÎºÏÎ¿ÏÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Î¸Ï…Î¼Î±Ï„Î¹ÎºÎ® ÏƒÎµÎ¹ÏÎ¬, Î±ÏÎºÎµÏ„Î­Ï‚ **`kallocs` Î±Î½Î±Î³ÎºÎ¬Î¶Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Î±ÏÎºÎµÏ„Î­Ï‚ Î½Î®Î¼Î±Ï„Î± Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎ¿Ï…Î½ Î½Î± Î´Î¹Î±ÏƒÏ†Î±Î»Î¯ÏƒÎ¿Ï…Î½ ÏŒÏ„Î¹ ÏŒÎ»Î¿Î¹ Î¿Î¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿Î¹ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Î¹ ÎµÎ¯Î½Î±Î¹ Î³ÎµÎ¼Î¬Ï„Î¿Î¹ ÎºÎ±Î¹ ÏŒÏ„Î¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Î±Î¹ Î¼Î¹Î± Î½Î­Î± ÏƒÎµÎ»Î¯Î´Î±**.

Î“Î¹Î± Î½Î± Î±Î½Î±Î³ÎºÎ±ÏƒÏ„ÎµÎ¯ Î±Ï…Ï„Î® Î· Î³Î­Î¼Î¹ÏƒÎ· Î¼Îµ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿Ï… Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚, Î· **ÎµÎºÏ„ÏŒÏ‚ Î³ÏÎ±Î¼Î¼Î®Ï‚ ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Î¼Î¹Î± Î¸ÏÏÎ± mach iOS** ÎµÎ¯Î½Î±Î¹ Î­Î½Î±Ï‚ Î¹Î´Î±Î½Î¹ÎºÏŒÏ‚ Ï…Ï€Î¿ÏˆÎ®Ï†Î¹Î¿Ï‚. Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÏÎ½Ï„Î±Ï‚ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î¿Ï… Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± ÎºÎ±Î¸Î¿ÏÎ¹ÏƒÏ„ÎµÎ¯ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¿ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Ï„Î·Ï‚ ÎºÎ±Ï„Î±Î½Î¿Î¼Î®Ï‚ `kalloc` ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Î· Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· Î¸ÏÏÎ± mach ÎºÎ±Ï„Î±ÏƒÏ„ÏÎ±Ï†ÎµÎ¯, Î· Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î· ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Î¸Î± Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏ‰Î¸ÎµÎ¯ Î±Î¼Î­ÏƒÏ‰Ï‚ Ï€Î¯ÏƒÏ‰ ÏƒÏ„Î¿ `kfree`.

Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î¼ÎµÏÎ¹ÎºÎ¿Î¯ Î±Ï€ÏŒ Î±Ï…Ï„Î¿ÏÏ‚ Ï„Î¿Ï…Ï‚ Ï‡ÏÏÎ¿Ï…Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ **ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿Î¹**. Î— **Î»Î¯ÏƒÏ„Î± ÎµÎ»ÎµÏÎ¸ÎµÏÏ‰Î½ `kalloc.4096` Î±Ï€ÎµÎ»ÎµÏ…Î¸ÎµÏÏÎ½ÎµÎ¹ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Î¼Îµ ÏƒÎµÎ¹ÏÎ¬ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… ÎµÎ¹ÏƒÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î¿Ï… Ï€ÏÏÏ„Î¿Ï… ÎµÎ¾ÎµÏÏ‡ÏŒÎ¼ÎµÎ½Î¿Ï…**, Ï€Î¿Ï… ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î²Î±ÏƒÎ¹ÎºÎ¬ ÏŒÏ„Î¹ Î±Î½ Î¼ÎµÏÎ¹ÎºÎ¿Î¯ Ï‡ÏÏÎ¿Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÎ»ÎµÏÎ¸ÎµÏÎ¿Î¹ ÎºÎ±Î¹ Î· ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Î½ÎµÎ¼Î®ÏƒÎµÎ¹ Î±ÏÎºÎµÏ„Î¬ Î¸Ï…Î¼Î±Ï„Î¹ÎºÎ¬ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î± ÎµÎ½Ï Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Î½ÎµÎ¼Î®ÏƒÎµÎ¹ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ ÏƒÎµ Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ·, ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏŒ ÏŒÏ„Î¹ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î¸Î± Î±ÎºÎ¿Î»Î¿Ï…Î¸Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Î­Î½Î± Î¸Ï…Î¼Î±Ï„Î¹ÎºÏŒ Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿.

### Example libc

[**Î£Îµ Î±Ï…Ï„Î® Ï„Î· ÏƒÎµÎ»Î¯Î´Î±**](https://guyinatuxedo.github.io/27-edit\_free\_chunk/heap\_consolidation\_explanation/index.html) ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î¼Î¹Î± Î²Î±ÏƒÎ¹ÎºÎ® Ï€ÏÎ¿ÏƒÎ¿Î¼Î¿Î¯Ï‰ÏƒÎ· Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ·Ï‚ ÏƒÏ‰ÏÎ¿Ï Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏÏ‚ Î· Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï… bit Ï‡ÏÎ®ÏƒÎ·Ï‚ Ï„Î¿Ï… ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿Ï… Î¸ÏÏŒÎ¹ÏƒÎºÎ¿Ï… ÎºÎ±Î¹ Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿Ï… Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚ ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± **ÏƒÏ…Î³ÎºÎµÎ½Ï„ÏÏÏƒÎ¿Ï…Î½ Î­Î½Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼ÎµÎ½Î¿ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿** (ÎºÎ¬Î½Î¿Î½Ï„Î¬Ï‚ Ï„Î¿Î½ Î½Î± Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ ÎµÎ¯Î½Î±Î¹ Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·Ï„Î¿Ï‚) ÎºÎ±Î¹ **ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± Î½Î± Ï„Î¿Î½ ÎºÎ±Ï„Î±Î½ÎµÎ¼Î®ÏƒÎ¿Ï…Î½ Î¾Î±Î½Î¬** Î­Ï‡Î¿Î½Ï„Î±Ï‚ Ï„Î· Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Î´ÎµÎ¯ÎºÏ„Î· ÎµÏ€Î¯ÏƒÎ·Ï‚.

ÎˆÎ½Î± Î¬Î»Î»Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î±Ï€ÏŒ [**protostar heap 0**](https://guyinatuxedo.github.io/24-heap\_overflow/protostar\_heap0/index.html) Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î­Î½Î± Ï€Î¿Î»Ï Î²Î±ÏƒÎ¹ÎºÏŒ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÎ½ÏŒÏ‚ CTF ÏŒÏ€Î¿Ï… Î¼Î¹Î± **Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· ÏƒÏ‰ÏÎ¿Ï** Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„ÎµÎ¯ Î³Î¹Î± Î½Î± ÎºÎ±Î»Î­ÏƒÎµÎ¹ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î½Î¹ÎºÎ·Ï„Î® Î³Î¹Î± Î½Î± **Ï€Î¬ÏÎµÏ„Îµ Ï„Î· ÏƒÎ·Î¼Î±Î¯Î±**.

Î£Ï„Î¿ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± [**protostar heap 1**](https://guyinatuxedo.github.io/24-heap\_overflow/protostar\_heap1/index.html) ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€ÏÏ‚ ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Î¹ Î¼Î¹Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ· buffer ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± **Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ ÏƒÎµ Î­Î½Î±Î½ ÎºÎ¿Î½Ï„Î¹Î½ÏŒ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·** ÏŒÏ€Î¿Ï… **Ï„Ï…Ï‡Î±Î¯Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·** Î¸Î± Î³ÏÎ±Ï†Î¿ÏÎ½.

### Example ARM64

Î£Ï„Î· ÏƒÎµÎ»Î¯Î´Î± [https://8ksec.io/arm64-reversing-and-exploitation-part-1-arm-instruction-set-simple-heap-overflow/](https://8ksec.io/arm64-reversing-and-exploitation-part-1-arm-instruction-set-simple-heap-overflow/) Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î²ÏÎµÎ¯Ï„Îµ Î­Î½Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Ï…Ï€ÎµÏÏ‡ÎµÎ¯Î»Î¹ÏƒÎ·Ï‚ ÏƒÏ‰ÏÎ¿Ï ÏŒÏ€Î¿Ï… Î¼Î¹Î± ÎµÎ½Ï„Î¿Î»Î® Ï€Î¿Ï… Ï€ÏÏŒÎºÎµÎ¹Ï„Î±Î¹ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î¸ÏÏŒÎ¹ÏƒÎºÎ¿ Î±Ï€ÏŒ Ï„Î¿Î½ Ï…Ï€ÎµÏÏ‡Ï…Î¸Î­Î½Ï„Î± Î¸ÏÏŒÎ¹ÏƒÎºÎ¿. ÎˆÏ„ÏƒÎ¹, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î·Î½ ÎµÎºÏ„ÎµÎ»Î¿ÏÎ¼ÎµÎ½Î· ÎµÎ½Ï„Î¿Î»Î® Î±Î½Ï„Î¹ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ Î¼Îµ Î¼Î¹Î± ÎµÏÎºÎ¿Î»Î· ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÏŒÏ€Ï‰Ï‚:
```bash
python3 -c 'print("/"*0x400+"/bin/ls\x00")' > hax.txt
```
### Î†Î»Î»Î± Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î±

* [**Auth-or-out. Hack The Box**](https://7rocky.github.io/en/ctf/htb-challenges/pwn/auth-or-out/)
* Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Î¼Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î± Integer Overflow Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Heap Overflow.
* Î”Î¹Î±Ï†Î¸ÎµÎ¯ÏÎ¿Ï…Î¼Îµ Î´ÎµÎ¯ÎºÏ„ÎµÏ‚ ÏƒÎµ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î¼Î­ÏƒÎ± ÏƒÎµ Î¼Î¹Î± `struct` Ï„Î¿Ï… Ï…Ï€ÎµÏÏ‡ÎµÎ¹Î»Î¹ÏƒÎ¼Î­Î½Î¿Ï… ÎºÎ¿Î¼Î¼Î±Ï„Î¹Î¿Ï Î³Î¹Î± Î½Î± Î¿ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Î¼Î¹Î± ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `system` ÎºÎ±Î¹ Î½Î± Î±Ï€Î¿ÎºÏ„Î®ÏƒÎ¿Ï…Î¼Îµ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· ÎºÏÎ´Î¹ÎºÎ±.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
