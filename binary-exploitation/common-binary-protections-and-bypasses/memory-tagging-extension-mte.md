# Memory Tagging Extension (MTE)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

**Memory Tagging Extension (MTE)** рдХреЛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ **рдореЗрдореЛрд░реА рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рддреНрд░реБрдЯрд┐рдпреЛрдВ** рдХрд╛ **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд░реЛрдХрдиреЗ** рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж рдореБрдХреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдХрдордЬреЛрд░рд┐рдпрд╛рдБред MTE, **ARM** рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛, рдкреНрд░рддреНрдпреЗрдХ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЗ рд▓рд┐рдП рдПрдХ **рдЫреЛрдЯрд╛ рдЯреИрдЧ рд╕рдВрд▓рдЧреНрди рдХрд░рдиреЗ** рдФрд░ рдЙрд╕ рдореЗрдореЛрд░реА рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕рдВрдмрдВрдзрд┐рдд рдЯреИрдЧ** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд░рдирдЯрд╛рдЗрдо рдкрд░ рдЕрд╡реИрдз рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдРрд╕реЗ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рдордирдорд╛рдирд╛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдЬреЛрдЦрд┐рдо рдХрд╛рдлреА рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

### **How Memory Tagging Extension Works**

MTE **рдореЗрдореЛрд░реА рдХреЛ рдЫреЛрдЯреЗ, рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рдмреНрд▓реЙрдХреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдХреЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ рдХреЛ рдПрдХ рдЯреИрдЧ рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИ,** рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рдХреБрдЫ рдмрд┐рдЯреНрд╕ рдХрд╛ рдЖрдХрд╛рд░ рд╣реЛрддрд╛ рд╣реИред&#x20;

рдЬрдм рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдЙрд╕ рдореЗрдореЛрд░реА рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рд╡рд╣реА рдЯреИрдЧ рдорд┐рд▓рддрд╛ рд╣реИред рдпрд╣ рдЯреИрдЧ **рдореЗрдореЛрд░реА рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдЕрдкреНрд░рдпреБрдХреНрдд рдмрд┐рдЯреНрд╕ рдореЗрдВ** рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ, рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдЙрд╕рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (1202).png" alt=""><figcaption><p><a href="https://www.youtube.com/watch?v=UwMt0e_dC_Q">https://www.youtube.com/watch?v=UwMt0e_dC_Q</a></p></figcaption></figure>

рдЬрдм рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдореЗрдореЛрд░реА рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИ, рддреЛ MTE рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ **рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рдЯреИрдЧ рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рдХреЗ рдЯреИрдЧ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ**ред рдпрджрд┐ рдЯреИрдЧ **рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗ**, рддреЛ рдпрд╣ рдПрдХ **рдЕрд╡реИрдз рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред

### MTE Pointer Tags

рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдЯреИрдЧ 4 рдмрд┐рдЯреНрд╕ рдореЗрдВ рд╢реАрд░реНрд╖ рдмрд╛рдЗрдЯ рдХреЗ рдЕрдВрджрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ:

<figure><img src="../../.gitbook/assets/image (1203).png" alt=""><figcaption><p><a href="https://www.youtube.com/watch?v=UwMt0e_dC_Q">https://www.youtube.com/watch?v=UwMt0e_dC_Q</a></p></figcaption></figure>

рдЗрд╕рд▓рд┐рдП, рдпрд╣ **16 рд╡рд┐рднрд┐рдиреНрди рдЯреИрдЧ рдорд╛рдиреЛрдВ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### MTE Memory Tags

рд╣рд░ **16B рднреМрддрд┐рдХ рдореЗрдореЛрд░реА** рдХреЗ рдкрд╛рд╕ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд **рдореЗрдореЛрд░реА рдЯреИрдЧ** рд╣реЛрддрд╛ рд╣реИред

рдореЗрдореЛрд░реА рдЯреИрдЧ рдПрдХ **рд╡рд┐рд╢рд┐рд╖реНрдЯ RAM рдХреНрд╖реЗрддреНрд░** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ (рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рд╕реБрд▓рдн рдирд╣реАрдВ)ред рд╣рд░ 16B рдореЗрдореЛрд░реА рдЯреИрдЧ рдХреЗ рд▓рд┐рдП 4 рдмрд┐рдЯреНрд╕ рдЯреИрдЧ рд╣реЛрдиреЗ рд╕реЗ RAM рдХрд╛ 3% рддрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

ARM рдЗрди рдЯреИрдЧреНрд╕ рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ RAM рдореЗрдореЛрд░реА рдореЗрдВ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджреЗрд╢ рдкреЗрд╢ рдХрд░рддрд╛ рд╣реИ:
```
STG [<Xn/SP>], #<simm>    Store Allocation (memory) Tag
LDG <Xt>, [<Xn/SP>]       Load Allocatoin (memory) Tag
IRG <Xd/SP>, <Xn/SP>      Insert Random [pointer] Tag
...
```
## Checking Modes

### Sync

CPU **рдирд┐рд░реНрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рджреМрд░рд╛рди** рдЯреИрдЧ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдХреЛрдИ рдЕрд╕рдВрдЧрддрд┐ рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдЕрдкрд╡рд╛рдж рдЙрдард╛рддрд╛ рд╣реИред\
рдпрд╣ рд╕рдмрд╕реЗ рдзреАрдорд╛ рдФрд░ рд╕рдмрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред

### Async

CPU **рдЕрд╕рд┐рдВрдХреНрд░реЛрдирд╕рд▓реА** рдЯреИрдЧ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдХреЛрдИ рдЕрд╕рдВрдЧрддрд┐ рдкрд╛рдИ рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рд╕рд┐рд╕реНрдЯрдо рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдПрдХ рдЕрдкрд╡рд╛рдж рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рд╕реЗ **рддреЗрдЬрд╝** рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ **рд╕рдЯреАрдХ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрде** рд╣реИ рдЬреЛ рдЕрд╕рдВрдЧрддрд┐ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ рдФрд░ рдпрд╣ рддреБрд░рдВрдд рдЕрдкрд╡рд╛рдж рдирд╣реАрдВ рдЙрдард╛рддрд╛, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдкрдиреЗ рд╣рдорд▓реЗ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдордп рдорд┐рд▓рддрд╛ рд╣реИред

### Mixed

???

## Implementation & Detection Examples

рдЗрд╕реЗ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЯреИрдЧ-рдЖрдзрд╛рд░рд┐рдд KASAN, MTE-рдЖрдзрд╛рд░рд┐рдд KASAN рдпрд╛ рдЗрди-рдХрд░реНрдиреЗрд▓ MTE рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдХрд░реНрдиреЗрд▓ рдЖрд╡рдВрдЯрдХ (рдЬреИрд╕реЗ `kmalloc`) рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдХреЛ **рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ** рдЬреЛ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЯреИрдЧ рддреИрдпрд╛рд░ рдХрд░реЗрдЧрд╛ (рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ) рдЗрд╕реЗ рдХрд░реНрдиреЗрд▓ рд╕реНрдкреЗрд╕ рдЖрд╡рдВрдЯрд┐рдд рдФрд░ рд▓реМрдЯрд╛рдП рдЧрдП рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдПред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ **рдХреЗрд╡рд▓ рдкрд░реНрдпрд╛рдкреНрдд рдореЗрдореЛрд░реА рдЧреНрд░реЗрдиреНрдпреВрд▓реНрд╕** (рдкреНрд░рддреНрдпреЗрдХ 16B) рдХреЛ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рд▓рд┐рдП **рдорд╛рд░реНрдХ** рдХрд░реЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдХрд╛рд░ 35 рдерд╛ рдФрд░ 60B рдХрд╛ рдПрдХ рд╕реНрд▓реИрдм рджрд┐рдпрд╛ рдЧрдпрд╛, рддреЛ рдпрд╣ рдкрд╣рд▓реЗ 16\*3 = 48B рдХреЛ рдЗрд╕ рдЯреИрдЧ рдХреЗ рд╕рд╛рде **рдорд╛рд░реНрдХ** рдХрд░реЗрдЧрд╛ рдФрд░ **рдмрд╛рдХреА** рдХреЛ рдПрдХ рддрдерд╛рдХрдерд┐рдд **рдЕрдорд╛рдиреНрдп рдЯреИрдЧ (0xE)** рдХреЗ рд╕рд╛рде **рдорд╛рд░реНрдХ** рдХрд░реЗрдЧрд╛ред

рдЯреИрдЧ **0xF** **рд╕рднреА рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ**ред рдЗрд╕ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдореЗрдореЛрд░реА **рдХрд┐рд╕реА рднреА рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдХреЗ рдЕрдкрдиреА рдореЗрдореЛрд░реА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ (рдХреЛрдИ рдЕрд╕рдВрдЧрддрд┐рдпрд╛рдБ рдирд╣реАрдВ)ред рдпрджрд┐ рдЗрд╕ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдорд▓реЗ рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ MET рдХреЛ рд╣рдорд▓реЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП рдХреЗрд╡рд▓ **14 рдорд╛рди** рд╣реИрдВ рдЬреЛ рдЯреИрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ 0xE рдФрд░ 0xF рдЖрд░рдХреНрд╖рд┐рдд рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЯреИрдЧ **рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛** 1/17 -> рд▓рдЧрднрдЧ **7%** рд╣реЛ рдЬрд╛рддреА рд╣реИред

рдпрджрд┐ рдХрд░реНрдиреЗрд▓ **рдЕрдорд╛рдиреНрдп рдЯреИрдЧ рдЧреНрд░реЗрдиреНрдпреВрд▓** рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рддреЛ **рдЕрд╕рдВрдЧрддрд┐** **рдкрддрд╛ рд▓рдЧрд╛рдИ рдЬрд╛рдПрдЧреА**ред рдпрджрд┐ рдпрд╣ рдХрд┐рд╕реА рдЕрдиреНрдп рдореЗрдореЛрд░реА рд╕реНрдерд╛рди рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рдпрджрд┐ **рдореЗрдореЛрд░реА рдореЗрдВ рдПрдХ рдЕрд▓рдЧ рдЯреИрдЧ** (рдпрд╛ рдЕрдорд╛рдиреНрдп рдЯреИрдЧ) рд╣реИ рддреЛ рдЕрд╕рдВрдЧрддрд┐ **рдкрддрд╛ рд▓рдЧрд╛рдИ рдЬрд╛рдПрдЧреАред** рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИ рдФрд░ рдореЗрдореЛрд░реА рдЙрд╕реА рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ, рддреЛ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ред рд╕рдВрднрд╛рд╡рдирд╛рдПрдБ рд▓рдЧрднрдЧ 7% рд╣реИрдВред

рдПрдХ рдФрд░ рдмрдЧ рдЖрд╡рдВрдЯрд┐рдд рдореЗрдореЛрд░реА рдХреЗ **рдЕрдВрддрд┐рдо рдЧреНрд░реЗрдиреНрдпреВрд▓** рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ 35B рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛, рддреЛ рдЗрд╕реЗ 32 рд╕реЗ 48 рддрдХ рдХрд╛ рдЧреНрд░реЗрдиреНрдпреВрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ред рдЗрд╕рд▓рд┐рдП, **36 рд╕реЗ 47 рддрдХ рдХреЗ рдмрд╛рдЗрдЯреНрд╕ рдЙрд╕реА рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ **рдЗрди рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд╛рдЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛**ред

рдЬрдм **`kfree()`** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдореЗрдореЛрд░реА рдХреЛ рдЕрдорд╛рдиреНрдп рдореЗрдореЛрд░реА рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдлрд┐рд░ рд╕реЗ рдЯреИрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ **рдпреВрдЬрд╝-рдЖрдлреНрдЯрд░-рдлреНрд░реА** рдореЗрдВ, рдЬрдм рдореЗрдореЛрд░реА рдлрд┐рд░ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ **рдЕрд╕рдВрдЧрддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдпреВрдЬрд╝-рдЖрдлреНрдЯрд░-рдлреНрд░реА рдореЗрдВ, рдпрджрд┐ рд╡рд╣реА **рдЯреБрдХрдбрд╝рд╛ рдлрд┐рд░ рд╕реЗ рдЙрд╕реА рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдкреБрдирдГ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдЬреИрд╕рд╛ рдкрд╣рд▓реЗ рдерд╛, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдПрдХреНрд╕реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдЧрд╛ рдФрд░ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ (рд▓рдЧрднрдЧ 7% рд╕рдВрднрд╛рд╡рдирд╛)ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреЗрд╡рд▓ **`slab` рдФрд░ `page_alloc`** рдЯреИрдЧ рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ `vmalloc`, `stack` рдФрд░ `globals` рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рд╡реАрдбрд┐рдпреЛ рдХреЗ рд╕рдордп рдпреЗ рдЕрднреА рднреА рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдЬрдм **рдЕрд╕рдВрдЧрддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ рдХрд░реНрдиреЗрд▓ **рдкреИрдирд┐рдХ** рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдЖрдЧреЗ рдХреЗ рд╢реЛрд╖рдг рдФрд░ рд╢реЛрд╖рдг рдХреЗ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗ (MTE рдореЗрдВ рдЭреВрдареЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдирд╣реАрдВ рд╣реЛрддреЗ)ред

## References

* [https://www.youtube.com/watch?v=UwMt0e\_dC\_Q](https://www.youtube.com/watch?v=UwMt0e\_dC\_Q)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
