# PIE

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## Grundinformationen

Eine als PIE kompilierte Bin√§rdatei, oder **Position Independent Executable**, bedeutet, dass das **Programm bei jedem Ausf√ºhren an unterschiedlichen Speicherorten geladen werden kann**, wodurch hartcodierte Adressen verhindert werden.

Der Trick, um diese Bin√§rdateien auszunutzen, besteht darin, die **relativen Adressen** auszunutzen ‚Äì die Offsets zwischen den Teilen des Programms bleiben gleich, auch wenn sich die absoluten Standorte √§ndern. Um **PIE zu umgehen, musst du nur eine Adresse leaken**, typischerweise vom **Stack** unter Verwendung von Schwachstellen wie Format-String-Angriffen. Sobald du eine Adresse hast, kannst du andere anhand ihrer **festen Offsets** berechnen.

Ein hilfreicher Hinweis beim Ausnutzen von PIE-Bin√§rdateien ist, dass ihre **Basisadresse typischerweise auf 000 endet**, da Speicherseiten die Einheiten der Randomisierung sind, die eine Gr√∂√üe von 0x1000 Bytes haben. Diese Ausrichtung kann eine kritische **√úberpr√ºfung sein, wenn ein Exploit nicht wie erwartet funktioniert**, um anzuzeigen, ob die richtige Basisadresse identifiziert wurde.\
Oder du kannst dies f√ºr deinen Exploit verwenden, wenn du leaken kannst, dass eine Adresse bei **`0x649e1024`** liegt, wei√üt du, dass die **Basisadresse `0x649e1000` ist** und von dort aus kannst du einfach die **Offsets** von Funktionen und Standorten berechnen.

## Umgehungen

Um PIE zu umgehen, ist es notwendig, **eine Adresse der geladenen** Bin√§rdatei zu leaken, es gibt einige Optionen daf√ºr:

* **Deaktiviertes ASLR**: Wenn ASLR deaktiviert ist, wird eine mit PIE kompilierte Bin√§rdatei immer **an derselben Adresse geladen**, daher wird **PIE nutzlos sein**, da die Adressen der Objekte immer am selben Ort sein werden.
* **Die Leckage erhalten** (h√§ufig in einfachen CTF-Herausforderungen, [**√ºberpr√ºfe dieses Beispiel**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **Brute-Force EBP- und EIP-Werte** im Stack, bis du die richtigen leaken kannst:

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

* Verwende eine **willk√ºrliche Lese**-Schwachstelle wie [**Format-String**](../../format-strings/), um eine Adresse der Bin√§rdatei zu leaken (z. B. vom Stack, wie in der vorherigen Technik), um die Basis der Bin√§rdatei zu erhalten und von dort aus Offsets zu verwenden. [**Finde hier ein Beispiel**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass).

## Referenzen

* [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
