# PIE

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

## Informations de base

Un binaire compil√© en tant que PIE, ou **Ex√©cutable √† Adresse Ind√©pendante**, signifie que le **programme peut se charger √† diff√©rentes adresses m√©moire** √† chaque ex√©cution, emp√™chant les adresses cod√©es en dur.

La technique pour exploiter ces binaires r√©side dans l'exploitation des **adresses relatives** - les d√©calages entre les parties du programme restent les m√™mes m√™me si les emplacements absolus changent. Pour **contourner le PIE, vous avez seulement besoin de divulguer une adresse**, g√©n√©ralement √† partir de la **pile** en utilisant des vuln√©rabilit√©s telles que les attaques par cha√Æne de format. Une fois que vous avez une adresse, vous pouvez calculer les autres en fonction de leurs **d√©calages fixes**.

Un indice utile pour exploiter les binaires PIE est que leur **adresse de base se termine g√©n√©ralement en 000** en raison des pages m√©moire √©tant les unit√©s de randomisation, de taille 0x1000 octets. Cet alignement peut √™tre une **v√©rification critique si un exploit ne fonctionne pas** comme pr√©vu, indiquant si la bonne adresse de base a √©t√© identifi√©e.\
Ou vous pouvez utiliser cela pour votre exploit, si vous divulguez qu'une adresse est situ√©e √† **`0x649e1024`** vous savez que la **adresse de base est `0x649e1000`** et √† partir de l√† vous pouvez simplement **calculer les d√©calages** des fonctions et des emplacements.

## Contournements

Pour contourner le PIE, il est n√©cessaire de **divulguer une adresse du binaire charg√©**, il existe quelques options pour cela :

* **ASLR d√©sactiv√©** : Si l'ASLR est d√©sactiv√©, un binaire compil√© avec PIE est toujours **charg√© √† la m√™me adresse**, donc le **PIE sera inutile** car les adresses des objets seront toujours au m√™me endroit.
* Se **voir attribuer** la fuite (courant dans les d√©fis CTF faciles, [**consultez cet exemple**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **Forcer les valeurs EBP et EIP** dans la pile jusqu'√† ce que vous divulguiez les bonnes :

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

* Utilisez une vuln√©rabilit√© de **lecture arbitraire** telle que les [**cha√Ænes de format**](../../format-strings/) pour divulguer une adresse du binaire (par exemple √† partir de la pile, comme dans la technique pr√©c√©dente) pour obtenir la base du binaire et utiliser des d√©calages √† partir de l√†. [**Trouvez un exemple ici**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass).

## R√©f√©rences

* [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
