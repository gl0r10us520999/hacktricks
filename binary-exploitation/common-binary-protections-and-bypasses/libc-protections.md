# Libc Protections

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Chunk Alignment Enforcement

**Malloc** рдореЗрдореЛрд░реА рдХреЛ **8-рдмрд╛рдЗрдЯ (32-рдмрд┐рдЯ) рдпрд╛ 16-рдмрд╛рдЗрдЯ (64-рдмрд┐рдЯ) рд╕рдореВрд╣реЛрдВ** рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ 32-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЪрдВрдХреНрд╕ рдХрд╛ рдЕрдВрдд **0x8** рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ 64-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **0x0** рдХреЗ рд╕рд╛рдеред рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рдпрд╣ рдЬрд╛рдВрдЪрддреА рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЪрдВрдХ рдЗрди рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ **рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрд░реЗрдЦрд┐рдд** рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдмрд┐рди рд╕реЗ рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПред

### Security Benefits

64-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЪрдВрдХ рд╕рдВрд░реЗрдЦрдг рдХрд╛ рдкреНрд░рд╡рд░реНрддрди Malloc рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ **рдХреЗрд╡рд▓ 16 рдкрддреЗ рдореЗрдВ рд╕реЗ 1 рдкрд░ рдирдХрд▓реА рдЪрдВрдХреНрд╕ рдХреЗ рд╕реНрдерд╛рди рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдХреЗ** рдорд╣рддреНрд╡рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдмрдврд╝рд╛рддрд╛ рд╣реИред рдпрд╣ рд╢реЛрд╖рдг рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЬрдЯрд┐рд▓ рдмрдирд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдЗрдирдкреБрдЯ рдорд╛рдиреЛрдВ рдкрд░ рд╕реАрдорд┐рдд рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓реЛрдВ рдХреЛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдФрд░ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдХрдард┐рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

* **Fastbin Attack on \_\_malloc\_hook**

Malloc рдореЗрдВ рдирдП рд╕рдВрд░реЗрдЦрдг рдирд┐рдпрдо рднреА `__malloc_hook` рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ рд╣рдорд▓реЗ рдХреЛ рд╡рд┐рдлрд▓ рдХрд░рддреЗ рд╣реИрдВред рдкрд╣рд▓реЗ, рд╣рдорд▓рд╛рд╡рд░ рдЪрдВрдХ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ **рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддреЗ рдереЗ** рдФрд░ **рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рдереЗред рдЕрдм, рд╕рдЦреНрдд рд╕рдВрд░реЗрдЦрдг рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдРрд╕реА рд╣реЗрд░рдлреЗрд░ рдЕрдм рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╢реЛрд╖рдг рдорд╛рд░реНрдЧ рдХреЛ рдмрдВрдж рдХрд░ рджреЗрддреА рд╣реИ рдФрд░ рд╕рдордЧреНрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред

## Pointer Mangling on fastbins and tcache

**Pointer Mangling** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрд╡рд░реНрдзрди рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдлрд╛рд╕реНрдЯрдмрд┐рди рдФрд░ рдЯрдХреИрд╢ рдПрдлрдбреА рдкреЙрдЗрдВрдЯрд░реНрд╕** рдХреЛ рдореЗрдореЛрд░реА рдкреНрд░рдмрдВрдзрди рд╕рдВрдЪрд╛рд▓рди рдореЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреА рдореЗрдореЛрд░реА рд╢реЛрд╖рдг рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрди рдЬреЛ рд▓реАрдХ рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рдпрд╛ рдЬреЛ рдЬреНрдЮрд╛рдд рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рд╕реАрдзреЗ рдореЗрдореЛрд░реА рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рддреА рд╣реИрдВ (рд╕рд╛рдкреЗрдХреНрд╖ **рдУрд╡рд░рд░рд╛рдЗрдЯреНрд╕**)ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдореВрд▓ рдПрдХ рдЕрд╕реНрдкрд╖реНрдЯрддрд╛ рд╕реВрддреНрд░ рд╣реИ:

**`New_Ptr = (L >> 12) XOR P`**

* **L** рдкреЙрдЗрдВрдЯрд░ рдХрд╛ **рд╕реНрдЯреЛрд░реЗрдЬ рд╕реНрдерд╛рди** рд╣реИред
* **P** рд╡рд╛рд╕реНрддрд╡рд┐рдХ **рдлрд╛рд╕реНрдЯрдмрд┐рди/рдЯрдХреИрд╢ рдПрдлрдбреА рдкреЙрдЗрдВрдЯрд░** рд╣реИред

рд╕реНрдЯреЛрд░реЗрдЬ рд╕реНрдерд╛рди (L) рдХреЗ рдмрд┐рдЯрд╡рд╛рдЗрдЬ рд╢рд┐рдлреНрдЯ рдХреЛ 12 рдмрд┐рдЯреНрд╕ рджрд╛рдИрдВ рдУрд░ XOR рдСрдкрд░реЗрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдпрд╣ рд╣реЗрд░рдлреЗрд░ рдореЗрдореЛрд░реА рдкрддреЗ рдХреЗ рд╕рдмрд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг 12 рдмрд┐рдЯреНрд╕ рдХреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рдкреНрд░рдХреГрддрд┐ рдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдПрдХ рднреЗрджреНрдпрддрд╛ рдХреЛ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рд╕рд┐рд╕реНрдЯрдо рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреА рд╕реАрдорд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдмрд┐рдЯреНрд╕ рдХреЛ рд╢рд┐рдлреНрдЯ рдХрд░рдХреЗ, рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рднрд╛рдЧ рд╕рдореАрдХрд░рдг рд╕реЗ рдмрд╛рд╣рд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдирдП, рдордВрдЧрд▓реЗ рд╣реБрдП рдкреЙрдЗрдВрдЯрд░ рдХреА рдпрд╛рджреГрддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрди рдмрд┐рдЯреНрд╕ рдХреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рддрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╢реЛрд╖рдгреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдордВрдЧрд▓рд╛ рд╣реБрдЖ рдкреЙрдЗрдВрдЯрд░ **рдПрдбреНрд░реЗрд╕ рд╕реНрдкреЗрд╕ рд▓реЗрдЖрдЙрдЯ рд░реИрдВрдбрдорд╛рдЗрдЬреЗрд╢рди (ASLR)** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдореМрдЬреВрджрд╛ рдпрд╛рджреГрддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкрддреЗ рдХреЛ рдпрд╛рджреГрддрд╛ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдореЗрдореЛрд░реА рд▓реЗрдЖрдЙрдЯ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдирд╛ рдХрдард┐рди рд╣реЛ рдЬрд╛рдПред

**Demangling** рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдореВрд▓ рдкрддреЗ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реА XOR рдСрдкрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдпрд╣рд╛рдБ, рдордВрдЧрд▓рд╛ рд╣реБрдЖ рдкреЙрдЗрдВрдЯрд░ рд╕реВрддреНрд░ рдореЗрдВ P рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдЗрд╕реЗ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╕реНрдЯреЛрд░реЗрдЬ рд╕реНрдерд╛рди (L) рдХреЗ рд╕рд╛рде XOR рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдореВрд▓ рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рдордВрдЧрд▓реАрдХрд░рдг рдФрд░ рдбреЗрдордВрдЧрд▓реАрдХрд░рдг рдореЗрдВ рдпрд╣ рд╕рдордорд┐рддрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдмрд┐рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдУрд╡рд░рд╣реЗрдб рдХреЗ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдПрдиреНрдХреЛрдб рдФрд░ рдбрд┐рдХреЛрдб рдХрд░ рд╕рдХреЗ, рдЬрдмрдХрд┐ рдореЗрдореЛрд░реА рдкреЙрдЗрдВрдЯрд░реНрд╕ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдХрд╛рдлреА рдмрдврд╝рд╛ рд╕рдХреЗред

### Security Benefits

Pointer mangling рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп **рд╣реАрдк рдореЗрдВ рдЖрдВрд╢рд┐рдХ рдФрд░ рдкреВрд░реНрдг рдкреЙрдЗрдВрдЯрд░ рдУрд╡рд░рд░рд╛рдЗрдЯреНрд╕ рдХреЛ рд░реЛрдХрдирд╛** рд╣реИ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдВрд╡рд░реНрдзрди рд╣реИред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рд╢реЛрд╖рдг рддрдХрдиреАрдХреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ:

1. **Bye Byte рд╕рд╛рдкреЗрдХреНрд╖ рдУрд╡рд░рд░рд╛рдЗрдЯреНрд╕ рдХреА рд░реЛрдХрдерд╛рдо**: рдкрд╣рд▓реЗ, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдПрдХ рднрд╛рдЧ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рдереЗ рддрд╛рдХрд┐ **рд╣реАрдк рдЪрдВрдХреНрд╕ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдмрд┐рдирд╛ рд╕рдЯреАрдХ рдкрддреЗ рдХреЛ рдЬрд╛рдиреЗ**, рдпрд╣ рддрдХрдиреАрдХ рд▓реАрдХрд▓реЗрд╕ **рд╣рд╛рдЙрд╕ рдСрдл рд░реЛрдорди** рд╢реЛрд╖рдг рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рд╣реИред рдкреЙрдЗрдВрдЯрд░ рдордВрдЧреНрд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде, рдРрд╕реА рд╕рд╛рдкреЗрдХреНрд╖ рдУрд╡рд░рд░рд╛рдЗрдЯреНрд╕ **рдмрд┐рдирд╛ рд╣реАрдк рд▓реАрдХ рдХреЗ рдЕрдм рдмрд▓рд╛рддреНрдХрд╛рд░реА рдмрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рдЙрдирдХреА рд╕рдлрд▓рддрд╛ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдореЗрдВ рднрд╛рд░реА рдХрдореА рдЖрддреА рд╣реИред
2. **Tcache Bin/Fastbin рд╣рдорд▓реЛрдВ рдХреА рдмрдврд╝рддреА рдХрдард┐рдирд╛рдИ**: рд╕рд╛рдорд╛рдиреНрдп рд╣рдорд▓реЗ рдЬреЛ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ (рдЬреИрд╕реЗ `__malloc_hook`) рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдлрд╛рд╕реНрдЯрдмрд┐рди рдпрд╛ рдЯрдХреИрд╢ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдХреЗ рдмрд╛рдзрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛ рдПрдХ LibC рдкрддреЗ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ, рдПрдХ рдЪрдВрдХ рдХреЛ рдЯрдХреИрд╢ рдмрд┐рди рдореЗрдВ рдореБрдХреНрдд рдХрд░рдиреЗ, рдФрд░ рдлрд┐рд░ рдПрдлрдбреА рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдХреЗ рдЗрд╕реЗ `__malloc_hook` рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдордирдорд╛рдиреЗ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдкреЙрдЗрдВрдЯрд░ рдордВрдЧреНрд▓рд┐рдВрдЧ рдХреЗ рд╕рд╛рде, рдЗрди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдордВрдЧреНрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, **рд╕рдЯреАрдХ рд╣реЗрд░рдлреЗрд░ рдХреЗ рд▓рд┐рдП рд╣реАрдк рд▓реАрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рд╢реЛрд╖рдг рдХреА рдмрд╛рдзрд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред
3. **рдЧреИрд░-рд╣реАрдк рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╣реАрдк рд▓реАрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛**: рдЧреИрд░-рд╣реАрдк рдХреНрд╖реЗрддреНрд░реЛрдВ (рдЬреИрд╕реЗ рд╕реНрдЯреИрдХ, .bss рдЕрдиреБрднрд╛рдЧ, рдпрд╛ PLT/GOT) рдореЗрдВ рдПрдХ рдирдХрд▓реА рдЪрдВрдХ рдмрдирд╛рдирд╛ рдЕрдм рднреА **рд╣реАрдк рд▓реАрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ рдкреЙрдЗрдВрдЯрд░ рдордВрдЧреНрд▓рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрд╣ рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд╢реЛрд╖рдг рдХреА рдЬрдЯрд┐рд▓рддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, LibC рдкрддреЗ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рд╕рдорд╛рдиред
4. **рд╣реАрдк рдкрддреЗ рд▓реАрдХ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**: рдкреЙрдЗрдВрдЯрд░ рдордВрдЧреНрд▓рд┐рдВрдЧ рдлрд╛рд╕реНрдЯрдмрд┐рди рдФрд░ рдЯрдХреИрд╢ рдмрд┐рди рдореЗрдВ рдПрдлрдбреА рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рд╣реАрдк рдкрддреЗ рд▓реАрдХ рдХреЗ рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЕрд╕рдВрд░рдЪрд┐рдд, рдЫреЛрдЯреЗ, рдФрд░ рдмрдбрд╝реЗ рдмрд┐рди рдореЗрдВ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдмрд┐рдирд╛ рдордВрдЧреНрд▓рд┐рдд рд░рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрднреА рднреА рдкрддреЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рдмрджрд▓рд╛рд╡ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдЗрди рдмрд┐рдиреЛрдВ рдореЗрдВ рд╢реЛрд╖рдг рдпреЛрдЧреНрдп рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдзрдХреЗрд▓рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдБрдХрд┐ рдХреБрдЫ рддрдХрдиреАрдХреЗрдВ рдЕрднреА рднреА рд▓реАрдХ рд╕реЗ рдкрд╣рд▓реЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдбреЗрдордВрдЧреНрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИрдВ, рд╣рд╛рд▓рд╛рдБрдХрд┐ рд╕реАрдорд╛рдУрдВ рдХреЗ рд╕рд╛рдеред

### **Demangling Pointers with a Heap Leak**

{% hint style="danger" %}
For a better explanation of the process [**check the original post from here**](https://maxwelldulin.com/BlogPost?post=5445977088).
{% endhint %}

### Algorithm Overview

рдордВрдЧрд▓рди рдФрд░ рдбреЗрдордВрдЧреНрд▓рд┐рдВрдЧ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╕реВрддреНрд░ рд╣реИ:&#x20;

**`New_Ptr = (L >> 12) XOR P`**

рдЬрд╣рд╛рдБ **L** рд╕реНрдЯреЛрд░реЗрдЬ рд╕реНрдерд╛рди рд╣реИ рдФрд░ **P** рдПрдлрдбреА рдкреЙрдЗрдВрдЯрд░ рд╣реИред рдЬрдм **L** рдХреЛ 12 рдмрд┐рдЯреНрд╕ рджрд╛рдИрдВ рдУрд░ рд╢рд┐рдлреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **P** рдХреЗ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯреНрд╕ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ, **XOR** рдХреА рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг, рдЬреЛ рддрдм 0 рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрдм рдмрд┐рдЯреНрд╕ рдХреЛ рдЕрдкрдиреЗ рдЖрдк XOR рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**Algorithm рдореЗрдВ рдореБрдЦреНрдп рдЪрд░рдг:**

1. **рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯреНрд╕ рдХрд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд▓реАрдХ**: рд╢рд┐рдлреНрдЯ рдХрд┐рдП рдЧрдП **L** рдХреЛ **P** рдХреЗ рд╕рд╛рде XOR рдХрд░рдХреЗ, рдЖрдк рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ **P** рдХреЗ рд╢реАрд░реНрд╖ 12 рдмрд┐рдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ **L** рдХрд╛ рд╢рд┐рдлреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рднрд╛рдЧ рд╢реВрдиреНрдп рд╣реЛрдЧрд╛, рдЬрд┐рд╕рд╕реЗ **P** рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдмрд┐рдЯреНрд╕ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд░рд╣реЗрдВрдЧреЗред
2. **рдкреЙрдЗрдВрдЯрд░ рдмрд┐рдЯреНрд╕ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐**: рдЪреВрдВрдХрд┐ XOR рдЙрд▓рдЯрд╛ рд╣реЛрддрд╛ рд╣реИ, рдкрд░рд┐рдгрд╛рдо рдФрд░ рдПрдХ рдСрдкрд░реЗрдЯрд░ рдХреЛ рдЬрд╛рдирдиреЗ рд╕реЗ рдЖрдкрдХреЛ рджреВрд╕рд░реЗ рдСрдкрд░реЗрдЯрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдЗрд╕ рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдордВрдЧрд▓реЗ рд╣реБрдП рдкреЙрдЗрдВрдЯрд░ рдХреЗ рднрд╛рдЧреЛрдВ рдХреЗ рд╕рд╛рде рдЬреНрдЮрд╛рдд рдмрд┐рдЯреНрд╕ рдХреЗ рд╕реЗрдЯ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ XOR рдХрд░рдХреЗ **P** рдХреЗ рд▓рд┐рдП рдмрд┐рдЯреНрд╕ рдХреЗ рдкреВрд░реЗ рд╕реЗрдЯ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
3. **рдЖрд╡рд░реНрддреА рдбреЗрдордВрдЧреНрд▓рд┐рдВрдЧ**: рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреЛрд╣рд░рд╛рдИ рдЬрд╛рддреА рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рд╕реЗ **P** рдХреЗ рдирдП рдЦреЛрдЬреЗ рдЧрдП рдмрд┐рдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдордВрдЧрд▓реЗ рд╣реБрдП рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдЕрдЧрд▓реЗ рдЦрдВрдб рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрдм рддрдХ рд╕рднреА рдмрд┐рдЯреНрд╕ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗред
4. **рдирд┐рд░реНрдзрд╛рд░рдгрд╛рддреНрдордХ рдмрд┐рдЯреНрд╕ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛**: **L** рдХреЗ рдЕрдВрддрд┐рдо 12 рдмрд┐рдЯреНрд╕ рд╢рд┐рдлреНрдЯ рдХреЗ рдХрд╛рд░рдг рдЦреЛ рдЬрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдирд┐рд░реНрдзрд╛рд░рдгрд╛рддреНрдордХ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдирд┐рд░реНрдорд╛рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЖрдк рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/mdulin2/mangle](https://github.com/mdulin2/mangle)

## Pointer Guard

Pointer guard рдПрдХ рд╢реЛрд╖рдг рд╢рдорди рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ glibc рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрди рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреА рдЬреЛ `atexit()` рдЬреИрд╕реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЙрд▓ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХреГрдд рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдПрдХ рдЧреБрдкреНрдд рдХреЗ рд╕рд╛рде XOR рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдмрд┐рдЯрд╡рд╛рдЗрдЬ рд░реЛрдЯреЗрд╢рди рд▓рд╛рдЧреВ рдХрд░рдХреЗ рд╕реНрдХреНрд░реИрдореНрдмрд▓ рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред рдпрд╣ рддрдВрддреНрд░ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХреЛ рд╣рд╛рдИрдЬреИрдХ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХрд╛ рд▓рдХреНрд╖реНрдп рд░рдЦрддрд╛ рд╣реИред

### **Bypassing Pointer Guard with a leak**

1. **Pointer Guard рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рд╕рдордЭрдирд╛:** рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХрд╛ рд╕реНрдХреНрд░реИрдореНрдмрд▓рд┐рдВрдЧ (рдордВрдЧреНрд▓рд┐рдВрдЧ) `PTR_MANGLE` рдореИрдХреНрд░реЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдкреЙрдЗрдВрдЯрд░ рдХреЛ 64-рдмрд┐рдЯ рдЧреБрдкреНрдд рдХреЗ рд╕рд╛рде XOR рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ 0x11 рдмрд┐рдЯреНрд╕ рдХреА рдмрд╛рдИрдВ рдУрд░ рдШреБрдорд╛рддрд╛ рд╣реИред рдореВрд▓ рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд▓рдЯрд╛ рдСрдкрд░реЗрд╢рди `PTR_DEMANGLE` рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред
2. **рд╣рдорд▓рд╛ рд░рдгрдиреАрддрд┐:** рдпрд╣ рд╣рдорд▓рд╛ рдПрдХ рдЬреНрдЮрд╛рдд-рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬрд╣рд╛рдБ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдордВрдЧрд▓реЗ рд╣реБрдП рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдореВрд▓ рдФрд░ рдордВрдЧрд▓реЗ рд╣реБрдП рджреЛрдиреЛрдВ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рдордВрдЧреНрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЧреБрдкреНрдд рдХреЛ рдирд┐рдХрд╛рд▓ рд╕рдХреЗред
3. **рдЬреНрдЮрд╛рдд рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рд╢реЛрд╖рдг:**
* **рд╕реНрдерд┐рд░ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛:** glibc рд╕реНрд░реЛрдд рдХреЛрдб рдпрд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░ рддрд╛рд▓рд┐рдХрд╛рдУрдВ (рдЬреИрд╕реЗ `__libc_pthread_functions`) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирд┐рдд рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░реНрд╕ рдкрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдЧреБрдкреНрдд рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛:** рдПрдХ рдЬреНрдЮрд╛рдд рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░ рдЬреИрд╕реЗ `__pthread_attr_destroy` рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░ рддрд╛рд▓рд┐рдХрд╛ рд╕реЗ рдЗрд╕рдХреЗ рдордВрдЧрд▓реЗ рд╣реБрдП рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЧреБрдкреНрдд рдХреЛ рдордВрдЧрд▓реЗ рд╣реБрдП рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдЙрд▓рдЯрд╛ рдШреБрдорд╛рдХрд░ (рджрд╛рдИрдВ рдУрд░ рдШреБрдорд╛рдирд╛) рдФрд░ рдлрд┐рд░ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рде XOR рдХрд░рдХреЗ рдЧрдгрдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред
4. **рд╡реИрдХрд▓реНрдкрд┐рдХ рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ:** рд╣рдорд▓рд╛рд╡рд░ рдЬреНрдЮрд╛рдд рдорд╛рдиреЛрдВ рдЬреИрд╕реЗ 0 рдпрд╛ -1 рдХреЗ рд╕рд╛рде рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреЛ рдордВрдЧреНрд▓рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдпреЗ рдореЗрдореЛрд░реА рдореЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рдкреИрдЯрд░реНрди рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЬрдм рдпреЗ рдкреИрдЯрд░реНрди рдореЗрдореЛрд░реА рдбрдВрдк рдореЗрдВ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ рддреЛ рдЧреБрдкреНрдд рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВред
5. **рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ:** рдЧреБрдкреНрдд рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХ рдорд▓реНрдЯреАрдереНрд░реЗрдбреЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ Pointer Guard рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ libc рдмреЗрд╕ рдкрддреЗ рдХрд╛ рдЬреНрдЮрд╛рди рдФрд░ рдордирдорд╛рдиреЗ рдореЗрдореЛрд░реА рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред

## References

* [https://maxwelldulin.com/BlogPost?post=5445977088](https://maxwelldulin.com/BlogPost?post=5445977088)
* [https://blog.infosectcbr.com.au/2020/04/bypassing-pointer-guard-in-linuxs-glibc.html?m=1](https://blog.infosectcbr.com.au/2020/04/bypassing-pointer-guard-in-linuxs-glibc.html?m=1)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
