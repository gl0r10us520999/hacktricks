# Ret2ret & Reo2pop

{% hint style="success" %}
**AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:**<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
**GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:** <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github рд░реЗрдкреЛ рдореЗрдВред**

</details>
{% endhint %}

## Ret2ret

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдореБрдЦреНрдп **рд▓рдХреНрд╖реНрдп** ASLR рдХреЛ рдЙрд▓реНрд▓рдВрдШрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реНрдЯреИрдХ рдореЗрдВ рдореМрдЬреВрдж рдПрдХ рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдореВрд▓ рд░реВрдк рд╕реЗ, рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдЖрдо рддреМрд░ рдкрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЗ рдЕрдВрдд рдореЗрдВ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реЛрддрд╛ рд╣реИ**ред рдпрд╣ рдпрд╣ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИ рдХрд┐ рд╕реНрдЯреИрдХ рдореЗрдВ рдореМрдЬреВрдж рдПрдХ рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд┐рдд рд╕реНрдерд╛рди рдХреЛ рдХрдо рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рд╕реНрдЯреИрдХ рдореЗрдВ `0xbfffffdd` рдерд╛, рддреЛ рдпрд╣ рдУрд╡рд░рдлреНрд▓реЛ рдЗрд╕реЗ `0xbfffff00` рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ (рдЕрдВрддрд┐рдо рдЬрд╝реАрд░реЛ рдмрд╛рдЗрдЯ рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВ)ред

рдпрджрд┐ рд╡рд╣ рдкрддрд╛ рд╣рдорд╛рд░реЗ рд╢реИрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдореЗрдВ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ **`ret` рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдореЗрдВ рдкрддреЗ рдЬреЛрдбрд╝рдХрд░** рдЗрд╕реЗ рдкрд╣реБрдВрдЪрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬрдм рддрдХ рдпрд╣ рдкрд╣реБрдВрдЪ рдЬрд╛рдПред

рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛:

* NOP рд╕реНрд▓реЗрдб
* рд╢реИрд▓рдХреЛрдб
* EIP рд╕реЗ рд╕реНрдЯреИрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдВ **`ret` рдХреЗ рдкрддреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ** (RET рд╕реНрд▓реЗрдб)
* рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ 0x00, рд╕реНрдЯреИрдХ рд╕реЗ рдПрдХ рдкрддреЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдЗрд╕реЗ NOP рд╕реНрд▓реЗрдб рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдирд╛

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) рдкрд░ рдПрдХ рд╡рдВрд▓рд░реЗрдмрд▓ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

## Ret2pop

рдпрджрд┐ рдЖрдк рд╕реНрдЯреИрдХ рдореЗрдВ рдПрдХ **рдЙрддреНрдХреГрд╖реНрдЯ рдкреЙрдЗрдВрдЯрд░ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ** (`ret2ret` рдореЗрдВ рд╣рдордиреЗ рдЕрдВрддрд┐рдо рд╕рдмрд╕реЗ рдХрдо рдмрд╛рдЗрдЯ рдХреЛ `0x00` рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛ рдерд╛), рддреЛ рдЖрдк рдПрдХ рд╣реА `ret2ret` рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди **RET рд╕реНрд▓реЗрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ 1 рд╕реЗ рдХрдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛** (рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо `0x00` рдЙрддреНрдХреГрд╖реНрдЯ рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗ), рдФрд░ **RET рд╕реНрд▓реЗрдб рдХрд╛ рдЕрдВрддрд┐рдо** рдкрддрд╛ **`pop <reg>; ret`** рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред\
рдЗрд╕ рдкреНрд░рдХрд╛рд░, **рдЙрддреНрдХреГрд╖реНрдЯ рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдкрд╣рд▓реЗ рдХрд╛ рдбреЗрдЯрд╛ рд╕реНрдЯреИрдХ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рдпрд╣ рдбреЗрдЯрд╛ `0x00` рджреНрд╡рд╛рд░рд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ) рдФрд░ **рдЕрдВрддрд┐рдо `ret` рдЙрддреНрдХреГрд╖реНрдЯ рдкрддреЗ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░реЗрдЧрд╛** рдмрд┐рдирд╛ рдХрд┐рд╕реА рдмрджрд▓рд╛рд╡ рдХреЗред

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) рдкрд░ рдПрдХ рд╡рдВрд▓рд░реЗрдмрд▓ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ** ](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c)рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

## рд╕рдВрджрд░реНрдн

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

{% hint style="success" %}
**AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:**<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
**GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:** <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github рд░реЗрдкреЛ рдореЗрдВред**

</details>
{% endhint %}
