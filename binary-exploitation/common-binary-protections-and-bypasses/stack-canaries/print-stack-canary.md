# Print Stack Canary

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Enlarge printed stack

рдПрдХ рдРрд╕реА рд╕реНрдерд┐рддрд┐ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдБ рдПрдХ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЬреЛ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ** рдПрдХ **puts** рдлрд╝рдВрдХреНрд╢рди рдХреЛ **рдкреЙрдЗрдВрдЯ** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ** рдХреЗ **рднрд╛рдЧ** рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ **рдХрдирд╛рд░реА рдХрд╛ рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реИ** (`\x00`) рдФрд░ рдмрд╛рдХреА рдХрдирд╛рд░реА **рдпрд╛рджреГрдЪреНрдЫрд┐рдХ** рдмрд╛рдЗрдЯреНрд╕ рд╣реИрдВред рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рд╕реНрдЯреИрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдХреЗрд╡рд▓ рдХрдирд╛рд░реА рдХрд╛ рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ** рди рд░рд╣ рдЬрд╛рдПред

рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ **рдкреЗрд▓реЛрдб рдХреЗ рдордзреНрдп рдореЗрдВ puts рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ** рдЬреЛ **рд╕рднреА рдХрдирд╛рд░реА рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛** (рдкрд╣рд▓реЗ рдирд▓ рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░)ред

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ **рдХрдирд╛рд░реА рдХреЛ рдЬрд╛рдирдХрд░ рдПрдХ рдирдпрд╛ рд╣рдорд▓рд╛ рддреИрдпрд╛рд░ рдФрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ** (рдЙрд╕реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░ рдореЗрдВ)ред

рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рд░рдгрдиреАрддрд┐ рдмрд╣реБрдд **рд╕реАрдорд┐рдд** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдкрдиреА **рдкреЗрд▓реЛрдб** рдХреА **рд╕рд╛рдордЧреНрд░реА** рдХреЛ **рдкреНрд░рд┐рдВрдЯ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡рд╣ **рдХрдирд╛рд░реА** рдХреЛ **рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ** рдХрд░ рд╕рдХреЗ рдФрд░ рдлрд┐рд░ рдПрдХ рдирдпрд╛ рдкреЗрд▓реЛрдб рдмрдирд╛ рд╕рдХреЗ (рдЙрд╕реА **рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░** рдореЗрдВ) рдФрд░ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ** рднреЗрдЬ рд╕рдХреЗред

**CTF рдЙрджрд╛рд╣рд░рдг:**&#x20;

* [**https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html**](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд▓реЗрдХрд┐рди рдХреЛрдИ PIE рдирд╣реАрдВ, рдкрд╣рд▓рд╛ рдХрджрдо рдУрд╡рд░рдлреНрд▓реЛ рдХреЛ рднрд░рдирд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдХрдирд╛рд░реА рдХрд╛ рдмрд╛рдЗрдЯ 0x00 рди рд╣реЛ рдЬрд╛рдП рддрд╛рдХрд┐ рдлрд┐рд░ puts рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЗрд╕реЗ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдХрдирд╛рд░реА рдХреЗ рд╕рд╛рде рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ puts рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ GOT рд╕реЗ puts рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдлрд┐рд░ рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдЬреЛ `system('/bin/sh')` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
* [**https://guyinatuxedo.github.io/14-ret\_2\_system/hxp18\_poorCanary/index.html**](https://guyinatuxedo.github.io/14-ret\_2\_system/hxp18\_poorCanary/index.html)
* 32 рдмрд┐рдЯ, ARM, рдХреЛрдИ relro рдирд╣реАрдВ, рдХрдирд╛рд░реА, nx, рдХреЛрдИ pie рдирд╣реАрдВред рдЗрд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП puts рдкрд░ рдХреЙрд▓ рдХреЗ рд╕рд╛рде рдУрд╡рд░рдлреНрд▓реЛред + ret2lib рдЬреЛ `system` рдХреЛ рдПрдХ ROP рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ r0 (рдЖрд░реНрдЧ `/bin/sh`) рдФрд░ pc (system рдХрд╛ рдкрддрд╛) рдХреЛ рдкреЙрдк рдХрд░рддрд╛ рд╣реИред

## Arbitrary Read

рдПрдХ **рдордирдорд╛рдирд╛ рдкрдврд╝рд╛рдИ** рдХреЗ рд╕рд╛рде рдЬреИрд╕реЗ рдХрд┐ рдлреЙрд░реНрдореЗрдЯ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛, рдХрдирд╛рд░реА рдХреЛ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЛ рджреЗрдЦреЗрдВ: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) рдФрд░ рдЖрдк рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдордирдорд╛рдиреЗ рдореЗрдореЛрд░реА рдкрддреЗ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* рдпрд╣ рдЪреБрдиреМрддреА рдмрд╣реБрдд рд╕рд░рд▓ рддрд░реАрдХреЗ рд╕реЗ рдПрдХ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рддрд╛рдХрд┐ рд╕реНрдЯреИрдХ рд╕реЗ рдХрдирд╛рд░реА рдХреЛ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХреЗред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
