# Array Indexing

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

## Grundinformationen

Diese Kategorie umfasst alle Schwachstellen, die auftreten, weil es m√∂glich ist, bestimmte Daten durch Fehler im Umgang mit Indizes in Arrays zu √ºberschreiben. Es ist eine sehr breite Kategorie ohne spezifische Methodik, da der Exploit-Mechanismus vollst√§ndig von den Bedingungen der Schwachstelle abh√§ngt.

Hier findest du jedoch einige sch√∂ne **Beispiele**:

* [https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html](https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html)
* Es gibt **2 kollidierende Arrays**, eines f√ºr **Adressen**, wo Daten gespeichert sind, und eines mit den **Gr√∂√üen** dieser Daten. Es ist m√∂glich, eines vom anderen zu √ºberschreiben, was es erm√∂glicht, eine beliebige Adresse anzugeben, die als Gr√∂√üe betrachtet wird. Dies erlaubt es, die Adresse der `free`-Funktion in der GOT-Tabelle zu schreiben und sie dann mit der Adresse von `system` zu √ºberschreiben und `free` aus einem Speicher mit `/bin/sh` aufzurufen.
* [https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html](https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html)
* 64 Bit, kein nx. √úberschreibe eine Gr√∂√üe, um eine Art Puffer√ºberlauf zu erhalten, bei dem alles als doppelte Zahl verwendet wird und von klein nach gro√ü sortiert wird, sodass es notwendig ist, einen Shellcode zu erstellen, der diese Anforderung erf√ºllt, wobei zu beachten ist, dass der Canary nicht von seiner Position verschoben werden sollte und schlie√ülich die RIP mit einer Adresse zu ret √ºberschrieben wird, die die vorherigen Anforderungen erf√ºllt und die gr√∂√üte Adresse eine neue Adresse zeigt, die auf den Anfang des Stacks zeigt (von dem Programm geleakt), sodass es m√∂glich ist, das ret zu verwenden, um dorthin zu springen.
* [https://faraz.faith/2019-10-20-secconctf-2019-sum/](https://faraz.faith/2019-10-20-secconctf-2019-sum/)
* 64 Bit, kein relro, canary, nx, kein pie. Es gibt einen Off-by-One-Fehler in einem Array im Stack, der es erm√∂glicht, einen Zeiger zu kontrollieren, der WWW gew√§hrt (es schreibt die Summe aller Zahlen des Arrays in die √ºberschriebenen Adresse durch den Off-by-One-Fehler im Array). Der Stack wird kontrolliert, sodass die GOT-Adresse `exit` mit `pop rdi; ret` √ºberschrieben wird, und im Stack wird die Adresse zu `main` hinzugef√ºgt (Schleife zur√ºck zu `main`). Eine ROP-Kette wird verwendet, um die Adresse von put in der GOT mit puts zu leaken (`exit` wird aufgerufen, sodass es `pop rdi; ret` aufruft und somit diese Kette im Stack ausf√ºhrt). Schlie√ülich wird eine neue ROP-Kette verwendet, die ret2lib ausf√ºhrt.
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 Bit, kein relro, kein canary, nx, pie. Missbrauche ein schlechtes Indizieren, um Adressen von libc und Heap vom Stack zu leaken. Missbrauche den Puffer√ºberlauf, um ein ret2lib aufzurufen, das `system('/bin/sh')` aufruft (die Heap-Adresse wird ben√∂tigt, um eine √úberpr√ºfung zu umgehen).
