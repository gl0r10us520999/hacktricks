# Indexation de tableau

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Informations de base

Cette cat√©gorie comprend toutes les vuln√©rabilit√©s qui se produisent parce qu'il est possible d'√©craser certaines donn√©es √† travers des erreurs dans la gestion des index dans les tableaux. C'est une cat√©gorie tr√®s large sans m√©thodologie sp√©cifique, car le m√©canisme d'exploitation d√©pend compl√®tement des conditions de la vuln√©rabilit√©.

Cependant, vous pouvez trouver quelques **exemples** int√©ressants :

* [https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html](https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html)
* Il y a **2 tableaux en collision**, un pour les **adresses** o√π les donn√©es sont stock√©es et un avec les **tailles** de ces donn√©es. Il est possible d'√©craser l'un par l'autre, permettant d'√©crire une adresse arbitraire en l'indiquant comme une taille. Cela permet d'√©crire l'adresse de la fonction `free` dans la table GOT et ensuite de l'√©craser avec l'adresse de `system`, et d'appeler free depuis une m√©moire avec `/bin/sh`.
* [https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html](https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html)
* 64 bits, pas de nx. √âcraser une taille pour obtenir une sorte de d√©bordement de tampon o√π tout va √™tre utilis√© comme un double nombre et tri√© du plus petit au plus grand, donc il est n√©cessaire de cr√©er un shellcode qui remplit cette exigence, en tenant compte que le canary ne doit pas √™tre d√©plac√© de sa position et enfin √©craser le RIP avec une adresse de retour, qui remplit les exigences pr√©c√©dentes et mettant la plus grande adresse √† une nouvelle adresse pointant vers le d√©but de la pile (fuit par le programme) afin qu'il soit possible d'utiliser le retour pour sauter l√†-bas.
* [https://faraz.faith/2019-10-20-secconctf-2019-sum/](https://faraz.faith/2019-10-20-secconctf-2019-sum/)
* 64 bits, pas de relro, canary, nx, pas de pie. Il y a un off-by-one dans un tableau dans la pile qui permet de contr√¥ler un pointeur accordant WWW (il √©crit la somme de tous les nombres du tableau dans l'adresse √©cras√©e par l'off-by-one dans le tableau). La pile est contr√¥l√©e donc l'adresse GOT `exit` est √©cras√©e avec `pop rdi; ret`, et dans la pile est ajout√©e l'adresse de `main` (retournant √† `main`). Une cha√Æne ROP pour fuir l'adresse de put dans la GOT en utilisant puts est utilis√©e (`exit` sera appel√© donc il appellera `pop rdi; ret` ex√©cutant ainsi cette cha√Æne dans la pile). Enfin, une nouvelle cha√Æne ROP ex√©cutant ret2lib est utilis√©e.
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 bits, pas de relro, pas de canary, nx, pie. Abuser d'une mauvaise indexation pour fuir les adresses de libc et de heap depuis la pile. Abuser du d√©bordement de tampon pour faire un ret2lib appelant `system('/bin/sh')` (l'adresse de la heap est n√©cessaire pour contourner un contr√¥le).
