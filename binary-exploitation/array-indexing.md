# Indexation de tableau

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

## Informations de base

Cette cat√©gorie inclut toutes les vuln√©rabilit√©s qui se produisent parce qu'il est possible de remplacer certaines donn√©es en raison d'erreurs dans la manipulation des index dans les tableaux. Il s'agit d'une cat√©gorie tr√®s large sans m√©thodologie sp√©cifique car le m√©canisme d'exploitation repose enti√®rement sur les conditions de la vuln√©rabilit√©.

Cependant, vous pouvez trouver quelques **exemples** int√©ressants :

* [https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html](https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html)
* Il y a **2 tableaux en collision**, un pour les **adresses** o√π les donn√©es sont stock√©es et un avec les **tailles** de ces donn√©es. Il est possible de remplacer l'un par l'autre, permettant d'√©crire une adresse arbitraire en la d√©signant comme une taille. Cela permet d'√©crire l'adresse de la fonction `free` dans la table GOT, puis de la remplacer par l'adresse de `system`, et d'appeler free √† partir d'une m√©moire avec `/bin/sh`.
* [https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html](https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html)
* 64 bits, pas de nx. Remplacez une taille pour obtenir une sorte de d√©passement de tampon o√π tout va √™tre utilis√© comme un double nombre et tri√© du plus petit au plus grand, il est donc n√©cessaire de cr√©er un shellcode qui remplit cette exigence, en tenant compte du fait que le canary ne doit pas √™tre d√©plac√© de sa position et enfin en √©crasant le RIP avec une adresse de ret, qui remplit les exigences pr√©c√©dentes et en pla√ßant l'adresse la plus grande une nouvelle adresse pointant vers le d√©but de la pile (fuit√©e par le programme) afin de pouvoir utiliser le ret pour sauter l√†-bas.
* [https://faraz.faith/2019-10-20-secconctf-2019-sum/](https://faraz.faith/2019-10-20-secconctf-2019-sum/)
* 64 bits, pas de relro, canary, nx, pas de pie. Il y a un d√©calage d'un octet dans un tableau dans la pile qui permet de contr√¥ler un pointeur accordant WWW (il √©crit la somme de tous les nombres du tableau dans l'adresse √©cras√©e par le d√©calage d'un octet dans le tableau). La pile est contr√¥l√©e de sorte que l'adresse `exit` de la GOT est √©cras√©e avec `pop rdi; ret`, et dans la pile est ajout√©e l'adresse de `main` (retournant √† `main`). Ensuite, une cha√Æne ROP est utilis√©e pour divulguer l'adresse de put dans la GOT en utilisant puts (`exit` sera appel√© donc il appellera `pop rdi; ret` ex√©cutant ainsi cette cha√Æne dans la pile). Enfin, une nouvelle cha√Æne ROP ex√©cutant ret2lib est utilis√©e.
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 bits, pas de relro, pas de canary, nx, pie. Abuser d'un mauvais index pour divulguer des adresses de libc et de tas √† partir de la pile. Abuser du d√©passement de tampon pour effectuer un ret2lib appelant `system('/bin/sh')` (l'adresse du tas est n√©cessaire pour contourner une v√©rification).
