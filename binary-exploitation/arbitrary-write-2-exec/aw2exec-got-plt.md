# WWW2Exec - GOT/PLT

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **Temel Bilgiler**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)**, dinamik olarak baÄŸlantÄ±lÄ± ikili dosyalarda **harici fonksiyonlarÄ±n adreslerini** yÃ¶netmek iÃ§in kullanÄ±lan bir mekanizmadÄ±r. Bu **adresler Ã§alÄ±ÅŸma zamanÄ±nda** (dinamik baÄŸlantÄ± nedeniyle) bilinmediÄŸinden, GOT, bu harici sembollerin adreslerini **dinamik olarak gÃ¼ncellemenin** bir yolunu saÄŸlar.

GOT'taki her giriÅŸ, ikilinin Ã§aÄŸÄ±rabileceÄŸi harici kÃ¼tÃ¼phanelerdeki bir sembole karÅŸÄ±lÄ±k gelir. Bir **fonksiyon ilk kez Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, gerÃ§ek adresi dinamik baÄŸlayÄ±cÄ± tarafÄ±ndan Ã§Ã¶zÃ¼lÃ¼r ve GOT'a kaydedilir**. AynÄ± fonksiyona yapÄ±lan sonraki Ã§aÄŸrÄ±lar, GOT'ta saklanan adresi kullanÄ±r ve bÃ¶ylece adresin tekrar Ã§Ã¶zÃ¼lmesi iÃ§in gereken yÃ¼kten kaÃ§Ä±nÄ±lÄ±r.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)**, GOT ile yakÄ±ndan Ã§alÄ±ÅŸÄ±r ve harici fonksiyonlara yapÄ±lan Ã§aÄŸrÄ±larÄ± yÃ¶netmek iÃ§in bir trampolin gÃ¶revi gÃ¶rÃ¼r. Bir ikili dosya **ilk kez bir harici fonksiyonu Ã§aÄŸÄ±rdÄ±ÄŸÄ±nda, kontrol o fonksiyonla iliÅŸkili PLT'deki bir giriÅŸe geÃ§er**. Bu PLT giriÅŸi, fonksiyonun adresini Ã§Ã¶zmek iÃ§in dinamik baÄŸlayÄ±cÄ±yÄ± Ã§aÄŸÄ±rmaktan sorumludur, eÄŸer bu adres daha Ã¶nce Ã§Ã¶zÃ¼lmemiÅŸse. Adres Ã§Ã¶zÃ¼ldÃ¼kten sonra, **GOT**'ta saklanÄ±r.

**Bu nedenle,** GOT giriÅŸleri, bir harici fonksiyon veya deÄŸiÅŸkenin adresi Ã§Ã¶zÃ¼ldÃ¼ÄŸÃ¼nde doÄŸrudan kullanÄ±lÄ±r. **PLT giriÅŸleri, bu adreslerin dinamik baÄŸlayÄ±cÄ± aracÄ±lÄ±ÄŸÄ±yla ilk Ã§Ã¶zÃ¼mlemesini kolaylaÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.**

## Ä°cra Alma

### GOT'u Kontrol Et

GOT tablosunun adresini almak iÃ§in: **`objdump -s -j .got ./exec`**

![](<../../.gitbook/assets/image (121).png>)

GEF'de **yÃ¼rÃ¼tÃ¼lebilir dosyayÄ± yÃ¼kledikten sonra** **GOT'taki** **fonksiyonlarÄ±** **gÃ¶rebileceÄŸinizi** gÃ¶zlemleyin: `gefâ¤ x/20x 0xADDR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEF kullanarak bir **hata ayÄ±klama** oturumu **baÅŸlatabilir** ve GOT tablosunu gÃ¶rmek iÃ§in **`got`** komutunu Ã§alÄ±ÅŸtÄ±rabilirsiniz:

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

Bir ikili dosyada GOT, **fonksiyonlarÄ±n adreslerini** veya **PLT** bÃ¶lÃ¼mÃ¼ne iÅŸaret eden adresleri iÃ§erir. Bu keyfi yazmanÄ±n amacÄ±, daha sonra **Ã§alÄ±ÅŸtÄ±rÄ±lacak** bir fonksiyonun **GOT giriÅŸini**, Ã¶rneÄŸin **`system`** **fonksiyonunun** PLT adresi ile **geÃ§ersiz kÄ±lmaktÄ±r**.

Ä°deal olarak, **parametreleri sizin kontrolÃ¼nÃ¼zde olan** bir **fonksiyonun** **GOT'unu geÃ§ersiz kÄ±lacaksÄ±nÄ±z** (bÃ¶ylece sistem fonksiyonuna gÃ¶nderilen parametreleri kontrol edebileceksiniz).

EÄŸer **`system`** **ikili dosya tarafÄ±ndan kullanÄ±lmÄ±yorsa**, sistem fonksiyonu **PLT'de** bir giriÅŸe sahip **olmayacaktÄ±r**. Bu senaryoda, Ã¶nce **`system`** fonksiyonunun adresini **sÄ±zdÄ±rmanÄ±z** ve ardÄ±ndan GOT'u bu adrese iÅŸaret edecek ÅŸekilde geÃ§ersiz kÄ±lmanÄ±z gerekecektir.

PLT adreslerini **`objdump -j .plt -d ./vuln_binary`** ile gÃ¶rebilirsiniz.

## libc GOT giriÅŸleri

**libc'nin GOT'u** genellikle **kÄ±smi RELRO** ile derlenir, bu da onun adresini bulmanÄ±n mÃ¼mkÃ¼n olduÄŸu varsayÄ±mÄ±yla gÃ¼zel bir hedef haline getirir ([**ASLR**](../common-binary-protections-and-bypasses/aslr/)).

libc'nin yaygÄ±n fonksiyonlarÄ±, kod yÃ¼rÃ¼tmek iÃ§in GOT'unun geÃ§ersiz kÄ±lÄ±nabileceÄŸi **diÄŸer iÃ§ fonksiyonlarÄ±** Ã§aÄŸÄ±racaktÄ±r.

Bu teknik hakkÄ±nda [**daha fazla bilgi burada**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries) bulun.

### **Free2system**

Heap istismarÄ±nda CTF'lerde, parÃ§alarÄ±n iÃ§eriÄŸini kontrol edebilmek ve bir noktada GOT tablosunu bile geÃ§ersiz kÄ±labilmek yaygÄ±ndÄ±r. EÄŸer bir gadget mevcut deÄŸilse, RCE elde etmek iÃ§in basit bir hile, `free` GOT adresini `system`'a iÅŸaret edecek ÅŸekilde geÃ§ersiz kÄ±lmak ve bir parÃ§anÄ±n iÃ§ine `"/bin/sh"` yazmaktÄ±r. Bu ÅŸekilde, bu parÃ§a serbest bÄ±rakÄ±ldÄ±ÄŸÄ±nda, `system("/bin/sh")` komutunu Ã§alÄ±ÅŸtÄ±racaktÄ±r.

### **Strlen2system**

Bir diÄŸer yaygÄ±n teknik, **`strlen`** GOT adresini **`system`**'a iÅŸaret edecek ÅŸekilde geÃ§ersiz kÄ±lmaktÄ±r, bÃ¶ylece bu fonksiyon kullanÄ±cÄ± girdisi ile Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda `"/bin/sh"` dizesini geÃ§mek ve bir shell almak mÃ¼mkÃ¼ndÃ¼r.

AyrÄ±ca, `puts` kullanÄ±cÄ± girdisi ile kullanÄ±ldÄ±ÄŸÄ±nda, `strlen` GOT adresini `system`'a iÅŸaret edecek ÅŸekilde geÃ§ersiz kÄ±lmak ve `"/bin/sh"` dizesini geÃ§mek mÃ¼mkÃ¼ndÃ¼r Ã§Ã¼nkÃ¼ **`puts`, kullanÄ±cÄ± girdisi ile `strlen`'Ä± Ã§aÄŸÄ±racaktÄ±r**.

## **One Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **Heap'ten GOT'u KÃ¶tÃ¼ye Kullanma**

Heap zafiyetinden RCE elde etmenin yaygÄ±n bir yolu, hÄ±zlÄ± bir binayÄ± kÃ¶tÃ¼ye kullanmaktÄ±r, bÃ¶ylece GOT tablosunun bir kÄ±smÄ±nÄ± hÄ±zlÄ± binaya eklemek mÃ¼mkÃ¼ndÃ¼r, bÃ¶ylece o parÃ§a tahsis edildiÄŸinde bir fonksiyonun, genellikle `free`'in, iÅŸaretÃ§isini **geÃ§ersiz kÄ±lmak** mÃ¼mkÃ¼n olacaktÄ±r.\
Sonra, `free`'i `system`'a iÅŸaret ederek ve `/bin/sh\x00` yazÄ±lmÄ±ÅŸ bir parÃ§ayÄ± serbest bÄ±rakarak bir shell Ã§alÄ±ÅŸtÄ±rÄ±lacaktÄ±r.

Burada bir [**Ã¶rnek bulabilirsiniz**](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/chunk\_extend\_overlapping/#hitcon-trainging-lab13)**.**

## **Koruma**

**Full RELRO** korumasÄ±, bu tÃ¼r tekniklere karÅŸÄ± koruma saÄŸlamak iÃ§in, ikili dosya baÅŸlatÄ±ldÄ±ÄŸÄ±nda tÃ¼m fonksiyonlarÄ±n adreslerini Ã§Ã¶zerek ve ardÄ±ndan **GOT tablosunu yalnÄ±zca okunur** hale getirerek tasarlanmÄ±ÅŸtÄ±r:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referanslar

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
