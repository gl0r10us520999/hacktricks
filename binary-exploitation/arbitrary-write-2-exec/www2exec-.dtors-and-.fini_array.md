# WWW2Exec - .dtors & .fini\_array

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## .dtors

{% hint style="danger" %}
рдЖрдЬрдХрд▓ рдПрдХ рдмрд╛рдЗрдирд░реА рдореЗрдВ .dtors рд╕реЗрдХреНрд╢рди рдорд┐рд▓рдирд╛ рдмрд╣реБрдд **рдЕрдЬреАрдм рд╣реИ!**
{% endhint %}

Destructor рд╡реЗ рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВ рдЬреЛ **рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** (рдЬрдм `main` рдлрд╝рдВрдХреНрд╢рди рд▓реМрдЯрддрд╛ рд╣реИ) **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрддреЗ рд╣реИрдВред\
рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЗ рдмрд╛рдЗрдирд░реА рдХреЗ **`.dtors`** рд╕реЗрдХреНрд╢рди рдХреЗ рдЕрдВрджрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **`__DTOR_END__`** рдореЗрдВ **shellcode** рдХреЗ рд▓рд┐рдП **рдкрддрд╛ рд▓рд┐рдЦрдиреЗ** рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╡рд╣ **рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрдЧрд╛ред

рдЗрд╕ рд╕реЗрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
objdump -s -j .dtors /exec
rabin -s /exec | grep тАЬ__DTORтАЭ
```
рдЖрдорддреМрд░ рдкрд░ рдЖрдк **DTOR** рдорд╛рд░реНрдХрд░ **`ffffffff`** рдФрд░ **`00000000`** рдХреЗ рдмреАрдЪ рдкрд╛рдПрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдХреЗрд╡рд▓ рдЙрди рдорд╛рдиреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреЛрдИ **рдлрдВрдХреНрд╢рди рд░рдЬрд┐рд╕реНрдЯрд░ рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП **`00000000`** рдХреЛ **shellcode** рдХреЗ **рдкрддреЗ** рд╕реЗ **overwrite** рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% hint style="warning" %}
рдмрд┐рд▓реНрдХреБрд▓, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ **shellcode рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдерд╛рди** рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рдмрд╛рдж рдореЗрдВ рдЗрд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
{% endhint %}

## **.fini\_array**

рдЖрдзрд╛рд░рднреВрдд рд░реВрдк рд╕реЗ рдпрд╣ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдлрдВрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ**, рдЬреИрд╕реЗ **`.dtors`**ред рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ **shellcode рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдкрддреЗ рдкрд░ рдХреВрджрдХрд░** рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ **рдлрд┐рд░ рд╕реЗ `main`** рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдирд╛ рд╣реИ рддрд╛рдХрд┐ **рджреВрд╕рд░реА рдмрд╛рд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
objdump -s -j .fini_array ./greeting

./greeting:     file format elf32-i386

Contents of section .fini_array:
8049934 a0850408

#Put your address in 0x8049934
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм **`.fini_array`** рд╕реЗ рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрдЧрд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдЪрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдХрдИ рдмрд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдЕрдирдВрдд рд▓реВрдк рдХреЛ рд░реЛрдХрдирд╛), рд▓реЗрдХрд┐рди рдпрд╣ рдХреЗрд╡рд▓ рдЖрдкрдХреЛ рдпрд╣рд╛рдБ рд░рдЦреЗ рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХрд╛ 1 **рдирд┐рд╖реНрдкрд╛рджрди** рджреЗрдЧрд╛ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ `.fini_array` рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ **рд╡рд┐рдкрд░реАрдд** рдХреНрд░рдо рдореЗрдВ рдХреЙрд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдк рд╢рд╛рдпрдж рдЕрдВрддрд┐рдо рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╕реЗ рд▓рд┐рдЦрдирд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗред

#### рдЕрдирдВрдд рд▓реВрдк

**`.fini_array`** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдирдВрдд рд▓реВрдк рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**рдпрд╣рд╛рдБ рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ**](https://guyinatuxedo.github.io/17-stack\_pivot/insomnihack18\_onewrite/index.html)**:** рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **`.fini_array`** рдореЗрдВ рдХрдо рд╕реЗ рдХрдо 2 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╣реИрдВ, рддреЛ рдЖрдк:

* рдЕрдкрдиреЗ рдкрд╣рд▓реЗ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХрдордЬреЛрд░ рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рд▓рд┐рдЦрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди** рдХреЛ рдлрд┐рд░ рд╕реЗ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* рдлрд┐рд░, **`__libc_csu_fini`** (рд╡рд╣ рдлрд╝рдВрдХреНрд╢рди рдЬреЛ рд╕рднреА `.fini_array` рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░ рд░рд╣рд╛ рд╣реИ) рджреНрд╡рд╛рд░рд╛ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд▓реМрдЯрдиреЗ рдХреЗ рдкрддреЗ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВ рдФрд░ рд╡рд╣рд╛рдБ **`__libc_csu_fini`** рдХрд╛ **рдкрддрд╛** рдбрд╛рд▓реЗрдВ
* рдЗрд╕рд╕реЗ **`__libc_csu_fini`** рдлрд┐рд░ рд╕реЗ рдЦреБрдж рдХреЛ рдХреЙрд▓ рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рд╕реЗ **`.fini_array`** рдлрд╝рдВрдХреНрд╢рди рдлрд┐рд░ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдВрдЧреЗ, рдЬреЛ рдХрдордЬреЛрд░ WWW рдлрд╝рдВрдХреНрд╢рди рдХреЛ 2 рдмрд╛рд░ рдХреЙрд▓ рдХрд░реЗрдЧрд╛: рдПрдХ рдмрд╛рд░ **рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рд▓рд┐рдЦрдиреЗ** рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рд╕реНрдЯреИрдХ рдкрд░ **`__libc_csu_fini`** рдХреЗ рд▓реМрдЯрдиреЗ рдХреЗ рдкрддреЗ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рдХрд┐ рдпрд╣ рдлрд┐рд░ рд╕реЗ рдЦреБрдж рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХреЗред

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ [**рдкреВрд░реНрдг RELRO**](../common-binary-protections-and-bypasses/relro.md)** рдХреЗ рд╕рд╛рде, **`.fini_array`** рдЕрдиреБрднрд╛рдЧ **рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓** рдмрдирд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, [**рдЖрдВрд╢рд┐рдХ RELRO**] рдХреЗ рд╕рд╛рде рднреА **`.fini_array`** рдЕрдиреБрднрд╛рдЧ **рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓** рдмрдирд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
{% endhint %}


{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
{% endhint %}
