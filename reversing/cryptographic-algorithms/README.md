# Cryptographic/Compression Algorithms

## Cryptographic/Compression Algorithms

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}

## Algorithms рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

рдпрджрд┐ рдЖрдк рдПрдХ рдХреЛрдб рдореЗрдВ **shift rights рдФрд░ lefts, xors рдФрд░ рдХрдИ рдЕрдВрдХрдЧрдгрд┐рддреАрдп рд╕рдВрдЪрд╛рд▓рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЕрддреНрдпрдзрд┐рдХ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ **рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо** рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИред рдпрд╣рд╛рдБ рдХреБрдЫ рддрд░реАрдХреЗ рджрд┐рдЦрд╛рдП рдЬрд╛рдПрдВрдЧреЗ **рдЬрд┐рд╕рд╕реЗ рдЖрдк рдмрд┐рдирд╛ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХрд┐рдП рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### API рдлрд╝рдВрдХреНрд╢рди

**CryptDeriveKey**

рдпрджрд┐ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рджреВрд╕рд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдХреМрди рд╕рд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**:

![](<../../.gitbook/assets/image (375) (1) (1) (1) (1).png>)

рд╕рдВрднрд╛рд╡рд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдЙрдирдХреЗ рдЕрд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

**RtlCompressBuffer/RtlDecompressBuffer**

рдПрдХ рджрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЗ рдмрдлрд░ рдХреЛ рд╕рдВрдХреБрдЪрд┐рдд рдФрд░ рдЕрдирд╕рдВрдХреБрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред

**CryptAcquireContext**

[рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рд╕реЗ](https://learn.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptacquirecontexta): **CryptAcquireContext** рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ (CSP) рдХреЗ рднреАрддрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХреБрдВрдЬреА рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реИрдВрдбрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред **рдпрд╣ рд▓реМрдЯрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИрдВрдбрд▓ рдЙрди CryptoAPI** рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЪрдпрдирд┐рдд CSP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

**CryptCreateHash**

рдбреЗрдЯрд╛ рдХреЗ рдПрдХ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рд╣реИрд╢рд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рджреВрд╕рд░реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдХреМрди рд╕рд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**:

![](<../../.gitbook/assets/image (376).png>)

\
рд╕рдВрднрд╛рд╡рд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдЙрдирдХреЗ рдЕрд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ: [https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id](https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id)

### рдХреЛрдб рд╕реНрдерд┐рд░рд╛рдВрдХ

рдХрднреА-рдХрднреА рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдФрд░ рдЕрджреНрд╡рд┐рддреАрдп рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

![](<../../.gitbook/assets/image (370).png>)

рдпрджрд┐ рдЖрдк Google рдореЗрдВ рдкрд╣рд▓реЗ рд╕реНрдерд┐рд░рд╛рдВрдХ рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдпрд╣ рдорд┐рд▓рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (371).png>)

рдЗрд╕рд▓рд┐рдП, рдЖрдк рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбрд┐рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдПрдХ **sha256 рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рд╣реИред**\
рдЖрдк рдЕрдиреНрдп рд╕реНрдерд┐рд░рд╛рдВрдХреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдХреА рднреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЛ (рд╕рдВрднрд╡рддрдГ) рд╡рд╣реА рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛ред

### рдбреЗрдЯрд╛ рдЬрд╛рдирдХрд╛рд░реА

рдпрджрд┐ рдХреЛрдб рдореЗрдВ рдХреЛрдИ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрдерд┐рд░рд╛рдВрдХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ **.data рд╕реЗрдХреНрд╢рди рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ**ред\
рдЖрдк рдЙрд╕ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ, **рдкрд╣рд▓реЗ dword рдХреЛ рд╕рдореВрд╣рд┐рдд рдХрд░реЗрдВ** рдФрд░ рдЗрд╕реЗ Google рдореЗрдВ рдЦреЛрдЬреЗрдВ рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛:

![](<../../.gitbook/assets/image (372).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрджрд┐ рдЖрдк **0xA56363C6** рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ **AES рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рддрд╛рд▓рд┐рдХрд╛рдУрдВ** рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред

## RC4 **(Symmetric Crypt)**

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

рдпрд╣ 3 рдореБрдЦреНрдп рднрд╛рдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реИ:

* **Initialization stage/**: **0x00 рд╕реЗ 0xFF** (рдХреБрд▓ 256bytes, 0x100) рддрдХ рдХреЗ рдорд╛рдиреЛрдВ рдХреА рдПрдХ **рддрд╛рд▓рд┐рдХрд╛** рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рд╕рд╛рдорд╛рдиреНрдпрддрдГ **Substitution Box** (рдпрд╛ SBox) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
* **Scrambling stage**: рдкрд╣рд▓реЗ рдмрдирд╛рдИ рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рд▓реВрдк рдХрд░реЗрдЧрд╛** (0x100 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХрд╛ рд▓реВрдк, рдлрд┐рд░ рд╕реЗ) рдкреНрд░рддреНрдпреЗрдХ рдорд╛рди рдХреЛ **рд╕реЗрдореА-рд░реИрдВрдбрдо** рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдЧрд╛ред рдЗрди рд╕реЗрдореА-рд░реИрдВрдбрдо рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, RC4 **рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред RC4 **рдХреБрдВрдЬреА** рдХреА рд▓рдВрдмрд╛рдИ **1 рд╕реЗ 256 рдмрд╛рдЗрдЯреНрд╕** рдХреЗ рдмреАрдЪ рд╣реЛ рд╕рдХрддреА рд╣реИ, рд╣рд╛рд▓рд╛рдБрдХрд┐ рдпрд╣ рд╕рд╛рдорд╛рдиреНрдпрддрдГ 5 рдмрд╛рдЗрдЯреНрд╕ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рд╕рд╛рдорд╛рдиреНрдпрддрдГ, RC4 рдХреБрдВрдЬреА 16 рдмрд╛рдЗрдЯреНрд╕ рдХреА рд╣реЛрддреА рд╣реИред
* **XOR stage**: рдЕрдВрддрддрдГ, рдкреНрд▓реЗрди-рдЯреЗрдХреНрд╕реНрдЯ рдпрд╛ рд╕рд┐рдлрд░рдЯреЗрдХреНрд╕ рдХреЛ **рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде XOR рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рд╡рд╣реА рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП, **рдмрдирд╛рдП рдЧрдП 256 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реВрдк рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** рдЬрд┐рддрдиреА рдмрд╛рд░ рдЖрд╡рд╢реНрдпрдХ рд╣реЛред рдЗрд╕реЗ рдЖрдорддреМрд░ рдкрд░ рдбрд┐рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдХреЛрдб рдореЗрдВ **%256 (mod 256)** рдХреЗ рд╕рд╛рде рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

{% hint style="info" %}
**рдбрд┐рд╕рдЕрд╕реНрд╕реЗрдореНрдмрд▓реА/рдбрд┐рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдХреЛрдб рдореЗрдВ RC4 рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк 0x100 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ 2 рд▓реВрдк рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ) рдФрд░ рдлрд┐рд░ рдЗрди 2 рд▓реВрдк рдореЗрдВ рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП 256 рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХрд╛ XOR рд╕рдВрднрд╡рддрдГ %256 (mod 256) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред**
{% endhint %}

### **Initialization stage/Substitution Box:** (рдЧрд┐рдирддреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП 256 рд╕рдВрдЦреНрдпрд╛ рдФрд░ 256 рд╡рд░реНрдгреЛрдВ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрдерд╛рди рдкрд░ 0 рдХреИрд╕реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ)

![](<../../.gitbook/assets/image (377).png>)

### **Scrambling Stage:**

![](<../../.gitbook/assets/image (378).png>)

### **XOR Stage:**

![](<../../.gitbook/assets/image (379).png>)

## **AES (Symmetric Crypt)**

### **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ**

* **Substitution boxes рдФрд░ lookup tables** рдХрд╛ рдЙрдкрдпреЛрдЧ
* **рд╡рд┐рд╢рд┐рд╖реНрдЯ lookup table рдорд╛рдиреЛрдВ** (рд╕реНрдерд┐рд░рд╛рдВрдХ) рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдХрд╛рд░рдг **AES рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣реИ**ред _рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рд╕реНрдерд┐рд░рд╛рдВрдХ** рдХреЛ **рдмрд╛рдЗрдирд░реА рдореЗрдВ** _рдпрд╛_ _**рдбрд╛рдпрдирд╛рдорд┐рдХрд▓реА**_ _**рд╕реНрдЯреЛрд░** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред_
* **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреБрдВрдЬреА** рдХреЛ **16** (рдЖрдорддреМрд░ рдкрд░ 32B) рд╕реЗ **рднрд╛рдЧреНрдпрд╢рд╛рд▓реА** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЖрдорддреМрд░ рдкрд░ 16B рдХрд╛ **IV** рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### SBox рд╕реНрдерд┐рд░рд╛рдВрдХ

![](<../../.gitbook/assets/image (380).png>)

## Serpent **(Symmetric Crypt)**

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреБрдЫ рдореИрд▓рд╡реЗрдпрд░ рдорд┐рд▓рдирд╛ рджреБрд░реНрд▓рдн рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ (Ursnif)
* рдЗрд╕рдХреА рд▓рдВрдмрд╛рдИ (рдЕрддреНрдпрдзрд┐рдХ рд▓рдВрдмрд╛ рдлрд╝рдВрдХреНрд╢рди) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рд╕рд░рд▓ рд╣реИ рдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рджрдо Serpent рд╣реИ рдпрд╛ рдирд╣реАрдВред

### рдкрд╣рдЪрд╛рдирдирд╛

рдЕрдЧрд▓реА рдЫрд╡рд┐ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрдерд┐рд░рд╛рдВрдХ **0x9E3779B9** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рд╕реНрдерд┐рд░рд╛рдВрдХ рдЕрдиреНрдп рдХреНрд░рд┐рдкреНрдЯреЛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЬреИрд╕реЗ **TEA** -Tiny Encryption Algorithm рджреНрд╡рд╛рд░рд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред\
рд▓реВрдк рдХрд╛ **рдЖрдХрд╛рд░** (**132**) рдФрд░ **рдбрд┐рд╕рдЕрд╕реНрд╕реЗрдореНрдмрд▓реА** рдирд┐рд░реНрджреЗрд╢реЛрдВ рдореЗрдВ **XOR рд╕рдВрдЪрд╛рд▓рди рдХреА рд╕рдВрдЦреНрдпрд╛** рдФрд░ **рдХреЛрдб** рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рднреА рдзреНрдпрд╛рди рджреЗрдВ:

![](<../../.gitbook/assets/image (381).png>)

рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЗрд╕ рдХреЛрдб рдХреЛ рдХрд┐рд╕реА рднреА рдбрд┐рдХрдВрдкрд╛рдЗрд▓рд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ **рдмрд╣реБрдд рд▓рдВрдмреЗ рдлрд╝рдВрдХреНрд╢рди** рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рдЕрдВрджрд░ **рдХреЛрдИ рдХреВрдж рдирд╣реАрдВ рд╣реИ**ред рдбрд┐рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (382).png>)

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ **рдЬрд╛рджреБрдИ рд╕рдВрдЦреНрдпрд╛** рдФрд░ **рдкреНрд░рд╛рд░рдВрднрд┐рдХ XORs** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ, рдПрдХ **рдмрд╣реБрдд рд▓рдВрдмреЗ рдлрд╝рдВрдХреНрд╢рди** рдХреЛ рджреЗрдЦрдирд╛ рдФрд░ **рдХреБрдЫ рдирд┐рд░реНрджреЗрд╢реЛрдВ** рдХреА рддреБрд▓рдирд╛ рдХрд░рдирд╛ **рдПрдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди** (рдЬреИрд╕реЗ 7 рджреНрд╡рд╛рд░рд╛ рдмрд╛рдИрдВ рдУрд░ рд╢рд┐рдлреНрдЯ рдХрд░рдирд╛ рдФрд░ 22 рджреНрд╡рд╛рд░рд╛ рдмрд╛рдИрдВ рдУрд░ рдШреБрдорд╛рдирд╛) рдХреЗ рд╕рд╛рдеред

## RSA **(Asymmetric Crypt)**

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* рд╕рдордорд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓
* рдХреЛрдИ рд╕реНрдерд┐рд░рд╛рдВрдХ рдирд╣реАрдВ! (рдХрд╕реНрдЯрдо рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдХрдард┐рди рд╣реИ)
* KANAL (рдПрдХ рдХреНрд░рд┐рдкреНрдЯреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ) RSA рдкрд░ рд╕рдВрдХреЗрдд рджрд┐рдЦрд╛рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд░рд╣рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд╕реНрдерд┐рд░рд╛рдВрдХреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

### рддреБрд▓рдирд╛ рджреНрд╡рд╛рд░рд╛ рдкрд╣рдЪрд╛рдирдирд╛

![](<../../.gitbook/assets/image (383).png>)

* рд▓рд╛рдЗрди 11 (рдмрд╛рдИрдВ рдУрд░) рдореЗрдВ `+7) >> 3` рд╣реИ рдЬреЛ рд▓рд╛рдЗрди 35 (рджрд╛рдИрдВ рдУрд░) рдореЗрдВ рд╕рдорд╛рди рд╣реИ: `+7) / 8`
* рд▓рд╛рдЗрди 12 (рдмрд╛рдИрдВ рдУрд░) рдпрд╣ рдЬрд╛рдВрдЪ рд░рд╣реА рд╣реИ рдХрд┐ `modulus_len < 0x040` рдФрд░ рд▓рд╛рдЗрди 36 (рджрд╛рдИрдВ рдУрд░) рдпрд╣ рдЬрд╛рдВрдЪ рд░рд╣реА рд╣реИ рдХрд┐ `inputLen+11 > modulusLen`

## MD5 & SHA (hash)

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* 3 рдлрд╝рдВрдХреНрд╢рди: Init, Update, Final
* рд╕рдорд╛рди рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдлрд╝рдВрдХреНрд╢рди

### рдкрд╣рдЪрд╛рдиреЗрдВ

**Init**

рдЖрдк рд╕реНрдерд┐рд░рд╛рдВрдХреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рджреЛрдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ sha\_init рдореЗрдВ 1 рд╕реНрдерд┐рд░рд╛рдВрдХ рд╣реИ рдЬреЛ MD5 рдореЗрдВ рдирд╣реАрдВ рд╣реИ:

![](<../../.gitbook/assets/image (385).png>)

**MD5 Transform**

рдЕрдзрд┐рдХ рд╕реНрдерд┐рд░рд╛рдВрдХреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ

![](<../../.gitbook/assets/image (253) (1) (1) (1).png>)

## CRC (hash)

* рдпрд╣ рдЫреЛрдЯрд╛ рдФрд░ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХрд╛ рдХрд╛рд░реНрдп рдбреЗрдЯрд╛ рдореЗрдВ рдЖрдХрд╕реНрдорд┐рдХ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдЦреЛрдЬрдирд╛ рд╣реИ
* рд╕реНрдерд┐рд░рд╛рдВрдХ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП lookup tables рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ

### рдкрд╣рдЪрд╛рдиреЗрдВ

**lookup table constants** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (387).png>)

рдПрдХ CRC рд╣реИрд╢ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (386).png>)

## APLib (Compression)

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рд╕реНрдерд┐рд░рд╛рдВрдХ рдирд╣реАрдВ
* рдЖрдк рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдкрд╛рдпрдерди рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдФрд░ рдСрдирд▓рд╛рдЗрди рд╕рдорд╛рди рдЪреАрдЬреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

### рдкрд╣рдЪрд╛рдиреЗрдВ

рдЧреНрд░рд╛рдлрд╝ рдХрд╛рдлреА рдмрдбрд╝рд╛ рд╣реИ:

![](<../../.gitbook/assets/image (207) (2) (1).png>)

рдЗрд╕реЗ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП **3 рддреБрд▓рдирд╛** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (384).png>)

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
