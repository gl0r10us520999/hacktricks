{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ GCP рд╣реИрдХрд┐рдВрдЧ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк

рдПрдХ рд╣рдорд▓рд╛рд╡рддрд╛ **рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдХреЛ рдмрджрд▓рдиреЗ** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦ рд╕рдХрддрд╛ рд╣реИред\
рдПрдордПрдлрдЯреА рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рдХреЛ рдЦреЛрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖рддрд╛ `$STANDARD_INFORMATION` __ рдФрд░ __ `$FILE_NAME` рдореЗрдВ рд╣реИрдВред

рджреЛрдиреЛрдВ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ 4 рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рд░рдЦрддреА рд╣реИрдВ: **рд╕рдВрд╢реЛрдзрди**, **рдкрд╣реБрдВрдЪ**, **рдирд┐рд░реНрдорд╛рдг**, рдФрд░ **рдПрдордПрдлрдЯреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрд╢реЛрдзрди** (MACE рдпрд╛ MACB)ред

**Windows рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░** рдФрд░ рдЕрдиреНрдп рдЙрдкрдХрд░рдг **`$STANDARD_INFORMATION`** рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рддреЗ рд╣реИрдВред

## рдЯрд╛рдЗрдорд╕реНрдЯреЙрдореНрдк - рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреВрд▓

рдпрд╣ рдЯреВрд▓ **`$STANDARD_INFORMATION`** рдХреЗ рднреАрддрд░ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рддрд╛ рд╣реИ **рд▓реЗрдХрд┐рди** **`$FILE_NAME`** рдХреЗ рднреАрддрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рдирд╣реАрдВ**ред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

## Usnjrnl

**USN рдЬрд░реНрдирд▓** (рдЕрдкрдбреЗрдЯ рд╕реАрдХреНрд╡реЗрдВрд╕ рдирдВрдмрд░ рдЬрд░реНрдирд▓) рдПрдирдЯреАрдПрдлрдПрд╕ (рд╡рд┐рдВрдбреЛрдЬ рдПрдирдЯреА рдПрдлрдПрд╕ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо) рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЙрд▓реНрдпреВрдо рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдкрддрд╛ рд░рдЦрддреА рд╣реИред [**UsnJrnl2Csv**](https://github.com/jschicht/UsnJrnl2Csv) рдЯреВрд▓ рдЗрди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (449).png>)

рдкрд┐рдЫрд▓реА рдЫрд╡рд┐ рдЯреВрд▓ рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдИ рдЧрдИ **рдЖрдЙрдЯрдкреБрдЯ** рд╣реИ рдЬрд╣рд╛рдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ **рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рдереЗ** рдлрд╝рд╛рдЗрд▓ рдореЗрдВред

## $LogFile

рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рднреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓реЙрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ [рд░рд╛рдЗрдЯ-рдЕрд╣реЗрдб рд▓реЙрдЧрд┐рдВрдЧ](https://en.wikipedia.org/wiki/Write-ahead_logging) рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓реЙрдЧ рдХрд┐рдП рдЧрдП рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ `**$LogFile**` рдирд╛рдордХ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдирдЯреАрдПрдлрдПрд╕ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдореВрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред [LogFileParser](https://github.com/jschicht/LogFileParser) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (450).png>)

рдлрд┐рд░ рд╕реЗ, рдЙрдкрдХрд░рдг рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХреБрдЫ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рдереЗ**ред

рдЗрд╕реА рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рдХреЛ **рдХрд┐рд╕ рд╕рдордп рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:

![](<../../.gitbook/assets/image (451).png>)

* CTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╕рдордп
* ATIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╕рдВрд╢реЛрдзрди рд╕рдордп
* MTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдПрдордПрдлрдЯреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрд╢реЛрдзрди
* RTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрд╣реБрдВрдЪ рд╕рдордп

## `$STANDARD_INFORMATION` рдФрд░ `$FILE_NAME` рддреБрд▓рдирд╛

рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рджреЛрдиреЛрдВ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдкрд░ рд╕рдордп рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ рдФрд░ **рдорд┐рд▓рд╛рди** рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ **рдЕрд╕рдВрдЧрддрд┐рдпрд╛рдБ**ред

## рдиреИрдиреЛрд╕реЗрдХрдВрдб

**рдПрдирдЯреАрдПрдлрдПрд╕** рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рдХрд╛ рдПрдХ **рдкреНрд░реЗрд╕рд┐рдЬрди** рд╣реИ **100 рдиреИрдиреЛрд╕реЗрдХрдВрдб**ред рдлрд┐рд░, 2010-10-10 10:10:**00.000:0000 рдЬреИрд╕реЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдирд╛ рдмрд╣реБрдд рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рд╣реИ**ред

## SetMace - рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреВрд▓

рдпрд╣ рдЙрдкрдХрд░рдг рджреЛрдиреЛрдВ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ `$STARNDAR_INFORMATION` рдФрд░ `$FILE_NAME` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, Windows Vista рд╕реЗ, рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд╛рдЗрд╡ рдУрдПрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

# рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдирд╛

рдПрдирдПрдлрдЯреАрдПрд╕ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдФрд░ рдиреНрдпреВрдирддрдо рдЬрд╛рдирдХрд╛рд░реА рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдФрд░ рдЖрдзрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рддреЛ **рд╢реЗрд╖ рдЖрдзрд╛ рдХрднреА рднреА рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрдЧрд╛** рдЬрдм рддрдХ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рддреАред рдлрд┐рд░, рдЗрд╕ "рдЫреБрдкреА" рдЬрдЧрд╣ рдореЗрдВ рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред

рдЗрд╕ рддрд░рд╣ рдХреЗ "рдЫреБрдкреЗ" рд╕реНрдерд╛рди рдореЗрдВ рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдг рдЬреИрд╕реЗ slacker рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, `$logfile` рдФрд░ `$usnjrnl` рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рджрд┐рдЦрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдбреЗрдЯрд╛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛:

![](<../../.gitbook/assets/image (452).png>)

рдлрд┐рд░, FTK рдЗрдореЗрдЬрд░ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЫреБрдкреЗ рд╕реНрдерд╛рди рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдХрд░рдг рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрд╕реНрдкрд╖реНрдЯ рдпрд╛ рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рднреА рд╕рд╣реЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред

# UsbKill

рдпрд╣ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ **USB** рдкреЛрд░реНрдЯ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рдбрд┐рдЯреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рддреЛ рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ред\
рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдЬрд╛рдВрдЪ** рдХрд░реЗрдВред

# рд▓рд╛рдЗрд╡ рд▓рд┐рдирдХреНрд╕ рд╡рд┐рддрд░рдг

рдпреЗ рдбрд┐рд╕реНрдЯреНрд░реЛ **рд░реИрдо** рдореЗрдореЛрд░реА рдХреЗ рдЕрдВрджрд░ **рдЪрд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ**ред рдЗрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реИ **рдпрджрд┐ рдПрдирдЯреАрдПрдлрдПрд╕ рдлрд╛рдЗрд▓-рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред рдпрджрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЙрдкрджреНрд░рд╡ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред

# рд╕реБрд░рдХреНрд╖рд┐рдд рдорд┐рдЯрд╛рдирд╛

[https://github.com/Claudio-C/awesome-data-sanitization](https://github.com/Claudio-C/awesome-data-sanitization)

# рд╡рд┐рдВрдбреЛрдЬ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдХрдард┐рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╡рд┐рдВрдбреЛрдЬ рд▓реЙрдЧрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

## рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ - UserAssist

рдпрд╣ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рд╣реИ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬрдм рддрд╛рд░реАрдЦ рдФрд░ рд╕рдордп рдмрдирд╛рдП рд░рдЦрддреА рд╣реИред

UserAssist рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ
## рд╣рдЯрд╛рдПрдВ USB рдЗрддрд┐рд╣рд╛рд╕

рд╕рднреА **USB рдбрд┐рд╡рд╛рдЗрд╕ рдПрдВрдЯреНрд░реАрдЬ** Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ **USBSTOR** рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреЗ рддрд╣рдд рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЙрдк-рдХреБрдВрдЬреА рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЬрдм рднреА рдЖрдк рдЕрдкрдиреЗ PC рдпрд╛ рд▓реИрдкрдЯреЙрдк рдореЗрдВ USB рдбрд┐рд╡рд╛рдЗрд╕ рдкреНрд▓рдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВред рдЖрдк рдЗрд╕ рдХреБрдВрдЬреА рдХреЛ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR`ред **рдЗрд╕реЗ рд╣рдЯрд╛рдиреЗ** рд╕реЗ рдЖрдк USB рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗред\
рдЖрдк рдЗрд╕реЗ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг [**USBDeview**](https://www.nirsoft.net/utils/usb_devices_view.html) рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред

рдПрдХ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдЬреЛ USBs рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рд╣реЗрдЬрддреА рд╣реИ рд╡рд╣ рд╣реИ `setupapi.dev.log` рдЬреЛ `C:\Windows\INF` рдХреЗ рдЕрдВрджрд░ рд╣реЛрддреА рд╣реИред рдЗрд╕реЗ рднреА рд╣рдЯрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

## рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

`vssadmin list shadowstorage` рдХреЗ рд╕рд╛рде рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреА **рд╕реВрдЪреА** рдмрдирд╛рдПрдВ\
рдЙрдиреНрд╣реЗрдВ рд░рди рдХрд░рдХреЗ `vssadmin delete shadow` рдХреЛ **рд╣рдЯрд╛рдПрдВ**

рдЖрдк GUI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП [https://www.ubackup.com/windows-10/how-to-delete-shadow-copies-windows-10-5740.html](https://www.ubackup.com/windows-10/how-to-delete-shadow-copies-windows-10-5740.html) рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред

рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рд╕реЗ рдЪрд░рдг](https://support.waters.com/KB_Inf/Other/WKB15560_How_to_disable_Volume_Shadow_Copy_Service_VSS_in_Windows):

1. "рд╕реЗрд╡рд╛рдПрдВ" рдХрд╛рд░реНрдпрдХреНрд░рдо рдЦреЛрд▓реЗрдВ рдЬрд┐рд╕реЗ рд╡рд┐рдВрдбреЛрдЬ рд╕реНрдЯрд╛рд░реНрдЯ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж "рд╕реЗрд╡рд╛рдПрдВ" рд▓рд┐рдЦрдХрд░ рдЯреЗрдХреНрд╕реНрдЯ рдЦреЛрдЬ рдмреЙрдХреНрд╕ рдореЗрдВ рдЯрд╛рдЗрдк рдХрд░рдХреЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред
2. рд╕реВрдЪреА рд╕реЗ "рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА" рдвреВрдВрдвреЗрдВ, рдЗрд╕реЗ рдЪреБрдиреЗрдВ, рдФрд░ рдлрд┐рд░ рд░рд╛рдЗрдЯ-рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рддрдХ рдкрд╣реБрдВрдЪреЗрдВред
3. "рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкреНрд░рдХрд╛рд░" рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдиреВ рд╕реЗ "рдбрд┐рд╕реЗрдмрд▓реНрдб" рдЪреБрдиреЗрдВ, рдФрд░ рдлрд┐рд░ рдмрджрд▓рд╛рд╡ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "рдПрдкреНрд▓рд╛рдИ" рдФрд░ "рдУрдХреЗ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ `HKLM\SYSTEM\CurrentControlSet\Control\BackupRestore\FilesNotToSnapshot` рдореЗрдВ рдХреМрди рд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢реИрдбреЛ рдХреЙрдкреА рдореЗрдВ рдХреЙрдкреА рдХреА рдЬрд╛рдПрдВрдЧреА рдЙрдирдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

## рд╣рдЯрд╛рдПрдВ рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЗрдВ

* рдЖрдк рдПрдХ **Windows рдЙрдкрдХрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `cipher /w:C` рдпрд╣ cipher рдХреЛ рд╕реА рдбреНрд░рд╛рдЗрд╡ рдХреЗ рдЙрдкрд▓рдмреНрдз рдЕрдкреНрд░рдпреБрдХреНрдд рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рд╕реЗ рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ред
* рдЖрдк [**Eraser**](https://eraser.heidi.ie) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

## рд╣рдЯрд╛рдПрдВ рд╡рд┐рдВрдбреЛрдЬ рдШрдЯрдирд╛ рд▓реЙрдЧ

* рд╡рд┐рдВрдбреЛрдЬ + R --> eventvwr.msc --> "рд╡рд┐рдВрдбреЛрдЬ рд▓реЙрдЧ" рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░реЗрдВ --> рдкреНрд░рддреНрдпреЗрдХ рд╢реНрд░реЗрдгреА рдкрд░ рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ "рдХреНрд▓рд┐рдпрд░ рд▓реЙрдЧ" рдЪреБрдиреЗрдВ
* `for /F "tokens=*" %1 in ('wevtutil.exe el') DO wevtutil.exe cl "%1"`
* `Get-EventLog -LogName * | ForEach { Clear-EventLog $_.Log }`

## рд╡рд┐рдВрдбреЛрдЬ рдШрдЯрдирд╛ рд▓реЙрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

* `reg add 'HKLM\SYSTEM\CurrentControlSet\Services\eventlog' /v Start /t REG_DWORD /d 4 /f`
* рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рднреАрддрд░ рд╕реЗрд╡рд╛ "рд╡рд┐рдВрдбреЛрдЬ рдШрдЯрдирд╛ рд▓реЙрдЧ" рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ
* `WEvtUtil.exec clear-log` рдпрд╛ `WEvtUtil.exe cl`

## $UsnJrnl рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

* `fsutil usn deletejournal /d c:`

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
