# Wireshark tricks

## Wireshark tricks

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреА **рд╡рд┐рдЬреНрдЮрд╛рдкрдирд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ HackTricks** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдЕрдкрдиреА Wireshark рдХреМрд╢рд▓ рдХреНрд╖рдорддрд╛рдПрдБ рд╕реБрдзрд╛рд░реЗрдВ

### рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреБрдЫ рд╢рд╛рдирджрд╛рд░ рдореВрд▓рднреВрдд рдЯреНрд░рд┐рдХреНрд╕ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ:

* [https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/](https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/)
* [https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/](https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/)
* [https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/](https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/)
* [https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/](https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/)

### рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реВрдЪрдирд╛

_**рд╡рд┐рд╢реНрд▓реЗрд╖рдг** --> **рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реВрдЪрдирд╛**_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ рдЖрдкрдХреЛ рдкреИрдХреЗрдЯреНрд╕ рдореЗрдВ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдХрд╛ **рдЕрд╡рд▓реЛрдХрди** рдорд┐рд▓реЗрдЧрд╛:

![](<../../../.gitbook/assets/image (570).png>)

**рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрддреЗ**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрддреЗ**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рдХрдИ **рд╕реВрдЪрдирд╛рдПрдВ** рдорд┐рд▓реЗрдВрдЧреА рдЬреЛ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рджреНрд╡рд╛рд░рд╛ "**рд╕рдВрдХреНрд╖реЗрдкрд┐рдд**" рдХреА рдЧрдИ рдереАрдВ, рдЬреИрд╕реЗ рдкреЛрд░реНрдЯ/рдкрд░рд┐рд╡рд╣рди рд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓, MAC рд╕реЗ рдирд┐рд░реНрдорд╛рддрд╛ рдЖрджрд┐ред рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдХреНрдпрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдпрд╣ рдЬрд╛рдирдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИред

![](<../../../.gitbook/assets/image (571).png>)

**рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡рд░реНрдЧреАрдХрд░рдг**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡рд░реНрдЧреАрдХрд░рдг**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ **рдкреНрд░реЛрдЯреЛрдХреЙрд▓** рдорд┐рд▓реЗрдВрдЧреЗ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ред

![](<../../../.gitbook/assets/image (572).png>)

**рдмрд╛рддрдЪреАрддреЗрдВ**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> рдмрд╛рддрдЪреАрддреЗрдВ**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдмрд╛рддрдЪреАрддреЛрдВ рдХрд╛ **рд╕рд╛рд░рд╛рдВрд╢** рдорд┐рд▓реЗрдЧрд╛ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ред

![](<../../../.gitbook/assets/image (573).png>)

**рдЕрдВрдд рд╕реНрдерд▓**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> рдЕрдВрдд рд╕реНрдерд▓**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдЕрдВрдд рд╕реНрдерд▓реЛрдВ рдХрд╛ **рд╕рд╛рд░рд╛рдВрд╢** рдорд┐рд▓реЗрдЧрд╛ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ред

![](<../../../.gitbook/assets/image (575).png>)

**DNS рдЬрд╛рдирдХрд╛рд░реА**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> DNS**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП DNS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╛рдВрдЦреНрдпрд┐рдХреА рдорд┐рд▓реЗрдЧреАред

![](<../../../.gitbook/assets/image (577).png>)

**I/O рдЧреНрд░рд╛рдл**

_**рд╕рд╛рдВрдЦреНрдпрд┐рдХреА --> I/O рдЧреНрд░рд╛рдл**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рдПрдХ **рд╕рдВрдЪрд╛рд░ рдХрд╛ рдЧреНрд░рд╛рдл** рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (574).png>)

### рдлрд╝рд┐рд▓реНрдЯрд░

рдпрд╣рд╛рдБ рдЖрдк рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдлрд╝рд┐рд▓реНрдЯрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://www.wireshark.org/docs/dfref/](https://www.wireshark.org/docs/dfref/)\
рдЕрдиреНрдп рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рд┐рд▓реНрдЯрд░:

* `(http.request or ssl.handshake.type == 1) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ + TCP SYN
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002 or dns) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ + TCP SYN + DNS рдЕрдиреБрд░реЛрдз

### рдЦреЛрдЬ

рдЕрдЧрд░ рдЖрдк рд╕рддреНрд░реЛрдВ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдореЗрдВ **рд╕рд╛рдордЧреНрд░реА** рдХреА **рдЦреЛрдЬ** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ _CTRL+f_ рджрдмрд╛рдПрдВред рдЖрдк рдореБрдЦреНрдп рд╕реВрдЪрдирд╛ рдкрдЯреНрдЯреА рдореЗрдВ рдирдИ рд▓реЗрдпрд░ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ (рд╕рдВрдЦреНрдпрд╛, рд╕рдордп, рд╕реНрд░реЛрдд, рдЖрджрд┐) рджрд╛рдПрдВ рдмрдЯрди рджрдмрд╛рдХрд░ рдФрд░ рдлрд┐рд░ рд╕рдВрдкрд╛рджрди рд╕реНрддрдВрдн рджрдмрд╛рдХрд░ред

### рдореБрдлреНрдд pcap рд▓реИрдмреНрд╕

**рдореБрдлреНрдд рдЪреБрдиреМрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: [https://www.malware-traffic-analysis.net/](https://www.malware-traffic-analysis.net)**

## рдбреЛрдореЗрдиреНрд╕ рдХреА рдкрд╣рдЪрд╛рди

рдЖрдк рдПрдХ рд╕реНрддрдВрдн рдЬреЛ рд╣реЛрд╕реНрдЯ HTTP рд╣реЗрдбрд░ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../../.gitbook/assets/image (403).png>)

рдФрд░ рдПрдХ рд╕реНрддрдВрдн рдЬреЛ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдХрдиреЗрдХреНрд╢рди рд╕реЗ рд╕рд░реНрд╡рд░ рдирд╛рдо рдЬреЛрдбрд╝рддрд╛ рд╣реИ (**ssl.handshake.type == 1**):

![](<../../../.gitbook/assets/image (408) (1).png>)

## рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреА рдкрд╣рдЪрд╛рди

### DHCP рд╕реЗ

рд╡рд░реНрддрдорд╛рди Wireshark рдореЗрдВ `bootp` рдХреА рдмрдЬрд╛рдп `DHCP` рдХреА рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрдЧреА

![](<../../../.gitbook/assets/image (404).png>)

### NBNS рд╕реЗ

![](<../../../.gitbook/assets/image (405).png>)

## TLS рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

### рд╕рд░реНрд╡рд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

_edit>preference>protocol>ssl>_

![](<../../../.gitbook/assets/image (98).png>)

_Edit_ рджрдмрд╛рдПрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рдЬреЛрдбрд╝реЗрдВ (_IP, рдкреЛрд░реНрдЯ, рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдХреБрдВрдЬреА рдлрд╝рд╛рдЗрд▓ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб_)

### рд╕рдордорд┐рдд рд╕рддреНрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

рдлрд╛рдпрд░рдлреЙрдХреНрд╕ рдФрд░ рдХреНрд░реЛрдо рджреЛрдиреЛрдВ рдХреЗ рдкрд╛рд╕ TLS рд╕рддреНрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ Wireshark рдХреЗ рд╕рд╛рде рдЯреНрд░рд╛рдВрд╕рдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрдЪрд╛рд░ рдХрд╛ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕ рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдПрдХ рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдореЗрдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ [Red Flag Security](https://redflagsecurity.net/2019/03/10/decrypting-tls-wireshark/).

рдЗрд╕реЗ рдбрд┐рдЯреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ `SSLKEYLOGFILE` рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ

рдПрдХ рд╕рд╛рдЭрд╛ рдХреБрдВрдЬреА рдХреА рдлрд╝рд╛рдЗрд▓ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧреА:

![](<../../../.gitbook/assets/image (99).png>)

рдЗрд╕реЗ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдореЗрдВ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдПрдВ \_edit > preference > protocol > ssl > рдФрд░ рдЗрд╕реЗ (рдкреВрд░реНрд╡)-рдорд╛рд╕реНрдЯрд░-рд╕реАрдХреНрд░реЗрдЯ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ:

![](<../../../.gitbook/assets/image (100).png>)

## ADB рд╕рдВрдЪрд╛рд░

рдЬрд╣рд╛рдВ APK рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛, рд╡рд╣рд╛рдВ рд╕реЗ ADB рд╕рдВрдЪрд╛рд░ рд╕реЗ APK рдирд┐рдХрд╛рд▓реЗрдВ:
```python
from scapy.all import *

pcap = rdpcap("final2.pcapng")

def rm_data(data):
splitted = data.split(b"DATA")
if len(splitted) == 1:
return data
else:
return splitted[0]+splitted[1][4:]

all_bytes = b""
for pkt in pcap:
if Raw in pkt:
a = pkt[Raw]
if b"WRTE" == bytes(a)[:4]:
all_bytes += rm_data(bytes(a)[24:])
else:
all_bytes += rm_data(bytes(a))
print(all_bytes)

f = open('all_bytes.data', 'w+b')
f.write(all_bytes)
f.close()
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
