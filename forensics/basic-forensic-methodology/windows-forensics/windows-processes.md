{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## smss.exe

**–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—ñ–π**.\
–°–µ—Å—ñ—è 0 –∑–∞–ø—É—Å–∫–∞—î **csrss.exe** —Ç–∞ **wininit.exe** (**—Å–µ—Ä–≤—ñ—Å–∏ –û–°**), —Ç–æ–¥—ñ —è–∫ –°–µ—Å—ñ—è 1 –∑–∞–ø—É—Å–∫–∞—î **csrss.exe** —Ç–∞ **winlogon.exe** (**—Å–µ—Å—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**). –û–¥–Ω–∞–∫ –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±–∞—á–∏—Ç–∏ **–ª–∏—à–µ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å** —Ü—å–æ–≥–æ **–±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É** –±–µ–∑ –¥–æ—á—ñ—Ä–Ω—ñ—Ö —É –¥–µ—Ä–µ–≤—ñ –ø—Ä–æ—Ü–µ—Å—ñ–≤.

–ö—Ä—ñ–º —Ç–æ–≥–æ, —Å–µ—Å—ñ—ó, –≤—ñ–¥–º—ñ–Ω–Ω—ñ –≤—ñ–¥ 0 —ñ 1, –º–æ–∂—É—Ç—å –æ–∑–Ω–∞—á–∞—Ç–∏, —â–æ –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è RDP —Å–µ—Å—ñ—ó.


## csrss.exe

**–ü—Ä–æ—Ü–µ—Å –ø—ñ–¥—Å–∏—Å—Ç–µ–º–∏ –∫–ª—ñ—î–Ω—Ç/—Å–µ—Ä–≤–µ—Ä**.\
–í—ñ–Ω —É–ø—Ä–∞–≤–ª—è—î **–ø—Ä–æ—Ü–µ—Å–∞–º–∏** —Ç–∞ **–ø–æ—Ç–æ–∫–∞–º–∏**, —Ä–æ–±–∏—Ç—å **API Windows** –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è —ñ–Ω—à–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, –∞ —Ç–∞–∫–æ–∂ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –ª—ñ—Ç–µ—Ä–∏ –¥–∏—Å–∫—ñ–≤**, —Å—Ç–≤–æ—Ä—é—î **—Ç–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏** —Ç–∞ –æ–±—Ä–æ–±–ª—è—î **–ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏**.

–Ñ –æ–¥–∏–Ω **–∑–∞–ø—É—â–µ–Ω–∏–π —É –°–µ—Å—ñ—ó 0 —ñ —â–µ –æ–¥–∏–Ω —É –°–µ—Å—ñ—ó 1** (—Ç–æ–±—Ç–æ **2 –ø—Ä–æ—Ü–µ—Å–∏** –≤ –¥–µ—Ä–µ–≤—ñ –ø—Ä–æ—Ü–µ—Å—ñ–≤). –©–µ –æ–¥–∏–Ω —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è **–¥–ª—è –Ω–æ–≤–æ—ó —Å–µ—Å—ñ—ó**.


## winlogon.exe

**–ü—Ä–æ—Ü–µ—Å –≤—Ö–æ–¥—É –≤ Windows**.\
–í—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ **–≤—Ö—ñ–¥**/**–≤–∏—Ö—ñ–¥** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –ó–∞–ø—É—Å–∫–∞—î **logonui.exe** –¥–ª—è –∑–∞–ø–∏—Ç—É —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—è, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î **lsass.exe** –¥–ª—è —ó—Ö –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏.

–ü–æ—Ç—ñ–º –∑–∞–ø—É—Å–∫–∞—î **userinit.exe**, —è–∫–∏–π –≤–∫–∞–∑–∞–Ω–∏–π —É **`HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon`** –∑ –∫–ª—é—á–µ–º **Userinit**.

–ö—Ä—ñ–º —Ç–æ–≥–æ, –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–µ—î—Å—Ç—Ä –ø–æ–≤–∏–Ω–µ–Ω –º—ñ—Å—Ç–∏—Ç–∏ **explorer.exe** –≤ –∫–ª—é—á—ñ **Shell**, —ñ–Ω–∞–∫—à–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —è–∫ **–º–µ—Ç–æ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ü–ó**.


## wininit.exe

**–ü—Ä–æ—Ü–µ—Å —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Windows**. \
–í—ñ–Ω –∑–∞–ø—É—Å–∫–∞—î **services.exe**, **lsass.exe** —Ç–∞ **lsm.exe** —É –°–µ—Å—ñ—ó 0. –ú–∞—î –±—É—Ç–∏ –ª–∏—à–µ 1 –ø—Ä–æ—Ü–µ—Å.


## userinit.exe

**–î–æ–¥–∞—Ç–æ–∫ –≤—Ö–æ–¥—É Userinit**.\
–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î **ntduser.dat –≤ HKCU** —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î **—Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, –∑–∞–ø—É—Å–∫–∞—î **—Å–∫—Ä–∏–ø—Ç–∏ –≤—Ö–æ–¥—É** —Ç–∞ **GPO**.

–í—ñ–Ω –∑–∞–ø—É—Å–∫–∞—î **explorer.exe**.


## lsm.exe

**–ú–µ–Ω–µ–¥–∂–µ—Ä –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Å–µ—Å—ñ–π**.\
–í—ñ–Ω –ø—Ä–∞—Ü—é—î –∑ smss.exe –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó —Å–µ—Å—ñ—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: –≤—Ö—ñ–¥/–≤–∏—Ö—ñ–¥, –∑–∞–ø—É—Å–∫ –æ–±–æ–ª–æ–Ω–∫–∏, –±–ª–æ–∫—É–≤–∞–Ω–Ω—è/—Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è —Ä–æ–±–æ—á–æ–≥–æ —Å—Ç–æ–ª—É —Ç–æ—â–æ.

–ü—ñ—Å–ª—è W7 lsm.exe –±—É–≤ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤—ñ—Å (lsm.dll).

–ú–∞—î –±—É—Ç–∏ –ª–∏—à–µ 1 –ø—Ä–æ—Ü–µ—Å —É W7, —ñ –∑ –Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å, —â–æ –≤–∏–∫–æ–Ω—É—î DLL.


## services.exe

**–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—é —Å–µ—Ä–≤—ñ—Å—ñ–≤**.\
–í—ñ–Ω **–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î** **—Å–µ—Ä–≤—ñ—Å–∏**, –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ —è–∫ **–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫** —Ç–∞ **–¥—Ä–∞–π–≤–µ—Ä–∏**.

–¶–µ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –ø—Ä–æ—Ü–µ—Å –¥–ª—è **svchost.exe**, **dllhost.exe**, **taskhost.exe**, **spoolsv.exe** —Ç–∞ –±–∞–≥–∞—Ç—å–æ—Ö —ñ–Ω—à–∏—Ö.

–°–µ—Ä–≤—ñ—Å–∏ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ `HKLM\SYSTEM\CurrentControlSet\Services`, —ñ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å –ø—ñ–¥—Ç—Ä–∏–º—É—î –±–∞–∑—É –¥–∞–Ω–∏—Ö —É –ø–∞–º'—è—Ç—ñ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å–µ—Ä–≤—ñ—Å–∏, —è–∫—É –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Ç–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é sc.exe.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–¥–µ—è–∫—ñ** **—Å–µ—Ä–≤—ñ—Å–∏** –±—É–¥—É—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –≤ **–ø—Ä–æ—Ü–µ—Å—ñ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ**, –∞ —ñ–Ω—à—ñ –±—É–¥—É—Ç—å **–¥—ñ–ª–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å svchost.exe**.

–ú–∞—î –±—É—Ç–∏ –ª–∏—à–µ 1 –ø—Ä–æ—Ü–µ—Å.


## lsass.exe

**–ü—ñ–¥—Å–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª—å–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏**.\
–í—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è **—Ç–æ–∫–µ–Ω—ñ–≤ –±–µ–∑–ø–µ–∫–∏**. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–∞–∫–µ—Ç–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ `HKLM\System\CurrentControlSet\Control\Lsa`.

–í—ñ–Ω –∑–∞–ø–∏—Å—É—î –≤ **–∂—É—Ä–Ω–∞–ª –ø–æ–¥—ñ–π –±–µ–∑–ø–µ–∫–∏**, —ñ –º–∞—î –±—É—Ç–∏ –ª–∏—à–µ 1 –ø—Ä–æ—Ü–µ—Å.

–ú–∞–π—Ç–µ –Ω–∞ —É–≤–∞–∑—ñ, —â–æ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å —á–∞—Å—Ç–æ –∞—Ç–∞–∫—É—é—Ç—å –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤.


## svchost.exe

**–ü—Ä–æ—Ü–µ—Å –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥—É —Å–µ—Ä–≤—ñ—Å—ñ–≤**.\
–í—ñ–Ω —Ö–æ—Å—Ç–∏—Ç—å –∫—ñ–ª—å–∫–∞ DLL-—Å–µ—Ä–≤—ñ—Å—ñ–≤ –≤ –æ–¥–Ω–æ–º—É —Å–ø—ñ–ª—å–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ.

–ó–∞–∑–≤–∏—á–∞–π –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ, —â–æ **svchost.exe** –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ –ø—Ä–∞–ø–æ—Ä–æ–º `-k`. –¶–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Ç –¥–æ —Ä–µ—î—Å—Ç—Ä—É **HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost**, –¥–µ –±—É–¥–µ –∫–ª—é—á –∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, –∑–≥–∞–¥–∞–Ω–∏–º —É -k, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Å–µ—Ä–≤—ñ—Å–∏ –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤ —Ç–æ–º—É –∂ –ø—Ä–æ—Ü–µ—Å—ñ.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥: `-k UnistackSvcGroup` –∑–∞–ø—É—Å—Ç–∏—Ç—å: `PimIndexMaintenanceSvc MessagingService WpnUserService CDPUserSvc UnistoreSvc UserDataSvc OneSyncSvc`

–Ø–∫—â–æ —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–ø—Ä–∞–ø–æ—Ä `-s`** –∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, —Ç–æ–¥—ñ svchost –∑–∞–ø–∏—Ç—É—î—Ç—å—Å—è, —â–æ–± **–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ª–∏—à–µ –≤–∫–∞–∑–∞–Ω–∏–π —Å–µ—Ä–≤—ñ—Å** –≤ —Ü—å–æ–º—É –∞—Ä–≥—É–º–µ–Ω—Ç—ñ.

–ë—É–¥—É—Ç—å –∫—ñ–ª—å–∫–∞ –ø—Ä–æ—Ü–µ—Å—ñ–≤ `svchost.exe`. –Ø–∫—â–æ –∂–æ–¥–µ–Ω –∑ –Ω–∏—Ö **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∞–ø–æ—Ä `-k`**, —Ü–µ –¥—É–∂–µ –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ. –Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏—Ç–µ, —â–æ **services.exe –Ω–µ —î –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–º**, —Ü–µ —Ç–∞–∫–æ–∂ –¥—É–∂–µ –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ.


## taskhost.exe

–¶–µ–π –ø—Ä–æ—Ü–µ—Å –¥—ñ—î —è–∫ —Ö–æ—Å—Ç –¥–ª—è –ø—Ä–æ—Ü–µ—Å—ñ–≤, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∑ DLL. –í—ñ–Ω —Ç–∞–∫–æ–∂ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Å–µ—Ä–≤—ñ—Å–∏, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –∑ DLL.

–£ W8 —Ü–µ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è taskhostex.exe, –∞ –≤ W10 taskhostw.exe.


## explorer.exe

–¶–µ –ø—Ä–æ—Ü–µ—Å, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π –∑–∞ **—Ä–æ–±–æ—á–∏–π —Å—Ç—ñ–ª –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** —Ç–∞ –∑–∞–ø—É—Å–∫ —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤.

**–õ–∏—à–µ 1** –ø—Ä–æ—Ü–µ—Å –º–∞—î –±—É—Ç–∏ –∑–∞–ø—É—â–µ–Ω–∏–π **–¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —É–≤—ñ–π—à–æ–≤—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

–¶–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ **userinit.exe**, —è–∫–∏–π –º–∞—î –±—É—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π, —Ç–æ–º—É **–∂–æ–¥–µ–Ω –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π** –ø—Ä–æ—Ü–µ—Å –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –∑'—è–≤–ª—è—Ç–∏—Å—è –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.


# –í–∏—è–≤–ª–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤

* –ß–∏ –ø—Ä–∞—Ü—é—î –≤—ñ–Ω –∑ –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ —à–ª—è—Ö—É? (–ñ–æ–¥–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ Windows –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å –∑ —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è)
* –ß–∏ —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è –≤—ñ–Ω –∑ –¥–∏–≤–Ω–∏–º–∏ IP-–∞–¥—Ä–µ—Å–∞–º–∏?
* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–∏—Ñ—Ä–æ–≤—ñ –ø—ñ–¥–ø–∏—Å–∏ (–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ Microsoft –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ)
* –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–æ?
* –ß–∏ –ø—Ä–∞—Ü—é—î –ø—ñ–¥ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º SID?
* –ß–∏ —î –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –ø—Ä–æ—Ü–µ—Å –æ—á—ñ–∫—É–≤–∞–Ω–∏–º (—è–∫—â–æ —î)?
* –ß–∏ —î –¥–æ—á—ñ—Ä–Ω—ñ –ø—Ä–æ—Ü–µ—Å–∏ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º–∏? (–∂–æ–¥–Ω–æ–≥–æ cmd.exe, wscript.exe, powershell.exe..?)
