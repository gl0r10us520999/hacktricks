{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Introduction

Disponible depuis la sp√©cification Bluetooth 4.0, le BLE utilise seulement 40 canaux, couvrant la plage de 2400 √† 2483,5 MHz. En revanche, le Bluetooth traditionnel utilise 79 canaux dans cette m√™me plage.

Les appareils BLE communiquent en envoyant des **paquets de publicit√©** (**balises**), ces paquets diffusent l'existence de l'appareil BLE √† d'autres appareils √† proximit√©. Ces balises envoient parfois aussi **des donn√©es**.

L'appareil d'√©coute, √©galement appel√© appareil central, peut r√©pondre √† un paquet de publicit√© avec une **demande SCAN** envoy√©e sp√©cifiquement √† l'appareil de publicit√©. La **r√©ponse** √† ce scan utilise la m√™me structure que le paquet de **publicit√©** avec des informations suppl√©mentaires qui ne pouvaient pas tenir dans la demande de publicit√© initiale, comme le nom complet de l'appareil.

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

Le byte de pr√©ambule synchronise la fr√©quence, tandis que l'adresse d'acc√®s de quatre bytes est un **identifiant de connexion**, qui est utilis√© dans des sc√©narios o√π plusieurs appareils essaient d'√©tablir des connexions sur les m√™mes canaux. Ensuite, l'Unit√© de Donn√©es de Protocole (**PDU**) contient les **donn√©es de publicit√©**. Il existe plusieurs types de PDU ; les plus couramment utilis√©s sont ADV\_NONCONN\_IND et ADV\_IND. Les appareils utilisent le type de PDU **ADV\_NONCONN\_IND** s'ils **n'acceptent pas les connexions**, transmettant des donn√©es uniquement dans le paquet de publicit√©. Les appareils utilisent **ADV\_IND** s'ils **permettent des connexions** et **cessent d'envoyer des paquets de publicit√©** une fois qu'une **connexion** a √©t√© **√©tablie**.

## GATT

Le **Profil d'Attributs G√©n√©riques** (GATT) d√©finit comment le **dispositif doit formater et transf√©rer des donn√©es**. Lorsque vous analysez la surface d'attaque d'un appareil BLE, vous vous concentrerez souvent sur le GATT (ou GATTs), car c'est ainsi que **la fonctionnalit√© de l'appareil est d√©clench√©e** et comment les donn√©es sont stock√©es, regroup√©es et modifi√©es. Le GATT liste les caract√©ristiques, descripteurs et services d'un appareil dans un tableau sous forme de valeurs de 16 ou 32 bits. Une **caract√©ristique** est une valeur **de donn√©es** **envoy√©e** entre l'appareil central et le p√©riph√©rique. Ces caract√©ristiques peuvent avoir des **descripteurs** qui **fournissent des informations suppl√©mentaires √† leur sujet**. Les **caract√©ristiques** sont souvent **regroup√©es** dans des **services** si elles sont li√©es √† l'ex√©cution d'une action particuli√®re.

# Enumeration
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** permet d'**√©tablir** une **connexion** avec un autre appareil, de lister les **caract√©ristiques** de cet appareil et de lire et √©crire ses attributs.\
GATTTool peut lancer un shell interactif avec l'option `-I` :
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
