# Reset/Forgotten Password Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## **Wagwoord Herstel Token Lek Via Verwysing**

* Die HTTP referer kop kan die wagwoord herstel token lek as dit in die URL ingesluit is. Dit kan gebeur wanneer 'n gebruiker op 'n derdeparty-webwerf skakel nadat hy 'n wagwoord herstel aangevra het.
* **Impak**: Potensi√´le rekening oorname via Cross-Site Request Forgery (CSRF) aanvalle.
* **Eksploitatie**: Om te kontroleer of 'n wagwoord herstel token in die referer kop lek, **versoek 'n wagwoord herstel** na jou e-pos adres en **klik die herstel skakel** wat gegee is. **Moet nie jou wagwoord** onmiddellik verander nie. In plaas daarvan, **navigeer na 'n derdeparty-webwerf** (soos Facebook of Twitter) terwyl jy **die versoeke met Burp Suite onderskep**. Ondersoek die versoeke om te sien of die **referer kop die wagwoord herstel token bevat**, aangesien dit sensitiewe inligting aan derdepartye kan blootstel.
* **Verwysings**:
* [HackerOne Verslag 342693](https://hackerone.com/reports/342693)
* [HackerOne Verslag 272379](https://hackerone.com/reports/272379)
* [Wagwoord Herstel Token Lek Artikel](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Wagwoord Herstel Besmetting**

* Aanvallers kan die Host kop manipuleer tydens wagwoord herstel versoeke om die herstel skakel na 'n kwaadwillige webwerf te wys.
* **Impak**: Lei tot potensi√´le rekening oorname deur die lek van herstel tokens aan aanvallers.
* **Mitigering Stappe**:
* Valideer die Host kop teen 'n witlys van toegelate domeine.
* Gebruik veilige, bediener-kant metodes om absolute URL's te genereer.
* **Patching**: Gebruik `$_SERVER['SERVER_NAME']` om wagwoord herstel URL's te konstrueer in plaas van `$_SERVER['HTTP_HOST']`.
* **Verwysings**:
* [Acunetix Artikel oor Wagwoord Herstel Besmetting](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Wagwoord Herstel Deur Manipulasie van E-pos Parameter**

Aanvallers kan die wagwoord herstel versoek manipuleer deur addisionele e-pos parameters by te voeg om die herstel skakel te omlei.

* Voeg aanvaller se e-pos as tweede parameter by met &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Voeg aanvaller e-pos as tweede parameter by met %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Voeg aanvaller e-pos as tweede parameter by met |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Voeg aanvaller se e-pos as tweede parameter by met cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Voeg aanvaller e-pos as tweede parameter by met bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Voeg aanvaller e-pos as tweede parameter by met ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Voeg aanvaller e-pos as tweede parameter in json-array
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Mitigeringstappe**:
* Parseer en valideer e-posparameters behoorlik aan die bediener-kant.
* Gebruik voorbereide verklarings of geparametriseerde navrae om inspuitaanvalle te voorkom.
* **Verwysings**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Verandering van E-pos en Wagwoord van enige Gebruiker deur API Parameters**

* Aanvallers kan e-pos en wagwoordparameters in API-versoeke wysig om rekeningakkredite te verander.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Mitigeringstappe**:
* Verseker strenge parametervalidasie en outentikasie kontrole.
* Implementeer robuuste logging en monitering om verdagte aktiwiteite op te spoor en daarop te reageer.
* **Verwysing**:
* [Volledige rekening oorname via API parameter manipulasie](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Geen Tempo Beperking: E-pos Bombardering**

* Gebrek aan tempo beperking op wagwoord herstel versoeke kan lei tot e-pos bombardering, wat die gebruiker oorweldig met herstel e-posse.
* **Mitigeringstappe**:
* Implementeer tempo beperking gebaseer op IP adres of gebruikersrekening.
* Gebruik CAPTCHA uitdagings om outomatiese misbruik te voorkom.
* **Verwysings**:
* [HackerOne Verslag 280534](https://hackerone.com/reports/280534)

## **Vind uit hoe Wagwoord Herstel Token gegenereer word**

* Om die patroon of metode agter token generasie te verstaan, kan lei tot die voorspel of brute-forcing van tokens. Sommige opsies:
* Gebaseer op tydstempel
* Gebaseer op die gebruikers-ID
* Gebaseer op die e-pos van die gebruiker
* Gebaseer op Voornaam en Van
* Gebaseer op Geboortedatum
* Gebaseer op Kryptografie
* **Mitigeringstappe**:
* Gebruik sterk, kryptografiese metodes vir token generasie.
* Verseker voldoende ewekansigheid en lengte om voorspelbaarheid te voorkom.
* **Gereedskap**: Gebruik Burp Sequencer om die ewekansigheid van tokens te analiseer.

## **Raadbare UUID**

* As UUID's (weergawe 1) raadsbaar of voorspelbaar is, kan aanvallers dit brute-force om geldige herstel tokens te genereer. Kontroleer:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Mitigeringstappe**:
* Gebruik GUID weergawe 4 vir ewekansigheid of implementeer addisionele sekuriteitsmaatre√´ls vir ander weergawes.
* **Gereedskap**: Gebruik [guidtool](https://github.com/intruder-io/guidtool) om GUIDs te analiseer en te genereer.

## **Antwoord Manipulasie: Vervang Slegte Antwoord met Goeie Een**

* Manipuleer HTTP-antwoorde om foutboodskappe of beperkings te omseil.
* **Mitigeringstappe**:
* Implementeer bediener-kant kontroles om antwoordintegriteit te verseker.
* Gebruik veilige kommunikasiekanale soos HTTPS om man-in-the-middle aanvalle te voorkom.
* **Verwysing**:
* [Kritieke Fout in Lewende Fout Bounty Gebeurtenis](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Gebruik van Verloop Token**

* Toets of verloop tokens steeds gebruik kan word vir wagwoord herstel.
* **Mitigeringstappe**:
* Implementeer strenge token verloopbeleide en valideer token vervaldatum bediener-kant.

## **Brute Force Wagwoord Herstel Token**

* Poging om die herstel token te brute-force met gereedskap soos Burpsuite en IP-Rotator om IP-gebaseerde tempo beperkings te omseil.
* **Mitigeringstappe**:
* Implementeer robuuste tempo-beperking en rekening sluiting meganismes.
* Monitor vir verdagte aktiwiteite wat dui op brute-force aanvalle.

## **Probeer om Jou Token te Gebruik**

* Toets of 'n aanvaller se herstel token gebruik kan word saam met die slagoffer se e-pos.
* **Mitigeringstappe**:
* Verseker dat tokens aan die gebruikersessie of ander gebruikerspesifieke eienskappe gebind is.

## **Sessie Ongeldigmaking by Afmelding/Wagwoord Herstel**

* Verseker dat sessies ongeldig gemaak word wanneer 'n gebruiker afmeld of hul wagwoord herstel.
* **Mitigeringstappe**:
* Implementeer behoorlike sessiebestuur, wat verseker dat alle sessies ongeldig gemaak word by afmelding of wagwoord herstel.

## **Sessie Ongeldigmaking by Afmelding/Wagwoord Herstel**

* Herstel tokens moet 'n vervaldatum h√™ waarna hulle ongeldig word.
* **Mitigeringstappe**:
* Stel 'n redelike vervaldatum vir herstel tokens in en handhaaf dit streng bediener-kant.

## Verwysings

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om met ervare hackers en fout bounty jagters te kommunikeer!

**Hacking Inligting**\
Betrek jouself met inhoud wat die opwinding en uitdagings van hacking ondersoek

**Regte Tyd Hack Nuus**\
Bly op hoogte van die vinnig bewegende hacking w√™reld deur regte tyd nuus en insigte

**Laaste Aankondigings**\
Bly ingelig oor die nuutste fout bounties wat bekendgestel word en belangrike platform opdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Opleiding AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Opleiding GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Ondersteun HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Deel hacking truuks deur PR's in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
