# Reset/Forgotten Password Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## **Password Reset Token Leak Via Referrer**

* HTTP referer header moÅ¾e otkriti token za resetovanje lozinke ako je ukljuÄen u URL. Ovo se moÅ¾e desiti kada korisnik klikne na link treÄ‡e strane nakon Å¡to zatraÅ¾i resetovanje lozinke.
* **Impact**: Potencijalno preuzimanje naloga putem Cross-Site Request Forgery (CSRF) napada.
* **Exploitation**: Da biste proverili da li se token za resetovanje lozinke otkriva u referer header-u, **zatraÅ¾ite resetovanje lozinke** na vaÅ¡u email adresu i **kliknite na link za resetovanje** koji je dostavljen. **Ne menjajte lozinku** odmah. Umesto toga, **navigirajte na sajt treÄ‡e strane** (kao Å¡to su Facebook ili Twitter) dok **presreÄ‡ete zahteve koristeÄ‡i Burp Suite**. IstraÅ¾ite zahteve da vidite da li **referer header sadrÅ¾i token za resetovanje lozinke**, jer ovo moÅ¾e izloÅ¾iti osetljive informacije treÄ‡im stranama.
* **References**:
* [HackerOne Report 342693](https://hackerone.com/reports/342693)
* [HackerOne Report 272379](https://hackerone.com/reports/272379)
* [Password Reset Token Leak Article](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Password Reset Poisoning**

* NapadaÄi mogu manipulisati Host header-om tokom zahteva za resetovanje lozinke kako bi usmerili link za resetovanje na zloÄ‡udni sajt.
* **Impact**: Dovodi do potencijalnog preuzimanja naloga otkrivanjem tokena za resetovanje napadaÄima.
* **Mitigation Steps**:
* Validirajte Host header u odnosu na belu listu dozvoljenih domena.
* Koristite sigurne, server-side metode za generisanje apsolutnih URL-ova.
* **Patch**: Koristite `$_SERVER['SERVER_NAME']` za konstrukciju URL-ova za resetovanje lozinke umesto `$_SERVER['HTTP_HOST']`.
* **References**:
* [Acunetix Article on Password Reset Poisoning](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Password Reset By Manipulating Email Parameter**

NapadaÄi mogu manipulisati zahtevom za resetovanje lozinke dodavanjem dodatnih email parametara kako bi preusmerili link za resetovanje.

* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Dodajte email napadaÄa kao drugi parametar koristeÄ‡i ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Dodajte email napadaÄa kao drugi parametar u json nizu
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Koraci za ublaÅ¾avanje**:
* Ispravno analizirati i validirati email parametre na serverskoj strani.
* Koristiti pripremljene izjave ili parametarske upite kako bi se spreÄili napadi injekcijom.
* **Reference**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Menjanje email-a i lozinke bilo kog korisnika putem API parametara**

* NapadaÄi mogu modifikovati email i lozinku u API zahtevima kako bi promenili akreditive naloga.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Koraci za ublaÅ¾avanje**:
* Osigurati strogu validaciju parametara i provere autentifikacije.
* Implementirati robusno logovanje i praÄ‡enje kako bi se otkrile i reagovalo na sumnjive aktivnosti.
* **Reference**:
* [Potpuno preuzimanje naloga putem manipulacije API parametrima](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Bez ograniÄenja brzine: Email bombardovanje**

* Nedostatak ograniÄenja brzine na zahtevima za resetovanje lozinke moÅ¾e dovesti do bombardovanja email-ova, preplavljujuÄ‡i korisnika reset email-ovima.
* **Koraci za ublaÅ¾avanje**:
* Implementirati ograniÄenje brzine na osnovu IP adrese ili korisniÄkog naloga.
* Koristiti CAPTCHA izazove kako bi se spreÄila automatska zloupotreba.
* **Reference**:
* [HackerOne izveÅ¡taj 280534](https://hackerone.com/reports/280534)

## **Saznajte kako se generiÅ¡e token za resetovanje lozinke**

* Razumevanje obrasca ili metode iza generisanja tokena moÅ¾e dovesti do predviÄ‘anja ili brute-forcing tokena. Neke opcije:
* Na osnovu vremenskog peÄata
* Na osnovu UserID-a
* Na osnovu email-a korisnika
* Na osnovu imena i prezimena
* Na osnovu datuma roÄ‘enja
* Na osnovu kriptografije
* **Koraci za ublaÅ¾avanje**:
* Koristiti jake, kriptografske metode za generisanje tokena.
* Osigurati dovoljnu nasumiÄnost i duÅ¾inu kako bi se spreÄila predvidljivost.
* **Alati**: Koristiti Burp Sequencer za analizu nasumiÄnosti tokena.

## **Pogodna UUID**

* Ako su UUID-ovi (verzija 1) pogodivi ili predvidivi, napadaÄi mogu da ih brute-force-uju kako bi generisali vaÅ¾eÄ‡e reset tokene. Proverite:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Koraci za ublaÅ¾avanje**:
* Koristiti GUID verziju 4 za nasumiÄnost ili implementirati dodatne sigurnosne mere za druge verzije.
* **Alati**: Koristiti [guidtool](https://github.com/intruder-io/guidtool) za analizu i generisanje GUID-ova.

## **Manipulacija odgovorom: Zamenite loÅ¡ odgovor dobrim**

* Manipulacija HTTP odgovorima kako bi se zaobiÅ¡le poruke o greÅ¡ci ili ograniÄenja.
* **Koraci za ublaÅ¾avanje**:
* Implementirati provere na serverskoj strani kako bi se osigurala integritet odgovora.
* Koristiti sigurne komunikacione kanale kao Å¡to je HTTPS kako bi se spreÄili napadi "man-in-the-middle".
* **Reference**:
* [KritiÄna greÅ¡ka u Live Bug Bounty dogaÄ‘aju](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **KoriÅ¡Ä‡enje istekao tokena**

* Testiranje da li se istekao token i dalje moÅ¾e koristiti za resetovanje lozinke.
* **Koraci za ublaÅ¾avanje**:
* Implementirati stroge politike isteka tokena i validirati istekao token na serverskoj strani.

## **Brute Force token za resetovanje lozinke**

* PokuÅ¡aj brute-force-a reset tokena koristeÄ‡i alate kao Å¡to su Burpsuite i IP-Rotator kako bi se zaobiÅ¡la ograniÄenja brzine zasnovana na IP-u.
* **Koraci za ublaÅ¾avanje**:
* Implementirati robusno ograniÄenje brzine i mehanizme zakljuÄavanja naloga.
* Pratiti sumnjive aktivnosti koje ukazuju na brute-force napade.

## **PokuÅ¡ajte koristiti svoj token**

* Testiranje da li se napadaÄev reset token moÅ¾e koristiti u kombinaciji sa email-om Å¾rtve.
* **Koraci za ublaÅ¾avanje**:
* Osigurati da su tokeni vezani za korisniÄku sesiju ili druge korisniÄke atribute.

## **NevaÅ¾enje sesije prilikom odjave/resetovanja lozinke**

* Osigurati da se sesije nevaÅ¾e kada se korisnik odjavi ili resetuje svoju lozinku.
* **Koraci za ublaÅ¾avanje**:
* Implementirati pravilno upravljanje sesijama, osiguravajuÄ‡i da se sve sesije nevaÅ¾e prilikom odjave ili resetovanja lozinke.

## **NevaÅ¾enje sesije prilikom odjave/resetovanja lozinke**

* Reset tokeni bi trebali imati vreme isteka nakon kojeg postaju nevaÅ¾eÄ‡i.
* **Koraci za ublaÅ¾avanje**:
* Postaviti razumno vreme isteka za reset tokene i strogo ga sprovoditi na serverskoj strani.

## Reference

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

PridruÅ¾ite se [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) serveru kako biste komunicirali sa iskusnim hakerima i lovcima na greÅ¡ke!

**Uvidi u hakovanje**\
UkljuÄite se u sadrÅ¾aj koji se bavi uzbuÄ‘enjem i izazovima hakovanja

**Vesti o hakovanju u realnom vremenu**\
Budite u toku sa brzim svetom hakovanja kroz vesti i uvide u realnom vremenu

**Najnovija obaveÅ¡tenja**\
Budite informisani o najnovijim nagradama za greÅ¡ke i vaÅ¾nim aÅ¾uriranjima platforme

**PridruÅ¾ite nam se na** [**Discord**](https://discord.com/invite/N3FrSbmwdy) i poÄnite da saraÄ‘ujete sa vrhunskim hakerima danas!

{% hint style="success" %}
UÄite i veÅ¾bajte AWS hakovanje:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
UÄite i veÅ¾bajte GCP hakovanje: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>PodrÅ¾ite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **PridruÅ¾ite se** ğŸ’¬ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite trikove hakovanja slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
