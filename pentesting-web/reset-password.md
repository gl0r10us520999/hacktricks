# Reset/Forgotten Password Bypass

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>qa'wI'pu' (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks vItlhutlh:

* **HackTricks** vItlhutlh **tlhIngan Hol** vItlhutlh **'ej HackTricks** vItlhutlh **PDF** vItlhutlh [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) **chaw'**.
* [**PEASS & HackTricks swag**](https://peass.creator-spring.com) vItlhutlh **tlhIngan Hol** vItlhutlh **HackTricks** vItlhutlh **PEASS** vItlhutlh **NFTs** vItlhutlh [**The PEASS Family**](https://opensea.io/collection/the-peass-family) vItlhutlh **tlhIngan Hol** vItlhutlh **NFTs** vItlhutlh.
* **Discord group** vItlhutlh **qa'wI'pu'** [**Discord group**](https://discord.gg/hRep4RUj7f) **'ej** [**telegram group**](https://t.me/peass) **'ej** **Twitter** vItlhutlh **tlhIngan Hol** vItlhutlh **Twitter** vItlhutlh [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **HackTricks** vItlhutlh **HackTricks Cloud** vItlhutlh **PRs** vItlhutlh **'e'** [**HackTricks**](https://github.com/carlospolop/hacktricks) **'ej** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos** vItlhutlh **'e'** **HackerOne Report 342693** vItlhutlh [**HackerOne Report 272379**](https://hackerone.com/reports/272379) **'ej** [**Password Reset Token Leak Article**](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) **qa'wI'pu'** **Discord** **qa'wI'pu'** **'ej** **bug bounty hunters** **qa'wI'pu'**!

**Hacking Insights**\
**Hacking** **tlhIngan Hol** **Hacking** **Hacking** **Hacking** **Hacking**

**Real-Time Hack News**\
**Hacking** **Hacking** **Hacking** **Hacking** **Hacking** **Hacking**

**Latest Announcements**\
**Hacking** **Hacking** **Hacking** **Hacking** **Hacking** **Hacking**

**qa'wI'pu'** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **'ej** **qa'wI'pu'** **top hackers** **qa'wI'pu'**!

## **Password Reset Token Leak Via Referrer**
* **HTTP referer** **header** **password reset token** **leak** **URL** **'e'** **'e'**. **user** **password reset** **request** **'e'** **third-party website link** **click** **'e'**.
* **Impact**: **Cross-Site Request Forgery (CSRF)** **attack** **potential** **account takeover**.
* **References**:
- [HackerOne Report 342693](https://hackerone.com/reports/342693)
- [HackerOne Report 272379](https://hackerone.com/reports/272379)
- [Password Reset Token Leak Article](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Password Reset Poisoning**
* **Attackers** **Host header** **password reset requests** **manipulate** **reset link** **malicious site** **point**.
* **Patch**: `$_SERVER['HTTP_HOST']` **'e'** **password reset URLs** **construct** **'e'** `$_SERVER['SERVER_NAME']` **'e'**.
* **Impact**: **reset tokens** **leak** **attackers** **account takeover** **lead**.
* **Mitigation Steps**:
- **Host header** **whitelist** **allowed domains** **validate**.
- **secure**, **server-side methods** **absolute URLs** **generate** **use**.
* **References**:
- [Acunetix Article on Password Reset Poisoning](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Password Reset By Manipulating Email Parameter**
* **Attackers** **password reset request** **additional email parameters** **divert** **reset link** **manipulate**.
* **Mitigation Steps**:
- **email parameters** **parse** **validate** **server-side** **properly**.
- **injection attacks** **prevent** **statements** **prepared** **queries** **parameterized** **use**.
* **References**:
- [Readme.com Account Takeover](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Changing Email And Password of any User through API Parameters**
* **Attackers** **API requests** **email and password parameters** **modify** **account credentials** **change**.
* **Mitigation Steps**:
- **parameter validation** **authentication checks** **strict** **Ensure**.
- **suspicious activities** **detect** **respond** **robust logging and monitoring** **Implement**.
* **Reference**:
- [Full Account Takeover via API Parameter Manipulation](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **No Rate Limiting: Email Bombing**
* **password reset requests** **rate limiting** **Lack** **email bombing** **lead** **reset emails** **user** **overwhelming**.
* **Mitigation Steps**:
- **IP address** **user account** **rate limiting** **Implement**.
- **automated abuse** **prevent** **CAPTCHA challenges** **Use**.
* **References**:
- [HackerOne Report 280534](https://hackerone.com/reports/280534)

## **Find out How Password Reset Token is Generated**
* **token generation** **method** **pattern** **Understanding** **tokens** **brute-forcing** **predicting** **lead**.
* **Mitigation Steps**:
- **token generation** **cryptographic methods** **strong** **Use**.
- **predictability** **prevent** **length** **randomness** **sufficient** **Ensure**.
* **Tools**: **Burp Sequencer** **tokens** **randomness** **analyze** **Use**.

## **Guessable GUID**
* **GUIDs** (e.g., **version 1**) **guessable** **predictable** **GUIDs** **brute-force** **attackers** **valid reset tokens** **generate**.
* **Mitigation Steps**:
- **GUID version 4** **randomness** **Use** **additional security measures** **implement** **versions** **other**.
* **Tools**: **[guidtool](https://github.com/intruder-io/guidtool)** **GUIDs** **generating** **analyzing** **Use**.

## **Response Manipulation: Replace Bad Response With Good One**
* **HTTP responses** **manipulating** **error messages** **restrictions** **bypass**.
* **Mitigation Steps**:
- **response integrity** **ensure** **checks** **server-side** **Implement**.
- **man-in-the-middle attacks** **prevent** **HTTPS** **channels** **communication** **secure** **Use**.
* **Reference**:
- [Critical Bug in Live Bug Bounty Event](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Using Expired Token**
* **expired tokens** **password reset** **used** **testing**.
* **Mitigation Steps**:
- **token expiration policies** **strict** **Implement**.
- **token expiry server-side** **validate** **Ensure**.

## **Brute Force Password Reset Token**
* **reset token** **brute-force** **attempting** **tools** **Burpsuite** **IP-Rotator** **bypass** **IP-based rate limits** **using**.
* **Mitigation Steps**:
- **account lockout mechanisms** **rate-limiting** **robust** **Implement**.
- **brute-force attacks** **indicative** **activities** **suspicious** **Monitor**.

## **Try Using Your Token**
* **attacker's reset token** **victim's email** **conjunction** **used** **testing**.
* **Mitigation Steps**:
- **tokens** **user-specific attributes** **user session** **bound** **Ensure**.

## **Session Invalidation in Logout/Password Reset**
* **sessions** **invalidated** **user logs out** **password reset** **user** **when** **Ensuring**.
* **Mitigation Steps**:
- **session management** **proper** **Implement**.
- **logout** **password reset** **upon** **invalidated** **sessions** **all** **Ensure**.

## **Session Invalidation in Logout/Password Reset**
* **reset tokens** **expiration time** **tokens** **invalid** **become**.
* **Mitigation Steps**:
- **reset tokens** **expiration time** **reasonable** **Set** **server-side
## References
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
