# Dependency Confusion

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Basic Information

‡§∏‡§Ç‡§ï‡•ç‡§∑‡•á‡§™ ‡§Æ‡•á‡§Ç, ‡§è‡§ï dependency confusion vulnerability ‡§§‡§¨ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡§¨ ‡§è‡§ï ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§è‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ **‡§ó‡§≤‡§§ ‡§∏‡•ç‡§™‡•á‡§≤‡§ø‡§Ç‡§ó** ‡§®‡§æ‡§Æ, **‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§π‡•Ä‡§®** ‡§Ø‡§æ **‡§Ö‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä dependency repository **‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï** repositories ‡§∏‡•á **‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§° ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§á‡§ï‡§ü‡•ç‡§†‡§æ ‡§ï‡§∞‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡•§

* **‡§ó‡§≤‡§§ ‡§∏‡•ç‡§™‡•á‡§≤‡§ø‡§Ç‡§ó**: Import **`reqests`** instead of `requests`
* **‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§π‡•Ä‡§®**: Import `company-logging`, ‡§è‡§ï ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ú‡•ã **‡§Ö‡§¨ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à**
* **‡§Ö‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£**: Import an **internal** **existent** `company-requests` ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä, ‡§≤‡•á‡§ï‡§ø‡§® repo **‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï repos** ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§Ø‡§π ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§µ‡§π‡§æ‡§Å **‡§¨‡§°‡§º‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** ‡§π‡•à‡§Ç‡•§

## Exploitation

{% hint style="warning" %}
‡§∏‡§≠‡•Ä ‡§Æ‡§æ‡§Æ‡§≤‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï **‡§¶‡•Å‡§∑‡•ç‡§ü ‡§™‡•à‡§ï‡•á‡§ú ‡§ï‡§æ ‡§®‡§æ‡§Æ** ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à‡•§
{% endhint %}

### Misspelled & Inexistent

‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§è‡§ï **‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡•ã ‡§Ü‡§Ø‡§æ‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à ‡§ú‡•ã ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à**, ‡§§‡•ã ‡§¨‡§π‡•Å‡§§ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡§æ repo ‡§á‡§∏‡•á **‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï repositories** ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§®‡•á ‡§á‡§∏‡•á ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™‡§ï‡§æ ‡§ï‡•ã‡§° ‡§î‡§∞ ‡§ö‡§≤‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§Æ‡§∂‡•Ä‡§®‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§è‡§Ç‡§ó‡•Ä‡•§

### Unspecified Version

‡§°‡•á‡§µ‡§≤‡§™‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à ‡§ï‡§ø ‡§µ‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡§æ **‡§ï‡•ã‡§à ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á** ‡§π‡•à‡§Ç, ‡§Ø‡§æ ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï **‡§Æ‡•á‡§ú‡§∞ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§´‡§ø‡§∞, ‡§á‡§Ç‡§ü‡§∞‡§™‡•ç‡§∞‡•á‡§ü‡§∞ ‡§â‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ **‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§\
‡§Ø‡§¶‡§ø ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§è‡§ï **‡§ú‡•ç‡§û‡§æ‡§§ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä** ‡§π‡•à (‡§ú‡•à‡§∏‡•á python `requests`), ‡§§‡•ã ‡§è‡§ï **‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ**, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§µ‡§π `requests` ‡§®‡§æ‡§Æ ‡§ï‡•Ä ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§®‡§æ ‡§∏‡§ï‡•á‡§ó‡§æ (‡§ú‡§¨ ‡§§‡§ï ‡§ï‡§ø ‡§µ‡§π ‡§Æ‡•Ç‡§≤ ‡§≤‡•á‡§ñ‡§ï ‡§® ‡§π‡•ã)‡•§\
‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§Ø‡§¶‡§ø ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä **‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï** ‡§π‡•à, ‡§ú‡•à‡§∏‡•á ‡§á‡§∏ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç `requests-company`, ‡§Ø‡§¶‡§ø **‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä repo** ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á **‡§®‡§è ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ø‡§π ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§è‡§ï ‡§®‡§è ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§ó‡§æ‡•§\
‡§§‡•ã ‡§Ø‡§¶‡§ø ‡§è‡§ï **‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ú‡§æ‡§®‡§§‡§æ ‡§π‡•à** ‡§ï‡§ø ‡§ï‡§Ç‡§™‡§®‡•Ä `requests-company` ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä **‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 1.0.1** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à (‡§õ‡•ã‡§ü‡•á ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à)‡•§ ‡§µ‡§π **‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä** `requests-company` **‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 1.0.2** ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§â‡§∏ ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡§æ **‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§ó‡•Ä** ‡§¨‡§ú‡§æ‡§Ø ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡•á‡•§

## AWS Fix

‡§Ø‡§π vulnerability AWS **CodeArtifact** ‡§Æ‡•á‡§Ç ‡§™‡§æ‡§à ‡§ó‡§à ‡§•‡•Ä (‡§™‡§¢‡§º‡•á‡§Ç [**‡§á‡§∏ ‡§¨‡•ç‡§≤‡•â‡§ó ‡§™‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§µ‡§∞‡§£**](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)).\
AWS ‡§®‡•á ‡§á‡§∏‡•á ‡§á‡§∏ ‡§§‡§∞‡§π ‡§∏‡•á ‡§†‡•Ä‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ï‡§ø ‡§Ø‡§π ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§π‡•à ‡§Ø‡§æ ‡§¨‡§æ‡§π‡§∞‡•Ä, ‡§§‡§æ‡§ï‡§ø ‡§¨‡§æ‡§π‡§∞‡•Ä repositories ‡§∏‡•á ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï dependencies ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§¨‡§ö‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§

## Finding Vulnerable Libraries

[**Dependency confusion ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡•Ç‡§≤ ‡§™‡•ã‡§∏‡•ç‡§ü**](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610) ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§ñ‡§ï ‡§®‡•á ‡§π‡§ú‡§æ‡§∞‡•ã‡§Ç ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§ú‡§º ‡§ï‡§ø‡§è ‡§ó‡§è package.json ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡•Ä ‡§ú‡•ã ‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•Ä dependencies ‡§ï‡•ã ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç‡•§

## References

* [https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)
* [https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
