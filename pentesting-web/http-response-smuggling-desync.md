# HTTP Response Smuggling / Desync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рддрдХрдиреАрдХ рд╡реАрдбрд┐рдпреЛ рд╕реЗ рд▓реА рдЧрдИ рдереА:** [**https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s**](https://www.youtube.com/watch?v=suxDcYViwao\&t=1343s)

## HTTP Request Queue Desynchronisation

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рддрдХрдиреАрдХ **HTTP Request Smuggling рднреЗрджреНрдпрддрд╛** рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдирдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ:

рдЗрд╕ рддрдХрдиреАрдХ рдФрд░ рд╕рд╛рдорд╛рдиреНрдп HTTP Request smuggling рдХреЗ рдмреАрдЪ рдХрд╛ **рдореБрдЦреНрдп** **рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ **рд╣рдо рдкреАрдбрд╝рд┐рдд рдХреЗ** **рдЕрдиреБрд░реЛрдз** рдХреЛ **рдЙрд╕рдореЗрдВ рдПрдХ рдЙрдкрд╕рд░реНрдЧ рдЬреЛрдбрд╝рдХрд░** **рд╣рдорд▓рд╛** рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо **рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд▓реАрдХ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ** рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рдпрд╣ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд┐ HTTP Request smuggling рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1 рдФрд░ рдЖрдзрд╛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреЗ рдмрдЬрд╛рдп, **рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ**ред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдВрдХреНрд░рдорд┐рдд** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ рддрд╛рдХрд┐ **рдкреАрдбрд╝рд┐рдд рдХреЗ рд╡реИрдз рдЕрдиреБрд░реЛрдз** рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬреА рдЬрд╛рдП**, рдпрд╛ **рдкреАрдбрд╝рд┐рдд рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ**ред

### HTTP Pipeline Desync

HTTP/1.1 **рдкрд┐рдЫрд▓реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╛рд░ рдХрд┐рдП рдмрд┐рдирд╛ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреВрдЫрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ **рдмреАрдЪ рдореЗрдВ рдПрдХ рдкреНрд░реЙрдХреНрд╕реА** рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдХрд╛рд░реНрдп рд╣реИ рдХрд┐ рд╡рд╣ **рдмреИрдХрдПрдВрдб рдХреЛ рднреЗрдЬреЗ рдЧрдП рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдЙрд╕рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдПрдХ рд╕рдордиреНрд╡рдпрд┐рдд рдорд┐рд▓рд╛рди рдмрдирд╛рдП рд░рдЦреЗ**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдХрддрд╛рд░ рдХреЛ рдЕрд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИред рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ HTTP Response smuggling рд╣рдорд▓рд╛ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз рдФрд░ рд╕реНрдордЧрд▓реНрдб рдПрдХ** рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рддреБрд░рдВрдд рджреА рдЬрд╛рддреА рд╣реИрдВ, рддреЛ рд╕реНрдордЧрд▓реНрдб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреАрдбрд╝рд┐рдд рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдХрддрд╛рд░ рдореЗрдВ рдирд╣реАрдВ рдбрд╛рд▓реА рдЬрд╛рдПрдЧреА рдмрд▓реНрдХрд┐ **рдХреЗрд╡рд▓ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджреА рдЬрд╛рдПрдЧреА**ред

![](<../.gitbook/assets/image (633).png>)

рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ **рд╕реНрдордЧрд▓реНрдб** **рдЕрдиреБрд░реЛрдз** **рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗ**ред рдЗрд╕рд▓рд┐рдП, рдЬрдм рддрдХ рд╕реНрдордЧрд▓реНрдб рдЕрдиреБрд░реЛрдз рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддрдм рддрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

рдпрджрд┐ рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ **рдкреАрдбрд╝рд┐рдд рдиреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрд╛** рдФрд░ **рд╕реНрдордЧрд▓реНрдб рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрддреНрддрд░ рдкрд╣рд▓реЗ** рд╡реИрдз рдЕрдиреБрд░реЛрдз рд╕реЗ рджрд┐рдпрд╛ рдЧрдпрд╛, рддреЛ **рд╕реНрдордЧрд▓реНрдб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреАрдбрд╝рд┐рдд рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ **рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ "рдкреНрд░рджрд░реНрд╢рд┐рдд" рдЕрдиреБрд░реЛрдз рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдЧрд╛**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ **рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ** рдФрд░ **рдкреАрдбрд╝рд┐рдд** рдХреЗ рдЕрдиреБрд░реЛрдз рдХрд╛ **рд╡реИрдз рдЙрддреНрддрд░** **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рдкрд╣рд▓реЗ** **рдЙрддреНрддрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред **рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдЧреА**, **рдкреАрдбрд╝рд┐рдд рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЪреБрд░рд╛рддреЗ рд╣реБрдП** (рдЬрд┐рд╕рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **Set-Cookie** рд╣реЗрдбрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред

![](<../.gitbook/assets/image (1020).png>)

![](<../.gitbook/assets/image (719).png>)

### Multiple Nested Injections

рд╕рд╛рдорд╛рдиреНрдп **HTTP Request Smuggling** рдХреЗ рд╕рд╛рде рдПрдХ рдФрд░ **рджрд┐рд▓рдЪрд╕реНрдк рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐, рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╣рдорд▓реЗ рдореЗрдВ, **рд▓рдХреНрд╖реНрдп** **рдкреАрдбрд╝рд┐рдд рдХреЗ рдЕрдиреБрд░реЛрдз рдХреА рд╢реБрд░реБрдЖрдд рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛** рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХреНрд░рд┐рдпрд╛ рдХрд░реЗред рдПрдХ **HTTP Response smuggling рд╣рдорд▓реЗ** рдореЗрдВ, рдЪреВрдВрдХрд┐ рдЖрдк **рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ**, рдЖрдк **рдПрдХ рдкреЗрд▓реЛрдб рдореЗрдВ рджрд░реНрдЬрдиреЛрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рджрд░реНрдЬрдиреЛрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрд╕рдВрдХреНрд░рдорд┐рдд** рдХрд░ рд░рд╣реА рд╣реЛрдВрдЧреА рдЬреЛ **рдЗрдВрдЬреЗрдХреНрдЯ рдХреА рдЧрдИ** **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмреАрдЪ рджрд░реНрдЬрдиреЛрдВ рд╢реЛрд╖рдгреЛрдВ рдХреЛ рдЕрдзрд┐рдХ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ** рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд░реНрд╡рд░ рдореЗрдВ **DoS** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Exploit Organisation

рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ **рд╕рд░реНрд╡рд░ рдореЗрдВ рдкрд╣рд▓рд╛ рд╕реНрдордЧрд▓реНрдб рд╕рдВрджреЗрд╢** **рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗ**ред

рдпрджрд┐ рд╣рдо рдХреЗрд╡рд▓ **рдкреАрдбрд╝рд┐рдд рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЪреБрд░рд╛рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ **рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз рдкрд░реНрдпрд╛рдкреНрдд** рд╣реИред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╢реЛрд╖рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрд░рдЪрдирд╛ рд╣реЛрдЧреАред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ **HTTP** **Request** **smuggling** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП **рдкреНрд░рд╛рд░рдВрднрд┐рдХ** рдЕрдиреБрд░реЛрдз, рдлрд┐рд░ **рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз** рдФрд░ рдлрд┐рд░ **1 рдпрд╛ рдЕрдзрд┐рдХ рдкреЗрд▓реЛрдб рдЕрдиреБрд░реЛрдз** рдЬрд┐рдирдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреАрдбрд╝рд┐рддреЛрдВ рдХреЛ рднреЗрдЬреА рдЬрд╛рдПрдВрдЧреАред

## Abusing HTTP Response Queue Desynchronisation

### Capturing other users' requests <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

HTTP Request Smuggling рдЬреНрдЮрд╛рдд рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде, рдЖрдк **рдкреАрдбрд╝рд┐рдд рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рд╣реИ: рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкрд░рд╛рд╡рд░реНрддрд┐рдд рд╕рд╛рдордЧреНрд░реА рднреЗрдЬрдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, **рдХреЛрдИ рд╕реНрдерд╛рдпреА рднрдВрдбрд╛рд░рдг** рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдкреЗрд▓реЛрдб рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░** рдХреЗ рд╕рд╛рде рдПрдХ **рдЕрдВрддрд┐рдо POST рдЕрдиреБрд░реЛрдз** рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдмрдбрд╝рд╛ Content-Length рд╣реЛрддрд╛ рд╣реИред

![](<../.gitbook/assets/image (1053).png>)

рдлрд┐рд░, рдПрдХ рдмрд╛рд░ рдЬрдм **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз** (рдиреАрд▓рд╛) **рдкреНрд░рд╕рдВрд╕реНрдХреГрдд** рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ **рдЬрдм** **рдиреАрдВрдж рд╡рд╛рд▓рд╛** рдПрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдкреАрд▓рд╛) рддреЛ **рдПрдХ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз** **рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдареАрдХ рдмрд╛рдж рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛**:

![](<../.gitbook/assets/image (794).png>)

рдлрд┐рд░, **рдкреАрдбрд╝рд┐рдд** **рдиреАрдВрдж рд╡рд╛рд▓реЗ** рдЕрдиреБрд░реЛрдз рдХрд╛ **рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛** рдФрд░ рдпрджрд┐ рдЗрд╕ рдмреАрдЪ **рд╣рдорд▓рд╛рд╡рд░ рдиреЗ** **рдПрдХ рдФрд░** **рдЕрдиреБрд░реЛрдз рднреЗрдЬрд╛**, рддреЛ **рдкрд░рд╛рд╡рд░реНрддрд┐рдд рд╕рд╛рдордЧреНрд░реА рдЕрдиреБрд░реЛрдз рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЙрд╕реЗ рднреЗрдЬреА рдЬрд╛рдПрдЧреА**ред

## Response Desynchronisation

рдЕрдм рддрдХ, рд╣рдордиреЗ рд╕реАрдЦрд╛ рд╣реИ рдХрд┐ HTTP Request Smuggling рд╣рдорд▓реЛрдВ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП рддрд╛рдХрд┐ **рдЕрдиреБрд░реЛрдз** **рдЬрд┐рд╕рдХреА** **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдПрдХ **рдХреНрд▓рд╛рдЗрдВрдЯ** рдХреЛ **рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╣реИ** рдФрд░ рдЖрдк рдлрд┐рд░ **рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред

рд▓реЗрдХрд┐рди рдпрд╣ рдЕрднреА рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ **рдФрд░ рднреА рдЕрдзрд┐рдХ рдЕрд╕рдВрдХреНрд░рдорд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛рдПред

рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдЕрдиреБрд░реЛрдз рд╣реИрдВ рдЬреИрд╕реЗ **HEAD** рдЕрдиреБрд░реЛрдз рдЬреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╢рд░реАрд░ рдореЗрдВ **рдХреЛрдИ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП** рдФрд░ рдЬреЛ **рдЕрдиреБрд░реЛрдз рдХреЗ Content-Length** рдХреЛ **GET рдЕрдиреБрд░реЛрдз рдХреА рддрд░рд╣** **рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред

рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **HEAD** рдЕрдиреБрд░реЛрдз **рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЗрди рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ:

![](<../.gitbook/assets/image (1107).png>)

рдлрд┐рд░, **рдЬрдм рдиреАрд▓рд╛ рдЙрддреНрддрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдЕрдЧрд▓рд╛ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрддрд╛рд░ рдореЗрдВ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

![](<../.gitbook/assets/image (999).png>)

рдлрд┐рд░, **рдкреАрдбрд╝рд┐рдд** **HEAD** рдЕрдиреБрд░реЛрдз рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛**, рдЬреЛ **рдПрдХ Content-Length рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди рдХреЛрдИ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рд╣реЛрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдкреНрд░реЙрдХреНрд╕реА **рдЗрд╕ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЛ рдирд╣реАрдВ рднреЗрдЬреЗрдЧрд╛**, рдмрд▓реНрдХрд┐ рдХреБрдЫ **рд╕рд╛рдордЧреНрд░реА** рдХреА **рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдЧрд╛**, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ **рдкреАрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рд╣реЛрдЧреА (рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рднреА рдЗрдВрдЬреЗрдХреНрдЯ рдХреА рдЧрдИ рдереА):

![](<../.gitbook/assets/image (735).png>)

### Content Confusion

рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдЖрдк **рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд╢рд░реАрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд┐рд╕рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреАрдбрд╝рд┐рдд рдХреЛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╣реИ рдФрд░ рдХрд┐ рдПрдХ **HEAD** **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдЖрдорддреМрд░ рдкрд░ рдЕрдкрдиреЗ рд╣реЗрдбрд░ рдореЗрдВ **Content-Type рдФрд░ Content-Length** рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ, рдЖрдк **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ** рддрд╛рдХрд┐ **рдкреАрдбрд╝рд┐рдд рдореЗрдВ XSS рдЙрддреНрдкрдиреНрди рд╣реЛ** рдмрд┐рдирд╛ рдХрд┐ рдкреГрд╖реНрда XSS рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ:

![](<../.gitbook/assets/image (688).png>)

### Cache Poisoning

рдкрд╣рд▓реЗ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрд╕рдВрдХреНрд░рдордг рд╕рд╛рдордЧреНрд░реА рднреНрд░рдо рд╣рдорд▓реЗ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, **рдпрджрд┐ рдХреИрд╢ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рдЗрдВрдЬреЗрдХреНрдЯ рдХреА рдЧрдИ рд╣реИ рдЬреЛ XSS рдЙрддреНрдкрдиреНрди рдХрд░ рд░рд╣реА рд╣реИ, рддреЛ рдХреИрд╢ рд╡рд┐рд╖рд╛рдХреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**ред

XSS рдкреЗрд▓реЛрдб рд╡рд╛рд▓реЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдз:

![](<../.gitbook/assets/image (614).png>)

рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬреЛ рдХреИрд╢ рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИ:

![](<../.gitbook/assets/image (566).png>)

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрджрд┐ **"рдкреАрдбрд╝рд┐рдд" рд╣рдорд▓рд╛рд╡рд░ рд╣реИ** рддреЛ рд╡рд╣ рдЕрдм **рдордирдорд╛рдиреЗ URL рдореЗрдВ рдХреИрд╢ рд╡рд┐рд╖рд╛рдХреНрддрддрд╛** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡рд╣ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдХреИрд╢ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ URL рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред
{% endhint %}

### Web Cache Deception

рдпрд╣ рд╣рдорд▓рд╛ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди **рдХреИрд╢ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдХреИрд╢ рдХреЗ рдЕрдВрджрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛:**

![](<../.gitbook/assets/image (991).png>)

### Response Splitting

рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ **рд▓рдХреНрд╖реНрдп** рдлрд┐рд░ рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** **рдЕрд╕рдВрдХреНрд░рдордг** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ **рдкреНрд░реЙрдХреНрд╕реА 100% рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬреЗ**ред

рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЙрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рдорд╛рдиреЛрдВ рдХреЛ рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ** рдФрд░ **HEAD рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рдЬрд╛рдирддрд╛ рд╣реИ**ред

рд╡рд╣ рдПрдХ **рд╢реЛрд╖рдг** рднреЗрдЬреЗрдЧрд╛ рдЬреИрд╕реЗ:

![](<../.gitbook/assets/image (911).png>)

рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣рд▓ рд╣реЛрдиреЗ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, **рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрддрд╛рд░ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛**:

![](<../.gitbook/assets/image (737).png>)

рдкреАрдбрд╝рд┐рдд рдХреЛ **HEAD рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ + рджреВрд╕рд░реЗ рдЕрдиреБрд░реЛрдз рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА (рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдПрдХ рднрд╛рдЧ рд╢рд╛рдорд┐рд▓) рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧреА:**

![](<../.gitbook/assets/image (356).png>)

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдкрд░рд╛рд╡рд░реНрддрд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ HEAD** рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА **Content-Length** рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдерд╛ рдЬрд┐рд╕рдиреЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдореЗрдВ рдПрдХ рд╡реИрдз HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЙрддреНрдкрдиреНрди рдХреА**ред

рдЗрд╕рд▓рд┐рдП, **рджреВрд╕рд░реЗ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз** **рдХреБрдЫ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рддреИрдпрд╛рд░ рдХреА рдЧрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛**ред рдЪреВрдВрдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рддреИрдпрд╛рд░ рдХреА рдЧрдИ рд╣реИ, рд╡рд╣ **рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рднреА **рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ**ред

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
