# Konto√ºbernahme

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## **Autorisierungsproblem**

Die E-Mail eines Kontos sollte versucht werden zu √§ndern, und der Best√§tigungsprozess **muss untersucht werden**. Wenn er als **schwach** befunden wird, sollte die E-Mail auf die des beabsichtigten Opfers ge√§ndert und dann best√§tigt werden.

## **Unicode-Normalisierungsproblem**

1. Das Konto des beabsichtigten Opfers `victim@gmail.com`
2. Ein Konto sollte unter Verwendung von Unicode erstellt werden\
zum Beispiel: `viƒátim@gmail.com`

Wie in [**diesem Vortrag**](https://www.youtube.com/watch?v=CiIyaZ3x49c) erkl√§rt, k√∂nnte der vorherige Angriff auch durch den Missbrauch von Identit√§tsanbietern Dritter durchgef√ºhrt werden:

* Erstellen Sie ein Konto beim Drittanbieter mit einer √§hnlichen E-Mail wie die des Opfers unter Verwendung eines Unicode-Zeichens (`viƒátim@company.com`).
* Der Drittanbieter sollte die E-Mail nicht verifizieren.
* Wenn der Identit√§tsanbieter die E-Mail verifiziert, k√∂nnen Sie m√∂glicherweise den Domainteil angreifen, wie: `victim@ƒáompany.com` und diese Domain registrieren und hoffen, dass der Identit√§tsanbieter die ASCII-Version der Domain generiert, w√§hrend die Opferplattform den Domainnamen normalisiert.
* Melden Sie sich √ºber diesen Identit√§tsanbieter auf der Opferplattform an, die das Unicode-Zeichen normalisieren sollte und Ihnen den Zugriff auf das Opferkonto erm√∂glicht.

F√ºr weitere Details verweisen Sie auf das Dokument zur Unicode-Normalisierung:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Wiederverwendung des R√ºcksetztokens**

Sollte das Zielsystem den **R√ºcksetzlink zur Wiederverwendung** zulassen, sollten Anstrengungen unternommen werden, um **weitere R√ºcksetzlinks zu finden** mit Tools wie `gau`, `wayback` oder `scan.io`.

## **Vor der Konto√ºbernahme**

1. Die E-Mail des Opfers sollte verwendet werden, um sich auf der Plattform anzumelden, und ein Passwort sollte festgelegt werden (ein Versuch, es zu best√§tigen, sollte unternommen werden, obwohl der Mangel an Zugriff auf die E-Mails des Opfers dies unm√∂glich machen k√∂nnte).
2. Man sollte warten, bis das Opfer sich √ºber OAuth anmeldet und das Konto best√§tigt.
3. Es wird gehofft, dass die regul√§re Anmeldung best√§tigt wird, was den Zugriff auf das Konto des Opfers erm√∂glicht.

## **CORS-Misconfiguration zur Konto√ºbernahme**

Wenn die Seite **CORS-Misconfigurations** enth√§lt, k√∂nnten Sie in der Lage sein, **sensible Informationen** vom Benutzer zu **stehlen, um sein Konto zu √ºbernehmen** oder ihn dazu zu bringen, Authentifizierungsinformationen zu √§ndern, um dasselbe Ziel zu erreichen:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF zur Konto√ºbernahme**

Wenn die Seite anf√§llig f√ºr CSRF ist, k√∂nnten Sie in der Lage sein, den **Benutzer dazu zu bringen, sein Passwort**, seine E-Mail oder seine Authentifizierung zu √§ndern, sodass Sie dann darauf zugreifen k√∂nnen:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS zur Konto√ºbernahme**

Wenn Sie ein XSS in der Anwendung finden, k√∂nnten Sie in der Lage sein, Cookies, lokalen Speicher oder Informationen von der Webseite zu stehlen, die es Ihnen erm√∂glichen k√∂nnten, das Konto zu √ºbernehmen:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Gleiche Herkunft + Cookies**

Wenn Sie ein begrenztes XSS oder eine Subdomain-√úbernahme finden, k√∂nnten Sie mit den Cookies spielen (zum Beispiel sie fixieren), um zu versuchen, das Konto des Opfers zu kompromittieren:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Angriff auf den Passwortzur√ºcksetzmechanismus**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Antwortmanipulation**

Wenn die Authentifizierungsantwort auf **ein einfaches Boolean reduziert werden kann, versuchen Sie einfach, false in true zu √§ndern** und sehen Sie, ob Sie Zugriff erhalten.

## OAuth zur Konto√ºbernahme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host-Header-Injection

1. Der Host-Header wird nach der Initiierung einer Passwortzur√ºcksetzanforderung ge√§ndert.
2. Der `X-Forwarded-For` Proxy-Header wird auf `attacker.com` ge√§ndert.
3. Die Host-, Referrer- und Origin-Header werden gleichzeitig auf `attacker.com` ge√§ndert.
4. Nach der Initiierung eines Passwortzur√ºcksetzens und der Entscheidung, die E-Mail erneut zu senden, werden alle drei der oben genannten Methoden angewendet.

## Antwortmanipulation

1. **Code-Manipulation**: Der Statuscode wird auf `200 OK` ge√§ndert.
2. **Code- und Body-Manipulation**:
* Der Statuscode wird auf `200 OK` ge√§ndert.
* Der Antwortk√∂rper wird auf `{"success":true}` oder ein leeres Objekt `{}` ge√§ndert.

Diese Manipulationstechniken sind effektiv in Szenarien, in denen JSON f√ºr die Daten√ºbertragung und den Empfang verwendet wird.

## E-Mail der aktuellen Sitzung √§ndern

Aus [diesem Bericht](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Der Angreifer fordert an, seine E-Mail mit einer neuen zu √§ndern.
* Der Angreifer erh√§lt einen Link, um die √Ñnderung der E-Mail zu best√§tigen.
* Der Angreifer sendet dem Opfer den Link, damit es darauf klickt.
* Die E-Mail des Opfers wird auf die vom Angreifer angegebene ge√§ndert.
* Der Angreifer kann das Passwort zur√ºcksetzen und das Konto √ºbernehmen.

Dies geschah auch in [**diesem Bericht**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Alte Cookies

Wie [**in diesem Beitrag**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9) erkl√§rt, war es m√∂glich, sich in ein Konto einzuloggen, die Cookies als authentifizierter Benutzer zu speichern, sich abzumelden und dann erneut anzumelden.\
Mit dem neuen Login, obwohl unterschiedliche Cookies generiert werden k√∂nnten, funktionierten die alten wieder.

## Referenzen

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
