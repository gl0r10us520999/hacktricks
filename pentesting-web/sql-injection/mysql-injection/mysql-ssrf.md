# MySQL File priv to SSRF/RCE

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**–¶–µ —Ä–µ–∑—é–º–µ —Ç–µ—Ö–Ω—ñ–∫ MySQL/MariaDB/Percona –∑ [https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/](https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/)**.

### –ü—ñ–¥—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ (SSRF) —á–µ—Ä–µ–∑ SQL-—Ñ—É–Ω–∫—Ü—ñ—ó

–£ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—ñ SQL-–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó –¥–∞–Ω–∏—Ö –ø–æ–∑–∞ –∫–∞–Ω–∞–ª–æ–º, —Ñ—É–Ω–∫—Ü—ñ—è `LOAD_FILE()` –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤. –û–¥–Ω–∞–∫ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –æ–±–º–µ–∂–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é, –Ω–∞ —è–∫—ñ–π –≤–æ–Ω–∞ –ø—Ä–∞—Ü—é—î, —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è–º–∏ –∑–∞–ø—É—Å–∫—É –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.

–ì–ª–æ–±–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ `secure_file_priv`, —è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–æ—Ä—ñ–≤–Ω—é—î `/var/lib/mysql-files/`, –æ–±–º–µ–∂—É—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤ –ª–∏—à–µ —Ü—ñ—î—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é, —è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ –ø–æ—Ä–æ–∂–Ω—ñ–π —Ä—è–¥–æ–∫ (`""`). –¶–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∏–º–∞–≥–∞—î –∑–º—ñ–Ω —É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–º—É —Ñ–∞–π–ª—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –∞–±–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∑–∞–ø—É—Å–∫—É.

–Ø–∫—â–æ `secure_file_priv` –≤–∏–º–∫–Ω–µ–Ω–æ (`""`), —ñ –∑–∞ —É–º–æ–≤–∏, —â–æ –Ω–∞–¥–∞–Ω—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –¥–æ–∑–≤–æ–ª–∏ `file_priv`, —Ñ–∞–π–ª–∏ –ø–æ–∑–∞ –≤–∫–∞–∑–∞–Ω–æ—é –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ. –ü—Ä–æ—Ç–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –º–µ—Ä–µ–∂–µ–≤—ñ –≤–∏–∫–ª–∏–∫–∏ —Å–∏–ª—å–Ω–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ù–∞ —Å–∏—Å—Ç–µ–º–∞—Ö Windows –º–µ—Ä–µ–∂–µ–≤—ñ –≤–∏–∫–ª–∏–∫–∏ –¥–æ UNC-—à–ª—è—Ö—ñ–≤ –º–æ–∂–ª–∏–≤—ñ –∑–∞–≤–¥—è–∫–∏ —Ä–æ–∑—É–º—ñ–Ω–Ω—é –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é –∫–æ–Ω–≤–µ–Ω—Ü—ñ–π —ñ–º–µ–Ω—É–≤–∞–Ω–Ω—è UNC, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó —Ö–µ—à—ñ–≤ NTLMv2.

–¶–µ–π –º–µ—Ç–æ–¥ SSRF –æ–±–º–µ–∂–µ–Ω–∏–π TCP-–ø–æ—Ä—Ç–æ–º 445 —ñ –Ω–µ –¥–æ–∑–≤–æ–ª—è—î –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç—É, —Ö–æ—á–∞ –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –∑–∞–≥–∞–ª—å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ —á–∏—Ç–∞–Ω–Ω—è —ñ, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è—Ö, –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ö–µ—à—ñ–≤ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó.

### –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É (RCE) —á–µ—Ä–µ–∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (UDF)

–ë–∞–∑–∏ –¥–∞–Ω–∏—Ö MySQL –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π (UDF) –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫. –Ø–∫—â–æ —Ü—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –ø–µ–≤–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è—Ö –∞–±–æ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º—É `$PATH`, —ó—Ö –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑—Å–µ—Ä–µ–¥–∏–Ω–∏ MySQL.

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –º–µ—Ä–µ–∂–µ–≤—ñ/HTTP-–∑–∞–ø–∏—Ç–∏ —á–µ—Ä–µ–∑ UDF, –∑–∞ —É–º–æ–≤–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Ö —É–º–æ–≤, –≤–∫–ª—é—á–∞—é—á–∏ –¥–æ—Å—Ç—É–ø –Ω–∞ –∑–∞–ø–∏—Å –¥–æ `@@plugin_dir`, `file_priv`, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ `Y`, —ñ –≤–∏–º–∫–Ω–µ–Ω–∏–π `secure_file_priv`.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ `lib_mysqludf_sys` –∞–±–æ —ñ–Ω—à—ñ UDF-–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—é—Ç—å HTTP-–∑–∞–ø–∏—Ç–∏, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è SSRF. –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ø–µ—Ä–µ–¥–∞–Ω—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä, —â–æ –º–æ–∂–Ω–∞ –¥–æ—Å—è–≥—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–¥—É–≤–∞–Ω–Ω—è –≤ hex –∞–±–æ base64 –≤–º—ñ—Å—Ç—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, –∞ –ø–æ—Ç—ñ–º –∑–∞–ø–∏—Å–∞—Ç–∏ –π–æ–≥–æ –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é.

–ü—Ä–æ—Ü–µ—Å –∑–º—ñ–Ω—é—î—Ç—å—Å—è, —è–∫—â–æ `@@plugin_dir` –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –∑–∞–ø–∏—Å—É, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è –≤–µ—Ä—Å—ñ–π MySQL –≤–∏—â–µ `v5.0.67`. –£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —à–ª—è—Ö–∏, —è–∫—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–ª—è –∑–∞–ø–∏—Å—É.

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—é —Ü–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –º–æ–∂–Ω–∞ –ø–æ–ª–µ–≥—à–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ SQLMap, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å —ñ–Ω'—î–∫—Ü—ñ—é UDF, –∞ –¥–ª—è —Å–ª—ñ–ø–∏—Ö SQL-—ñ–Ω'—î–∫—Ü—ñ–π –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤–∏—Ö–æ–¥—É –∞–±–æ –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–∏ DNS-–∑–∞–ø–∏—Ç—ñ–≤.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
