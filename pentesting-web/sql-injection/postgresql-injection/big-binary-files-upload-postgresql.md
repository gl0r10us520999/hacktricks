<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!HackTricks AWS Red Team Expert</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

### PostgreSQL Large Objects

PostgreSQL offers a structure known as **large objects**, accessible via the `pg_largeobject` table, designed for storing large data types, such as images or PDF documents. This approach is advantageous over the `COPY TO` function as it enables the **exportation of data back to the file system**, ensuring an exact replica of the original file is maintained.

For **storing a complete file** within this table, an object must be created in the `pg_largeobject` table (identified by a LOID), followed by the insertion of data chunks, each 2KB in size, into this object. It is crucial that these chunks are exactly 2KB in size (with the possible exception of the last chunk) to ensure the exporting function performs correctly.

To **divide your binary data** into 2KB chunks, the following commands can be executed:
```bash
split -b 2048 your_file # Creates 2KB sized files
```
For encoding each file into Base64 or Hex, the commands below can be used:

```bash
# Base64 Encoding
echo -n "file_content" | base64

# Hex Encoding
xxd -p -c 9999 file_path
```

Remember to replace "file_content" with the actual content of the file and "file_path" with the path to the file you want to encode.
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**Qapla'**: QaghmeywI' vItlhutlhlaHchugh, vaj 2KB De'wI'pu'wI'wI' De'wI'pu'wI'wI' bytes. Hex encoded De'wI'pu'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'wI'w
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### lo_creat & Base64-ghItlh

binary data vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID vItlhutlh lo'ID
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
In situations requiring precise control, such as exploiting a Blind SQL Injection, `lo_create` is preferred for specifying a fixed LOID.

Data chunks can then be inserted as follows:

```
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (LOID, PAGENO, BYTEA);
```

Where `LOID` is the fixed LOID value, `PAGENO` is the page number, and `BYTEA` is the binary data chunk to be inserted.
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
To'wI' je 'ej potlhbe'chugh vItlhutlh.
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### lo_import & Hex-ghItlh

The `lo_import` vItlhutlh can be utilized to create and specify a LOID for a large object:
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
**Klingon Translation:**

**Qap creation, data inserted per page, ensuring each chunk does not exceed 2KB:**
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
To'wI' jatlhlaHbe'chugh, maHvaD DaH jatlhlaHbe'chugh:
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### qImHa'

**lojmIt vItlhutlh** (Access Control Lists) **qetlh** 'e' vItlhutlh, **lojmIt vItlhutlh** vItlhutlh 'e' vItlhutlh. 'ach, **lojmIt vItlhutlh** vItlhutlh 'e' vItlhutlh, **lojmIt vItlhutlh** vItlhutlh 'e' vItlhutlh.
