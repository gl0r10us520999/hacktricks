# Injection Unicode

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## Introduction

Selon le comportement du back-end/front-end lorsqu'il **re√ßoit des caract√®res unicode √©tranges**, un attaquant pourrait √™tre en mesure de **contourner les protections et d'injecter des caract√®res arbitraires** qui pourraient √™tre utilis√©s pour **exploiter des vuln√©rabilit√©s d'injection** telles que XSS ou SQLi.

## Normalisation Unicode

La normalisation Unicode se produit lorsque **les caract√®res unicode sont normalis√©s en caract√®res ascii**.

Un sc√©nario courant de ce type de vuln√©rabilit√© se produit lorsque le syst√®me **modifie** d'une mani√®re ou d'une autre l'**entr√©e** de l'utilisateur **apr√®s l'avoir v√©rifi√©e**. Par exemple, dans certaines langues, un simple appel pour rendre l'**entr√©e en majuscules ou en minuscules** pourrait normaliser l'entr√©e donn√©e et le **unicode sera transform√© en ASCII**, g√©n√©rant de nouveaux caract√®res.\
Pour plus d'infos, consultez :

{% content-ref url="unicode-normalization.md" %}
[unicode-normalization.md](unicode-normalization.md)
{% endcontent-ref %}

## `\u` √† `%`

Les caract√®res Unicode sont g√©n√©ralement repr√©sent√©s avec le **pr√©fixe `\u`**. Par exemple, le caract√®re `„±ã` est `\u3c4b`([v√©rifiez-le ici](https://unicode-explorer.com/c/3c4B)). Si un backend **transforme** le pr√©fixe **`\u` en `%`**, la cha√Æne r√©sultante sera `%3c4b`, qui d√©cod√©e en URL est : **`<4b`**. Et, comme vous pouvez le voir, un **caract√®re `<` est inject√©**.\
Vous pourriez utiliser cette technique pour **injecter n'importe quel type de caract√®re** si le backend est vuln√©rable.\
Consultez [https://unicode-explorer.com/](https://unicode-explorer.com/) pour trouver les caract√®res dont vous avez besoin.

Cette vuln√©rabilit√© provient en fait d'une vuln√©rabilit√© qu'un chercheur a trouv√©e, pour une explication plus approfondie, consultez [https://www.youtube.com/watch?v=aUsAHb0E7Cg](https://www.youtube.com/watch?v=aUsAHb0E7Cg)

## Injection d'√âmojis

Les back-ends se comportent parfois de mani√®re √©trange lorsqu'ils **re√ßoivent des √©mojis**. C'est ce qui s'est pass√© dans [**ce rapport**](https://medium.com/@fpatrik/how-i-found-an-xss-vulnerability-via-using-emojis-7ad72de49209) o√π le chercheur a r√©ussi √† obtenir un XSS avec une charge utile telle que : `üíãimg src=x onerror=alert(document.domain)//üíõ`

Dans ce cas, l'erreur √©tait que le serveur, apr√®s avoir supprim√© les caract√®res malveillants, **a converti la cha√Æne UTF-8 de Windows-1252 √† UTF-8** (essentiellement, l'encodage d'entr√©e et la conversion d'encodage √©taient incompatibles). Cela ne donne pas un < correct, juste un unicode √©trange : `‚Äπ`\
``Ils ont donc pris cette sortie et **convertie √† nouveau maintenant de UTF-8 √† ASCII**. Cela a **normalis√©** le `‚Äπ` en `<`, c'est ainsi que l'exploit a pu fonctionner sur ce syst√®me.\
Voici ce qui s'est pass√© :
```php
<?php

$str = isset($_GET["str"]) ? htmlspecialchars($_GET["str"]) : "";

$str = iconv("Windows-1252", "UTF-8", $str);
$str = iconv("UTF-8", "ASCII//TRANSLIT", $str);

echo "String: " . $str;
```
Liste d'emojis :

* [https://github.com/iorch/jakaton\_feminicidios/blob/master/data/emojis.csv](https://github.com/iorch/jakaton\_feminicidios/blob/master/data/emojis.csv)
* [https://unicode.org/emoji/charts-14.0/full-emoji-list.html](https://unicode.org/emoji/charts-14.0/full-emoji-list.html)

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
