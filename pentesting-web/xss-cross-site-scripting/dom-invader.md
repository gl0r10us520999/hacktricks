# DOM Invader

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## DOM Invader

DOM Invader, Burp'Ä±n yerleÅŸik tarayÄ±cÄ±sÄ±nda kurulu bir tarayÄ±cÄ± aracÄ±dÄ±r. Ã‡eÅŸitli kaynaklar ve sinkler kullanarak **DOM XSS zafiyetlerini tespit etmeye** yardÄ±mcÄ± olur; bunlar arasÄ±nda web mesajlarÄ± ve prototip kirlenmesi bulunmaktadÄ±r. AraÃ§, bir uzantÄ± olarak Ã¶nceden yÃ¼klenmiÅŸtir.

DOM Invader, tarayÄ±cÄ±nÄ±n GeliÅŸtirici AraÃ§larÄ± panelinde aÅŸaÄŸÄ±dakileri saÄŸlayan bir sekme entegre eder:

1. **DOM XSS testi iÃ§in bir web sayfasÄ±ndaki kontrol edilebilir sinklerin tanÄ±mlanmasÄ±**, baÄŸlam ve sanitizasyon detaylarÄ± saÄŸlar.
2. **`postMessage()` yÃ¶ntemiyle gÃ¶nderilen web mesajlarÄ±nÄ±n** kaydedilmesi, dÃ¼zenlenmesi ve yeniden gÃ¶nderilmesi iÃ§in DOM XSS testi. DOM Invader ayrÄ±ca Ã¶zel olarak hazÄ±rlanmÄ±ÅŸ web mesajlarÄ± kullanarak zafiyetleri otomatik olarak tespit edebilir.
3. **Ä°stemci tarafÄ± prototip kirlenmesi** kaynaklarÄ±nÄ±n tespiti ve riskli sinklere gÃ¶nderilen kontrol edilebilir gadgetlarÄ±n taranmasÄ±.
4. **DOM clobbering zafiyetlerinin** tanÄ±mlanmasÄ±.

### AktifleÅŸtir

Burp'Ä±n yerleÅŸik tarayÄ±cÄ±sÄ±nda **Burp uzantÄ±sÄ±na** gidin ve bunu aktifleÅŸtirin:

<figure><img src="../../.gitbook/assets/image (1129).png" alt=""><figcaption></figcaption></figure>

Åimdi sayfayÄ± yenileyin ve **GeliÅŸtirici AraÃ§larÄ±**'nda **DOM Invader sekmesini** bulacaksÄ±nÄ±z:

<figure><img src="../../.gitbook/assets/image (695).png" alt=""><figcaption></figcaption></figure>

### Bir Canary Enjekte Et

Ã–nceki resimde bir **rastgele karakter grubu, yani Canary** gÃ¶rebilirsiniz. Åimdi bunu webin farklÄ± kÄ±sÄ±mlarÄ±na (parametreler, formlar, url...) **enjekte etmeye** baÅŸlamalÄ±sÄ±nÄ±z ve her seferinde arama butonuna tÄ±klayÄ±n. DOM Invader, **canary'nin herhangi bir ilginÃ§ sinkte** sonlanÄ±p sonlanmadÄ±ÄŸÄ±nÄ± kontrol edecektir.

AyrÄ±ca, **URL parametrelerini Enjekte Et** ve **formlarÄ± Enjekte Et** seÃ§enekleri, bulduÄŸu her **URL** parametresine ve **formuna** **canary** enjekte ederek otomatik olarak **yeni bir sekme** aÃ§acaktÄ±r.

### BoÅŸ Bir Canary Enjekte Et

SayfanÄ±n potansiyel sinklerini bulmak istiyorsanÄ±z, bunlar istismar edilebilir olmasa bile, **boÅŸ bir canary** arayabilirsiniz.

### Mesajlar GÃ¶nder

DOM Invader, web mesajlarÄ± kullanarak DOM XSS testi yapmayÄ± saÄŸlar ve ÅŸu Ã¶zelliklere sahiptir:

1. **`postMessage()` ile gÃ¶nderilen web mesajlarÄ±nÄ±n** kaydedilmesi, Burp Proxy'nin HTTP istek/yanÄ±t geÃ§miÅŸi kaydÄ±yla benzerlik gÃ¶sterir.
2. **Web mesajlarÄ±nÄ±n** deÄŸiÅŸtirilmesi ve **yeniden gÃ¶nderilmesi**, DOM XSS iÃ§in manuel test yapmaya benzer, Burp Repeater'Ä±n iÅŸlevine benzer.
3. **Web mesajlarÄ±nÄ±n otomatik olarak deÄŸiÅŸtirilmesi** ve DOM XSS'i araÅŸtÄ±rmak iÃ§in gÃ¶nderilmesi.

#### Mesaj detaylarÄ±

Her mesaj hakkÄ±nda detaylÄ± bilgi, Ã¼zerine tÄ±klanarak gÃ¶rÃ¼ntÃ¼lenebilir; bu, istemci tarafÄ± JavaScript'in mesajÄ±n `origin`, `data` veya `source` Ã¶zelliklerine eriÅŸip eriÅŸmediÄŸini iÃ§erir.

* **`origin`** : EÄŸer mesajÄ±n **origin bilgisi kontrol edilmezse**, **rastgele bir dÄ±ÅŸ alan** Ã¼zerinden olay iÅŸleyicisine Ã§apraz alan mesajlarÄ± gÃ¶nderebilirsiniz. Ancak kontrol ediliyorsa, yine de gÃ¼vensiz olabilir.
* **`data`**: Payload'un gÃ¶nderildiÄŸi yerdir. Bu veri kullanÄ±lmazsa, sink iÅŸe yaramaz.
* **`source`**: Kaynak Ã¶zelliÄŸinin, genellikle bir iframe'i referans alÄ±p almadÄ±ÄŸÄ±nÄ± deÄŸerlendirir. Bu kontrol edilse bile, doÄŸrulamanÄ±n atlanamayacaÄŸÄ±na dair bir gÃ¼vence vermez.

#### Bir mesaja yanÄ±t ver

1. **Mesajlar** gÃ¶rÃ¼nÃ¼mÃ¼nden, herhangi bir mesaja tÄ±klayarak mesaj detaylarÄ± penceresini aÃ§Ä±n.
2. Gerekli ÅŸekilde **Data** alanÄ±nÄ± dÃ¼zenleyin.
3. **GÃ¶nder** butonuna tÄ±klayÄ±n.

### Prototip Kirlenmesi

DOM Invader ayrÄ±ca **Prototip Kirlenmesi zafiyetlerini** arayabilir. Ã–ncelikle, bunu aktifleÅŸtirmeniz gerekir:

<figure><img src="../../.gitbook/assets/image (1026).png" alt=""><figcaption></figcaption></figure>

SonrasÄ±nda, **`Object.prototype`**'a rastgele Ã¶zellikler eklemenizi saÄŸlayan **kaynaklarÄ±** arayacaktÄ±r.

EÄŸer bir ÅŸey bulunursa, bulunan kaynaÄŸÄ± **test etmek iÃ§in** bir **Test** butonu gÃ¶rÃ¼necektir. Ãœzerine tÄ±klayÄ±n, yeni bir sekme aÃ§Ä±lacak, konsolda bir nesne oluÅŸturun ve `testproperty`'nin var olup olmadÄ±ÄŸÄ±nÄ± kontrol edin:
```javascript
let b = {}
b.testproperty
```
Bir kaynak bulduÄŸunuzda **bir gadget iÃ§in tarama yapabilirsiniz**:

1. **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde tanÄ±mlanan herhangi bir prototip kirlenme kaynaÄŸÄ±nÄ±n yanÄ±nda bulunan **Gadget'lar iÃ§in tara** butonuna tÄ±klandÄ±ÄŸÄ±nda DOM Invader yeni bir sekme aÃ§ar. Uygun gadget'lar iÃ§in tarama baÅŸlar.
2. Bu arada, aynÄ± sekmede **DOM Invader** sekmesi DevTools panelinde aÃ§Ä±lmalÄ±dÄ±r. Tarama tamamlandÄ±ÄŸÄ±nda, tanÄ±mlanan gadget'lar aracÄ±lÄ±ÄŸÄ±yla eriÅŸilebilen herhangi bir sink **DOM** gÃ¶rÃ¼nÃ¼mÃ¼nde gÃ¶rÃ¼ntÃ¼lenir. Ã–rneÄŸin, `innerHTML` sink'ine geÃ§irilen `html` adlÄ± bir gadget Ã¶zelliÄŸi aÅŸaÄŸÄ±daki Ã¶rnekte gÃ¶sterilmektedir.

## DOM clobbering

Ã–nceki gÃ¶rÃ¼ntÃ¼de DOM clobbering taramasÄ±nÄ±n aÃ§Ä±labileceÄŸi gÃ¶rÃ¼lmektedir. TamamlandÄ±ÄŸÄ±nda, **DOM Invader DOM clobbering zafiyetlerini aramaya baÅŸlayacaktÄ±r**.

## Referanslar

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

{% hint style="success" %}
AWS Hacking Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
