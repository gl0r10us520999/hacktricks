# Chrome Cache to XSS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

More in depth details [**in this writeup**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

La technique discut√©e ici implique de comprendre le comportement et l'interaction de deux types de cache principaux : le **back/forward cache (bfcache)** et le **disk cache**. Le bfcache, qui stocke un instantan√© complet d'une page y compris le tas JavaScript, est prioris√© par rapport au disk cache pour les navigations avant/arri√®re en raison de sa capacit√© √† stocker un instantan√© plus complet. Le disk cache, en revanche, stocke les ressources r√©cup√©r√©es sur le web sans inclure le tas JavaScript, et est utilis√© pour les navigations avant/arri√®re afin de r√©duire les co√ªts de communication. Un aspect int√©ressant du disk cache est son inclusion de ressources r√©cup√©r√©es en utilisant `fetch`, ce qui signifie que les ressources d'URL accessibles seront rendues par le navigateur √† partir du cache.

### Key Points:

- Le **bfcache** a la priorit√© sur le disk cache lors des navigations avant/arri√®re.
- Pour utiliser une page stock√©e dans le disk cache au lieu du bfcache, ce dernier doit √™tre d√©sactiv√©.

### Disabling bfcache:

Par d√©faut, Puppeteer d√©sactive le bfcache, conform√©ment aux conditions √©num√©r√©es dans la documentation de Chromium. Une m√©thode efficace pour d√©sactiver le bfcache est d'utiliser `RelatedActiveContentsExist`, obtenue en ouvrant une page avec `window.open()` qui conserve une r√©f√©rence √† `window.opener`.

### Reproducing the behavior:

1. Visitez une page web, par exemple, `https://example.com`.
2. Ex√©cutez `open("http://spanote.seccon.games:3000/api/token")`, ce qui entra√Æne une r√©ponse du serveur avec un code d'√©tat 500.
3. Dans l'onglet nouvellement ouvert, naviguez vers `http://spanote.seccon.games:3000/`. Cette action met en cache la r√©ponse de `http://spanote.seccon.games:3000/api/token` en tant que disk cache.
4. Utilisez `history.back()` pour revenir en arri√®re. L'action entra√Æne le rendu de la r√©ponse JSON mise en cache sur la page.

La v√©rification que le disk cache a √©t√© utilis√© peut √™tre confirm√©e par l'utilisation des DevTools dans Google Chrome.

Pour plus de d√©tails sur le bfcache et le disk cache, des r√©f√©rences peuvent √™tre trouv√©es sur [web.dev sur bfcache](https://web.dev/i18n/en/bfcache/) et [les documents de conception de Chromium sur le disk cache](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/), respectivement.


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
