# SOME - Same Origin Method Execution

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Same Origin Method Execution

Bazı durumlarda bir sayfada sınırlı javascript çalıştırabilirsiniz. Örneğin, [**çalıştırılacak bir geri çağırma değerini kontrol edebildiğiniz**](./#javascript-function) durumlarda.

Bu durumlarda yapabileceğiniz en iyi şey, **orada bulabileceğiniz herhangi bir** hassas eylemi çağırmak için **DOM'a erişmek** olacaktır (örneğin bir düğmeye tıklamak). Ancak, genellikle bu güvenlik açığını **DOM'da ilginç bir şey olmayan küçük uç noktalar** içinde bulacaksınız.

Bu senaryolarda, bu saldırı çok faydalı olacaktır, çünkü amacı, **aynı alan adından farklı bir sayfadaki DOM içindeki sınırlı JS yürütmesini kötüye kullanabilmektir** ve daha ilginç eylemler gerçekleştirmektir.

Temelde, saldırı akışı şu şekildedir:

* **Kötüye kullanabileceğiniz bir geri çağırma bulun** (potansiyel olarak \[\w\\.\_] ile sınırlı).
* Eğer sınırlı değilse ve herhangi bir JS çalıştırabiliyorsanız, bunu normal bir XSS olarak kötüye kullanabilirsiniz.
* **Kurbanı,** **saldırgan** tarafından kontrol edilen bir **sayfayı açmaya** zorlayın.
* **Sayfa kendini** **farklı bir pencerede** açacaktır (yeni pencere, başlangıçtaki nesne **`opener`** ile referans alacaktır).
* **Başlangıç sayfası**, **ilginç DOM'un** bulunduğu **sayfayı** yükleyecektir.
* **İkinci sayfa**, **geri çağırmayı kötüye kullanarak** **savunmasız sayfayı** yükleyecek ve **`opener`** nesnesini kullanarak **başlangıç sayfasında bazı eylemleri erişip çalıştıracaktır** (artık ilginç DOM'u içermektedir).

{% hint style="danger" %}
Başlangıç sayfası, ikinci sayfayı oluşturduktan sonra yeni bir URL'ye erişse bile, **ikinci sayfanın `opener` nesnesi, yeni DOM'daki ilk sayfaya geçerli bir referans olmaya devam eder**.

Ayrıca, ikinci sayfanın opener nesnesini kullanabilmesi için **her iki sayfanın da aynı kökene sahip olması gerekir**. Bu, bu güvenlik açığını kötüye kullanmak için bazı türde **aynı köken içinde XSS bulmanız gerektiği** anlamına gelir.
{% endhint %}

### Exploitation

* Bu formu kullanarak bu tür bir güvenlik açığını istismar etmek için **bir PoC oluşturabilirsiniz**: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML öğesine tıklayarak bir DOM yolu bulmak için bu tarayıcı uzantısını kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Örnek

* Savunmasız bir örneği [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde bulabilirsiniz.
* Bu örnekte sunucunun **javascript kodu ürettiğini** ve **geri çağırma parametresinin içeriğine göre** HTML'ye eklediğini unutmayın: `<script>opener.{callbacl_content}</script>` . Bu nedenle bu örnekte `opener` kullanımını açıkça belirtmenize gerek yoktur.
* Ayrıca bu CTF yazımını kontrol edin: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
