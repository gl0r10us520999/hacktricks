# Cookie Tossing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### –û–ø–∏—Å

–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ø—ñ–¥–¥–æ–º–µ–Ω –∞–±–æ –¥–æ–º–µ–Ω –∫–æ–º–ø–∞–Ω—ñ—ó –∞–±–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å XSS —É –ø—ñ–¥–¥–æ–º–µ–Ω—ñ**, –≤—ñ–Ω –∑–º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü—é –∞—Ç–∞–∫—É.

–Ø–∫ –±—É–ª–æ –∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ —Ä–æ–∑–¥—ñ–ª—ñ –ø—Ä–æ –•–∞–∫—ñ–Ω–≥ –ö—É–∫—ñ–≤, –∫–æ–ª–∏ **–∫—É–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞ –¥–æ–º–µ–Ω (–≤–∫–∞–∑—É—é—á–∏ –π–æ–≥–æ), –≤–æ–Ω–∞ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –≤ –¥–æ–º–µ–Ω—ñ —Ç–∞ –ø—ñ–¥–¥–æ–º–µ–Ω–∞—Ö.**

{% hint style="danger" %}
–û—Ç–∂–µ, **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –¥–ª—è –¥–æ–º–µ–Ω—É —Ç–∞ –ø—ñ–¥–¥–æ–º–µ–Ω—ñ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É –∫—É–∫—É, –∑—Ä–æ–±–∏–≤—à–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç** `document.cookie="session=1234; Path=/app/login; domain=.example.com"`
{% endhint %}

–¶–µ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ:

* **–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏ –∫—É–∫—É –∂–µ—Ä—Ç–≤–∏ –∑–∞ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, —Ç–æ–º—É —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –ø–æ–º—ñ—Ç–∏—Ç—å, **–≤—ñ–Ω –±—É–¥–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, —ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—è–∫—É —Ü—ñ–∫–∞–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é –ø–æ—à—É–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ, –∂–µ—Ä—Ç–≤–∞ –º–æ–∂–µ –≤–∫–∞–∑–∞—Ç–∏ —Å–≤–æ—é –∫—Ä–µ–¥–∏—Ç–Ω—É –∫–∞—Ä—Ç–∫—É –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ...)
* –Ø–∫—â–æ **–∫—É–∫–∞ –Ω–µ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø—Ä–æ—Å—Ç–æ **–∑–∞–∫—Ä—ñ–ø–∏—Ç–∏ –∫—É–∫—É (session-fixation)**, –ø–æ—á–µ–∫–∞—Ç–∏, –ø–æ–∫–∏ –∂–µ—Ä—Ç–≤–∞ —É–≤—ñ–π–¥–µ, –∞ –ø–æ—Ç—ñ–º **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü—é –∫—É–∫—É, —â–æ–± —É–≤—ñ–π—Ç–∏ —è–∫ –∂–µ—Ä—Ç–≤–∞**.
* –Ü–Ω–æ–¥—ñ, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫—É–∫–∏ —Å–µ—Å—ñ—ó –∑–º—ñ–Ω—é—é—Ç—å—Å—è, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ–ø–µ—Ä–µ–¥–Ω—é —ñ —Ç–∞–∫–æ–∂ –æ—Ç—Ä–∏–º–∞—î –Ω–æ–≤—É.
* –Ø–∫—â–æ **–∫—É–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –¥–µ—è–∫–µ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è** (—è–∫ —É flask, –¥–µ **–∫—É–∫–∞** –º–æ–∂–µ **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏** **CSRF —Ç–æ–∫–µ–Ω** —Å–µ—Å—ñ—ó, —ñ —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É –∂–µ—Ä—Ç–≤–∏), **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ü–µ –≤—ñ–¥–æ–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ –ø–æ—Ç—ñ–º –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º** (–≤ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ CSRF –∑–∞–ø–∏—Ç, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–Ω–∞—î CSRF —Ç–æ–∫–µ–Ω).
* –¢–∞–∫ —Å–∞–º–æ, —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Ç–∞–∫–æ–∂ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—É –∫—É–∫—É, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—É —Å–µ—Ä–≤–µ—Ä–æ–º, –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –Ω–µ—ó CSRF —Ç–æ–∫–µ–Ω —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ.

### –ü–æ—Ä—è–¥–æ–∫ –ö—É–∫

–ö–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä –æ—Ç—Ä–∏–º—É—î –¥–≤—ñ –∫—É–∫–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º —ñ–º'—è–º, **—è–∫—ñ —á–∞—Å—Ç–∫–æ–≤–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –æ–±—Å—è–≥** (–¥–æ–º–µ–Ω, –ø—ñ–¥–¥–æ–º–µ–Ω–∏ —Ç–∞ —à–ª—è—Ö), **–±—Ä–∞—É–∑–µ—Ä –Ω–∞–¥—ñ—à–ª–µ –æ–±–∏–¥–≤–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–∫–∏**, –∫–æ–ª–∏ –æ–±–∏–¥–≤–∞ —î –¥—ñ–π—Å–Ω–∏–º–∏ –¥–ª—è –∑–∞–ø–∏—Ç—É.

–í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ, —Ö—Ç–æ –º–∞—î **–Ω–∞–π–±—ñ–ª—å—à —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π —à–ª—è—Ö** –∞–±–æ —è–∫–∞ –∑ –Ω–∏—Ö —î **–Ω–∞–π—Å—Ç–∞—Ä—ñ—à–æ—é**, –±—Ä–∞—É–∑–µ—Ä **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–∫–∏ —Å–ø–æ—á–∞—Ç–∫—É** —ñ –ø–æ—Ç—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω—à–æ—ó, —è–∫ —É: `Cookie: iduser=MoreSpecificAndOldestCookie; iduser=LessSpecific;`

–ë—ñ–ª—å—à—ñ—Å—Ç—å **–≤–µ–±—Å–∞–π—Ç—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏–º—É—Ç—å –ª–∏—à–µ –ø–µ—Ä—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è**. –¢–æ–º—É, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Ö–æ—á–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫—É–∫—É, –∫—Ä–∞—â–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ó—ó –ø–µ—Ä–µ–¥ —Ç–∏–º, —è–∫ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —ñ–Ω—à–∞, –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —ó—ó –∑ –±—ñ–ª—å—à —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–º —à–ª—è—Ö–æ–º.

{% hint style="warning" %}
–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫—É–∫—É –≤ –±—ñ–ª—å—à —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–º—É —à–ª—è—Ö—É** —î –¥—É–∂–µ —Ü—ñ–∫–∞–≤–æ—é, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ **–∂–µ—Ä—Ç–≤—É –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑—ñ —Å–≤–æ—î—é –∫—É–∫–æ—é, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —à–ª—è—Ö—É, –¥–µ –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∞ –∫—É–∫–∞**.
{% endhint %}

### –û–±—Ö—ñ–¥ –ó–∞—Ö–∏—Å—Ç—É

–ú–æ–∂–ª–∏–≤–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –ø–æ–ª—è–≥–∞–≤ –±–∏ –≤ —Ç–æ–º—É, —â–æ **–≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –ø—Ä–∏–π–º–∞—Ç–∏–º–µ –∑–∞–ø–∏—Ç–∏ –∑ –¥–≤–æ–º–∞ –∫—É–∫–∞–º–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º —ñ–º'—è–º, –∞–ª–µ –∑ –¥–≤–æ–º–∞ —Ä—ñ–∑–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏**.

–©–æ–± –æ–±—ñ–π—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∫—É–∫—É –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –∂–µ—Ä—Ç–≤–∞ –≤–∂–µ –æ—Ç—Ä–∏–º–∞–ª–∞ –∫—É–∫—É, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ **–ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –∫—É–∫–∏**, –∞ –ø–æ—Ç—ñ–º, —è–∫ —Ç—ñ–ª—å–∫–∏ **–ª–µ–≥—ñ—Ç–∏–º–Ω–∞ –∫—É–∫–∞ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–∞, –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω—É**.

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

–©–µ –æ–¥–∏–Ω –∫–æ—Ä–∏—Å–Ω–∏–π **–æ–±—Ö—ñ–¥** –º–æ–∂–µ –ø–æ–ª—è–≥–∞—Ç–∏ –≤ —Ç–æ–º—É, —â–æ–± **URL-–∫–æ–¥—É–≤–∞—Ç–∏ —ñ–º'—è –∫—É–∫–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ –¥–µ—è–∫—ñ –∑–∞—Ö–∏—Å—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –Ω–∞—è–≤–Ω—ñ—Å—Ç—å 2 –∫—É–∫—ñ–≤ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º —ñ–º'—è–º —É –∑–∞–ø–∏—Ç—ñ, –∞ –ø–æ—Ç—ñ–º —Å–µ—Ä–≤–µ—Ä –¥–µ–∫–æ–¥—É—î —ñ–º–µ–Ω–∞ –∫—É–∫—ñ–≤.

### Cookie Bomb

–ê—Ç–∞–∫–∞ Cookie Tossing —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞—Ç–∞–∫–∏ **Cookie Bomb**:

{% content-ref url="cookie-bomb.md" %}
[cookie-bomb.md](cookie-bomb.md)
{% endcontent-ref %}

### –ó–∞—Ö–∏—Å—Ç–∏

#### **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–µ—Ñ—ñ–∫—Å `__Host` –≤ —ñ–º–µ–Ω—ñ –∫—É–∫–∏**

* –Ø–∫—â–æ —ñ–º'—è –∫—É–∫–∏ –º–∞—î —Ü–µ–π –ø—Ä–µ—Ñ—ñ–∫—Å, –≤–æ–Ω–∞ **–±—É–¥–µ –ø—Ä–∏–π–Ω—è—Ç–∞** –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤—ñ Set-Cookie –ª–∏—à–µ —è–∫—â–æ –≤–æ–Ω–∞ –ø–æ–∑–Ω–∞—á–µ–Ω–∞ —è–∫ Secure, –±—É–ª–∞ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞ –∑ –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞, –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç—É Domain —ñ –º–∞—î –∞—Ç—Ä–∏–±—É—Ç Path, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ /
* **–¶–µ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø—ñ–¥–¥–æ–º–µ–Ω–∞–º –≤—ñ–¥ –ø—Ä–∏–º—É—à–µ–Ω–Ω—è –∫—É–∫–∏ –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –∫—É–∫–∏ –º–æ–∂—É—Ç—å —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ "–∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ –∑–∞ –¥–æ–º–µ–Ω–æ–º"**

### –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [**@blueminimal**](https://twitter.com/blueminimal)
* [**https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers**](https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers)
* [**https://github.blog/2013-04-09-yummy-cookies-across-domains/**](https://github.blog/2013-04-09-yummy-cookies-across-domains/)
* [**Cookie Crumbles: Unveiling Web Session Integrity Vulnerabilities**](https://www.youtube.com/watch?v=F\_wAzF4a7Xg)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
