# HTTP Connection Contamination

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Dies ist eine Zusammenfassung des Beitrags: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. √úberpr√ºfen Sie es f√ºr weitere Details!

Webbrowser k√∂nnen eine einzelne HTTP/2+-Verbindung f√ºr verschiedene Websites durch [HTTP-Verbindungskoaleszenz](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing) wiederverwenden, vorausgesetzt, es gibt gemeinsame IP-Adressen und ein gemeinsames TLS-Zertifikat. Dies kann jedoch mit **First-Request-Routing** in Reverse-Proxys in Konflikt geraten, bei dem nachfolgende Anfragen an das Backend geleitet werden, das durch die erste Anfrage bestimmt wird. Diese Fehlleitung kann zu Sicherheitsanf√§lligkeiten f√ºhren, insbesondere in Kombination mit Wildcard-TLS-Zertifikaten und Domains wie `*.example.com`.

Wenn beispielsweise `wordpress.example.com` und `secure.example.com` beide vom selben Reverse-Proxy bedient werden und ein gemeinsames Wildcard-Zertifikat haben, k√∂nnte die Verbindungskoaleszenz eines Browsers dazu f√ºhren, dass Anfragen an `secure.example.com` f√§lschlicherweise vom WordPress-Backend verarbeitet werden, wodurch Schwachstellen wie XSS ausgenutzt werden.

Um die Verbindungskoaleszenz zu beobachten, k√∂nnen Chome's Netzwerk-Tab oder Tools wie Wireshark verwendet werden. Hier ist ein Snippet zum Testen:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
Die Bedrohung ist derzeit aufgrund der Seltenheit des First-Request-Routings und der Komplexit√§t von HTTP/2 begrenzt. Die vorgeschlagenen √Ñnderungen in HTTP/3, die die Anforderung an die √úbereinstimmung der IP-Adresse lockern, k√∂nnten jedoch die Angriffsfl√§che erweitern und Server mit einem Wildcard-Zertifikat anf√§lliger machen, ohne dass ein MITM-Angriff erforderlich ist.

Best Practices umfassen das Vermeiden von First-Request-Routing in Reverse-Proxys und Vorsicht im Umgang mit Wildcard-TLS-Zertifikaten, insbesondere mit dem Aufkommen von HTTP/3. Regelm√§√üige Tests und das Bewusstsein f√ºr diese komplexen, miteinander verbundenen Schwachstellen sind entscheidend f√ºr die Aufrechterhaltung der Websicherheit.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
