# Contamination de la connexion HTTP

{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

**Ceci est un r√©sum√© du post : [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Consultez-le pour plus de d√©tails !

Les navigateurs web peuvent r√©utiliser une seule connexion HTTP/2+ pour diff√©rents sites web gr√¢ce √† [la coalescence de connexion HTTP](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), √† condition d'avoir des adresses IP partag√©es et un certificat TLS commun. Cependant, cela peut entrer en conflit avec le **routage de premi√®re requ√™te** dans les reverse-proxies, o√π les requ√™tes suivantes sont dirig√©es vers le back-end d√©termin√© par la premi√®re requ√™te. Ce mauvais routage peut entra√Æner des vuln√©rabilit√©s de s√©curit√©, en particulier lorsqu'il est combin√© avec des certificats TLS wildcard et des domaines comme `*.example.com`.

Par exemple, si `wordpress.example.com` et `secure.example.com` sont tous deux servis par le m√™me reverse proxy et ont un certificat wildcard commun, la coalescence de connexion d'un navigateur pourrait amener les requ√™tes vers `secure.example.com` √† √™tre mal trait√©es par le back-end WordPress, exploitant des vuln√©rabilit√©s telles que XSS.

Pour observer la coalescence de connexion, l'onglet R√©seau de Chrome ou des outils comme Wireshark peuvent √™tre utilis√©s. Voici un extrait pour tester :
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
La menace est actuellement limit√©e en raison de la raret√© du routage de premi√®re requ√™te et de la complexit√© de HTTP/2. Cependant, les changements propos√©s dans HTTP/3, qui assouplissent l'exigence de correspondance d'adresse IP, pourraient √©largir la surface d'attaque, rendant les serveurs avec un certificat wildcard plus vuln√©rables sans n√©cessiter une attaque MITM.

Les meilleures pratiques incluent d'√©viter le routage de premi√®re requ√™te dans les proxys inverses et d'√™tre prudent avec les certificats TLS wildcard, surtout avec l'av√®nement de HTTP/3. Des tests r√©guliers et une sensibilisation √† ces vuln√©rabilit√©s complexes et interconnect√©es sont cruciaux pour maintenir la s√©curit√© web.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
