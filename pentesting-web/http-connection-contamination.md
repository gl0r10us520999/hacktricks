# HTTP Connection Contamination

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Dit is 'n opsomming van die pos: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Kyk daarna vir verdere besonderhede!

Webblaaiers kan 'n enkele HTTP/2+ verbinding hergebruik vir verskillende webwerwe deur middel van [HTTP connection coalescing](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), gegewe gedeelde IP adresse en 'n algemene TLS sertifikaat. Dit kan egter in konflik kom met **first-request routing** in omgekeerde proxies, waar daaropvolgende versoeke na die agterkant gelei word deur die eerste versoek. Hierdie verkeerde routing kan lei tot sekuriteitskwesbaarhede, veral wanneer dit gekombineer word met wildcard TLS sertifikate en domeine soos `*.example.com`.

Byvoorbeeld, as `wordpress.example.com` en `secure.example.com` albei deur dieselfde omgekeerde proxy bedien word en 'n algemene wildcard sertifikaat het, kan 'n blaier se verbinding coalescing versoeke na `secure.example.com` verkeerd verwerk deur die WordPress agterkant, wat kwesbaarhede soos XSS benut.

Om verbinding coalescing te observeer, kan Chrome se Netwerk-oortjie of gereedskap soos Wireshark gebruik word. Hier is 'n snit vir toetsing:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
Die bedreiging is tans beperk weens die seldsaamheid van eerste-versoek routering en die kompleksiteit van HTTP/2. egter, die voorgestelde veranderinge in HTTP/3, wat die IP-adres ooreenkoms vereiste verslap, kan die aanvaloppervlak verbreed, wat bedieners met 'n wildcard sertifikaat meer kwesbaar maak sonder die behoefte aan 'n MITM-aanval.

Beste praktyke sluit in om eerste-versoek routering in omgekeerde proxies te vermy en om versigtig te wees met wildcard TLS-sertifikate, veral met die opkoms van HTTP/3. Gereelde toetsing en bewustheid van hierdie komplekse, onderling verbonde kwesbaarhede is van kardinale belang vir die handhawing van websekuriteit.
