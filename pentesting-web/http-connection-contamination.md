# HTTP Connection Contamination

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**–¶–µ —Ä–µ–∑—é–º–µ –ø–æ—Å—Ç—É: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –π–æ–≥–æ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥–µ—Ç–∞–ª–µ–π!

–í–µ–±-–±—Ä–∞—É–∑–µ—Ä–∏ –º–æ–∂—É—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–¥–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è HTTP/2+ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –≤–µ–±-—Å–∞–π—Ç—ñ–≤ —á–µ—Ä–µ–∑ [HTTP connection coalescing](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), –∑–∞ —É–º–æ–≤–∏ —Å–ø—ñ–ª—å–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å —ñ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ TLS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞. –û–¥–Ω–∞–∫ —Ü–µ –º–æ–∂–µ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É–≤–∞—Ç–∏ –∑ **–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—î—é –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø–∏—Ç—É** –≤ –∑–≤–æ—Ä–æ—Ç–Ω–∏—Ö –ø—Ä–æ–∫—Å—ñ, –¥–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –Ω–∞ –±–µ–∫–µ–Ω–¥, –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä—à–∏–º –∑–∞–ø–∏—Ç–æ–º. –¶–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –±–µ–∑–ø–µ–∫–∏, –æ—Å–æ–±–ª–∏–≤–æ –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞–º–∏ wildcard TLS —ñ –¥–æ–º–µ–Ω–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ `*.example.com`.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ `wordpress.example.com` —ñ `secure.example.com` –æ–±—Å–ª—É–≥–æ–≤—É—é—Ç—å—Å—è –æ–¥–Ω–∏–º —ñ —Ç–∏–º –∂–µ –∑–≤–æ—Ä–æ—Ç–Ω–∏–º –ø—Ä–æ–∫—Å—ñ —ñ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç wildcard, –∫–æ–∞–ª–µ—Å—Ü—ñ—é–≤–∞–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ, —â–æ –∑–∞–ø–∏—Ç–∏ –¥–æ `secure.example.com` –±—É–¥—É—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–ª–µ–Ω—ñ –±–µ–∫–µ–Ω–¥–æ–º WordPress, –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —Ç–∞–∫—ñ —è–∫ XSS.

–©–æ–± —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –∫–æ–∞–ª–µ—Å—Ü—ñ—é–≤–∞–Ω–Ω—è–º –∑'—î–¥–Ω–∞–Ω–Ω—è, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–∫–ª–∞–¥–∫—É –ú–µ—Ä–µ–∂–∞ Chrome –∞–±–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Wireshark. –û—Å—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
–ó–∞–≥—Ä–æ–∑–∞ –Ω–∞—Ä–∞–∑—ñ –æ–±–º–µ–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ —Ä—ñ–¥–∫—ñ—Å—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø–∏—Ç—É —Ç–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å HTTP/2. –û–¥–Ω–∞–∫ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—ñ –∑–º—ñ–Ω–∏ –≤ HTTP/3, —è–∫—ñ –ø–æ—Å–ª–∞–±–ª—é—é—Ç—å –≤–∏–º–æ–≥—É –¥–æ –∑–±—ñ–≥—É IP-–∞–¥—Ä–µ—Å–∏, –º–æ–∂—É—Ç—å —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –ø–æ–≤–µ—Ä—Ö–Ω—é –∞—Ç–∞–∫–∏, —Ä–æ–±–ª—è—á–∏ —Å–µ—Ä–≤–µ—Ä–∏ –∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º wildcard –±—ñ–ª—å—à –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∞—Ç–∞–∫–∏ MITM.

–ù–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø–∏—Ç—É –≤ –∑–≤–æ—Ä–æ—Ç–Ω–∏—Ö –ø—Ä–æ–∫—Å—ñ —Ç–∞ –æ–±–µ—Ä–µ–∂–Ω—ñ—Å—Ç—å –∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞–º–∏ TLS wildcard, –æ—Å–æ–±–ª–∏–≤–æ –∑ –ø–æ—è–≤–æ—é HTTP/3. –†–µ–≥—É–ª—è—Ä–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ü–∏—Ö —Å–∫–ª–∞–¥–Ω–∏—Ö, –≤–∑–∞—î–º–æ–ø–æ–≤'—è–∑–∞–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤–µ–±-–±–µ–∑–ø–µ–∫–∏.
