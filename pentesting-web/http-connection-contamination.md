# HTTP Connection Contamination

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Questo √® un riepilogo del post: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Controllalo per ulteriori dettagli!

I browser web possono riutilizzare una singola connessione HTTP/2+ per diversi siti web attraverso [HTTP connection coalescing](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), date indirizzi IP condivisi e un certificato TLS comune. Tuttavia, questo pu√≤ confliggere con il **first-request routing** nei reverse proxy, dove le richieste successive sono dirette al back-end determinato dalla prima richiesta. Questo errore di instradamento pu√≤ portare a vulnerabilit√† di sicurezza, particolarmente quando combinato con certificati TLS wildcard e domini come `*.example.com`.

Ad esempio, se `wordpress.example.com` e `secure.example.com` sono entrambi serviti dallo stesso reverse proxy e hanno un certificato wildcard comune, la coalescenza della connessione di un browser potrebbe portare le richieste a `secure.example.com` a essere elaborate erroneamente dal back-end di WordPress, sfruttando vulnerabilit√† come XSS.

Per osservare la coalescenza delle connessioni, si possono utilizzare la scheda Rete di Chrome o strumenti come Wireshark. Ecco un frammento per il test:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
La minaccia √® attualmente limitata a causa della rarit√† del routing della prima richiesta e della complessit√† di HTTP/2. Tuttavia, le modifiche proposte in HTTP/3, che allentano il requisito di corrispondenza dell'indirizzo IP, potrebbero ampliare la superficie di attacco, rendendo i server con un certificato wildcard pi√π vulnerabili senza necessit√† di un attacco MITM.

Le migliori pratiche includono l'evitare il routing della prima richiesta nei proxy inversi e prestare attenzione ai certificati TLS wildcard, specialmente con l'avvento di HTTP/3. Test regolari e consapevolezza di queste vulnerabilit√† complesse e interconnesse sono cruciali per mantenere la sicurezza web.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
