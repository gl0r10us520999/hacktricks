# HTTP Connection Contamination

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**この記事の要約は次のとおりです: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**。詳細はそちらをご覧ください！

ウェブブラウザは、共有IPアドレスと共通のTLS証明書がある場合、異なるウェブサイトのために単一のHTTP/2+接続を再利用できます[HTTP接続のコアレッシング](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing)を通じて。しかし、これはリバースプロキシにおける**最初のリクエストルーティング**と衝突する可能性があり、後続のリクエストが最初のリクエストによって決定されたバックエンドに送信されます。この誤ルーティングは、特にワイルドカードTLS証明書や`*.example.com`のようなドメインと組み合わせると、セキュリティの脆弱性を引き起こす可能性があります。

例えば、`wordpress.example.com`と`secure.example.com`が同じリバースプロキシによって提供され、共通のワイルドカード証明書を持っている場合、ブラウザの接続コアレッシングにより、`secure.example.com`へのリクエストが誤ってWordPressバックエンドによって処理され、XSSのような脆弱性を悪用される可能性があります。

接続コアレッシングを観察するには、ChromeのネットワークタブやWiresharkのようなツールを使用できます。テスト用のスニペットは次のとおりです:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
現在の脅威は、最初のリクエストルーティングの稀少性とHTTP/2の複雑さにより制限されています。しかし、IPアドレスの一致要件を緩和するHTTP/3の提案された変更は、攻撃面を広げ、MITM攻撃を必要とせずにワイルドカード証明書を持つサーバーをより脆弱にする可能性があります。

ベストプラクティスには、リバースプロキシでの最初のリクエストルーティングを避け、特にHTTP/3の登場に伴い、ワイルドカードTLS証明書に注意することが含まれます。これらの複雑で相互に関連する脆弱性について定期的にテストし、意識することは、ウェブセキュリティを維持するために重要です。

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
