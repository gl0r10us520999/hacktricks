# Timing Attacks

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

{% hint style="warning" %}
Para obter uma compreens√£o profunda desta t√©cnica, consulte o relat√≥rio original em [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)
{% endhint %}

## Basic Information

O objetivo b√°sico de um ataque de timing √© basicamente ser capaz de responder a perguntas complicadas ou detectar funcionalidades ocultas apenas **verificando as diferen√ßas de tempo nas respostas de solicita√ß√µes semelhantes**.

Tradicionalmente, isso tem sido muito complicado devido √† lat√™ncia e jitter introduzidos tanto pela rede quanto pelo servidor. No entanto, desde a descoberta e melhoria do [**Race Condition Single Packet attack**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization), √© poss√≠vel usar essa t√©cnica para remover todos os ru√≠dos de atrasos de rede da equa√ß√£o.\
Deixando apenas os **atrasos do servidor**, o ataque de timing se torna mais f√°cil de descobrir e abusar.

## Discoveries

### Hidden Attack Surface

No post do blog √© comentado como, usando essa t√©cnica, foi poss√≠vel encontrar par√¢metros ocultos e at√© cabe√ßalhos apenas verificando que sempre que o par√¢metro ou cabe√ßalho estava presente na solicita√ß√£o, havia uma **diferen√ßa de tempo de cerca de 5ms**. Na verdade, essa t√©cnica de descoberta foi adicionada ao **Param Miner** no Burp Suite.

Essas diferen√ßas de tempo podem ocorrer porque uma **solicita√ß√£o DNS** foi realizada, algum **log foi escrito** devido a uma entrada inv√°lida ou porque alguns **checks s√£o realizados** quando um par√¢metro est√° presente na solicita√ß√£o.

Algo que voc√™ precisa lembrar ao realizar esse tipo de ataque √© que, devido √† natureza oculta da superf√≠cie, voc√™ pode n√£o saber qual √© a verdadeira causa das diferen√ßas de tempo.

### Reverse Proxy Misconfigurations

Na mesma pesquisa, foi compartilhado que a t√©cnica de timing era √≥tima para descobrir "SSRFs com escopo" (que s√£o SSRFs que podem acessar apenas IPs/dom√≠nios permitidos). Apenas **verificando a diferen√ßa de tempo quando um dom√≠nio permitido √© definido** em compara√ß√£o com quando um dom√≠nio n√£o permitido √© definido ajuda a descobrir proxies abertos, mesmo que a resposta seja a mesma.

Uma vez que um proxy aberto com escopo √© descoberto, foi poss√≠vel encontrar alvos v√°lidos analisando subdom√≠nios conhecidos do alvo, e isso permitiu:

* **Contornar firewalls** acessando subdom√≠nios restritos via o **proxy aberto** em vez de pela internet.
* Al√©m disso, abusando de um **proxy aberto**, tamb√©m √© poss√≠vel **descobrir novos subdom√≠nios acess√≠veis apenas internamente.**
* **Ataques de impersona√ß√£o de Front-End**: Servidores de front-end normalmente adicionam cabe√ßalhos para o backend, como `X-Forwarded-For` ou `X-Real-IP`. Proxies abertos que recebem esses cabe√ßalhos os adicionar√£o ao endpoint solicitado, portanto, um atacante poderia acessar ainda mais dom√≠nios internos adicionando esses cabe√ßalhos com valores permitidos.

## References

* [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
