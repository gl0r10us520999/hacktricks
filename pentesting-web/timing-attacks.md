# Timing Attacks

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

{% hint style="warning" %}
Um ein tiefes Verst√§ndnis dieser Technik zu erlangen, √ºberpr√ºfe den Originalbericht von [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)
{% endhint %}

## Grundinformationen

Das grundlegende Ziel eines Timing-Angriffs besteht darin, komplizierte Fragen zu beantworten oder versteckte Funktionen zu erkennen, indem man einfach **die Zeitunterschiede in den Antworten auf √§hnliche Anfragen √ºberpr√ºft**.

Traditionell war dies sehr kompliziert, da die Latenz und der Jitter sowohl durch das Netzwerk als auch durch den Server verursacht werden. Seit der Entdeckung und Verbesserung des [**Race Condition Single Packet Angriffs**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization) ist es jedoch m√∂glich, diese Technik zu verwenden, um alle netzwerkbedingten Verz√∂gerungen aus der Gleichung zu entfernen.\
Wenn nur die **Serververz√∂gerungen** √ºbrig bleiben, wird der Timing-Angriff einfacher zu entdecken und auszunutzen.

## Entdeckungen

### Versteckte Angriffsfl√§che

In dem Blogbeitrag wird kommentiert, wie es mit dieser Technik m√∂glich war, versteckte Parameter und sogar Header zu finden, indem einfach √ºberpr√ºft wurde, dass es immer dann einen **Zeitunterschied von etwa 5 ms** gab, wenn der Parameter oder Header in der Anfrage vorhanden war. Tats√§chlich wurde diese Entdeckungstechnik zu **Param Miner** in Burp Suite hinzugef√ºgt.

Diese Zeitunterschiede k√∂nnten darauf zur√ºckzuf√ºhren sein, dass eine **DNS-Anfrage** durchgef√ºhrt wurde, einige **Protokolle geschrieben** wurden, weil eine ung√ºltige Eingabe vorlag, oder weil einige **√úberpr√ºfungen durchgef√ºhrt werden**, wenn ein Parameter in der Anfrage vorhanden ist.

Etwas, das du dir merken musst, wenn du diese Art von Angriffen durchf√ºhrst, ist, dass du aufgrund der versteckten Natur der Oberfl√§che m√∂glicherweise nicht wei√üt, was die tats√§chliche Ursache der Zeitunterschiede ist.

### Reverse Proxy Fehlkonfigurationen

In derselben Forschung wurde geteilt, dass die Timing-Technik gro√üartig war, um "scoped SSRFs" zu entdecken (das sind SSRFs, die nur auf erlaubte IPs/Domains zugreifen k√∂nnen). Einfach **den Zeitunterschied zu √ºberpr√ºfen, wenn eine erlaubte Domain gesetzt ist** im Vergleich zu einer nicht erlaubten Domain hilft, offene Proxys zu entdecken, selbst wenn die Antwort die gleiche ist.

Sobald ein scoped offener Proxy entdeckt wurde, war es m√∂glich, g√ºltige Ziele zu finden, indem bekannte Subdomains des Ziels geparst wurden, und dies erm√∂glichte:

* **Firewalls zu umgehen**, indem auf eingeschr√§nkte Subdomains √ºber den **offenen Proxy** anstelle des Internets zugegriffen wird.
* Dar√ºber hinaus ist es auch m√∂glich, durch den Missbrauch eines **offenen Proxys** **neue Subdomains zu entdecken, die nur intern zug√§nglich sind.**
* **Front-End-Imitationsangriffe**: Front-End-Server f√ºgen normalerweise Header f√ºr das Backend wie `X-Forwarded-For` oder `X-Real-IP` hinzu. Offene Proxys, die diese Header empfangen, f√ºgen sie dem angeforderten Endpunkt hinzu, daher k√∂nnte ein Angreifer in der Lage sein, noch mehr interne Domains zuzugreifen, indem er diese Header mit zugelassenen Werten hinzuf√ºgt.

## Referenzen

* [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
