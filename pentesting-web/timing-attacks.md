# Timing Attacks

{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
学习和实践 GCP 黑客技术：<img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 分享黑客技巧。

</details>
{% endhint %}

{% hint style="warning" %}
要深入了解此技术，请查看原始报告 [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)
{% endhint %}

## 基本信息

时序攻击的基本目标是通过**检查相似请求的响应时间差异**来回答复杂问题或检测隐藏功能。

传统上，由于网络和服务器引入的延迟和抖动，这一直非常复杂。然而，自从发现和改进了 [**竞争条件单包攻击**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization) 后，可以使用此技术消除所有网络延迟噪声。\
只留下**服务器延迟**使得时序攻击更容易被发现和利用。

## 发现

### 隐藏攻击面

在博客文章中提到，使用此技术可以找到隐藏参数甚至头部，只需检查每当参数或头部出现在请求中时，**时间差约为 5 毫秒**。实际上，这种发现技术已被添加到 Burp Suite 的 **Param Miner** 中。

这些时间差可能是因为执行了**DNS 请求**、因为无效输入而**写入了一些日志**，或者因为在请求中存在参数时**执行了一些检查**。

进行此类攻击时需要记住的一点是，由于表面的隐藏性质，您可能不知道时间差的实际原因。

### 反向代理配置错误

在同一研究中，分享了时序技术非常适合发现“范围 SSRF”（只能访问允许的 IP/域的 SSRF）。只需**检查设置允许域时的时间差**与设置不允许域时的时间差，有助于发现开放代理，即使响应相同。

一旦发现范围开放代理，就可以通过解析目标的已知子域找到有效目标，这使得：

* **通过开放代理绕过防火墙**，访问受限子域，而不是通过互联网
* 此外，利用**开放代理**，还可以**发现仅在内部可访问的新子域。**
* **前端冒充攻击**：前端服务器通常会为后端添加头部，如 `X-Forwarded-For` 或 `X-Real-IP`。接收这些头部的开放代理将其添加到请求的端点，因此，攻击者可以通过将这些头部添加到白名单值来访问更多内部域。

## 参考文献

* [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{% hint style="success" %}
学习和实践 AWS 黑客技术：<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
学习和实践 GCP 黑客技术：<img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 查看 [**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass) 或 **关注** 我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub 仓库提交 PR 分享黑客技巧。

</details>
{% endhint %}
