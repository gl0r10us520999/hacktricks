# Timing Attacks

{% hint style="success" %}
Učite i vežbajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Učite i vežbajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **nas pratite na** **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

{% hint style="warning" %}
Za sticanje dubokog razumevanja ove tehnike proverite originalni izveštaj sa [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)
{% endhint %}

## Osnovne informacije

Osnovni cilj napada vremenskog razmaka je u suštini da se mogu odgovoriti složena pitanja ili otkriti skrivene funkcionalnosti jednostavno **proveravanjem vremenskih razlika u odgovorima na slične zahteve**.

Tradicionalno, ovo je bilo veoma komplikovano zbog latencije i jitter-a koje uvode i mreža i server. Međutim, od otkrića i poboljšanja [**Race Condition Single Packet napada**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization), moguće je koristiti ovu tehniku da se uklone svi mrežni kašnjenja iz jednačine.\
Ostavljajući samo **kašnjenja servera** čini napad vremenskog razmaka lakšim za otkrivanje i zloupotrebu.

## Otkrića

### Skrivena površina napada

U blog postu se komentariše kako je korišćenjem ove tehnike bilo moguće pronaći skrivene parametre i čak zaglavlja jednostavno proveravajući da kada je parametar ili zaglavlje prisutno u zahtevu, postoji **vremenska razlika od oko 5ms**. U stvari, ova tehnika otkrivanja je dodata u **Param Miner** u Burp Suite.

Ove vremenske razlike mogu biti rezultat **DNS zahteva**, nekog **logovanja** zbog nevalidnog unosa ili zato što se neki **provere vrše** kada je parametar prisutan u zahtevu.

Nešto što treba da zapamtite kada izvodite ovakve napade je da zbog skrivene prirode površine, možda nećete znati koja je stvarna prava uzrok vremenskih razlika.

### Pogrešne konfiguracije reverznih proksija

U istom istraživanju, podeljeno je da je tehnika vremenskog razmaka bila odlična za otkrivanje "scoped SSRF-a" (koji su SSRF-ovi koji mogu pristupiti samo dozvoljenim IP/domenima). Jednostavno **proveravanje vremenske razlike kada je postavljen dozvoljeni domen** u poređenju sa kada je postavljen nedozvoljeni domen pomaže u otkrivanju otvorenih proksija čak i ako je odgovor isti.

Kada se otkrije scoped otvoreni proksi, bilo je moguće pronaći validne ciljeve parsiranjem poznatih poddomena cilja i to je omogućilo:

* **Obilaženje vatrozida** pristupanjem ograničenim poddomenima putem **otvorenog proksija** umesto preko interneta
* Štaviše, zloupotrebom **otvorenog proksija** takođe je moguće **otkriti nove poddomene dostupne samo interno.**
* **Napadi na imitaciju front-end-a**: Front-end serveri obično dodaju zaglavlja za backend kao što su `X-Forwarded-For` ili `X-Real-IP`. Otvoreni proksiji koji primaju ova zaglavlja će ih dodati traženom kraju, stoga bi napadač mogao da pristupi još više internih domena dodavanjem ovih zaglavlja sa vrednostima koje su na beloj listi.

## Reference

* [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{% hint style="success" %}
Učite i vežbajte AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Učite i vežbajte GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **nas pratite na** **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
