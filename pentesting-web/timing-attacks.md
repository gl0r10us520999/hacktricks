# Ataki Czasowe

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się sztuczkami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów na GitHubie.

</details>
{% endhint %}

{% hint style="warning" %}
Aby uzyskać głębokie zrozumienie tej techniki, sprawdź oryginalny raport z [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)
{% endhint %}

## Podstawowe Informacje

Podstawowym celem ataku czasowego jest w zasadzie możliwość odpowiedzi na skomplikowane pytania lub wykrycia ukrytych funkcji poprzez **sprawdzanie różnic czasowych w odpowiedziach na podobne żądania**.

Tradycyjnie było to bardzo skomplikowane z powodu opóźnień i jittera wprowadzanego zarówno przez sieć, jak i serwer. Jednak od odkrycia i poprawy [**ataku Race Condition Single Packet**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization), możliwe jest wykorzystanie tej techniki do usunięcia wszystkich opóźnień sieciowych z równania.\
Pozostawienie tylko **opóźnień serwera** ułatwia odkrywanie i nadużywanie ataków czasowych.

## Odkrycia

### Ukryta Powierzchnia Ataku

W poście na blogu omówiono, jak przy użyciu tej techniki udało się znaleźć ukryte parametry, a nawet nagłówki, po prostu sprawdzając, że za każdym razem, gdy parametr lub nagłówek był obecny w żądaniu, występowała **różnica czasowa wynosząca około 5 ms**. W rzeczywistości ta technika odkrywania została dodana do **Param Miner** w Burp Suite.

Te różnice czasowe mogą wynikać z tego, że wykonano **żądanie DNS**, zapisano jakiś **log** z powodu nieprawidłowego wejścia lub ponieważ wykonano jakieś **sprawdzenia**, gdy parametr był obecny w żądaniu.

Co musisz pamiętać, wykonując tego rodzaju ataki, to że z powodu ukrytej natury powierzchni, możesz nie wiedzieć, co jest rzeczywistą przyczyną różnic czasowych.

### Błędy Konfiguracji Reverse Proxy

W tym samym badaniu podano, że technika czasowa była świetna do odkrywania "ograniczonych SSRF" (które są SSRF, które mogą uzyskać dostęp tylko do dozwolonych adresów IP/domen). Po prostu **sprawdzając różnicę czasową, gdy ustawiona jest dozwolona domena** w porównaniu do sytuacji, gdy ustawiona jest niedozwolona domena, pomaga odkryć otwarte proxy, nawet jeśli odpowiedź jest taka sama.

Gdy odkryto ograniczone otwarte proxy, możliwe było znalezienie ważnych celów poprzez analizowanie znanych subdomen celu, co pozwoliło na:

* **Ominięcie zapór** poprzez dostęp do zastrzeżonych subdomen za pośrednictwem **otwartego proxy** zamiast przez internet
* Co więcej, nadużywając **otwartego proxy**, możliwe jest również **odkrycie nowych subdomen dostępnych tylko wewnętrznie.**
* **Ataki naśladujące Front-End**: Serwery front-endowe zazwyczaj dodają nagłówki dla backendu, takie jak `X-Forwarded-For` lub `X-Real-IP`. Otwarte proxy, które otrzymuje te nagłówki, doda je do żądanej końcówki, w związku z czym atakujący mógłby uzyskać dostęp do jeszcze większej liczby wewnętrznych domen, dodając te nagłówki do wartości z białej listy.

## Referencje

* [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{% hint style="success" %}
Ucz się i ćwicz Hacking AWS:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Ucz się i ćwicz Hacking GCP: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Wsparcie dla HackTricks</summary>

* Sprawdź [**plany subskrypcyjne**](https://github.com/sponsors/carlospolop)!
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegram**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się sztuczkami hackingowymi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów na GitHubie.

</details>
{% endhint %}
