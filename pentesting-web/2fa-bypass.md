# 2FA/MFA/OTP Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Mbinu za Kuepuka Uthibitisho wa Hatua Mbili (2FA)**

### **Upatikanaji wa Moja kwa Moja wa Mwisho**

Ili kuepuka 2FA, pata upatikanaji wa mwisho moja kwa moja, kujua njia ni muhimu. Ikiwa haifanikiwi, badilisha **Referrer header** ili kuiga urambazaji kutoka kwenye ukurasa wa uthibitisho wa 2FA.

### **Matumizi ya Tokeni Zilizotumika Tangu Zamani**

Kurejelea tokeni zilizotumika awali kwa uthibitisho ndani ya akaunti kunaweza kuwa na ufanisi.

### **Matumizi ya Tokeni Zisizotumika**

Kutoa tokeni kutoka kwenye akaunti yako mwenyewe ili kuepuka 2FA katika akaunti nyingine inaweza kujaribiwa.

### **Ufunuo wa Tokeni**

Chunguza ikiwa tokeni imefunuliwa katika jibu kutoka kwa programu ya wavuti.

### **Kunyanyua Kiungo cha Uthibitisho**

Kutumia **kiungo cha uthibitisho wa barua pepe kilichotumwa wakati wa uundaji wa akaunti** kunaweza kuruhusu upatikanaji wa wasifu bila 2FA, kama ilivyoangaziwa katika [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulering ya Kikao**

Kuanza vikao vya akaunti ya mtumiaji na ya mwathirika, na kukamilisha 2FA kwa akaunti ya mtumiaji bila kuendelea, inaruhusu jaribio la kupata hatua inayofuata katika mtiririko wa akaunti ya mwathirika, ikitumia mapungufu ya usimamizi wa kikao cha nyuma.

### **Mekaniki ya Kurekebisha Nenosiri**

Kuchunguza kazi ya kurekebisha nenosiri, ambayo inamwingiza mtumiaji kwenye programu baada ya kurekebisha, kwa uwezo wake wa kuruhusu marekebisho mengi kwa kutumia kiungo kimoja ni muhimu. Kuingia na taarifa mpya za kurekebisha kunaweza kuepuka 2FA.

### **Kuathiri Jukwaa la OAuth**

Kuharibu akaunti ya mtumiaji kwenye jukwaa la **OAuth** lililoaminika (mfano, Google, Facebook) kunaweza kutoa njia ya kuepuka 2FA.

### **Mashambulizi ya Brute Force**

#### **Ukosefu wa Kiwango cha Kiwango**

Ukosefu wa kikomo kwenye idadi ya majaribio ya msimbo unaruhusu mashambulizi ya brute force, ingawa kikomo cha kimya kinachowezekana kinapaswa kuzingatiwa.

Kumbuka kwamba hata kama kikomo cha kiwango kiko, unapaswa kujaribu kuona ikiwa jibu ni tofauti wakati OTP halali inatumwa. Katika [**post hii**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), mtafiti wa makosa aligundua kwamba hata kama kikomo cha kiwango kinachochewa baada ya majaribio 20 yasiyofanikiwa kwa kujibu na 401, ikiwa halali ilitumwa jibu la 200 lilipokelewa.

#### **Brute Force Polepole**

Shambulio la brute force polepole linaweza kufanyika ambapo mipaka ya mtiririko ipo bila kikomo cha jumla.

#### **Kurejesha Kikomo cha Kutuma Msimbo Tena**

Kutuma tena msimbo kunarejesha kikomo cha kiwango, kuruhusu majaribio ya kuendelea ya brute force.

#### **Kuepuka Kikomo cha Kiwango cha Mteja**

Hati inaelezea mbinu za kuepuka kikomo cha kiwango cha mteja.

#### **Vitendo vya Ndani Havina Kikomo cha Kiwango**

Mipaka ya kiwango inaweza kulinda majaribio ya kuingia lakini si vitendo vya ndani vya akaunti.

#### **Gharama za Kutuma Msimbo wa SMS Tena**

Kutuma tena misimbo kupitia SMS kwa wingi kunagharimu kampuni, ingawa hakuepuki 2FA.

#### **Uundaji wa OTP Usio na Mwisho**

Uundaji wa OTP usio na mwisho kwa kutumia misimbo rahisi unaruhusu brute force kwa kujaribu seti ndogo ya misimbo.

### **Kunyanyua Masharti ya Mbio**

Kunyanyua masharti ya mbio kwa kuepuka 2FA kunaweza kupatikana katika hati maalum.

### **Vulnerabilities za CSRF/Clickjacking**

Kuchunguza vulnerabilities za CSRF au Clickjacking ili kuzima 2FA ni mkakati unaofaa.

### **Matumizi ya Kipengele cha "Nikumbuke"**

#### **Thamani za Keki Zinazoweza Kutarajiwa**

Kukisia thamani ya keki ya "nikumbuke" kunaweza kuepuka vizuizi.

#### **Uigaji wa Anwani ya IP**

Kuingiza anwani ya IP ya mwathirika kupitia **X-Forwarded-For** header kunaweza kuepuka vizuizi.

### **Matumizi ya Matoleo ya Kale**

#### **Subdomains**

Kujaribu subdomains kunaweza kutumia matoleo ya zamani yasiyo na msaada wa 2FA au kuwa na utekelezaji dhaifu wa 2FA.

#### **API Endpoints**

Matoleo ya zamani ya API, yanayoonyeshwa na njia za saraka za /v\*/, yanaweza kuwa na udhaifu kwa mbinu za kuepuka 2FA.

### **Kushughulikia Vikao vya Awali**

Kumaliza vikao vilivyopo wakati wa kuanzishwa kwa 2FA kunalinda akaunti dhidi ya upatikanaji usioidhinishwa kutoka kwa vikao vilivyoharibiwa.

### **Mapungufu ya Udhibiti wa Upatikanaji na Nambari za Akiba**

Uundaji wa haraka na uwezekano wa kupata nambari za akiba bila idhini mara tu 2FA inapoanzishwa, hasa na mipangilio ya CORS isiyo sahihi/vulnerabilities za XSS, kuna hatari.

### **Ufunuo wa Taarifa kwenye Ukurasa wa 2FA**

Ufunuo wa taarifa nyeti (mfano, nambari ya simu) kwenye ukurasa wa uthibitisho wa 2FA ni wasiwasi.

### **Kurekebisha Nenosiri na Kuzima 2FA**

Mchakato unaoonyesha mbinu inayoweza kuepuka inajumuisha uundaji wa akaunti, kuanzishwa kwa 2FA, kurekebisha nenosiri, na kuingia bila hitaji la 2FA.

### **Maombi ya Kijakazi**

Kutumia maombi ya kijakazi ili kuficha majaribio ya brute force au kupotosha mifumo ya kikomo cha kiwango kunaongeza safu nyingine kwa mikakati ya kuepuka. Kuunda maombi kama haya kunahitaji uelewa wa kina wa hatua za usalama za programu na tabia za kikomo cha kiwango.

### Makosa ya Ujenzi wa OTP

Ikiwa OTP inaundwa kwa msingi wa data ambayo mtumiaji tayari ana au ambayo inatumwa kabla ya kuunda OTP, inawezekana kwa mtumiaji pia kuunda na kuiepuka.

## References

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
