# 2FA/MFA/OTP Bypass

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

## **Techniken zum Umgehen der erweiterten Zwei-Faktor-Authentifizierung**

### **Direkter Zugriff auf Endpunkte**

Um 2FA zu umgehen, greifen Sie direkt auf den nachfolgenden Endpunkt zu, wobei der Pfad entscheidend ist. Wenn dies nicht erfolgreich ist, √§ndern Sie den **Referrer-Header**, um die Navigation von der 2FA-√úberpr√ºfungsseite zu imitieren.

### **Token-Wiederverwendung**

Die Wiederverwendung zuvor verwendeter Tokens zur Authentifizierung innerhalb eines Kontos kann effektiv sein.

### **Nutzung ungenutzter Tokens**

Es kann versucht werden, ein Token aus dem eigenen Konto zu extrahieren, um 2FA in einem anderen Konto zu umgehen.

### **Offenlegung des Tokens**

Untersuchen Sie, ob das Token in einer Antwort der Webanwendung offengelegt wird.

### **Ausnutzung des Best√§tigungslinks**

Die Verwendung des **E-Mail-Best√§tigungslinks, der bei der Kontoerstellung gesendet wird**, kann den Zugriff auf das Profil ohne 2FA erm√∂glichen, wie in einem detaillierten [Beitrag](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) hervorgehoben.

### **Sitzungsmanipulation**

Das Initiieren von Sitzungen sowohl f√ºr das Konto des Benutzers als auch f√ºr das Konto eines Opfers und das Abschlie√üen von 2FA f√ºr das Benutzerkonto, ohne fortzufahren, erm√∂glicht den Versuch, auf den n√§chsten Schritt im Ablauf des Opfers zuzugreifen und die Einschr√§nkungen des Backend-Sitzungsmanagements auszunutzen.

### **Passwortzur√ºcksetzmechanismus**

Die Untersuchung der Passwortzur√ºcksetzfunktion, die einen Benutzer nach dem Zur√ºcksetzen in die Anwendung einloggt, ist entscheidend, um festzustellen, ob mehrere Zur√ºcksetzungen mit demselben Link m√∂glich sind. Das Einloggen mit den neu zur√ºckgesetzten Anmeldeinformationen k√∂nnte 2FA umgehen.

### **Kompromittierung der OAuth-Plattform**

Die Kompromittierung eines Benutzerkontos auf einer vertrauensw√ºrdigen **OAuth**-Plattform (z. B. Google, Facebook) kann einen Weg bieten, 2FA zu umgehen.

### **Brute-Force-Angriffe**

#### **Fehlende Ratenbegrenzung**

Das Fehlen einer Begrenzung der Anzahl der Codeversuche erm√∂glicht Brute-Force-Angriffe, obwohl potenzielle stille Ratenbegrenzungen ber√ºcksichtigt werden sollten.

Beachten Sie, dass Sie selbst bei einer bestehenden Ratenbegrenzung versuchen sollten zu sehen, ob die Antwort unterschiedlich ist, wenn der g√ºltige OTP gesendet wird. In [**diesem Beitrag**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) entdeckte der Bug-J√§ger, dass selbst wenn eine Ratenbegrenzung nach 20 erfolglosen Versuchen durch eine Antwort mit 401 ausgel√∂st wird, eine 200-Antwort empfangen wurde, wenn der g√ºltige gesendet wurde.

#### **Langsame Brute-Force**

Ein langsamer Brute-Force-Angriff ist m√∂glich, wenn Flussratenbegrenzungen existieren, ohne eine √ºbergeordnete Ratenbegrenzung.

#### **Zur√ºcksetzen der Code-Wiederholungsgrenze**

Das erneute Senden des Codes setzt die Ratenbegrenzung zur√ºck und erleichtert fortgesetzte Brute-Force-Versuche.

#### **Umgehung der clientseitigen Ratenbegrenzung**

Ein Dokument beschreibt Techniken zur Umgehung der clientseitigen Ratenbegrenzung.

#### **Interne Aktionen ohne Ratenbegrenzung**

Ratenbegrenzungen k√∂nnen Login-Versuche sch√ºtzen, jedoch nicht interne Kontenaktionen.

#### **Kosten f√ºr das erneute Senden von SMS-Codes**

√úberm√§√üiges erneutes Senden von Codes per SMS verursacht Kosten f√ºr das Unternehmen, umgeht jedoch nicht 2FA.

#### **Unendliche OTP-Regeneration**

Endlose OTP-Generierung mit einfachen Codes erm√∂glicht Brute-Force, indem eine kleine Menge von Codes erneut versucht wird.

### **Ausnutzung von Race Conditions**

Die Ausnutzung von Race Conditions zum Umgehen von 2FA kann in einem bestimmten Dokument gefunden werden.

### **CSRF/Clickjacking-Schwachstellen**

Die Untersuchung von CSRF- oder Clickjacking-Schwachstellen zur Deaktivierung von 2FA ist eine praktikable Strategie.

### **Ausnutzung der "Erinnere dich an mich"-Funktion**

#### **Vorhersehbare Cookie-Werte**

Das Erraten des Wertes des "Erinnere dich an mich"-Cookies kann Einschr√§nkungen umgehen.

#### **IP-Adressensimulation**

Die Simulation der IP-Adresse des Opfers √ºber den **X-Forwarded-For**-Header kann Einschr√§nkungen umgehen.

### **Verwendung √§lterer Versionen**

#### **Subdomains**

Das Testen von Subdomains kann veraltete Versionen verwenden, die keine 2FA-Unterst√ºtzung bieten oder anf√§llige 2FA-Implementierungen enthalten.

#### **API-Endpunkte**

√Ñltere API-Versionen, die durch /v\*/-Verzeichnispfade angezeigt werden, k√∂nnen anf√§llig f√ºr Methoden zum Umgehen von 2FA sein.

### **Umgang mit vorherigen Sitzungen**

Das Beenden bestehender Sitzungen bei Aktivierung von 2FA sichert Konten gegen unbefugten Zugriff aus kompromittierten Sitzungen.

### **Zugriffskontrollfehler mit Backup-Codes**

Die sofortige Generierung und potenzielle unbefugte Abholung von Backup-Codes bei Aktivierung von 2FA, insbesondere bei CORS-Fehlkonfigurationen/XSS-Schwachstellen, stellt ein Risiko dar.

### **Offenlegung von Informationen auf der 2FA-Seite**

Die Offenlegung sensibler Informationen (z. B. Telefonnummer) auf der 2FA-√úberpr√ºfungsseite ist ein Anliegen.

### **Passwortzur√ºcksetzung, die 2FA deaktiviert**

Ein Prozess, der eine potenzielle Umgehungsmethode demonstriert, umfasst die Kontoerstellung, Aktivierung von 2FA, Passwortzur√ºcksetzung und anschlie√üendes Einloggen ohne die 2FA-Anforderung.

### **T√§uschungsanfragen**

Die Nutzung von T√§uschungsanfragen zur Verschleierung von Brute-Force-Versuchen oder zur Irref√ºhrung von Ratenbegrenzungsmechanismen f√ºgt eine weitere Ebene zu Umgehungsstrategien hinzu. Das Erstellen solcher Anfragen erfordert ein nuanciertes Verst√§ndnis der Sicherheitsma√ünahmen und des Verhaltens der Ratenbegrenzung der Anwendung.

### OTP-Konstruktionsfehler

Falls der OTP basierend auf Daten erstellt wird, die der Benutzer bereits hat oder die zuvor gesendet werden, um den OTP zu erstellen, ist es m√∂glich, dass der Benutzer ihn ebenfalls generieren und umgehen kann.

## Referenzen

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
