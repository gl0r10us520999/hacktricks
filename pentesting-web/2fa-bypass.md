# Bypass 2FA/MFA/OTP

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## **Techniques de contournement de l'authentification √† deux facteurs am√©lior√©e**

### **Acc√®s direct √† l'endpoint**

Pour contourner 2FA, acc√©dez directement √† l'endpoint suivant, conna√Ætre le chemin est crucial. Si cela √©choue, modifiez l'**en-t√™te Referrer** pour imiter la navigation depuis la page de v√©rification 2FA.

### **R√©utilisation de jetons**

R√©utiliser des jetons pr√©c√©demment utilis√©s pour l'authentification dans un compte peut √™tre efficace.

### **Utilisation de jetons non utilis√©s**

Extraire un jeton de son propre compte pour contourner 2FA dans un autre compte peut √™tre tent√©.

### **Exposition de jeton**

V√©rifiez si le jeton est divulgu√© dans une r√©ponse de l'application web.

### **Exploitation du lien de v√©rification**

Utiliser le **lien de v√©rification par e-mail envoy√© lors de la cr√©ation du compte** peut permettre l'acc√®s au profil sans 2FA, comme soulign√© dans un [post d√©taill√©](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulation de session**

Initier des sessions pour le compte de l'utilisateur et celui d'une victime, et compl√©ter 2FA pour le compte de l'utilisateur sans continuer, permet d'essayer d'acc√©der √† l'√©tape suivante dans le flux de compte de la victime, exploitant les limitations de gestion de session backend.

### **M√©canisme de r√©initialisation de mot de passe**

Il est crucial d'examiner la fonction de r√©initialisation de mot de passe, qui connecte un utilisateur √† l'application apr√®s la r√©initialisation, pour son potentiel √† permettre plusieurs r√©initialisations en utilisant le m√™me lien. Se connecter avec les nouvelles informations d'identification r√©initialis√©es pourrait contourner 2FA.

### **Compromission de plateforme OAuth**

Compromettre le compte d'un utilisateur sur une plateforme **OAuth** de confiance (par exemple, Google, Facebook) peut offrir un moyen de contourner 2FA.

### **Attaques par force brute**

#### **Absence de limite de taux**

L'absence de limite sur le nombre de tentatives de code permet des attaques par force brute, bien que des limitations de taux silencieuses potentielles doivent √™tre consid√©r√©es.

Notez que m√™me si une limite de taux est en place, vous devriez essayer de voir si la r√©ponse est diff√©rente lorsque le OTP valide est envoy√©. Dans [**ce post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), le chasseur de bugs a d√©couvert que m√™me si une limite de taux est d√©clench√©e apr√®s 20 tentatives infructueuses en r√©pondant avec 401, si le valide √©tait envoy√©, une r√©ponse 200 √©tait re√ßue.

#### **Force brute lente**

Une attaque par force brute lente est viable l√† o√π des limites de flux existent sans une limite de taux globale.

#### **R√©initialisation de la limite de renvoi de code**

Le renvoi du code r√©initialise la limite de taux, facilitant les tentatives de force brute continues.

#### **Contournement de la limite de taux c√¥t√© client**

Un document d√©taille des techniques pour contourner la limitation de taux c√¥t√© client.

#### **Les actions internes manquent de limite de taux**

Les limites de taux peuvent prot√©ger les tentatives de connexion mais pas les actions internes du compte.

#### **Co√ªts de renvoi de code SMS**

Le renvoi excessif de codes par SMS entra√Æne des co√ªts pour l'entreprise, bien que cela ne contourne pas 2FA.

#### **R√©g√©n√©ration infinie de OTP**

La g√©n√©ration infinie de OTP avec des codes simples permet la force brute en r√©essayant un petit ensemble de codes.

### **Exploitation de conditions de course**

L'exploitation des conditions de course pour contourner 2FA peut √™tre trouv√©e dans un document sp√©cifique.

### **Vuln√©rabilit√©s CSRF/Clickjacking**

Explorer les vuln√©rabilit√©s CSRF ou Clickjacking pour d√©sactiver 2FA est une strat√©gie viable.

### **Exploits de la fonction "Se souvenir de moi"**

#### **Valeurs de cookie pr√©visibles**

Deviner la valeur du cookie "se souvenir de moi" peut contourner les restrictions.

#### **Impersonation d'adresse IP**

Imiter l'adresse IP de la victime via l'en-t√™te **X-Forwarded-For** peut contourner les restrictions.

### **Utilisation de versions plus anciennes**

#### **Sous-domaines**

Tester des sous-domaines peut utiliser des versions obsol√®tes manquant de support 2FA ou contenir des impl√©mentations 2FA vuln√©rables.

#### **Endpoints API**

Les anciennes versions d'API, indiqu√©es par des chemins de r√©pertoire /v\*/, peuvent √™tre vuln√©rables aux m√©thodes de contournement 2FA.

### **Gestion des sessions pr√©c√©dentes**

Terminer les sessions existantes lors de l'activation de 2FA s√©curise les comptes contre l'acc√®s non autoris√© depuis des sessions compromises.

### **Flaws de contr√¥le d'acc√®s avec des codes de secours**

La g√©n√©ration imm√©diate et la r√©cup√©ration potentielle non autoris√©e de codes de secours lors de l'activation de 2FA, en particulier avec des configurations CORS incorrectes/vuln√©rabilit√©s XSS, posent un risque.

### **Divulgation d'informations sur la page 2FA**

La divulgation d'informations sensibles (par exemple, num√©ro de t√©l√©phone) sur la page de v√©rification 2FA est une pr√©occupation.

### **R√©initialisation de mot de passe d√©sactivant 2FA**

Un processus d√©montrant une m√©thode de contournement potentielle implique la cr√©ation de compte, l'activation de 2FA, la r√©initialisation de mot de passe, et la connexion subs√©quente sans l'exigence de 2FA.

### **Requ√™tes leurres**

Utiliser des requ√™tes leurres pour obscurcir les tentatives de force brute ou induire en erreur les m√©canismes de limitation de taux ajoute une autre couche aux strat√©gies de contournement. La cr√©ation de telles requ√™tes n√©cessite une compr√©hension nuanc√©e des mesures de s√©curit√© de l'application et des comportements de limitation de taux.

### Erreurs de construction de OTP

Dans le cas o√π le OTP est cr√©√© en fonction des donn√©es que l'utilisateur poss√®de d√©j√† ou qui sont envoy√©es pr√©c√©demment pour cr√©er le OTP, il est possible pour l'utilisateur de le g√©n√©rer √©galement et de le contourner.

## R√©f√©rences

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
