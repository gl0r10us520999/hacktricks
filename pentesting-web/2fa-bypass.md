# 2FA/MFA/OTP Bypass

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## **Gelişmiş İki Aşamalı Kimlik Doğrulama Bypass Teknikleri**

### **Doğrudan Uç Nokta Erişimi**

2FA'yı atlatmak için, yolun bilinmesi kritik olmakla birlikte, sonraki uç noktaya doğrudan erişim sağlanabilir. Başarısız olursa, **Referrer başlığını** 2FA doğrulama sayfasından gezinmeyi taklit edecek şekilde değiştirin.

### **Token Yeniden Kullanımı**

Bir hesap içindeki kimlik doğrulama için daha önce kullanılan token'ların yeniden kullanılması etkili olabilir.

### **Kullanılmayan Token'ların Kullanımı**

Kendi hesabınızdan bir token çıkararak başka bir hesapta 2FA'yı atlatmayı deneyebilirsiniz.

### **Token'in Açığa Çıkması**

Token'in web uygulamasından gelen bir yanıtta ifşa edilip edilmediğini araştırın.

### **Doğrulama Bağlantısı İstismarı**

**Hesap oluşturulduğunda gönderilen e-posta doğrulama bağlantısını** kullanmak, 2FA olmadan profil erişimi sağlayabilir; bu, detaylı bir [yazıda](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) vurgulanmıştır.

### **Oturum Manipülasyonu**

Kullanıcının ve bir kurbanın hesabı için oturum başlatmak ve kullanıcının hesabı için 2FA'yı tamamlamadan devam etmek, kurbanın hesap akışındaki bir sonraki adıma erişim sağlama girişiminde bulunur ve arka uç oturum yönetimi sınırlamalarını istismar eder.

### **Şifre Sıfırlama Mekanizması**

Şifre sıfırlama işlevini araştırmak, uygulamaya sıfırlama sonrası kullanıcıyı giriş yaptırma potansiyeli açısından önemlidir; aynı bağlantıyı kullanarak birden fazla sıfırlama yapılmasına olanak tanıyabilir. Yeni sıfırlanan kimlik bilgileriyle giriş yapmak 2FA'yı atlatabilir.

### **OAuth Platformu Kompromizasyonu**

Güvenilir bir **OAuth** platformundaki (örneğin, Google, Facebook) bir kullanıcının hesabının ele geçirilmesi, 2FA'yı atlatma yolu sunabilir.

### **Kaba Kuvvet Saldırıları**

#### **Hız Sınırı Yokluğu**

Kod denemeleri sayısında bir sınır olmaması, kaba kuvvet saldırılarına olanak tanır; ancak potansiyel sessiz hız sınırlaması dikkate alınmalıdır.

Hız sınırı mevcut olsa bile, geçerli OTP gönderildiğinde yanıtın farklı olup olmadığını kontrol etmelisiniz. [**Bu yazıda**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), hata avcısı, 20 başarısız denemeden sonra hız sınırı tetiklendiğinde 401 yanıtı verildiğini, ancak geçerli olan gönderildiğinde 200 yanıtı alındığını keşfetti.

#### **Yavaş Kaba Kuvvet**

Akış hızı sınırlamaları olan yerlerde yavaş bir kaba kuvvet saldırısı uygulanabilir.

#### **Kod Yeniden Gönderme Sınırının Sıfırlanması**

Kodun yeniden gönderilmesi hız sınırını sıfırlar ve devam eden kaba kuvvet denemelerine olanak tanır.

#### **İstemci Tarafı Hız Sınırı Aşma**

İstemci tarafı hız sınırlamasını aşma tekniklerini detaylandıran bir belge mevcuttur.

#### **İçsel Eylemlerde Hız Sınırı Yokluğu**

Hız sınırlamaları giriş denemelerini koruyabilir, ancak iç hesap eylemlerini korumayabilir.

#### **SMS Kodu Yeniden Gönderme Maliyetleri**

SMS ile kodların aşırı yeniden gönderilmesi şirkete maliyet yükler, ancak 2FA'yı atlatmaz.

#### **Sonsuz OTP Yeniden Üretimi**

Basit kodlarla sonsuz OTP üretimi, küçük bir kod setini yeniden deneyerek kaba kuvvet saldırısına olanak tanır.

### **Yarış Durumu İstismarı**

2FA bypass'ı için yarış durumlarını istismar etme yöntemleri belirli bir belgede bulunabilir.

### **CSRF/Clickjacking Açıkları**

CSRF veya Clickjacking açıklarını araştırmak, 2FA'yı devre dışı bırakmak için geçerli bir stratejidir.

### **"Beni Hatırla" Özelliği İstismarları**

#### **Tahmin Edilebilir Çerez Değerleri**

"Beni hatırla" çerez değerini tahmin etmek kısıtlamaları atlatabilir.

#### **IP Adresi Taklidi**

**X-Forwarded-For** başlığı aracılığıyla kurbanın IP adresini taklit etmek kısıtlamaları atlatabilir.

### **Eski Sürümlerin Kullanımı**

#### **Alt Alan Adları**

Alt alan adlarını test etmek, 2FA desteği olmayan veya savunmasız 2FA uygulamaları içeren eski sürümleri kullanabilir.

#### **API Uç Noktaları**

/v\*/ dizin yollarıyla gösterilen eski API sürümleri, 2FA bypass yöntemlerine karşı savunmasız olabilir.

### **Önceki Oturumların Yönetimi**

2FA etkinleştirildiğinde mevcut oturumların sonlandırılması, ele geçirilmiş oturumlardan yetkisiz erişime karşı hesapları güvence altına alır.

### **Yedek Kodlarla Erişim Kontrol Hataları**

2FA etkinleştirildiğinde yedek kodların hemen üretilmesi ve potansiyel yetkisiz erişimi, özellikle CORS yanlış yapılandırmaları/XSS açıkları ile birlikte bir risk oluşturur.

### **2FA Sayfasında Bilgi Açığı**

2FA doğrulama sayfasında hassas bilgilerin (örneğin, telefon numarası) ifşası bir endişe kaynağıdır.

### **Şifre Sıfırlamanın 2FA'yı Devre Dışı Bırakması**

Bir hesap oluşturma, 2FA etkinleştirme, şifre sıfırlama ve ardından 2FA gereksinimi olmadan giriş yapma sürecini gösteren bir yöntem, potansiyel bir bypass yöntemi olarak değerlendirilebilir.

### **Aldatıcı İstekler**

Kaba kuvvet denemelerini gizlemek veya hız sınırlama mekanizmalarını yanıltmak için aldatıcı istekler kullanmak, bypass stratejilerine bir katman daha ekler. Bu tür istekleri oluşturmak, uygulamanın güvenlik önlemleri ve hız sınırlama davranışları hakkında ince bir anlayış gerektirir.

### OTP Oluşturma Hataları

Eğer OTP, kullanıcının zaten sahip olduğu verilere veya OTP'yi oluşturmak için gönderilen verilere dayanarak oluşturulursa, kullanıcının da bunu oluşturması ve atlatması mümkündür.

## Referanslar

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
