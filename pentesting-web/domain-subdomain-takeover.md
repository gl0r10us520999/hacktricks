# Domain/Subdomain takeover

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

## Domain takeover

EÄŸer bazÄ± hizmetler tarafÄ±ndan **kullanÄ±lan** bir domain (domain.tld) keÅŸfettiyseniz ancak **ÅŸirket** bu domainin **sahipliÄŸini kaybetmiÅŸse**, onu **kaydetmeyi** (eÄŸer yeterince ucuzsa) deneyebilir ve ÅŸirkete bildirebilirsiniz. EÄŸer bu domain bazÄ± **hassas bilgiler** alÄ±yorsa, Ã¶rneÄŸin bir oturum Ã§erezi **GET** parametresi veya **Referer** baÅŸlÄ±ÄŸÄ± aracÄ±lÄ±ÄŸÄ±yla, bu kesinlikle bir **aÃ§Ä±k**tÄ±r.

### Subdomain takeover

Åirketin bir alt alan adÄ±, **kayÄ±tlÄ± olmayan bir Ã¼Ã§Ã¼ncÃ¼ taraf hizmete** iÅŸaret ediyor. EÄŸer bu **Ã¼Ã§Ã¼ncÃ¼ taraf hizmette** bir **hesap oluÅŸturabilir** ve kullanÄ±lan **ismi kaydedebilirseniz**, alt alan adÄ± ele geÃ§irme iÅŸlemini gerÃ§ekleÅŸtirebilirsiniz.

OlasÄ± ele geÃ§irmeleri kontrol etmek iÃ§in Ã§eÅŸitli sÃ¶zlÃ¼klerle birlikte birÃ§ok araÃ§ bulunmaktadÄ±r:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)
* [https://github.com/Stratus-Security/Subdominator](https://github.com/Stratus-Security/Subdominator)
* [https://github.com/NImaism/takeit](https://github.com/NImaism/takeit)

### Subdomain Takeover Generation via DNS Wildcard

Bir domain Ã¼zerinde DNS wildcard kullanÄ±ldÄ±ÄŸÄ±nda, o domainin farklÄ± bir adresi aÃ§Ä±kÃ§a belirtilmemiÅŸ olan herhangi bir istenen alt alan adÄ± **aynÄ± bilgilere** yÃ¶nlendirilir. Bu bir A IP adresi, bir CNAME olabilir...

Ã–rneÄŸin, `*.testing.com` `1.1.1.1`'e wildcard olarak ayarlandÄ±ysa, `not-existent.testing.com` `1.1.1.1`'e iÅŸaret edecektir.

Ancak, bir IP adresine iÅŸaret etmek yerine, sistem yÃ¶neticisi bunu bir **Ã¼Ã§Ã¼ncÃ¼ taraf hizmete CNAME aracÄ±lÄ±ÄŸÄ±yla** yÃ¶nlendirirse, Ã¶rneÄŸin bir G**ithub alt alan adÄ±** (`sohomdatta1.github.io`) gibi. Bir saldÄ±rgan **kendi Ã¼Ã§Ã¼ncÃ¼ taraf sayfasÄ±nÄ±** (bu durumda Gihub'da) oluÅŸturabilir ve `something.testing.com`'un oraya iÅŸaret ettiÄŸini sÃ¶yleyebilir. Ã‡Ã¼nkÃ¼, **CNAME wildcard** saldÄ±rgana **kurbanÄ±n domaini iÃ§in keyfi alt alan adlarÄ± oluÅŸturma** yetkisi verecektir.

Bu aÃ§Ä±ÄŸÄ±n bir Ã¶rneÄŸini CTF yazÄ±mÄ±nda bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Exploiting a subdomain takeover

Alt alan adÄ± ele geÃ§irme, internet Ã¼zerindeki belirli bir domain iÃ§in DNS sahtekarlÄ±ÄŸÄ±dÄ±r ve saldÄ±rganlarÄ±n bir domain iÃ§in A kayÄ±tlarÄ± ayarlamasÄ±na olanak tanÄ±r, bu da tarayÄ±cÄ±larÄ±n saldÄ±rganÄ±n sunucusundan iÃ§erik gÃ¶stermesine neden olur. Bu **ÅŸeffaflÄ±k**, tarayÄ±cÄ±larÄ±n domainleri phishing'e karÅŸÄ± savunmasÄ±z hale getirir. SaldÄ±rganlar bu amaÃ§la [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Ã–zellikle, phishing e-postasÄ±nda URL'nin meÅŸru gÃ¶rÃ¼ndÃ¼ÄŸÃ¼ domainler savunmasÄ±zdÄ±r, bu da kullanÄ±cÄ±larÄ± kandÄ±rarak domainin doÄŸasÄ± gereÄŸi gÃ¼venilirliÄŸinden yararlanÄ±r ve spam filtrelerinden kaÃ§Ä±nÄ±r.

Daha fazla ayrÄ±ntÄ± iÃ§in bu [gÃ¶nderiyi kontrol edin](https://0xpatrik.com/subdomain-takeover/)

### **SSL Certificates**

SSL sertifikalarÄ±, saldÄ±rganlar tarafÄ±ndan [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracÄ±lÄ±ÄŸÄ±yla oluÅŸturulursa, bu sahte domainlerin meÅŸruiyetini artÄ±rÄ±r ve phishing saldÄ±rÄ±larÄ±nÄ± daha inandÄ±rÄ±cÄ± hale getirir.

### **Cookie Security and Browser Transparency**

TarayÄ±cÄ± ÅŸeffaflÄ±ÄŸÄ±, [AynÄ± kÃ¶ken politikasÄ±](https://en.wikipedia.org/wiki/Same-origin\_policy) gibi politikalarla yÃ¶netilen Ã§erez gÃ¼venliÄŸine de uzanÄ±r. OturumlarÄ± yÃ¶netmek ve giriÅŸ belirteÃ§lerini depolamak iÃ§in sÄ±kÃ§a kullanÄ±lan Ã§erezler, alt alan adÄ± ele geÃ§irme yoluyla istismar edilebilir. SaldÄ±rganlar, kullanÄ±cÄ±larÄ± tehlikeye atÄ±lmÄ±ÅŸ bir alt alan adÄ±na yÃ¶nlendirerek **oturum Ã§erezlerini** toplayabilir, bu da kullanÄ±cÄ± verilerini ve gizliliÄŸini tehlikeye atar.

### **Emails and Subdomain Takeover**

Alt alan adÄ± ele geÃ§irmenin bir diÄŸer yÃ¶nÃ¼, e-posta hizmetleridir. SaldÄ±rganlar, meÅŸru bir alt alan adÄ±ndan e-posta almak veya gÃ¶ndermek iÃ§in **MX kayÄ±tlarÄ±nÄ±** manipÃ¼le edebilir, bu da phishing saldÄ±rÄ±larÄ±nÄ±n etkinliÄŸini artÄ±rÄ±r.

### **Higher Order Risks**

Daha fazla risk, **NS kayÄ±t ele geÃ§irme** iÃ§erir. EÄŸer bir saldÄ±rgan bir domainin bir NS kaydÄ±nÄ± kontrol altÄ±na alÄ±rsa, trafiÄŸin bir kÄ±smÄ±nÄ± kendi kontrolÃ¼ndeki bir sunucuya yÃ¶nlendirebilir. Bu risk, saldÄ±rganÄ±n DNS kayÄ±tlarÄ± iÃ§in yÃ¼ksek bir **TTL (Time to Live)** ayarlamasÄ± durumunda artar ve saldÄ±rÄ±nÄ±n sÃ¼resini uzatÄ±r.

### CNAME Record Vulnerability

SaldÄ±rganlar, artÄ±k kullanÄ±lmayan veya devre dÄ±ÅŸÄ± bÄ±rakÄ±lan dÄ±ÅŸ hizmetlere iÅŸaret eden talep edilmemiÅŸ CNAME kayÄ±tlarÄ±nÄ± istismar edebilir. Bu, onlara gÃ¼venilir domain altÄ±nda bir sayfa oluÅŸturma imkanÄ± tanÄ±r ve phishing veya kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m daÄŸÄ±tÄ±mÄ±nÄ± kolaylaÅŸtÄ±rÄ±r.

### **Mitigation Strategies**

Azaltma stratejileri ÅŸunlarÄ± iÃ§erir:

1. **SavunmasÄ±z DNS kayÄ±tlarÄ±nÄ± kaldÄ±rmak** - Bu, alt alan adÄ± artÄ±k gerekli deÄŸilse etkilidir.
2. **Domain adÄ±nÄ± talep etmek** - Ä°lgili bulut saÄŸlayÄ±cÄ±sÄ±yla kaynaÄŸÄ± kaydetmek veya sÃ¼resi dolmuÅŸ bir domaini yeniden satÄ±n almak.
3. **SavunmasÄ±zlÄ±klar iÃ§in dÃ¼zenli izleme** - [aquatone](https://github.com/michenriksen/aquatone) gibi araÃ§lar, savunmasÄ±z domainleri tanÄ±mlamaya yardÄ±mcÄ± olabilir. KuruluÅŸlar ayrÄ±ca, DNS kayÄ±tlarÄ±nÄ±n oluÅŸturulmasÄ±nÄ±n kaynak oluÅŸturmanÄ±n son adÄ±mÄ± ve kaynak yok etmenin ilk adÄ±mÄ± olduÄŸundan emin olarak altyapÄ± yÃ¶netim sÃ¼reÃ§lerini gÃ¶zden geÃ§irmelidir.

Bulut saÄŸlayÄ±cÄ±larÄ± iÃ§in, alt alan adÄ± ele geÃ§irmelerini Ã¶nlemek iÃ§in domain sahipliÄŸini doÄŸrulamak Ã§ok Ã¶nemlidir. BazÄ±larÄ±, [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi, bu sorunu tanÄ±mÄ±ÅŸ ve domain doÄŸrulama mekanizmalarÄ± uygulamÄ±ÅŸtÄ±r.

## References

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)
* [https://www.stratussecurity.com/post/subdomain-takeover-guide](https://www.stratussecurity.com/post/subdomain-takeover-guide)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=domain-subdomain-takeover) kullanarak dÃ¼nyanÄ±n **en geliÅŸmiÅŸ** topluluk araÃ§larÄ±yla **iÅŸ akÄ±ÅŸlarÄ±nÄ±** kolayca oluÅŸturun ve **otomatikleÅŸtirin**.\
BugÃ¼n EriÅŸim AlÄ±n:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'Ä± takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
