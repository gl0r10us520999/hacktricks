# Xamarin Apps

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **åŸºæœ¬æƒ…å ±**

Xamarinã¯ã€é–‹ç™ºè€…ãŒ.NETãŠã‚ˆã³C#ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦**iOSã€Androidã€Windowsç”¨ã®ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰**ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸ**ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **ã§ã™ã€‚ã“ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯ã€åŠ¹ç‡çš„ã«ç¾ä»£çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®å¤šæ•°ã®ãƒ„ãƒ¼ãƒ«ã¨æ‹¡å¼µæ©Ÿèƒ½ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

### Xamarinã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

* **Android**ã®å ´åˆã€Xamarinã¯.NETãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä»‹ã—ã¦AndroidãŠã‚ˆã³Javaåå‰ç©ºé–“ã¨çµ±åˆã•ã‚Œã€Monoå®Ÿè¡Œç’°å¢ƒå†…ã§Android Runtime (ART)ã¨å…±ã«å‹•ä½œã—ã¾ã™ã€‚Managed Callable Wrappers (MCW)ãŠã‚ˆã³Android Callable Wrappers (ACW)ã¯ã€Monoã¨ARTé–“ã®é€šä¿¡ã‚’ä¿ƒé€²ã—ã€ä¸¡è€…ã¯Linuxã‚«ãƒ¼ãƒãƒ«ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
* **iOS**ã®å ´åˆã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Monoãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ä¸‹ã§å®Ÿè¡Œã•ã‚Œã€C# .NETã‚³ãƒ¼ãƒ‰ã‚’ARMã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«å¤‰æ›ã™ã‚‹ãŸã‚ã«å®Œå…¨ãªAhead of Time (AOT)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€UNIXãƒ©ã‚¤ã‚¯ãªã‚«ãƒ¼ãƒãƒ«ä¸Šã®Objective-C Runtimeã¨å…±ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

### .NETãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¨Monoãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

**.NETãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**ã«ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã®ãŸã‚ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ã‚¯ãƒ©ã‚¹ã€ãŠã‚ˆã³åå‰ç©ºé–“ãŒå«ã¾ã‚Œã€.NETãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’ç®¡ç†ã—ã¾ã™ã€‚ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ç‹¬ç«‹æ€§ã¨å¾Œæ–¹äº’æ›æ€§ã‚’æä¾›ã—ã¾ã™ã€‚**Monoãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**ã¯ã€2005å¹´ã«Linuxå‘ã‘ã«.NETã‚’æ‹¡å¼µã™ã‚‹ãŸã‚ã«é–‹å§‹ã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ç‰ˆã®.NETãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€ç¾åœ¨ã¯Microsoftã«ã‚ˆã£ã¦ã‚µãƒãƒ¼ãƒˆã•ã‚Œã€Xamarinã«ã‚ˆã£ã¦ä¸»å°ã•ã‚Œã¦ã„ã¾ã™ã€‚

### Xamarinã‚¢ãƒ—ãƒªã®ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°

#### Xamarinã‚¢ã‚»ãƒ³ãƒ–ãƒªã®ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

ãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«æˆ»ã™ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚Windowsã§ã¯ã€Visual Studioã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒãƒ‡ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç”¨ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç‰¹å®šã§ãã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ã‚³ãƒ¼ãƒ‰ã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã¨åˆ†æã®ãŸã‚ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æŠ½å‡ºã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

#### JITã¨AOTã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

* **Android**ã¯ã€Just-In-Time (JIT)ãŠã‚ˆã³Ahead-Of-Time (AOT)ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€æœ€é©ãªå®Ÿè¡Œé€Ÿåº¦ã®ãŸã‚ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰AOTãƒ¢ãƒ¼ãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚å®Œå…¨ãªAOTã¯ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ©ã‚¤ã‚»ãƒ³ã‚¹å°‚ç”¨ã§ã™ã€‚
* **iOS**ã¯ã€Appleã®å‹•çš„ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã«é–¢ã™ã‚‹åˆ¶é™ã®ãŸã‚ã€AOTã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### APK/IPAã‹ã‚‰ã®dllãƒ•ã‚¡ã‚¤ãƒ«ã®æŠ½å‡º

APK/IPAå†…ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¢ç´¢ã—ã¾ã™ã€‚Androidã®å ´åˆã€[XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ)ã‚„[xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦dllãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã§ãã¾ã™ã€‚
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
APKã‚’é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸå¾Œã€unknown/assemblies/ãƒ•ã‚©ãƒ«ãƒ€å†…ã«`.dll`ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ãˆã‚‹å ´åˆã€[**dnSpy**](https://github.com/dnSpy/dnSpy)ã‚’ä½¿ç”¨ã—ã¦`.dll`ã‚’ç›´æ¥åˆ†æã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚\
ã—ã‹ã—ã€æ™‚ã«ã¯unknown/assemblies/ãƒ•ã‚©ãƒ«ãƒ€å†…ã«`assemblies.blob`ã¨`assemblies.manifest`ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒ„ãƒ¼ãƒ«[pyxamstore](https://github.com/jakev/pyxamstore)ã¯ã€Xamarinã‚¢ãƒ—ãƒªã®`assemblies.blob`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã€ã•ã‚‰ãªã‚‹åˆ†æã®ãŸã‚ã«.NETã‚¢ã‚»ãƒ³ãƒ–ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOSã®dllãƒ•ã‚¡ã‚¤ãƒ«ã¯é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ãŸã‚ã«å®¹æ˜“ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã‚ã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®é‡è¦ãªéƒ¨åˆ†ã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ç•°ãªã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ é–“ã§å…±é€šã®ãƒ™ãƒ¼ã‚¹ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

### é™çš„åˆ†æ

`.dll`ã‚’å–å¾—ã—ãŸã‚‰ã€[**dnSpy**](https://github.com/dnSpy/dnSpy) **ã‚„** [**ILSpy**](https://github.com/icsharpcode/ILSpy) **ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€.Netã‚³ãƒ¼ãƒ‰ã‚’é™çš„ã«åˆ†æã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ä¿è­·ã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”¹ã–ã‚“ã™ã‚‹ã®ã«éå¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚\
ã‚¢ãƒ—ãƒªã‚’å¤‰æ›´ã—ãŸå¾Œã¯ã€å†åº¦ãƒ‘ãƒƒã‚­ãƒ³ã‚°ã—ã€å†ç½²åã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

### å‹•çš„åˆ†æ

å‹•çš„åˆ†æã¯ã€SSLãƒ”ãƒ³ãƒ‹ãƒ³ã‚°ã®ãƒã‚§ãƒƒã‚¯ã‚„ã€Xamarinã‚¢ãƒ—ãƒªã®.NETãƒã‚¤ãƒŠãƒªã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ å¤‰æ›´ã®ãŸã‚ã«[Fridax](https://github.com/NorthwaveSecurity/fridax)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’å«ã¿ã¾ã™ã€‚Fridaã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ãƒ«ãƒ¼ãƒˆæ¤œå‡ºã‚„SSLãƒ”ãƒ³ãƒ‹ãƒ³ã‚°ã‚’å›é¿ã™ã‚‹ãŸã‚ã«åˆ©ç”¨å¯èƒ½ã§ã€åˆ†æèƒ½åŠ›ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚

ä»–ã®èˆˆå‘³æ·±ã„Fridaã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼š

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)

### å†ç½²å

ãƒ„ãƒ¼ãƒ«[Uber APK Signer](https://github.com/patrickfav/uber-apk-signer)ã¯ã€åŒã˜ã‚­ãƒ¼ã§è¤‡æ•°ã®APKã«ç½²åã™ã‚‹ã“ã¨ã‚’ç°¡ç´ åŒ–ã—ã€å¤‰æ›´ã‚’åŠ ãˆãŸå¾Œã«ã‚¢ãƒ—ãƒªã‚’å†ç½²åã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚

## ã•ã‚‰ãªã‚‹æƒ…å ±

* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)
* [https://medium.com/@justmobilesec/introduction-to-the-exploitation-of-xamarin-apps-fde4619a51bf](https://medium.com/@justmobilesec/introduction-to-the-exploitation-of-xamarin-apps-fde4619a51bf)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã™ã‚‹ï¼š<img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
