# Xamarin Apps

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **Temel Bilgiler**

Xamarin, geliÅŸtiricilerin **iOS, Android ve Windows iÃ§in uygulamalar oluÅŸturmasÄ±nÄ±** saÄŸlamak amacÄ±yla tasarlanmÄ±ÅŸ **aÃ§Ä±k kaynak bir platformdur**. Bu platform, modern uygulamalarÄ± verimli bir ÅŸekilde oluÅŸturmak iÃ§in birÃ§ok araÃ§ ve uzantÄ±ya eriÅŸim sunar.

### Xamarin'Ä±n Mimarisi

* **Android** iÃ§in, Xamarin, .NET baÄŸlamalarÄ± aracÄ±lÄ±ÄŸÄ±yla Android ve Java ad alanlarÄ±yla entegre olur ve Mono yÃ¼rÃ¼tme ortamÄ±nda Android Runtime (ART) ile birlikte Ã§alÄ±ÅŸÄ±r. Managed Callable Wrappers (MCW) ve Android Callable Wrappers (ACW), Mono ve ART arasÄ±nda iletiÅŸimi kolaylaÅŸtÄ±rÄ±r; her ikisi de Linux Ã§ekirdeÄŸi Ã¼zerine inÅŸa edilmiÅŸtir.
* **iOS** iÃ§in, uygulamalar Mono Ã§alÄ±ÅŸma zamanÄ± altÄ±nda Ã§alÄ±ÅŸÄ±r ve C# .NET kodunu ARM montaj diline dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in tam Ahead of Time (AOT) derlemesi kullanÄ±r. Bu sÃ¼reÃ§, UNIX benzeri bir Ã§ekirdek Ã¼zerinde Objective-C Runtime ile birlikte Ã§alÄ±ÅŸÄ±r.

### .NET Runtime ve Mono Framework

**.NET framework**, uygulama geliÅŸtirme iÃ§in derlemeler, sÄ±nÄ±flar ve ad alanlarÄ± iÃ§erir; .NET Runtime, kod yÃ¼rÃ¼tmesini yÃ¶netir. Platform baÄŸÄ±msÄ±zlÄ±ÄŸÄ± ve geriye dÃ¶nÃ¼k uyumluluk sunar. **Mono Framework**, 2005 yÄ±lÄ±nda .NET'i Linux'a geniÅŸletmek amacÄ±yla baÅŸlatÄ±lan aÃ§Ä±k kaynak bir .NET sÃ¼rÃ¼mÃ¼dÃ¼r; ÅŸu anda Microsoft tarafÄ±ndan desteklenmekte ve Xamarin tarafÄ±ndan yÃ¶netilmektedir.

### Xamarin UygulamalarÄ±nÄ±n Tersine MÃ¼hendisliÄŸi

#### Xamarin Derlemelerinin DeÄŸiÅŸtirilmesi

DeÄŸiÅŸtirme, derlenmiÅŸ kodu tekrar kaynak koda dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r. Windows'ta, Visual Studio'daki ModÃ¼ller penceresi, deÄŸiÅŸtirme iÃ§in modÃ¼lleri tanÄ±mlayabilir ve Ã¼Ã§Ã¼ncÃ¼ taraf koda doÄŸrudan eriÅŸim saÄŸlayarak analiz iÃ§in kaynak kodunu Ã§Ä±karabilir.

#### JIT vs AOT Derlemesi

* **Android**, Just-In-Time (JIT) ve Ahead-Of-Time (AOT) derlemesini destekler; optimal yÃ¼rÃ¼tme hÄ±zÄ± iÃ§in Hibrit AOT modu vardÄ±r. Tam AOT, yalnÄ±zca Kurumsal lisanslara Ã¶zeldir.
* **iOS**, Apple'Ä±n dinamik kod yÃ¼rÃ¼tme kÄ±sÄ±tlamalarÄ± nedeniyle yalnÄ±zca AOT derlemesi kullanÄ±r.

### APK/IPA'dan dll DosyalarÄ±nÄ± Ã‡Ä±karma

APK/IPA'daki derlemelere eriÅŸmek iÃ§in dosyayÄ± aÃ§Ä±n ve derlemeler dizinini keÅŸfedin. Android iÃ§in, [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) ve [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) gibi araÃ§lar dll dosyalarÄ±nÄ± aÃ§abilir.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
APK dekompile edildikten sonra unknown/assemblies/ klasÃ¶rÃ¼nde iÃ§indeki `.dll` dosyalarÄ±nÄ± gÃ¶rmek mÃ¼mkÃ¼nse, bu durumda `.dll` dosyalarÄ± Ã¼zerinde analiz yapmak iÃ§in [**dnSpy**](https://github.com/dnSpy/dnSpy) doÄŸrudan kullanÄ±labilir.\
Ancak bazen unknown/assemblies/ klasÃ¶rÃ¼nde `assemblies.blob` ve `assemblies.manifest` dosyalarÄ± bulunur. Xamarin uygulamalarÄ±nda `assemblies.blob` dosyasÄ±nÄ± aÃ§mak iÃ§in [pyxamstore](https://github.com/jakev/pyxamstore) aracÄ± kullanÄ±labilir, bu da daha fazla analiz iÃ§in .NET assembly'lerine eriÅŸim saÄŸlar:
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOS dll dosyalarÄ±, uygulama kodunun Ã¶nemli kÄ±sÄ±mlarÄ±nÄ± ortaya Ã§Ä±kararak dekompile edilmek Ã¼zere kolayca eriÅŸilebilir durumdadÄ±r; bu kod genellikle farklÄ± platformlar arasÄ±nda ortak bir temel paylaÅŸÄ±r.

### Statik Analiz

`.dll` dosyalarÄ± elde edildikten sonra, uygulamanÄ±n kodunu deÄŸiÅŸtirmeye olanak tanÄ±yan [**dnSpy**](https://github.com/dnSpy/dnSpy) **veya** [**ILSpy**](https://github.com/icsharpcode/ILSpy) gibi araÃ§lar kullanarak .Net kodunu statik olarak analiz etmek mÃ¼mkÃ¼ndÃ¼r. Bu, uygulamayÄ± korumalarÄ± aÅŸmak iÃ§in deÄŸiÅŸtirmek gibi durumlarda oldukÃ§a faydalÄ± olabilir.\
UygulamayÄ± deÄŸiÅŸtirdikten sonra, tekrar paketlemeniz ve yeniden imzalamanÄ±z gerektiÄŸini unutmayÄ±n.

### Dinamik Analiz

Dinamik analiz, SSL pinning kontrolÃ¼ yapmayÄ± ve Xamarin uygulamalarÄ±ndaki .NET ikili dosyalarÄ±nÄ±n Ã§alÄ±ÅŸma zamanÄ± deÄŸiÅŸiklikleri iÃ§in [Fridax](https://github.com/NorthwaveSecurity/fridax) gibi araÃ§lar kullanmayÄ± iÃ§erir. Root tespiti veya SSL pinning'i aÅŸmak iÃ§in Frida betikleri mevcuttur ve analiz yeteneklerini artÄ±rÄ±r.

DiÄŸer ilginÃ§ Frida betikleri:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)

### Yeniden Ä°mzalama

[Uber APK Signer](https://github.com/patrickfav/uber-apk-signer) aracÄ±, aynÄ± anahtar ile birden fazla APK'yÄ± imzalamayÄ± kolaylaÅŸtÄ±rÄ±r ve uygulamada deÄŸiÅŸiklikler yapÄ±ldÄ±ktan sonra yeniden imzalamak iÃ§in kullanÄ±labilir.

## Daha Fazla Bilgi

* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)
* [https://medium.com/@justmobilesec/introduction-to-the-exploitation-of-xamarin-apps-fde4619a51bf](https://medium.com/@justmobilesec/introduction-to-the-exploitation-of-xamarin-apps-fde4619a51bf)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
