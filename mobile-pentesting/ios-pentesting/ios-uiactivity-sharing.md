# iOS UIActivity Sharing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

# UIActivity Sharing Simplified

Από το iOS 6 και μετά, οι εφαρμογές τρίτων έχουν ενεργοποιηθεί να **μοιράζονται δεδομένα** όπως κείμενο, διευθύνσεις URL ή εικόνες χρησιμοποιώντας μηχανισμούς όπως το AirDrop, όπως περιγράφεται στον οδηγό [Επικοινωνίας Μεταξύ Εφαρμογών](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3) της Apple. Αυτή η δυνατότητα εκδηλώνεται μέσω ενός συστήματος _sheet δραστηριότητας κοινής χρήσης_ που εμφανίζεται κατά την αλληλεπίδραση με το κουμπί "Κοινή Χρήση".

Μια ολοκληρωμένη απαρίθμηση όλων των ενσωματωμένων επιλογών κοινής χρήσης είναι διαθέσιμη στο [UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype). Οι προγραμματιστές μπορεί να επιλέξουν να αποκλείσουν συγκεκριμένες επιλογές κοινής χρήσης αν τις θεωρούν ακατάλληλες για την εφαρμογή τους.

## **How to Share Data**

Πρέπει να δοθεί προσοχή σε:

- Τη φύση των δεδομένων που μοιράζονται.
- Την ένταξη προσαρμοσμένων δραστηριοτήτων.
- Τον αποκλεισμό ορισμένων τύπων δραστηριότητας.

Η κοινή χρήση διευκολύνεται μέσω της δημιουργίας ενός `UIActivityViewController`, στον οποίο περνιούνται τα αντικείμενα που προορίζονται για κοινή χρήση. Αυτό επιτυγχάνεται καλώντας:
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
Οι προγραμματιστές θα πρέπει να εξετάσουν προσεκτικά το `UIActivityViewController` για τις δραστηριότητες και τις προσαρμοσμένες δραστηριότητες με τις οποίες αρχικοποιείται, καθώς και για οποιουσδήποτε καθορισμένους `excludedActivityTypes`.

## **Πώς να Λάβετε Δεδομένα**

Τα παρακάτω στοιχεία είναι κρίσιμα κατά την λήψη δεδομένων:

- Η δήλωση **προσαρμοσμένων τύπων εγγράφων**.
- Η καθορισμένη **τύποι εγγράφων που μπορεί να ανοίξει η εφαρμογή**.
- Η επαλήθευση της **ακεραιότητας των ληφθέντων δεδομένων**.

Χωρίς πρόσβαση στον πηγαίο κώδικα, μπορεί κανείς να εξετάσει το `Info.plist` για κλειδιά όπως `UTExportedTypeDeclarations`, `UTImportedTypeDeclarations` και `CFBundleDocumentTypes` για να κατανοήσει τους τύπους εγγράφων που μπορεί να χειριστεί και να δηλώσει μια εφαρμογή.

Ένας συνοπτικός οδηγός για αυτά τα κλειδιά είναι διαθέσιμος στο [Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i), τονίζοντας τη σημασία του καθορισμού και της εισαγωγής UTIs για αναγνώριση σε επίπεδο συστήματος και της συσχέτισης τύπων εγγράφων με την εφαρμογή σας για ενσωμάτωση στο διάλογο "Άνοιγμα με".

## Προσέγγιση Δυναμικής Δοκιμής

Για να δοκιμάσετε **την αποστολή δραστηριοτήτων**, μπορεί κανείς να:

- Συνδέσει τη μέθοδο `init(activityItems:applicationActivities:)` για να καταγράψει τα στοιχεία και τις δραστηριότητες που κοινοποιούνται.
- Εντοπίσει τις αποκλεισμένες δραστηριότητες παρεμβαίνοντας στην ιδιότητα `excludedActivityTypes`.

Για **τη λήψη στοιχείων**, περιλαμβάνει:

- Κοινοποίηση ενός αρχείου με την εφαρμογή από άλλη πηγή (π.χ., AirDrop, email) που προκαλεί το διάλογο "Άνοιγμα με...".
- Συνδέοντας `application:openURL:options:` μεταξύ άλλων μεθόδων που εντοπίστηκαν κατά τη διάρκεια της στατικής ανάλυσης για να παρατηρήσετε την αντίδραση της εφαρμογής.
- Χρησιμοποιώντας κακώς διαμορφωμένα αρχεία ή τεχνικές fuzzing για να αξιολογήσετε την ανθεκτικότητα της εφαρμογής.

## Αναφορές
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
