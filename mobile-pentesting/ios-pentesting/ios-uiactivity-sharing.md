# iOS UIActivity Sharing

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

# UIActivity Sharing Vereinfacht

Seit iOS 6 k√∂nnen Drittanbieteranwendungen **Daten** wie Text, URLs oder Bilder √ºber Mechanismen wie AirDrop teilen, wie im [Inter-App Communication guide](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW3) von Apple beschrieben. Diese Funktion zeigt sich durch ein systemweites _Share-Aktivit√§tsblatt_, das beim Interagieren mit der Schaltfl√§che "Teilen" erscheint.

Eine umfassende Auflistung aller integrierten Freigabeoptionen ist unter [UIActivity.ActivityType](https://developer.apple.com/documentation/uikit/uiactivity/activitytype) verf√ºgbar. Entwickler k√∂nnen entscheiden, bestimmte Freigabeoptionen auszuschlie√üen, wenn sie diese f√ºr ihre Anwendung als ungeeignet erachten.

## **Wie man Daten teilt**

Die Aufmerksamkeit sollte auf Folgendes gerichtet werden:

- Die Art der geteilten Daten.
- Die Einbeziehung benutzerdefinierter Aktivit√§ten.
- Der Ausschluss bestimmter Aktivit√§tstypen.

Das Teilen erfolgt durch die Instanziierung eines `UIActivityViewController`, an den die zum Teilen vorgesehenen Elemente √ºbergeben werden. Dies wird erreicht, indem man aufruft:
```bash
$ rabin2 -zq Telegram\ X.app/Telegram\ X | grep -i activityItems
0x1000df034 45 44 initWithActivityItems:applicationActivities:
```
Entwickler sollten den `UIActivityViewController` hinsichtlich der Aktivit√§ten und benutzerdefinierten Aktivit√§ten, mit denen er initialisiert wird, sowie aller angegebenen `excludedActivityTypes` genau pr√ºfen.

## **Wie man Daten empf√§ngt**

Die folgenden Aspekte sind entscheidend beim Empfangen von Daten:

- Die Deklaration von **benutzerdefinierten Dokumenttypen**.
- Die Spezifikation von **Dokumenttypen, die die App √∂ffnen kann**.
- Die √úberpr√ºfung der **Integrit√§t der empfangenen Daten**.

Ohne Zugriff auf den Quellcode kann man dennoch die `Info.plist` auf Schl√ºssel wie `UTExportedTypeDeclarations`, `UTImportedTypeDeclarations` und `CFBundleDocumentTypes` √ºberpr√ºfen, um die Arten von Dokumenten zu verstehen, die eine App verarbeiten und deklarieren kann.

Ein pr√§gnanter Leitfaden zu diesen Schl√ºsseln ist auf [Stackoverflow](https://stackoverflow.com/questions/21937978/what-are-utimportedtypedeclarations-and-utexportedtypedeclarations-used-for-on-i) verf√ºgbar, der die Bedeutung der Definition und des Imports von UTIs f√ºr die systemweite Erkennung sowie die Zuordnung von Dokumenttypen zu Ihrer App f√ºr die Integration im Dialog "√ñffnen mit..." hervorhebt.

## Dynamischer Testansatz

Um **sendende Aktivit√§ten** zu testen, k√∂nnte man:

- In die Methode `init(activityItems:applicationActivities:)` einhaken, um die Elemente und Aktivit√§ten zu erfassen, die geteilt werden.
- Ausgeschlossene Aktivit√§ten identifizieren, indem man die Eigenschaft `excludedActivityTypes` abf√§ngt.

F√ºr **empfangene Elemente** umfasst es:

- Eine Datei von einer anderen Quelle (z. B. AirDrop, E-Mail) mit der App zu teilen, die den Dialog "√ñffnen mit..." aufruft.
- `application:openURL:options:` unter anderen w√§hrend der statischen Analyse identifizierten Methoden abfangen, um die Reaktion der App zu beobachten.
- Fehlformatierte Dateien oder Fuzzing-Techniken verwenden, um die Robustheit der App zu bewerten.

## Referenzen
* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
