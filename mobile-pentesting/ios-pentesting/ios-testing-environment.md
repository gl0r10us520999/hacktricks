# iOS Testing Environment

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichen.

</details>
{% endhint %}

## Apple Developer Program

Eine **Provisionierungsidentit√§t** ist eine Sammlung von √∂ffentlichen und privaten Schl√ºsseln, die mit einem Apple-Entwicklerkonto verkn√ºpft sind. Um **Apps zu signieren**, m√ºssen Sie **99$/Jahr** zahlen, um sich im **Apple Developer Program** zu registrieren und Ihre Provisionierungsidentit√§t zu erhalten. Ohne dies k√∂nnen Sie Anwendungen aus dem Quellcode auf einem physischen Ger√§t nicht ausf√ºhren. Eine andere M√∂glichkeit, dies zu tun, besteht darin, ein **jailbroken Ger√§t** zu verwenden.

Seit Xcode 7.2 hat Apple eine Option bereitgestellt, um ein **kostenloses iOS-Entwicklungs-Provisionierungsprofil** zu erstellen, das es erm√∂glicht, Ihre Anwendung auf einem echten iPhone zu schreiben und zu testen. Gehen Sie zu _Xcode_ --> _Einstellungen_ --> _Accounts_ --> _+_ (Neues Appli ID mit Ihren Anmeldeinformationen hinzuf√ºgen) --> _Klicken Sie auf die erstellte Apple ID_ --> _Zertifikate verwalten_ --> _+_ (Apple Development) --> _Fertig_\
\_\_Um Ihre Anwendung auf Ihrem iPhone auszuf√ºhren, m√ºssen Sie zuerst **das iPhone anweisen, dem Computer zu vertrauen.** Dann k√∂nnen Sie versuchen, **die Anwendung vom Xcode auf dem Mobilger√§t auszuf√ºhren**, aber es wird ein Fehler angezeigt. Gehen Sie also zu _Einstellungen_ --> _Allgemein_ --> _Profile und Ger√§teverwaltung_ --> W√§hlen Sie das nicht vertrauensw√ºrdige Profil aus und klicken Sie auf "**Vertrauen**".

Beachten Sie, dass **Anwendungen, die mit demselben Signierungszertifikat signiert sind, Ressourcen auf sichere Weise teilen k√∂nnen, wie z.B. Schl√ºsselbundobjekte**.

Die Provisionierungsprofile werden im Telefon unter **`/Library/MobileDevice/ProvisioningProfiles`** gespeichert.

## **Simulator**

{% hint style="info" %}
Beachten Sie, dass ein **Simulator nicht dasselbe wie ein Emulator ist**. Der Simulator simuliert nur das Verhalten und die Funktionen des Ger√§ts, verwendet sie jedoch nicht tats√§chlich.
{% endhint %}

### **Simulator**

Das erste, was Sie wissen m√ºssen, ist, dass **das Durchf√ºhren eines Pentests in einem Simulator viel eingeschr√§nkter ist als in einem jailbroken Ger√§t**.

Alle Tools, die zum Erstellen und Unterst√ºtzen einer iOS-App erforderlich sind, werden **nur offiziell auf Mac OS unterst√ºtzt**.\
Das de facto-Tool von Apple zum Erstellen/Debuggen/Instruieren von iOS-Anwendungen ist **Xcode**. Es kann verwendet werden, um andere Komponenten wie **Simulatoren** und verschiedene **SDK** **Versionen** herunterzuladen, die zum Erstellen und **Testen** Ihrer App erforderlich sind.\
Es wird dringend empfohlen, **Xcode** aus dem **offiziellen App Store** herunterzuladen. Andere Versionen k√∂nnten Malware enthalten.

Die Simulator-Dateien finden Sie unter `/Users/<username>/Library/Developer/CoreSimulator/Devices`

Um den Simulator zu √∂ffnen, starten Sie Xcode, dr√ºcken Sie dann im _Xcode-Tab_ --> _Entwicklertools √∂ffnen_ --> _Simulator_\
\_\_Im folgenden Bild k√∂nnen Sie durch Klicken auf "iPod touch \[...\]" ein anderes Ger√§t ausw√§hlen, um es zu testen:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Anwendungen im Simulator

Im Verzeichnis `/Users/<username>/Library/Developer/CoreSimulator/Devices` finden Sie alle **installierten Simulatoren**. Wenn Sie auf die Dateien einer Anwendung zugreifen m√∂chten, die in einem der Emulatoren erstellt wurde, kann es schwierig sein zu wissen, **in welchem die App installiert ist**. Ein schneller Weg, um **die richtige UID zu finden**, besteht darin, die App im Simulator auszuf√ºhren und Folgendes auszuf√ºhren:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Sobald Sie die UID kennen, k√∂nnen die installierten Apps unter `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` gefunden werden.

√úberraschenderweise finden Sie die Anwendung jedoch nicht hier. Sie m√ºssen auf `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/` zugreifen.

In diesem Ordner k√∂nnen Sie **das Paket der Anwendung finden.**

## Emulator

Corellium ist der einzige √∂ffentlich verf√ºgbare iOS-Emulator. Es handelt sich um eine Unternehmens-SaaS-L√∂sung mit einem Lizenzmodell pro Benutzer und es werden keine Testlizenzen angeboten.

## Kein Jailbreak erforderlich

√úberpr√ºfen Sie diesen Blogbeitrag, wie man eine iOS-Anwendung auf einem **nicht gejailbreakten Ger√§t** pentestet: [https://dvuln.com/blog/modern-ios-pentesting-no-jailbreak-needed](https://dvuln.com/blog/modern-ios-pentesting-no-jailbreak-needed)

## Jailbreaking

Apple verlangt strikt, dass der auf dem iPhone ausgef√ºhrte Code **von einem von Apple ausgestellten Zertifikat signiert sein muss**. **Jailbreaking** ist der Prozess, aktiv **solche Einschr√§nkungen** und andere Sicherheitskontrollen, die vom Betriebssystem festgelegt wurden, zu **umgehen**. Daher wird, sobald das Ger√§t gejailbreakt ist, die **Integrit√§tspr√ºfung**, die f√ºr die √úberpr√ºfung der installierten Apps verantwortlich ist, gepatcht, sodass sie **umgangen** wird.

{% hint style="info" %}
Im Gegensatz zu Android **k√∂nnen Sie in iOS nicht in den "Entwicklermodus" wechseln**, um nicht signierten/nicht vertrauensw√ºrdigen Code auf dem Ger√§t auszuf√ºhren.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Obwohl oft verglichen, sind **Rooting** auf Android und **Jailbreaking** auf iOS grundlegend unterschiedliche Prozesse. Das Rooten von Android-Ger√§ten kann **die Installation der `su`-Bin√§rdatei** oder **den Austausch des Systems durch ein gerootetes benutzerdefiniertes ROM** umfassen, was nicht unbedingt Exploits erfordert, wenn der Bootloader entsperrt ist. **Das Flashen von benutzerdefinierten ROMs** ersetzt das Betriebssystem des Ger√§ts nach dem Entsperren des Bootloaders, was manchmal einen Exploit erfordert.

Im Gegensatz dazu k√∂nnen iOS-Ger√§te aufgrund der Einschr√§nkung des Bootloaders, nur von Apple signierte Images zu booten, keine benutzerdefinierten ROMs flashen. **Jailbreaking iOS** zielt darauf ab, die Code-Signierungsschutzma√ünahmen von Apple zu umgehen, um nicht signierten Code auszuf√ºhren, ein Prozess, der durch die kontinuierlichen Sicherheitsverbesserungen von Apple kompliziert wird.

### Herausforderungen beim Jailbreaking

Jailbreaking von iOS wird zunehmend schwieriger, da Apple Schwachstellen schnell patcht. **Das Downgrade von iOS** ist nur f√ºr eine begrenzte Zeit nach einer Ver√∂ffentlichung m√∂glich, was Jailbreaking zu einer zeitkritischen Angelegenheit macht. Ger√§te, die f√ºr Sicherheitstests verwendet werden, sollten nicht aktualisiert werden, es sei denn, das Re-Jailbreaking ist garantiert.

iOS-Updates werden durch einen **Challenge-Response-Mechanismus** (SHSH-Blobs) gesteuert, der die Installation nur f√ºr von Apple signierte Antworten zul√§sst. Dieser Mechanismus, bekannt als "Signing Window", schr√§nkt die M√∂glichkeit ein, OTA-Firmware-Pakete zu speichern und sp√§ter zu verwenden. Die [IPSW Downloads-Website](https://ipsw.me) ist eine Ressource, um aktuelle Signing Windows zu √ºberpr√ºfen.

### Jailbreak-Varianten

* **Tethered Jailbreaks** erfordern eine Computerverbindung f√ºr jeden Neustart.
* **Semi-tethered Jailbreaks** erm√∂glichen das Booten in den nicht gejailbreakten Modus ohne Computer.
* **Semi-untethered Jailbreaks** erfordern ein manuelles Re-Jailbreaking ohne Computer.
* **Untethered Jailbreaks** bieten eine permanente Jailbreak-L√∂sung ohne die Notwendigkeit einer erneuten Anwendung.

### Jailbreaking-Tools und Ressourcen

Jailbreaking-Tools variieren je nach iOS-Version und Ger√§t. Ressourcen wie [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) und [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) bieten aktuelle Informationen. Beispiele sind:

* [Checkra1n](https://checkra.in/) f√ºr A7-A11-Chip-Ger√§te.
* [Palera1n](https://palera.in/) f√ºr Checkm8-Ger√§te (A8-A11) auf iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) f√ºr iOS-Versionen bis 14.8.

Die Modifikation Ihres Ger√§ts birgt Risiken, und Jailbreaking sollte mit Vorsicht angegangen werden.

### Vorteile und Risiken des Jailbreakings

Jailbreaking **entfernt die vom Betriebssystem auferlegte Sandbox**, sodass Apps auf das gesamte Dateisystem zugreifen k√∂nnen. Diese Freiheit erm√∂glicht die Installation von nicht genehmigten Apps und den Zugriff auf mehr APIs. F√ºr regul√§re Benutzer wird Jailbreaking jedoch **nicht empfohlen** aufgrund potenzieller Sicherheitsrisiken und Instabilit√§t des Ger√§ts.

### **Nach dem Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak-Erkennung**

**Mehrere Anwendungen versuchen zu erkennen, ob das Mobilger√§t gejailbreakt ist, und in diesem Fall wird die Anwendung nicht ausgef√ºhrt.**

* Nach dem Jailbreaking von iOS **werden normalerweise Dateien und Ordner installiert**, die durchsucht werden k√∂nnen, um festzustellen, ob das Ger√§t gejailbreakt ist.
* Auf einem gejailbreakten Ger√§t erhalten Anwendungen **Lese-/Schreibzugriff auf neue Dateien** au√üerhalb der Sandbox.
* Einige **API** **Aufrufe** werden **anders reagieren**.
* Das Vorhandensein des **OpenSSH**-Dienstes.
* Der Aufruf von `/bin/sh` wird **1** anstelle von 0 zur√ºckgeben.

**Weitere Informationen zur Erkennung von Jailbreaking** [**hier**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Sie k√∂nnen versuchen, diese Erkennungen mit **objection's** `ios jailbreak disable` zu vermeiden.

## **Umgehung der Jailbreak-Erkennung**

* Sie k√∂nnen versuchen, diese Erkennungen mit **objection's** `ios jailbreak disable` zu vermeiden.
* Sie k√∂nnten auch das Tool **Liberty Lite** (https://ryleyangus.com/repo/) installieren. Sobald das Repo hinzugef√ºgt wurde, sollte die App im Tab ‚ÄûSuche‚Äú erscheinen.

## Referenzen

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks unterst√ºtzen</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
