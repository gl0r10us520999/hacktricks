# iOS Test Ortamı

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **bizi** **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

## Apple Geliştirici Programı

Bir **provisioning identity**, bir Apple geliştirici hesabıyla ilişkili olan bir dizi genel ve özel anahtardır. **Uygulamaları imzalamak** için **Apple Geliştirici Programı'na** kaydolmak için **99$/yıl** ödemeniz gerekir. Bunu yapmadan, bir fiziksel cihazda kaynak kodundan uygulamaları çalıştıramazsınız. Bunu yapmanın bir diğer seçeneği ise **jailbroken bir cihaz** kullanmaktır.

Xcode 7.2 ile birlikte Apple, gerçek bir iPhone'da uygulamanızı yazmanıza ve test etmenize olanak tanıyan **ücretsiz bir iOS geliştirme provisioning profili** oluşturma seçeneği sunmuştur. _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Kimlik bilgilerinizi ekleyin) --> _Oluşturulan Apple ID'ye tıklayın_ --> _Sertifikaları Yönet_ --> _+_ (Apple Geliştirme) --> _Tamam_\
\_\_Daha sonra, uygulamanızı iPhone'unuzda çalıştırmak için önce **iPhone'un bilgisayarı güvenilir olarak göstermesini sağlamanız gerekir.** Ardından, **Xcode'dan mobilde uygulamayı çalıştırmayı deneyebilirsiniz,** ancak bir hata görünecektir. Bu nedenle _Ayarlar_ --> _Genel_ --> _Profiller ve Cihaz Yönetimi_ --> Güvenilmeyen profili seçin ve "**Güven**"e tıklayın.

**Aynı imzalama sertifikasıyla imzalanmış uygulamaların güvenli bir şekilde kaynakları paylaşabileceğini** unutmayın, örneğin anahtar zinciri öğeleri.

Provisioning profilleri telefonun içinde **`/Library/MobileDevice/ProvisioningProfiles`** dizininde saklanır.

## **Simülatör**

{% hint style="info" %}
Bir **simülatörün emülatörle aynı olmadığını** unutmayın. Simülatör, cihazın davranışını ve işlevlerini simüle eder, ancak bunları gerçekten kullanmaz.
{% endhint %}

### **Simülatör**

Bilmeniz gereken ilk şey, **bir simülatör içinde pentest yapmanın, jailbreak yapılmış bir cihazda yapmaktan çok daha sınırlı olacağıdır**.

Bir iOS uygulaması oluşturmak ve desteklemek için gereken tüm araçlar **sadece resmi olarak Mac OS'ta desteklenmektedir**.\
Apple'ın iOS uygulamalarını oluşturmak/ayarlarını düzeltmek/geliştirmek için kullanılan de facto aracı **Xcode**'dur. Uygulamanızı oluşturmak ve **test** etmek için gereken diğer bileşenleri, örneğin **simülatörler** ve farklı **SDK** **sürümlerini** indirmek için kullanılabilir.\
Xcode'u **resmi uygulama mağazasından** **indirmeniz şiddetle tavsiye edilir**. Diğer sürümler kötü amaçlı yazılım içerebilir.

Simülatör dosyaları `/Users/<username>/Library/Developer/CoreSimulator/Devices` dizininde bulunabilir.

Simülatörü açmak için Xcode'u çalıştırın, ardından _Xcode sekmesine_ basın --> _Geliştirici araçlarını aç_ --> _Simülatör_\
\_\_Aşağıdaki resimde "iPod touch \[...\]" üzerine tıklayarak test etmek için başka bir cihaz seçebilirsiniz:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Simülatördeki Uygulamalar

`/Users/<username>/Library/Developer/CoreSimulator/Devices` dizininde tüm **kurulu simülatörleri** bulabilirsiniz. Emülatörlerden birinde oluşturulan bir uygulamanın dosyalarına erişmek istiyorsanız, **uygulamanın hangi emülatörde kurulu olduğunu bilmek zor olabilir**. Doğru UID'yi **bulmanın hızlı bir yolu**, simülatörde uygulamayı çalıştırmak ve şunu yürütmektir:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Once you know the UID the apps installed within it can be found in `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

Ancak, şaşırtıcı bir şekilde burada uygulamayı bulamayacaksınız. `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/` adresine erişmeniz gerekiyor.

Ve bu klasörde **uygulamanın paketini bulabilirsiniz.**

## Emulator

Corellium, kamuya açık tek iOS emülatörüdür. Kullanıcı başına lisans modeli ile bir kurumsal SaaS çözümüdür ve herhangi bir deneme lisansı sunmamaktadır.

## No Jailbreak needed

**Jailbreak yapılmamış bir cihazda** bir iOS uygulamasını nasıl pentest edeceğiniz hakkında bu blog yazısını kontrol edin: [https://dvuln.com/blog/modern-ios-pentesting-no-jailbreak-needed](https://dvuln.com/blog/modern-ios-pentesting-no-jailbreak-needed)

## Jailbreaking

Apple, iPhone'da çalışan kodun **Apple tarafından verilen bir sertifika ile imzalanmasını** kesinlikle gerektirir. **Jailbreaking**, OS tarafından konulan bu tür kısıtlamaları ve diğer güvenlik kontrollerini **aşma** sürecidir. Bu nedenle, cihaz jailbreak yapıldığında, uygulamaların yüklenmesini kontrol eden **bütünlük kontrolü** yamanır, böylece **bypass edilir**.

{% hint style="info" %}
Android'in aksine, iOS'ta **imzasız/güvenilmeyen kodu çalıştırmak için "Geliştirici Modu"na geçemezsiniz.**
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Sıklıkla karşılaştırılsa da, Android'de **rooting** ve iOS'ta **jailbreaking** temelde farklı süreçlerdir. Android cihazlarını rootlamak, **`su` ikili dosyasını yüklemeyi** veya **sistemi köklü bir özel ROM ile değiştirmeyi** içerebilir; bu, bootloader kilidi açıldığında mutlaka istismar gerektirmez. **Özel ROM'ların yüklenmesi**, bootloader kilidi açıldıktan sonra cihazın işletim sistemini değiştirir ve bazen bir istismar gerektirebilir.

Buna karşılık, iOS cihazları, bootloader'ın yalnızca Apple imzalı görüntüleri başlatma kısıtlaması nedeniyle özel ROM'ları yükleyemez. **iOS'u jailbreak yapmak**, imzasız kod çalıştırmak için Apple'ın kod imzalama korumalarını aşmayı hedefler; bu süreç, Apple'ın sürekli güvenlik iyileştirmeleri ile karmaşıklaşır.

### Jailbreaking Challenges

iOS'u jailbreak yapmak, Apple'ın güvenlik açıklarını hızla yamalaması nedeniyle giderek zorlaşmaktadır. **iOS'u düşürmek**, bir sürümden sonra sınırlı bir süre için mümkündür, bu da jailbreak yapmayı zaman açısından hassas bir mesele haline getirir. Güvenlik testi için kullanılan cihazlar, yeniden jailbreak yapılması garanti edilmedikçe güncellenmemelidir.

iOS güncellemeleri, yalnızca Apple imzalı yanıtlar için yüklemeye izin veren bir **challenge-response mekanizması** (SHSH blobları) ile kontrol edilir. "İmzalama penceresi" olarak bilinen bu mekanizma, OTA firmware paketlerini depolama ve daha sonra kullanma yeteneğini sınırlar. [IPSW Downloads web sitesi](https://ipsw.me), mevcut imzalama pencerelerini kontrol etmek için bir kaynaktır.

### Jailbreak Varieties

* **Tethered jailbreak'ler**, her yeniden başlatma için bir bilgisayar bağlantısı gerektirir.
* **Semi-tethered jailbreak'ler**, bilgisayar olmadan jailbreak yapılmamış moda geçişe izin verir.
* **Semi-untethered jailbreak'ler**, bilgisayar gerektirmeden manuel yeniden jailbreak yapmayı gerektirir.
* **Untethered jailbreak'ler**, yeniden uygulama gerektirmeden kalıcı bir jailbreak çözümü sunar.

### Jailbreaking Tools and Resources

Jailbreaking araçları, iOS sürümüne ve cihaza göre değişir. [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) ve [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) gibi kaynaklar güncel bilgiler sağlar. Örnekler:

* A7-A11 çipli cihazlar için [Checkra1n](https://checkra.in/).
* iOS 15.0-16.5'te Checkm8 cihazları (A8-A11) için [Palera1n](https://palera.in/).
* iOS sürümleri 14.8'e kadar [Unc0ver](https://unc0ver.dev/).

Cihazınızı değiştirmek risk taşır ve jailbreak yaparken dikkatli olunmalıdır.

### Jailbreaking Benefits and Risks

Jailbreaking, **OS tarafından dayatılan sandbox'ı kaldırır**, uygulamaların tüm dosya sistemine erişmesine izin verir. Bu özgürlük, onaylanmamış uygulamaların yüklenmesini ve daha fazla API'ye erişimi sağlar. Ancak, normal kullanıcılar için, potansiyel güvenlik riskleri ve cihaz kararsızlığı nedeniyle jailbreak yapılması **tavsiye edilmez**.

### **After Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak Detection**

**Birçok uygulama, mobil cihazın jailbreak yapılıp yapılmadığını tespit etmeye çalışacak ve bu durumda uygulama çalışmayacaktır.**

* Jailbreak yapıldıktan sonra iOS'ta **dosyalar ve klasörler genellikle yüklenir**, bunlar cihazın jailbreak yapılıp yapılmadığını belirlemek için aranabilir.
* Jailbreak yapılmış bir cihazda uygulamalar, sandbox dışındaki yeni dosyalara **okuma/yazma erişimi** alır.
* Bazı **API** **çağrıları** **farklı davranacaktır.**
* **OpenSSH** hizmetinin varlığı.
* `/bin/sh` çağrısı **0 yerine 1** döndürecektir.

**Jailbreaking'i tespit etme yöntemleri hakkında daha fazla bilgi** [**burada**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Bu tespitlerden kaçınmaya çalışabilirsiniz **objection'ın** `ios jailbreak disable` komutunu kullanarak.

## **Jailbreak Detection Bypass**

* Bu tespitlerden kaçınmaya çalışabilirsiniz **objection'ın** `ios jailbreak disable` komutunu kullanarak.
* Ayrıca **Liberty Lite** (https://ryleyangus.com/repo/) aracını yükleyebilirsiniz. Repo eklendikten sonra, uygulama 'Arama' sekmesinde görünmelidir.

## References

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
