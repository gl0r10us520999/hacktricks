# iOS Testing Environment

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Apple Developer Program

A **provisioning identity** is a collection of public and private keys that are associated an Apple developer account. In order to **sign apps** you need to pay **99$/year** to register in the **Apple Developer Program** to get your provisioning identity. Without this you won't be able to run applications from the source code in a physical device. Another option to do this is to use a **jailbroken device**.

Starting in Xcode 7.2 Apple has provided an option to create a **free iOS development provisioning profile** that allows to write and test your application on a real iPhone. Go to _Xcode_ --> _Preferences_ --> _Accounts_ --> _+_ (Add new Appli ID you your credentials) --> _Click on the Apple ID created_ --> _Manage Certificates_ --> _+_ (Apple Development) --> _Done_\
\_\_Then, in order to run your application in your iPhone you need first to **indicate the iPhone to trust the computer.** Then, you can try to **run the application in the mobile from Xcode,** but and error will appear. So go to _Settings_ --> _General_ --> _Profiles and Device Management_ --> Select the untrusted profile and click "**Trust**".

Note that **applications signed by the same signing certificate can share resources on a secure manner, like keychain items**.

The provisioning profiles are stored inside the phone in **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulator**

{% hint style="info" %}
Note that a **simulator isn't the same as en emulator**. The simulator just simulates the behaviour of the device and functions but don't actually use them.
{% endhint %}

### **Simulator**

The first thing you need to know is that **performing a pentest inside a simulator will much more limited than doing it in a jailbroken device**.

All the tools required to build and support an iOS app are **only officially supported on Mac OS**.\
Apple's de facto tool for creating/debugging/instrumenting iOS applications is **Xcode**. It can be used to download other components such as **simulators** and different **SDK** **versions** required to build and **test** your app.\
It's highly recommended to **download** Xcode from the **official app store**. Other versions may be carrying malware.

The simulator files can be found in `/Users/<username>/Library/Developer/CoreSimulator/Devices`

To open the simulator, run Xcode, then press in the _Xcode tab_ --> _Open Developer tools_ --> _Simulator_\
\_\_In the following image clicking in "iPod touch \[...]" you can select other device to test in:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Applications in the Simulator

Inside `/Users/<username>/Library/Developer/CoreSimulator/Devices` you may find all the **installed simulators**. If you want to access the files of an application created inside one of the emulators it might be difficult to know **in which one the app is installed**. A quick way to **find the correct UID** is to execute the app in the simulator and execute:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
**UID** vItlhutlh `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` Daq vItlhutlh **apps** vItlhutlh.

Qatlh, **application** vItlhutlh. `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/` Daq vItlhutlh.

'ej **application** **package** vItlhutlh.

## Emulator

Corellium vItlhutlh iOS emulator. vItlhutlh SaaS solution 'ej per user license model vItlhutlh 'ej trial license vItlhutlh.

## Jailbeaking

Apple **certificate issued by Apple** vItlhutlh **signed by** iPhone vItlhutlh **code running** **strictly requires**. **Jailbreaking** vItlhutlh **circumventing such restrictions** 'ej **security controls** vItlhutlh **put in places** OS. SoH, **device** jailbroken vItlhutlh, **integrity check** vItlhutlh **responsible for checking apps** vItlhutlh **patched** vItlhutlh **bypassed**.

{% hint style="info" %}
Android, **"Developer Mode"** **switch** **cannot** vItlhutlh **iOS** vItlhutlh **unsigned/untrusted code** vItlhutlh **run** **switch**.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Android devices **rooting** 'ej **installing the `su` binary** 'ej **replacing the system with a rooted custom ROM** vItlhutlh involve. **Exploits** vItlhutlh **bootloader** **unlocked** vItlhutlh **require** **necessarily**. **Flashing custom ROMs** vItlhutlh **device's OS** **replaces** **bootloader** **unlocking** vItlhutlh, **exploit** vItlhutlh **require** vItlhutlh.

jImej, iOS devices **custom ROMs** **flash** vItlhutlh **bootloader's restriction** vItlhutlh **Apple-signed images** **boot** **only**. **Jailbreaking iOS** vItlhutlh **Apple's code signing protections** vItlhutlh **bypass** **unsigned code** **run**, **Apple's continuous security enhancements** vItlhutlh **complicated** vItlhutlh.

### Jailbreaking Challenges

Jailbreaking iOS vItlhutlh **Apple patches vulnerabilities** **quickly** vItlhutlh **increasingly difficult**. **Downgrading iOS** vItlhutlh **limited time** vItlhutlh **possible** vItlhutlh, **jailbreaking** vItlhutlh **time-sensitive matter**. **Devices** vItlhutlh **security testing** vItlhutlh **updated** vItlhutlh **re-jailbreaking** vItlhutlh **guaranteed** vItlhutlh.

iOS updates vItlhutlh **challenge-response mechanism** (SHSH blobs) vItlhutlh **controlled**, **installation** vItlhutlh **Apple-signed responses** vItlhutlh. **Mechanism** vItlhutlh **signing window** vItlhutlh, **OTA firmware packages** vItlhutlh **store** 'ej **later use** vItlhutlh **ability** vItlhutlh. [IPSW Downloads website](https://ipsw.me) vItlhutlh **resource** vItlhutlh **checking current signing windows**.

### Jailbreak Varieties

- **Tethered jailbreaks** vItlhutlh **computer connection** vItlhutlh **require** **each reboot**.
- **Semi-tethered jailbreaks** vItlhutlh **booting into non-jailbroken mode** **without a computer**.
- **Semi-untethered jailbreaks** vItlhutlh **manual re-jailbreaking** **without needing a computer**.
- **Untethered jailbreaks** vItlhutlh **permanent jailbreak solution** **without the need for re-application**.

### Jailbreaking Tools and Resources

Jailbreaking tools vItlhutlh **iOS version** 'ej **device** vItlhutlh **vary**. [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com), 'ej [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) vItlhutlh **resources** vItlhutlh **up-to-date information** vItlhutlh. Examples vItlhutlh:

- [Checkra1n](https://checkra.in/) vItlhutlh **A7-A11 chip devices**.
- [Palera1n](https://palera.in/) vItlhutlh **Checkm8 devices** (A8-A11) **iOS 15.0-16.5**.
- [Unc0ver](https://unc0ver.dev/) vItlhutlh **iOS versions up to 14.8**.

Device vItlhutlh **modifying** vItlhutlh, **jailbreaking** vItlhutlh **risks** vItlhutlh, 'ej **caution** vItlhutlh **approached** vItlhutlh.

### Jailbreaking Benefits and Risks

Jailbreaking **OS-imposed sandboxing** vItlhutlh **removes**, **apps** vItlhutlh **access** **entire filesystem** vItlhutlh. **Freedom** vItlhutlh **installation** **unapproved apps** 'ej **access** **more APIs** vItlhutlh. jImej, **regular users** vItlhutlh, **jailbreaking** vItlhutlh **not recommended** vItlhutlh, **potential security risks** 'ej **device instability** vItlhutlh.

### **After Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak Detection**

**Several applications** vItlhutlh **detect** **mobile is jailbroken** 'ej **application** vItlhutlh **won't run**

* iOS **files and folders** vItlhutlh **usually installed** **jailbreaking** vItlhutlh **device** vItlhutlh **searched** vItlhutlh **determine**.
* **Jailbroken device** vItlhutlh **applications** vItlhutlh **read/write access** **new files** **outside the sandbox**
* **API** **calls** vItlhutlh **behave differently**
* **OpenSSH** vItlhutlh **presence** vItlhutlh
* `/bin/sh` vItlhutlh **calling** **return 1** vItlhutlh **0** vItlhutlh

**More information about how to detect jailbreaking** [**here**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

**objection's** `ios jailbreak disable` vItlhutlh **avoid** **detections** **try**.

## **Jailbreak Detection Bypass**

**objection's** `ios jailbreak disable` vItlhutlh **avoid** **detections** **try**.

**Liberty Lite** (https://ryleyangus.com/repo/) vItlhutlh **tool** **install** **could**. **Repo** vItlhutlh **added**, **app** vItlhutlh **appear** **Search** **tab**

## References
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
