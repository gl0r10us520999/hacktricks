{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Code and more information in [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence).

## –°–µ—Ä–∏–∞–ª—ñ–∑–∞—Ü—ñ—è –æ–±'—î–∫—Ç—ñ–≤ —É —Ä–æ–∑—Ä–æ–±—Ü—ñ iOS

–£ iOS, **—Å–µ—Ä–∏–∞–ª—ñ–∑–∞—Ü—ñ—è –æ–±'—î–∫—Ç—ñ–≤** –ø–µ—Ä–µ–¥–±–∞—á–∞—î –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç, —è–∫–∏–π –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∞–±–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏, –∞ –ø–æ—Ç—ñ–º –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —ó—Ö –∑ —Ü—å–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É –∑–∞ –ø–æ—Ç—Ä–µ–±–∏. –î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏, **`NSCoding`** —Ç–∞ **`NSSecureCoding`**, –ø–æ–ª–µ–≥—à—É—é—Ç—å —Ü–µ–π –ø—Ä–æ—Ü–µ—Å –¥–ª—è Objective-C –∞–±–æ –ø—ñ–¥–∫–ª–∞—Å—ñ–≤ `NSObject`, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –æ–±'—î–∫—Ç–∞–º –±—É—Ç–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º–∏ –≤ **`NSData`**, —Ñ–æ—Ä–º–∞—Ç, —è–∫–∏–π –æ–±–≥–æ—Ä—Ç–∞—î –±–∞–π—Ç–æ–≤—ñ –±—É—Ñ–µ—Ä–∏.

### **`NSCoding`** –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
–©–æ–± —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `NSCoding`, –∫–ª–∞—Å –ø–æ–≤–∏–Ω–µ–Ω —É—Å–ø–∞–¥–∫–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥ `NSObject` –∞–±–æ –±—É—Ç–∏ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–º —è–∫ `@objc`. –¶–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–∏–º–∞–≥–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–≤–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –µ–∫–∑–µ–º–ø–ª—è—Ä–∞:
```swift
class CustomPoint: NSObject, NSCoding {
var x: Double = 0.0
var name: String = ""

func encode(with aCoder: NSCoder) {
aCoder.encode(x, forKey: "x")
aCoder.encode(name, forKey: "name")
}

required convenience init?(coder aDecoder: NSCoder) {
guard let name = aDecoder.decodeObject(forKey: "name") as? String else { return nil }
self.init(x: aDecoder.decodeDouble(forKey: "x"), name: name)
}
}
```
### **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –∑ `NSSecureCoding`**
–©–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –≤–ø—Ä–æ–≤–∞–¥–∂—É—é—Ç—å –¥–∞–Ω—ñ –≤ —É–∂–µ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –æ–±'—î–∫—Ç–∏, **`NSSecureCoding`** –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª. –ö–ª–∞—Å–∏, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å `NSSecureCoding`, –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ç–∏–ø –æ–±'—î–∫—Ç—ñ–≤ –ø—ñ–¥ —á–∞—Å –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏, —â–æ –ª–∏—à–µ –æ—á—ñ–∫—É–≤–∞–Ω—ñ —Ç–∏–ø–∏ –æ–±'—î–∫—Ç—ñ–≤ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ö–æ—á–∞ `NSSecureCoding` –ø–æ–∫—Ä–∞—â—É—î –±–µ–∑–ø–µ–∫—É —Ç–∏–ø—ñ–≤, –≤—ñ–Ω –Ω–µ —à–∏—Ñ—Ä—É—î –¥–∞–Ω—ñ —ñ –Ω–µ –∑–∞–±–µ–∑–ø–µ—á—É—î —ó—Ö —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å, —â–æ –≤–∏–º–∞–≥–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó:
```swift
static var supportsSecureCoding: Bool {
return true
}

let obj = decoder.decodeObject(of: MyClass.self, forKey: "myKey")
```
## Data Archiving with `NSKeyedArchiver`
`NSKeyedArchiver` —Ç–∞ –π–æ–≥–æ –∞–Ω–∞–ª–æ–≥, `NSKeyedUnarchiver`, –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∫–æ–¥—É–≤–∞—Ç–∏ –æ–±'—î–∫—Ç–∏ —É —Ñ–∞–π–ª —ñ –ø—ñ–∑–Ω—ñ—à–µ —ó—Ö –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏. –¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤:
```swift
NSKeyedArchiver.archiveRootObject(customPoint, toFile: "/path/to/archive")
let customPoint = NSKeyedUnarchiver.unarchiveObjectWithFile("/path/to/archive") as? CustomPoint
```
### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `Codable` –¥–ª—è —Å–ø—Ä–æ—â–µ–Ω–æ—ó —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
–ü—Ä–æ—Ç–æ–∫–æ–ª `Codable` —É Swift –ø–æ—î–¥–Ω—É—î `Decodable` —Ç–∞ `Encodable`, –ø–æ–ª–µ–≥—à—É—é—á–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ `String`, `Int`, `Double` —Ç–æ—â–æ, –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑—É—Å–∏–ª—å:
```swift
struct CustomPointStruct: Codable {
var x: Double
var name: String
}
```
–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø—Ä–æ—Å—Ç—É —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é –¥–æ —Ç–∞ –∑ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ —ñ JSON, –ø–æ–∫—Ä–∞—â—É—é—á–∏ –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö —É Swift-–¥–æ–¥–∞—Ç–∫–∞—Ö.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ –∫–æ–¥—É–≤–∞–Ω–Ω—è JSON —Ç–∞ XML
–û–∫—Ä—ñ–º –Ω–∞—Ç–∏–≤–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏, –∫—ñ–ª—å–∫–∞ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–¥—É–≤–∞–Ω–Ω—è/–¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è JSON —Ç–∞ XML, –∫–æ–∂–Ω–∞ –∑ —è–∫–∏—Ö –º–∞—î —Å–≤–æ—ó —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –º—ñ—Ä–∫—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏. –í–∞–∂–ª–∏–≤–æ —Ä–µ—Ç–µ–ª—å–Ω–æ –æ–±–∏—Ä–∞—Ç–∏ —Ü—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, —Ç–∞–∫–∏—Ö —è–∫ –∞—Ç–∞–∫–∏ XXE (XML External Entities), –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—á–∏ –ø–∞—Ä—Å–µ—Ä–∏ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –æ–±—Ä–æ–±—Ü—ñ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å—É—Ç–Ω–æ—Å—Ç–µ–π.

### –ú—ñ—Ä–∫—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
–ü—Ä–∏ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö, –æ—Å–æ–±–ª–∏–≤–æ –¥–æ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏, –≤–∞–∂–ª–∏–≤–æ –±—É—Ç–∏ —É–≤–∞–∂–Ω–∏–º –¥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –°–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ, —è–∫—â–æ —ó—Ö –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–æ–±–∏—Ç–∏, –º–æ–∂—É—Ç—å –ø—ñ–¥–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–∏ —Ä–∏–∑–∏–∫–∞–º, —Ç–∞–∫–∏–º —è–∫ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω—ñ –¥—ñ—ó –∞–±–æ –≤–∏—Ç—ñ–∫ –¥–∞–Ω–∏—Ö. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥–ø–∏—Å—É–≤–∞–Ω–Ω—è —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
