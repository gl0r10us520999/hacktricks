# Extracting Entitlements from Compiled Application

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


Samevatting van die bladsy [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracting Entitlements and Mobile Provision Files**

Wanneer jy met 'n app se IPA of 'n ge√Ønstalleerde app op 'n jailbroken toestel werk, mag dit nie moontlik wees om `.entitlements` l√™ers of die `embedded.mobileprovision` l√™er direk te vind nie. Dit is egter steeds moontlik om entitlements eiendomslijste uit die app bin√™re te onttrek, volgens die prosedures uiteengesit in die "iOS Basic Security Testing" hoofstuk, veral die "Acquiring the App Binary" afdeling.

Selfs met versleutelde bin√™re, kan sekere stappe gebruik word om hierdie l√™ers te onttrek. Indien hierdie stappe misluk, kan gereedskap soos Clutch (indien dit met die iOS weergawe versoenbaar is), frida-ios-dump, of soortgelyke nutsprogramme benodig word om die app te ontsleutel en onttrek.

#### **Extracting the Entitlements Plist from the App Binary**

Met die app bin√™re toeganklik op 'n rekenaar, kan **binwalk** gebruik word om al die XML l√™ers te onttrek. Die onderstaande opdrag demonstreer hoe om dit te doen:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternatiewelik kan **radare2** gebruik word om stilweg 'n opdrag uit te voer en te verlaat, terwyl daar gesoek word na alle strings in die app-binary wat "PropertyList" bevat:
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Beide metodes, binwalk en radare2, stel die ekstraksie van `plist`-l√™ers in staat, met 'n inspeksie van die eerste een (0x0015d2a4) wat 'n suksesvolle herstel van die [oorspronklike regte-l√™er van Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements) onthul.

Vir app-binaries wat op jailbreak-toestelle verkry word (bv. via SSH), kan die **grep** opdrag met die `-a, --text` vlag gebruik word om alle l√™ers as ASCII-teks te behandel:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Adjusting the `-A num, --after-context=num` flag allows for the display of more or fewer lines. This method is viable even for encrypted app binaries and has been verified against multiple App Store apps. Tools mentioned earlier may also be employed on jailbroken iOS devices for similar purposes.

**Note**: Direkte gebruik van die `strings`-opdrag word nie aanbeveel vir hierdie taak nie weens sy beperkings in die vind van relevante inligting. In plaas daarvan, is dit raadsaam om grep met die `-a` vlag op die bin√™re te gebruik of radare2 (`izz`)/rabin2 (`-zz`) te benut vir meer effektiewe resultate.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
