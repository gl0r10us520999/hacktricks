# iOS App Extensions

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}

App-Erweiterungen verbessern die Funktionalit√§t von Apps, indem sie es ihnen erm√∂glichen, mit anderen Apps oder dem System zu interagieren und benutzerdefinierte Funktionen oder Inhalte bereitzustellen. Diese Erweiterungen umfassen:

- **Benutzerdefinierte Tastatur**: Bietet eine einzigartige Tastatur in allen Apps und ersetzt die Standard-iOS-Tastatur.
- **Teilen**: Erm√∂glicht das Teilen in sozialen Netzwerken oder direkt mit anderen.
- **Heute (Widgets)**: Liefert Inhalte oder f√ºhrt Aufgaben schnell aus der Heute-Ansicht des Benachrichtigungszentrums aus.

Wenn ein Benutzer mit diesen Erweiterungen interagiert, wie z.B. das Teilen von Text aus einer Host-App, verarbeitet die Erweiterung diese Eingabe in ihrem Kontext und nutzt die geteilten Informationen, um ihre Aufgabe auszuf√ºhren, wie in der Dokumentation von Apple beschrieben.

### **Sicherheits√ºberlegungen**

Wichtige Sicherheitsaspekte umfassen:

- Erweiterungen und ihre enthaltenen Apps kommunizieren √ºber Interprozesskommunikation, nicht direkt.
- Das **Heute-Widget** ist einzigartig, da es seine App √ºber eine spezifische Methode √∂ffnen kann.
- Der Zugriff auf gemeinsam genutzte Daten ist innerhalb eines privaten Containers erlaubt, aber der direkte Zugriff ist eingeschr√§nkt.
- Bestimmte APIs, einschlie√ülich HealthKit, sind f√ºr App-Erweiterungen tabu, die auch keine lang laufenden Aufgaben starten, auf die Kamera oder das Mikrofon zugreifen k√∂nnen, au√üer f√ºr iMessage-Erweiterungen.

### Statische Analyse

#### **Identifizierung von App-Erweiterungen**

Um App-Erweiterungen im Quellcode zu finden, suchen Sie nach `NSExtensionPointIdentifier` in Xcode oder √ºberpr√ºfen Sie das App-Bundle auf `.appex`-Dateien, die Erweiterungen anzeigen. Ohne Quellcode verwenden Sie grep oder SSH, um diese Identifikatoren im App-Bundle zu finden.

#### **Unterst√ºtzte Datentypen**

√úberpr√ºfen Sie die `Info.plist`-Datei einer Erweiterung auf `NSExtensionActivationRule`, um unterst√ºtzte Datentypen zu identifizieren. Diese Einrichtung stellt sicher, dass nur kompatible Datentypen die Erweiterung in Host-Apps ausl√∂sen.

#### **Datenfreigabe**

Die Datenfreigabe zwischen einer App und ihrer Erweiterung erfordert einen gemeinsamen Container, der √ºber "App-Gruppen" eingerichtet und √ºber `NSUserDefaults` zugegriffen wird. Dieser gemeinsame Raum ist notwendig f√ºr Hintergrund√ºbertragungen, die von Erweiterungen initiiert werden.

#### **Einschr√§nkung von Erweiterungen**

Apps k√∂nnen bestimmte Erweiterungstypen einschr√§nken, insbesondere benutzerdefinierte Tastaturen, um sicherzustellen, dass die Verarbeitung sensibler Daten mit Sicherheitsprotokollen √ºbereinstimmt.

### Dynamische Analyse

Dynamische Analyse umfasst:

- **√úberpr√ºfen von gemeinsam genutzten Elementen**: Hook in `NSExtensionContext - inputItems`, um gemeinsam genutzte Datentypen und Urspr√ºnge zu sehen.
- **Identifizierung von Erweiterungen**: Entdecken Sie, welche Erweiterungen Ihre Daten verarbeiten, indem Sie interne Mechanismen wie `NSXPCConnection` beobachten.

Tools wie `frida-trace` k√∂nnen helfen, die zugrunde liegenden Prozesse zu verstehen, insbesondere f√ºr diejenigen, die an den technischen Details der Interprozesskommunikation interessiert sind.

## Referenzen
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/)

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
