# Android Applications Pentesting

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## Android Applications Basics

It's highly recommended to start reading this page to know about the **most important parts related to Android security and the most dangerous components in an Android application**:

{% content-ref url="android-applications-basics.md" %}
[android-applications-basics.md](android-applications-basics.md)
{% endcontent-ref %}

## ADB (Android Debug Bridge)

This is the main tool you need to connect to an android device (emulated or physical).\
**ADB** allows to control devices either over **USB** or **Network** from a computer. This utility enables the **copying** of files in both directions, **installation** and **uninstallation** of apps, **execution** of shell commands, **backing up** of data, **reading** of logs, among other functions.

Take a look to the following list of [**ADB Commands**](adb-commands.md) to learn how to use adb.

## Smali

Sometimes it is interesting to **modify the application code** to access **hidden information** (maybe well obfuscated passwords or flags). Then, it could be interesting to decompile the apk, modify the code and recompile it.\
[**In this tutorial** you can **learn how to decompile and APK, modify Smali code and recompile the APK** with the new functionality](smali-changes.md). This could be very useful as an **alternative for several tests during the dynamic analysis** that are going to presented. Then, **keep always in mid this possibility**.

## Other interesting tricks

* [Spoofing your location in Play Store](spoofing-your-location-in-play-store.md)
* **Download APKs**: [https://apps.evozi.com/apk-downloader/](https://apps.evozi.com/apk-downloader/), [https://apkpure.com/es/](https://apkpure.com/es/), [https://www.apkmirror.com/](https://www.apkmirror.com), [https://apkcombo.com/es-es/apk-downloader/](https://apkcombo.com/es-es/apk-downloader/)
* Extract APK from device:
```bash
adb shell pm list packages
com.android.insecurebankv2

adb shell pm path com.android.insecurebankv2
package:/data/app/com.android.insecurebankv2-Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk

adb pull /data/app/com.android.insecurebankv2- Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk
```
## Static Analysis

**QaQ** **APK** **analysing** **yIqaw** **java code** **ghItlh** **decompiler** **ghItlh**.\
**[** **ghItlh** **yIqaw** **decompilers** **ghItlh** **ghItlh** **yIqaw** **information** **ghItlh** **available** **decompilers** **ghItlh** **yIqaw** **here** **ghItlh** **yIqaw**](apk-decompilers.md).

### **QaQ** **Info** **ghItlh** **qawHaq**

**APK** **strings** **ghItlh** **yIqaw** **passwords**, **URLs** ([https://github.com/ndelphit/apkurlgrep](https://github.com/ndelphit/apkurlgrep)), **api** **keys**, **encryption**, **bluetooth uuids**, **tokens** **ghItlh** **anything** **qawHaq**... **qawHaq** **even** **code execution** **backdoors** **authentication backdoors** (hardcoded admin credentials **app**).

**Firebase**

**firebase URLs** **attention** **yIqaw** **bad configured**. [**More information** **FIrebase** **exploit** **ghItlh** **yIqaw** **here** **ghItlh**](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)

### **QaQ** **application** **yIqaw** **Manifest.xml**, **strings.xml** **ghItlh** **Basic understanding**

**Manifest.xml** **strings.xml** **examination** **application** **potential security vulnerabilities** **ghItlh**. **files** **accessed** **decompilers** **renaming** **APK** **file extension** **.zip** **unzipping**.

**Vulnerabilities** **Manifest.xml** **ghItlh**:

* **Debuggable Applications**: Applications **debuggable** (`debuggable="true"`) **Manifest.xml** **risk** **ghItlh** **allow** **connections** **lead** **exploitation**. **exploit debuggable applications** **tutorial** **finding** **exploiting debuggable applications** **device**.

* **Backup Settings**: `android:allowBackup="false"` **attribute** **explicitly set** **applications** **dealing** **sensitive information** **prevent** **unauthorized data backups** **adb**, **usb debugging** **enabled**.

* **Network Security**: Custom network security configurations (`android:networkSecurityConfig="@xml/network_security_config"`) **res/xml/** **specify** **security details** **certificate pins** **HTTP traffic settings**. **example** **allowing** **HTTP traffic** **specific domains**.

* **Exported Activities and Services**: **Identifying** **exported activities** **services** **manifest** **highlight** **components** **misused**. **analysis** **dynamic testing** **reveal** **exploit** **components**.

* **Content Providers and FileProviders**: **Exposed content providers** **allow** **unauthorized access** **modification** **data**. **configuration** **FileProviders** **scrutinized**.

* **Broadcast Receivers and URL Schemes**: **components** **leveraged** **exploitation**, **attention** **URL schemes** **managed** **input vulnerabilities**.

* **SDK Versions**: `minSdkVersion`, `targetSDKVersion`, **maxSdkVersion** **attributes** **indicate** **supported Android versions**, **highlighting** **importance** **supporting outdated, vulnerable Android versions** **security reasons**.

**strings.xml** **file**, **sensitive information** **API keys**, **custom schemas**, **developer notes** **discovered**, **underscoring** **need** **careful review** **resources**.

### **Tapjacking**

**Tapjacking** **attack** **malicious** **application** **launched** **positions itself** **top** **victim application**. **visibly obscures** **victim app**, **user interface** **designed** **trick** **user** **interact** **ghItlh**, **passing** **interaction** **victim app**.\
**effect**, **blinding** **user** **knowing** **performing actions** **victim app**.

**QaQ** **information** **ghItlh**:

{% content-ref url="tapjacking.md" %}
[tapjacking.md](tapjacking.md)
{% endcontent-ref %}

### **Task Hijacking**

**activity** **`launchMode`** **`singleTask`** **`taskAffinity`** **defined** **vulnerable** **task Hijacking**. **application** **installed** **launched** **real application** **hijack** **task** **real application** (so **user** **interacting** **malicious application thinking** **using** **real one**).

**info** **ghItlh**:

{% content-ref url="android-task-hijacking.md" %}
[android-task-hijacking.md](android-task-hijacking.md)
{% endcontent-ref %}

### **Insecure data storage**

**Internal Storage**

**Android**, **files** **stored** **internal** **storage** **designed** **accessible** **app** **created** **ghItlh**. **security measure** **enforced** **Android operating system** **generally adequate** **security needs** **applications**. **developers** **utilize** **modes** **`MODE_WORLD_READABLE`** **`MODE_WORLD_WRITABLE`** **allow** **files** **shared** **different applications**. **modes** **restrict access** **files** **applications**, **potentially malicious ones**.

1. **Static Analysis:**
- **Ensure** **use** `MODE_WORLD_READABLE` **`MODE_WORLD_WRITABLE`** **carefully scrutinized**. **modes** **potentially expose** **files** **unintended or unauthorized access**.

2. **Dynamic Analysis:**
- **Verify** **permissions** **set** **files** **created** **app**. **check** **files** **set** **readable or writable worldwide**. **pose** **significant security risk**, **allow** **application** **installed** **device**, **regardless** **origin or intent**, **read or modify** **files**.

**External Storage**

**dealing** **files** **external storage**, **SD Cards**, **precautions** **taken**:

1. **Accessibility**:
- **Files** **external storage** **globally readable and writable**. **means** **application** **user** **access** **files**.

2. **Security Concerns**:
- **Given** **ease** **access**, **advised** **store sensitive information** **external storage**.
- **External storage** **removed** **accessed** **application**, **making** **secure**.

3. **Handling Data from External Storage**:
- **Always** **perform input validation** **data** **retrieved** **external storage**. **crucial** **data** **untrusted source**.
- **Storing executables or class files** **external storage** **dynamic loading** **strongly discouraged**.
- **application** **retrieve executable files** **external storage**, **ensure** **files** **signed and cryptographically verified** **dynamically loaded**. **step** **vital** **maintaining** **security integrity** **application**.

**External storage** **accessed** **`/storage/emulated/0`** , **`/sdcard`** , **`/mnt/sdcard`**

{% hint style="info" %}
**Android 4.4** (**API 17**) **SD card** **directory structure** **limits access** **app** **directory** **specifically for that app**. **prevents** **malicious application** **gaining read or write access** **app's files**.
{% endhint %}

**Sensitive data stored in clear-text**

* **Shared preferences**: **Android** **allow** **application** **easily save xml files** **path** **`/data/data/<packagename>/shared_prefs/`** **sometimes** **possible** **find sensitive information** **clear-text** **folder**.
* **Databases**: **Android** **allow** **application** **easily save sqlite databases** **path** **`/data/data/<packagename>/databases/`** **sometimes** **possible** **find sensitive information** **clear-text** **folder**.

### **Broken TLS**

**Accept All Certificates**

**reason** **developers** **accept all the certificates** **example** **hostname** **match** **lines** **code** **following one**:
```java
SSLSocketFactory sf = new cc(trustStore);
sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
```
### Broken Cryptography

**Poor Key Management Processes**

Some developers save sensitive data in the local storage and encrypt it with a key hardcoded/predictable in the code. This shouldn't be done as some reversing could allow attackers to extract the confidential information.

**Use of Insecure and/or Deprecated Algorithms**

Developers shouldn't use **deprecated algorithms** to perform authorisation **checks**, **store** or **send** data. Some of these algorithms are: RC4, MD4, MD5, SHA1... If **hashes** are used to store passwords for example, hashes brute-force **resistant** should be used with salt.

### Other checks

* It's recommended to **obfuscate the APK** to difficult the reverse engineer labour to attackers.
* If the app is sensitive (like bank apps), it should perform it's **own checks to see if the mobile is rooted** and act in consequence.
* If the app is sensitive (like bank apps), it should check if an **emulator** is being used.
* If the app is sensitive (like bank apps), it should **check it's own integrity before executing** it to check if it was modified.
* Use [**APKiD**](https://github.com/rednaga/APKiD) to check which compiler/packer/obfuscator was used to build the APK

### React Native Application

Read the following page to learn how to easily access javascript code of React applications:

{% content-ref url="react-native-application.md" %}
[react-native-application.md](react-native-application.md)
{% endcontent-ref %}

### Xamarin Applications

Read the following page to learn how to easily access C# code of a xamarin applications:

{% content-ref url="../xamarin-apps.md" %}
[xamarin-apps.md](../xamarin-apps.md)
{% endcontent-ref %}

### Superpacked Applications

According to this [**blog post**](https://clearbluejar.github.io/posts/desuperpacking-meta-superpacked-apks-with-github-actions/) superpacked is a Meta algorithm that compress the content of an application into a single file. The blog talks about the possibility of creating an app that decompress these kind of apps... and a faster way which involves to **execute the application and gather the decompressed files from the filesystem.**

### Automated Static Code Analysis

The tool [**mariana-trench**](https://github.com/facebook/mariana-trench) is capable of finding **vulnerabilities** by **scanning** the **code** of the application. This tool contains a series of **known sources** (that indicates to the tool the **places** where the **input** is **controlled by the user**), **sinks** (which indicates to the tool **dangerous** **places** where malicious user input could cause damages) and **rules**. These rules indicates the **combination** of **sources-sinks** that indicates a vulnerability.

With this knowledge, **mariana-trench will review the code and find possible vulnerabilities on it**.

### Secrets leaked

An application may contain secrets (API keys, passwords, hidden urls, subdomains...) inside of it that you might be able to discover. You could us a tool such as [https://github.com/dwisiswant0/apkleaks](https://github.com/dwisiswant0/apkleaks)

### Bypass Biometric Authentication

{% content-ref url="bypass-biometric-authentication-android.md" %}
[bypass-biometric-authentication-android.md](bypass-biometric-authentication-android.md)
{% endcontent-ref %}

### Other interesting functions

* **Code execution**: `Runtime.exec(), ProcessBuilder(), native code:system()`
* **Send SMSs**: `sendTextMessage, sendMultipartTestMessage`
* **Native functions** declared as `native`: `public native, System.loadLibrary, System.load`
* [Read this to learn **how to reverse native functions**](reversing-native-libraries.md)

### **Other tricks**

{% content-ref url="content-protocol.md" %}
[content-protocol.md](content-protocol.md)
{% endcontent-ref %}

***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

***

## Dynamic Analysis

> First of all, you need an environment where you can install the application and all the environment (Burp CA cert, Drozer and Frida mainly). Therefore, a rooted device (emulated or not) is extremely recommended.

### Online Dynamic analysis

You can create a **free account** in: [https://appetize.io/](https://appetize.io). This platform allows you to **upload** and **execute** APKs, so it is useful to see how an apk is behaving.

You can even **see the logs of your application** in the web and connect through **adb**.

![](<../../.gitbook/assets/image (60).png>)

Thanks to the ADB connection you can use **Drozer** and **Frida** inside the emulators.

### Local Dynamic Analysis

#### Using an emulator

* [**Android Studio**](https://developer.android.com/studio) (You can create **x86** and **arm** devices, and according to [**this** ](https://android-developers.googleblog.com/2020/03/run-arm-apps-on-android-emulator.html)**latest x86** versions **support ARM libraries** without needing an slow arm emulator).
* Learn to set it up in this page:

{% content-ref url="avd-android-virtual-device.md" %}
[avd-android-virtual-device.md](avd-android-virtual-device.md)
{% endcontent-ref %}

* [**Genymotion**](https://www.genymotion.com/fun-zone/) **(Free version:** Personal Edition, you need to create an account. _It's recommend to **download** the version **WITH**_ _**VirtualBox** to avoid potential errors._)
* [**Nox**](https://es.bignox.com) (Free, but it doesn't support Frida or Drozer).

{% hint style="info" %}
When creating a new emulator on any platform remember that the bigger the screen is, the slower the emulator will run. So select small screens if possible.
{% endhint %}

To **install google services** (like AppStore) in Genymotion you need to click on the red marked button of the following image:

![](<../../.gitbook/assets/image (200) (1).png>)

Also, notice that in the **configuration of the Android VM in Genymotion** you can select **Bridge Network mode** (this will be useful if you will be connecting to the Android VM from a different VM with the tools).
#### Use a physical device

**ghItlh** **debugging** **chel** **options** **'ej** **root** **vItlhutlh**:

1. **Settings**.
2. (FromAndroid 8.0) **System** **ghItlh** **Select**.
3. **About phone** **ghItlh** **Select**.
4. **Build number** **7** **veb** **Press**.
5. **Developer options** **ghItlh** **back** **'ej** **yIqaw**.

> **application** **lagh** **installed** **vItlhutlh**, **qaStaHvIS** **ghItlh** **jatlh** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh** **'e'** **'ej** **qaStaHvIS** **jatlh
```bash
adb shell am start -n com.example.demo/com.example.test.MainActivity
```
**NOTE**: MobSF will detect as malicious the use of _**singleTask/singleInstance**_ as `android:launchMode` in an activity, but due to [this](https://github.com/MobSF/Mobile-Security-Framework-MobSF/pull/750), apparently this is only dangerous on old versions (API versions < 21).

{% hint style="info" %}
Note that an authorisation bypass is not always a vulnerability, it would depend on how the bypass works and which information is exposed.
{% endhint %}

**Sensitive information leakage**

**Activities can also return results**. If you manage to find an exported and unprotected activity calling the **`setResult`** method and **returning sensitive information**, there is a sensitive information leakage.

#### Tapjacking

If tapjacking isn't prevented, you could abuse the exported activity to make the **user perform unexpected actions**. For more info about [**what is Tapjacking follow the link**](./#tapjacking).

### Exploiting Content Providers - Accessing and manipulating sensitive information

[**Read this if you want to refresh what is a Content Provider.**](android-applications-basics.md#content-provider)\
Content providers are basically used to **share data**. If an app has available content providers you may be able to **extract sensitive** data from them. It also interesting to test possible **SQL injections** and **Path Traversals** as they could be vulnerable.

[**Learn how to exploit Content Providers with Drozer.**](drozer-tutorial/#content-providers)

### **Exploiting Services**

[**Read this if you want to refresh what is a Service.**](android-applications-basics.md#services)\
Remember that a the actions of a Service start in the method `onStartCommand`.

As service is basically something that **can receive data**, **process** it and **returns** (or not) a response. Then, if an application is exporting some services you should **check** the **code** to understand what is it doing and **test** it **dynamically** for extracting confidential info, bypassing authentication measures...\
[**Learn how to exploit Services with Drozer.**](drozer-tutorial/#services)

### **Exploiting Broadcast Receivers**

[**Read this if you want to refresh what is a Broadcast Receiver.**](android-applications-basics.md#broadcast-receivers)\
Remember that a the actions of a Broadcast Receiver start in the method `onReceive`.

A broadcast receiver will be waiting for a type of message. Depending on ho the receiver handles the message it could be vulnerable.\
[**Learn how to exploit Broadcast Receivers with Drozer.**](./#exploiting-broadcast-receivers)

### **Exploiting Schemes / Deep links**

You can look for deep links manually, using tools like MobSF or scripts like [this one](https://github.com/ashleykinguk/FBLinkBuilder/blob/master/FBLinkBuilder.py).\
You can **open** a declared **scheme** using **adb** or a **browser**:

{% code overflow="wrap" %}
```bash
adb shell am start -a android.intent.action.VIEW -d "scheme://hostname/path?param=value" [your.package.name]
```
{% endcode %}

_Note that you can **omit the package name** and the mobile will automatically call the app that should open that link._

{% code overflow="wrap" %}
```markup
<!-- Browser regular link -->
<a href="scheme://hostname/path?param=value">Click me</a>
<!-- fallback in your url you could try the intent url -->
<a href="intent://hostname#Intent;scheme=scheme;package=your.package.name;S.browser_fallback_url=http%3A%2F%2Fwww.example.com;end">with alternative</a>
```
{% endcode %}

**QapDIchDaq**

**App** vItlhutlh **code** **jImej** **App** **activity** **Deeplink** **ghItlh** **'onNewIntent'** **ghItlh** **function** **Doch**.

![](<../../.gitbook/assets/image (436) (1) (1) (1).png>)

**QapDIchDaq** **ghItlh**

**Deeplink** **QapDIchDaq** **'URL parameters'** **ghItlh** **sensitive data (passwords)** **ghItlh** **pagh** **'Impersonate'** **Deeplink** **'leak'** **'data'** **'steal'** **'application'** **'vuln'** **'info'** **'here'**.

**Path** **parameters** **ghItlh**

**Deeplink** **QapDIchDaq** **'URL path'** **parameters** **ghItlh** **'parameter'** **'URL'** **'path'** **'https://api.example.com/v1/users/{username}'** , **'example://app/users?username=../../unwanted-endpoint%3fparam=value'** **'path traversal'** **'Open Redirect'** **'account takeover'** **'vuln'** **'info'** **'here'**.

**QapDIchDaq** **'examples'**

**[interesting bug bounty report](https://hackerone.com/reports/855618)** **'links'** (_/.well-known/assetlinks.json_).

### **Transport Layer Inspection and Verification Failures**

- **Certificates** **'Android applications'** **'inspect'** **'warnings'** **'self-signed certificates'** **'HTTP connections'**.
- **SSL/TLS handshake** **'weak'** **'insecure cipher suites'** **'vuln'** **'man-in-the-middle (MITM) attacks'** **'decrypt'** **'data'**.
- **'Leakage'** **'private information'** **'applications'** **'authenticate'** **'secure channels'** **'communicate'** **'non-secure channels'** **'transactions'** **'protect'** **'sensitive data'** **'session cookies'** **'user details'** **'interception'** **'malicious entities'**.

#### **Certificate Verification**

**'Certificate verification'** **'focus'**. **'Server's certificate'** **'verify'** **'enhance security'**. **'Insecure TLS configurations'** **'transmission'** **'sensitive data'** **'unencrypted channels'** **'pose significant risks'**. **'Verifying server certificates'** **'addressing vulnerabilities'** **'resource'**.

#### **SSL Pinning**

**SSL Pinning** **'security measure'** **'application'** **'verify'** **'server's certificate'** **'known copy'** **'stored'** **'application'**. **'Preventing MITM attacks'**. **'Implementing SSL Pinning'** **'strongly recommended'** **'applications'** **'handling sensitive information'**.

#### **Traffic Inspection**

**HTTP traffic** **'inspect'** **'install'** **'proxy tool's certificate'** **(e.g., Burp)**. **'Installing'** **'certificate'** **'encrypted traffic'** **'visible'** **'proxy'**. **'Installing a custom CA certificate'** **'guide'**.

**API Level 24 and above** **'modifications'** **'Network Security Config'** **'accept'** **'proxy's CA certificate'**. **'Inspecting encrypted traffic'** **'critical'**. **'Modifying the Network Security Config'** **'tutorial'**.

#### **Bypassing SSL Pinning**

**SSL Pinning** **'implemented'** **'bypassing'** **'necessary'** **'inspect HTTPS traffic'**. **'Methods'** **'available'**:

* **'Automatically modify'** **'apk'** **'bypass'** **'SSLPinning'** **'apk-mitm'**. **'Pro'** **'won't need root'** **'bypass'** **'SSL Pinning'** **'delete'** **'application'** **'reinstall'** **'won't always work'**.
* **'Frida'** **'bypass'** **'protection'**. **'Guide'** **'Burp+Frida+Genymotion'**.
* **'Automatically bypass SSL Pinning'** **'objection'** **'objection --gadget com.package.app explore --startup-command "android sslpinning disable"'**.
* **'Automatically bypass SSL Pinning'** **'MobSF dynamic analysis'**.
* **'Forward the traffic to burp using iptables'**.

#### **Looking for Common Web Vulnerabilities**

**'Search'** **'common web vulnerabilities'** **'application'**. **'Identifying'** **'mitigating'** **'vulnerabilities'**.

### **Frida**

[Frida](https://www.frida.re) **'dynamic instrumentation toolkit'** **'developers'** **'reverse-engineers'** **'security researchers'**.\
**'Access'** **'running application'** **'hook methods'** **'run time'** **'change behaviour'** **'change values'** **'extract values'** **'run different code'**.\
**'Pentest Android applications'** **'know'** **'use Frida'**.

* **'Learn how to use Frida'**.
* **'GUI'** **'actions with Frida'**.
* **'Ojection'** **'automate'** **'Frida'**.
* **'Awesome Frida scripts'**.

### **Dump Memory - Fridump**

**'Check'** **'application'** **'storing sensitive information'** **'memory'** **'shouldn't be storing'** **'passwords'** **'mnemonics'**.

[**Fridump3**](https://github.com/rootbsd/fridump3) **'dump'** **'memory'** **'app'** **'with'**:
```bash
# With PID
python3 fridump3.py -u <PID>

# With name
frida-ps -Uai
python3 fridump3.py -u "<Name>"
```
ghItlhmeH ./dump folder, 'ej 'e' vItlhutlh:

{% code overflow="wrap" %}
```bash
strings * | grep -E "^[a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+$"
```
{% endcode %}

### **QaStaHvIS Sensitive data vIneH**

In Android, vIneH Keystore vItlhutlh vIneH vItlhutlh, 'ach, vItlhutlh **vIneH vItlhutlh vIneH** vItlhutlh vaj vIneH. vaj applications tends to vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIneH vItlhutlh vIne
```bash
frida -U -f com.example.app -l frida-scripts/tracer-cipher.js
```
### **Fingerprint/Biometrics Bypass**

Using the following Frida script it could be possible to **bypass fingerprint authentication** Android applications might be performing in order to **protect certain sensitive areas:**

{% code overflow="wrap" %}
```bash
frida --codeshare krapgras/android-biometric-bypass-update-android-11 -U -f <app.package>
```
{% endcode %}

### **Qa'Hom 'ej Qa'Hom**

Qa'HomDaq 'oH 'ej Android vItlhutlh 'ej **Qa'HomDaq snapshot** 'oH ghaH 'ej 'ach, 'oH vItlhutlhDaq 'e' vItlhutlhDaq snapshot vItlhutlhDaq **sensitive information**, snapshot vItlhutlhDaq 'e' vItlhutlhDaq **info** (root vItlhutlhDaq 'e' vItlhutlhDaq 'e' vItlhutlhDaq).

Snapshots usually vItlhutlhDaq: **`/data/system_ce/0/snapshots`**

Android **screenshot capture prevent** 'e' vItlhutlhDaq FLAG\_SECURE layout parameter. 'ej flag vItlhutlhDaq, window contents vItlhutlhDaq 'e' vItlhutlhDaq, screenshots vItlhutlhDaq 'ej non-secure displays vItlhutlhDaq vItlhutlhDaq.
```bash
getWindow().setFlags(LayoutParams.FLAG_SECURE, LayoutParams.FLAG_SECURE);
```
### **Android Application Analyzer**

**Android Application Analyzer** vItlhDI' tool Hoch vItlhutlh tools during the dynamic analysis: [https://github.com/NotSoSecure/android\_application\_analyzer](https://github.com/NotSoSecure/android\_application\_analyzer)

### Intent Injection

Developers often create proxy components like activities, services, and broadcast receivers that handle these Intents and pass them to methods such as `startActivity(...)` or `sendBroadcast(...)`, which can be risky.

The danger lies in allowing attackers to trigger non-exported app components or access sensitive content providers by misdirecting these Intents. A notable example is the `WebView` component converting URLs to `Intent` objects via `Intent.parseUri(...)` and then executing them, potentially leading to malicious Intent injections.

### Essential Takeaways
- **Intent Injection** vItlhDI' web's Open Redirect issue.
- Exploits involve passing `Intent` objects as extras, which can be redirected to execute unsafe operations.
- It can expose non-exported components and content providers to attackers.
- `WebView`‚Äôs URL to `Intent` conversion can facilitate unintended actions.

### Android Client Side Injections and others

Probably you know about this kind of vulnerabilities from the Web. You have to be specially careful with this vulnerabilities in an Android application:

* **SQL Injection:** When dealing with dynamic queries or Content-Providers ensure you are using parameterized queries.
* **JavaScript Injection (XSS):** Verify that JavaScript and Plugin support is disabled for any WebViews (disabled by default). [More info here](webview-attacks.md#javascript-enabled).
* **Local File Inclusion:** WebViews should have access to the file system disabled (enabled by default) - `(webview.getSettings().setAllowFileAccess(false);)`. [More info here](webview-attacks.md#javascript-enabled).
* **Eternal cookies**: In several cases when the android application finish the session the cookie isn't revoked or it could be even saved to disk
* [**Secure Flag** in cookies](../../pentesting-web/hacking-with-cookies/#cookies-flags)

***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

## Automatic Analysis

### [MobSF](https://github.com/MobSF/Mobile-Security-Framework-MobSF)

**Static analysis**

![](<../../.gitbook/assets/image (61).png>)

**Vulnerability assessment of the application** using a nice web-based frontend. You can also perform dynamic analysis (but you need to prepare the environment).
```bash
docker pull opensecurity/mobile-security-framework-mobsf
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest
```
Qapla'! MobSF **Android**(apk)**, IOS**(ipa) **je Windows**(apx) qapla' 'oH **analysing**. (_Windows 'oH MobSF installed Windows host_).\
DaH jImej **ZIP** file **source code** **Android** 'ej **IOS** app (go to root folder application, select 'ej create ZIPfile), 'oH **analysing**.

MobSF **diff/Compare** **analysis** 'ej **VirusTotal** **integrate** (API key _MobSF/settings.py_ 'ej enable: `VT_ENABLED = TRUE` `VT_API_KEY = <Your API key>` `VT_UPLOAD = TRUE`). 'ej `VT_UPLOAD` **False** set, **hash** **upload** file.

### Assisted Dynamic analysis with MobSF

**MobSF** **dynamic analysis** **Android** **helpful**, 'ach vaj MobSF **genymotion** **install** host (VM 'ej Docker won't). _Note: **genymotion** **VM start** 'ej **MobSF.**_\
**MobSF dynamic analyser**:

* **Dump application data** (URLs, logs, clipboard, screenshots made by you, screenshots made by "**Exported Activity Tester**", emails, SQLite databases, XML files, 'ej created files). 'oH automatically screenshots, 'oH press screenshot 'ej press "**Exported Activity Tester**" screenshots exported activities.
* Capture **HTTPS traffic**
* **Frida** **runtime** **information** **obtain**

android **versions > 5**, **automatically start Frida** 'ej set global **proxy** settings **capture** traffic. 'oH traffic tested application.

**Frida**

By default, 'oH Frida Scripts **bypass SSL pinning**, **root detection** 'ej **debugger detection** 'ej **monitor interesting APIs**.\
MobSF **invoke exported activities**, **grab screenshots** 'ej **save** report.

**Start** dynamic testing press green bottom: "**Start Instrumentation**". Press "**Frida Live Logs**" logs generated Frida scripts "**Live API Monitor**" invocation hooked methods, arguments passed 'ej returned values (appear pressing "Start Instrumentation").\
MobSF **load your own Frida scripts** (results Friday scripts MobSF **send()** function). 'oH **several pre-written scripts** load (add `MobSF/DynamicAnalyzer/tools/frida_scripts/others/`), **select**, press "**Load**" 'ej press "**Start Instrumentation**" (logs scripts inside "**Frida Live Logs**").

![](<../../.gitbook/assets/image (215).png>)

Moreover, 'oH Auxiliary Frida functionalities:

* **Enumerate Loaded Classes**: 'oH print loaded classes
* **Capture Strings**: 'oH print capture strings application (super noisy)
* **Capture String Comparisons**: 'oH **show 2 strings compared** 'ej result True 'ej False.
* **Enumerate Class Methods**: Put class name (like "java.io.File") 'ej print methods class.
* **Search Class Pattern**: Search classes pattern
* **Trace Class Methods**: **Trace** **whole class** (inputs 'ej outputs methods class). Remember MobSF traces several interesting Android Api methods.

Selected auxiliary module 'oH press "**Start Intrumentation**" 'ej 'oH outputs "**Frida Live Logs**".

**Shell**

Mobsf 'oH shell **adb** commands, **MobSF commands**, 'ej common **shell** **commands** bottom dynamic analysis page. Some interesting commands:
```bash
help
shell ls
activities
exported_activities
services
receivers
```
**HTTP tools**

When http traffic is capture you can see an ugly view of the captured traffic on "**HTTP(S) Traffic**" bottom or a nicer view in "**Start HTTPTools**" green bottom. From the second option, you can **send** the **captured requests** to **proxies** like Burp or Owasp ZAP.\
To do so, _power on Burp -->_ _turn off Intercept --> in MobSB HTTPTools select the request_ --> press "**Send to Fuzzer**" --> _select the proxy address_ ([http://127.0.0.1:8080\\](http://127.0.0.1:8080)).

Once you finish the dynamic analysis with MobSF you can press on "**Start Web API Fuzzer**" to **fuzz http requests** an look for vulnerabilities.

{% hint style="info" %}
After performing a dynamic analysis with MobSF the proxy settings me be misconfigured and you won't be able to fix them from the GUI. You can fix the proxy settings by doing:

**HTTP tools**

When http traffic is capture you can see an ugly view of the captured traffic on "**HTTP(S) Traffic**" bottom or a nicer view in "**Start HTTPTools**" green bottom. From the second option, you can **send** the **captured requests** to **proxies** like Burp or Owasp ZAP.\
To do so, _power on Burp -->_ _turn off Intercept --> in MobSB HTTPTools select the request_ --> press "**Send to Fuzzer**" --> _select the proxy address_ ([http://127.0.0.1:8080\\](http://127.0.0.1:8080)).

Once you finish the dynamic analysis with MobSF you can press on "**Start Web API Fuzzer**" to **fuzz http requests** an look for vulnerabilities.

{% hint style="info" %}
After performing a dynamic analysis with MobSF the proxy settings me be misconfigured and you won't be able to fix them from the GUI. You can fix the proxy settings by doing:
```
adb shell settings put global http_proxy :0
```
{% endhint %}

### Assisted Dynamic Analysis with Inspeckage

You can get the tool from [**Inspeckage**](https://github.com/ac-pm/Inspeckage).\
This tool with use some **Hooks** to let you know **what is happening in the application** while you perform a **dynamic analysis**.


### [Yaazhini](https://www.vegabird.com/yaazhini/)

This is a **great tool to perform static analysis with a GUI**

![](<../../.gitbook/assets/image (527).png>)

### [Qark](https://github.com/linkedin/qark)

This tool is designed to look for several **security related Android application vulnerabilities**, either in **source code** or **packaged APKs**. The tool is also **capable of creating a "Proof-of-Concept" deployable APK** and **ADB commands**, to exploit some of the found vulnerabilities (Exposed activities, intents, tapjacking...). As with Drozer, there is no need to root the test device.
```bash
pip3 install --user qark  # --user is only needed if not using a virtualenv
qark --apk path/to/my.apk
qark --java path/to/parent/java/folder
qark --java path/to/specific/java/file.java
```
### [**ReverseAPK**](https://github.com/1N3/ReverseAPK.git)

* **ghItlh** - bIngDaq jImej
* **APK** qawHaq **Java** je **Smali** format **ghItlhDaq decompile** 
* **AndroidManifest.xml** **common vulnerabilities je behavior** **analyze** 
* **Static source code analysis** **common vulnerabilities je behavior** 
* **Device info**
* je **vItlhutlh**
```bash
reverse-apk relative/path/to/APP.apk
```
### [SUPER Android Analyzer](https://github.com/SUPERAndroidAnalyzer/super)

SUPER jenbogh 'ej command-line application Hoch, vaj Windows, MacOS X 'ej Linux, 'ej analyzes _.apk_ files search vulnerabilities. vItlhutlh 'e' vItlhutlh APKs 'ej applying 'ej rules.json file, 'ej company tester create rules analyze cha'logh.

Download latest binaries [download page](https://superanalyzer.rocks/download.html) DaH jImej.
```
super-analyzer {apk_file}
```
### [StaCoAn](https://github.com/vincentcox/StaCoAn)

![](<../../.gitbook/assets/image (62).png>)

StaCoAn jup'a' **crossplatform** tool vItlhutlh developers, bugbounty hunters je ethical hackers performing [static code analysis](https://en.wikipedia.org/wiki/Static\_program\_analysis) on mobile applications.

The concept vItlhutlh you drag je drop your mobile application file (an .apk or .ipa file) on the StaCoAn application je 'e' generate a visual je portable report for you. You can tweak the settings je wordlists to get a customized experience.

Download[ latest release](https://github.com/vincentcox/StaCoAn/releases):
```
./stacoan
```
### [AndroBugs](https://github.com/AndroBugs/AndroBugs\_Framework)

AndroBugs Framework jatlh 'ej Android vulnerability analysis system 'oH developers hackers potential security vulnerabilities Android applications.\
[Windows releases](https://github.com/AndroBugs/AndroBugs\_Framework/releases)
```
python androbugs.py -f [APK file]
androbugs.exe -f [APK file]
```
### [Androwarn](https://github.com/maaaaz/androwarn)

**Androwarn** jup'a' tool vItlhutlh vItlhutlh 'ej warn user potential malicious behaviours developped by an Android application.

The detection is performed with the **static analysis** of the application's Dalvik bytecode, represented as **Smali**, with the [`androguard`](https://github.com/androguard/androguard) library.

This tool looks for **common behavior of "bad" applications** like: Telephony identifiers exfiltration, Audio/video flow interception, PIM data modification, Arbitrary code execution...
```
python androwarn.py -i my_application_to_be_analyzed.apk -r html -v 3
```
### [MARA Framework](https://github.com/xtiankisutsa/MARA\_Framework)

![](<../../.gitbook/assets/image (81).png>)

**MARA** jatlh **M**obile **A**pplication **R**everse engineering je **A**nalysis Framework. Qapla' mobile application reverse engineering je analysis tools, to assist in testing mobile applications against the OWASP mobile security threats. Qapla' Hoch 'ej friendly mobile application developers je security professionals.

Qapla' 'ej:

* Java je Smali code using different tools extract
* APKs using analyze: [smalisca](https://github.com/dorneanu/smalisca), [ClassyShark](https://github.com/google/android-classyshark), [androbugs](https://github.com/AndroBugs/AndroBugs\_Framework), [androwarn](https://github.com/maaaaz/androwarn), [APKiD](https://github.com/rednaga/APKiD) analyze
* APK from private information extract regexps using.
* Manifest analyze.
* found domains using analyze: [pyssltest](https://github.com/moheshmohan/pyssltest), [testssl](https://github.com/drwetter/testssl.sh) je [whatweb](https://github.com/urbanadventurer/WhatWeb)
* APK via [apk-deguard.com](http://www.apk-deguard.com) Deobfuscate

### Koodous

malware detect: [https://koodous.com/](https://koodous.com) Qapla'

## Obfuscating/Deobfuscating code

Note that depending the service and configuration you use to obfuscate the code. Secrets may or may not ended obfuscated.

### [ProGuard](https://en.wikipedia.org/wiki/ProGuard\_\(software\))

[Wikipedia](https://en.wikipedia.org/wiki/ProGuard\_\(software\)) vItlhutlh **ProGuard** 'oH open source command-line tool that shrinks, optimizes je obfuscates Java code. bytecode optimize je detect je remove unused instructions. ProGuard free software je GNU General Public License, version 2 distributed.

ProGuard Android SDK part je application building when runs.

### [DexGuard](https://www.guardsquare.com/dexguard)

[https://blog.lexfo.fr/dexguard.html](https://blog.lexfo.fr/dexguard.html) vItlhutlh step-by-step guide to deobfuscate the apk.

(From that guide) Last time we checked, the Dexguard mode of operation was:

* load a resource as an InputStream;
* feed the result to a class inheriting from FilterInputStream to decrypt it;
* do some useless obfuscation to waste a few minutes of time from a reverser;
* feed the decrypted result to a ZipInputStream to get a DEX file;
* finally load the resulting DEX as a Resource using the `loadDex` method.

### [DeGuard](http://apk-deguard.com)

**DeGuard reverses the process of obfuscation performed by Android obfuscation tools. This enables numerous security analyses, including code inspection and predicting libraries.**

You can upload an obfuscated APK to their platform.

### [Simplify](https://github.com/CalebFenton/simplify)

**generic android deobfuscator.** Simplify **virtually executes an app** to understand its behavior je **tries to optimize the code** so it behaves identically but is easier for a human to understand. Each optimization type is simple je generic, so it doesn't matter what the specific type of obfuscation is used.

### [APKiD](https://github.com/rednaga/APKiD)

APKiD gives you information about **how an APK was made**. It identifies many **compilers**, **packers**, **obfuscators**, je other weird stuff. It's [_PEiD_](https://www.aldeid.com/wiki/PEiD) for Android.

### Manual

[manual-deobfuscation.md](manual-deobfuscation.md) vItlhutlh tutorial to learn some tricks on **how to reverse custom obfuscation**

## Labs

### [Androl4b](https://github.com/sh4hin/Androl4b)

AndroL4b is an Android security virtual machine based on ubuntu-mate includes the collection of latest framework, tutorials je labs from different security geeks je researchers for reverse engineering je malware analysis.

## References

* [https://owasp.org/www-project-mobile-app-security/](https://owasp.org/www-project-mobile-app-security/)
* [https://appsecwiki.com/#/](https://appsecwiki.com/#/) It is a great list of resources
* [https://maddiestone.github.io/AndroidAppRE/](https://maddiestone.github.io/AndroidAppRE/) Android quick course
* [https://manifestsecurity.com/android-application-security/](https://manifestsecurity.com/android-application-security/)
* [https://github.com/Ralireza/Android-Security-Teryaagh](https://github.com/Ralireza/Android-Security-Teryaagh)
* [https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec](https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec)

## Yet to try

* [https://www.vegabird.com/yaazhini/](https://www.vegabird.com/yaazhini/)
* [https://github.com/abhi-r3v0/Adhrit](https://github.com/abhi-r3v0/Adhrit)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Join [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server to communicate with experienced hackers and bug bounty hunters!

**Hacking Insights**\
Engage with content that delves into the thrill and challenges of hacking

**Real-Time Hack News**\
Keep up-to-date with fast-paced hacking world through real-time news and insights

**Latest Announcements**\
Stay informed with the newest bug bounties launching and crucial platform updates

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) and start collaborating with top hackers today!

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
