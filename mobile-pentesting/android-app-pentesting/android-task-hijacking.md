# Android Task Hijacking

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>qa'vIn AWS hacking</strong></a><strong>!</strong></summary>

HackTricks vItlhutlh:

* **HackTricks vItlhutlh** **tlhInganpu'** **advertised** **company** **download** **HackTricks PDF** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) **Check**!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) **Get**
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) **Discover**, [**NFTs**](https://opensea.io/collection/the-peass-family) **exclusive** **collection** **our**
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) **telegram group** [**follow**](https://t.me/peass) **us** **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos** **submitting PRs**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

**vulnerabilities** **Find** **matter** **fix** **them** **faster**. **Intruder** **attack surface** **your** **tracks**, **proactive threat scans** **runs**, **issues** **your** **whole tech stack**, **from APIs** **web apps** **cloud systems**. [**Try it for free**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) **today**.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Task, Back Stack and Foreground Activities

**Android** **task** **essentially** **activities** **set** **users interact with** **specific job**, **back stack** **organized**. **stack** **activities** **based** **opened**, **recent activity** **top** **foreground activity**. **moment**, **activity** **visible** **screen**, **part** **foreground task**.

**activity transitions** **quick breakdown**:

- **Activity 1** **starts** **sole activity** **foreground**.
- **Activity 2** **Launching** **pushes** **Activity 1** **back stack**, **Activity 2** **foreground**.
- **Activity 3** **Starting** **moves** **Activity 1** **Activity 2** **back** **stack**, **Activity 3** **front**.
- **Activity 3** **Closing** **brings** **Activity 2** **foreground**, **Android's streamlined task navigation mechanism** **showcasing**.

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## Task affinity attack

### Task Affinity and Launch Modes

**Android applications**, **task affinity** **activity's preferred task** **aligning** **app's package name** **typically**. **setup** **crafting** **proof-of-concept (PoC) app** **demonstrating** **attack** **instrumental**.

### Launch Modes

**launchMode** **attribute** **directs** **handling** **activity instances** **tasks**. **singleTask** **mode** **pivotal** **attack**, **dictating** **scenarios** **existing activity instances** **task affinity matches**. **exploit** **ability** **attacker's app** **mimic** **target app's task affinity**, **Android system** **launching** **attacker's app** **intended target**.

### Detailed Attack Steps

1. **Malicious App Installation**: **victim** **installs** **attacker's app** **device**.
2. **Initial Activation**: **victim** **opens** **malicious app** **first**, **device** **attack** **setting up**.
3. **Target App Launch Attempt**: **victim** **attempts** **open** **target app**.
4. **Hijack Execution**: **matching task affinity**, **malicious app** **launched** **place** **target app**.
5. **Deception**: **malicious app** **presents** **fake login screen** **resembling** **target app**, **tricking** **user** **entering** **sensitive information**.

**practical implementation** **attack**, **refer** **Task Hijacking Strandhogg repository** **GitHub**: [Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg).

### Prevention Measures

**prevent** **attacks**, **developers** **set** `taskAffinity` **empty string** **opt** **`singleInstance`** **launch mode**, **app's isolation** **ensuring**. **Customizing** `onBackPressed()` **function** **additional protection** **task hijacking**.

## **References**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

**vulnerabilities** **Find** **matter** **fix** **them** **faster**. **Intruder** **attack surface** **your** **tracks**, **proactive threat scans** **runs**, **issues** **your** **whole tech stack**, **from APIs** **web apps** **cloud systems**. [**Try it for free**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) **today**.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>qa'vIn AWS hacking</strong></a><strong>!</strong></summary>

HackTricks vItlhutlh:

* **HackTricks vItlhutlh** **tlhInganpu'** **advertised** **company** **download** **HackTricks PDF** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) **Check**!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) **Get**
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) **Discover**, [**NFTs**](https://opensea.io/collection/the-peass-family) **exclusive** **collection** **our**
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) **telegram group** [**follow**](https://t.me/peass) **us** **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos** **submitting PRs**.

</details>
