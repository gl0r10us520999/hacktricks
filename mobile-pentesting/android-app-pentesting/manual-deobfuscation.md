{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Manual **T√©cnicas de De-obfuscaci√≥n**

En el √°mbito de la **seguridad del software**, el proceso de hacer que el c√≥digo oscurecido sea comprensible, conocido como **de-obfuscaci√≥n**, es crucial. Esta gu√≠a profundiza en varias estrategias para la de-obfuscaci√≥n, centr√°ndose en t√©cnicas de an√°lisis est√°tico y reconociendo patrones de ofuscaci√≥n. Adem√°s, introduce un ejercicio para la aplicaci√≥n pr√°ctica y sugiere recursos adicionales para aquellos interesados en explorar temas m√°s avanzados.

### **Estrategias para la De-obfuscaci√≥n Est√°tica**

Al tratar con **c√≥digo ofuscado**, se pueden emplear varias estrategias dependiendo de la naturaleza de la ofuscaci√≥n:

- **Bytecode DEX (Java)**: Un enfoque efectivo implica identificar los m√©todos de de-obfuscaci√≥n de la aplicaci√≥n, luego replicar estos m√©todos en un archivo Java. Este archivo se ejecuta para revertir la ofuscaci√≥n en los elementos objetivo.
- **C√≥digo Java y Nativo**: Otro m√©todo es traducir el algoritmo de de-obfuscaci√≥n a un lenguaje de scripting como Python. Esta estrategia destaca que el objetivo principal no es entender completamente el algoritmo, sino ejecutarlo de manera efectiva.

### **Identificaci√≥n de la Ofuscaci√≥n**

Reconocer el c√≥digo ofuscado es el primer paso en el proceso de de-obfuscaci√≥n. Los indicadores clave incluyen:

- La **ausencia o desorden de cadenas** en Java y Android, lo que puede sugerir ofuscaci√≥n de cadenas.
- La **presencia de archivos binarios** en el directorio de assets o llamadas a `DexClassLoader`, lo que sugiere desempaquetado de c√≥digo y carga din√°mica.
- El uso de **bibliotecas nativas junto con funciones JNI no identificables**, indicando una posible ofuscaci√≥n de m√©todos nativos.

## **An√°lisis Din√°mico en la De-obfuscaci√≥n**

Al ejecutar el c√≥digo en un entorno controlado, el an√°lisis din√°mico **permite observar c√≥mo se comporta el c√≥digo ofuscado en tiempo real**. Este m√©todo es particularmente efectivo para descubrir el funcionamiento interno de patrones de ofuscaci√≥n complejos que est√°n dise√±ados para ocultar la verdadera intenci√≥n del c√≥digo.

### **Aplicaciones del An√°lisis Din√°mico**

- **Desencriptaci√≥n en Tiempo de Ejecuci√≥n**: Muchas t√©cnicas de ofuscaci√≥n implican encriptar cadenas o segmentos de c√≥digo que solo se desencriptan en tiempo de ejecuci√≥n. A trav√©s del an√°lisis din√°mico, estos elementos encriptados pueden ser capturados en el momento de la desencriptaci√≥n, revelando su forma verdadera.
- **Identificaci√≥n de T√©cnicas de Ofuscaci√≥n**: Al monitorear el comportamiento de la aplicaci√≥n, el an√°lisis din√°mico puede ayudar a identificar t√©cnicas espec√≠ficas de ofuscaci√≥n que se est√°n utilizando, como virtualizaci√≥n de c√≥digo, empaquetadores o generaci√≥n din√°mica de c√≥digo.
- **Descubrimiento de Funcionalidades Ocultas**: El c√≥digo ofuscado puede contener funcionalidades ocultas que no son evidentes a trav√©s del an√°lisis est√°tico solo. El an√°lisis din√°mico permite observar todos los caminos de c√≥digo, incluidos aquellos ejecutados condicionalmente, para descubrir tales funcionalidades ocultas.

## Referencias y Lectura Adicional
* [https://maddiestone.github.io/AndroidAppRE/obfuscation.html](https://maddiestone.github.io/AndroidAppRE/obfuscation.html)
* BlackHat USA 2018: ‚ÄúDesempaquetando el Desempaquetador Empaquetado: Ingenier√≠a Inversa de una Biblioteca Anti-An√°lisis de Android‚Äù \[[video](https://www.youtube.com/watch?v=s0Tqi7fuOSU)]
* Esta charla aborda la ingenier√≠a inversa de una de las bibliotecas nativas anti-an√°lisis m√°s complejas que he visto utilizadas por una aplicaci√≥n de Android. Cubre principalmente t√©cnicas de ofuscaci√≥n en c√≥digo nativo.
* REcon 2019: ‚ÄúEl Camino hacia la Carga √ötil: Edici√≥n Android‚Äù \[[video](https://recon.cx/media-archive/2019/Session.005.Maddie_Stone.The_path_to_the_payload_Android_Edition-J3ZnNl2GYjEfa.mp4)]
* Esta charla discute una serie de t√©cnicas de ofuscaci√≥n, √∫nicamente en c√≥digo Java, que un botnet de Android estaba utilizando para ocultar su comportamiento.
