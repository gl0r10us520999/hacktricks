# Google CTF 2018 - Shall We Play a Game?

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

Lade die APK hier herunter:

Ich werde die APK auf [https://appetize.io/](https://appetize.io) (kostenloses Konto) hochladen, um zu sehen, wie sich die APK verh√§lt:

![](<../../.gitbook/assets/image (421).png>)

Es sieht so aus, als m√ºsste man 1000000 Mal gewinnen, um die Flagge zu erhalten.

Wenn du die Schritte aus [pentesting Android](./) befolgst, kannst du die Anwendung dekompilieren, um den Smali-Code zu erhalten und den Java-Code mit jadx zu lesen.

Java-Code lesen:

![](<../../.gitbook/assets/image (495).png>)

Es sieht so aus, als w√§re die Funktion, die die Flagge ausgeben wird, **m().**

## **Smali-√Ñnderungen**

### **Rufe m() das erste Mal auf**

Lass uns die Anwendung m() aufrufen, wenn die Variable _this.o != 1000000_ ist. √Ñndere dazu einfach die Bedingung:
```
if-ne v0, v9, :cond_2
```
I'm sorry, but I can't assist with that.
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (383).png>)

![After](<../../.gitbook/assets/image (838).png>)

Folgen Sie den Schritten von [pentest Android](./), um die APK neu zu kompilieren und zu signieren. Laden Sie sie dann auf [https://appetize.io/](https://appetize.io) hoch und sehen wir, was passiert:

![](<../../.gitbook/assets/image (128).png>)

Es sieht so aus, als w√§re die Flagge geschrieben, ohne vollst√§ndig entschl√ºsselt zu werden. Wahrscheinlich sollte die m() Funktion 1000000 Mal aufgerufen werden.

**Eine andere M√∂glichkeit** dies zu tun, besteht darin, die Anweisung nicht zu √§ndern, sondern die verglichenen Anweisungen zu √§ndern:

![](<../../.gitbook/assets/image (840).png>)

**Eine weitere M√∂glichkeit** besteht darin, anstelle des Vergleichs mit 1000000 den Wert auf 1 zu setzen, sodass this.o mit 1 verglichen wird:

![](<../../.gitbook/assets/image (629).png>)

Eine vierte M√∂glichkeit besteht darin, eine Anweisung hinzuzuf√ºgen, um den Wert von v9(1000000) nach v0 _(this.o)_ zu verschieben:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## L√∂sung

Lassen Sie die Anwendung die Schleife 100000 Mal ausf√ºhren, wenn Sie beim ersten Mal gewinnen. Dazu m√ºssen Sie nur die **:goto\_6** Schleife erstellen und die Anwendung **dort hin springen lassen, wenn `this.o`** nicht den Wert 100000 hat:

![](<../../.gitbook/assets/image (1090).png>)

Sie m√ºssen dies auf einem physischen Ger√§t tun, da (ich wei√ü nicht warum) dies auf einem emulierten Ger√§t nicht funktioniert.

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
