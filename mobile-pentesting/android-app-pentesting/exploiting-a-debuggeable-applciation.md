# **bIjatlh 'ej debuggeable application**

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>DaH jImej</strong></a><strong>!</strong></summary>

HackTricks jImej:

* **tlhIngan Hol** **HackTricks** **advertised** **company** **want** **or** **HackTricks** **PDF** **download** **SUBSCRIPTION PLANS** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) **Check**.
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) **Get**
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) **Discover**, [**NFTs**](https://opensea.io/collection/the-peass-family) **exclusive** **collection** **our**
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) **or** [**telegram group**](https://t.me/peass) **or** **follow** **us** **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) **and** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos**.

</details>

# **root 'ej debuggeable checks Bypassing**

[**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0) **post** **from** **summary** **is** **section**.

## **Steps to Make an Android App Debuggable and Bypass Checks**

### **Making the App Debuggable**

[**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0) **based** **Content**

1. **APK Decompile:**
- **APK-GUI** **tool** **Decompile** **APK** **for**.
- _android-manifest_ **file** **in**, `android:debuggable=true` **insert** **to enable debugging mode**.
- **Recompile**, **sign**, **zipalign** **modified application**.

2. **Modified Application Install:**
- **command** **Use**: `adb install <application_name>`.

3. **Package Name Retrieve:**
- `adb shell pm list packages ‚Äì3` **execute** **to list third-party applications** **and** **package name** **find**.

4. **App to Await Debugger Connection Set:**
- **command** **Use**: `adb shell am setup-debug-app ‚Äìw <package_name>`.
- **Note:** **This command** **each time** **before starting the application** **to ensure it waits for the debugger** **run** **must**.
- **Persistence** **for**, `adb shell am setup-debug-app ‚Äìw -‚Äìpersistent <package_name>` **Use**.
- **all flags** **remove** **to**, `adb shell am clear-debug-app <package_name>` **Use**.

5. **Debugging in Android Studio Prepare:**
- **Android Studio** **in** **Navigate**, _File -> Open Profile or APK_ **to**.
- **recompiled APK** **Open**.

6. **Breakpoints in Key Java Files Set:**
- **breakpoints** **Place** **in**, `MainActivity.java` (**onCreate** **method** **specifically**), `b.java`, **'ej** `ContextWrapper.java`.

### **Bypassing Checks**

application, **certain points** **at**, **debuggable** **'ej** **binaries** **rooted device** **indicating** **check** **will verify**. **debugger** **app info** **modify**, **debuggable bit** **unset**, **searched binaries** **names** **alter** **can be used** **to bypass** **these checks**.

**debuggable check** **for**:

1. **Flag Settings Modify:**
- **debugger console's variable section** **in**, `this mLoadedAPK -> mApplicationInfo -> flags = 814267974` **navigate**.
- **Note:** **flags = 814267974** **binary representation** **is**, `11000011100111011110` **indicating** **"Flag_debuggable"** **is active**.

![https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png](https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png)

**These steps** **collectively ensure** **that the application can be debugged** **and** **that certain security checks can be bypassed using the debugger**, **facilitating** **a more in-depth analysis or modification of the application's behavior**.

**Step 2** **value** **flag** **to**, `814267972` **changing** **involves**, **binary** **as**, `110000101101000000100010100`.

# **Vulnerability Exploiting**

**Demonstration** **using** **vulnerable application** **provided** **a button** **and** **a textview** **containing**. **Initially**, **application** **displays** **"Crack Me"**. **aim** **is to alter** **from** **"Try Again"** **to** **"Hacked"** **at runtime**, **without modifying the source code**.

## **Vulnerability Checking**
- **apktool** **using** **application** **decompiled** **to access** **the AndroidManifest.xml file**.
- **AndroidManifest.xml** **in** **'android_debuggable="true"** **presence** **the application is debuggable** **and** **susceptible to exploitation** **indicates**.
- **apktool** **solely** **is employed** **debuggable status** **to check** **without altering any code** **any**.

## **Setup Preparing**
- **process** **involved** **an emulator** **initiating**, **vulnerable application** **installing**, **and** **using** **adb jdwp** **to identify** **Dalvik VM ports** **that are listening**.
- **JDWP (Java Debug Wire Protocol)** **allows debugging** **of an application running in a VM** **by exposing a unique port**.
- **Port forwarding** **for remote debugging** **necessary**, **followed by attaching JDB to the target application**.

## **Code at Runtime Injecting**
- **exploitation** **carried out** **by setting breakpoints** **and** **controlling the application flow**.
- **commands** **like** **classes** **and** **methods <class_name>** **were used** **to uncover the application‚Äôs structure**.
- **breakpoint** **at the onClick method** **set**, **and** **execution** **controlled**.
- **locals**, **next**, **and** **set** **commands** **were utilized** **to inspect and modify local variables**, **particularly changing** **the "Try Again" message to "Hacked"**.
- **modified code** **using the run command** **executed**, **successfully altering** **the application‚Äôs output in real-time**.

**This example** **demonstrated** **how the behavior of a debuggable application can be manipulated**, **highlighting** **the potential for more complex exploits like gaining shell access on the device in the application's context**.



## References
* [**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)
* [**https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications**](https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>DaH jImej</strong></a><strong>!</strong></summary>

HackTricks jImej:

* **tlhIngan Hol** **HackTricks** **advertised**
