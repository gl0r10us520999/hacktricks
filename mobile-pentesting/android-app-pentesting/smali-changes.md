# Smali - jIHDaq/\[ghItlh]/jIHDaq

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

ghItlhmeH vaj jImejmoHmeH 'ej vItlhutlhlaHbe'lu'chugh, vaj jImejmoHmeH 'ej vItlhutlhlaHbe'lu'chugh vItlhutlhlaHbe'lu'chugh (vaj jImejmoHmeH 'ej vItlhutlhlaHbe'lu'chugh vItlhutlhlaHbe'lu'chugh vaj jImejmoHmeH 'ej vItlhutlhlaHbe'lu'chugh). vaj, 'op vItlhutlhlaHbe'lu'chugh vItlhutlhlaHbe'lu'chugh 'ej vItlhutlhlaHbe'lu'chugh.

**Opcodes reference:** [http://pallergabor.uw.hu/androidblog/dalvik\_opcodes.html](http://pallergabor.uw.hu/androidblog/dalvik\_opcodes.html)

## Fast Way

**Visual Studio Code** 'ej [APKLab](https://github.com/APKLab/APKLab) extension, vaj **automatically decompile**, modify, **recompile**, sign & install the application without executing any command.

Another **script** that facilitates this task a lot is [**https://github.com/ax/apk.sh**](https://github.com/ax/apk.sh)

## Decompile the APK

APKTool vItlhutlhlaHbe'lu'chugh vItlhutlhlaHbe'lu'chugh **smali code 'ej resources**:
```bash
apktool d APP.apk
```
**apktool** vItlhutlh **error** Daj, **latest version** [**install**] (https://ibotpeaches.github.io/Apktool/install/) **try**.

**tlhIngan Hol** **interesting files** **look** **should**:

* _res/values/strings.xml_ (res/values/\* **xmls** **inside**)
* _AndroidManifest.xml_
* _.sqlite_ **or** _.db_ **extension** **file** **Any**

**apktool** **problems decoding the application** **has**, [https://ibotpeaches.github.io/Apktool/documentation/#framework-files](https://ibotpeaches.github.io/Apktool/documentation/#framework-files) **look** **take** **or** **argument** **`-r`** **using** (Do not decode resources). **Then**, **resource** **in** **problem** **was** **and** **source code** **in** **problem** **won't** **have** (resources **also** **won't** **decompile**).

## Change smali code

**change** **instructions**, **change** **value** **of** **some variables** **or** **add** **new instructions** **You can**. **I** **change** **Smali code** [**VS Code**] (https://code.visualstudio.com) **using**, **smalise extension** **then** **install** **and** **editor** **will tell you** **if** **instruction** **is incorrect**.\
**examples** **Some** **can be found** **here**:

* [Smali changes examples](smali-changes.md)
* [Google CTF 2018 - Shall We Play a Game?](google-ctf-2018-shall-we-play-a-game.md)

**Or** **check below some Smali changes explained** [**here**] (smali-changes.md#modifying-smali).

## Recompile the APK

**After** **code** **the** **modifying** **you can recompile** **the** **code** **using**:
```bash
apktool b . #In the folder generated when you decompiled the application
```
**ghItlh** **APK** **new** **compile** **'e'** _**dist**_ **folder**.

**apktool** **error** **throw**, **latest version** **install** [**here**](https://ibotpeaches.github.io/Apktool/install/)

### **APK** **new** **Sign**

**SoH** **key** **generate** (**password** **ask** **and** **randomly** **fill** **information** **some** **for** **you** **will** **be**):
```bash
keytool -genkey -v -keystore key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias <your-alias>
```
**Qatlh** vItlhutlh **APK** **chu'**.
```bash
jarsigner -keystore key.jks path/to/dist/* <your-alias>
```
### QaD optimize application

**zipalign** vItlhutlh archive alignment tool vaj provides important optimisation to Android application (APK) files. [More information here](https://developer.android.com/studio/command-line/zipalign).
```bash
zipalign [-f] [-v] <alignment> infile.apk outfile.apk
zipalign -v 4 infile.apk
```
### **Qa'vam lo'wI' (Dochvam?)**

Qa'vam [**apksigner**](https://developer.android.com/studio/command-line/) **ghaH** jarsigner **vaj** **apklI'** **qaStaHvIS** **ghaH** **zipaling** **vaj** **qaStaHvIS** **ghaH** **apklI'** **qaStaHvIS** **aspsigner** **vaj** **qaStaHvIS** **ghaH** **apklI'**. **jarsigner** **qaStaHvIS** **ghaH** **zipalign** **vaj** **apklI'** **qaStaHvIS** **ghaH** **apklI'** **qaStaHvIS** **aspsigner** **qaStaHvIS** **ghaH** **apklI'**.
```bash
apksigner sign --ks key.jks ./dist/mycompiled.apk
```
## Smali cha'logh

ghu' jatlh HelloWorld Java code:
```java
public static void printHelloWorld() {
System.out.println("Hello World")
}
```
The Smali code would be:

```
Smali code vItlhutlh:
```

```
.method public static checkRooted()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "/system/bin/su"

    invoke-static {v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkEmulator()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "goldfish"

    invoke-static {v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkDebuggable()Z
    .registers 2

    const/4 v0, 0x0

    invoke-static {}, Landroid/os/Debug;->isDebuggerConnected()Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkEmulatorBuild()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "generic"

    invoke-static {v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkHooking()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "XposedBridge"

    invoke-static {v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppSignature()Z
    .registers 3

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v1

    iget-object v2, v1, Landroid/content/pm/PackageInfo;->signatures:[Landroid/content/pm/Signature;

    array-length v2, v2

    if-lez v2, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppPermissions()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "android.permission.WRITE_EXTERNAL_STORAGE"

    invoke-static {v1}, Landroid/content/Context;->checkSelfPermission(Ljava/lang/String;)I

    move-result v1

    if-nez v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppNetwork()Z
    .registers 2

    const/4 v0, 0x0

    invoke-static {}, Landroid/net/ConnectivityManager;->getActiveNetworkInfo()Landroid/net/NetworkInfo;

    move-result-object v1

    if-eqz v1, :cond_0

    invoke-virtual {v1}, Landroid/net/NetworkInfo;->isConnected()Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppStorage()Z
    .registers 2

    const/4 v0, 0x0

    invoke-static {}, Landroid/os/Environment;->getExternalStorageState()Ljava/lang/String;

    move-result-object v1

    const-string v2, "mounted"

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppSandbox()Z
    .registers 2

    const/4 v0, 0x0

    invoke-static {}, Landroid/os/Environment;->isExternalStorageEmulated()Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppCloud()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppSaas()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppLeak()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppBackup()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppLogs()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppAnalytics()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppCrash()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppPerformance()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppEncryption()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppIntegrity()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppTampering()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppReverse()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppObfuscation()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getApplicationInfo(Ljava/lang/String;I)Landroid/content/pm/ApplicationInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/ApplicationInfo;->sourceDir:Ljava/lang/String;

    const-string v2, "/data/app/"

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppTamperDetection()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "com.example.app"

    invoke-static {v1}, Landroid/content/pm/PackageManager;->getPackageInfo(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/PackageInfo;->signatures:[Landroid/content/pm/Signature;

    array-length v1, v1

    if-lez v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppRootDetection()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "/system/bin/su"

    invoke-static {v1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z

    move-result v1

    if-eqz v1, :cond_0

    const/4 v0, 0x1

    :cond_0
    return v0
.end method
```

```
.method public static checkAppEmulatorDetection()Z
    .registers 2

    const/4 v0, 0x0

    const-string v1, "
```java
.method public static printHelloWorld()V
.registers 2
sget-object v0, Ljava/lang/System;->out:Ljava/io/PrintStream;
const-string v1, "Hello World"
invoke-virtual {v0,v1}, Ljava/io/PrintStream;->println(Ljava/lang/String;)V
return-void
.end method
```
### QI'ya' Qap

### QapHa' DaH jatlh

_Smali_ qapHa' je [chel](https://source.android.com/devices/tech/dalvik/dalvik-bytecode#instructions).

### QapHa' Qap

### QapHa' DaH jatlh

QaStaHvIS DaH jatlh _const_ opcode lo'laHbe'chugh, DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh DaH jatlh, pagh
```bash
#Number
const v9, 0xf4240
const/4 v8, 0x1
#Strings
const-string v5, "wins"
```
### QaStaHvIS

#### Load and Store Instructions

##### Load Constant

The `const` instruction is used to load a constant value onto the stack. The constant value can be an integer, float, long, double, string, or null.

```kotlin
const v0, 0x1
```

##### Load Local Variable

The `move` instruction is used to load the value of a local variable onto the stack.

```kotlin
move v0, v1
```

##### Load Instance Field

The `iget` instruction is used to load the value of an instance field onto the stack.

```kotlin
iget v0, v1, Lcom/example/Class;->field:I
```

##### Load Static Field

The `sget` instruction is used to load the value of a static field onto the stack.

```kotlin
sget v0, Lcom/example/Class;->field:I
```

##### Store Local Variable

The `move` instruction is used to store a value from the stack into a local variable.

```kotlin
move v0, v1
```

##### Store Instance Field

The `iput` instruction is used to store a value from the stack into an instance field.

```kotlin
iput v0, v1, Lcom/example/Class;->field:I
```

##### Store Static Field

The `sput` instruction is used to store a value from the stack into a static field.

```kotlin
sput v0, Lcom/example/Class;->field:I
```

#### Arithmetic Instructions

##### Addition

The `add` instruction is used to perform addition on two values.

```kotlin
add v0, v1, v2
```

##### Subtraction

The `sub` instruction is used to perform subtraction on two values.

```kotlin
sub v0, v1, v2
```

##### Multiplication

The `mul` instruction is used to perform multiplication on two values.

```kotlin
mul v0, v1, v2
```

##### Division

The `div` instruction is used to perform division on two values.

```kotlin
div v0, v1, v2
```

##### Remainder

The `rem` instruction is used to calculate the remainder of division between two values.

```kotlin
rem v0, v1, v2
```

#### Comparison Instructions

##### Equal

The `if-eq` instruction is used to compare two values for equality.

```kotlin
if-eq v0, v1, :label
```

##### Not Equal

The `if-ne` instruction is used to compare two values for inequality.

```kotlin
if-ne v0, v1, :label
```

##### Greater Than

The `if-gt` instruction is used to compare if one value is greater than another.

```kotlin
if-gt v0, v1, :label
```

##### Greater Than or Equal

The `if-ge` instruction is used to compare if one value is greater than or equal to another.

```kotlin
if-ge v0, v1, :label
```

##### Less Than

The `if-lt` instruction is used to compare if one value is less than another.

```kotlin
if-lt v0, v1, :label
```

##### Less Than or Equal

The `if-le` instruction is used to compare if one value is less than or equal to another.

```kotlin
if-le v0, v1, :label
```

#### Control Flow Instructions

##### Jump

The `goto` instruction is used to jump to a specific instruction.

```kotlin
goto :label
```

##### Conditional Jump

The `if-<condition>` instructions are used to perform a conditional jump based on a specific condition.

```kotlin
if-eq v0, v1, :label
if-ne v0, v1, :label
if-gt v0, v1, :label
if-ge v0, v1, :label
if-lt v0, v1, :label
if-le v0, v1, :label
```

##### Return

The `return` instruction is used to return from a method.

```kotlin
return
```

##### Throw Exception

The `throw` instruction is used to throw an exception.

```kotlin
throw v0
```

#### Method Invocation Instructions

##### Invoke Static Method

The `invoke-static` instruction is used to invoke a static method.

```kotlin
invoke-static {v0, v1}, Lcom/example/Class;->method(II)V
```

##### Invoke Instance Method

The `invoke-virtual` instruction is used to invoke an instance method.

```kotlin
invoke-virtual {v0, v1}, Lcom/example/Class;->method(II)V
```

##### Invoke Super Method

The `invoke-super` instruction is used to invoke a super method.

```kotlin
invoke-super {v0, v1}, Lcom/example/Class;->method(II)V
```

##### Invoke Direct Method

The `invoke-direct` instruction is used to invoke a direct method.

```kotlin
invoke-direct {v0, v1}, Lcom/example/Class;->method(II)V
```

##### Invoke Interface Method

The `invoke-interface` instruction is used to invoke an interface method.

```kotlin
invoke-interface {v0, v1}, Lcom/example/Interface;->method(II)V
```

#### Object Creation Instructions

##### New Instance

The `new-instance` instruction is used to create a new instance of a class.

```kotlin
new-instance v0, Lcom/example/Class;
```

##### New Array

The `new-array` instruction is used to create a new array.

```kotlin
new-array v0, v1, [I
```

#### Type Conversion Instructions

##### Cast

The `check-cast` instruction is used to check if an object can be cast to a specific type.

```kotlin
check-cast v0, Lcom/example/Class;
```

##### Instance of

The `instance-of` instruction is used to check if an object is an instance of a specific type.

```kotlin
instance-of v0, v1, Lcom/example/Class;
```

#### Miscellaneous Instructions

##### Nop

The `nop` instruction is used as a placeholder and does nothing.

```kotlin
nop
```

##### Array Length

The `array-length` instruction is used to get the length of an array.

```kotlin
array-length v0, v1
```

##### Monitor Enter

The `monitor-enter` instruction is used to acquire the monitor of an object.

```kotlin
monitor-enter v0
```

##### Monitor Exit

The `monitor-exit` instruction is used to release the monitor of an object.

```kotlin
monitor-exit v0
```

##### Check Null

The `if-null` instruction is used to check if a value is null.

```kotlin
if-null v0, :label
```

##### Check Not Null

The `if-not-null` instruction is used to check if a value is not null.

```kotlin
if-not-null v0, :label
```

##### Check Zero

The `if-eqz` instruction is used to check if a value is zero.

```kotlin
if-eqz v0, :label
```

##### Check Non-Zero

The `if-nez` instruction is used to check if a value is not zero.

```kotlin
if-nez v0, :label
```

##### Move Result

The `move-result` instruction is used to move the result of the previous method invocation onto the stack.

```kotlin
move-result v0
```

##### Move Exception

The `move-exception` instruction is used to move the exception object onto the stack.

```kotlin
move-exception v0
```

##### Throw Null Pointer Exception

The `throw-null-pointer-exception` instruction is used to throw a null pointer exception.

```kotlin
throw-null-pointer-exception
```

##### Throw Class Cast Exception

The `throw-class-cast-exception` instruction is used to throw a class cast exception.

```kotlin
throw-class-cast-exception v0
```

##### Throw Array Index Out Of Bounds Exception

The `throw-array-index-out-of-bounds-exception` instruction is used to throw an array index out of bounds exception.

```kotlin
throw-array-index-out-of-bounds-exception v0
```

##### Throw Arithmetic Exception

The `throw-arithmetic-exception` instruction is used to throw an arithmetic exception.

```kotlin
throw-arithmetic-exception v0
```

##### Throw Illegal Monitor State Exception

The `throw-illegal-monitor-state-exception` instruction is used to throw an illegal monitor state exception.

```kotlin
throw-illegal-monitor-state-exception v0
```

##### Throw Instantiation Error

The `throw-instantiation-error` instruction is used to throw an instantiation error.

```kotlin
throw-instantiation-error v0
```

##### Throw Abstract Method Error

The `throw-abstract-method-error` instruction is used to throw an abstract method error.

```kotlin
throw-abstract-method-error v0
```

##### Throw NoSuchField Error

The `throw-no-such-field-error` instruction is used to throw a no such field error.

```kotlin
throw-no-such-field-error v0
```

##### Throw NoSuchMethod Error

The `throw-no-such-method-error` instruction is used to throw a no such method error.

```kotlin
throw-no-such-method-error v0
```

##### Throw UnsatisfiedLink Error

The `throw-unsatisfied-link-error` instruction is used to throw an unsatisfied link error.

```kotlin
throw-unsatisfied-link-error v0
```

##### Throw VerifyError

The `throw-verify-error` instruction is used to throw a verify error.

```kotlin
throw-verify-error v0
```

##### Throw ExceptionInInitializerError

The `throw-exception-in-initializer-error` instruction is used to throw an exception in initializer error.

```kotlin
throw-exception-in-initializer-error v0
```

##### Throw InternalError

The `throw-internal-error` instruction is used to throw an internal error.

```kotlin
throw-internal-error v0
```

##### Throw OutOfMemoryError

The `throw-out-of-memory-error` instruction is used to throw an out of memory error.

```kotlin
throw-out-of-memory-error v0
```

##### Throw StackOverflowError

The `throw-stack-overflow-error` instruction is used to throw a stack overflow error.

```kotlin
throw-stack-overflow-error v0
```

##### Throw UnknownError

The `throw-unknown-error` instruction is used to throw an unknown error.

```kotlin
throw-unknown-error v0
```

##### Throw RuntimeException

The `throw-runtime-exception` instruction is used to throw a runtime exception.

```kotlin
throw-runtime-exception v0
```

##### Throw Error

The `throw-error` instruction is used to throw an error.

```kotlin
throw-error v0
```

##### Throw Throwable

The `throw-throwable` instruction is used to throw a throwable.

```kotlin
throw-throwable v0
```
```bash
#Math
add-int/lit8 v0, v2, 0x1 #v2 + 0x1 and save it in v0
mul-int v0,v2,0x2 #v2*0x2 and save in v0

#Move the value of one object into another
move v1,v2

#Condtions
if-ge #Greater or equals
if-le #Less or equals
if-eq #Equals

#Get/Save attributes of an object
iget v0, p0, Lcom/google/ctf/shallweplayagame/GameActivity;->o:I #Save this.o inside v0
iput v0, p0, Lcom/google/ctf/shallweplayagame/GameActivity;->o:I #Save v0 inside this.o

#goto
:goto_6 #Declare this where you want to start a loop
if-ne v0, v9, :goto_6 #If not equals, go to: :goto_6
goto :goto_6 #Always go to: :goto_6
```
### QaD lo'wI'vam

### logging

#### Original Text:

In Android apps, logging is a common practice used by developers to track and debug their code. It allows them to print messages to the system log, which can be helpful in identifying and fixing issues.

From a security perspective, logging can be a valuable source of information for attackers. If sensitive data, such as passwords or API keys, is logged without proper protection, it can be easily accessed by an attacker who gains access to the device or the app's logs.

To prevent this, it is important to review the app's logging implementation and make necessary changes to ensure that sensitive information is not leaked. This can include removing or obfuscating sensitive data from the logs, disabling logging in production builds, and implementing proper access controls to restrict who can view the logs.

#### Translation:

Android apps, logging is a common practice used by developers to track and debug their code. It allows them to print messages to the system log, which can be helpful in identifying and fixing issues.

From a security perspective, logging can be a valuable source of information for attackers. If sensitive data, such as passwords or API keys, is logged without proper protection, it can be easily accessed by an attacker who gains access to the device or the app's logs.

To prevent this, it is important to review the app's logging implementation and make necessary changes to ensure that sensitive information is not leaked. This can include removing or obfuscating sensitive data from the logs, disabling logging in production builds, and implementing proper access controls to restrict who can view the logs.
```bash
#Log win: <number>
iget v5, p0, Lcom/google/ctf/shallweplayagame/GameActivity;->o:I #Get this.o inside v5
invoke-static {v5}, Ljava/lang/String;->valueOf(I)Ljava/lang/String; #Transform number to String
move-result-object v1 #Move to v1
const-string v5, "wins" #Save "win" inside v5
invoke-static {v5, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I #Logging "Wins: <num>"
```
### Recommendations:

* If you are going to use declared variables inside the function (declared v0,v1,v2...) put these lines between the _.local \<number>_ and the declarations of the variables (_const v0, 0x1_)
* If you want to put the logging code in the middle of the code of a function:
* Add 2 to the number of declared variables: Ex: from _.locals 10_ to _.locals 12_
* The new variables should be the next numbers of the already declared variables (in this example should be _v10_ and _v11_, remember that it starts in v0).
* Change the code of the logging function and use _v10_ and _v11_ instead of _v5_ and _v1_.

### Toasting

Remember to add 3 to the number of _.locals_ at the beginning of the function.

This code is prepared to be inserted in the **middle of a function** (**change** the number of the **variables** as necessary). It will take the **value of this.o**, **transform** it to **String** and them **make** a **toast** with its value.
```bash
const/4 v10, 0x1
const/4 v11, 0x1
const/4 v12, 0x1
iget v10, p0, Lcom/google/ctf/shallweplayagame/GameActivity;->o:I
invoke-static {v10}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;
move-result-object v11
invoke-static {p0, v11, v12}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
move-result-object v12
invoke-virtual {v12}, Landroid/widget/Toast;->show()V
```
<details>

<summary><strong>qaStaHvIS AWS hacking vItlhlaHbe'chugh</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
