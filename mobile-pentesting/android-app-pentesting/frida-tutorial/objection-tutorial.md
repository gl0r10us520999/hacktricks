# Objection Tutorial

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug bounty tip**: **melden Sie sich an** f√ºr **Intigriti**, eine Premium-**Bug-Bounty-Plattform, die von Hackern f√ºr Hacker erstellt wurde**! Treten Sie uns bei unter [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) heute und beginnen Sie, Pr√§mien von bis zu **$100.000** zu verdienen!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Einf√ºhrung**

**objection - Runtime Mobile Exploration**

[**Objection**](https://github.com/sensepost/objection) ist ein Toolkit zur mobilen Runtime-Exploration, das von [Frida](https://www.frida.re) unterst√ºtzt wird. Es wurde mit dem Ziel entwickelt, mobile Anwendungen und deren Sicherheitslage zu bewerten, ohne dass ein jailbreak- oder gerootetes mobiles Ger√§t erforderlich ist.

**Hinweis:** Dies ist keine Form von Jailbreak / Root-Bypass. Durch die Verwendung von `objection` sind Sie weiterhin durch alle Einschr√§nkungen, die durch die anwendbare Sandbox auferlegt werden, eingeschr√§nkt.

### Zusammenfassung

Das **Ziel** von **objection** ist es, dem Benutzer zu erm√∂glichen, die **Hauptaktionen, die Frida anbietet, aufzurufen**. **Andernfalls** muss der Benutzer ein **einzelnes Skript f√ºr jede Anwendung** erstellen, die er testen m√∂chte.

## Tutorial

F√ºr dieses Tutorial werde ich die APK verwenden, die Sie hier herunterladen k√∂nnen:

{% file src="../../../.gitbook/assets/app-release.zip" %}

Oder aus dem [originalen Repository](https://github.com/asvid/FridaApp) (app-release.apk herunterladen)

### Installation
```bash
pip3 install objection
```
### Verbindung

Stellen Sie eine **regul√§re ADB-Verbindung** her und **starten** Sie den **frida**-Server auf dem Ger√§t (und √ºberpr√ºfen Sie, ob frida sowohl auf dem Client als auch auf dem Server funktioniert).

Wenn Sie ein **gerootetes Ger√§t** verwenden, m√ºssen Sie die Anwendung ausw√§hlen, die Sie im _**--gadget**_-Option testen m√∂chten. In diesem Fall:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Grundlegende Aktionen

Nicht alle m√∂glichen Befehle von Objection werden in diesem Tutorial aufgelistet, nur die, die ich als n√ºtzlicher empfunden habe.

#### Umgebung

Einige interessante Informationen (wie Passw√∂rter oder Pfade) k√∂nnten in der Umgebung gefunden werden.
```bash
env
```
![](<../../../.gitbook/assets/image (220).png>)

#### Frida Informationen
```bash
frida
```
![](<../../../.gitbook/assets/image (1093).png>)

#### Hochladen/Herunterladen
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Frida-Skript importieren
```bash
import <local path frida-script>
```
#### SSLPinning
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Root-Erkennung
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### Exec-Befehl
```bash
android shell_exec whoami
```
#### Screenshots
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### Statische Analyse dynamisch gemacht

In einer echten Anwendung sollten wir alle Informationen, die in diesem Teil entdeckt wurden, kennen, bevor wir objection verwenden, dank **statischer Analyse**. So oder so, auf diese Weise k√∂nnen Sie vielleicht **etwas Neues** sehen, da Sie hier nur eine vollst√§ndige Liste von Klassen, Methoden und exportierten Objekten haben.

Dies ist auch n√ºtzlich, wenn Sie aus irgendeinem Grund **nicht in der Lage sind, lesbaren Quellcode** der App zu erhalten.

#### Aktivit√§ten, Empf√§nger und Dienste auflisten
```bash
android hooking list activities
```
![](<../../../.gitbook/assets/image (1016).png>)
```bash
android hooking list services
android hooking list receivers
```
Frida wird einen Fehler ausl√∂sen, wenn keine gefunden wird

#### Aktuelle Aktivit√§t abrufen
```bash
android hooking get current_activity
```
![](<../../../.gitbook/assets/image (813).png>)

#### Klassen suchen

Lass uns anfangen, nach Klassen in unserer Anwendung zu suchen.
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (507).png>)

#### Suchmethoden einer Klasse

Jetzt extrahieren wir die Methoden innerhalb der Klasse _MainActivity:_
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (929).png>)

#### Liste der deklarierten Methoden einer Klasse mit ihren Parametern

Lass uns herausfinden, welche Parameter die Methoden der Klasse ben√∂tigen:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (299).png>)

#### Klassen auflisten

Sie k√∂nnen auch alle Klassen auflisten, die in der aktuellen Anwendung geladen wurden:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Das ist sehr n√ºtzlich, wenn Sie **die Methode einer Klasse hooken m√∂chten und nur den Namen der Klasse kennen**. Sie k√∂nnten diese Funktion verwenden, um **zu suchen, welches Modul die Klasse besitzt** und dann ihre Methode zu hooken.

### Hooking ist einfach

#### Hooking (√úberwachen) einer Methode

Aus dem [Quellcode](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) der Anwendung wissen wir, dass die **Funktion** _**sum()**_ **von** _**MainActivity**_ **jede Sekunde** ausgef√ºhrt wird. Lassen Sie uns versuchen, **alle m√∂glichen Informationen** jedes Mal zu dumpen, wenn die Funktion aufgerufen wird (Argumente, R√ºckgabewert und R√ºckverfolgung):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (1086).png>)

#### Hooking (√úberwachen) einer gesamten Klasse

Tats√§chlich finde ich alle Methoden der Klasse MainActivity wirklich interessant, lass uns **alle hooken**. Sei vorsichtig, das k√∂nnte eine Anwendung **zum Absturz bringen**.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
Wenn Sie mit der Anwendung spielen, w√§hrend die Klasse gehookt ist, werden Sie sehen, wann **jede Funktion aufgerufen wird**, ihre **Argumente** und den **R√ºckgabewert**.

![](<../../../.gitbook/assets/image (861).png>)

#### √Ñndern des booleschen R√ºckgabewerts einer Funktion

Aus dem Quellcode k√∂nnen Sie sehen, dass die Funktion _checkPin_ einen _String_ als Argument erh√§lt und einen _boolean_ zur√ºckgibt. Lassen Sie uns die Funktion **immer true zur√ºckgeben**:

![](<../../../.gitbook/assets/image (883).png>)

Jetzt, wenn Sie irgendetwas im Textfeld f√ºr den PIN-Code eingeben, werden Sie sehen, dass alles g√ºltig ist:

![](<../../../.gitbook/assets/image (228).png>)

### Klasseninstanzen

Suchen und drucken Sie **lebende Instanzen einer bestimmten Java-Klasse**, die durch einen vollqualifizierten Klassennamen angegeben ist. Das Ergebnis ist der Versuch, einen String-Wert f√ºr eine entdeckte Objection zu erhalten, die typischerweise **Eigenschaftswerte f√ºr das Objekt enthalten w√ºrde**.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (1095).png>)

### Keystore/Intents

Sie k√∂nnen mit dem Keystore und Intents spielen, indem Sie:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
### Speicher

#### Dump
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Liste
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (286).png>)

Am Ende der Liste kannst du frida sehen:

![](<../../../.gitbook/assets/image (1097).png>)

Lass uns √ºberpr√ºfen, was frida exportiert:

![](<../../../.gitbook/assets/image (298).png>)

#### Suchen/Schreiben

Du kannst auch im Speicher mit objection suchen und schreiben:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

Sie k√∂nnen den Befehl `sqlite` verwenden, um mit SQLite-Datenbanken zu interagieren.

### Exit
```bash
exit
```
## Was mir in Objection fehlt

* Die Hooking-Methoden st√ºrzen manchmal die Anwendung ab (das liegt auch an Frida).
* Du kannst die Instanzen der Klassen nicht verwenden, um Funktionen der Instanz aufzurufen. Und du kannst keine neuen Instanzen von Klassen erstellen und sie verwenden, um Funktionen aufzurufen.
* Es gibt keinen Shortcut (wie den f√ºr sslpinnin), um alle g√§ngigen Krypto-Methoden, die von der Anwendung verwendet werden, zu hooken, um verschl√ºsselten Text, Klartext, Schl√ºssel, IVs und verwendete Algorithmen zu sehen.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug-Bounty-Tipp**: **Melde dich an** bei **Intigriti**, einer Premium-**Bug-Bounty-Plattform, die von Hackern f√ºr Hacker erstellt wurde**! Schlie√üe dich uns an unter [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) heute und beginne, Pr√§mien von bis zu **100.000 $** zu verdienen!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
