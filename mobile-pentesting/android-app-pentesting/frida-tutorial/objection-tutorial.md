# Objection Tutorial

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug bounty tip**: **jiandikishe** kwa **Intigriti**, jukwaa la **bug bounty la kiwango cha juu lililotengenezwa na hackers, kwa hackers**! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na uanze kupata zawadi hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Utangulizi**

**objection - Utafiti wa Simu wa Wakati Halisi**

[**Objection**](https://github.com/sensepost/objection) ni zana ya utafiti wa simu wa wakati halisi, inayotumiwa na [Frida](https://www.frida.re). Ilijengwa kwa lengo la kusaidia kutathmini programu za simu na hali yao ya usalama bila haja ya kifaa cha simu kilichovunjwa au kilichoshikiliwa.

**Kumbuka:** Hii si aina yoyote ya kukwepa jailbreak / root. Kwa kutumia `objection`, bado unakabiliwa na vizuizi vyote vilivyowekwa na sandbox inayofaa unayokutana nayo.

### Muhtasari

**Lengo** la **objection** ni kumruhusu mtumiaji kuita **vitendo vikuu vinavyotolewa na Frida**. **Vinginevyo**, mtumiaji atahitaji kuunda **script moja kwa kila programu** anayotaka kupima.

## Tutorial

Kwa ajili ya tutorial hii nitatumia APK ambayo unaweza kupakua hapa:

{% file src="../../../.gitbook/assets/app-release.zip" %}

Au kutoka kwenye [hifadhi yake ya asili](https://github.com/asvid/FridaApp)(pakua app-release.apk)

### Usanidi
```bash
pip3 install objection
```
### Connection

Fanya **muunganisho wa kawaida wa ADB** na **anzisha** seva ya **frida** kwenye kifaa (na hakikisha kwamba frida inafanya kazi kwenye mteja na seva).

Ikiwa unatumia **kifaa kilichopandishwa** ni muhimu kuchagua programu unayotaka kupima ndani ya chaguo la _**--gadget**_. katika kesi hii:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Basic Actions

Sio amri zote zinazowezekana za objections zitakazoorodheshwa katika tutorial hii, ni zile tu ambazo nimezipata kuwa za manufaa zaidi.

#### Environment

Taarifa za kuvutia (kama nywila au njia) zinaweza kupatikana ndani ya mazingira.
```bash
env
```
![](<../../../.gitbook/assets/image (220).png>)

#### Taarifa za Frida
```bash
frida
```
![](<../../../.gitbook/assets/image (1093).png>)

#### Pakia/Download
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Ingiza skripti ya frida
```bash
import <local path frida-script>
```
#### SSLPinning
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Ugunduzi wa mizizi
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### Amri ya Exec
```bash
android shell_exec whoami
```
#### Picha za skrini
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### Uchambuzi wa Kihistoria uliofanywa kuwa wa Kiharakati

Katika programu halisi tunapaswa kujua taarifa zote zilizogunduliwa katika sehemu hii kabla ya kutumia objection kutokana na **uchambuzi wa kihistoria**. Hata hivyo, njia hii huenda ukawaona **mambo mapya** kwani hapa utakuwa na orodha kamili ya madarasa, mbinu na vitu vilivyotolewa.

Hii pia ni muhimu ikiwa kwa namna fulani huwezi **kupata msimbo wa chanzo unaoweza kusomeka** wa programu hiyo.

#### Orodha ya shughuli, wapokeaji na huduma
```bash
android hooking list activities
```
![](<../../../.gitbook/assets/image (1016).png>)
```bash
android hooking list services
android hooking list receivers
```
Frida itatoa kosa ikiwa hakuna inapatikana

#### Kupata shughuli ya sasa
```bash
android hooking get current_activity
```
![](<../../../.gitbook/assets/image (813).png>)

#### Tafuta Madarasa

Tuanze kutafuta madarasa ndani ya programu yetu
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (507).png>)

#### Njia za Kutafuta za darasa

Sasa hebu tutoe njia ndani ya darasa _MainActivity:_
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (929).png>)

#### Orodha ya Mbinu zilizotangazwa za darasa na vigezo vyake

Hebu tuone ni vigezo gani mbinu za darasa zinahitaji:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (299).png>)

#### Orodha ya madarasa

Unaweza pia kuorodhesha madarasa yote ambayo yamepakuliwa ndani ya programu ya sasa:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Hii ni muhimu sana ikiwa unataka **kuunganisha njia ya darasa na unajua tu jina la darasa**. Unaweza kutumia kazi hii **kutafuta ni moduli ipi inayomiliki darasa** na kisha kuunganisha njia yake.

### Kuunganisha kuwa rahisi

#### Kuunganisha (kuangalia) njia

Kutoka kwenye [kanuni ya chanzo](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) ya programu tunajua kwamba **kazi** _**sum()**_ **kutoka** _**MainActivity**_ inatekelezwa **kila sekunde**. Hebu jaribu **kudondosha taarifa zote zinazowezekana** kila wakati kazi inaitwa (hoja, thamani ya kurudi na backtrace):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (1086).png>)

#### Hooking (kuangalia) darasa zima

Kwa kweli, ninapata mbinu zote za darasa la MainActivity kuwa za kuvutia sana, hebu **ziunganishe zote**. Kuwa makini, hii inaweza **kusababisha** programu kuanguka.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
If you play with the application while the class is hooked you will see when **kila kazi inaitwa**, its **hoja** and the **thamani** return.

![](<../../../.gitbook/assets/image (861).png>)

#### Kubadilisha thamani ya boolean ya kazi

From the source code you can see that the function _checkPin_ gets a _String_ as argument and returns a _boolean_. Lets make the function **kila wakati irejeze kweli**:

![](<../../../.gitbook/assets/image (883).png>)

Now, If you write anything in the text box for the PIN code you will see tat anything is valid:

![](<../../../.gitbook/assets/image (228).png>)

### Class instances

Search for and print **mifano hai ya darasa maalum la Java**, specified by a fully qualified class name. Out is the result of an attempt at getting a string value for a discovered objection which would typically **kuwa na thamani za mali za kitu**.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (1095).png>)

### Keystore/Intents

Unaweza kucheza na keystore na intents ukitumia:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
### Kumbukumbu

#### Dump
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Orodha
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (286).png>)

Katika mwisho wa orodha unaweza kuona frida:

![](<../../../.gitbook/assets/image (1097).png>)

Hebu tuangalia ni nini frida inasafirisha:

![](<../../../.gitbook/assets/image (298).png>)

#### Search/Write

Unaweza pia kutafuta na kuandika ndani ya kumbukumbu kwa kutumia objection:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

Unaweza kutumia amri `sqlite` kuingiliana na hifadhidata za sqlite.

### Exit
```bash
exit
```
## Nini ninakosa katika Objection

* Mbinu za hooking wakati mwingine zinaweza kusababisha programu kuanguka (hii pia ni kwa sababu ya Frida).
* Huwezi kutumia mifano ya madarasa kuita kazi za mfano. Na huwezi kuunda mifano mipya ya madarasa na kuvitumia kuita kazi.
* Hakuna njia fupi (kama ile ya sslpinnin) ya kuhooki mbinu zote za kawaida za crypto zinazotumiwa na programu ili kuona maandiko yaliyofichwa, maandiko ya kawaida, funguo, IVs na algorithimu zinazotumiwa.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Nasaha ya bug bounty**: **jiandikishe** kwa **Intigriti**, jukwaa la **bug bounty la premium lililoundwa na hackers, kwa hackers**! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na uanze kupata zawadi hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

{% hint style="success" %}
Jifunze & fanya mazoezi ya AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze & fanya mazoezi ya GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za hacking kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
