# Bypass Biometric Authentication (Android)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Deepen your expertise in **Mobile Security** with 8kSec Academy. Master iOS and Android security through our self-paced courses and get certified:

{% embed url="https://academy.8ksec.io/" %}

## **M√©thode 1 ‚Äì Contournement sans utilisation d'objet Crypto**

L'accent est mis ici sur le *onAuthenticationSucceeded* callback, qui est crucial dans le processus d'authentification. Des chercheurs de WithSecure ont d√©velopp√© un [script Frida](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js), permettant de contourner le NULL *CryptoObject* dans *onAuthenticationSucceeded(...)*. Le script force un contournement automatique de l'authentification par empreinte digitale lors de l'invocation de la m√©thode. Ci-dessous se trouve un extrait simplifi√© d√©montrant le contournement dans un contexte d'empreinte digitale Android, avec l'application compl√®te disponible sur [GitHub](https://github.com/St3v3nsS/InsecureBanking).
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
Commande pour ex√©cuter le script Frida :
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
## **M√©thode 2 ‚Äì Approche de gestion des exceptions**

Un autre [script Frida](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) de WithSecure traite du contournement de l'utilisation d'objets crypto non s√©curis√©s. Le script invoque *onAuthenticationSucceeded* avec un *CryptoObject* qui n'a pas √©t√© autoris√© par une empreinte digitale. Si l'application essaie d'utiliser un objet de chiffrement diff√©rent, cela d√©clenchera une exception. Le script se pr√©pare √† invoquer *onAuthenticationSucceeded* et √† g√©rer le *javax.crypto.IllegalBlockSizeException* dans la classe _Cipher_, garantissant que les objets suivants utilis√©s par l'application sont chiffr√©s avec la nouvelle cl√©.

Commande pour ex√©cuter le script Frida :
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
Lors de l'acc√®s √† l'√©cran d'empreinte digitale et de l'initiation de `authenticate()`, tapez `bypass()` dans la console Frida pour activer le contournement :
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
## **M√©thode 3 ‚Äì Cadres d'instrumentation**

Les cadres d'instrumentation comme Xposed ou Frida peuvent √™tre utilis√©s pour s'accrocher aux m√©thodes d'application √† l'ex√©cution. Pour l'authentification par empreinte digitale, ces cadres peuvent :

1. **Simuler les rappels d'authentification** : En s'accrochant aux m√©thodes `onAuthenticationSucceeded`, `onAuthenticationFailed` ou `onAuthenticationError` de `BiometricPrompt.AuthenticationCallback`, vous pouvez contr√¥ler le r√©sultat du processus d'authentification par empreinte digitale.
2. **Contourner le SSL Pinning** : Cela permet √† un attaquant d'intercepter et de modifier le trafic entre le client et le serveur, potentiellement en alt√©rant le processus d'authentification ou en volant des donn√©es sensibles.

Exemple de commande pour Frida :
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
## **M√©thode 4 ‚Äì Ing√©nierie Inverse & Modification de Code**

Les outils d'ing√©nierie inverse comme `APKTool`, `dex2jar` et `JD-GUI` peuvent √™tre utilis√©s pour d√©compiler une application Android, lire son code source et comprendre son m√©canisme d'authentification. Les √©tapes incluent g√©n√©ralement :

1. **D√©compiler l'APK** : Convertir le fichier APK en un format plus lisible par l'homme (comme le code Java).
2. **Analyser le Code** : Rechercher l'impl√©mentation de l'authentification par empreinte digitale et identifier les faiblesses potentielles (comme les m√©canismes de secours ou les v√©rifications de validation incorrectes).
3. **Recompiler l'APK** : Apr√®s avoir modifi√© le code pour contourner l'authentification par empreinte digitale, l'application est recompil√©e, sign√©e et install√©e sur l'appareil pour des tests.

## **M√©thode 5 ‚Äì Utilisation d'Outils d'Authentification Personnalis√©s**

Il existe des outils et des scripts sp√©cialis√©s con√ßus pour tester et contourner les m√©canismes d'authentification. Par exemple :

1. **Modules MAGISK** : MAGISK est un outil pour Android qui permet aux utilisateurs de rooter leurs appareils et d'ajouter des modules qui peuvent modifier ou usurper des informations au niveau mat√©riel, y compris les empreintes digitales.
2. **Scripts Personnalis√©s** : Des scripts peuvent √™tre √©crits pour interagir avec le pont de d√©bogage Android (ADB) ou directement avec le backend de l'application pour simuler ou contourner l'authentification par empreinte digitale.

## R√©f√©rences
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Approfondissez votre expertise en **S√©curit√© Mobile** avec 8kSec Academy. Ma√Ætrisez la s√©curit√© iOS et Android gr√¢ce √† nos cours auto-dirig√©s et obtenez une certification :

{% embed url="https://academy.8ksec.io/" %}

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
