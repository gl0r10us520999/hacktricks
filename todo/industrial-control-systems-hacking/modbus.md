# Το Πρωτόκολλο Modbus

## Εισαγωγή στο Πρωτόκολλο Modbus

Το πρωτόκολλο Modbus είναι ένα ευρέως χρησιμοποιούμενο πρωτόκολλο στα Βιομηχανικά Συστήματα Αυτοματισμού και Ελέγχου. Το Modbus επιτρέπει την επικοινωνία μεταξύ διάφορων συσκευών όπως ελεγκτές προγραμματιζόμενης λογικής (PLCs), αισθητήρες, ενεργοποιητές και άλλες βιομηχανικές συσκευές. Η κατανόηση του Πρωτοκόλλου Modbus είναι ουσιώδης καθώς αυτό είναι το πιο χρησιμοποιούμενο πρωτόκολλο επικοινωνίας στα ΒΣΑ και έχει πολλές δυνητικές επιφάνειες επίθεσης για sniffing και ακόμα και ενσωμάτωση εντολών στους PLCs.

Εδώ, οι έννοιες αναφέρονται με καταλήξεις παρέχοντας πλαίσιο για το πρωτόκολλο και τη φύση λειτουργίας του. Η μεγαλύτερη πρόκληση στην ασφάλεια του συστήματος ΒΣΑ είναι το κόστος υλοποίησης και αναβάθμισης. Αυτά τα πρωτόκολλα και πρότυπα σχεδιάστηκαν στις αρχές των δεκαετιών του '80 και του '90 και εξακολουθούν να χρησιμοποιούνται ευρέως. Καθώς μια βιομηχανία έχει πολλές συσκευές και συνδέσεις, η αναβάθμιση των συσκευών είναι πολύ δύσκολη, παρέχοντας στους χάκερ ένα πλεονέκτημα στην αντιμετώπιση παλαιών πρωτοκόλλων. Οι επιθέσεις στο Modbus είναι σχεδόν αναπόφευκτες καθώς αναμένεται να χρησιμοποιείται χωρίς αναβάθμιση και η λειτουργία του είναι κρίσιμη για τη βιομηχανία.

## Η Αρχιτεκτονική Πελάτη-Διακομιστή

Το Πρωτόκολλο Modbus χρησιμοποιείται τυπικά στην Αρχιτεκτονική Πελάτη-Διακομιστή όπου μια κύρια συσκευή (πελάτης) ξεκινά την επικοινωνία με μία ή περισσότερες σκλάβες συσκευές (διακομιστές). Αυτό αναφέρεται επίσης ως αρχιτεκτονική Κύριος-Δούλος, η οποία χρησιμοποιείται ευρέως στην ηλεκτρονική και το Διαδίκτυο των πραγμάτων με SPI, I2C, κλπ.

## Έκδοσεις Σειριακής και Ethernet Επικοινωνίας

Το Πρωτόκολλο Modbus σχεδιάστηκε τόσο για Σειριακή Επικοινωνία όσο και για Επικοινωνίες Ethernet. Η Σειριακή Επικοινωνία χρησιμοποιείται ευρέως σε παλαιά συστήματα, ενώ οι μοντέρνες συσκευές υποστηρίζουν την Ethernet που προσφέρει υψηλές ταχύτητες μετάδοσης δεδομένων και είναι πιο κατάλληλη για μοντέρνα βιομηχανικά δίκτυα.

## Αναπαράσταση Δεδομένων

Τα δεδομένα μεταδίδονται στο πρωτόκολλο Modbus ως ASCII ή Δυαδικά, αν και η δυαδική μορφή χρησιμοποιείται λόγω της συμβατότητάς της με παλαιότερες συσκευές.

## Κωδικοί Λειτουργιών

Το Πρωτόκολλο Modbus λειτουργεί με τη μετάδοση συγκεκριμένων κωδικών λειτουργιών που χρησιμοποιούνται για τη λειτουργία των PLCs και διάφορων ελεγκτικών συσκευών. Αυτό το τμήμα είναι σημαντικό για την κατανόηση καθώς οι επαναλαμβανόμενες επιθέσεις μπορούν να γίνουν με την επαναμετάδοση κωδικών λειτουργιών. Οι παλαιές συσκευές δεν υποστηρίζουν κρυπτογράφηση προς τη μετάδοση δεδομένων και συνήθως έχουν μακριές καλωδιώσεις που τις συνδέουν, με αποτέλεσμα την παρεμβολή σε αυτές τις καλωδιώσεις και την καταγραφή/ενσωμάτωση δεδομένων.

## Διευθυνσιοδότηση του Modbus

Κάθε συσκευή στο δίκτυο έχει μια μοναδική διεύθυνση που είναι ουσιώδης για την επικοινωνία μεταξύ των συσκευών. Πρωτόκολλα όπως το Modbus RTU, το Modbus TCP, κλπ. χρησιμοποιούνται για την υλοποίηση της διευθυνσιοδότησης και λειτουργούν ως στρώμα μεταφοράς για τη μετάδοση δεδομένων. Τα δεδομένα που μεταφέρονται είναι σε μορφή πρωτοκόλλου Modbus που περιέχει το μήνυμα.

Επιπλέον, το Modbus εφαρμόζει ελέγχους σφαλμάτων για να διασφαλίσει την ακεραιότητα των μεταδιδόμενων δεδομένων. Αλλά το σημαντικότερο, το Modbus είναι ένα Ανοιχτό Πρότυπο και οποιοσδήποτε μπορεί να το υλοποιήσει στις συσκευές του. Αυτό έκανε αυτό το πρωτόκολλο να γίνει παγκόσμιο πρότυπο και να είναι ευρέως διαδεδομένο στη βιομηχανία του αυτοματισμού.

Λόγω της εκτεταμένης χρήσης του και της έλλειψης αναβαθμίσεων, η επίθεση στο Modbus παρέχει σημαντικό πλεονέκτημα με την επιφάνεια επίθεσης του. Τα ΒΣΑ εξαρτώνται σε μεγάλο βαθμό από την επικοινωνία μεταξύ των συσκευών και οποιεσδήποτε επιθέσεις που γίνονται σε αυτές μπορεί να είναι επικίνδυνες για τη λειτουργία των βιομηχανικών συστημάτων. Επιθέσεις όπως επανάληψη, ενσωμάτωση δεδομένων, sniffing και διαρροή δεδομένων, Αρνηση Υπηρεσίας, πλαστογράφηση δεδομένων, κλπ. μπορούν να πραγματοποιηθούν εάν ο μηχανισμός μετάδοσης αναγνωριστεί από τον επιτιθέμενο.
