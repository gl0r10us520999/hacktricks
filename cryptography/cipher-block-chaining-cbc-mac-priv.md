{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}


# CBC

–Ø–∫—â–æ **cookie** - —Ü–µ **—Ç—ñ–ª—å–∫–∏** **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** (–∞–±–æ –ø–µ—Ä—à–∞ —á–∞—Å—Ç–∏–Ω–∞ cookie - —Ü–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞) —ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞—á—É —Å–µ–±–µ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**". –¢–æ–¥—ñ –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **"bdmin"** —ñ **–ø—Ä–æ–≤–µ—Å—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å –ø–µ—Ä—à–æ–≥–æ –±–∞–π—Ç–∞** cookie.

# CBC-MAC

**–ö–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –ª–∞–Ω—Ü—é–∂–∫–æ–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—ñ–≤** (**CBC-MAC**) - —Ü–µ –º–µ—Ç–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó. –í—ñ–Ω –ø—Ä–∞—Ü—é—î —à–ª—è—Ö–æ–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–ª–æ–∫ –∑–∞ –±–ª–æ–∫–æ–º, –¥–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É –ø–æ–≤'—è–∑–∞–Ω–µ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º. –¶–µ–π –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä—é—î **–ª–∞–Ω—Ü—é–∂–æ–∫ –±–ª–æ–∫—ñ–≤**, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏, —â–æ –∑–º—ñ–Ω–∞ –Ω–∞–≤—ñ—Ç—å –æ–¥–Ω–æ–≥–æ –±—ñ—Ç–∞ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—ó –∑–º—ñ–Ω–∏ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–ª–æ–∫—É –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –î–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –∞–±–æ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Ç–∞–∫–æ—ó –∑–º—ñ–Ω–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ–∫—É.

–î–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è CBC-MAC –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è m, –π–æ–≥–æ —à–∏—Ñ—Ä—É—é—Ç—å –≤ —Ä–µ–∂–∏–º—ñ CBC –∑ –Ω—É–ª—å–æ–≤–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –æ—Å—Ç–∞–Ω–Ω—ñ–π –±–ª–æ–∫. –ù–∞—Å—Ç—É–ø–Ω–∞ —Ñ—ñ–≥—É—Ä–∞ –Ω–∞–≤–æ–¥–∏—Ç—å –æ–±—á–∏—Å–ª–µ–Ω–Ω—è CBC-MAC –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –±–ª–æ–∫—ñ–≤![https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5](https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ k —Ç–∞ –±–ª–æ—á–Ω–æ–≥–æ —à–∏—Ñ—Ä—É E:

![https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png)

# –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å

–ó CBC-MAC –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **IV —Ä—ñ–≤–Ω–∏–π 0**.\
–¶–µ –ø—Ä–æ–±–ª–µ–º–∞, –æ—Å–∫—ñ–ª—å–∫–∏ 2 –≤—ñ–¥–æ–º—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (`m1` —Ç–∞ `m2`) –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏–º—É—Ç—å 2 –ø—ñ–¥–ø–∏—Å–∏ (`s1` —Ç–∞ `s2`). –¢–∞–∫–∏–º —á–∏–Ω–æ–º:

* `E(m1 XOR 0) = s1`
* `E(m2 XOR 0) = s2`

–¢–æ–¥—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ m1 —Ç–∞ m2, –æ–±'—î–¥–Ω–∞–Ω—ñ (m3), –∑–≥–µ–Ω–µ—Ä—É—é—Ç—å 2 –ø—ñ–¥–ø–∏—Å–∏ (s31 —Ç–∞ s32):

* `E(m1 XOR 0) = s31 = s1`
* `E(m2 XOR s1) = s32`

**–¶–µ –º–æ–∂–ª–∏–≤–æ –æ–±—á–∏—Å–ª–∏—Ç–∏, –Ω–µ –∑–Ω–∞—é—á–∏ –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.**

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ —à–∏—Ñ—Ä—É—î—Ç–µ —ñ–º'—è **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä** —É –±–ª–æ–∫–∞—Ö **8 –±–∞–π—Ç—ñ–≤**:

* `Administ`
* `rator\00\00\00`

–í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **Administ** (m1) —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å (s1).\
–ü–æ—Ç—ñ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–µ –¥–æ—Ä—ñ–≤–Ω—é—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É `rator\00\00\00 XOR s1`. –¶–µ –∑–≥–µ–Ω–µ—Ä—É—î `E(m2 XOR s1 XOR 0)`, —è–∫–µ —î s32.\
—Ç–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ s32 —è–∫ –ø—ñ–¥–ø–∏—Å –ø–æ–≤–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**.

### –†–µ–∑—é–º–µ

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –ø—ñ–¥–ø–∏—Å —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **Administ** (m1), —è–∫–∏–π –¥–æ—Ä—ñ–≤–Ω—é—î s1
2. –û—Ç—Ä–∏–º–∞–π—Ç–µ –ø—ñ–¥–ø–∏—Å —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **rator\x00\x00\x00 XOR s1 XOR 0**, —è–∫–∏–π –¥–æ—Ä—ñ–≤–Ω—é—î s32**.**
3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å cookie –Ω–∞ s32 —ñ –≤—ñ–Ω –±—É–¥–µ –¥—ñ–π—Å–Ω–∏–º cookie –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**.

# –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∞—Ç–∞–∫–æ—é IV

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π IV, –∞—Ç–∞–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –ø—Ä–æ—Å—Ç–æ—é.\
–Ø–∫—â–æ cookie - —Ü–µ –ø—Ä–æ—Å—Ç–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –¥–ª—è –≤–∏–¥–∞—á—ñ —Å–µ–±–µ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**" –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**" —ñ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –π–æ–≥–æ cookie.\
–¢–µ–ø–µ—Ä, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ IV, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –ø–µ—Ä—à–∏–π –±–∞–π—Ç IV —Ç–∞–∫, —â–æ **IV\[0] XOR "A" == IV'\[0] XOR "a"** —ñ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ cookie –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**. –¶–µ–π cookie –±—É–¥–µ –¥—ñ–π—Å–Ω–∏–º –¥–ª—è **–≤–∏–¥–∞—á—ñ —Å–µ–±–µ** –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä** –∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏–º **IV**.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://en.wikipedia.org/wiki/CBC-MAC](https://en.wikipedia.org/wiki/CBC-MAC)


{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
