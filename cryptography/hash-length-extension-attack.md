# Резиме напада

Замислите сервер који **потписује** неке **податке** тако што **додаје** **тајну** неким познатим чистим текстуалним подацима и затим хешира те податке. Ако знате:

* **Дужину тајне** (ово се може и брутфорсати из датог опсега дужине)
* **Чисте текстуалне податке**
* **Алгоритам (и он је подложан овом нападу)**
* **Паддинг је познат**
* Обично се користи подразумевани, тако да ако су испуњена остала 3 захтева, и ово је
* Паддинг варира у зависности од дужине тајне + података, зато је потребна дужина тајне

Тада, могуће је да **нападач** **дода** **податке** и **генерише** валидну **потпис** за **претходне податке + додате податке**.

## Како?

У основи, подложни алгоритми генеришу хешеве прво **хеширајући блок података**, а затим, **из** **претходно** створеног **хеша** (статус), **додају следећи блок података** и **хеширају га**.

Затим, замислите да је тајна "тајна" и податак је "податак", MD5 "тајнаподатак" је 6036708eba0d11f6ef52ad44e8b74d5b.\
Ако нападач жели да дода низ "додавање" он може:

* Генерисати MD5 од 64 "А"
* Променити статус претходно иницијализованог хеша на 6036708eba0d11f6ef52ad44e8b74d5b
* Додати низ "додавање"
* Завршити хеш и резултујући хеш ће бити **валидан за "тајна" + "податак" + "паддинг" + "додавање"**

## **Алат**

{% embed url="https://github.com/iagox86/hash_extender" %}

## Референце

Овај напад је добро објашњен на [https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks](https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks)
