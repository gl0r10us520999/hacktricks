# AW2Exec - GOT/PLT

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

### **GOT: –ì–ª–æ–±–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑—Å—É–≤—ñ–≤**

**–ì–ª–æ–±–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑—Å—É–≤—ñ–≤ (GOT)** - —Ü–µ –º–µ—Ö–∞–Ω—ñ–∑–º, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–≤'—è–∑–∞–Ω–∏—Ö –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è **–∞–¥—Ä–µ—Å–∞–º–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π**. –û—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ **–∞–¥—Ä–µ—Å–∏ –Ω–µ –≤—ñ–¥–æ–º—ñ –¥–æ —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** (—á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–µ –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è), GOT –∑–∞–±–µ–∑–ø–µ—á—É—î —Å–ø–æ—Å—ñ–± **–¥–∏–Ω–∞–º—ñ—á–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å–∏ —Ü–∏—Ö –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å–∏–º–≤–æ–ª—ñ–≤** –ø—ñ—Å–ª—è —ó—Ö —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è.

–ö–æ–∂–µ–Ω –∑–∞–ø–∏—Å —É GOT –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å–∏–º–≤–æ–ª—É —É –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞—Ö, —è–∫—ñ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª. –ö–æ–ª–∏ **—Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤–ø–µ—Ä—à–µ, —ó—ó —Ñ–∞–∫—Ç–∏—á–Ω–∞ –∞–¥—Ä–µ—Å–∞ —Ä–æ–∑–≤'—è–∑—É—î—Ç—å—Å—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º –∑–≤'—è–∑—É–≤–∞—á–µ–º —ñ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ GOT**. –ù–∞—Å—Ç—É–ø–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ —Ç—ñ—î—ó –∂ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∞–¥—Ä–µ—Å—É, –∑–±–µ—Ä–µ–∂–µ–Ω—É –≤ GOT, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —É–Ω–∏–∫–∞—é—á–∏ –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏.

### **PLT: –¢–∞–±–ª–∏—Ü—è –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ–¥—É—Ä**

**–¢–∞–±–ª–∏—Ü—è –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ–¥—É—Ä (PLT)** —Ç—ñ—Å–Ω–æ —Å–ø—ñ–≤–ø—Ä–∞—Ü—é—î –∑ GOT —ñ —Å–ª—É–∂–∏—Ç—å —è–∫ —Ç—Ä–∞–º–ø–ª—ñ–Ω –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–∏–∫–ª–∏–∫—ñ–≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π. –ö–æ–ª–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª **–≤–∏–∫–ª–∏–∫–∞—î –∑–æ–≤–Ω—ñ—à–Ω—é —Ñ—É–Ω–∫—Ü—ñ—é –≤–ø–µ—Ä—à–µ, —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –¥–æ –∑–∞–ø–∏—Å—É –≤ PLT, –ø–æ–≤'—è–∑–∞–Ω–æ–≥–æ –∑ —Ü—ñ—î—é —Ñ—É–Ω–∫—Ü—ñ—î—é**. –¶–µ–π –∑–∞–ø–∏—Å PLT –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –≤–∏–∫–ª–∏–∫ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–≤'—è–∑—É–≤–∞—á–∞ –¥–ª—è —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—â–æ –≤–æ–Ω–∞ —â–µ –Ω–µ –±—É–ª–∞ —Ä–æ–∑–≤'—è–∑–∞–Ω–∞. –ü—ñ—Å–ª—è —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ –≤–æ–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ GOT.

**–û—Ç–∂–µ,** –∑–∞–ø–∏—Å–∏ GOT –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—ñ—Å–ª—è —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –∞–±–æ –∑–º—ñ–Ω–Ω–æ—ó. **–ó–∞–ø–∏—Å–∏ PLT –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è** —Ü–∏—Ö –∞–¥—Ä–µ—Å —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∑–≤'—è–∑—É–≤–∞—á.

## –û—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

### –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ GOT

–û—Ç—Ä–∏–º–∞–π—Ç–µ –∞–¥—Ä–µ—Å—É —Ç–∞–±–ª–∏—Ü—ñ GOT –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —è–∫ –ø—ñ—Å–ª—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** **–≤–∏–∫–æ–Ω—É–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É** –≤ GEF –≤–∏ –º–æ–∂–µ—Ç–µ **–±–∞—á–∏—Ç–∏** **—Ñ—É–Ω–∫—Ü—ñ—ó**, —è–∫—ñ —î –≤ **GOT**: `gef‚û§ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ GEF, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–æ—á–∞—Ç–∏** —Å–µ—Å—ñ—é **–≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è** —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ **`got`**, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é got:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

–£ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ GOT –º–∞—î **–∞–¥—Ä–µ—Å–∏ –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π –∞–±–æ** –¥–æ **—Å–µ–∫—Ç–æ—Ä–∞ PLT**, —è–∫–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó. –ú–µ—Ç–∞ —Ü—å–æ–≥–æ –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É - **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–∞–ø–∏—Å GOT** —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫–∞ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∞ –ø—ñ–∑–Ω—ñ—à–µ **–∞–¥—Ä–µ—Å–æ—é** PLT **—Ñ—É–Ω–∫—Ü—ñ—ó** **`system`**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥.

–Ü–¥–µ–∞–ª—å–Ω–æ, –≤–∏ –±—É–¥–µ—Ç–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏** **GOT** —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫–∞ **–±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–º–∏ –≤–∞–º–∏** (—Ç–∞–∫ —â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –¥–æ —Ñ—É–Ω–∫—Ü—ñ—ó system).

–Ø–∫—â–æ **`system`** **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è** —Å–∫—Ä–∏–ø—Ç–æ–º, —Ñ—É–Ω–∫—Ü—ñ—è system **–Ω–µ –º–∞—Ç–∏–º–µ** –∑–∞–ø–∏—Å—É –≤ PLT. –£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó –≤–∞–º **–ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–ø–æ—á–∞—Ç–∫—É –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∞–¥—Ä–µ—Å—É** —Ñ—É–Ω–∫—Ü—ñ—ó `system`, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ GOT, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞ —Ü—é –∞–¥—Ä–µ—Å—É.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –∞–¥—Ä–µ—Å–∏ PLT –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`objdump -j .plt -d ./vuln_binary`**

## **–û–¥–∏–Ω –≥–∞–¥–∂–µ—Ç**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **–ó–∞—Ö–∏—Å—Ç–∏**

–ó–∞—Ö–∏—Å—Ç **Full RELRO** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ —Ç–∞–∫–æ–≥–æ —Ä–æ–¥—É —Ç–µ—Ö–Ω—ñ–∫, —Ä–æ–∑–≤'—è–∑—É—é—á–∏ –≤—Å—ñ –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ–π, –∫–æ–ª–∏ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, —ñ —Ä–æ–±–ª—è—á–∏ **—Ç–∞–±–ª–∏—Ü—é GOT —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è** –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
