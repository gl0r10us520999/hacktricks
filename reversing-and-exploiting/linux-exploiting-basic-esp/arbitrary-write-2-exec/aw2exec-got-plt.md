# AW2Exec - GOT/PLT

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## **Informations de base**

### **GOT : Table d'offset global**

La **Table d'offset global (GOT)** est un m√©canisme utilis√© dans les binaires li√©s dynamiquement pour g√©rer les **adresses des fonctions externes**. √âtant donn√© que ces **adresses ne sont pas connues avant l'ex√©cution** (en raison du lien dynamique), la GOT fournit un moyen de **mettre √† jour dynamiquement les adresses de ces symboles externes** une fois qu'elles sont r√©solues.

Chaque entr√©e dans la GOT correspond √† un symbole dans les biblioth√®ques externes que le binaire peut appeler. Lorsqu'une **fonction est appel√©e pour la premi√®re fois, son adresse r√©elle est r√©solue par le lieur dynamique et stock√©e dans la GOT**. Les appels suivants √† la m√™me fonction utilisent l'adresse stock√©e dans la GOT, √©vitant ainsi le surco√ªt de la r√©solution de l'adresse √† nouveau.

### **PLT : Table de liaison de proc√©dures**

La **Table de liaison de proc√©dures (PLT)** fonctionne en √©troite collaboration avec la GOT et sert de trampoline pour g√©rer les appels aux fonctions externes. Lorsqu'un binaire **appelle une fonction externe pour la premi√®re fois, le contr√¥le est transf√©r√© √† une entr√©e dans la PLT associ√©e √† cette fonction**. Cette entr√©e PLT est responsable d'invoquer le lieur dynamique pour r√©soudre l'adresse de la fonction si elle n'a pas d√©j√† √©t√© r√©solue. Une fois l'adresse r√©solue, elle est stock√©e dans la GOT.

**Par cons√©quent,** les entr√©es de la GOT sont utilis√©es directement une fois que l'adresse d'une fonction ou d'une variable externe est r√©solue. **Les entr√©es de la PLT sont utilis√©es pour faciliter la r√©solution initiale** de ces adresses via le lieur dynamique.

## Obtenir l'ex√©cution

### V√©rifiez la GOT

Obtenez l'adresse de la table GOT avec : **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

Observez comment apr√®s **le chargement** de l'**ex√©cutable** dans GEF, vous pouvez **voir** les **fonctions** qui se trouvent dans la **GOT** : `gef‚û§ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

En utilisant GEF, vous pouvez **d√©marrer** une session de **d√©bogage** et ex√©cuter **`got`** pour voir la table got :

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

Dans un binaire, la GOT contient les **adresses des fonctions ou** de la **section PLT** qui chargera l'adresse de la fonction. L'objectif de cette √©criture arbitraire est de **remplacer une entr√©e de la GOT** d'une fonction qui sera ex√©cut√©e plus tard **avec** l'**adresse** de la PLT de la **fonction** **`system`** par exemple.

Id√©alement, vous allez **remplacer** la **GOT** d'une **fonction** qui est **sur le point d'√™tre appel√©e avec des param√®tres contr√¥l√©s par vous** (vous pourrez ainsi contr√¥ler les param√®tres envoy√©s √† la fonction syst√®me).

Si **`system`** **n'est pas utilis√©** par le script, la fonction syst√®me **n'aura pas** d'entr√©e dans la PLT. Dans ce sc√©nario, vous devrez **d'abord obtenir l'adresse** de la fonction `system` et ensuite remplacer la GOT pour pointer vers cette adresse.

Vous pouvez voir les adresses PLT avec **`objdump -j .plt -d ./vuln_binary`**

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Protections**

La protection **Full RELRO** est con√ßue pour prot√©ger contre ce type de technique en r√©solvant toutes les adresses des fonctions lorsque le binaire est d√©marr√© et en rendant la **table GOT en lecture seule** apr√®s cela :

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## R√©f√©rences

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
