# AW2Exec - GOT/PLT

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Informaci√≥n B√°sica**

### **GOT: Tabla de Desplazamiento Global**

La **Tabla de Desplazamiento Global (GOT)** es un mecanismo utilizado en binarios vinculados din√°micamente para gestionar las **direcciones de funciones externas**. Dado que estas **direcciones no se conocen hasta el tiempo de ejecuci√≥n** (debido al enlace din√°mico), la GOT proporciona una forma de **actualizar din√°micamente las direcciones de estos s√≠mbolos externos** una vez que se resuelven.

Cada entrada en la GOT corresponde a un s√≠mbolo en las bibliotecas externas que el binario puede llamar. Cuando se **llama a una funci√≥n por primera vez, su direcci√≥n real es resuelta por el enlazador din√°mico y almacenada en la GOT**. Las llamadas posteriores a la misma funci√≥n utilizan la direcci√≥n almacenada en la GOT, evitando as√≠ el costo de resolver la direcci√≥n nuevamente.

### **PLT: Tabla de Enlace de Procedimientos**

La **Tabla de Enlace de Procedimientos (PLT)** trabaja en estrecha colaboraci√≥n con la GOT y sirve como un trampol√≠n para manejar llamadas a funciones externas. Cuando un binario **llama a una funci√≥n externa por primera vez, el control se pasa a una entrada en la PLT asociada con esa funci√≥n**. Esta entrada de la PLT es responsable de invocar al enlazador din√°mico para resolver la direcci√≥n de la funci√≥n si a√∫n no se ha resuelto. Despu√©s de que se resuelve la direcci√≥n, se almacena en la GOT.

**Por lo tanto,** las entradas de la GOT se utilizan directamente una vez que se resuelve la direcci√≥n de una funci√≥n o variable externa. **Las entradas de la PLT se utilizan para facilitar la resoluci√≥n inicial** de estas direcciones a trav√©s del enlazador din√°mico.

## Obtener Ejecuci√≥n

### Verificar la GOT

Obt√©n la direcci√≥n de la tabla GOT con: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

Observa c√≥mo despu√©s de **cargar** el **ejecutable** en GEF puedes **ver** las **funciones** que est√°n en la **GOT**: `gef‚û§ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

Usando GEF puedes **iniciar** una sesi√≥n de **depuraci√≥n** y ejecutar **`got`** para ver la tabla got:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

En un binario, la GOT tiene las **direcciones a las funciones o** a la **secci√≥n PLT** que cargar√° la direcci√≥n de la funci√≥n. El objetivo de esta escritura arbitraria es **sobrescribir una entrada de la GOT** de una funci√≥n que se va a ejecutar m√°s tarde **con** la **direcci√≥n** de la PLT de la **funci√≥n** **`system`** por ejemplo.

Idealmente, deber√≠as **sobrescribir** la **GOT** de una **funci√≥n** que va a ser **llamada con par√°metros controlados por ti** (as√≠ podr√°s controlar los par√°metros enviados a la funci√≥n del sistema).

Si **`system`** **no es utilizado** por el script, la funci√≥n del sistema **no** tendr√° una entrada en la PLT. En este escenario, necesitar√°s **filtrar primero la direcci√≥n** de la funci√≥n `system` y luego sobrescribir la GOT para apuntar a esta direcci√≥n.

Puedes ver las direcciones de la PLT con **`objdump -j .plt -d ./vuln_binary`**

## **Un Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Protecciones**

La protecci√≥n **Full RELRO** est√° destinada a proteger contra este tipo de t√©cnica al resolver todas las direcciones de las funciones cuando se inicia el binario y hacer que la **tabla GOT sea de solo lectura** despu√©s de eso:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referencias

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
