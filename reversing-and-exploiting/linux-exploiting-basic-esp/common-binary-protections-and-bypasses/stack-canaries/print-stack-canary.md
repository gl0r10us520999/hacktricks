# Print Stack Canary

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Enlarge printed stack

스택 오버플로우에 취약한 **프로그램**이 **스택 오버플로우**의 **일부**를 가리키는 **puts** 함수를 실행할 수 있는 상황을 상상해 보십시오. 공격자는 **canary의 첫 번째 바이트가 널 바이트**(`\x00`)이고 나머지 canary는 **무작위** 바이트라는 것을 알고 있습니다. 그러면 공격자는 **canary의 첫 번째 바이트**만 덮어쓰는 오버플로우를 생성할 수 있습니다.

그런 다음 공격자는 페이로드의 중간에서 **puts 기능**을 호출하여 **canary를 모두 출력**합니다(첫 번째 널 바이트 제외).

이 정보를 통해 공격자는 **canary를 알고** 새로운 공격을 **구성하고 전송**할 수 있습니다(같은 프로그램 세션에서).

명백히, 이 전술은 공격자가 **canary**를 **유출**하기 위해 자신의 **페이로드**의 **내용**을 **출력**할 수 있어야 하므로 매우 **제한적**입니다. 그런 다음 **새로운 페이로드**를 생성하고(같은 **프로그램 세션**에서) **실제 버퍼 오버플로우**를 **전송**할 수 있어야 합니다.

**CTF 예시:**&#x20;

* [**https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html**](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64비트, ASLR 활성화되었지만 PIE 없음, 첫 번째 단계는 canary의 바이트 0x00까지 오버플로우를 채운 다음 puts를 호출하여 유출하는 것입니다. canary로 ROP 가젯을 생성하여 puts를 호출하여 GOT에서 puts의 주소를 유출하고, `system('/bin/sh')`를 호출하는 ROP 가젯을 생성합니다.

## Arbitrary Read

형식 **문자열**이 제공하는 임의 읽기를 통해 canary를 유출할 수 있을지도 모릅니다. 이 예를 확인하십시오: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) 및 임의 메모리 주소를 읽기 위해 형식 문자열을 악용하는 방법에 대해 읽을 수 있습니다:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
