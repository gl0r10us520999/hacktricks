# PIE

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Un binaire compil√© en tant que PIE, ou **Position Independent Executable**, signifie que le **programme peut se charger √† diff√©rents emplacements m√©moire** chaque fois qu'il est ex√©cut√©, emp√™chant les adresses cod√©es en dur.

Le truc pour exploiter ces binaires r√©side dans l'exploitation des **adresses relatives**‚Äîles d√©calages entre les parties du programme restent les m√™mes m√™me si les emplacements absolus changent. Pour **contourner PIE, vous devez seulement divulguer une adresse**, g√©n√©ralement depuis la **pile** en utilisant des vuln√©rabilit√©s comme les attaques par cha√Æne de format. Une fois que vous avez une adresse, vous pouvez calculer d'autres par leurs **d√©calages fixes**.

Un indice utile pour exploiter les binaires PIE est que leur **adresse de base se termine g√©n√©ralement par 000** en raison des pages m√©moire √©tant les unit√©s de randomisation, de taille 0x1000 octets. Cet alignement peut √™tre un **v√©rification critique si une exploitation ne fonctionne pas** comme pr√©vu, indiquant si la bonne adresse de base a √©t√© identifi√©e.\
Ou vous pouvez utiliser cela pour votre exploitation, si vous divulguez qu'une adresse est situ√©e √† **`0x649e1024`** vous savez que l'**adresse de base est `0x649e1000`** et √† partir de l√† vous pouvez simplement **calculer les d√©calages** des fonctions et des emplacements.

## Bypasses

Pour contourner PIE, il est n√©cessaire de **divulguer une adresse du binaire charg√©**, il existe plusieurs options pour cela :

* **ASLR d√©sactiv√©** : Si ASLR est d√©sactiv√©, un binaire compil√© avec PIE est toujours **charg√© √† la m√™me adresse**, donc **PIE va √™tre inutile** car les adresses des objets seront toujours au m√™me endroit.
* Recevoir la **divulgation** (commun dans les d√©fis CTF faciles, [**v√©rifiez cet exemple**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **Brute-forcer les valeurs EBP et EIP** dans la pile jusqu'√† ce que vous divulguiez les bonnes :

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

* Utiliser une vuln√©rabilit√© de lecture arbitraire telle que [**format string**](../../format-strings/) pour divulguer une adresse du binaire (par exemple, depuis la pile, comme dans la technique pr√©c√©dente) pour obtenir la base du binaire et utiliser des d√©calages √† partir de l√†. [**Trouvez un exemple ici**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass).

## References

* [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
