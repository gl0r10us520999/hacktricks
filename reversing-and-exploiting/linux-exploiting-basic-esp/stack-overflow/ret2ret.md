# Ret2ret & Reo2pop

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Ret2ret

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдореБрдЦреНрдп рд▓рдХреНрд╖реНрдп **рд╕реНрдЯреИрдХ рдореЗрдВ рдПрдХ рдореМрдЬреВрджрд╛ рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ ASLR рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛** рд╣реИред

рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ, рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдЖрдорддреМрд░ рдкрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЗ рдХрд╛рд░рдг рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдореЗрдореЛрд░реА рдореЗрдВ рдЕрдВрдд рдореЗрдВ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИрдВ**ред рдпрд╣ рдореМрдЬреВрджрд╛ рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рд╕реНрдерд╛рди рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рд╕реНрдЯреИрдХ рдореЗрдВ `0xbfffffdd` рдерд╛, рддреЛ рдпрд╣ рдУрд╡рд░рдлреНрд▓реЛ рдЗрд╕реЗ `0xbfffff00` рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ (рдЕрдВрддрд┐рдо рд╢реВрдиреНрдп рдмрд╛рдЗрдЯ рдХреЛ рдиреЛрдЯ рдХрд░реЗрдВ)ред

рдпрджрд┐ рд╡рд╣ рдкрддрд╛ рд╣рдорд╛рд░реЗ рд╢реЗрд▓рдХреЛрдб рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ **`ret` рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдкрддреЗ рдЬреЛрдбрд╝рдХрд░** рдЙрд╕ рдкрддреЗ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рдирд╣реАрдВ рдкрд╣реБрдВрдЪ рдЬрд╛рддрд╛ред

рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛ рдЗрд╕ рддрд░рд╣ рд╣реЛрдЧрд╛:

* NOP рд╕реНрд▓реЗрдб
* рд╢реЗрд▓рдХреЛрдб
* **`ret` рдХреЗ рд▓рд┐рдП рдкрддреЗ рдХреЗ рд╕рд╛рде EIP рд╕реЗ рд╕реНрдЯреИрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдВ** (RET рд╕реНрд▓реЗрдб)
* 0x00 рдЬреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рд╕реНрдЯреИрдХ рд╕реЗ рдПрдХ рдкрддреЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ NOP рд╕реНрд▓реЗрдб рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдЖрдк рдПрдХ рдХрдордЬреЛрд░ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯред

## Ret2pop

рдпрджрд┐ рдЖрдк рд╕реНрдЯреИрдХ рдореЗрдВ рдПрдХ **рдкрд░рдлреЗрдХреНрдЯ рдкреЙрдЗрдВрдЯрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ** (`ret2ret` рдореЗрдВ рд╣рдо рдЕрдВрддрд┐рдо рд╕рдмрд╕реЗ рдХрдо рдмрд╛рдЗрдЯ рдХреЛ `0x00` рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ), рддреЛ рдЖрдк рд╡рд╣реА `ret2ret` рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди **RET рд╕реНрд▓реЗрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ 1 рд╕реЗ рдЫреЛрдЯрд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛** (рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо `0x00` рдкрд░рдлреЗрдХреНрдЯ рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдареАрдХ рдкрд╣рд▓реЗ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗ), рдФрд░ **RET рд╕реНрд▓реЗрдб рдХрд╛ рдЕрдВрддрд┐рдо** рдкрддрд╛ **`pop <reg>; ret`** рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред\
рдЗрд╕ рддрд░рд╣, **рдкрд░рдлреЗрдХреНрдЯ рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдкрд╣рд▓реЗ рдХрд╛ рдбреЗрдЯрд╛** рд╕реНрдЯреИрдХ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдпрд╣ рдбреЗрдЯрд╛ `0x00` рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ) рдФрд░ **рдЕрдВрддрд┐рдо `ret` рдмрд┐рдирд╛ рдХрд┐рд╕реА рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд╕реНрдЯреИрдХ рдореЗрдВ рдкрд░рдлреЗрдХреНрдЯ рдкрддреЗ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧрд╛**ред

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдЖрдк рдПрдХ рдХрдордЬреЛрд░ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ** ](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c) рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯред

## References

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
