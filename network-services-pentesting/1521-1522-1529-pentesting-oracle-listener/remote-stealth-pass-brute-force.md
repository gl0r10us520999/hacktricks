<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Per칤metro Exterior: Fuerza bruta remota y sigilosa

**Las versiones 11.1.0.6, 11.1.0.7, 11.2.0.1, 11.2.0.2 y 11.2.0.3 son vulnerables** a esta t칠cnica. Para entender la idea detr치s de esta vulnerabilidad, necesitas considerar c칩mo funciona el protocolo de autenticaci칩n con la base de datos. Lo mostrar칠 para la versi칩n 11. La interacci칩n con el servidor procede de la siguiente manera:

1. El cliente se conecta al servidor y env칤a el nombre de usuario.
2. El servidor genera un identificador de sesi칩n ('AUTH\_SESSKEY') y lo encripta usando AES-192. Como clave, el sistema utiliza el hash SHA-1 generado a partir de la contrase침a del usuario y la sal ('AUTH\_VFR\_DATA').
3. El servidor env칤a un ID de sesi칩n encriptado y la sal al cliente.
4. El cliente genera la clave haciendo hash de su contrase침a y la sal recibida. El cliente utiliza esta clave para desencriptar los datos de sesi칩n recibidos del servidor.
5. Bas치ndose en el ID de sesi칩n del servidor desencriptado, el cliente genera una nueva clave p칰blica para uso futuro.

Ahora, aqu칤 est치 la parte m치s interesante: El ID de sesi칩n 'AUTH\_SESSKEY' enviado por el servidor al cliente tiene una longitud de 48 bytes. De estos, 40 bytes son aleatorios, y los 칰ltimos 8 son duplicados de '0x08'. El vector de inicializaci칩n es 0x00 (Nulo).
Sabiendo que los 칰ltimos 8 bytes del identificador p칰blico siempre consisten en '0x08', podemos hacer fuerza bruta a esta contrase침a y, adem치s, hacerlo en modo offline, lo que significa una velocidad tremenda, especialmente si usas GPU. Para montar un ataque, necesitas conocer el SID, un login v치lido (por ejemplo, la cuenta 'SYS' es muy interesante) y, por supuesto, tener la capacidad de conectarte a la base de datos. 춰En este caso, no se crear치n registros como 'Intento de Login Inv치lido' en los registros de auditor칤a de Oracle!

Resumiendo todo:

1. Usa Wireshark para **interceptar** el **tr치fico inicial** durante la **autorizaci칩n**. Esto se facilitar치 con el filtro 'tns'.
2. Extrae los **valores HEX para AUTH\_SESSKEY, AUTH\_VFR\_DATA**.
3. Ins칠rtalos en el [**script PoC**](https://www.exploit-db.com/exploits/22069), que realizar치 un ataque de diccionario (fuerza bruta).

## Usando nmap y john
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><strong>Aprende hacking en AWS de cero a h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en github.

</details>
