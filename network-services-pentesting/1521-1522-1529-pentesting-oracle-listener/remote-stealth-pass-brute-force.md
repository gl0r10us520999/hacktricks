```markdown
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# P√©rim√®tre ext√©rieur : Force brute discr√®te √† distance

**Les versions 11.1.0.6, 11.1.0.7, 11.2.0.1, 11.2.0.2 et 11.2.0.3 sont vuln√©rables** √† cette technique. Pour comprendre l'id√©e derri√®re cette vuln√©rabilit√©, vous devez consid√©rer comment le protocole d'authentification fonctionne avec la base de donn√©es. Je vais le montrer pour la version 11. L'interaction avec le serveur se d√©roule comme suit :

1. Le client se connecte au serveur et envoie le nom d'utilisateur.
2. Le serveur g√©n√®re un identifiant de session ('AUTH\_SESSKEY') et le chiffre en utilisant AES-192. Comme cl√©, le syst√®me utilise le hash SHA-1 g√©n√©r√© √† partir du mot de passe de l'utilisateur et du sel ('AUTH\_VFR\_DATA').
3. Le serveur envoie un ID de session chiffr√© et du sel au client.
4. Le client g√©n√®re la cl√© en hachant son mot de passe et le sel re√ßu. Le client utilise cette cl√© pour d√©chiffrer les donn√©es de session re√ßues du serveur.
5. Sur la base de l'ID de session serveur d√©chiffr√©, le client g√©n√®re une nouvelle cl√© publique pour une utilisation future.

Maintenant, voici la partie la plus int√©ressante : L'ID de session 'AUTH\_SESSKEY' envoy√© par le serveur au client a une longueur de 48 octets. Parmi ceux-ci, 40 octets sont al√©atoires, et les 8 derniers sont les doublons de '0x08'. Le vecteur d'initialisation est 0x00 (Null).
Sachant que les 8 derniers octets de l'identifiant public sont toujours constitu√©s de '0x08', nous pouvons forcer le mot de passe et, de plus, le faire en mode hors ligne, ce qui signifie une vitesse √©norme, surtout si vous utilisez un GPU. Pour monter une attaque, vous devez conna√Ætre le SID, un login valide (par exemple, le compte 'SYS' est tr√®s int√©ressant) et, bien s√ªr, avoir la possibilit√© de se connecter √† la base de donn√©es. Dans ce cas, il n'y aura pas d'enregistrements, tels que 'Tentative de connexion invalide', cr√©√©s dans les journaux d'audit Oracle !

En r√©sum√© :

1. Utilisez Wireshark pour **intercepter** le **trafic initial** pendant **l'autorisation**. Cela sera aid√© par le filtre 'tns'.
2. Extrayez les **valeurs HEX pour AUTH\_SESSKEY, AUTH\_VFR\_DATA**.
3. Ins√©rez-les dans le [**script PoC**](https://www.exploit-db.com/exploits/22069), qui effectuera une attaque par dictionnaire (force brute).

## Utilisation de nmap et john
```
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
