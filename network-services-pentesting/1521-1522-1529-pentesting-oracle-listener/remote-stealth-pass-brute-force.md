<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs exclusivos**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no github.

</details>


# Per√≠metro Externo: For√ßa bruta passiva remota

**As vers√µes 11.1.0.6, 11.1.0.7, 11.2.0.1, 11.2.0.2 e 11.2.0.3 s√£o vulner√°veis** a esta t√©cnica. Para entender a ideia por tr√°s desta vulnerabilidade, voc√™ precisa considerar como o protocolo de autentica√ß√£o funciona com o banco de dados. Vou demonstrar para a vers√£o 11. A intera√ß√£o com o servidor procede da seguinte forma:

1. O cliente se conecta ao servidor e envia o nome de usu√°rio.
2. O servidor gera um identificador de sess√£o ('AUTH\_SESSKEY') e o criptografa usando AES-192. Como chave, o sistema usa o hash SHA-1 gerado a partir da senha do usu√°rio e do sal ('AUTH\_VFR\_DATA').
3. O servidor envia um ID de sess√£o criptografado e o sal para o cliente.
4. O cliente gera a chave fazendo o hash de sua senha e do sal recebido. O cliente usa essa chave para descriptografar os dados da sess√£o recebidos do servidor.
5. Com base no ID de sess√£o do servidor descriptografado, o cliente gera uma nova chave p√∫blica para uso futuro.

Agora, aqui est√° a parte mais interessante: O ID de sess√£o 'AUTH\_SESSKEY' enviado pelo servidor ao cliente tem um comprimento de 48 bytes. Destes, 40 bytes s√£o aleat√≥rios, e os √∫ltimos 8 s√£o duplicatas de '0x08'. O vetor de inicializa√ß√£o √© 0x00 (Nulo).
Sabendo que os √∫ltimos 8 bytes do identificador p√∫blico sempre consistem em '0x08', podemos fazer for√ßa bruta dessa senha e, al√©m disso, fazer isso em modo offline, o que significa uma velocidade tremenda, especialmente se voc√™ usar GPU. Para montar um ataque, voc√™ precisa conhecer o SID, um login v√°lido (por exemplo, a conta 'SYS' √© muito interessante) e, claro, ter a capacidade de se conectar ao banco de dados. Neste caso, n√£o haver√° registros, como 'Tentativa de Login Inv√°lida', criados nos logs de auditoria da Oracle!

Resumindo tudo:

1. Use o Wireshark para **interceptar** o **tr√°fego inicial** durante a **autoriza√ß√£o**. Isso ser√° auxiliado pelo filtro 'tns'.
2. Extraia os **valores HEX para AUTH\_SESSKEY, AUTH\_VFR\_DATA**.
3. Insira-os no [**script PoC**](https://www.exploit-db.com/exploits/22069), que realizar√° um ataque de dicion√°rio (for√ßa bruta).

## Usando nmap e john
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
