<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong>を通じてゼロからヒーローまでAWSハッキングを学ぶ</summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)をフォローする
- **ハッキングトリックを共有するために、[HackTricks](https://github.com/carlospolop/hacktricks)と[HackTricks Cloud](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する**

</details>


'**TNS Poison**'として知られる脆弱性は、リスナーの12cバージョンまでに影響を与え、後者は特定の構成でのみ脆弱です。たとえば、リスナーの動的構成を無効にすることは、Oracle DataGuard、PL/SQL Gateway with APEX、および特定のSAPバージョンを使用するセットアップでは実現不可能な緩和措置です。この脆弱性は、リスナーサービスのデフォルト動作がリモート構成をサポートし、匿名構成を含むことが脆弱性の要点です。

![https://hackmag.com/wp-content/uploads/2015/04/poison.png](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

*図1はTNS Poison脆弱性を示しています。*

攻撃アルゴリズムのサンプルは次のとおりです（図1を参照）：

1. 'CONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)'というTNSクエリを送信する。
2. '（DESCRIPTION=(TMP=))'という応答は脆弱性を示し、パッチ済みサーバーは '（ERROR_STACK=(ERROR=1194))' で応答します。
3. 攻撃者は、新しいリスナー向けにSIDとIPを含む構成パッケージを生成する必要があり、Man-In-The-Middle（MITM）攻撃を狙います。現在のSID名の長さは、Well Formedパッケージを作成するために重要です。
4. これらのコンポーネントは次にリスナーに転送されます。
5. 成功した実行後、新しい接続は攻撃者が制御するIP経由でリスナーによって誘導されます。

潜在的なMITM攻撃をDoS攻撃に変換して新しいクライアントがデータベースに接続できないようにするために、クエリプロキシング（LinuxのIP_forwardingに類似）を有効にすることが重要です。この脆弱性により、攻撃者は他のユーザーのセッションにコマンドを挿入できます。サーバーの脆弱性は、Metasploit Framework（MSF）モジュール 'auxiliary/scanner/oracle/tnspoison_checker' を使用して評価できます。

詳細については、オリジナルの[HackmagのOracle DB侵害手法に関する記事](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/)をご覧ください。

**代替テスト方法:**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションを見る
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**する
* **ハッキングトリックを共有するためにPRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>
