<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>


Uma vulnerabilidade conhecida como 'TNS Poison' afeta vers√µes at√© 12c do listener, sendo que a √∫ltima √© vulner√°vel apenas sob configura√ß√µes espec√≠ficas. Por exemplo, desabilitar a configura√ß√£o din√¢mica do listener √© uma medida de remedia√ß√£o que n√£o √© vi√°vel em ambientes que utilizam Oracle DataGuard, PL/SQL Gateway com APEX e certas vers√µes do SAP. Essa vulnerabilidade decorre do comportamento padr√£o do servi√ßo de listener de suportar configura√ß√µes remotas, incluindo configura√ß√µes an√¥nimas, que √© o cerne da vulnerabilidade.

![https://hackmag.com/wp-content/uploads/2015/04/poison.png](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

*A Figura 1 representa a Vulnerabilidade TNS Poison.*

Um algoritmo de ataque de exemplo √© detalhado da seguinte forma (consulte a Fig. 1):

1. Um query TNS, ‚ÄòCONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)‚Äô, deve ser enviado.
2. Uma resposta de ‚Äò(DESCRIPTION=(TMP=))‚Äô indica vulnerabilidade, enquanto um servidor corrigido responde com ‚Äò(ERROR_STACK=(ERROR=1194))‚Äô.
3. O atacante deve gerar um pacote de configura√ß√£o, incluindo o SID e o IP para um novo listener, visando um ataque Man-In-The-Middle (MITM). O comprimento do nome do SID atual √© crucial para criar um pacote Bem Formado.
4. Esses componentes s√£o ent√£o encaminhados para o listener.
5. Ap√≥s a execu√ß√£o bem-sucedida, novas conex√µes s√£o direcionadas atrav√©s do IP controlado pelo atacante pelo listener.

√â crucial ativar o proxy de consulta (semelhante ao IP_forwarding no Linux) para evitar transformar um potencial ataque MITM em um ataque de Nega√ß√£o de Servi√ßo (DoS), que bloquearia novos clientes de se conectarem ao banco de dados. Essa vulnerabilidade permite que um atacante insira comandos na sess√£o de outro usu√°rio. A vulnerabilidade do servidor pode ser avaliada usando o m√≥dulo do Metasploit Framework (MSF): ‚Äòauxiliary/scanner/oracle/tnspoison_checker‚Äô.

Para mais informa√ß√µes, confira o [artigo original do Hackmag sobre m√©todos de penetra√ß√£o em bancos de dados Oracle](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/).

**M√©todo de Teste Alternativo:**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
