<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>


Una vulnerabilidad conocida como 'TNS Poison' afecta a las versiones hasta la 12c del listener, siendo la √∫ltima vulnerable solo bajo configuraciones espec√≠ficas. Por ejemplo, deshabilitar la configuraci√≥n din√°mica del listener es una medida de mitigaci√≥n que no es factible en configuraciones que utilizan Oracle DataGuard, PL/SQL Gateway con APEX y ciertas versiones de SAP. Esta vulnerabilidad se deriva del comportamiento predeterminado del servicio del listener de admitir configuraciones remotas, incluidas configuraciones an√≥nimas, que es el meollo de la vulnerabilidad.

![https://hackmag.com/wp-content/uploads/2015/04/poison.png](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

*La Figura 1 representa la Vulnerabilidad de TNS Poison.*

Se detalla un algoritmo de ataque de muestra de la siguiente manera (consulte la Fig. 1):

1. Se debe enviar una consulta de TNS, ‚ÄòCONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)‚Äô.
2. Una respuesta de ‚Äò(DESCRIPTION=(TMP=))‚Äô indica vulnerabilidad, mientras que un servidor parcheado responde con ‚Äò(ERROR_STACK=(ERROR=1194))‚Äô.
3. El atacante debe generar un paquete de configuraci√≥n, que incluya el SID y la IP para un nuevo listener, dirigido a un ataque de Man-In-The-Middle (MITM). La longitud del nombre del SID actual es crucial para crear un paquete Bien Formado.
4. Estos componentes se env√≠an luego al listener.
5. Tras una ejecuci√≥n exitosa, las nuevas conexiones son dirigidas a trav√©s de la IP controlada por el atacante por el listener.

Es crucial activar la proxy de consultas (similar a IP_forwarding en Linux) para evitar transformar un posible ataque MITM en un ataque de Denegaci√≥n de Servicio (DoS), que bloquear√≠a a nuevos clientes de conectarse a la base de datos. Esta vulnerabilidad permite a un atacante insertar comandos en la sesi√≥n de otro usuario. La vulnerabilidad del servidor puede ser evaluada utilizando el m√≥dulo del Framework Metasploit (MSF): ‚Äòauxiliary/scanner/oracle/tnspoison_checker‚Äô.

Para obtener m√°s informaci√≥n, consulta el [art√≠culo original de Hackmag sobre m√©todos de penetraci√≥n en bases de datos Oracle](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/).

**M√©todo de Prueba Alternativo:**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme en** **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
