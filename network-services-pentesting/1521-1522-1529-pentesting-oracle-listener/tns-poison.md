<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>


Une vuln√©rabilit√© connue sous le nom de 'TNS Poison' affecte les versions jusqu'√† 12c du listener, cette derni√®re n'√©tant vuln√©rable que dans des configurations sp√©cifiques. Par exemple, la d√©sactivation de la configuration dynamique du listener est une mesure de rem√©diation qui n'est pas r√©alisable dans les configurations utilisant Oracle DataGuard, PL/SQL Gateway avec APEX et certaines versions de SAP. Cette vuln√©rabilit√© d√©coule du comportement par d√©faut du service d'√©coute du listener qui prend en charge la configuration √† distance, y compris les configurations anonymes, ce qui est le c≈ìur de la vuln√©rabilit√©.

![https://hackmag.com/wp-content/uploads/2015/04/poison.png](https://hackmag.com/wp-content/uploads/2015/04/poison.png)

*La figure 1 illustre la vuln√©rabilit√© TNS Poison.*

Un algorithme d'attaque type est d√©taill√© comme suit (voir Fig. 1) :

1. Une requ√™te TNS, 'CONNECT_DATA=(COMMAND=SERVICE_REGISTER_NSGR)', doit √™tre envoy√©e.
2. Une r√©ponse de '(DESCRIPTION=(TMP=))' indique une vuln√©rabilit√©, tandis qu'un serveur patch√© r√©pond avec '(ERROR_STACK=(ERROR=1194))'.
3. L'attaquant doit g√©n√©rer un package de configuration, comprenant le SID et l'IP pour un nouveau listener, dans le but d'une attaque de l'homme du milieu (MITM). La longueur du nom du SID actuel est cruciale pour √©laborer un package bien form√©.
4. Ces composants sont ensuite transmis au listener.
5. Apr√®s une ex√©cution r√©ussie, les nouvelles connexions sont dirig√©es vers l'IP contr√¥l√©e par l'attaquant par le listener.

Il est crucial d'activer la mise en proxy de requ√™tes (similaire √† IP_forwarding sous Linux) pour √©viter de transformer une √©ventuelle attaque MITM en une attaque par d√©ni de service (DoS), qui bloquerait les nouveaux clients de se connecter √† la base de donn√©es. Cette vuln√©rabilit√© permet √† un attaquant d'ins√©rer des commandes dans la session d'un autre utilisateur. La vuln√©rabilit√© du serveur peut √™tre √©valu√©e en utilisant le module du Framework Metasploit (MSF) : 'auxiliary/scanner/oracle/tnspoison_checker'.

Pour plus d'informations, consultez l'article original de [Hackmag sur les m√©thodes de p√©n√©tration de la base de donn√©es Oracle](https://hackmag.com/uncategorized/looking-into-methods-to-penetrate-oracle-db/).

**M√©thode de test alternative :**
```text
./odat.py tnspoison -s <IP> -p <PORT> -d <SID> --test-module
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

D'autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
