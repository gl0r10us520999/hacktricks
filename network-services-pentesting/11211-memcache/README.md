# 11211 - Pentesting Memcache

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>tlhIngan Hol</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Protocol Information

From [wikipedia](https://en.wikipedia.org/wiki/Memcached):

> **Memcached** (pronunciation: mem-cashed, mem-cash-dee) is a general-purpose distributed [memory caching](https://en.wikipedia.org/wiki/Memory\_caching) system. It is often used to speed up dynamic database-driven websites by caching data and objects in RAM to reduce the number of times an external data source (such as a database or API) must be read.

Although Memcached supports SASL, most instances are **exposed without authentication**.

**Default port:** 11211
```
PORT      STATE SERVICE
11211/tcp open  unknown
```
## Enumeration

### Manual

To exfiltrate all the information saved inside a memcache instance you need to:

1. Find **slabs** with **active items**
2. Get the **key names** of the slabs detected before
3. Ex-filtrate the **saved data** by **getting the key names**

Remember that this service is just a **cache**, so **data may be appearing and disappearing**.

## qo'wI'wI'

### QaD

memcache instance vItlhutlhlaHbe'chugh **slabs** **active items** **ghItlh**:

1. **slabs** **ghItlh** **key names** **ghItlh**
2. **slabs** **ghItlh** **key names** **ghItlh**
3. **key names** **ghItlh** **saved data** **ghItlh**

memcache **service** **cache** **'e'** **'ej** **data may be appearing and disappearing** **ghItlh**.
```bash
echo "version" | nc -vn -w 1 <IP> 11211      #Get version
echo "stats" | nc -vn -w 1 <IP> 11211        #Get status
echo "stats slabs" | nc -vn -w 1 <IP> 11211  #Get slabs
echo "stats items" | nc -vn -w 1 <IP> 11211  #Get items of slabs with info
echo "stats cachedump <number> 0" | nc -vn -w 1 <IP> 11211  #Get key names (the 0 is for unlimited output size)
echo "get <item_name>" | nc -vn -w 1 <IP> 11211  #Get saved info

#This php will just dump the keys, you need to use "get <item_name> later"
sudo apt-get install php-memcached
php -r '$c = new Memcached(); $c->addServer("localhost", 11211); var_dump( $c->getAllKeys() );'
```
### Qapla'2

#### Introduction

Memcached is a high-performance, distributed memory caching system commonly used in web applications to speed up database queries by caching data in memory. However, misconfigurations or vulnerabilities in Memcached can lead to unauthorized access or data leakage.

This guide provides an overview of Memcached and its potential security issues, along with techniques for manual testing and exploitation.

#### Table of Contents

- [Memcached Basics](#memcached-basics)
- [Memcached Security Issues](#memcached-security-issues)
- [Manual Testing](#manual-testing)
- [Exploitation](#exploitation)
- [Mitigation](#mitigation)

#### Memcached Basics

Memcached is a distributed caching system that stores data in memory to reduce the load on backend databases. It is commonly used in web applications to cache frequently accessed data, such as database query results, API responses, or session data.

Memcached operates as a key-value store, where data is stored and retrieved using unique keys. When a client requests data, Memcached checks if the data is already in memory. If it is, the data is returned quickly without the need to query the backend database. If the data is not in memory, Memcached retrieves it from the database, stores it in memory, and returns it to the client.

#### Memcached Security Issues

Misconfigurations or vulnerabilities in Memcached can expose sensitive data or allow unauthorized access to the system. Some common security issues include:

- **Unauthenticated Access**: Memcached does not have built-in authentication mechanisms, which means that anyone with network access to the Memcached service can interact with it.

- **Default Configuration**: Memcached is often deployed with default configurations that may not be secure. For example, it may listen on all network interfaces, allowing external connections, or it may have excessive memory allocation, leading to potential denial-of-service attacks.

- **Data Leakage**: If sensitive data is stored in Memcached and the service is accessible to unauthorized users, it can result in data leakage.

- **Injection Attacks**: Memcached supports a binary protocol that allows clients to send arbitrary commands. If input validation is not properly implemented, it can lead to injection attacks.

#### Manual Testing

Manual testing of Memcached involves identifying misconfigurations and vulnerabilities by interacting with the service and analyzing its responses. Some techniques for manual testing include:

- **Banner Grabbing**: Retrieve the Memcached banner to gather information about the service version and configuration.

- **Key Enumeration**: Enumerate the keys stored in Memcached to identify potentially sensitive data.

- **Command Injection**: Test for command injection vulnerabilities by sending crafted commands to Memcached.

- **Memory Exhaustion**: Test the service's response to excessive memory allocation to identify potential denial-of-service vulnerabilities.

#### Exploitation

Exploiting vulnerabilities in Memcached can lead to unauthorized access or data leakage. Some exploitation techniques include:

- **Data Exfiltration**: Retrieve sensitive data stored in Memcached by exploiting misconfigurations or injection vulnerabilities.

- **Remote Code Execution**: If command injection vulnerabilities exist, it may be possible to execute arbitrary code on the Memcached server.

- **Denial-of-Service**: Exploit memory exhaustion vulnerabilities to cause the Memcached service to become unresponsive or crash.

#### Mitigation

To secure Memcached installations, consider the following mitigation techniques:

- **Access Control**: Implement network-level access controls to restrict access to the Memcached service.

- **Authentication**: Use external authentication mechanisms, such as firewall rules or VPNs, to control access to Memcached.

- **Secure Configuration**: Ensure that Memcached is properly configured, including limiting network interfaces, disabling unnecessary features, and setting appropriate memory limits.

- **Input Validation**: Implement strict input validation to prevent injection attacks.

- **Monitoring**: Regularly monitor Memcached logs and network traffic for suspicious activity.

- **Updates and Patches**: Keep Memcached up to date with the latest security patches and updates.

#### Conclusion

Memcached is a powerful caching system that can significantly improve the performance of web applications. However, it is important to understand and address the potential security issues associated with Memcached to prevent unauthorized access or data leakage. By following the techniques and mitigation strategies outlined in this guide, you can enhance the security of your Memcached installations.
```bash
sudo apt install libmemcached-tools
memcstat --servers=127.0.0.1 #Get stats
memcdump --servers=127.0.0.1 #Get all items
memccat  --servers=127.0.0.1 <item1> <item2> <item3> #Get info inside the item(s)
```
### Qapla' 

#### Automatic
```bash
nmap -n -sV --script memcached-info -p 11211 <IP>   #Just gather info
msf > use auxiliary/gather/memcached_extractor      #Extracts saved data
msf > use auxiliary/scanner/memcached/memcached_amp #Check is UDP DDoS amplification attack is possible
```
## **tlhIngan Hol: Memcache Keypu'wI' DuHwI'**

memcache, yIqem 'e' yIDel, 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlhlaHbe'chugh, vaj 'e' vItlhutlh
```bash
$ memcached -vv
slab class   1: chunk size        96 perslab   10922
[...]
```
To display all currently existing slabs, the following command is used:

```
stats items
```

To translate the above text to Klingon, we would have:

```
DaH jImej vItlhutlh:
```
```bash
stats slabs
```
**Translation:**

**Adding a single key to memcached 1.4.13 illustrates how slab classes are populated and managed. For instance:**

**Translation (Klingon):**

**memcached 1.4.13-va yIlo'be' 'e' vItlhutlh. QaQmey Slab classes vItlhutlh je vItlhutlh. jatlh:**
```bash
set mykey 0 60 1
1
STORED
```
Executing the "stats slabs" command post key addition yields detailed statistics about slab utilization:

---

**Klingon Translation:**

"stats slabs" jatlhmeH key lo'laHvIS qachDaq jatlhmeHvam vItlhutlh.
```bash
stats slabs
[...]
```
**Dujatlh:** 
Qapbe'ghach vItlhutlh, vItlhutlh chunks, je operational statistics, vItlhutlh read je write operations efficiency insights vItlhutlh.

**Qapbe'ghach:** 
"stats items" command, evictions, memory constraints, je item lifecycles data vItlhutlh:
```bash
stats items
[...]
```
### **QaD jImej**

1.4.31 laHbe'pu' jatlhlaHbe'pu' ghotpu' jImej vItlhutlh:

```bash
echo "stats cachedump <slab_id> <limit>" | nc <target_ip> 11211
```

### **QaD jImej vItlhutlh**

1.4.31 laHbe'pu' jatlhlaHbe'pu' ghotpu' jImej vItlhutlh:

```bash
echo "stats cachedump <slab_id> <limit>" | nc <target_ip> 11211
```
```bash
stats cachedump <slab class> <number of items to dump>
```
For example, to dump a key in class #1:
```bash
stats cachedump 1 1000
ITEM mykey [1 b; 1350677968 s]
END
```
### **DUMPING MEMCACHE KEYS (VER 1.4.31+)**

**DUMPING MEMCACHE KEYS (VER 1.4.31+)** **(MEMCACHE KEYS DUMPING (VER 1.4.31+))**

With memcache version 1.4.31 and above, a new, safer method for dumping keys in a production environment is introduced, utilizing non-blocking mode as detailed in the [release notes](https://github.com/memcached/memcached/wiki/ReleaseNotes1431). This approach generates extensive output, hence the recommendation to employ the 'nc' command for efficiency. Examples include: **(MEMCACHE KEYS DUMPING (VER 1.4.31+))**

Examples include: **(EXAMPLES INCLUDE:)**
```bash
echo 'lru_crawler metadump all' | nc 127.0.0.1 11211 | head -1
echo 'lru_crawler metadump all' | nc 127.0.0.1 11211 | grep ee6ba58566e234ccbbce13f9a24f9a28
```
### **DUMPING TOOLS**

Table [from here](https://lzone.de/blog).

| Programming Languages | Tools                                                                                                                              | Functionality                                                                                                                                                          |                                                                             |         |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- | ------- |
| PHP                   | [simple script](http://snipt.org/xtP)                                                                                              | Prints key names.                                                                                                                                                      |                                                                             |         |
| Perl                  | [simple script](https://wiki.jasig.org/download/attachments/13572172/memcached-clean.pl?version=1\&modificationDate=1229693957401) | Prints keys and values                                                                                                                                                 |                                                                             |         |
| Ruby                  | [simple script](https://gist.github.com/1365005)                                                                                   | Prints key names.                                                                                                                                                      |                                                                             |         |
| Perl                  | [memdump](https://search.cpan.org/\~dmaki/Memcached-libmemcached-0.4202/src/libmemcached/docs/memdump.pod)                         | Tool in CPAN module                                                                                                                                                    | [Memcached-libmemcached](https://search.cpan.org/\~dmaki/Memcached-libmemc) | ached/) |
| PHP                   | [memcache.php](http://livebookmark.net/journal/2008/05/21/memcachephp-stats-like-apcphp/)                                          | Memcache Monitoring GUI that also allows dumping keys                                                                                                                  |                                                                             |         |
| libmemcached          | [peep](http://blog.evanweaver.com/2009/04/20/peeping-into-memcached/)                                                              | **Does freeze your memcached process!!!** Be careful when using this in production. Still using it you can workaround the 1MB limitation and really dump **all** keys. |                                                                             |         |

## Troubleshooting <a href="#troubleshooting" id="troubleshooting"></a>

### 1MB Data Limit <a href="#1mb-data-limit" id="1mb-data-limit"></a>

Note that prio to memcached 1.4 you cannot store objects larger than 1MB due to the default maximum slab size.

### Never Set a Timeout > 30 Days! <a href="#never-set-a-timeout--30-days" id="never-set-a-timeout--30-days"></a>

If you try to ‚Äúset‚Äù or ‚Äúadd‚Äù a key with a timeout bigger than the allowed maximum you might not get what you expect because memcached then treats the value as a Unix timestamp. Also if the timestamp is in the past it will do nothing at all. Your command will silently fail.

So if you want to use the maximum lifetime specify 2592000. Example:
```
set my_key 0 2592000 1
1
```
### Disappearing Keys on Overflow <a href="#disappearing-keys-on-overflow" id="disappearing-keys-on-overflow"></a>

**tlhIngan Hol translation:**

**QaHvIS 11211 'ej "STAT pid"**

* `port:11211 "STAT pid"`
* `"STAT pid"`

### Replication <a href="#replication" id="replication"></a>

memcached jatlhpu'wI' rep yIDel. vaj vaj 3rd party solutions vaj:

* [repcached](http://repcached.lab.klab.org/): Multi-master async replication (memcached 1.2 patch set)
* [Couchbase memcached interface](http://www.couchbase.com/memcached): Use CouchBase as memcached drop-in
* [yrmcds](https://cybozu.github.io/yrmcds/): memcached compatible Master-Slave key value store
* [twemproxy](https://github.com/twitter/twemproxy) (aka nutcracker): proxy with memcached support

### Commands Cheat-Sheet

{% content-ref url="memcache-commands.md" %}
[memcache-commands.md](memcache-commands.md)
{% endcontent-ref %}

### **Shodan**

* `port:11211 "STAT pid"`
* `"STAT pid"`

## References

* [https://lzone.de/cheat-sheet/memcached](https://lzone.de/cheat-sheet/memcached)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
