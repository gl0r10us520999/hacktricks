# Memcache Commands

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Commands Cheat-Sheet

**From** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Οι υποστηριζόμενες εντολές (οι επίσημες και μερικές ανεπίσημες) είναι τεκμηριωμένες στο έγγραφο [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt).

Δυστυχώς, η περιγραφή σύνταξης δεν είναι πραγματικά σαφής και μια απλή εντολή βοήθειας που να απαριθμεί τις υπάρχουσες εντολές θα ήταν πολύ καλύτερη. Ακολουθεί μια επισκόπηση των εντολών που μπορείτε να βρείτε στην [πηγή](https://github.com/memcached/memcached) (από 19.08.2016):

| Command               | Description                                                     | Example                                                                                                                                                                                                                                     |
| --------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Διαβάζει μια τιμή                                              | `get mykey`                                                                                                                                                                                                                                 |
| set                   | Ορίζει ένα κλειδί χωρίς προϋποθέσεις                          | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Βεβαιωθείτε ότι χρησιμοποιείτε \r\n ως διαλείμματα γραμμών όταν χρησιμοποιείτε εργαλεία CLI Unix. Για παράδειγμα&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | Προσθέτει ένα νέο κλειδί                                       | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | Επαναγράφει το υπάρχον κλειδί                                 | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | Προσθέτει δεδομένα στο υπάρχον κλειδί                         | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | Προσθέτει δεδομένα πριν το υπάρχον κλειδί                     | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Αυξάνει την αριθμητική τιμή του κλειδιού κατά τον καθορισμένο αριθμό | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | Μειώνει την αριθμητική τιμή του κλειδιού κατά τον καθορισμένο αριθμό | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | Διαγράφει ένα υπάρχον κλειδί                                   | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | Ακυρώνει όλα τα στοιχεία άμεσα                                 | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Ακυρώνει όλα τα στοιχεία σε n δευτερόλεπτα                     | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Εκτυπώνει γενικά στατιστικά                                   | `stats`                                                                                                                                                                                                                                     |
|                       | Εκτυπώνει στατιστικά μνήμης                                    | `stats slabs`                                                                                                                                                                                                                               |
|                       | Εκτυπώνει στατιστικά υψηλότερης κατανομής                      | `stats malloc`                                                                                                                                                                                                                              |
|                       | Εκτυπώνει πληροφορίες για τα στοιχεία                          | `stats items`                                                                                                                                                                                                                               |
|                       |                                                                 | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                                 | `stats sizes`                                                                                                                                                                                                                               |
|                       | Επαναφέρει τους μετρητές στατιστικών                          | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Εξάγει (το μεγαλύτερο μέρος) των μεταδεδομένων για (όλα) τα στοιχεία στην κρυφή μνήμη | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Εκτυπώνει την έκδοση του διακομιστή.                          | `version`                                                                                                                                                                                                                                   |
| verbosity             | Αυξάνει το επίπεδο καταγραφής                                   | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Τερματίζει τη συνεδρία                                         | `quit`                                                                                                                                                                                                                                      |

#### Traffic Statistics <a href="#traffic-statistics" id="traffic-statistics"></a>

Μπορείτε να ερωτήσετε τα τρέχοντα στατιστικά κίνησης χρησιμοποιώντας την εντολή
```
stats
```
Θα λάβετε μια λίστα που παρέχει τον αριθμό των συνδέσεων, τα bytes εισόδου/εξόδου και πολλά άλλα.

Example Output:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Στατιστικά Μνήμης <a href="#memory-statistics" id="memory-statistics"></a>

Μπορείτε να ερωτήσετε τα τρέχοντα στατιστικά μνήμης χρησιμοποιώντας
```
stats slabs
```
```markdown
# Memcached Commands

## Basic Commands

### set
Αυτή η εντολή αποθηκεύει ένα στοιχείο στην μνήμη.

### get
Αυτή η εντολή ανακτά ένα στοιχείο από την μνήμη.

### delete
Αυτή η εντολή διαγράφει ένα στοιχείο από την μνήμη.

## Advanced Commands

### flush_all
Αυτή η εντολή καθαρίζει όλα τα στοιχεία από την μνήμη.

### stats
Αυτή η εντολή επιστρέφει στατιστικά στοιχεία για την κατάσταση του memcached.

### version
Αυτή η εντολή επιστρέφει την έκδοση του memcached που εκτελείται.
```
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Αν δεν είστε σίγουροι αν έχετε αρκετή μνήμη για την περίπτωση memcached σας, πάντα ελέγξτε τους μετρητές “evictions” που παρέχονται από την εντολή “stats”. Αν έχετε αρκετή μνήμη για την περίπτωση, ο μετρητής “evictions” θα πρέπει να είναι 0 ή τουλάχιστον να μην αυξάνεται.

#### Ποιοι Κωδικοί Χρησιμοποιούνται; <a href="#which-keys-are-used" id="which-keys-are-used"></a>

Δεν υπάρχει ενσωματωμένη λειτουργία για να προσδιορίσετε άμεσα το τρέχον σύνολο κωδικών. Ωστόσο, μπορείτε να χρησιμοποιήσετε την
```
stats items
```
```markdown
εντολή για να προσδιορίσετε πόσα κλειδιά υπάρχουν.
```
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Αυτό τουλάχιστον βοηθά να δούμε αν χρησιμοποιούνται κλειδιά. Για να εξάγετε τα ονόματα των κλειδιών από ένα σενάριο PHP που ήδη έχει πρόσβαση στο memcache, μπορείτε να χρησιμοποιήσετε τον κώδικα PHP από [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
