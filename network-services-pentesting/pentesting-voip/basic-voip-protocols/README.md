# Basic VoIP Protocols

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
{% endhint %}

## Signaling Protocols

### SIP (Session Initiation Protocol)

Αυτό είναι το βιομηχανικό πρότυπο, για περισσότερες πληροφορίες ελέγξτε:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) είναι ένα **πρωτόκολλο σήμανσης** και **ελέγχου κλήσεων** που περιγράφεται στο RFC 3435. Λειτουργεί σε μια κεντρική αρχιτεκτονική, η οποία αποτελείται από τρία κύρια στοιχεία:

1. **Call Agent ή Media Gateway Controller (MGC)**: Η κύρια πύλη στην αρχιτεκτονική MGCP είναι υπεύθυνη για **τη διαχείριση και τον έλεγχο των πύλων πολυμέσων**. Διαχειρίζεται τις διαδικασίες εγκατάστασης, τροποποίησης και τερματισμού κλήσεων. Ο MGC επικοινωνεί με τις πύλες πολυμέσων χρησιμοποιώντας το πρωτόκολλο MGCP.
2. **Media Gateways (MGs) ή Slave Gateways**: Αυτές οι συσκευές **μετατρέπουν ψηφιακά ρεύματα πολυμέσων μεταξύ διαφορετικών δικτύων**, όπως η παραδοσιακή τηλεφωνία κυκλωμάτων και τα δίκτυα IP με πακέτα. Διαχειρίζονται από τον MGC και εκτελούν τις εντολές που λαμβάνουν από αυτόν. Οι πύλες πολυμέσων μπορεί να περιλαμβάνουν λειτουργίες όπως η μετατροπή, η πακετοποίηση και η ακύρωση ηχούς.
3. **Signaling Gateways (SGs)**: Αυτές οι πύλες είναι υπεύθυνες για **τη μετατροπή μηνυμάτων σήμανσης μεταξύ διαφορετικών δικτύων**, επιτρέποντας την απρόσκοπτη επικοινωνία μεταξύ παραδοσιακών τηλεφωνικών συστημάτων (π.χ. SS7) και δικτύων IP (π.χ. SIP ή H.323). Οι πύλες σήμανσης είναι κρίσιμες για την διαλειτουργικότητα και τη διασφάλιση ότι οι πληροφορίες ελέγχου κλήσεων επικοινωνούνται σωστά μεταξύ των διαφορετικών δικτύων.

Συνοπτικά, το MGCP κεντρικοποιεί τη λογική ελέγχου κλήσεων στον πράκτορα κλήσεων, απλοποιώντας τη διαχείριση των πύλων πολυμέσων και σήμανσης, παρέχοντας καλύτερη κλιμάκωση, αξιοπιστία και αποδοτικότητα στα τηλεπικοινωνιακά δίκτυα.

### SCCP (Skinny Client Control Protocol)

Το Skinny Client Control Protocol (SCCP) είναι ένα **ιδιόκτητο πρωτόκολλο σήμανσης και ελέγχου κλήσεων** που ανήκει στην Cisco Systems. Χρησιμοποιείται κυρίως για την επικοινωνία μεταξύ του **Cisco Unified Communications Manager** (πρώην γνωστός ως CallManager) και των IP τηλεφώνων της Cisco ή άλλων τερματικών φωνής και βίντεο της Cisco.

Το SCCP είναι ένα ελαφρύ πρωτόκολλο που απλοποιεί την επικοινωνία μεταξύ του διακομιστή ελέγχου κλήσεων και των τερματικών συσκευών. Αναφέρεται ως "Skinny" λόγω του μινιμαλιστικού σχεδιασμού του και των μειωμένων απαιτήσεων εύρους ζώνης σε σύγκριση με άλλα πρωτόκολλα VoIP όπως το H.323 ή το SIP.

Τα κύρια στοιχεία ενός συστήματος βασισμένου σε SCCP είναι:

1. **Call Control Server**: Αυτός ο διακομιστής, συνήθως ένας Cisco Unified Communications Manager, διαχειρίζεται τις διαδικασίες εγκατάστασης, τροποποίησης και τερματισμού κλήσεων, καθώς και άλλες τηλεφωνικές δυνατότητες όπως η προώθηση κλήσεων, η μεταφορά κλήσεων και η αναμονή κλήσεων.
2. **SCCP Endpoints**: Αυτές είναι συσκευές όπως IP τηλέφωνα, μονάδες τηλεδιάσκεψης ή άλλες τερματικές συσκευές φωνής και βίντεο της Cisco που χρησιμοποιούν το SCCP για να επικοινωνούν με τον διακομιστή ελέγχου κλήσεων. Εγγράφονται στον διακομιστή, στέλνουν και λαμβάνουν μηνύματα σήμανσης και ακολουθούν τις οδηγίες που παρέχονται από τον διακομιστή ελέγχου κλήσεων για τη διαχείριση κλήσεων.
3. **Gateways**: Αυτές οι συσκευές, όπως οι πύλες φωνής ή οι πύλες πολυμέσων, είναι υπεύθυνες για τη μετατροπή ρευμάτων πολυμέσων μεταξύ διαφορετικών δικτύων, όπως η παραδοσιακή τηλεφωνία κυκλωμάτων και τα δίκτυα IP με πακέτα. Μπορεί επίσης να περιλαμβάνουν πρόσθετη λειτουργικότητα, όπως η μετατροπή ή η ακύρωση ηχούς.

Το SCCP προσφέρει μια απλή και αποδοτική μέθοδο επικοινωνίας μεταξύ των διακομιστών ελέγχου κλήσεων της Cisco και των τερματικών συσκευών. Ωστόσο, αξίζει να σημειωθεί ότι **το SCCP είναι ένα ιδιόκτητο πρωτόκολλο**, το οποίο μπορεί να περιορίσει τη διαλειτουργικότητα με μη συστήματα της Cisco. Σε τέτοιες περιπτώσεις, άλλα πρότυπα VoIP όπως το SIP μπορεί να είναι πιο κατάλληλα.

### H.323

Το H.323 είναι μια **σουίτα πρωτοκόλλων** για πολυμεσική επικοινωνία, συμπεριλαμβανομένων φωνής, βίντεο και συνεδριάσεων δεδομένων μέσω δικτύων με πακέτα, όπως τα δίκτυα IP. Αναπτύχθηκε από την **Διεθνή Ένωση Τηλεπικοινωνιών** (ITU-T) και παρέχει ένα ολοκληρωμένο πλαίσιο για τη διαχείριση πολυμεσικών συνεδριών επικοινωνίας.

Ορισμένα βασικά στοιχεία της σουίτας H.323 περιλαμβάνουν:

1. **Terminals**: Αυτές είναι τερματικές συσκευές, όπως IP τηλέφωνα, συστήματα τηλεδιάσκεψης ή λογισμικά εφαρμογών, που υποστηρίζουν το H.323 και μπορούν να συμμετάσχουν σε πολυμεσικές συνεδρίες επικοινωνίας.
2. **Gateways**: Αυτές οι συσκευές μετατρέπουν ρεύματα πολυμέσων μεταξύ διαφορετικών δικτύων, όπως η παραδοσιακή τηλεφωνία κυκλωμάτων και τα δίκτυα IP με πακέτα, επιτρέποντας τη διαλειτουργικότητα μεταξύ του H.323 και άλλων συστημάτων επικοινωνίας. Μπορεί επίσης να περιλαμβάνουν πρόσθετη λειτουργικότητα, όπως η μετατροπή ή η ακύρωση ηχούς.
3. **Gatekeepers**: Αυτά είναι προαιρετικά στοιχεία που παρέχουν υπηρεσίες ελέγχου και διαχείρισης κλήσεων σε ένα δίκτυο H.323. Εκτελούν λειτουργίες όπως η μετάφραση διευθύνσεων, η διαχείριση εύρους ζώνης και ο έλεγχος εισόδου, βοηθώντας στη διαχείριση και βελτιστοποίηση των πόρων του δικτύου.
4. **Multipoint Control Units (MCUs)**: Αυτές οι συσκευές διευκολύνουν τις πολυμερείς συνεδρίες διαχειριζόμενες και αναμειγνύοντας ρεύματα πολυμέσων από πολλαπλές τερματικές συσκευές. Οι MCUs επιτρέπουν δυνατότητες όπως ο έλεγχος διάταξης βίντεο, η εναλλαγή με ενεργοποίηση φωνής και η συνεχής παρουσία, καθιστώντας δυνατή τη φιλοξενία μεγάλων συνεδριών με πολλούς συμμετέχοντες.

Το H.323 υποστηρίζει μια σειρά από κωδικοποιητές ήχου και βίντεο, καθώς και άλλες συμπληρωματικές υπηρεσίες όπως η προώθηση κλήσεων, η μεταφορά κλήσεων, η αναμονή κλήσεων και η αναμονή κλήσεων. Παρά την ευρεία υιοθέτησή του στις πρώτες ημέρες του VoIP, το H.323 έχει σταδιακά αντικατασταθεί από πιο σύγχρονα και ευέλικτα πρωτόκολλα όπως το **Session Initiation Protocol (SIP)**, το οποίο προσφέρει καλύτερη διαλειτουργικότητα και ευκολότερη υλοποίηση. Ωστόσο, το H.323 παραμένει σε χρήση σε πολλά κληρονομικά συστήματα και συνεχίζει να υποστηρίζεται από διάφορους προμηθευτές εξοπλισμού.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) είναι ένα **πρωτόκολλο σήμανσης και ελέγχου κλήσεων** που χρησιμοποιείται κυρίως για την επικοινωνία μεταξύ των διακομιστών Asterisk PBX (Private Branch Exchange) και άλλων συσκευών VoIP. Αναπτύχθηκε από τον Mark Spencer, τον δημιουργό του λογισμικού Asterisk open-source PBX, ως εναλλακτική λύση σε άλλα πρωτόκολλα VoIP όπως το SIP και το H.323.

Το IAX είναι γνωστό για την **απλότητά του, την αποδοτικότητα και την ευκολία υλοποίησης**. Ορισμένα βασικά χαρακτηριστικά του IAX περιλαμβάνουν:

1. **Single UDP Port**: Το IAX χρησιμοποιεί μια μόνο θύρα UDP (4569) για τη σήμανση και την κυκλοφορία πολυμέσων, γεγονός που απλοποιεί την παρακολούθηση τείχους προστασίας και NAT, διευκολύνοντας την ανάπτυξή του σε διάφορα περιβάλλοντα δικτύου.
2. **Binary Protocol**: Σε αντίθεση με τα πρωτόκολλα κειμένου όπως το SIP, το IAX είναι ένα δυαδικό πρωτόκολλο, το οποίο μειώνει την κατανάλωση εύρους ζώνης και το καθιστά πιο αποδοτικό για τη μετάδοση δεδομένων σήμανσης και πολυμέσων.
3. **Trunking**: Το IAX υποστηρίζει το trunking, το οποίο επιτρέπει σε πολλές κλήσεις να συνδυάζονται σε μια μόνο σύνδεση δικτύου, μειώνοντας την υπερβολική φόρτωση και βελτιώνοντας τη χρησιμοποίηση του εύρους ζώνης.
4. **Native Encryption**: Το IAX έχει ενσωματωμένη υποστήριξη για κρυπτογράφηση, χρησιμοποιώντας μεθόδους όπως το RSA για την ανταλλαγή κλειδιών και το AES για την κρυπτογράφηση πολυμέσων, παρέχοντας ασφαλή επικοινωνία μεταξύ των τερματικών.
5. **Peer-to-Peer Communication**: Το IAX μπορεί να χρησιμοποιηθεί για άμεση επικοινωνία μεταξύ τερματικών χωρίς την ανάγκη κεντρικού διακομιστή, επιτρέποντας απλούστερη και πιο αποδοτική δρομολόγηση κλήσεων.

Παρά τα οφέλη του, το IAX έχει ορισμένους περιορισμούς, όπως η κύρια εστίαση στο οικοσύστημα Asterisk και η λιγότερη ευρεία υιοθέτηση σε σύγκριση με πιο καθιερωμένα πρωτόκολλα όπως το SIP. Ως αποτέλεσμα, το IAX μπορεί να μην είναι η καλύτερη επιλογή για διαλειτουργικότητα με μη συστήματα ή συσκευές Asterisk. Ωστόσο, για όσους εργάζονται στο περιβάλλον Asterisk, το IAX προσφέρει μια robust και αποδοτική λύση για την επικοινωνία VoIP.

## Transmission & Transport Protocols

### SDP (Session Description Protocol)

SDP (Session Description Protocol) είναι μια **μορφή βασισμένη σε κείμενο** που χρησιμοποιείται για να περιγράψει τα χαρακτηριστικά των πολυμεσικών συνεδριών, όπως φωνής, βίντεο ή συνεδριάσεις δεδομένων, μέσω δικτύων IP. Αναπτύχθηκε από την **Internet Engineering Task Force (IETF)** και ορίζεται στο **RFC 4566**. Το SDP δεν χειρίζεται τη μετάδοση πολυμέσων ή την εγκατάσταση συνεδριών, αλλά χρησιμοποιείται σε συνδυασμό με άλλα πρωτόκολλα σήμανσης, όπως το **SIP (Session Initiation Protocol)**, για να διαπραγματευτεί και να ανταλλάξει πληροφορίες σχετικά με τα ρεύματα πολυμέσων και τα χαρακτηριστικά τους.

Ορισμένα βασικά στοιχεία του SDP περιλαμβάνουν:

1. **Session Information**: Το SDP περιγράφει τις λεπτομέρειες μιας πολυμεσικής συνεδρίας, συμπεριλαμβανομένου του ονόματος της συνεδρίας, της περιγραφής της συνεδρίας, της ώρας έναρξης και της ώρας λήξης.
2. **Media Streams**: Το SDP ορίζει τα χαρακτηριστικά των ρευμάτων πολυμέσων, όπως ο τύπος πολυμέσων (ήχος, βίντεο ή κείμενο), το πρωτόκολλο μεταφοράς (π.χ. RTP ή SRTP) και τη μορφή πολυμέσων (π.χ. πληροφορίες κωδικοποιητή).
3. **Connection Information**: Το SDP παρέχει πληροφορίες σχετικά με τη διεύθυνση δικτύου (διεύθυνση IP) και τον αριθμό θύρας όπου πρέπει να σταλούν ή να ληφθούν τα πολυμέσα.
4. **Attributes**: Το SDP υποστηρίζει τη χρήση χαρακτηριστικών για την παροχή πρόσθετων, προαιρετικών πληροφοριών σχετικά με μια συνεδρία ή ρεύμα πολυμέσων. Τα χαρακτηριστικά μπορούν να χρησιμοποιηθούν για τον καθορισμό διαφόρων λειτουργιών όπως κλειδιά κρυπτογράφησης, απαιτήσεις εύρους ζώνης ή μηχανισμούς ελέγχου πολυμέσων.

Το SDP χρησιμοποιείται συνήθως στη διαδικασία:

1. Ένα αρχικό μέρος δημιουργεί μια περιγραφή SDP της προτεινόμενης πολυμεσικής συνεδρίας, συμπεριλαμβανομένων των λεπτομερειών των ρευμάτων πολυμέσων και των χαρακτηριστικών τους.
2. Η περιγραφή SDP αποστέλλεται στο παραλαμβάνον μέρος, συνήθως ενσωματωμένη σε ένα μήνυμα πρωτοκόλλου σήμανσης όπως το SIP ή το RTSP.
3. Το παραλαμβάνον μέρος επεξεργάζεται την περιγραφή SDP και, με βάση τις δυνατότητές του, μπορεί να αποδεχθεί, να απορρίψει ή να τροποποιήσει την προτεινόμενη συνεδρία.
4. Η τελική περιγραφή SDP αποστέλλεται πίσω στο αρχικό μέρος ως μέρος του μηνύματος πρωτοκόλλου σήμανσης, ολοκληρώνοντας τη διαδικασία διαπραγμάτευσης.

Η απλότητα και η ευελιξία του SDP το καθιστούν ένα ευρέως υιοθετημένο πρότυπο για την περιγραφή πολυμεσικών συνεδριών σε διάφορα συστήματα επικοινωνίας, παίζοντας κρίσιμο ρόλο στην εγκατάσταση και διαχείριση πραγματικών πολυμεσικών συνεδριών μέσω δικτύων IP.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: Το RTP είναι ένα πρωτόκολλο δικτύου σχεδιασμένο για την παράδοση ήχου και βίντεο δεδομένων, ή άλλων πραγματικών πολυμέσων, μέσω δικτύων IP. Αναπτύχθηκε από την **IETF** και ορίζεται στο **RFC 3550**, το RTP χρησιμοποιείται συνήθως με πρωτόκολλα σήμανσης όπως το SIP και το H.323 για να επιτρέψει την πολυμεσική επικοινωνία. Το RTP παρέχει μηχανισμούς για **συγχρονισμό**, **αλληλουχία** και **χρονοσήμανση** των ρευμάτων πολυμέσων, βοηθώντας να διασφαλιστεί η ομαλή και έγκαιρη αναπαραγωγή πολυμέσων.
2. **RTCP (Real-time Transport Control Protocol)**: Το RTCP είναι ένα συνοδευτικό πρωτόκολλο του RTP, που χρησιμοποιείται για την παρακολούθηση της ποιότητας υπηρεσίας (QoS) και την παροχή ανατροφοδότησης σχετικά με τη μετάδοση των ρευμάτων πολυμέσων. Οριζόμενο στο ίδιο **RFC 3550** με το RTP, το RTCP **ανταλλάσσει περιοδικά πακέτα ελέγχου μεταξύ των συμμετεχόντων σε μια συνεδρία RTP**. Μοιράζεται πληροφορίες όπως η απώλεια πακέτων, η τζιτερ και ο χρόνος round-trip, που βοηθούν στη διάγνωση και προσαρμογή στις συνθήκες του δικτύου, βελτιώνοντας τη συνολική ποιότητα των πολυμέσων.
3. **SRTP (Secure Real-time Transport Protocol)**: Το SRTP είναι μια επέκταση του RTP που παρέχει **κρυπτογράφηση**, **αυθεντικοποίηση μηνυμάτων** και **προστασία επανάληψης** για ρεύματα πολυμέσων, διασφαλίζοντας ασφαλή μετάδοση ευαίσθητων δεδομένων ήχου και βίντεο. Οριζόμενο στο **RFC 3711**, το SRTP χρησιμοποιεί κρυπτογραφικούς αλγόριθμους όπως το AES για κρυπτογράφηση και το HMAC-SHA1 για αυθεντικοποίηση μηνυμάτων. Το SRTP χρησιμοποιείται συχνά σε συνδυασμό με ασφαλή πρωτόκολλα σήμανσης όπως το SIP μέσω TLS για να παρέχει ασφάλεια από άκρο σε άκρο στην πολυμεσική επικοινωνία.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: Το ZRTP είναι ένα πρωτόκολλο κρυπτογραφικής συμφωνίας κλειδιών που παρέχει **κρυπτογράφηση από άκρο σε άκρο** για ρεύματα πολυμέσων RTP. Αναπτύχθηκε από τον Phil Zimmermann, τον δημιουργό του PGP, το ZRTP περιγράφεται στο **RFC 6189**. Σε αντίθεση με το SRTP, το οποίο βασίζεται σε πρωτόκολλα σήμανσης για την ανταλλαγή κλειδιών, το ZRTP έχει σχεδιαστεί για να λειτουργεί ανεξάρτητα από το πρωτόκολλο σήμανσης. Χρησιμοποιεί **την ανταλλαγή κλειδιών Diffie-Hellman** για να καθορίσει ένα κοινό μυστικό μεταξύ των επικοινωνούντων μερών, χωρίς να απαιτεί προηγούμενη εμπιστοσύνη ή υποδομή δημόσιων κλειδιών (PKI). Το ZRTP περιλαμβάνει επίσης χαρακτηριστικά όπως **Σύντομες Αυθεντικές Συγκρίσεις (SAS)** για την προστασία από επιθέσεις man-in-the-middle.

Αυτά τα πρωτόκολλα παίζουν ουσιαστικούς ρόλους στην **παράδοση και ασφάλιση πραγματικής πολυμεσικής επικοινωνίας μέσω δικτύων IP**. Ενώ το RTP και το RTCP χειρίζονται την πραγματική μετάδοση πολυμέσων και την παρακολούθηση ποιότητας, το SRTP και το ZRTP διασφαλίζουν ότι τα μεταδιδόμενα πολυμέσα προστατεύονται από υποκλοπές, αλλοιώσεις και επιθέσεις επανάληψης.

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
</details>
{% endhint %}
