# 403 & 401 Bypasses

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtze HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Erhalte die Perspektive eines Hackers auf deine Webanwendungen, Netzwerke und Cloud**

**Finde und melde kritische, ausnutzbare Sicherheitsanf√§lligkeiten mit echtem Gesch√§ftsauswirkungen.** Nutze unsere 20+ benutzerdefinierten Tools, um die Angriffsfl√§che zu kartieren, Sicherheitsprobleme zu finden, die dir erm√∂glichen, Privilegien zu eskalieren, und automatisierte Exploits zu verwenden, um wesentliche Beweise zu sammeln, die deine harte Arbeit in √ºberzeugende Berichte verwandeln.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## HTTP Verbs/Methods Fuzzing

Versuche, **verschiedene Verben** zu verwenden, um auf die Datei zuzugreifen: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* √úberpr√ºfe die Antwort-Header, vielleicht k√∂nnen einige Informationen gegeben werden. Zum Beispiel bedeutet eine **200-Antwort** auf **HEAD** mit `Content-Length: 55`, dass das **HEAD-Verb auf die Info zugreifen kann**. Aber du musst immer noch einen Weg finden, diese Info zu exfiltrieren.
* Die Verwendung eines HTTP-Headers wie `X-HTTP-Method-Override: PUT` kann das verwendete Verb √ºberschreiben.
* Verwende das **`TRACE`**-Verb und wenn du sehr viel Gl√ºck hast, kannst du vielleicht in der Antwort auch die **von Zwischenproxies hinzugef√ºgten Header** sehen, die n√ºtzlich sein k√∂nnten.

## HTTP Headers Fuzzing

* **√Ñndere den Host-Header** auf einen beliebigen Wert ([das hat hier funktioniert](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* Versuche, [**andere User Agents**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) zu verwenden, um auf die Ressource zuzugreifen.
* **Fuzz HTTP-Header**: Versuche, HTTP-Proxy-**Header**, HTTP-Authentifizierung Basic und NTLM-Brute-Force (nur mit wenigen Kombinationen) und andere Techniken zu verwenden. Um all dies zu tun, habe ich das Tool [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass) erstellt.

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

Wenn der **Pfad gesch√ºtzt ist**, kannst du versuchen, den Pfadschutz mit diesen anderen Headern zu umgehen:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* Wenn die Seite **hinter einem Proxy** ist, k√∂nnte es der Proxy sein, der dir den Zugriff auf die privaten Informationen verweigert. Versuche, [**HTTP Request Smuggling**](../../pentesting-web/http-request-smuggling/) **oder** [**Hop-by-Hop-Header**](../../pentesting-web/abusing-hop-by-hop-headers.md)** auszunutzen.**
* Fuzz [**spezielle HTTP-Header**](special-http-headers.md) auf der Suche nach unterschiedlichen Antworten.
* **Fuzz spezielle HTTP-Header**, w√§hrend du **HTTP-Methoden** fuzzst.
* **Entferne den Host-Header** und vielleicht kannst du den Schutz umgehen.

## Path **Fuzzing**

Wenn _/path_ blockiert ist:

* Versuche, _**/**_**%2e/path \_(wenn der Zugriff durch einen Proxy blockiert wird, k√∂nnte dies den Schutz umgehen). Versuche auch**\_\*\* /%252e\*\*/path (doppelte URL-Kodierung)
* Versuche **Unicode-Umgehung**: _/**%ef%bc%8f**path_ (Die URL-kodierten Zeichen sind wie "/"), sodass es beim Zur√ºckkodieren _//path_ sein wird und du m√∂glicherweise bereits die _/path_-Namenspr√ºfung umgangen hast.
* **Andere Pfad-Umgehungen**:
* site.com/secret ‚Äì> HTTP 403 Forbidden
* site.com/SECRET ‚Äì> HTTP 200 OK
* site.com/secret/ ‚Äì> HTTP 200 OK
* site.com/secret/. ‚Äì> HTTP 200 OK
* site.com//secret// ‚Äì> HTTP 200 OK
* site.com/./secret/.. ‚Äì> HTTP 200 OK
* site.com/;/secret ‚Äì> HTTP 200 OK
* site.com/.;/secret ‚Äì> HTTP 200 OK
* site.com//;//secret ‚Äì> HTTP 200 OK
* site.com/secret.json ‚Äì> HTTP 200 OK (ruby)
* Verwende [**diese Liste**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) in den folgenden Situationen:
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **Andere API-Umgehungen:**
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Unauthorisiert
* {‚Äúid‚Äù:\[111]} --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Unauthorisiert
* {‚Äúid‚Äù:{‚Äúid‚Äù:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSON Parameter Pollution)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (Parameter Pollution)

## **Parameter Manipulation**

* √Ñndere **param Wert**: Von **`id=123` --> `id=124`**
* F√ºge zus√§tzliche Parameter zur URL hinzu: `?`**`id=124` ‚Äî-> `id=124&isAdmin=true`**
* Entferne die Parameter
* √Ñndere die Reihenfolge der Parameter
* Verwende Sonderzeichen.
* F√ºhre Grenzwerttests in den Parametern durch ‚Äî gib Werte wie _-234_ oder _0_ oder _99999999_ (nur einige Beispielwerte) an.

## **Protokollversion**

Wenn du HTTP/1.1 verwendest, **versuche 1.0** oder teste sogar, ob es **2.0 unterst√ºtzt**.

## **Andere Umgehungen**

* Hole die **IP** oder **CNAME** der Domain und versuche, **sie direkt zu kontaktieren**.
* Versuche, den **Server zu belasten**, indem du g√§ngige GET-Anfragen sendest ([Es hat f√ºr diesen Typen mit Facebook funktioniert](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **√Ñndere das Protokoll**: von http zu https oder von https zu http
* Gehe zu [**https://archive.org/web/**](https://archive.org/web/) und √ºberpr√ºfe, ob die Datei in der Vergangenheit **weltweit zug√§nglich** war.

## **Brute Force**

* **Rate das Passwort**: Teste die folgenden g√§ngigen Anmeldedaten. Wei√üt du etwas √ºber das Opfer? Oder den Namen der CTF-Herausforderung?
* [**Brute Force**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** Versuche Basic-, Digest- und NTLM-Authentifizierung.

{% code title="Common creds" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## Automatische Werkzeuge

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp-Erweiterung - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
* [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="/.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Erhalten Sie die Perspektive eines Hackers auf Ihre Webanwendungen, Ihr Netzwerk und die Cloud**

**Finden und melden Sie kritische, ausnutzbare Sicherheitsanf√§lligkeiten mit echtem Gesch√§ftsauswirkungen.** Verwenden Sie unsere 20+ benutzerdefinierten Werkzeuge, um die Angriffsfl√§che zu kartieren, Sicherheitsprobleme zu finden, die Ihnen erm√∂glichen, Berechtigungen zu eskalieren, und automatisierte Exploits zu verwenden, um wesentliche Beweise zu sammeln, die Ihre harte Arbeit in √ºberzeugende Berichte umwandeln.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos senden.

</details>
{% endhint %}
