# 80,443 - Pentesting Web Methodology

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug bounty tip**: **sign up** for **Intigriti**, a premium **bug bounty platform created by hackers, for hackers**! Join us at [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) today, and start earning bounties up to **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## Basic Info

The web service is the most **common and extensive service** and a lot of **different types of vulnerabilities** exists.

**Default port:** 80 (HTTP), 443(HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### Web API Qap

{% content-ref url="web-api-pentesting.md" %}
[web-api-pentesting.md](web-api-pentesting.md)
{% endcontent-ref %}

## Methodology summary

> jImejDaq jImejDaq 'e' vItlhutlh. 'ej, 'oH jImejDaq jImejDaq 'e' vItlhutlh. So, jImejDaq jImejDaq 'e' vItlhutlh, jImejDaq jImejDaq 'e' vItlhutlh, 'ej IP jImejDaq jImejDaq 'e' vItlhutlh.

* [ ] **jImejDaq** jImejDaq **jImejDaq** jImejDaq. **jImejDaq** jImejDaq **jImejDaq** jImejDaq 'ej **jImejDaq** jImejDaq **jImejDaq** jImejDaq.
* [ ] **jImejDaq** **jImejDaq** jImejDaq? **jImejDaq** **jImejDaq** jImejDaq **jImejDaq** jImejDaq.
* [ ] **jImejDaq** **jImejDaq** jImejDaq? **jImejDaq** **jImejDaq** jImejDaq **jImejDaq** jImejDaq.
* [ ] **jImejDaq** **jImejDaq** jImejDaq (vaj wpscan)?
* [ ] **jImejDaq** **jImejDaq** jImejDaq. **jImejDaq** jImejDaq **jImejDaq** jImejDaq 'ej **jImejDaq** jImejDaq **jImejDaq** jImejDaq.
* [ ] **jImejDaq** **jImejDaq**: **robots**, **sitemap**, **404** 'ej **SSL/TLS scan** (HTTPS vaj).
* [ ] **jImejDaq** **jImejDaq** jImejDaq: **jImejDaq** **jImejDaq** **jImejDaq**, **jImejDaq** 'ej **jImejDaq** **jImejDaq**. **jImejDaq** **jImejDaq** jImejDaq.
* [ ] _**jImejDaq** jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jImejDaq jIm
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
**vulnerabilities of the web application version** **Search** **for**

### **Check if any WAF**

* [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
* [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
* [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### Web tech tricks

Some **tricks** for **finding vulnerabilities** in different well known **technologies** being used:

* [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
* [**Apache**](apache.md)
* [**Artifactory**](artifactory-hacking-guide.md)
* [**Buckets**](buckets/)
* [**CGI**](cgi.md)
* [**Drupal**](drupal.md)
* [**Flask**](flask.md)
* [**Git**](git.md)
* [**Golang**](golang.md)
* [**GraphQL**](graphql.md)
* [**H2 - Java SQL database**](h2-java-sql-database.md)
* [**IIS tricks**](iis-internet-information-services.md)
* [**JBOSS**](jboss.md)
* [**Jenkins**](broken-reference/)
* [**Jira**](jira.md)
* [**Joomla**](joomla.md)
* [**JSP**](jsp.md)
* [**Laravel**](laravel.md)
* [**Moodle**](moodle.md)
* [**Nginx**](nginx.md)
* [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/)
* [**Python**](python.md)
* [**Spring Actuators**](spring-actuators.md)
* [**Symphony**](symphony.md)
* [**Tomcat**](tomcat.md)
* [**VMWare**](vmware-esx-vcenter....md)
* [**Web API Pentesting**](web-api-pentesting.md)
* [**WebDav**](put-method-webdav.md)
* [**Werkzeug**](werkzeug.md)
* [**Wordpress**](wordpress.md)
* [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/)

_Take into account that the **same domain** can be using **different technologies** in different **ports**, **folders** and **subdomains**._\
If the web application is using any well known **tech/platform listed before** or **any other**, don't forget to **search on the Internet** new tricks (and let me know!).

### Source Code Review

If the **source code** of the application is available in **github**, apart of performing by **your own a White box test** of the application there is **some information** that could be **useful** for the current **Black-Box testing**:

* Is there a **Change-log or Readme or Version** file or anything with **version info accessible** via web?
* How and where are saved the **credentials**? Is there any (accessible?) **file** with credentials (usernames or passwords)?
* Are **passwords** in **plain text**, **encrypted** or which **hashing algorithm** is used?
* Is it using any **master key** for encrypting something? Which **algorithm** is used?
* Can you **access any of these files** exploiting some vulnerability?
* Is there any **interesting information in the github** (solved and not solved) **issues**? Or in **commit history** (maybe some **password introduced inside an old commit**)?

{% content-ref url="code-review-tools.md" %}
[code-review-tools.md](code-review-tools.md)
{% endcontent-ref %}

### Automatic scanners

#### General purpose automatic scanners
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### CMS scanners

If a CMS is used don't forget to **run a scanner**, maybe something juicy is found:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat.md)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal.md), **Joomla**, **vBulletin** websites for Security issues. (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal.md)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal.md) **or** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal.md)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> **ghItlhvam** vaj **web server** **ghaH** **ghItlhvam** **(data** **Dochvam)** **'ej** **qaStaHvIS** **vaj** **web application** **ghItlhvam** **qar**.

### **web application** **ghItlhvam** **Step-by-step**

> **web application** **ghItlhvam** **ghaH** **qaStaHvIS** **ghItlhvam**.

#### **qaStaHvIS** **chegh**

**Default pages** **vaj** **qawHaq** **ghItlhvam**:

* /robots.txt
* /sitemap.xml
* /crossdomain.xml
* /clientaccesspolicy.xml
* /.well-known/
* **ghItlhvam** **'ej** **qar** **ghItlhvam** **ghItlhvam** **ghItlhvam**.

**vaj** **'e'** **ghItlhvam**

**web server** **qaStaHvIS** **ghItlhvam** **ghaH** **'e'** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam**.

* **fake pages** **ghItlhvam** /whatever\_fake.php (.aspx,.html,.etc)
* **"\[]", "]]", 'ej "\[\["** **ghItlhvam** **cookie values** **'ej** **parameter** **values** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam**
* **`/~randomthing/%s`** **URL** **'ej** **input** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam**
* **HTTP Verbs** **ghItlhvam** **PATCH, DEBUG** **ghItlhvam** **FAKE** **ghItlhvam**

#### **'e'** **upload files** **ghItlhvam** (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

**WebDav** **ghItlhvam** **ghaH** **'e'** **ghItlhvam** **'ej** **root folder** **uploading files** **ghItlhvam** **ghItlhvam**:

* **Brute Force** **credentials** **ghItlhvam**
* **Upload files** **WebDav** **rest** **found folders** **web page** **ghItlhvam** **ghItlhvam** **ghItlhvam** **ghItlhvam**

### **SSL/TLS vulnerabilites**

* **application** **'e'** **HTTPS** **vaj** **ghItlhvam** **'ej** **MitM** **vulnerability** **ghItlhvam**
* **application** **'e'** **sensitive data (passwords)** **HTTP** **vaj** **ghItlhvam** **vulnerability** **ghItlhvam**

**testssl.sh** **ghItlhvam** **vulnerabilities** **(Bug Bounty programs** **vaj** **vulnerabilities)** **ghItlhvam** **a2sv** **ghItlhvam** **vulnerabilities** **recheck** **ghItlhvam**:
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
### SSL/TLS vulnerabilities

* [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
* [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

**Qa'vIn** **spider** **web**. **Spider** **web** **paths** **find** **as much as possible**. **Web crawling** **external sources** **paths** **find** **as much as possible**.

* [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML **spider**, LinkFinder **JS** **files** **external sources** (Archive.org, CommonCrawl.org, VirusTotal.com, AlienVault.com).
* [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HML **spider**, LinkFider **JS** **files** **Archive.org** **external source**.
* [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML **spider**, "juicy files" **indicate**.
* [**evine** ](https://github.com/saeeddhqan/evine)(go): Interactive CLI HTML **spider**. **Archive.org** **search**.
* [**meg**](https://github.com/tomnomnom/meg) (go): **tool** **spider** **useful**. **indicate** **file** **hosts** **file** **paths** **meg** **fetch** **path** **host** **save** **response**.
* [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): HTML **spider** **JS** **rendering** **capabilities**. **unmaintained**, **precompiled version** **old** **current code** **compile**.
* [**gau**](https://github.com/lc/gau) (go): HTML **spider** **external providers** (wayback, otx, commoncrawl).
* [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): **script** **find** **URLs** **parameter** **list**.
* [**galer**](https://github.com/dwisiswant0/galer) (go): HTML **spider** **JS** **rendering** **capabilities**.
* [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML **spider**, **JS** **beautify** **capabilities** **search** **paths** **JS** **files**. **look** **JSScanner** **wrapper** **LinkFinder**.
* [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): **extract** **endpoints** **HTML source** **embedded javascript files**. **useful** **bug hunters**, **red teamers**, **infosec ninjas**.
* [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): **python 2.7 script** **Tornado** **JSBeautifier** **parse** **relative URLs** **JavaScript files**. **easily discover** **AJAX requests**. **unmaintained**.
* [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): **file** (HTML) **extract** **URLs** **nifty regular expression** **find** **extract** **relative URLs** **ugly (minify) files**.
* [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, several tools): **Gather** **interesting information** **JS** **files** **several tools**.
* [**subjs**](https://github.com/lc/subjs) (go): **Find** **JS** **files**.
* [**page-fetch**](https://github.com/detectify/page-fetch) (go): **Load** **page** **headless browser** **print** **urls** **load** **page**.
* [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): **Content discovery tool** **mixing** **options** **previous tools**.
* [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): **Burp extension** **find** **path** **params** **JS** **files**.
* [**Sourcemapper**](https://github.com/denandz/sourcemapper): **tool** **.js.map URL** **beatified JS code**.
* [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): **tool** **discover endpoints** **given target**.
* [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** **Discover links** **wayback machine** **download** **responses** **wayback** **look** **links**.
* [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): **Crawl** (even **filling forms**) **find** **sensitive info** **specific regexes**.
* [**SpiderSuite**](https://github.com/3nock/SpiderSuite): **Spider Suite** **advance multi-feature GUI web security Crawler/Spider** **designed** **cyber security professionals**.
* [**jsluice**](https://github.com/BishopFox/jsluice) (go): **Go package** **command-line tool** **extracting URLs**, **paths**, **secrets**, **interesting data** **JavaScript source code**.
* [**ParaForge**](https://github.com/Anof-cyber/ParaForge): **ParaForge** **simple** **Burp Suite extension** **extract** **paramters** **endpoints** **request** **create custom wordlist** **fuzzing** **enumeration**.

### Brute Force directories and files

**Brute-force** **root folder** **brute-force** **directories found** **method** **directories discovered** **Spidering** (**brute-forcing recursively** **appending** **beginning** **used wordlist** **names** **found directories**).\
**Tools**:

* **Dirb** / **Dirbuster** - **Included** **Kali**, **old** (**slow**) **functional**. **Allow** **auto-signed certificates** **recursive search**. **Too slow** **compared** **th other options**.
* [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: **Allow** **auto-signed certificates** **recursive search**.
* [**Gobuster**](https://github.com/OJ/gobuster) (go): **Allow** **auto-signed certificates**, **doesn't** **recursive search**.
* [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- **Fast**, **supports recursive search**.
* [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
* [**ffuf** ](https://github.com/ffuf/ffuf)- **Fast**: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
* [**uro**](https://github.com/s0md3v/uro) (python): **Spider** **tool** **given** **list** **found URLs** **delete** "duplicated" URLs.
* [**Scavenger**](https://github.com/0xDexter0us/Scavenger): **Burp Extension** **create** **list** **directories** **burp history** **different pages**.
* [**TrashCompactor**](https://github.com/michael1026/trashcompactor): **Remove URLs** **duplicated functionalities** (**based** **js imports**).
* [**Chamaleon**](https://github.com/iustin24/chameleon): **Use** **wapalyzer** **detect** **used technologies** **select** **wordlists** **use**.

**Recommended dictionaries**:

* [https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/bf\_directories.txt](https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/bf\_directories.txt)
* [**Dirsearch** included dictionary](
* [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
* [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
* [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
* _/usr/share/wordlists/dirb/common.txt_
* _/usr/share/wordlists/dirb/big.txt_
* _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_Note that anytime a new directory is discovered during brute-forcing or spidering, it should be Brute-Forced._

### What to check on each file found

* [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): Find broken links inside HTMLs that may be prone to takeovers
* **File Backups**: Once you have found all the files, look for backups of all the executable files ("_.php_", "_.aspx_"...). Common variations for naming a backup are: _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ You can also use the tool [**bfac**](https://github.com/mazen160/bfac) **or** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)**.**
* **Discover new parameters**: You can use tools like [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **and** [**Param Miner**](https://github.com/PortSwigger/param-miner) **to discover hidden parameters. If you can, you could try to search** hidden parameters on each executable web file.
* _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
* _Param-miner ‚Äúparams‚Äù :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
* _Assetnote ‚Äúparameters\_top\_1m‚Äù:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
* _nullenc0de ‚Äúparams.txt‚Äù:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
* **Comments:** Check the comments of all the files, you can find **credentials** or **hidden functionality**.
* If you are playing **CTF**, a "common" trick is to **hide** **information** inside comments at the **right** of the **page** (using **hundreds** of **spaces** so you don't see the data if you open the source code with the browser). Other possibility is to use **several new lines** and **hide information** in a comment at the **bottom** of the web page.
* **API keys**: If you **find any API key** there is guide that indicates how to use API keys of different platforms: [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](https://github.com/l4yton/RegHex\)/)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
* Google API keys: If you find any API key looking like **AIza**SyA-qLheq6xjDiEIRisP\_ujUseYLQCHUjik you can use the project [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) to check which apis the key can access.
* **S3 Buckets**: While spidering look if any **subdomain** or any **link** is related with some **S3 bucket**. In that case, [**check** the **permissions** of the bucket](buckets/).

### Special findings

**While** performing the **spidering** and **brute-forcing** you could find **interesting** **things** that you have to **notice**.

**Interesting files**

* Look for **links** to other files inside the **CSS** files.
* [If you find a _**.git**_ file some information can be extracted](git.md)
* If you find a _**.env**_ information such as api keys, dbs passwords and other information can be found.
* If you find **API endpoints** you [should also test them](web-api-pentesting.md). These aren't files, but will probably "look like" them.
* **JS files**: In the spidering section several tools that can extract path from JS files were mentioned. Also, It would be interesting to **monitor each JS file found**, as in some ocations, a change may indicate that a potential vulnerability was introduced in the code. You could use for example [**JSMon**](https://github.com/robre/jsmon)**.**
* You should also check discovered JS files with [**RetireJS**](https://github.com/retirejs/retire.js/) or [**JSHole**](https://github.com/callforpapers-source/jshole) to find if it's vulnerable.
* **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
* **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
* **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://ooze.ninja/javascript/poisonjs/](https://ooze.ninja/javascript/poisonjs/))
* [**TrainFuck**](https://github.com/taco-c/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
* In several occasions you will need to **understand regular expressions** used, this will be useful: [https://regex101.com/](https://regex101.com)
* You could also **monitor the files were forms were detected**, as a change in the parameter or the apearance f a new form may indicate a potential new vulnerable functionality.

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**

{% content-ref url="403-and-401-bypasses.md" %}
[403-and-401-bypasses.md](403-and-401-bypasses.md)
{% endcontent-ref %}

**502 Proxy Error**

If any page **responds** with that **code**, it's probably a **bad configured proxy**. **If you send a HTTP request like: `GET https://google.com HTTP/1.1`** (with the host header and other common headers), the **proxy** will try to **access** _**google.com**_ **and you will have found a** SSRF.

**NTLM Authentication - Info disclosure**

If the running server asking for authentication is **Windows** or you find a login asking for your **credentials** (and asking for **domain** **name**), you can provoke an **information disclosure**.\
**Send** the **header**: `‚ÄúAuthorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=‚Äù` and due to how the **NTLM authentication works**, the server will respond with internal info (IIS version, Windows version...) inside the header "WWW-Authenticate".\
You can **automate** this using the **nmap plugin** "_http-ntlm-info.nse_".

**HTTP Redirect (CTF)**

It is possible to **put content** inside a **Redirection**. This content **won't be shown to the user** (as the browser will execute the redirection) but something could be **hidden** in there.
### Web Vulnerabilities Checking

Now that a comprehensive enumeration of the web application has been performed it's time to check for a lot of possible vulnerabilities. You can find the checklist here:

{% content-ref url="../../pentesting-web/web-vulnerabilities-methodology/" %}
[web-vulnerabilities-methodology](../../pentesting-web/web-vulnerabilities-methodology/)
{% endcontent-ref %}

Find more info about web vulns in:

* [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
* [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web\_application\_security\_testing/configuration\_and\_deployment\_management\_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web\_application\_security\_testing/configuration\_and\_deployment\_management\_testing.html)
* [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

You can use tools such as [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) to monitor pages for modifications that might insert vulnerabilities.

### HackTricks Automatic Commands
```
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.xyz/pentesting/pentesting-web

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **Intigriti** **qIb** **bug bounty platform created by hackers, for hackers**! **https://go.intigriti.com/hacktricks** **join** **qaStaHvIS**, **$100,000** **bounties** **earn** **start**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
