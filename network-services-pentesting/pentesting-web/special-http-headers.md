# –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –°–ª–æ–≤–Ω–∏–∫–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/Web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/Web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∑–º—ñ–Ω–∏ –º—ñ—Å—Ü—è

–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ **IP –¥–∂–µ—Ä–µ–ª–∞**:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop)

–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ **–º—ñ—Å—Ü–µ**:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop

–ó–∞–≥–æ–ª–æ–≤–æ–∫ hop-by-hop - —Ü–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫, —è–∫–∏–π –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ç–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ, —â–æ –Ω–∞—Ä–∞–∑—ñ –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç, –Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ end-to-end.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP Request Smuggling

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à—É

**–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à—É —Å–µ—Ä–≤–µ—Ä–∞**:

* **`X-Cache`** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂–µ –º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è **`miss`**, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç –Ω–µ –∫–µ—à—É–≤–∞–≤—Å—è, —ñ –∑–Ω–∞—á–µ–Ω–Ω—è **`hit`**, –∫–æ–ª–∏ –≤—ñ–Ω –∫–µ—à—É—î—Ç—å—Å—è
* –°—Ö–æ–∂–µ –ø–æ–≤–æ–¥–∂–µ–Ω–Ω—è —É –∑–∞–≥–æ–ª–æ–≤–∫—É **`Cf-Cache-Status`**
* **`Cache-Control`** –≤–∫–∞–∑—É—î, —á–∏ —Ä–µ—Å—É—Ä—Å –∫–µ—à—É—î—Ç—å—Å—è —ñ –∫–æ–ª–∏ –±—É–¥–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–∞–∑ –∫–µ—à—É–≤–∞—Ç–∏—Å—è: `Cache-Control: public, max-age=1800`
* **`Vary`** —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è **–≤–∫–∞–∑—ñ–≤–∫–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤**, —è–∫—ñ —Ä–æ–∑–≥–ª—è–¥–∞—é—Ç—å—Å—è —è–∫ **—á–∞—Å—Ç–∏–Ω–∞ –∫–ª—é—á–∞ –∫–µ—à—É**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –º–∞—é—Ç—å –∫–ª—é—á–∞.
* **`Age`** –≤–∏–∑–Ω–∞—á–∞—î —á–∞—Å —É —Å–µ–∫—É–Ω–¥–∞—Ö, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ –æ–±'—î–∫—Ç –ø–µ—Ä–µ–±—É–≤–∞–≤ —É –∫–µ—à—ñ –ø—Ä–æ–∫—Å—ñ.
* **`Server-Timing: cdn-cache; desc=HIT`** —Ç–∞–∫–æ–∂ –≤–∫–∞–∑—É—î, —â–æ —Ä–µ—Å—É—Ä—Å –±—É–≤ –∫–µ—à–æ–≤–∞–Ω–∏–π

{% content-ref url="../../pentesting-web/cache-deception/" %}
[cache-deception](../../pentesting-web/cache-deception/)
{% endcontent-ref %}

**–ó–∞–≥–æ–ª–æ–≤–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–µ—à—É**:

* `Clear-Site-Data`: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ –∫–µ—à—É, —è–∫–∏–π —Å–ª—ñ–¥ –≤–∏–¥–∞–ª–∏—Ç–∏: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: –ú—ñ—Å—Ç–∏—Ç—å –¥–∞—Ç—É/—á–∞—Å, –∫–æ–ª–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–≤–∏–Ω–Ω–∞ –∑–∞–∫—ñ–Ω—á–∏—Ç–∏—Å—è: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` —Ç–µ –∂ —Å–∞–º–µ, —â–æ `Cache-Control: no-cache`
* `Warning`: –ó–∞–≥–∞–ª—å–Ω–∏–π HTTP –∑–∞–≥–æ–ª–æ–≤–æ–∫ **`Warning`** –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂–µ –∑'—è–≤–∏—Ç–∏—Å—è –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Warning`. `Warning: 110 anderson/1.3.37 "Response is stale"`

## –£–º–æ–≤–∏

* –ó–∞–ø–∏—Ç–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏: **`If-Modified-Since`** —Ç–∞ **`If-Unmodified-Since`**, –±—É–¥—É—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –¥–∞–Ω–∏–º–∏ –ª–∏—à–µ —è–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\*\*`Last-Modified`\*\* –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—à–∏–π —á–∞—Å.
* –£–º–æ–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **`If-Match`** —Ç–∞ **`If-None-Match`**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è Etag, —Ç–æ–º—É –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞–¥—ñ—à–ª–µ –≤–º—ñ—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —è–∫—â–æ –¥–∞–Ω—ñ (Etag) –∑–º—ñ–Ω–∏–ª–∏—Å—è. `Etag` –±–µ—Ä–µ—Ç—å—Å—è –∑ HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* –ó–Ω–∞—á–µ–Ω–Ω—è **Etag** –∑–∞–∑–≤–∏—á–∞–π **–æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è** –Ω–∞ –æ—Å–Ω–æ–≤—ñ **–≤–º—ñ—Å—Ç—É** –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` –≤–∫–∞–∑—É—î, —â–æ `Etag` —î **Sha1** –∑ **37 –±–∞–π—Ç—ñ–≤**.

## –ó–∞–ø–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É

* **`Accept-Ranges`**: –í–∫–∞–∑—É—î, —á–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–µ—Ä–≤–µ—Ä –∑–∞–ø–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É, —ñ —è–∫—â–æ —Ç–∞–∫, –≤ —è–∫—ñ–π –æ–¥–∏–Ω–∏—Ü—ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—Ä–∞–∂–µ–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω. `Accept-Ranges: <range-unit>`
* **`Range`**: –í–∫–∞–∑—É—î —á–∞—Å—Ç–∏–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞, —è–∫—É —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–≤–µ—Ä–Ω—É—Ç–∏.
* **`If-Range`**: –°—Ç–≤–æ—Ä—é—î —É–º–æ–≤–Ω–∏–π –∑–∞–ø–∏—Ç –¥—ñ–∞–ø–∞–∑–æ–Ω—É, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ª–∏—à–µ —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–∏–π etag –∞–±–æ –¥–∞—Ç–∞ –∑–±—ñ–≥–∞—é—Ç—å—Å—è –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–º. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é –¥–≤–æ—Ö –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –∑ –Ω–µ—Å—É–º—ñ—Å–Ω–∏—Ö –≤–µ—Ä—Å—ñ–π —Ä–µ—Å—É—Ä—Å—É.
* **`Content-Range`**: –í–∫–∞–∑—É—î, –¥–µ –≤ –ø–æ–≤–Ω–æ–º—É —Ç—ñ–ª—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–∏—Ç—å —á–∞—Å—Ç–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç—ñ–ª–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

* **`Content-Length`:** –†–æ–∑–º—ñ—Ä —Ä–µ—Å—É—Ä—Å—É, —É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É —á–∏—Å–ª—ñ –±–∞–π—Ç—ñ–≤.
* **`Content-Type`**: –í–∫–∞–∑—É—î –º–µ–¥—ñ–∞-—Ç–∏–ø —Ä–µ—Å—É—Ä—Å—É
* **`Content-Encoding`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è.
* **`Content-Language`**: –û–ø–∏—Å—É—î –ª—é–¥—Å—å–∫—É –º–æ–≤—É(–∏), –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—É –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä—ñ—ó, —â–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–ª–∞—Å–Ω–æ—ó –ø–µ—Ä–µ–≤–∞–∂–Ω–æ—ó –º–æ–≤–∏.
* **`Content-Location`**: –í–∫–∞–∑—É—î –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

–ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É pentest —Ü—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞–∑–≤–∏—á–∞–π "–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞", –∞–ª–µ —è–∫—â–æ —Ä–µ—Å—É—Ä—Å **–∑–∞—Ö–∏—â–µ–Ω–∏–π** 401 –∞–±–æ 403 —ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —è–∫–∏–π—Å—å **—Å–ø–æ—Å—ñ–±** –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—é **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **—Ü—ñ–∫–∞–≤–æ.**\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è **`Range`** —Ç–∞ **`Etag`** —É –∑–∞–ø–∏—Ç—ñ HEAD –º–æ–∂–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –≤–º—ñ—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç–∏ HEAD:

* –ó–∞–ø–∏—Ç –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Range: bytes=20-20` —ñ –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é, —â–æ –º—ñ—Å—Ç–∏—Ç—å `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"`, –≤–∏—Ç—ñ–∫–∞—î, —â–æ SHA1 –±–∞–π—Ç–∞ 20 —î `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y`

## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä

* `Server: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## –ö–æ–Ω—Ç—Ä–æ–ª—ñ

* **`Allow`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è HTTP –º–µ—Ç–æ–¥—ñ–≤, —è–∫—ñ —Ä–µ—Å—É—Ä—Å –º–æ–∂–µ –æ–±—Ä–æ–±–ª—è—Ç–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—ñ–Ω –º–æ–∂–µ –±—É—Ç–∏ –≤–∫–∞–∑–∞–Ω–∏–π —è–∫ `Allow: GET, POST, HEAD`, —â–æ –≤–∫–∞–∑—É—î, —â–æ —Ä–µ—Å—É—Ä—Å –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ü—ñ –º–µ—Ç–æ–¥–∏.
* **`Expect`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–æ–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –æ—á—ñ–∫—É–≤–∞–Ω—å, —è–∫—ñ —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—É. –ó–∞–≥–∞–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–∫–ª—é—á–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Expect: 100-continue`, —è–∫–∏–π —Å–∏–≥–Ω–∞–ª—ñ–∑—É—î, —â–æ –∫–ª—ñ—î–Ω—Ç –º–∞—î –Ω–∞–º—ñ—Ä –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤–µ–ª–∏–∫–∏–π –æ–±—Å—è–≥ –¥–∞–Ω–∏—Ö. –ö–ª—ñ—î–Ω—Ç —á–µ–∫–∞—î –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å `100 (Continue)` –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è–º –ø–µ—Ä–µ–¥–∞—á—ñ. –¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º –¥–æ–ø–æ–º–∞–≥–∞—î –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ, –æ—á—ñ–∫—É—é—á–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞.

## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

* –ó–∞–≥–æ–ª–æ–≤–æ–∫ **`Content-Disposition`** —É HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö –≤–∫–∞–∑—É—î, —á–∏ —Ñ–∞–π–ª –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è **–≤–±—É–¥–æ–≤–∞–Ω–æ** (–≤ –º–µ–∂–∞—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏) –∞–±–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ **–¥–æ–¥–∞—Ç–æ–∫** (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π). –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
Content-Disposition: attachment; filename="filename.jpg"
```
–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ñ–∞–π–ª –∑ –Ω–∞–∑–≤–æ—é "filename.jpg" –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–ø–µ–∫–∏

### –ü–æ–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **–î–æ–≤—ñ—Ä–µ–Ω—ñ —Ç–∏–ø–∏**

–ó–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –î–æ–≤—ñ—Ä–µ–Ω—ñ —Ç–∏–ø–∏ —á–µ—Ä–µ–∑ CSP, –ø—Ä–æ–≥—Ä–∞–º–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Ö–∏—â–µ–Ω—ñ –≤—ñ–¥ –∞—Ç–∞–∫ DOM XSS. –î–æ–≤—ñ—Ä–µ–Ω—ñ —Ç–∏–ø–∏ –≥–∞—Ä–∞–Ω—Ç—É—é—Ç—å, —â–æ –ª–∏—à–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –æ–±'—î–∫—Ç–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º –ø–æ–ª—ñ—Ç–∏–∫–∞–º –±–µ–∑–ø–µ–∫–∏, –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –≤ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –≤–∏–∫–ª–∏–∫–∞—Ö –≤–µ–±-API, —Ç–∏–º —Å–∞–º–∏–º –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –±–µ–∑–ø–µ–∫—É JavaScript-–∫–æ–¥—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

–¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø–æ–±—ñ–≥–∞—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—é —Ç–∏–ø—É MIME, –ø—Ä–∞–∫—Ç–∏–∫–∞, —è–∫–∞ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π XSS. –í—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ–± –±—Ä–∞—É–∑–µ—Ä–∏ –ø–æ–≤–∞–∂–∞–ª–∏ —Ç–∏–ø–∏ MIME, –≤–∫–∞–∑–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–æ–º.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

–©–æ–± –±–æ—Ä–æ—Ç–∏—Å—è –∑ –∫–ª—ñ–∫–¥–∂–µ–∫–∏–Ω–≥–æ–º, —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±–º–µ–∂—É—î, —è–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –≤ `<frame>`, `<iframe>`, `<embed>`, –∞–±–æ `<object>` —Ç–µ–≥–∏, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤—Å—ñ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º —è–≤–Ω–æ –≤–∫–∞–∑—É–≤–∞—Ç–∏ —Å–≤–æ—ó –¥–æ–∑–≤–æ–ª–∏ –Ω–∞ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è.
```
X-Frame-Options: DENY
```
### **–ü–æ–ª—ñ—Ç–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ –∫—Ä–æ—Å-–¥–æ–º–µ–Ω–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º (CORP) —Ç–∞ –æ–±–º—ñ–Ω —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∑ –∫—Ä–æ—Å-–¥–æ–º–µ–Ω–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º (CORS)**

CORP —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ —Ä–µ—Å—É—Ä—Å–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –≤–µ–±-—Å–∞–π—Ç–∞–º–∏, –∑–º–µ–Ω—à—É—é—á–∏ –∫—Ä–æ—Å-—Å–∞–π—Ç–æ–≤—ñ –≤–∏—Ç–æ–∫–∏. CORS, –∑ —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –¥–æ–∑–≤–æ–ª—è—î –±—ñ–ª—å—à –≥–Ω—É—á–∫–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –æ–±–º—ñ–Ω—É —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∑ –∫—Ä–æ—Å-–¥–æ–º–µ–Ω–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º, –ø–æ—Å–ª–∞–±–ª—é—é—á–∏ –ø–æ–ª—ñ—Ç–∏–∫—É –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–∞ –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **–ü–æ–ª—ñ—Ç–∏–∫–∞ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª (COEP) —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª (COOP)**

COEP —Ç–∞ COOP —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —ñ–∑–æ–ª—è—Ü—ñ—ó –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª, –∑–Ω–∞—á–Ω–æ –∑–º–µ–Ω—à—É—é—á–∏ —Ä–∏–∑–∏–∫ –∞—Ç–∞–∫, –ø–æ–¥—ñ–±–Ω–∏—Ö –¥–æ Spectre. –í–æ–Ω–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –≤—ñ–∫–Ω–∞–º–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

–ù–∞—Ä–µ—à—Ç—ñ, HSTS - —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –∑–º—É—à—É—î –±—Ä–∞—É–∑–µ—Ä–∏ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –ª–∏—à–µ —á–µ—Ä–µ–∑ –∑–∞—Ö–∏—â–µ–Ω—ñ HTTPS –∑'—î–¥–Ω–∞–Ω–Ω—è, —Ç–∏–º —Å–∞–º–∏–º –ø—ñ–¥–≤–∏—â—É—é—á–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å —ñ –±–µ–∑–ø–µ–∫—É.
```
Strict-Transport-Security: max-age=3153600
```
## References

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
