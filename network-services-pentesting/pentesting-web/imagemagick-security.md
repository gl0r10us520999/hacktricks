# ImageMagick S√©curit√©

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

Consultez plus de d√©tails sur [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, une biblioth√®que de traitement d'images polyvalente, pr√©sente un d√©fi dans la configuration de sa politique de s√©curit√© en raison de ses nombreuses options et du manque de documentation en ligne d√©taill√©e. Les utilisateurs cr√©ent souvent des politiques bas√©es sur des sources fragment√©es sur Internet, ce qui peut entra√Æner des erreurs de configuration. La biblioth√®que prend en charge un vaste √©ventail de plus de 100 formats d'image, chacun contribuant √† sa complexit√© et √† son profil de vuln√©rabilit√©, comme le montrent des incidents de s√©curit√© historiques.

## Vers des politiques plus s√ªres
Pour relever ces d√©fis, un [outil a √©t√© d√©velopp√©](https://imagemagick-secevaluator.doyensec.com/) pour aider √† concevoir et √† auditer les politiques de s√©curit√© d'ImageMagick. Cet outil est bas√© sur des recherches approfondies et vise √† garantir que les politiques ne sont pas seulement robustes, mais aussi exemptes de failles pouvant √™tre exploit√©es.

## Approche de liste blanche vs liste noire
Historiquement, les politiques d'ImageMagick reposaient sur une approche de liste noire, o√π des codeurs sp√©cifiques √©taient refus√©s. Cependant, des changements dans ImageMagick 6.9.7-7 ont modifi√© ce paradigme, permettant une approche de liste blanche. Cette approche refuse d'abord tous les codeurs, puis accorde s√©lectivement l'acc√®s √† ceux de confiance, renfor√ßant ainsi la posture de s√©curit√©.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Sensibilit√© √† la casse dans les politiques
Il est crucial de noter que les mod√®les de politique dans ImageMagick sont sensibles √† la casse. En tant que tel, s'assurer que les codeurs et les modules sont correctement en majuscules dans les politiques est vital pour pr√©venir des permissions non intentionnelles.

## Limites de ressources
ImageMagick est sujet √† des attaques par d√©ni de service s'il n'est pas correctement configur√©. D√©finir des limites de ressources explicites dans la politique est essentiel pour pr√©venir de telles vuln√©rabilit√©s.

## Fragmentation des politiques
Les politiques peuvent √™tre fragment√©es √† travers diff√©rentes installations d'ImageMagick, entra√Ænant des conflits ou des remplacements potentiels. Il est recommand√© de localiser et de v√©rifier les fichiers de politique actifs en utilisant des commandes comme :
```shell
$ find / -iname policy.xml
```
## Une politique restrictive de d√©part
Un mod√®le de politique restrictive a √©t√© propos√©, ax√© sur des limitations strictes des ressources et des contr√¥les d'acc√®s. Ce mod√®le sert de base pour d√©velopper des politiques sur mesure qui s'alignent sur les exigences sp√©cifiques des applications.

L'efficacit√© d'une politique de s√©curit√© peut √™tre confirm√©e en utilisant la commande `identify -list policy` dans ImageMagick. De plus, l'[outil d'√©valuation](https://imagemagick-secevaluator.doyensec.com/) mentionn√© pr√©c√©demment peut √™tre utilis√© pour affiner la politique en fonction des besoins individuels.

## R√©f√©rences
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
