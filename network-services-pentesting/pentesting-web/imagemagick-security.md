# ImageMagick Bezbednost

{% hint style="success" %}
Učite i vežbajte AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Učite i vežbajte GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podržite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}

Proverite dodatne detalje na [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, svestrana biblioteka za obradu slika, predstavlja izazov u konfigurisanju svoje bezbednosne politike zbog svojih opsežnih opcija i nedostatka detaljne online dokumentacije. Korisnici često kreiraju politike na osnovu fragmentisanih internet izvora, što može dovesti do potencijalnih pogrešnih konfiguracija. Biblioteka podržava širok spektar od preko 100 formata slika, od kojih svaki doprinosi njenoj kompleksnosti i profilu ranjivosti, što su pokazali istorijski bezbednosni incidenti.

## Ka Bezbednijim Politikama
Kako bi se rešili ovi izazovi, [razvijen je alat](https://imagemagick-secevaluator.doyensec.com/) koji pomaže u dizajniranju i reviziji bezbednosnih politika ImageMagick-a. Ovaj alat je zasnovan na opsežnom istraživanju i ima za cilj da osigura da politike budu ne samo robusne, već i bez rupa koje bi mogle biti iskorišćene.

## Pristup sa Dozvolama naspram Pristupa sa Zabrana
Istorijski gledano, politike ImageMagick-a oslanjale su se na pristup sa zabranama, gde su određenim kodovima bio uskraćen pristup. Međutim, promene u ImageMagick 6.9.7-7 su pomerile ovu paradigmu, omogućavajući pristup sa dozvolama. Ovaj pristup prvo uskraćuje pristup svim kodovima, a zatim selektivno dodeljuje pristup pouzdanim, čime se poboljšava bezbednosna pozicija.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Osjetljivost na velika i mala slova u politikama
Važno je napomenuti da su obrasci politika u ImageMagick-u osjetljivi na velika i mala slova. Stoga je od suštinskog značaja osigurati da su kodovi i moduli pravilno napisani velikim slovima u politikama kako bi se sprečile nepredviđene dozvole.

## Ograničenja resursa
ImageMagick je podložan napadima uskraćivanja usluga ako nije pravilno konfigurisan. Postavljanje eksplicitnih ograničenja resursa u politici je od suštinskog značaja za sprečavanje takvih ranjivosti.

## Fragmentacija politika
Politike mogu biti fragmentirane kroz različite instalacije ImageMagick-a, što može dovesti do potencijalnih sukoba ili preklapanja. Preporučuje se lociranje i verifikacija aktivnih datoteka politika korišćenjem komandi kao što su:
```shell
$ find / -iname policy.xml
```
## Početna, Restriktivna Politika
Predložen je šablon restriktivne politike, fokusirajući se na stroga ograničenja resursa i kontrole pristupa. Ovaj šablon služi kao osnovna tačka za razvijanje prilagođenih politika koje se usklađuju sa specifičnim zahtevima aplikacija.

Efikasnost bezbednosne politike može se potvrditi korišćenjem komande `identify -list policy` u ImageMagick-u. Pored toga, [alat za evaluaciju](https://imagemagick-secevaluator.doyensec.com/) pomenut ranije može se koristiti za usavršavanje politike na osnovu individualnih potreba.

## Reference
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
