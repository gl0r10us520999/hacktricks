# Web API Pentesting

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 游눫 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

Use [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=web-api-pentesting) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=web-api-pentesting" %}

## API Pentesting Methodology Summary

Pentesting APIs involves a structured approach to uncovering vulnerabilities. This guide encapsulates a comprehensive methodology, emphasizing practical techniques and tools.

### **Understanding API Types**

* **SOAP/XML Web Services**: Utilizan el formato WSDL para la documentaci칩n, que generalmente se encuentra en rutas `?wsdl`. Herramientas como **SOAPUI** y **WSDLer** (Burp Suite Extension) son fundamentales para analizar y generar solicitudes. La documentaci칩n de ejemplo est치 disponible en [DNE Online](http://www.dneonline.com/calculator.asmx).
* **REST APIs (JSON)**: La documentaci칩n a menudo viene en archivos WADL, sin embargo, herramientas como [Swagger UI](https://swagger.io/tools/swagger-ui/) proporcionan una interfaz m치s amigable para la interacci칩n. **Postman** es una herramienta valiosa para crear y gestionar solicitudes de ejemplo.
* **GraphQL**: Un lenguaje de consulta para APIs que ofrece una descripci칩n completa y comprensible de los datos en tu API.

### **Practice Labs**

* [**VAmPI**](https://github.com/erev0s/VAmPI): Una API deliberadamente vulnerable para pr치ctica pr치ctica, cubriendo las 10 principales vulnerabilidades de API de OWASP.

### **Effective Tricks for API Pentesting**

* **SOAP/XML Vulnerabilities**: Explora vulnerabilidades XXE, aunque las declaraciones DTD a menudo est치n restringidas. Las etiquetas CDATA pueden permitir la inserci칩n de cargas 칰tiles si el XML sigue siendo v치lido.
* **Privilege Escalation**: Prueba los puntos finales con diferentes niveles de privilegio para identificar posibilidades de acceso no autorizado.
* **CORS Misconfigurations**: Investiga la configuraci칩n de CORS para potenciales explotaciones a trav칠s de ataques CSRF desde sesiones autenticadas.
* **Endpoint Discovery**: Aprovecha los patrones de API para descubrir puntos finales ocultos. Herramientas como fuzzers pueden automatizar este proceso.
* **Parameter Tampering**: Experimenta con agregar o reemplazar par치metros en solicitudes para acceder a datos o funcionalidades no autorizadas.
* **HTTP Method Testing**: Var칤a los m칠todos de solicitud (GET, POST, PUT, DELETE, PATCH) para descubrir comportamientos inesperados o divulgaciones de informaci칩n.
* **Content-Type Manipulation**: Cambia entre diferentes tipos de contenido (x-www-form-urlencoded, application/xml, application/json) para probar problemas de an치lisis o vulnerabilidades.
* **Advanced Parameter Techniques**: Prueba con tipos de datos inesperados en cargas 칰tiles JSON o juega con datos XML para inyecciones XXE. Tambi칠n intenta la contaminaci칩n de par치metros y caracteres comod칤n para pruebas m치s amplias.
* **Version Testing**: Las versiones m치s antiguas de la API pueden ser m치s susceptibles a ataques. Siempre verifica y prueba contra m칰ltiples versiones de API.

### **Tools and Resources for API Pentesting**

* [**kiterunner**](https://github.com/assetnote/kiterunner): Excelente para descubrir puntos finales de API. 칔salo para escanear y forzar rutas y par치metros contra APIs objetivo.
```bash
kr scan https://domain.com/api/ -w routes-large.kite -x 20
kr scan https://domain.com/api/ -A=apiroutes-220828 -x 20
kr brute https://domain.com/api/ -A=raft-large-words -x 20 -d=0
kr brute https://domain.com/api/ -w /tmp/lang-english.txt -x 20 -d=0
```
* [**https://github.com/BishopFox/sj**](https://github.com/BishopFox/sj): sj es una herramienta de l칤nea de comandos dise침ada para ayudar con la auditor칤a de **archivos de definici칩n Swagger/OpenAPI expuestos** al verificar los puntos finales de la API asociados en busca de autenticaci칩n d칠bil. Tambi칠n proporciona plantillas de comandos para pruebas manuales de vulnerabilidades.
* Herramientas adicionales como **automatic-api-attack-tool**, **Astra** y **restler-fuzzer** ofrecen funcionalidades personalizadas para pruebas de seguridad de API, que van desde simulaci칩n de ataques hasta fuzzing y escaneo de vulnerabilidades.
* [**Cherrybomb**](https://github.com/blst-security/cherrybomb): Es una herramienta de seguridad de API que audita tu API basada en un archivo OAS (la herramienta est치 escrita en rust).

### **Recursos de Aprendizaje y Pr치ctica**

* **OWASP API Security Top 10**: Lectura esencial para entender las vulnerabilidades comunes de API ([OWASP Top 10](https://github.com/OWASP/API-Security/blob/master/2019/en/dist/owasp-api-security-top-10.pdf)).
* **API Security Checklist**: Una lista de verificaci칩n completa para asegurar APIs ([enlace de GitHub](https://github.com/shieldfy/API-Security-Checklist)).
* **Logger++ Filters**: Para cazar vulnerabilidades de API, Logger++ ofrece filtros 칰tiles ([enlace de GitHub](https://github.com/bnematzadeh/LoggerPlusPlus-API-Filters)).
* **API Endpoints List**: Una lista curada de posibles puntos finales de API para fines de prueba ([gist de GitHub](https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d)).

## Referencias

* [https://github.com/Cyber-Guy1/API-SecurityEmpire](https://github.com/Cyber-Guy1/API-SecurityEmpire)

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

Usa [**Trickest**](https://trickest.com/?utm\_source=hacktricks\&utm\_medium=text\&utm\_campaign=ppc\&utm\_term=trickest\&utm\_content=web-api-pentesting) para construir y **automatizar flujos de trabajo** f치cilmente impulsados por las **herramientas comunitarias m치s avanzadas** del mundo.\
Obt칠n acceso hoy:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=web-api-pentesting" %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos de GitHub.

</details>
{% endhint %}
