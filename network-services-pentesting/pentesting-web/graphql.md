# GraphQL

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Introduction

GraphQL is **highlighted** as an **efficient alternative** to REST API, offering a simplified approach for querying data from the backend. In contrast to REST, which often necessitates numerous requests across varied endpoints to gather data, GraphQL enables the fetching of all required information through a **single request**. This streamlining significantly **benefits developers** by diminishing the intricacy of their data fetching processes.

## GraphQL and Security

With the advent of new technologies, including GraphQL, new security vulnerabilities also emerge. A key point to note is that **GraphQL does not include authentication mechanisms by default**. It's the responsibility of developers to implement such security measures. Without proper authentication, GraphQL endpoints may expose sensitive information to unauthenticated users, posing a significant security risk.

### Directory Brute Force Attacks and GraphQL

To identify exposed GraphQL instances, the inclusion of specific paths in directory brute force attacks is recommended. These paths are:

- `/graphql`
- `/graphiql`
- `/graphql.php`
- `/graphql/console`
- `/api`
- `/api/graphql`
- `/graphql/api`
- `/graphql/graphql`

Identifying open GraphQL instances allows for the examination of supported queries. This is crucial for understanding the data accessible through the endpoint. GraphQL's introspection system facilitates this by detailing the queries a schema supports. For more information on this, refer to the GraphQL documentation on introspection: [**GraphQL: A query language for APIs.**](https://graphql.org/learn/introspection/)

### Fingerprint

The tool [**graphw00f**](https://github.com/dolevf/graphw00f) is capable to detect wich GraphQL engine is used in a server and then prints some helpful information for the security auditor.

#### Universal queries <a href="#universal-queries" id="universal-queries"></a>

To check if a URL is a GraphQL service, a **universal query**, `query{__typename}`, can be sent. If the response includes `{"data": {"__typename": "Query"}}`, it confirms the URL hosts a GraphQL endpoint. This method relies on GraphQL's `__typename` field, which reveals the type of the queried object.
```javascript
query{__typename}
```
### QaStaHvIS

Graphql qar'a' **GET**, **POST** (x-www-form-urlencoded) je **POST**(json) laH. 'ach, mamI' DaneH'a' 'e' vItlhutlh CSRF attacks vItlhutlh json vItlhutlh.

#### Introspection

Schema vItlhutlh pagh 'ej, schema vItlhutlh jatlhqa' 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, 'ej, '
```bash
query={__schema{types{name,fields{name}}}}
```
DaH jatlhpu' Hoch vItlhutlh:

![](<../../.gitbook/assets/image (202).png>)

{% code overflow="wrap" %}
```bash
query={__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}
```
{% endcode %}

**tlhIngan Hol translation:**

With this query you can extract all the types, it's fields, and it's arguments (and the type of the args). This will be very useful to know how to query the database.

![](<../../.gitbook/assets/image (207) (3).png>)

**Errors**

It's interesting to know if the **errors** are going to be **shown** as they will contribute with useful **information**.
```
?query={__schema}
?query={}
?query={thisdefinitelydoesnotexist}
```
![](<../../.gitbook/assets/image (205) (1).png>)

**Introspection yIlo' Database Schema Enumerate**

{% hint style="info" %}
vaj introspection enabled 'ej bIngDaq query run, 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlhutlh 'ej vItlh
```bash
#Full introspection query

query IntrospectionQuery {
__schema {
queryType {
name
}
mutationType {
name
}
subscriptionType {
name
}
types {
...FullType
}
directives {
name
description
args {
...InputValue
}
onOperation  #Often needs to be deleted to run query
onFragment   #Often needs to be deleted to run query
onField      #Often needs to be deleted to run query
}
}
}

fragment FullType on __Type {
kind
name
description
fields(includeDeprecated: true) {
name
description
args {
...InputValue
}
type {
...TypeRef
}
isDeprecated
deprecationReason
}
inputFields {
...InputValue
}
interfaces {
...TypeRef
}
enumValues(includeDeprecated: true) {
name
description
isDeprecated
deprecationReason
}
possibleTypes {
...TypeRef
}
}

fragment InputValue on __InputValue {
name
description
type {
...TypeRef
}
defaultValue
}

fragment TypeRef on __Type {
kind
name
ofType {
kind
name
ofType {
kind
name
ofType {
kind
name
}
}
}
}
```
Inline introspection query:

**Klingon Translation:**

`Inline Introspection`:
```
Qapla'! Qapla'! Qapla'!
```

**Note:** The Klingon translation for "Inline Introspection" is "Qapla'! Qapla'! Qapla'!"
```
/?query=fragment%20FullType%20on%20Type%20{+%20%20kind+%20%20name+%20%20description+%20%20fields%20{+%20%20%20%20name+%20%20%20%20description+%20%20%20%20args%20{+%20%20%20%20%20%20...InputValue+%20%20%20%20}+%20%20%20%20type%20{+%20%20%20%20%20%20...TypeRef+%20%20%20%20}+%20%20}+%20%20inputFields%20{+%20%20%20%20...InputValue+%20%20}+%20%20interfaces%20{+%20%20%20%20...TypeRef+%20%20}+%20%20enumValues%20{+%20%20%20%20name+%20%20%20%20description+%20%20}+%20%20possibleTypes%20{+%20%20%20%20...TypeRef+%20%20}+}++fragment%20InputValue%20on%20InputValue%20{+%20%20name+%20%20description+%20%20type%20{+%20%20%20%20...TypeRef+%20%20}+%20%20defaultValue+}++fragment%20TypeRef%20on%20Type%20{+%20%20kind+%20%20name+%20%20ofType%20{+%20%20%20%20kind+%20%20%20%20name+%20%20%20%20ofType%20{+%20%20%20%20%20%20kind+%20%20%20%20%20%20name+%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20ofType%20{+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20kind+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name+%20%20%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20%20%20}+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}++query%20IntrospectionQuery%20{+%20%20schema%20{+%20%20%20%20queryType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20mutationType%20{+%20%20%20%20%20%20name+%20%20%20%20}+%20%20%20%20types%20{+%20%20%20%20%20%20...FullType+%20%20%20%20}+%20%20%20%20directives%20{+%20%20%20%20%20%20name+%20%20%20%20%20%20description+%20%20%20%20%20%20locations+%20%20%20%20%20%20args%20{+%20%20%20%20%20%20%20%20...InputValue+%20%20%20%20%20%20}+%20%20%20%20}+%20%20}+}
```
The last code line is a graphql query that will dump all the meta-information from the graphql (objects names, parameters, types...)

![](<../../.gitbook/assets/image (206).png>)

If introspection is enabled you can use [**GraphQL Voyager**](https://github.com/APIs-guru/graphql-voyager) to view in a GUI all the options.

### Querying

Now that we know which kind of information is saved inside the database, let's try to **extract some values**.

In the introspection you can find **which object you can directly query for** (because you cannot query an object just because it exists). In the following image you can see that the "_queryType_" is called "_Query_" and that one of the fields of the "_Query_" object is "_flags_", which is also a type of object. Therefore you can query the flag object.

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-17-48.png)

Note that the type of the query "_flags_" is "_Flags_", and this object is defined as below:

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-22-57.png)

You can see that the "_Flags_" objects are composed by **name** and .**value** Then you can get all the names and values of the flags with the query:
```javascript
query={flags{name, value}}
```
ghItlh **object to query** **primitive** **type** **string** **example**:

![](<../../.gitbook/assets/image (441).png>)
```javascript
query={hiddenFlags}
```
**ghItlh** **_Query_** **_type_** **_object_-Daq** **2** **_objects_** **_user_** **_je_** **_users_** **_Daq_** **_Doch_** **_argument_** **_pagh_** **_search_** **_chaw'be'_** **_data_** **_cha'logh_**. **_Internet_** **_example_** **_Daq_** **_extract_** **_username_** **_je_** **_password_** **_ghItlh_** **_chu'_**:

![](<../../.gitbook/assets/image (208).png>)

'ej, **_example_** **_Daq_** **_ghItlh_** **_chu'_** **_error_** **_ghItlh_** **_chu'_**:

![](<../../.gitbook/assets/image (210).png>)

'_**uid**_' **_argument_** **_type_** _**Int**_ **_Daq_** **_search_** **_ghItlh_** **_chu'_**. **_Anyway_**, [**_Basic Enumeration_**](graphql.md#basic-enumeration) **_section_** **_Daq_** **_query_** **_purposed_** **_ghItlh_** **_cha'_** **_needed information_** **_cha'_** **_show_** **_ghItlh_**: `query={__schema{types{name,fields{name, args{name,description,type{name, kind, ofType{name, kind}}}}}}}`

**_query_** **_run_** **_ghItlh_** **_image_** **_provided_** **_Daq_** **_read_** **_ghItlh_** **_cha'_** **_uid_** **_arg_** **_type_** _Int_ **_cha'_** **_user_** **_je_** **_password_** **_ghItlh_** **_chu'_**:
`query={user(uid:1){user,password}}`

![](<../../.gitbook/assets/image (211).png>)

**_Note_** **_ghItlh_** **_cha'_** **_username_** **_je_** **_password_** **_ghItlh_** **_chu'_** **_parameters_** **_ghItlh_** **_cha'_** **_discovered_** **_ghItlh_** **_chu'_** **_try_** **_ghItlh_** **_something_** **_doesn't exist_** (`query={user(uid:1){noExists}}`) **_ghItlh_** **_cha'_** **_error_** **_ghItlh_**:

![](<../../.gitbook/assets/image (213).png>)

**_Enumeration phase_** **_Daq_** **_dbuser_** **_object_** **_cha'_** **_fields_** **_ghItlh_** **_cha'_** **_user_** **_je_** **_password_** **_ghItlh_**.

**_Query string dump trick (thanks to @BinaryShadow_)_**

**_String type_** **_search_** **_ghItlh_** **_cha'_** `query={theusers(description: ""){username,password}}` **_ghItlh_** **_cha'_** **_search_** **_ghItlh_** **_empty string_** **_ghItlh_** **_cha'_** **_dump all data_**. (_**_Note_**_**_ghItlh_**_**_cha'_**_**_example_**_**_ghItlh_**_**_cha'_** **_related_** **_ghItlh_** **_example_** **_ghItlh_** **_tutorials_** **_Daq_** **_example_** **_suppose_** **_ghItlh_** **_search_** "**_theusers_**" **_String field_** "**_description_**"_).

### **_Searching_**

**_Setup_** **_Daq_** **_database_** **_cha'_** **_persons_** **_je_** **_movies_** **_ghItlh_**. **_Persons_** **_cha'_** **_identified_** **_ghItlh_** **_email_** **_je_** **_name_**; **_movies_** **_cha'_** **_identified_** **_ghItlh_** **_name_** **_je_** **_rating_**. **_Persons_** **_cha'_** **_friends_** **_ghItlh_** **_each other_** **_je_** **_movies_** **_ghItlh_** **_indicate_** **_relationships_** **_ghItlh_** **_database_**.

**_Search_** **_ghItlh_** **_persons_** **_cha'_** **_name_** **_je_** **_emails_** **_ghItlh_** **_cha'_** **_search_** **_ghItlh_**:
```javascript
{
searchPerson(name: "John Doe") {
email
}
}
```
**jImej** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghotvam** **'e'** **vItlhutlh** **ghotvam** **'ej** **ghot
```javascript
{
searchPerson(name: "John Doe") {
email
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
ghItlh 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e' 'ej 'oH 'e'
```javascript
{
searchPerson(subscribedMovies: [{name: "Inception"}, {name: "Rocky"}]) {
name
}
}r
```
**ghItlhvamDaq 'ej vItlhutlh** **'ej** **'ay'** **DaparHa'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'ay'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'e'** **'
```javascript
{
johnsMovieList: searchPerson(name: "John Doe") {
subscribedMovies {
edges {
node {
name
}
}
}
}
davidsMovieList: searchPerson(name: "David Smith") {
subscribedMovies {
edges {
node {
name
}
}
}
}
}
```
### Mutations

**Mutations are used to make changes in the server-side.**

In the **introspection** you can find the **declared** **mutations**. In the following image the "_MutationType_" is called "_Mutation_" and the "_Mutation_" object contains the names of the mutations (like "_addPerson_" in this case):

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-26-27.png)

In this setup, a **database** contains **persons** and **movies**. **Persons** are identified by their **email** and **name**; **movies** by their **name** and **rating**. **Persons** can be friends with each other and also have movies, indicating relationships within the database.

A mutation to **create new** movies inside the database can be like the following one (in this example the mutation is called `addMovie`):

### Mutations

**Mutations are used to make changes in the server-side.**

In the **introspection** you can find the **declared** **mutations**. In the following image the "_MutationType_" is called "_Mutation_" and the "_Mutation_" object contains the names of the mutations (like "_addPerson_" in this case):

![](../../.gitbook/assets/screenshot-from-2021-03-13-18-26-27.png)

In this setup, a **database** contains **persons** and **movies**. **Persons** are identified by their **email** and **name**; **movies** by their **name** and **rating**. **Persons** can be friends with each other and also have movies, indicating relationships within the database.

A mutation to **create new** movies inside the database can be like the following one (in this example the mutation is called `addMovie`):
```javascript
mutation {
addMovie(name: "Jumanji: The Next Level", rating: "6.8/10", releaseYear: 2019) {
movies {
name
rating
}
}
}
```
**ghItlh 'ej Datlhutlh vItlhutlh.**

Dochvam'e' vItlhutlh 'ej 'ej vItlhutlh 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej 'ej '
```javascript
mutation {
addPerson(name: "James Yoe", email: "jy@example.com", friends: [{name: "John Doe"}, {email: "jd@example.com"}], subscribedMovies: [{name: "Rocky"}, {name: "Interstellar"}, {name: "Harry Potter and the Sorcerer's Stone"}]) {
person {
name
email
friends {
edges {
node {
name
email
}
}
}
subscribedMovies {
edges {
node {
name
rating
releaseYear
}
}
}
}
}
}
```
### Batching brute-force in 1 API request

This information was take from [https://lab.wallarm.com/graphql-batching-attack/](https://lab.wallarm.com/graphql-batching-attack/).\
Authentication through GraphQL API with **simultaneously sending many queries with different credentials** to check it. It‚Äôs a classic brute force attack, but now it‚Äôs possible to send more than one login/password pair per HTTP request because of the GraphQL batching feature. This approach would trick external rate monitoring applications into thinking all is well and there is no brute-forcing bot trying to guess passwords.

Below you can find the simplest demonstration of an application authentication request, with **3 different email/passwords pairs at a time**. Obviously it‚Äôs possible to send thousands in a single request in the same way:

![](<../../.gitbook/assets/image (182) (1).png>)

As we can see from the response screenshot, the first and the third requests returned _null_ and reflected the corresponding information in the _error_ section. The **second mutation had the correct authentication** data and the response has the correct authentication session token.

![](<../../.gitbook/assets/image (119) (1).png>)

## GraphQL Without Introspection

More and more **graphql endpoints are disabling introspection**. However, the errors that graphql throws when an unexpected request is received are enough for tools like [**clairvoyance**](https://github.com/nikitastupin/clairvoyance) to recreate most part of the schema.

Moreover, the Burp Suite extension [**GraphQuail**](https://github.com/forcesunseen/graphquail) extension **observes GraphQL API requests going through Burp** and **builds** an internal GraphQL **schema** with each new query it sees. It can also expose the schema for GraphiQL and Voyager. The extension returns a fake response when it receives an introspection query. As a result, GraphQuail shows all queries, arguments, and fields available for use within the API. For more info [**check this**](https://blog.forcesunseen.com/graphql-security-testing-without-a-schema).

A nice **wordlist** to discover [**GraphQL entities can be found here**](https://github.com/Escape-Technologies/graphql-wordlist?).

### Bypassing GraphQL introspection defences <a href="#bypassing-graphql-introspection-defences" id="bypassing-graphql-introspection-defences"></a>

### **Bypassing GraphQL Introspection Defenses**

To bypass restrictions on introspection queries in APIs, inserting a **special character after the `__schema` keyword** proves effective. This method exploits common developer oversights in regex patterns that aim to block introspection by focusing on the `__schema` keyword. By adding characters like **spaces, new lines, and commas**, which GraphQL ignores but might not be accounted for in regex, restrictions can be circumvented. For instance, an introspection query with a newline after `__schema` may bypass such defenses:
```bash
# Example with newline to bypass
{
"query": "query{__schema
{queryType{name}}}"
}
```
**ghItlhlaHbe', 'GET request'** or **POST with `x-www-form-urlencoded`** methods, 'ach ghaH, POST requestmeyDaq yIqaw'egh, **GET request** or **POST with `x-www-form-urlencoded`** methods, 'ach ghaH, POST requestmeyDaq yIqaw'egh, 'ach ghaH.

### **Exposed GraphQL Structures tIq**

vaj introspection vItlhutlh, JavaScript librariesDaq preloaded queries website's source code vItlhutlh. 'ach, 'ach Developer toolsDaq 'oH tab SourcesDaq, API's schema 'ej potentially **exposed sensitive queries** vItlhutlh. Developer toolsDaq search commands:
```javascript
Inspect/Sources/"Search all files"
file:* mutation
file:* query
```
## CSRF in GraphQL

{!csrf-cross-site-request-forgery.md!}

Out there you are going to be able to find several GraphQL endpoints **configured without CSRF tokens.**

Note that GraphQL request are usually sent via POST requests using the Content-Type **`application/json`**.
```javascript
{"operationName":null,"variables":{},"query":"{\n  user {\n    firstName\n    __typename\n  }\n}\n"}
```
**`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded` POST requests** **`form-urlencoded`
```javascript
query=%7B%0A++user+%7B%0A++++firstName%0A++++__typename%0A++%7D%0A%7D%0A
```
**ngoD**, CSRF **yI'el** **requests** **ghaH** **preflight requests** **bI'el**, **GraphQL** **abusing** **CSRF** **changes** **perform** **possible**.

**'ach**, **cookie** **value** **Chrome** **flag** `samesite` **new default** **note** `Lax`. **cookie** **third party web** **GET requests** **be sent** **will**.

**'ach**, **query** **request** **GET** **request** **also** **possible** **usually** **GET request** **validated** **token** **CSRF** **being** **might**.

[**XS-Search**](../../pentesting-web/xs-search.md) **attack** **abusing** **endpoint** **GraphQL** **content** **exfiltrate** **possible** **might** **user** **credentials**.

**more information** **check the** [**original post here**](https://blog.doyensec.com/2021/05/20/graphql-csrf.html).

## **Authorization** **GraphQL**

**Many** **functions** **GraphQL** **defined** **endpoint** **requester** **authentication** **check** **only** **might** **but** **authorization**.

**Modifying** **variables** **input** **query** **lead** **details** **account** **sensitive** **leaked**.

**Mutation** **data** **account** **other** **modify** **trying** **takeover** **account** **lead** **even** **could**.
```javascript
{
"operationName":"updateProfile",
"variables":{"username":INJECT,"data":INJECT},
"query":"mutation updateProfile($username: String!,...){updateProfile(username: $username,...){...}}"
}
```
### Bypass authorization in GraphQL

[Chaining queries](https://s1n1st3r.gitbook.io/theb10g/graphql-query-authentication-bypass-vuln) together can bypass a weak authentication system.

In the below example you can see that the operation is "forgotPassword" and that it should only execute the forgotPassword query associated with it. This can be bypassed by adding a query to the end, in this case we add "register" and a user variable for the system to register as a new user.

<figure><img src="../../.gitbook/assets/GraphQLAuthBypassMethod.PNG" alt=""><figcaption></figcaption></figure>

## Bypassing Rate Limits Using Aliases in GraphQL

In GraphQL, aliases are a powerful feature that allow for the **naming of properties explicitly** when making an API request. This capability is particularly useful for retrieving **multiple instances of the same type** of object within a single request. Aliases can be employed to overcome the limitation that prevents GraphQL objects from having multiple properties with the same name.

For a detailed understanding of GraphQL aliases, the following resource is recommended: [Aliases](https://portswigger.net/web-security/graphql/what-is-graphql#aliases).

While the primary purpose of aliases is to reduce the necessity for numerous API calls, an unintended use case has been identified where aliases can be leveraged to execute brute force attacks on a GraphQL endpoint. This is possible because some endpoints are protected by rate limiters designed to thwart brute force attacks by restricting the **number of HTTP requests**. However, these rate limiters might not account for the number of operations within each request. Given that aliases allow for the inclusion of multiple queries in a single HTTP request, they can circumvent such rate limiting measures.

Consider the example provided below, which illustrates how aliased queries can be used to verify the validity of store discount codes. This method could sidestep rate limiting since it compiles several queries into one HTTP request, potentially allowing for the verification of numerous discount codes simultaneously.
```bash
# Example of a request utilizing aliased queries to check for valid discount codes
query isValidDiscount($code: Int) {
isvalidDiscount(code:$code){
valid
}
isValidDiscount2:isValidDiscount(code:$code){
valid
}
isValidDiscount3:isValidDiscount(code:$code){
valid
}
}
```
## Tools

### Vulnerability scanners

* [https://github.com/gsmith257-cyber/GraphCrawler](https://github.com/gsmith257-cyber/GraphCrawler): Toolkit that can be used to grab schemas and search for sensitive data, test authorization, brute force schemas, and find paths to a given type.
* [https://blog.doyensec.com/2020/03/26/graphql-scanner.html](https://blog.doyensec.com/2020/03/26/graphql-scanner.html): Can be used as standalone or [Burp extension](https://github.com/doyensec/inql).
* [https://github.com/swisskyrepo/GraphQLmap](https://github.com/swisskyrepo/GraphQLmap): Can be used as a CLI client also to automate attacks
* [https://gitlab.com/dee-see/graphql-path-enum](https://gitlab.com/dee-see/graphql-path-enum): Tool that lists the different ways of reaching a given type in a GraphQL schema.
* [https://github.com/doyensec/inql](https://github.com/doyensec/inql): Burp extension for advanced GraphQL testing. The _**Scanner**_ is the core of InQL v5.0, where you can analyze a GraphQL endpoint or a local introspection schema file. It auto-generates all possible queries and mutations, organizing them into a structured view for your analysis. The _**Attacker**_ component lets you run batch GraphQL attacks, which can be useful for circumventing poorly implemented rate limits.

### Clients

* [https://github.com/graphql/graphiql](https://github.com/graphql/graphiql): GUI client
* [https://altair.sirmuel.design/](https://altair.sirmuel.design/): GUI Client

### Automatic Tests

{% embed url="https://graphql-dashboard.herokuapp.com/" %}

* Video explaining AutoGraphQL: [https://www.youtube.com/watch?v=JJmufWfVvyU](https://www.youtube.com/watch?v=JJmufWfVvyU)

## References

* [**https://jondow.eu/practical-graphql-attack-vectors/**](https://jondow.eu/practical-graphql-attack-vectors/)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4**](https://medium.com/@apkash8/graphql-vs-rest-api-model-common-security-test-cases-for-graphql-endpoints-5b723b1468b4)
* [**http://ghostlulz.com/api-hacking-graphql/**](http://ghostlulz.com/api-hacking-graphql/)
* [**https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md**](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/GraphQL%20Injection/README.md)
* [**https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696**](https://medium.com/@the.bilal.rizwan/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696)
* [**https://portswigger.net/web-security/graphql**](https://portswigger.net/web-security/graphql)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
