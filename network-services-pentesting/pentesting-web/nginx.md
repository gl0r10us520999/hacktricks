# Nginx

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Instantly available setup for vulnerability assessment & penetration testing**. Run a full pentest from anywhere with 20+ tools & features that go from recon to reporting. We don't replace pentesters - we develop custom tools, detection & exploitation modules to give them back some time to dig deeper, pop shells, and have fun.

{% embed url="https://pentest-tools.com/" %}

## Missing root location <a href="#missing-root-location" id="missing-root-location"></a>

## **Essentials of Configuring Nginx Root Directory**

When configuring the Nginx server, the **root directive** plays a critical role by defining the base directory from which files are served. Consider the example below:
```bash
server {
root /etc/nginx;

location /hello.txt {
try_files $uri $uri/ =404;
proxy_pass http://127.0.0.1:8080/;
}
}
```
In this configuration, `/etc/nginx` is designated as the root directory. This setup allows access to files within the specified root directory, such as `/hello.txt`. However, it's crucial to note that only a specific location (`/hello.txt`) is defined. There's no configuration for the root location (`location / {...}`). This omission means that the root directive applies globally, enabling requests to the root path `/` to access files under `/etc/nginx`.

A critical security consideration arises from this configuration. A simple `GET` request, like `GET /nginx.conf`, could expose sensitive information by serving the Nginx configuration file located at `/etc/nginx/nginx.conf`. Setting the root to a less sensitive directory, like `/etc`, could mitigate this risk, yet it still may allow unintended access to other critical files, including other configuration files, access logs, and even encrypted credentials used for HTTP basic authentication.

## Alias LFI Misconfiguration <a href="#alias-lfi-misconfiguration" id="alias-lfi-misconfiguration"></a>

In the configuration files of Nginx, a close inspection is warranted for the "location" directives. A vulnerability known as Local File Inclusion (LFI) can be inadvertently introduced through a configuration that resembles the following:

---

**ghItlh:** 
vaj `/etc/nginx` vItlhutlh. vajtaHvIS, `/hello.txt` vItlhutlh `/etc/nginx` Daq vItlhutlh, vajtaHvIS `/hello.txt` vItlhutlh. 'ach, vItlhutlh `/` Daq vItlhutlh (`location / {...}`) vItlhutlh. vajtaHvIS, `/etc/nginx` Daq vItlhutlh `/` Daq vItlhutlh, vItlhutlh `/` Daq vItlhutlh `/etc/nginx` Daq vItlhutlh.

vItlhutlh vItlhutlh `/nginx.conf` vItlhutlh `GET` vItlhutlh, `GET /nginx.conf`, vItlhutlh `/etc/nginx/nginx.conf` Daq vItlhutlh. vItlhutlh `/etc` Daq vItlhutlh `/etc/nginx` Daq vItlhutlh, vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vItlhutlh vIt
```
location /imgs {
alias /path/images/;
}
```
**Translation:**

```
ghItlhvam vItlhutlh. /imgs../flag.txt vItlhutlh, /path/images/../flag.txt vItlhutlh. vItlhutlhbe'chugh, webDaq qabDajDaq vItlhutlhbe'chugh vItlhutlhbe'chugh, vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'chugh vItlhutlhbe'
```
location /imgs/ {
alias /path/images/;
}
```
More info: [https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/](https://www.acunetix.com/vulnerabilities/web/path-traversal-via-misconfigured-nginx-alias/)

Accunetix tests:
```
alias../ => HTTP status code 403
alias.../ => HTTP status code 404
alias../../ => HTTP status code 403
alias../../../../../../../../../../../ => HTTP status code 400
alias../ => HTTP status code 403
```
## QaD jopwI' <a href="#QaD-jopwI'" id="QaD-jopwI'"></a>

QaD jopwI' vItlhutlhlaHchu' 'ej vItlhutlhlaHchu' pagh 'e' vItlhutlhlaHchu' 'e' vItlhutlhlaHchu' pagh:
```plaintext
location = /admin {
deny all;
}

location = /admin/ {
deny all;
}
```
## qaw'Ha' variable use <a href="#unsafe-variable-use" id="unsafe-variable-use"></a>

Nginx configuration vItlhutlh 'e' vItlhutlh 'e' vulnerability 'e' demonstrated 'e' Nginx configuration example vItlhutlh:
```
location / {
return 302 https://example.com$uri;
}
```
The characters \r (Carriage Return) and \n (Line Feed) signify new line characters in HTTP requests, and their URL-encoded forms are represented as `%0d%0a`. Including these characters in a request (e.g., `http://localhost/%0d%0aDetectify:%20clrf`) to a misconfigured server results in the server issuing a new header named `Detectify`. This happens because the $uri variable decodes the URL-encoded new line characters, leading to an unexpected header in the response:

---

The characters \r (Carriage Return) and \n (Line Feed) signify new line characters in HTTP requests, and their URL-encoded forms are represented as `%0d%0a`. Including these characters in a request (e.g., `http://localhost/%0d%0aDetectify:%20clrf`) to a misconfigured server results in the server issuing a new header named `Detectify`. This happens because the $uri variable decodes the URL-encoded new line characters, leading to an unexpected header in the response:
```
HTTP/1.1 302 Moved Temporarily
Server: nginx/1.19.3
Content-Type: text/html
Content-Length: 145
Connection: keep-alive
Location: https://example.com/
Detectify: clrf
```
### QaHvIn

[https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/](https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/) Daq 'e' vItlhutlh.

### vItlhutlh

**user-supplied data** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'** **Nginx variable** **ghItlh** **cheghpu'** **ghItlh** **cheghpu'
```bash
$ curl -H ‚ÄòReferer: bar‚Äô http://localhost/foo$http_referer | grep ‚Äòfoobar‚Äô
```
Scans for this misconfiguration across systems revealed multiple instances where Nginx variables could be printed by a user. However, a decrease in the number of vulnerable instances suggests that efforts to patch this issue have been somewhat successful.

## Raw backend response reading


Nginx offers a feature through `proxy_pass` that allows for the interception of errors and HTTP headers produced by the backend, aiming to hide internal error messages and headers. This is accomplished by Nginx serving custom error pages in response to backend errors. However, challenges arise when Nginx encounters an invalid HTTP request. Such a request gets forwarded to the backend as received, and the backend's raw response is then directly sent to the client without Nginx's intervention.

Consider an example scenario involving a uWSGI application:
```python
def application(environ, start_response):
start_response('500 Error', [('Content-Type', 'text/html'), ('Secret-Header', 'secret-info')])
return [b"Secret info, should not be visible!"]
```
To'wI' jatlhbe'chugh, Nginx qonwI'wI' jatlhbe'chugh vItlhutlh.
```
http {
error_page 500 /html/error.html;
proxy_intercept_errors on;
proxy_hide_header Secret-Header;
}
```
- **[proxy_intercept_errors](http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_intercept_errors)**: This directive enables Nginx to serve a custom response for backend responses with a status code greater than 300. It ensures that, for our example uWSGI application, a `500 Error` response is intercepted and handled by Nginx.
- **[proxy_hide_header](http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_hide_header)**: As the name suggests, this directive hides specified HTTP headers from the client, enhancing privacy and security.

When a valid `GET` request is made, Nginx processes it normally, returning a standard error response without revealing any secret headers. However, an invalid HTTP request bypasses this mechanism, resulting in the exposure of raw backend responses, including secret headers and error messages.


## merge\_slashes set to off

By default, Nginx's **`merge_slashes` directive** is set to **`on`**, which compresses multiple forward slashes in a URL into a single slash. This feature, while streamlining URL processing, can inadvertently conceal vulnerabilities in applications behind Nginx, particularly those prone to local file inclusion (LFI) attacks. Security experts **Danny Robinson and Rotem Bar** have highlighted the potential risks associated with this default behavior, especially when Nginx acts as a reverse-proxy.

To mitigate such risks, it is recommended to **turn the `merge_slashes` directive off** for applications susceptible to these vulnerabilities. This ensures that Nginx forwards requests to the application without altering the URL structure, thereby not masking any underlying security issues.

For more information check [Danny Robinson and Rotem Bar](https://medium.com/appsflyer/nginx-may-be-protecting-your-applications-from-traversal-attacks-without-you-even-knowing-b08f882fd43d).

### **Default Value in Map Directive**

In the **Nginx configuration**, the `map` directive often plays a role in **authorization control**. A common mistake is not specifying a **default** value, which could lead to unauthorized access. For instance:
```yaml
http {
map $uri $mappocallow {
/map-poc/private 0;
/map-poc/secret 0;
/map-poc/public 1;
}
}
```

```yaml
server {
location /map-poc {
if ($mappocallow = 0) {return 403;}
return 200 "Hello. It is private area: $mappocallow";
}
}
```
`default` jImej, `/map-poc` Daq **undefined URI** vItlhutlh **malicious user** vItlhutlh **security** bypass. [The Nginx manual](https://nginx.org/en/docs/http/ngx_http_map_module.html) **default value** vItlhutlh **set** vItlhutlh **advises**.

### **DNS Spoofing Vulnerability**

DNS spoofing Nginx Daq **feasible** vItlhutlh **certain conditions**. Nginx vItlhutlh **DNS server** vItlhutlh **attacker** vItlhutlh **knows** 'ej **DNS queries** intercept vItlhutlh, DNS records spoof vItlhutlh. **Method** vItlhutlh, Nginx vItlhutlh **configured** vItlhutlh **localhost (127.0.0.1)** DNS resolution vItlhutlh. Nginx vItlhutlh **DNS server** vItlhutlh **specifying** vItlhutlh:
```yaml
resolver 8.8.8.8;
```
### **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`**

**`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`** **`proxy_set_header Upgrade & Connection`** **`proxy_pass`** **`internal`
```
server {
listen       443 ssl;
server_name  localhost;

ssl_certificate       /usr/local/nginx/conf/cert.pem;
ssl_certificate_key   /usr/local/nginx/conf/privkey.pem;

location / {
proxy_pass http://backend:9999;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection $http_connection;
}

location /flag {
deny all;
}
```
{% hint style="warning" %}
Qatlh 'e' vItlhutlh 'e' proxy_pass 'e' 'path' 'e' 'http://backend:9999/socket.io' vaj 'e' 'http://backend:9999' 'e' vItlhutlh. 'ej 'oH 'e' 'URL' proxy_pass 'e' path 'e' jatlh 'e' vItlhutlh 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' 'e' '
