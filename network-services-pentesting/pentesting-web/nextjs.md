# NextJS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ë°˜ ì•„í‚¤í…ì²˜

### ì¼ë°˜ì ì¸ íŒŒì¼ êµ¬ì¡°

í‘œì¤€ Next.js í”„ë¡œì íŠ¸ëŠ” ë¼ìš°íŒ…, API ì—”ë“œí¬ì¸íŠ¸ ë° ì •ì  ìì‚° ê´€ë¦¬ë¥¼ ìš©ì´í•˜ê²Œ í•˜ëŠ” íŠ¹ì • íŒŒì¼ ë° ë””ë ‰í† ë¦¬ êµ¬ì¡°ë¥¼ ë”°ë¦…ë‹ˆë‹¤. ë‹¤ìŒì€ ì¼ë°˜ì ì¸ ë ˆì´ì•„ì›ƒì…ë‹ˆë‹¤:
```lua
my-nextjs-app/
â”œâ”€â”€ node_modules/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â””â”€â”€ logo.png
â”‚   â””â”€â”€ favicon.ico
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ hello/
â”‚   â”‚       â””â”€â”€ route.ts
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â””â”€â”€ Footer.tsx
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”œâ”€â”€ globals.css
â”‚   â”‚   â””â”€â”€ Home.module.css
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ api.ts
â”œâ”€â”€ .env.local
â”œâ”€â”€ next.config.js
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
â”œâ”€â”€ README.md
â””â”€â”€ yarn.lock / package-lock.json

```
### Core Directories and Files

* **public/:** ì •ì  ìì‚°(ì´ë¯¸ì§€, ê¸€ê¼´ ë° ê¸°íƒ€ íŒŒì¼)ì„ í˜¸ìŠ¤íŒ…í•©ë‹ˆë‹¤. ì—¬ê¸°ì˜ íŒŒì¼ì€ ë£¨íŠ¸ ê²½ë¡œ(`/`)ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **app/:** ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í˜ì´ì§€, ë ˆì´ì•„ì›ƒ, êµ¬ì„± ìš”ì†Œ ë° API ê²½ë¡œì˜ ì¤‘ì•™ ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. **App Router** íŒ¨ëŸ¬ë‹¤ì„ì„ ìˆ˜ìš©í•˜ì—¬ ê³ ê¸‰ ë¼ìš°íŒ… ê¸°ëŠ¥ê³¼ ì„œë²„-í´ë¼ì´ì–¸íŠ¸ êµ¬ì„± ìš”ì†Œ ë¶„ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
* **app/layout.tsx:** ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë£¨íŠ¸ ë ˆì´ì•„ì›ƒì„ ì •ì˜í•˜ë©°, ëª¨ë“  í˜ì´ì§€ë¥¼ ê°ì‹¸ê³  í—¤ë”, í‘¸í„° ë° ë‚´ë¹„ê²Œì´ì…˜ ë°”ì™€ ê°™ì€ ì¼ê´€ëœ UI ìš”ì†Œë¥¼ ì œê³µí•©ë‹ˆë‹¤.
* **app/page.tsx:** ë£¨íŠ¸ ê²½ë¡œ `/`ì˜ ì§„ì…ì  ì—­í• ì„ í•˜ë©°, í™ˆ í˜ì´ì§€ë¥¼ ë Œë”ë§í•©ë‹ˆë‹¤.
* **app/\[route]/page.tsx:** ì •ì  ë° ë™ì  ê²½ë¡œë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. `app/` ë‚´ì˜ ê° í´ë”ëŠ” ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ë©°, í•´ë‹¹ í´ë” ë‚´ì˜ `page.tsx`ëŠ” ê²½ë¡œì˜ êµ¬ì„± ìš”ì†Œì— í•´ë‹¹í•©ë‹ˆë‹¤.
* **app/api/:** API ê²½ë¡œë¥¼ í¬í•¨í•˜ë©°, HTTP ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ë¡œëŠ” ì „í†µì ì¸ `pages/api` ë””ë ‰í† ë¦¬ë¥¼ ëŒ€ì²´í•©ë‹ˆë‹¤.
* **app/components/:** ë‹¤ì–‘í•œ í˜ì´ì§€ì™€ ë ˆì´ì•„ì›ƒì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ React êµ¬ì„± ìš”ì†Œë¥¼ ë³´ê´€í•©ë‹ˆë‹¤.
* **app/styles/:** êµ¬ì„± ìš”ì†Œ ë²”ìœ„ ìŠ¤íƒ€ì¼ë§ì„ ìœ„í•œ ì „ì—­ CSS íŒŒì¼ ë° CSS ëª¨ë“ˆì„ í¬í•¨í•©ë‹ˆë‹¤.
* **app/utils/:** ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì—ì„œ ê³µìœ í•  ìˆ˜ ìˆëŠ” ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜, í—¬í¼ ëª¨ë“ˆ ë° ê¸°íƒ€ ë¹„ UI ë…¼ë¦¬ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **.env.local:** ë¡œì»¬ ê°œë°œ í™˜ê²½ì— íŠ¹ì •í•œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì €ì¥í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë³€ìˆ˜ëŠ” **ë²„ì „ ê´€ë¦¬ì— ì»¤ë°‹ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
* **next.config.js:** Next.js ë™ì‘ì„ ì‚¬ìš©ì ì •ì˜í•˜ë©°, webpack êµ¬ì„±, í™˜ê²½ ë³€ìˆ˜ ë° ë³´ì•ˆ ì„¤ì •ì„ í¬í•¨í•©ë‹ˆë‹¤.
* **tsconfig.json:** í”„ë¡œì íŠ¸ì˜ TypeScript ì„¤ì •ì„ êµ¬ì„±í•˜ì—¬ íƒ€ì… ê²€ì‚¬ ë° ê¸°íƒ€ TypeScript ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤.
* **package.json:** í”„ë¡œì íŠ¸ ì¢…ì†ì„±, ìŠ¤í¬ë¦½íŠ¸ ë° ë©”íƒ€ë°ì´í„°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
* **README.md:** í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì„œ ë° ì •ë³´ë¥¼ ì œê³µí•˜ë©°, ì„¤ì • ì§€ì¹¨, ì‚¬ìš© ê°€ì´ë“œ ë° ê¸°íƒ€ ê´€ë ¨ ì„¸ë¶€ ì •ë³´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
* **yarn.lock / package-lock.json:** í”„ë¡œì íŠ¸ì˜ ì¢…ì†ì„±ì„ íŠ¹ì • ë²„ì „ìœ¼ë¡œ ê³ ì •í•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì¼ê´€ëœ ì„¤ì¹˜ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

## Client-Side in Next.js

### File-Based Routing in the `app` Directory

`app` ë””ë ‰í† ë¦¬ëŠ” ìµœì‹  Next.js ë²„ì „ì—ì„œ ë¼ìš°íŒ…ì˜ ì´ˆì„ì…ë‹ˆë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì„ í™œìš©í•˜ì—¬ ê²½ë¡œë¥¼ ì •ì˜í•˜ì—¬ ë¼ìš°íŠ¸ ê´€ë¦¬ë¥¼ ì§ê´€ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

<details>

<summary>Handling the Root Path /</summary>

**File Structure:**
```arduino
my-nextjs-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.js
â””â”€â”€ ...
```
**ì£¼ìš” íŒŒì¼:**

* **`app/page.tsx`**: ë£¨íŠ¸ ê²½ë¡œ `/`ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
* **`app/layout.tsx`**: ëª¨ë“  í˜ì´ì§€ë¥¼ ê°ì‹¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë ˆì´ì•„ì›ƒì„ ì •ì˜í•©ë‹ˆë‹¤.

**êµ¬í˜„:**
```tsx
tsxCopy code// app/page.tsx

export default function HomePage() {
return (
<div>
<h1>Welcome to the Home Page!</h1>
<p>This is the root route.</p>
</div>
);
}
```
**ì„¤ëª…:**

* **ê²½ë¡œ ì •ì˜:** `app` ë””ë ‰í† ë¦¬ ë°”ë¡œ ì•„ë˜ì˜ `page.tsx` íŒŒì¼ì€ `/` ê²½ë¡œì— í•´ë‹¹í•©ë‹ˆë‹¤.
* **ë Œë”ë§:** ì´ ì»´í¬ë„ŒíŠ¸ëŠ” í™ˆ í˜ì´ì§€ì˜ ë‚´ìš©ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
* **ë ˆì´ì•„ì›ƒ í†µí•©:** `HomePage` ì»´í¬ë„ŒíŠ¸ëŠ” í—¤ë”, í‘¸í„° ë° ê¸°íƒ€ ê³µí†µ ìš”ì†Œë¥¼ í¬í•¨í•  ìˆ˜ ìˆëŠ” `layout.tsx`ë¡œ ê°ì‹¸ì ¸ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>ë‹¤ë¥¸ ì •ì  ê²½ë¡œ ì²˜ë¦¬</summary>



**ì˜ˆì‹œ: `/about` ê²½ë¡œ**

**íŒŒì¼ êµ¬ì¡°:**
```arduino
arduinoCopy codemy-nextjs-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ about/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.js
â””â”€â”€ ...
```
**êµ¬í˜„:**
```tsx
// app/about/page.tsx

export default function AboutPage() {
return (
<div>
<h1>About Us</h1>
<p>Learn more about our mission and values.</p>
</div>
);
}
```
**ì„¤ëª…:**

* **ê²½ë¡œ ì •ì˜:** `about` í´ë” ì•ˆì˜ `page.tsx` íŒŒì¼ì€ `/about` ê²½ë¡œì— í•´ë‹¹í•©ë‹ˆë‹¤.
* **ë Œë”ë§:** ì´ ì»´í¬ë„ŒíŠ¸ëŠ” about í˜ì´ì§€ì˜ ë‚´ìš©ì„ ë Œë”ë§í•©ë‹ˆë‹¤.

</details>

<details>

<summary>ë™ì  ê²½ë¡œ</summary>

ë™ì  ê²½ë¡œëŠ” ë³€ìˆ˜ ì„¸ê·¸ë¨¼íŠ¸ê°€ ìˆëŠ” ê²½ë¡œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•˜ì—¬, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ID, ìŠ¬ëŸ¬ê·¸ ë“±ê³¼ ê°™ì€ ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ ë‚´ìš©ì„ í‘œì‹œí•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ: `/posts/[id]` ê²½ë¡œ**

**íŒŒì¼ êµ¬ì¡°:**
```arduino
arduinoCopy codemy-nextjs-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ posts/
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.js
â””â”€â”€ ...
```
**êµ¬í˜„:**
```tsx
tsxCopy code// app/posts/[id]/page.tsx

import { useRouter } from 'next/navigation';

interface PostProps {
params: { id: string };
}

export default function PostPage({ params }: PostProps) {
const { id } = params;
// Fetch post data based on 'id'

return (
<div>
<h1>Post #{id}</h1>
<p>This is the content of post {id}.</p>
</div>
);
}
```
**ì„¤ëª…:**

* **ë™ì  ì„¸ê·¸ë¨¼íŠ¸:** `[id]`ëŠ” ê²½ë¡œì—ì„œ ë™ì  ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ë©°, URLì—ì„œ `id` ë§¤ê°œë³€ìˆ˜ë¥¼ ìº¡ì²˜í•©ë‹ˆë‹¤.
* **ë§¤ê°œë³€ìˆ˜ ì ‘ê·¼:** `params` ê°ì²´ëŠ” ë™ì  ë§¤ê°œë³€ìˆ˜ë¥¼ í¬í•¨í•˜ë©°, ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê²½ë¡œ ì¼ì¹˜:** `/posts/*`ì™€ ì¼ì¹˜í•˜ëŠ” ëª¨ë“  ê²½ë¡œ, ì˜ˆë¥¼ ë“¤ì–´ `/posts/1`, `/posts/abc` ë“±ì´ ì´ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ ì²˜ë¦¬ë©ë‹ˆë‹¤.

</details>

<details>

<summary>ì¤‘ì²© ê²½ë¡œ</summary>



Next.jsëŠ” ì¤‘ì²© ë¼ìš°íŒ…ì„ ì§€ì›í•˜ì—¬ ë””ë ‰í† ë¦¬ ë ˆì´ì•„ì›ƒì„ ë°˜ì˜í•˜ëŠ” ê³„ì¸µì  ê²½ë¡œ êµ¬ì¡°ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ: `/dashboard/settings/profile` ê²½ë¡œ**

**íŒŒì¼ êµ¬ì¡°:**
```arduino
arduinoCopy codemy-nextjs-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”‚   â””â”€â”€ profile/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.js
â””â”€â”€ ...
```
**êµ¬í˜„:**
```tsx
tsxCopy code// app/dashboard/settings/profile/page.tsx

export default function ProfileSettingsPage() {
return (
<div>
<h1>Profile Settings</h1>
<p>Manage your profile information here.</p>
</div>
);
}
```
**ì„¤ëª…:**

* **ê¹Šì€ ì¤‘ì²©:** `dashboard/settings/profile/` ë‚´ë¶€ì˜ `page.tsx` íŒŒì¼ì€ `/dashboard/settings/profile` ê²½ë¡œì— í•´ë‹¹í•©ë‹ˆë‹¤.
* **ê³„ì¸µ ë°˜ì˜:** ë””ë ‰í† ë¦¬ êµ¬ì¡°ëŠ” URL ê²½ë¡œë¥¼ ë°˜ì˜í•˜ì—¬ ìœ ì§€ ê´€ë¦¬ì„±ê³¼ ëª…í™•ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

</details>

<details>

<summary>ëª¨ë“  ê²½ë¡œ ì²˜ë¦¬</summary>

ëª¨ë“  ê²½ë¡œ ì²˜ë¦¬ëŠ” ì—¬ëŸ¬ ì¤‘ì²© ì„¸ê·¸ë¨¼íŠ¸ ë˜ëŠ” ì•Œ ìˆ˜ ì—†ëŠ” ê²½ë¡œë¥¼ ì²˜ë¦¬í•˜ì—¬ ê²½ë¡œ ì²˜ë¦¬ì˜ ìœ ì—°ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.

**ì˜ˆì‹œ: `/*` ê²½ë¡œ**

**íŒŒì¼ êµ¬ì¡°:**
```arduino
my-nextjs-app/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ [..slug]/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ public/
â”œâ”€â”€ next.config.js
â””â”€â”€ ...
```
**êµ¬í˜„:**
```tsx
// app/[...slug]/page.tsx

interface CatchAllProps {
params: { slug: string[] };
}

export default function CatchAllPage({ params }: CatchAllProps) {
const { slug } = params;
const fullPath = `/${slug.join('/')}`;

return (
<div>
<h1>Catch-All Route</h1>
<p>You have navigated to: {fullPath}</p>
</div>
);
}
```
**ì„¤ëª…:**

* **Catch-All ì„¸ê·¸ë¨¼íŠ¸:** `[...slug]`ëŠ” ë‚¨ì€ ëª¨ë“  ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë°°ì—´ë¡œ ìº¡ì²˜í•©ë‹ˆë‹¤.
* **ì‚¬ìš©ë²•:** ì‚¬ìš©ì ìƒì„± ê²½ë¡œ, ì¤‘ì²© ì¹´í…Œê³ ë¦¬ ë“±ê³¼ ê°™ì€ ë™ì  ë¼ìš°íŒ… ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
* **ê²½ë¡œ ì¼ì¹˜:** `/anything/here`, `/foo/bar/baz`ì™€ ê°™ì€ ê²½ë¡œëŠ” ì´ êµ¬ì„± ìš”ì†Œì— ì˜í•´ ì²˜ë¦¬ë©ë‹ˆë‹¤.

</details>

### ì ì¬ì ì¸ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì·¨ì•½ì 

Next.jsëŠ” ì•ˆì „í•œ ê¸°ë°˜ì„ ì œê³µí•˜ì§€ë§Œ, ë¶€ì ì ˆí•œ ì½”ë”© ê´€í–‰ì€ ì·¨ì•½ì ì„ ë„ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì£¼ìš” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì·¨ì•½ì ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

<details>

<summary>êµì°¨ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ… (XSS)</summary>

XSS ê³µê²©ì€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì›¹ì‚¬ì´íŠ¸ì— ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ ì£¼ì…ë  ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ í›”ì¹˜ê±°ë‚˜ ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì·¨ì•½í•œ ì½”ë“œì˜ ì˜ˆ:**
```jsx
// Dangerous: Injecting user input directly into HTML
function Comment({ userInput }) {
return <div dangerouslySetInnerHTML={{ __html: userInput }} />;
}
```
**ì™œ ì·¨ì•½í•œê°€:** ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì…ë ¥ê³¼ í•¨ê»˜ `dangerouslySetInnerHTML`ì„ ì‚¬ìš©í•˜ë©´ ê³µê²©ìê°€ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>í´ë¼ì´ì–¸íŠ¸ ì¸¡ í…œí”Œë¦¿ ì£¼ì…</summary>

ì‚¬ìš©ì ì…ë ¥ì´ í…œí”Œë¦¿ì—ì„œ ë¶€ì ì ˆí•˜ê²Œ ì²˜ë¦¬ë  ë•Œ ë°œìƒí•˜ë©°, ê³µê²©ìê°€ í…œí”Œë¦¿ì´ë‚˜ í‘œí˜„ì‹ì„ ì£¼ì…í•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

**ì·¨ì•½í•œ ì½”ë“œì˜ ì˜ˆ:**
```jsx
import React from 'react';
import ejs from 'ejs';

function RenderTemplate({ template, data }) {
const html = ejs.render(template, data);
return <div dangerouslySetInnerHTML={{ __html: html }} />;
}
```
**ì™œ ì·¨ì•½í•œê°€:** `template` ë˜ëŠ” `data`ì— ì•…ì˜ì ì¸ ë‚´ìš©ì´ í¬í•¨ë˜ë©´ ì˜ë„í•˜ì§€ ì•Šì€ ì½”ë“œ ì‹¤í–‰ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>í´ë¼ì´ì–¸íŠ¸ ê²½ë¡œ íƒìƒ‰</summary>

ì´ëŠ” ê³µê²©ìê°€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ê²½ë¡œë¥¼ ì¡°ì‘í•˜ì—¬ Cross-Site Request Forgery (CSRF)ì™€ ê°™ì€ ì˜ë„í•˜ì§€ ì•Šì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì·¨ì•½ì ì…ë‹ˆë‹¤. ì„œë²„ ì¸¡ ê²½ë¡œ íƒìƒ‰ì´ ì„œë²„ì˜ íŒŒì¼ ì‹œìŠ¤í…œì„ ëª©í‘œë¡œ í•˜ëŠ” ê²ƒê³¼ ë‹¬ë¦¬, CSPTëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë©”ì»¤ë‹ˆì¦˜ì„ ì•…ìš©í•˜ì—¬ í•©ë²•ì ì¸ API ìš”ì²­ì„ ì•…ì˜ì ì¸ ì—”ë“œí¬ì¸íŠ¸ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ë° ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.

**ì·¨ì•½í•œ ì½”ë“œì˜ ì˜ˆ:**

Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì‚¬ìš©ìê°€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©°, ì‚¬ìš©ìê°€ ë‹¤ìš´ë¡œë“œí•  íŒŒì¼ ê²½ë¡œë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```jsx
// pages/download.js
import { useState } from 'react';

export default function DownloadPage() {
const [filePath, setFilePath] = useState('');

const handleDownload = () => {
fetch(`/api/files/${filePath}`)
.then(response => response.blob())
.then(blob => {
const url = window.URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = filePath;
a.click();
});
};

return (
<div>
<h1>Download File</h1>
<input
type="text"
value={filePath}
onChange={(e) => setFilePath(e.target.value)}
placeholder="Enter file path"
/>
<button onClick={handleDownload}>Download</button>
</div>
);
}
```
#### ê³µê²© ì‹œë‚˜ë¦¬ì˜¤

1. **ê³µê²©ìì˜ ëª©í‘œ**: `filePath`ë¥¼ ì¡°ì‘í•˜ì—¬ ì¤‘ìš”í•œ íŒŒì¼(ì˜ˆ: `admin/config.json`)ì„ ì‚­ì œí•˜ëŠ” CSRF ê³µê²© ìˆ˜í–‰.
2. **CSPT ì•…ìš©**:
* **ì•…ì˜ì ì¸ ì…ë ¥**: ê³µê²©ìëŠ” `../deleteFile/config.json`ê³¼ ê°™ì€ ì¡°ì‘ëœ `filePath`ë¥¼ ê°€ì§„ URLì„ ìƒì„±.
* **ê²°ê³¼ API í˜¸ì¶œ**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œê°€ `/api/files/../deleteFile/config.json`ì— ìš”ì²­ì„ ë³´ëƒ„.
* **ì„œë²„ì˜ ì²˜ë¦¬**: ì„œë²„ê°€ `filePath`ë¥¼ ê²€ì¦í•˜ì§€ ì•Šìœ¼ë©´ ìš”ì²­ì„ ì²˜ë¦¬í•˜ì—¬ ë¯¼ê°í•œ íŒŒì¼ì„ ì‚­ì œí•˜ê±°ë‚˜ ë…¸ì¶œí•  ìˆ˜ ìˆìŒ.
3. **CSRF ì‹¤í–‰**:
* **ì¡°ì‘ëœ ë§í¬**: ê³µê²©ìëŠ” í”¼í•´ìì—ê²Œ ë§í¬ë¥¼ ë³´ë‚´ê±°ë‚˜ ì¡°ì‘ëœ `filePath`ë¡œ ë‹¤ìš´ë¡œë“œ ìš”ì²­ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì….
* **ê²°ê³¼**: í”¼í•´ìê°€ ì•Œì§€ ëª»í•˜ê²Œ í–‰ë™ì„ ì‹¤í–‰í•˜ì—¬ ë¬´ë‹¨ íŒŒì¼ ì ‘ê·¼ ë˜ëŠ” ì‚­ì œë¡œ ì´ì–´ì§.

#### ì™œ ì·¨ì•½í•œê°€

* **ì…ë ¥ ê²€ì¦ ë¶€ì¡±**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì„ì˜ì˜ `filePath` ì…ë ¥ì„ í—ˆìš©í•˜ì—¬ ê²½ë¡œ íƒìƒ‰ì„ ê°€ëŠ¥í•˜ê²Œ í•¨.
* **í´ë¼ì´ì–¸íŠ¸ ì…ë ¥ ì‹ ë¢°**: ì„œë²„ ì¸¡ APIê°€ `filePath`ë¥¼ ê²€ì¦ ì—†ì´ ì‹ ë¢°í•˜ê³  ì²˜ë¦¬í•¨.
* **ì ì¬ì  API ì‘ì—…**: API ì—”ë“œí¬ì¸íŠ¸ê°€ ìƒíƒœ ë³€ê²½ ì‘ì—…(ì˜ˆ: íŒŒì¼ ì‚­ì œ, ìˆ˜ì •)ì„ ìˆ˜í–‰í•˜ë©´ CSPTë¥¼ í†µí•´ ì•…ìš©ë  ìˆ˜ ìˆìŒ.

</details>

## Next.jsì˜ ì„œë²„ ì¸¡

### ì„œë²„ ì¸¡ ë Œë”ë§ (SSR)

í˜ì´ì§€ëŠ” ê° ìš”ì²­ ì‹œ ì„œë²„ì—ì„œ ë Œë”ë§ë˜ì–´ ì‚¬ìš©ìê°€ ì™„ì „íˆ ë Œë”ë§ëœ HTMLì„ ë°›ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì´ ê²½ìš° ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ìì²´ ì»¤ìŠ¤í…€ ì„œë²„ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.

**ì‚¬ìš© ì‚¬ë¡€:**

* ìì£¼ ë³€ê²½ë˜ëŠ” ë™ì  ì½˜í…ì¸ .
* ê²€ìƒ‰ ì—”ì§„ì´ ì™„ì „íˆ ë Œë”ë§ëœ í˜ì´ì§€ë¥¼ í¬ë¡¤ë§í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ SEO ìµœì í™”.

**êµ¬í˜„:**
```jsx
// pages/index.js
export async function getServerSideProps(context) {
const res = await fetch('https://api.example.com/data');
const data = await res.json();
return { props: { data } };
}

function HomePage({ data }) {
return <div>{data.title}</div>;
}

export default HomePage;
```
### Static Site Generation (SSG)

í˜ì´ì§€ëŠ” ë¹Œë“œ ì‹œê°„ì— ë¯¸ë¦¬ ë Œë”ë§ë˜ì–´ ë” ë¹ ë¥¸ ë¡œë“œ ì‹œê°„ê³¼ ê°ì†Œëœ ì„œë²„ ë¶€í•˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**Use Cases:**

* ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì½˜í…ì¸ .
* ë¸”ë¡œê·¸, ë¬¸ì„œ, ë§ˆì¼€íŒ… í˜ì´ì§€.

**Implementation:**
```jsx
// pages/index.js
export async function getStaticProps() {
const res = await fetch('https://api.example.com/data');
const data = await res.json();
return { props: { data }, revalidate: 60 }; // Revalidate every 60 seconds
}

function HomePage({ data }) {
return <div>{data.title}</div>;
}

export default HomePage;
```
### Serverless Functions (API Routes)

Next.jsëŠ” ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ë¡œ API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í•¨ìˆ˜ëŠ” ì „ìš© ì„œë²„ ì—†ì´ í•„ìš”ì— ë”°ë¼ ì‹¤í–‰ë©ë‹ˆë‹¤.

**Use Cases:**

* ì–‘ì‹ ì œì¶œ ì²˜ë¦¬.
* ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ì‘ìš©.
* ë°ì´í„° ì²˜ë¦¬ ë˜ëŠ” ì„œë“œíŒŒí‹° APIì™€ í†µí•©.

**Implementation:**

Next.js 13ì—ì„œ `app` ë””ë ‰í† ë¦¬ê°€ ë„ì…ë˜ë©´ì„œ ë¼ìš°íŒ… ë° API ì²˜ë¦¬ê°€ ë” ìœ ì—°í•˜ê³  ê°•ë ¥í•´ì¡ŒìŠµë‹ˆë‹¤. ì´ í˜„ëŒ€ì ì¸ ì ‘ê·¼ ë°©ì‹ì€ íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ… ì‹œìŠ¤í…œê³¼ ë°€ì ‘í•˜ê²Œ ì¼ì¹˜í•˜ì§€ë§Œ ì„œë²„ ë° í´ë¼ì´ì–¸íŠ¸ êµ¬ì„± ìš”ì†Œì— ëŒ€í•œ ì§€ì›ì„ í¬í•¨í•œ í–¥ìƒëœ ê¸°ëŠ¥ì„ ë„ì…í•©ë‹ˆë‹¤.

#### Basic Route Handler

**File Structure:**
```go
my-nextjs-app/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ hello/
â”‚           â””â”€â”€ route.js
â”œâ”€â”€ package.json
â””â”€â”€ ...
```
**êµ¬í˜„:**
```javascript
// app/api/hello/route.js

export async function POST(request) {
return new Response(JSON.stringify({ message: 'Hello from App Router!' }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}

// Client-side fetch to access the API endpoint
fetch('/api/submit', {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({ name: 'John Doe' }),
})
.then((res) => res.json())
.then((data) => console.log(data));
```
**ì„¤ëª…:**

* **ìœ„ì¹˜:** API ê²½ë¡œëŠ” `app/api/` ë””ë ‰í† ë¦¬ ì•„ë˜ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.
* **íŒŒì¼ ëª…ëª…:** ê° API ì—”ë“œí¬ì¸íŠ¸ëŠ” `route.js` ë˜ëŠ” `route.ts` íŒŒì¼ì´ í¬í•¨ëœ ìì²´ í´ë”ì— ìˆìŠµë‹ˆë‹¤.
* **ë‚´ë³´ë‚¸ í•¨ìˆ˜:** ë‹¨ì¼ ê¸°ë³¸ ë‚´ë³´ë‚´ê¸° ëŒ€ì‹  íŠ¹ì • HTTP ë©”ì„œë“œ í•¨ìˆ˜(ì˜ˆ: `GET`, `POST`)ê°€ ë‚´ë³´ë‚´ì§‘ë‹ˆë‹¤.
* **ì‘ë‹µ ì²˜ë¦¬:** `Response` ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ë‹µì„ ë°˜í™˜í•˜ì—¬ í—¤ë” ë° ìƒíƒœ ì½”ë“œì— ëŒ€í•œ ë” ë§ì€ ì œì–´ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.

#### ë‹¤ë¥¸ ê²½ë¡œ ë° ë©”ì„œë“œ ì²˜ë¦¬ ë°©ë²•:

<details>

<summary>íŠ¹ì • HTTP ë©”ì„œë“œ ì²˜ë¦¬</summary>

Next.js 13+ëŠ” ë™ì¼í•œ `route.js` ë˜ëŠ” `route.ts` íŒŒì¼ ë‚´ì—ì„œ íŠ¹ì • HTTP ë©”ì„œë“œì— ëŒ€í•œ í•¸ë“¤ëŸ¬ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ë” ëª…í™•í•˜ê³  ì¡°ì§ì ì¸ ì½”ë“œë¥¼ ì´‰ì§„í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```javascript
// app/api/users/[id]/route.js

export async function GET(request, { params }) {
const { id } = params;
// Fetch user data based on 'id'
return new Response(JSON.stringify({ userId: id, name: 'Jane Doe' }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}

export async function PUT(request, { params }) {
const { id } = params;
// Update user data based on 'id'
return new Response(JSON.stringify({ message: `User ${id} updated.` }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}

export async function DELETE(request, { params }) {
const { id } = params;
// Delete user based on 'id'
return new Response(JSON.stringify({ message: `User ${id} deleted.` }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}
```
**ì„¤ëª…:**

* **ë‹¤ì¤‘ ë‚´ë³´ë‚´ê¸°:** ê° HTTP ë©”ì„œë“œ(`GET`, `PUT`, `DELETE`)ëŠ” ê³ ìœ í•œ ë‚´ë³´ë‚´ê¸° í•¨ìˆ˜ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
* **ë§¤ê°œë³€ìˆ˜:** ë‘ ë²ˆì§¸ ì¸ìˆ˜ëŠ” `params`ë¥¼ í†µí•´ ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.
* **í–¥ìƒëœ ì‘ë‹µ:** ì‘ë‹µ ê°ì²´ì— ëŒ€í•œ ë” í° ì œì–´ë¥¼ ì œê³µí•˜ì—¬ ì •í™•í•œ í—¤ë” ë° ìƒíƒœ ì½”ë“œ ê´€ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

</details>

<details>

<summary>Catch-All ë° ì¤‘ì²© ê²½ë¡œ</summary>



Next.js 13+ëŠ” ë” ë™ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ API êµ¬ì¡°ë¥¼ í—ˆìš©í•˜ëŠ” catch-all ê²½ë¡œ ë° ì¤‘ì²© API ê²½ë¡œì™€ ê°™ì€ ê³ ê¸‰ ë¼ìš°íŒ… ê¸°ëŠ¥ì„ ì§€ì›í•©ë‹ˆë‹¤.

**Catch-All ê²½ë¡œ ì˜ˆ:**
```javascript
// app/api/[...slug]/route.js

export async function GET(request, { params }) {
const { slug } = params;
// Handle dynamic nested routes
return new Response(JSON.stringify({ slug }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}
```
**ì„¤ëª…:**

* **êµ¬ë¬¸:** `[...]`ëŠ” ëª¨ë“  ì¤‘ì²© ê²½ë¡œë¥¼ í¬ì°©í•˜ëŠ” í¬ê´„ì ì¸ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* **ìš©ë„:** ë‹¤ì–‘í•œ ê²½ë¡œ ê¹Šì´ë‚˜ ë™ì  ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” APIì— ìœ ìš©í•©ë‹ˆë‹¤.

**ì¤‘ì²© ê²½ë¡œ ì˜ˆ:**
```javascript
// app/api/posts/[postId]/comments/[commentId]/route.js

export async function GET(request, { params }) {
const { postId, commentId } = params;
// Fetch specific comment for a post
return new Response(JSON.stringify({ postId, commentId, comment: 'Great post!' }), {
status: 200,
headers: { 'Content-Type': 'application/json' },
});
}
```
**ì„¤ëª…:**

* **ê¹Šì€ ì¤‘ì²©:** ë¦¬ì†ŒìŠ¤ ê´€ê³„ë¥¼ ë°˜ì˜í•˜ëŠ” ê³„ì¸µì  API êµ¬ì¡°ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
* **ë§¤ê°œë³€ìˆ˜ ì ‘ê·¼:** `params` ê°ì²´ë¥¼ í†µí•´ ì—¬ëŸ¬ ê²½ë¡œ ë§¤ê°œë³€ìˆ˜ì— ì‰½ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>Next.js 12 ë° ì´ì „ ë²„ì „ì—ì„œ API ê²½ë¡œ ì²˜ë¦¬</summary>

## `pages` ë””ë ‰í† ë¦¬ì˜ API ê²½ë¡œ (Next.js 12 ë° ì´ì „ ë²„ì „)

Next.js 13ì´ `app` ë””ë ‰í† ë¦¬ë¥¼ ë„ì…í•˜ê³  ë¼ìš°íŒ… ê¸°ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ì „, API ê²½ë¡œëŠ” ì£¼ë¡œ `pages` ë””ë ‰í† ë¦¬ ë‚´ì—ì„œ ì •ì˜ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ì ‘ê·¼ ë°©ì‹ì€ ì—¬ì „íˆ ë„ë¦¬ ì‚¬ìš©ë˜ë©° Next.js 12 ë° ì´ì „ ë²„ì „ì—ì„œ ì§€ì›ë©ë‹ˆë‹¤.

#### ê¸°ë³¸ API ê²½ë¡œ

**íŒŒì¼ êµ¬ì¡°:**
```go
goCopy codemy-nextjs-app/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ hello.js
â”œâ”€â”€ package.json
â””â”€â”€ ...
```
**êµ¬í˜„:**
```javascript
javascriptCopy code// pages/api/hello.js

export default function handler(req, res) {
res.status(200).json({ message: 'Hello, World!' });
}
```
**ì„¤ëª…:**

* **ìœ„ì¹˜:** API ê²½ë¡œëŠ” `pages/api/` ë””ë ‰í† ë¦¬ ì•„ë˜ì— ìˆìŠµë‹ˆë‹¤.
* **ë‚´ë³´ë‚´ê¸°:** í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ë ¤ë©´ `export default`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
* **í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜:** í•¸ë“¤ëŸ¬ëŠ” `req` (HTTP ìš”ì²­) ë° `res` (HTTP ì‘ë‹µ) ê°ì²´ë¥¼ ë°›ìŠµë‹ˆë‹¤.
* **ë¼ìš°íŒ…:** íŒŒì¼ ì´ë¦„ (`hello.js`)ì€ ì—”ë“œí¬ì¸íŠ¸ `/api/hello`ì— ë§¤í•‘ë©ë‹ˆë‹¤.

#### ë™ì  API ê²½ë¡œ

**íŒŒì¼ êµ¬ì¡°:**
```bash
bashCopy codemy-nextjs-app/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ users/
â”‚           â””â”€â”€ [id].js
â”œâ”€â”€ package.json
â””â”€â”€ ...
```
**êµ¬í˜„:**
```javascript
javascriptCopy code// pages/api/users/[id].js

export default function handler(req, res) {
const {
query: { id },
method,
} = req;

switch (method) {
case 'GET':
// Fetch user data based on 'id'
res.status(200).json({ userId: id, name: 'John Doe' });
break;
case 'PUT':
// Update user data based on 'id'
res.status(200).json({ message: `User ${id} updated.` });
break;
case 'DELETE':
// Delete user based on 'id'
res.status(200).json({ message: `User ${id} deleted.` });
break;
default:
res.setHeader('Allow', ['GET', 'PUT', 'DELETE']);
res.status(405).end(`Method ${method} Not Allowed`);
}
}
```
**ì„¤ëª…:**

* **ë™ì  ì„¸ê·¸ë¨¼íŠ¸:** ëŒ€ê´„í˜¸(`[id].js`)ëŠ” ë™ì  ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
* **ë§¤ê°œë³€ìˆ˜ ì ‘ê·¼:** `req.query.id`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì  ë§¤ê°œë³€ìˆ˜ì— ì ‘ê·¼í•©ë‹ˆë‹¤.
* **ë©”ì„œë“œ ì²˜ë¦¬:** ì¡°ê±´ ë…¼ë¦¬ë¥¼ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ HTTP ë©”ì„œë“œ(`GET`, `PUT`, `DELETE` ë“±)ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

#### ë‹¤ì–‘í•œ HTTP ë©”ì„œë“œ ì²˜ë¦¬

ê¸°ë³¸ API ê²½ë¡œ ì˜ˆì œëŠ” ë‹¨ì¼ í•¨ìˆ˜ ë‚´ì—ì„œ ëª¨ë“  HTTP ë©”ì„œë“œë¥¼ ì²˜ë¦¬í•˜ì§€ë§Œ, ì½”ë“œì˜ ëª…í™•ì„±ê³¼ ìœ ì§€ ê´€ë¦¬ë¥¼ ìœ„í•´ ê° ë©”ì„œë“œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ êµ¬ì¡°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì œ:**
```javascript
javascriptCopy code// pages/api/posts.js

export default async function handler(req, res) {
const { method } = req;

switch (method) {
case 'GET':
// Handle GET request
res.status(200).json({ message: 'Fetching posts.' });
break;
case 'POST':
// Handle POST request
res.status(201).json({ message: 'Post created.' });
break;
default:
res.setHeader('Allow', ['GET', 'POST']);
res.status(405).end(`Method ${method} Not Allowed`);
}
}
```
**ëª¨ë²” ì‚¬ë¡€:**

* **ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬:** ì„œë¡œ ë‹¤ë¥¸ HTTP ë©”ì„œë“œì— ëŒ€í•œ ë¡œì§ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬í•©ë‹ˆë‹¤.
* **ì‘ë‹µ ì¼ê´€ì„±:** í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì²˜ë¦¬ë¥¼ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì¼ê´€ëœ ì‘ë‹µ êµ¬ì¡°ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.
* **ì˜¤ë¥˜ ì²˜ë¦¬:** ì§€ì›ë˜ì§€ ì•ŠëŠ” ë©”ì„œë“œì™€ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ë¥¼ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

</details>

### CORS êµ¬ì„±

ì–´ë–¤ ì¶œì²˜ê°€ API ê²½ë¡œì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€ ì œì–´í•˜ì—¬ êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ (CORS) ì·¨ì•½ì ì„ ì™„í™”í•©ë‹ˆë‹¤.

**ì˜ëª»ëœ êµ¬ì„± ì˜ˆ:**
```javascript
// app/api/data/route.js

export async function GET(request) {
return new Response(JSON.stringify({ data: 'Public Data' }), {
status: 200,
headers: {
'Access-Control-Allow-Origin': '*', // Allows any origin
'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE',
},
});
}
```
**CORSëŠ” ë˜í•œ **`middleware.ts`** íŒŒì¼ ë‚´ì˜ ëª¨ë“  API ê²½ë¡œì—ì„œ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**
```javascript
// app/middleware.ts

import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
const allowedOrigins = ['https://yourdomain.com', 'https://sub.yourdomain.com'];
const origin = request.headers.get('Origin');

const response = NextResponse.next();

if (allowedOrigins.includes(origin || '')) {
response.headers.set('Access-Control-Allow-Origin', origin || '');
response.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
response.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization');
// If credentials are needed:
// response.headers.set('Access-Control-Allow-Credentials', 'true');
}

// Handle preflight requests
if (request.method === 'OPTIONS') {
return new Response(null, {
status: 204,
headers: response.headers,
});
}

return response;
}

export const config = {
matcher: '/api/:path*', // Apply to all API routes
};

```
**ë¬¸ì œ:**

* **`Access-Control-Allow-Origin: '*'`:** ëª¨ë“  ì›¹ì‚¬ì´íŠ¸ê°€ APIì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ì—¬, ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ê°€ ì œí•œ ì—†ì´ APIì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê´‘ë²”ìœ„í•œ ë©”ì„œë“œ í—ˆìš©:** ëª¨ë“  ë©”ì„œë“œë¥¼ í—ˆìš©í•˜ë©´ ê³µê²©ìê°€ ì›í•˜ì§€ ì•ŠëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê³µê²©ìê°€ ì´ë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•:**

ê³µê²©ìëŠ” ì•…ì˜ì ì¸ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë§Œë“¤ì–´ APIì— ìš”ì²­ì„ ë³´ë‚´ê³ , ì¸ì¦ëœ ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•˜ì—¬ ë°ì´í„° ê²€ìƒ‰, ë°ì´í„° ì¡°ì‘ ë˜ëŠ” ì›í•˜ì§€ ì•ŠëŠ” ì‘ì—…ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” ê¸°ëŠ¥ì„ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

{% content-ref url="../../pentesting-web/cors-bypass.md" %}
[cors-bypass.md](../../pentesting-web/cors-bypass.md)
{% endcontent-ref %}

### í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ ì„œë²„ ì½”ë“œ ë…¸ì¶œ

**ì„œë²„ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œë¥¼ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ë…¸ì¶œë˜ê³  ì‚¬ìš©ë˜ëŠ” ì½”ë“œì—ì„œë„ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.** í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ íŒŒì¼ì´ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ë³´ì¥í•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ íŒŒì¼ì˜ ì‹œì‘ ë¶€ë¶„ì— ì´ importë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤:
```js
import "server-only";
```
## ì£¼ìš” íŒŒì¼ ë° ì—­í• 

### `middleware.ts` / `middleware.js`

**ìœ„ì¹˜:** í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ ë˜ëŠ” `src/` ë‚´.

**ëª©ì :** ìš”ì²­ì´ ì²˜ë¦¬ë˜ê¸° ì „ì— ì„œë²„ ì¸¡ ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì¸ì¦, ë¦¬ë””ë ‰ì…˜ ë˜ëŠ” ì‘ë‹µ ìˆ˜ì •ê³¼ ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

**ì‹¤í–‰ íë¦„:**

1. **ìˆ˜ì‹  ìš”ì²­:** ë¯¸ë“¤ì›¨ì–´ê°€ ìš”ì²­ì„ ê°€ë¡œì±•ë‹ˆë‹¤.
2. **ì²˜ë¦¬:** ìš”ì²­ì— ë”°ë¼ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤ (ì˜ˆ: ì¸ì¦ í™•ì¸).
3. **ì‘ë‹µ ìˆ˜ì •:** ì‘ë‹µì„ ë³€ê²½í•˜ê±°ë‚˜ ë‹¤ìŒ í•¸ë“¤ëŸ¬ë¡œ ì œì–´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ ì‚¬ìš© ì‚¬ë¡€:**

* ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜.
* ì‚¬ìš©ì ì •ì˜ í—¤ë” ì¶”ê°€.
* ìš”ì²­ ë¡œê¹….

**ìƒ˜í”Œ êµ¬ì„±:**
```typescript
// middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(req: NextRequest) {
const url = req.nextUrl.clone();
if (!req.cookies.has('token')) {
url.pathname = '/login';
return NextResponse.redirect(url);
}
return NextResponse.next();
}

export const config = {
matcher: ['/protected/:path*'],
};
```
### `next.config.js`

**ìœ„ì¹˜:** í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸.

**ëª©ì :** Next.js ë™ì‘ì„ êµ¬ì„±í•˜ê³ , ê¸°ëŠ¥ì„ í™œì„±í™” ë˜ëŠ” ë¹„í™œì„±í™”í•˜ë©°, webpack êµ¬ì„±ì„ ì‚¬ìš©ì ì •ì˜í•˜ê³ , í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ê³ , ì—¬ëŸ¬ ë³´ì•ˆ ê¸°ëŠ¥ì„ êµ¬ì„±í•©ë‹ˆë‹¤.

**ì£¼ìš” ë³´ì•ˆ êµ¬ì„±:**

<details>

<summary>ë³´ì•ˆ í—¤ë”</summary>

ë³´ì•ˆ í—¤ë”ëŠ” ë¸Œë¼ìš°ì €ì— ì½˜í…ì¸ ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì§€ì‹œí•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë³´ì•ˆì„ ê°•í™”í•©ë‹ˆë‹¤. ì´ë“¤ì€ êµì°¨ ì‚¬ì´íŠ¸ ìŠ¤í¬ë¦½íŒ…(XSS), í´ë¦­ì¬í‚¹, MIME íƒ€ì… ìŠ¤ë‹ˆí•‘ê³¼ ê°™ì€ ë‹¤ì–‘í•œ ê³µê²©ì„ ì™„í™”í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤:

* ì½˜í…ì¸  ë³´ì•ˆ ì •ì±…(CSP)
* X-Frame-Options
* X-Content-Type-Options
* ì—„ê²©í•œ ì „ì†¡ ë³´ì•ˆ(HSTS)
* ì°¸ì¡°ì ì •ì±…

**ì˜ˆì‹œ:**
```javascript
// next.config.js

module.exports = {
async headers() {
return [
{
source: '/(.*)', // Apply to all routes
headers: [
{
key: 'X-Frame-Options',
value: 'DENY',
},
{
key: 'Content-Security-Policy',
value: "default-src *; script-src 'self' 'unsafe-inline' 'unsafe-eval';",
},
{
key: 'X-Content-Type-Options',
value: 'nosniff',
},
{
key: 'Strict-Transport-Security',
value: 'max-age=63072000; includeSubDomains; preload', // Enforces HTTPS
},
{
key: 'Referrer-Policy',
value: 'no-referrer', // Completely hides referrer
},
// Additional headers...
],
},
];
},
};
```
</details>

<details>

<summary>ì´ë¯¸ì§€ ìµœì í™” ì„¤ì •</summary>

Next.jsëŠ” ì„±ëŠ¥ì„ ìœ„í•´ ì´ë¯¸ì§€ë¥¼ ìµœì í™”í•˜ì§€ë§Œ, ì˜ëª»ëœ êµ¬ì„±ì€ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì†ŒìŠ¤ê°€ ì•…ì„± ì½˜í…ì¸ ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆëŠ” ë³´ì•ˆ ì·¨ì•½ì ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ëª»ëœ êµ¬ì„± ì˜ˆ:**
```javascript
// next.config.js

module.exports = {
images: {
domains: ['*'], // Allows images from any domain
},
};
```
**ë¬¸ì œ:**

* **`'*'`:** ì‹ ë¢°í•  ìˆ˜ ì—†ê±°ë‚˜ ì•…ì˜ì ì¸ ë„ë©”ì¸ì„ í¬í•¨í•˜ì—¬ ëª¨ë“  ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í—ˆìš©í•©ë‹ˆë‹¤. ê³µê²©ìëŠ” ì•…ì„± í˜ì´ë¡œë“œë‚˜ ì‚¬ìš©ìë¥¼ ì˜¤ë„í•˜ëŠ” ì½˜í…ì¸ ê°€ í¬í•¨ëœ ì´ë¯¸ì§€ë¥¼ í˜¸ìŠ¤íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ë˜ ë‹¤ë¥¸ ë¬¸ì œëŠ” **ëˆ„êµ¬ë‚˜ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” ë„ë©”ì¸**ì„ í—ˆìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤ (ì˜ˆ: `raw.githubusercontent.com`)

**ê³µê²©ìê°€ ì´ë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•:**

ì•…ì„± ì†ŒìŠ¤ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì£¼ì…í•¨ìœ¼ë¡œì¨ ê³µê²©ìëŠ” í”¼ì‹± ê³µê²©ì„ ìˆ˜í–‰í•˜ê±°ë‚˜, ì˜¤í•´ì˜ ì†Œì§€ê°€ ìˆëŠ” ì •ë³´ë¥¼ í‘œì‹œí•˜ê±°ë‚˜, ì´ë¯¸ì§€ ë Œë”ë§ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì·¨ì•½ì ì„ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>í™˜ê²½ ë³€ìˆ˜ ë…¸ì¶œ</summary>

API í‚¤ ë° ë°ì´í„°ë² ì´ìŠ¤ ìê²© ì¦ëª…ê³¼ ê°™ì€ ë¯¼ê°í•œ ì •ë³´ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œí•˜ì§€ ì•Šê³  ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•©ë‹ˆë‹¤.

#### a. ë¯¼ê°í•œ ë³€ìˆ˜ ë…¸ì¶œ

**ì˜ëª»ëœ êµ¬ì„± ì˜ˆ:**
```javascript
// next.config.js

module.exports = {
env: {
SECRET_API_KEY: process.env.SECRET_API_KEY, // Exposed to the client
NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL, // Correctly prefixed for client
},
};
```
**ë¬¸ì œ:**

* **`SECRET_API_KEY`:** `NEXT_PUBLIC_` ì ‘ë‘ì‚¬ê°€ ì—†ìœ¼ë©´ Next.jsëŠ” ë³€ìˆ˜ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ìˆ˜ë¡œ ì ‘ë‘ì‚¬ê°€ ë¶™ìœ¼ë©´(ì˜ˆ: `NEXT_PUBLIC_SECRET_API_KEY`), í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

**ê³µê²©ìê°€ ì´ë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•:**

ë¯¼ê°í•œ ë³€ìˆ˜ê°€ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œë˜ë©´, ê³µê²©ìëŠ” í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œë‚˜ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ê²€ì‚¬í•˜ì—¬ ì´ë¥¼ ê²€ìƒ‰í•˜ê³ , API, ë°ì´í„°ë² ì´ìŠ¤ ë˜ëŠ” ê¸°íƒ€ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ë¬´ë‹¨ ì ‘ê·¼ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>ë¦¬ë””ë ‰ì…˜</summary>

ì‘ìš© í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ URL ë¦¬ë””ë ‰ì…˜ ë° ì¬ì‘ì„± ê´€ë¦¬ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ ì ì ˆí•˜ê²Œ ì•ˆë‚´ë˜ë„ë¡ í•˜ì—¬ ì—´ë¦° ë¦¬ë””ë ‰ì…˜ ì·¨ì•½ì ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤.

#### a. ì—´ë¦° ë¦¬ë””ë ‰ì…˜ ì·¨ì•½ì 

**ì˜ëª»ëœ êµ¬ì„± ì˜ˆ:**
```javascript
// next.config.js

module.exports = {
async redirects() {
return [
{
source: '/redirect',
destination: (req) => req.query.url, // Dynamically redirects based on query parameter
permanent: false,
},
];
},
};
```
**ë¬¸ì œ:**

* **ë™ì  ëª©ì ì§€:** ì‚¬ìš©ìê°€ ì„ì˜ì˜ URLì„ ì§€ì •í•  ìˆ˜ ìˆì–´ ì˜¤í”ˆ ë¦¬ë””ë ‰ì…˜ ê³µê²©ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
* **ì‚¬ìš©ì ì…ë ¥ ì‹ ë¢°:** ì‚¬ìš©ìì— ì˜í•´ ì œê³µëœ URLë¡œ ë¦¬ë””ë ‰ì…˜í•˜ëŠ” ê²ƒì€ ê²€ì¦ ì—†ì´ ì´ë£¨ì–´ì§ˆ ê²½ìš° í”¼ì‹±, ì•…ì„± ì†Œí”„íŠ¸ì›¨ì–´ ë°°í¬ ë˜ëŠ” ìê²© ì¦ëª… ë„ìš©ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ê³µê²©ìê°€ ì´ë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•:**

ê³µê²©ìëŠ” ê·€í•˜ì˜ ë„ë©”ì¸ì—ì„œ ì‹œì‘ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” URLì„ ë§Œë“¤ì–´ ì‚¬ìš©ìë¥¼ ì•…ì„± ì‚¬ì´íŠ¸ë¡œ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:
```bash
https://yourdomain.com/redirect?url=https://malicious-site.com
```
ì‚¬ìš©ìê°€ ì›ë˜ ë„ë©”ì¸ì„ ì‹ ë¢°í•˜ë©´ ì›ì¹˜ ì•Šê²Œ í•´ë¡œìš´ ì›¹ì‚¬ì´íŠ¸ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

<details>

<summary>Webpack êµ¬ì„±</summary>

Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ Webpack êµ¬ì„±ì„ ì‚¬ìš©ì ì •ì˜í•˜ì‹­ì‹œì˜¤. ì£¼ì˜í•˜ì§€ ì•Šìœ¼ë©´ ë³´ì•ˆ ì·¨ì•½ì ì„ ì˜ë„ì¹˜ ì•Šê²Œ ë„ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### a. ë¯¼ê°í•œ ëª¨ë“ˆ ë…¸ì¶œ

**ì˜ëª»ëœ êµ¬ì„± ì˜ˆ:**
```javascript
// next.config.js

module.exports = {
webpack: (config, { isServer }) => {
if (!isServer) {
config.resolve.alias['@sensitive'] = path.join(__dirname, 'secret-folder');
}
return config;
},
};
```
**ë¬¸ì œ:**

* **ë¯¼ê°í•œ ê²½ë¡œ ë…¸ì¶œ:** ë¯¼ê°í•œ ë””ë ‰í† ë¦¬ë¥¼ ë³„ì¹­ ì²˜ë¦¬í•˜ê³  í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì ‘ê·¼ì„ í—ˆìš©í•˜ë©´ ê¸°ë°€ ì •ë³´ê°€ ìœ ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ë¹„ë°€ ë²ˆë“¤ë§:** ë¯¼ê°í•œ íŒŒì¼ì´ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•´ ë²ˆë“¤ë§ë˜ë©´, ê·¸ ë‚´ìš©ì´ ì†ŒìŠ¤ ë§µì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œë¥¼ ê²€ì‚¬í•˜ì—¬ ì ‘ê·¼ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

**ê³µê²©ìê°€ ì´ë¥¼ ì•…ìš©í•˜ëŠ” ë°©ë²•:**

ê³µê²©ìëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë””ë ‰í† ë¦¬ êµ¬ì¡°ì— ì ‘ê·¼í•˜ê±°ë‚˜ ì¬êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©°, ì ì¬ì ìœ¼ë¡œ ë¯¼ê°í•œ íŒŒì¼ì´ë‚˜ ë°ì´í„°ë¥¼ ì°¾ê³  ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</details>

### `pages/_app.js` ë° `pages/_document.js`

#### **`pages/_app.js`**

**ëª©ì :** ê¸°ë³¸ App êµ¬ì„± ìš”ì†Œë¥¼ ì¬ì •ì˜í•˜ì—¬ ì „ì—­ ìƒíƒœ, ìŠ¤íƒ€ì¼ ë° ë ˆì´ì•„ì›ƒ êµ¬ì„± ìš”ì†Œë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.

**ì‚¬ìš© ì‚¬ë¡€:**

* ì „ì—­ CSS ì£¼ì….
* ë ˆì´ì•„ì›ƒ ë˜í¼ ì¶”ê°€.
* ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•©.

**ì˜ˆì‹œ:**
```jsx
// pages/_app.js
import '../styles/globals.css';

function MyApp({ Component, pageProps }) {
return <Component {...pageProps} />;
}

export default MyApp;
```
#### **`pages/_document.js`**

**ëª©ì :** ê¸°ë³¸ Documentë¥¼ ì¬ì •ì˜í•˜ì—¬ HTML ë° Body íƒœê·¸ì˜ ì‚¬ìš©ì ì§€ì •ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

**ì‚¬ìš© ì‚¬ë¡€:**

* `<html>` ë˜ëŠ” `<body>` íƒœê·¸ ìˆ˜ì •.
* ë©”íƒ€ íƒœê·¸ ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€.
* ì„œë“œíŒŒí‹° ê¸€ê¼´ í†µí•©.

**ì˜ˆì‹œ:**
```jsx
// pages/_document.js
import Document, { Html, Head, Main, NextScript } from 'next/document';

class MyDocument extends Document {
render() {
return (
<Html lang="en">
<Head>
{/* Custom fonts or meta tags */}
</Head>
<body>
<Main />
<NextScript />
</body>
</Html>
);
}
}

export default MyDocument;
```
### Custom Server (Optional)

**ëª©ì :** Next.jsëŠ” ë‚´ì¥ ì„œë²„ë¥¼ ì œê³µí•˜ì§€ë§Œ, ì‚¬ìš©ì ì§€ì • ë¼ìš°íŒ…ì´ë‚˜ ê¸°ì¡´ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ì™€ì˜ í†µí•©ê³¼ ê°™ì€ ê³ ê¸‰ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ìœ„í•´ ì‚¬ìš©ì ì§€ì • ì„œë²„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì°¸ê³ :** ì‚¬ìš©ì ì§€ì • ì„œë²„ë¥¼ ì‚¬ìš©í•˜ë©´ Vercelê³¼ ê°™ì´ Next.jsì˜ ë‚´ì¥ ì„œë²„ì— ìµœì í™”ëœ í”Œë«í¼ì—ì„œ ë°°í¬ ì˜µì…˜ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```javascript
// server.js
const express = require('express');
const next = require('next');

const dev = process.env.NODE_ENV !== 'production';
const app = next({ dev });
const handle = app.getRequestHandler();

app.prepare().then(() => {
const server = express();

// Custom route
server.get('/a', (req, res) => {
return app.render(req, res, '/a');
});

// Default handler
server.all('*', (req, res) => {
return handle(req, res);
});

server.listen(3000, (err) => {
if (err) throw err;
console.log('> Ready on http://localhost:3000');
});
});
```
***

## ì¶”ê°€ ì•„í‚¤í…ì²˜ ë° ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### í™˜ê²½ ë³€ìˆ˜ ë° êµ¬ì„±

**ëª©ì :** ì½”ë“œë² ì´ìŠ¤ ì™¸ë¶€ì—ì„œ ë¯¼ê°í•œ ì •ë³´ ë° êµ¬ì„± ì„¤ì • ê´€ë¦¬.

**ëª¨ë²” ì‚¬ë¡€:**

* **`.env` íŒŒì¼ ì‚¬ìš©:** API í‚¤ì™€ ê°™ì€ ë³€ìˆ˜ë¥¼ `.env.local`ì— ì €ì¥ (ë²„ì „ ê´€ë¦¬ì—ì„œ ì œì™¸).
* **ë³€ìˆ˜ë¥¼ ì•ˆì „í•˜ê²Œ ì ‘ê·¼:** `process.env.VARIABLE_NAME`ì„ ì‚¬ìš©í•˜ì—¬ í™˜ê²½ ë³€ìˆ˜ì— ì ‘ê·¼.
* **í´ë¼ì´ì–¸íŠ¸ì— ë¹„ë°€ ë…¸ì¶œ ê¸ˆì§€:** ë¯¼ê°í•œ ë³€ìˆ˜ëŠ” ì„œë²„ ì¸¡ì—ì„œë§Œ ì‚¬ìš©ë˜ë„ë¡ ë³´ì¥.

**ì˜ˆì‹œ:**
```javascript
// next.config.js
module.exports = {
env: {
API_KEY: process.env.API_KEY, // Accessible on both client and server
SECRET_KEY: process.env.SECRET_KEY, // Be cautious if accessible on the client
},
};
```
**ì°¸ê³ :** ë³€ìˆ˜ë¥¼ ì„œë²„ ì¸¡ ì „ìš©ìœ¼ë¡œ ì œí•œí•˜ë ¤ë©´ `env` ê°ì²´ì—ì„œ ìƒëµí•˜ê±°ë‚˜ í´ë¼ì´ì–¸íŠ¸ ë…¸ì¶œì„ ìœ„í•´ `NEXT_PUBLIC_`ë¡œ ì ‘ë‘ì‚¬ë¥¼ ë¶™ì´ì‹­ì‹œì˜¤.

### ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬

**ì ‘ê·¼ ë°©ì‹:**

* **ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦:** ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì„¸ì…˜ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
* **í† í° ê¸°ë°˜ ì¸ì¦:** ìƒíƒœ ë¹„ì €ì¥ ì¸ì¦ì„ ìœ„í•´ JWTë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.
* **íƒ€ì‚¬ ì œê³µì—…ì²´:** `next-auth`ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ OAuth ì œê³µì—…ì²´(ì˜ˆ: Google, GitHub)ì™€ í†µí•©í•©ë‹ˆë‹¤.

**ë³´ì•ˆ ê´€í–‰:**

* **ë³´ì•ˆ ì¿ í‚¤:** `HttpOnly`, `Secure`, ë° `SameSite` ì†ì„±ì„ ì„¤ì •í•©ë‹ˆë‹¤.
* **ë¹„ë°€ë²ˆí˜¸ í•´ì‹±:** ë¹„ë°€ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê¸° ì „ì— í•­ìƒ í•´ì‹œí•©ë‹ˆë‹¤.
* **ì…ë ¥ ê²€ì¦:** ì…ë ¥ì„ ê²€ì¦í•˜ê³  ì •ë¦¬í•˜ì—¬ ì£¼ì… ê³µê²©ì„ ë°©ì§€í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```javascript
// pages/api/login.js
import { sign } from 'jsonwebtoken';
import { serialize } from 'cookie';

export default async function handler(req, res) {
const { username, password } = req.body;

// Validate user credentials
if (username === 'admin' && password === 'password') {
const token = sign({ username }, process.env.JWT_SECRET, { expiresIn: '1h' });
res.setHeader('Set-Cookie', serialize('auth', token, { path: '/', httpOnly: true, secure: true, sameSite: 'strict' }));
res.status(200).json({ message: 'Logged in' });
} else {
res.status(401).json({ error: 'Invalid credentials' });
}
}
```
### ì„±ëŠ¥ ìµœì í™”

**ì „ëµ:**

* **ì´ë¯¸ì§€ ìµœì í™”:** Next.jsì˜ `next/image` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ ì´ë¯¸ì§€ ìµœì í™”ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
* **ì½”ë“œ ë¶„í• :** ë™ì  ì„í¬íŠ¸ë¥¼ í™œìš©í•˜ì—¬ ì½”ë“œë¥¼ ë¶„í• í•˜ê³  ì´ˆê¸° ë¡œë“œ ì‹œê°„ì„ ì¤„ì…ë‹ˆë‹¤.
* **ìºì‹±:** API ì‘ë‹µ ë° ì •ì  ìì‚°ì— ëŒ€í•œ ìºì‹± ì „ëµì„ êµ¬í˜„í•©ë‹ˆë‹¤.
* **ì§€ì—° ë¡œë”©:** í•„ìš”í•  ë•Œë§Œ ì»´í¬ë„ŒíŠ¸ë‚˜ ìì‚°ì„ ë¡œë“œí•©ë‹ˆë‹¤.

**ì˜ˆì‹œ:**
```jsx
// Dynamic Import with Code Splitting
import dynamic from 'next/dynamic';

const HeavyComponent = dynamic(() => import('../components/HeavyComponent'), {
loading: () => <p>Loading...</p>,
});
```
{% hint style="success" %}
AWS í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP í•´í‚¹ ë°°ìš°ê¸° ë° ì—°ìŠµí•˜ê¸°: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ì§€ì›í•˜ê¸°</summary>

* [**êµ¬ë… ê³„íš**](https://github.com/sponsors/carlospolop) í™•ì¸í•˜ê¸°!
* **ğŸ’¬ [**ë””ìŠ¤ì½”ë“œ ê·¸ë£¹**](https://discord.gg/hRep4RUj7f) ë˜ëŠ” [**í…”ë ˆê·¸ë¨ ê·¸ë£¹**](https://t.me/peass)ì— ì°¸ì—¬í•˜ê±°ë‚˜ **íŠ¸ìœ„í„°** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ë¥¼ íŒ”ë¡œìš°í•˜ì„¸ìš”.**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks) ë° [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ê¹ƒí—ˆë¸Œ ë¦¬í¬ì§€í† ë¦¬ì— PRì„ ì œì¶œí•˜ì—¬ í•´í‚¹ íŠ¸ë¦­ì„ ê³µìœ í•˜ì„¸ìš”.**

</details>
{% endhint %}
