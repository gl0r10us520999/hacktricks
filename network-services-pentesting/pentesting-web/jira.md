# Jira & Confluence

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
{% endhint %}

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Se voc√™ est√° interessado em **carreira de hacking** e hackear o inhacke√°vel - **estamos contratando!** (_flu√™ncia em polon√™s escrita e falada √© necess√°ria_).

{% embed url="https://www.stmcyber.com/careers" %}

## Verificar Privil√©gios

No Jira, **privil√©gios podem ser verificados** por qualquer usu√°rio, autenticado ou n√£o, atrav√©s dos endpoints `/rest/api/2/mypermissions` ou `/rest/api/3/mypermissions`. Esses endpoints revelam os privil√©gios atuais do usu√°rio. Uma preocupa√ß√£o not√°vel surge quando **usu√°rios n√£o autenticados possuem privil√©gios**, indicando uma **vulnerabilidade de seguran√ßa** que pode ser eleg√≠vel para um **bounty**. Da mesma forma, **privil√©gios inesperados para usu√°rios autenticados** tamb√©m destacam uma **vulnerabilidade**.

Uma **atualiza√ß√£o** importante foi feita em **1¬∫ de fevereiro de 2019**, exigindo que o endpoint 'mypermissions' inclu√≠sse um **'par√¢metro de permiss√£o'**. Este requisito visa **aumentar a seguran√ßa** especificando os privil√©gios que est√£o sendo consultados: [verifique aqui](https://developer.atlassian.com/cloud/jira/platform/change-notice-get-my-permissions-requires-permissions-query-parameter/#change-notice---get-my-permissions-resource-will-require-a-permissions-query-parameter)

* ADD\_COMMENTS
* ADMINISTRAR
* ADMINISTRAR\_PROJETOS
* USU√ÅRIO\_ATRIBU√çVEL
* ATRIBUIR\_TAREFAS
* NAVEGAR\_PROJETOS
* ALTERA√á√ÉO\_EM\_BULK
* FECHAR\_TAREFAS
* CRIAR\_ANEXOS
* CRIAR\_TAREFAS
* CRIAR\_PROJETO
* CRIAR\_OBJETOS\_COMPARTILHADOS
* DELETAR\_TODOS\_ANEXOS
* DELETAR\_TODOS\_COMENT√ÅRIOS
* DELETAR\_TODOS\_REGISTROS\_DE\_TRABALHO
* DELETAR\_TAREFAS
* DELETAR\_SEUS\_ANEXOS
* DELETAR\_SEUS\_COMENT√ÅRIOS
* DELETAR\_SEUS\_REGISTROS\_DE\_TRABALHO
* EDITAR\_TODOS\_COMENT√ÅRIOS
* EDITAR\_TODOS\_REGISTROS\_DE\_TRABALHO
* EDITAR\_TAREFAS
* EDITAR\_SEUS\_COMENT√ÅRIOS
* EDITAR\_SEUS\_REGISTROS\_DE\_TRABALHO
* VINCULAR\_TAREFAS
* GERENCIAR\_ASSINATURAS\_DE\_FILTRO\_DE\_GRUPO
* GERENCIAR\_PERMISS√ÉO\_DE\_SPRINTS
* GERENCIAR\_OBSERVADORES
* MODIFICAR\_REPORTER
* MOVER\_TAREFAS
* RESOLVER\_TAREFAS
* AGENDAR\_TAREFAS
* DEFINIR\_SEGURAN√áA\_DA\_TAREFA
* ADMIN\_DO\_SISTEMA
* TRANSICIONAR\_TAREFAS
* SELECIONADOR\_DE\_USU√ÅRIOS
* VER\_DADOS\_AGREGADOS
* VER\_FERRAMENTAS\_DE\_DEV
* VER\_FLUXO\_DE\_TRABALHO\_SOMENTE\_LEITURA
* VER\_VOTANTES\_E\_OBSERVADORES
* TRABALHAR\_EM\_TAREFAS

Exemplo: `https://your-domain.atlassian.net/rest/api/2/mypermissions?permissions=BROWSE_PROJECTS,CREATE_ISSUES,ADMINISTER_PROJECTS`
```bash
#Check non-authenticated privileges
curl https://jira.some.example.com/rest/api/2/mypermissions | jq | grep -iB6 '"havePermission": true'
```
## Enumera√ß√£o automatizada

* [https://github.com/0x48piraj/Jiraffe](https://github.com/0x48piraj/Jiraffe)
* [https://github.com/bcoles/jira\_scan](https://github.com/bcoles/jira_scan)

## Plugins Atlassian

Conforme indicado neste [**blog**](https://cyllective.com/blog/posts/atlassian-audit-plugins), na documenta√ß√£o sobre [M√≥dulos de Plugin ‚Üó](https://developer.atlassian.com/server/framework/atlassian-sdk/plugin-modules/) √© poss√≠vel verificar os diferentes tipos de plugins, como:

* [M√≥dulo de Plugin REST ‚Üó](https://developer.atlassian.com/server/framework/atlassian-sdk/rest-plugin-module): Exp√µe endpoints de API RESTful
* [M√≥dulo de Plugin Servlet ‚Üó](https://developer.atlassian.com/server/framework/atlassian-sdk/servlet-plugin-module/): Implanta servlets Java como parte de um plugin
* [M√≥dulo de Plugin Macro ‚Üó](https://developer.atlassian.com/server/confluence/macro-module/): Implementa Macros do Confluence, ou seja, templates HTML parametrizados

Este √© um exemplo do tipo de plugin macro:
```java
package com.atlassian.tutorial.macro;

import com.atlassian.confluence.content.render.xhtml.ConversionContext;
import com.atlassian.confluence.macro.Macro;
import com.atlassian.confluence.macro.MacroExecutionException;

import java.util.Map;

public class helloworld implements Macro {

public String execute(Map<String, String> map, String body, ConversionContext conversionContext) throws MacroExecutionException {
if (map.get("Name") != null) {
return ("<h1>Hello " + map.get("Name") + "!</h1>");
} else {
return "<h1>Hello World!<h1>";
}
}

public BodyType getBodyType() { return BodyType.NONE; }

public OutputType getOutputType() { return OutputType.BLOCK; }
}
```
√â poss√≠vel observar que esses plugins podem ser vulner√°veis a vulnerabilidades web comuns, como XSS. Por exemplo, o exemplo anterior √© vulner√°vel porque est√° refletindo dados fornecidos pelo usu√°rio.&#x20;

Uma vez que um XSS √© encontrado, no [**este reposit√≥rio do github**](https://github.com/cyllective/XSS-Payloads/tree/main/Confluence) voc√™ pode encontrar alguns payloads para aumentar o impacto do XSS.

## Plugin de Backdoor

[**Este post**](https://cyllective.com/blog/posts/atlassian-malicious-plugin) descreve diferentes a√ß√µes (maliciosas) que um plugin malicioso do Jira poderia realizar. Voc√™ pode encontrar [**exemplo de c√≥digo neste reposit√≥rio**](https://github.com/cyllective/malfluence).

Estas s√£o algumas das a√ß√µes que um plugin malicioso poderia realizar:

* **Ocultar Plugins de Administradores**: √â poss√≠vel ocultar o plugin malicioso injetando algum javascript de front-end.
* **Exfiltrar Anexos e P√°ginas**: Permitir acessar e exfiltrar todos os dados.
* **Roubar Tokens de Sess√£o**: Adicionar um endpoint que ir√° ecoar os cabe√ßalhos na resposta (com o cookie) e algum javascript que ir√° contat√°-lo e vazar os cookies.
* **Execu√ß√£o de Comandos**: Claro que √© poss√≠vel criar um plugin que ir√° executar c√≥digo.
* **Shell Reversa**: Ou obter um shell reverso.
* **Proxy DOM**: Se o confluence estiver dentro de uma rede privada, seria poss√≠vel estabelecer uma conex√£o atrav√©s do navegador de algum usu√°rio com acesso a ele e, por exemplo, contatar o servidor executando comandos atrav√©s dele.

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Se voc√™ est√° interessado em **carreira em hacking** e hackear o inhacke√°vel - **estamos contratando!** (_flu√™ncia em polon√™s escrita e falada √© necess√°ria_).

{% embed url="https://www.stmcyber.com/careers" %}

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
