# PHP - RCE abusing object creation: new $\_GET\["a"]\($\_GET\["b"])

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

This is basically a summary of [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)

## Introduction

The creation of new arbitrary objects, such as `new $_GET["a"]($_GET["a"])`, can lead to Remote Code Execution (RCE), as detailed in a [**writeup**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/). This document highlights various strategies for achieving RCE.

## RCE via Custom Classes or Autoloading

The syntax `new $a($b)` is used to instantiate an object where **`$a`** represents the class name and **`$b`** is the first argument passed to the constructor. These variables can be sourced from user inputs like GET/POST, where they may be strings or arrays, or from JSON, where they might present as other types.

Consider the code snippet below:
```php
class App {
function __construct ($cmd) {
system($cmd);
}
}

class App2 {
function App2 ($cmd) {
system($cmd);
}
}

$a = $_GET['a'];
$b = $_GET['b'];

new $a($b);
```
vaj vay' `$a` laH `App` pe'vIl `App2` 'ej `$b` laH system command (e.g., `uname -a`) vItlhutlh.

**Autoloading functions** vaj vay'pu' 'e' vay' 'e' vItlhutlh. vaj 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh 'e' vItlhutlh '
```php
spl_autoload_register(function ($class_name) {
include './../classes/' . $class_name . '.php';
});

function __autoload($class_name) {
include $class_name . '.php';
};

spl_autoload_register();
```
## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatlhlaHbe'chugh, autoloading behavior vItlhutlh.

## RCE via Built-In Classes

PHP versionmey DaH jatl
```php
new SplFileObject('http://attacker.com/');
```
SSRF pIm vItlhavmo' PHP 8.0 ghap Phar protocol vItlhutlh.

### **PDOs qorwagh**

PDO class constructor DSN strings vIleghlaHbe'lu'chugh, vaj databases connection 'e' vItlhutlh vay' vItlhutlhbe'lu'. vItlhutlhbe'lu'chugh, vaj vItlhutlhbe'lu'chugh vItlhutlhbe'lu'chugh:
```php
new PDO("sqlite:/tmp/test.txt")
```
### **SoapClient/SimpleXMLElement XXE**

Versions of PHP up to 5.3.22 and 5.4.12 were susceptible to XXE attacks through the `SoapClient` and `SimpleXMLElement` constructors, contingent on the version of libxml2.

## RCE via Imagick Extension

In the analysis of a **project's dependencies**, it was discovered that **Imagick** could be leveraged for **command execution** by instantiating new objects. This presents an opportunity for exploiting vulnerabilities.

### VID parser

The VID parser capability of writing content to any specified path in the filesystem was identified. This could lead to the placement of a PHP shell in a web-accessible directory, achieving Remote Code Execution (RCE).

#### VID Parser + File Upload

It's noted that PHP temporarily stores uploaded files in `/tmp/phpXXXXXX`. The VID parser in Imagick, utilizing the **msl** protocol, can handle wildcards in file paths, facilitating the transfer of the temporary file to a chosen location. This method offers an additional approach to achieve arbitrary file writing within the filesystem.

### PHP Crash + Brute Force

A method described in the [**original writeup**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) involves uploading files that trigger a server crash before deletion. By brute-forcing the name of the temporary file, it becomes possible for Imagick to execute arbitrary PHP code. However, this technique was found to be effective only in an outdated version of ImageMagick.

## References

* [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
