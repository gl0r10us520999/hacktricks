# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Podstawowe informacje

ProtokÃ³Å‚ **Terminal Access Controller Access Control System (TACACS)** jest uÅ¼ywany do centralnej weryfikacji uÅ¼ytkownikÃ³w prÃ³bujÄ…cych uzyskaÄ‡ dostÄ™p do routerÃ³w lub serwerÃ³w dostÄ™pu do sieci (NAS). Jego ulepszona wersja, **TACACS+**, dzieli usÅ‚ugi na uwierzytelnianie, autoryzacjÄ™ i rozliczanie (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**DomyÅ›lny port:** 49

## Przechwycenie klucza uwierzytelniajÄ…cego

JeÅ›li komunikacja miÄ™dzy klientem a serwerem TACACS jest przechwytywana przez atakujÄ…cego, **szyfrowany klucz uwierzytelniajÄ…cy moÅ¼e zostaÄ‡ przechwycony**. AtakujÄ…cy moÅ¼e nastÄ™pnie sprÃ³bowaÄ‡ **lokalnego ataku brute-force na klucz bez bycia wykrytym w logach**. JeÅ›li uda mu siÄ™ zÅ‚amaÄ‡ klucz, zyskuje dostÄ™p do sprzÄ™tu sieciowego i moÅ¼e odszyfrowaÄ‡ ruch za pomocÄ… narzÄ™dzi takich jak Wireshark.

### Wykonywanie ataku MitM

**Atak spoofingowy ARP moÅ¼e byÄ‡ wykorzystany do przeprowadzenia ataku Man-in-the-Middle (MitM)**.

### Åamanie klucza

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) moÅ¼e byÄ‡ uÅ¼yty do Å‚amania klucza:
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**usually in MD5 encrypted format)**, **moÅ¼emy uzyskaÄ‡ dostÄ™p do urzÄ…dzenia i odszyfrowaÄ‡ ruch zaszyfrowany TACACS.**

### Decrypting Traffic
Once the key is successfully cracked, the next step is to **odszyfrowaÄ‡ ruch zaszyfrowany TACACS**. Wireshark moÅ¼e obsÅ‚ugiwaÄ‡ zaszyfrowany ruch TACACS, jeÅ›li klucz jest podany. AnalizujÄ…c odszyfrowany ruch, moÅ¼na uzyskaÄ‡ informacje takie jak **uÅ¼ywana baner i nazwa uÅ¼ytkownika admina**.

ZyskujÄ…c dostÄ™p do panelu sterowania urzÄ…dzeÅ„ sieciowych za pomocÄ… uzyskanych poÅ›wiadczeÅ„, atakujÄ…cy moÅ¼e sprawowaÄ‡ kontrolÄ™ nad sieciÄ…. WaÅ¼ne jest, aby zauwaÅ¼yÄ‡, Å¼e te dziaÅ‚ania sÄ… Å›ciÅ›le edukacyjne i nie powinny byÄ‡ wykorzystywane bez odpowiedniej autoryzacji.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
