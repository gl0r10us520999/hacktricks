# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Temel Bilgiler

**Terminal Erişim Kontrolörü Erişim Kontrol Sistemi (TACACS)** protokolü, yönlendiricilere veya Ağ Erişim Sunucularına (NAS) erişmeye çalışan kullanıcıları merkezi olarak doğrulamak için kullanılır. Geliştirilmiş versiyonu **TACACS+**, hizmetleri kimlik doğrulama, yetkilendirme ve muhasebe (AAA) olarak ayırır.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Varsayılan port:** 49

## Kimlik Doğrulama Anahtarını Yakalama

Eğer istemci ve TACACS sunucusu arasındaki iletişim bir saldırgan tarafından yakalanırsa, **şifrelenmiş kimlik doğrulama anahtarı yakalanabilir**. Saldırgan, **loglarda tespit edilmeden anahtara karşı yerel bir brute-force saldırısı gerçekleştirmeyi deneyebilir**. Anahtarı brute-force ile kırmayı başarırsa, saldırgan ağ ekipmanına erişim kazanır ve Wireshark gibi araçlar kullanarak trafiği şifreleyebilir.

### MitM Saldırısı Gerçekleştirme

**ARP sahtekarlığı saldırısı, Man-in-the-Middle (MitM) saldırısı gerçekleştirmek için kullanılabilir**.

### Anahtarı Brute-Force ile Kırma

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) anahtarı brute force yapmak için kullanılabilir:
```
sudo loki_gtk.py
```
Eğer anahtar başarıyla **bruteforced** (**genellikle MD5 şifreli formatta**) olursa, **cihazlara erişebilir ve TACACS şifreli trafiği çözebiliriz.**

### Trafiği Çözme
Anahtar başarıyla kırıldıktan sonra, bir sonraki adım **TACACS şifreli trafiği çözmektir**. Wireshark, anahtar sağlandığında şifreli TACACS trafiğini işleyebilir. Çözülmüş trafiği analiz ederek, **kullanılan banner ve admin kullanıcısının kullanıcı adı** gibi bilgilere ulaşılabilir.

Elde edilen kimlik bilgileri kullanılarak ağ ekipmanının kontrol paneline erişim sağlandığında, saldırgan ağ üzerinde kontrol kurabilir. Bu eylemlerin yalnızca eğitim amaçlı olduğunu ve uygun yetkilendirme olmadan kullanılmaması gerektiğini belirtmek önemlidir.

## Referanslar

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
