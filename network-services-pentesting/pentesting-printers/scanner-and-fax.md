<details>

<summary><strong>Aprende a hackear AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Esc√°ner

El acceso a la funcionalidad de escaneo en MFPs (impresoras/perif√©ricos multifunci√≥n) no est√° estandarizado y parece que solo algunos fabricantes aplican comandos PJL para esta tarea. Falta documentaci√≥n p√∫blica, el [proyecto SANE](http://www.sane-project.org/sane-backends.html#SCANNERS) logr√≥ ingenier√≠a inversa de los protocolos para varios dispositivos de escaneo. En MFPs de Brother, posiblemente se pueda utilizar el operador PostScript propietario \_brpdfscan.

**¬øC√≥mo probar este ataque?**

Instala los controladores de la impresora para el modelo espec√≠fico y (ab)usa la funci√≥n de escaneo.

**¬øQui√©n puede realizar este ataque?**

* Cualquiera que pueda imprimir, si la funcionalidad de escaneo se puede acceder a trav√©s de un [control de impresora](http://hacking-printers.net/wiki/index.php/Fundamentals#Printer_Control_Languages) o un lenguaje de [descripci√≥n de p√°gina](http://hacking-printers.net/wiki/index.php/Fundamentals#Page_Description_Languages)
* Cualquiera que pueda acceder a la interfaz web, en MFPs donde los documentos se pueden escanear utilizando la interfaz web
* Solo atacantes que puedan acceder a ciertos servicios de red, si se utiliza un puerto TCP separado para el escaneo

# Telefax

Los mensajes de fax se transmiten en forma de tonos de frecuencia de audio. Se pueden enviar a cualquier dispositivo con capacidad para telefax disponible a trav√©s del sistema telef√≥nico. Por lo tanto, podr√≠an usarse potencialmente para eludir mecanismos de protecci√≥n t√≠picos de la empresa como firewalls TCP/IP o sistemas de detecci√≥n de intrusiones y ejecutar comandos maliciosos en impresoras o MFPs en redes internas. A mediados de los 90, Adobe introdujo el 'fax PostScript' como un suplemento del lenguaje [\[1\]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1), permitiendo que los dispositivos compatibles reciban archivos PostScript directamente a trav√©s del fax. Esto permite a un atacante usar el sistema telef√≥nico ordinario como un canal para desplegar c√≥digo PostScript malicioso en una impresora. Desafortunadamente, el fax PostScript nunca se estableci√≥ y solo se implement√≥ en unos pocos dispositivos. En cambio, los mensajes de telefax t√≠picamente se transmiten como im√°genes gr√°ficas como [TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag). Sin embargo, no se puede descartar que otros fabricantes implementen extensiones de fax propietarias para recibir flujos de datos PDL **entrantes** en lugar de im√°genes de fax en bruto. Te√≥ricamente, se podr√≠a crear un 'virus de fax' que se propagar√≠a infectando otros dispositivos basados en n√∫meros de la agenda de direcciones de los MFPs o mediante wardialing tradicional.

Adem√°s, el fax **saliente** a menudo se puede controlar mediante comandos PJL propietarios en los MFPs actuales. Esto se puede utilizar para causar p√©rdidas financieras a una instituci√≥n llamando a un n√∫mero 0900 (que puede estar registrado por la propia atacante) o como un canal de retorno para filtrar informaci√≥n sensible. A continuaci√≥n se dan ejemplos espec√≠ficos de fabricantes para enviar fax a trav√©s de flujos de datos PDL.

### HP

Seg√∫n [\[1\]](http://hplipopensource.com) el fax se puede acceder utilizando PML en dispositivos HP.

### Xerox

Seg√∫n [\[2\]](http://www.office.xerox.com/support/dctips/dc02cc0280.pdf), Xerox utiliza comandos PJL propietarios: `@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

Seg√∫n [\[3\]](http://brother-mfc.sourceforge.net/faxlanguage.txt), Brother utiliza el FCL (Fax Control Language) propietario: `<Esc>DIALNUM[ (...) ]`

### Lexmark

Seg√∫n [\[4\]](https://www.lexmark.com/publications/pdfs/techref_WB.pdf) Lexmark utiliza comandos PJL propietarios: `@PJL LFAX PHONENUMBER="..."`

### Kyocera

Seg√∫n [\[5\]](http://material.karlov.mff.cuni.cz/people/hajek/bizhub/femperonpsc200mu.pl) Kyocera utiliza comandos PJL propietarios: `@PJL SET FAXTEL = ...`

### Ricoh

Seg√∫n [\[6\]](http://www.objectiflune.com/forum2/ubbthreads.php?ubb=showflat\&Number=29462\&page=1) Ricoh utiliza comandos PJL propietarios: `@PJL ENTER LANGUAGE=RFAX`

\
**¬øC√≥mo probar este ataque?**

Instala los controladores de la impresora para el modelo espec√≠fico y (ab)usa la funci√≥n de fax.


<details>

<summary><strong>Aprende a hackear AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
