<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)や[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングテクニックを共有する。

</details>


# スキャナー

MFP（マルチファンクションプリンター/周辺機器）へのスキャン機能へのアクセスは標準化されておらず、PJLコマンドをこのタスクに適用するベンダーは少数のようです。公開されている文書はありませんが、[SANEプロジェクト](http://www.sane-project.org/sane-backends.html#SCANNERS)は様々なスキャナーデバイスのプロトコルをリバースエンジニアリングで解明しました。BrotherのMFPでは、独自のPostScriptオペレーター\_brpdfscanが使用される可能性があります。

**この攻撃をテストする方法は？**

特定のモデルのプリンタードライバーをインストールし、スキャン機能を（悪用）使用します。

**この攻撃を実行できるのは誰ですか？**

* [プリンター制御](http://hacking-printers.net/wiki/index.php/Fundamentals#Printer_Control_Languages)言語または[ページ記述](http://hacking-printers.net/wiki/index.php/Fundamentals#Page_Description_Languages)言語を通じてスキャン機能にアクセスできる場合、印刷できる任意の人
* ウェブインターフェースを介して文書をスキャンできるMFPにアクセスできる任意の人
* スキャン用に別のTCPポートが使用されている場合、特定のネットワークサービスにアクセスできる攻撃者のみ

# テレファックス

ファックスメッセージは音声周波数トーンの形で送信されます。これらは電話システムを介して利用可能な任意のテレファックス対応デバイスに送信することができます。したがって、TCP/IPファイアウォールや侵入検知システムなどの典型的な企業保護メカニズムをバイパスし、内部ネットワークのプリンターやMFPで悪意のあるコマンドを実行するために使用される可能性があります。90年代半ばにAdobeは「PostScriptファックス」として言語補足を導入しました[\[1\]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1)。これにより、互換性のあるデバイスがファックス経由で直接PostScriptファイルを受信できるようになりました。これにより、攻撃者は通常の電話システムを使用して、プリンターに悪意のあるPostScriptコードを展開するチャンネルとして使用できます。残念ながら、PostScriptファックスは普及せず、ごく少数のデバイスでのみ実装されました。代わりに、テレファックスメッセージは通常、[TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag)のようなグラフィカルイメージとして送信されます。それでも、他のベンダーが独自のファックス拡張を実装して、生のファックスイメージの代わりに任意のPDLデータストリームを**受信**することは否定できません。理論的には、「ファックスウイルス」が作成され、MFPのアドレス帳からの番号や従来のワードダイヤリングに基づいて他のデバイスに感染を広げる可能性があります。

さらに、現在のMFPでは、**発信**ファックスはしばしば独自のPJLコマンドによって制御されます。これは、攻撃者自身が登録した0900番号（有料番号）に電話をかけることで機関に財政的損失を与えるため、または機密情報を漏洩するためのバックチャネルとして使用される可能性があります。以下に、PDLデータストリームを介してファックスを送信するためのベンダー固有の例を示します。

### HP

[\[1\]](http://hplipopensource.com)によると、HPデバイスではPMLを使用してファックスにアクセスできます。

### Xerox

[\[2\]](http://www.office.xerox.com/support/dctips/dc02cc0280.pdf)によると、Xeroxは独自のPJLコマンドを使用します: `@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

[\[3\]](http://brother-mfc.sourceforge.net/faxlanguage.txt)によると、Brotherは独自のFCL（Fax Control Language）を使用します: `<Esc>DIALNUM[ (...) ]`

### Lexmark

[\[4\]](https://www.lexmark.com/publications/pdfs/techref_WB.pdf)によると、Lexmarkは独自のPJLコマンドを使用します: `@PJL LFAX PHONENUMBER="..."`

### Kyocera

[\[5\]](http://material.karlov.mff.cuni.cz/people/hajek/bizhub/femperonpsc200mu.pl)によると、Kyoceraは独自のPJLコマンドを使用します: `@PJL SET FAXTEL = ...`

### Ricoh

[\[6\]](http://www.objectiflune.com/forum2/ubbthreads.php?ubb=showflat\&Number=29462\&page=1)によると、Ricohは独自のPJLコマンドを使用します: `@PJL ENTER LANGUAGE=RFAX`

\
**この攻撃をテストする方法は？**

特定のモデルのプリンタードライバーをインストールし、ファックス機能を（悪用）使用します。


<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**の[**GitHubリポジトリ**](https://github.com/carlospolop/hacktricks)や[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、あなたのハッキングテクニックを共有する。

</details>
