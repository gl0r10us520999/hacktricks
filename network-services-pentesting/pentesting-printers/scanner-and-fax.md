```markdown
<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Scanner

L'acc√®s √† la fonctionnalit√© de scan sur les MFP (imprimantes/p√©riph√©riques multifonctions) n'est pas standardis√© et il semble que peu de fournisseurs appliquent des commandes PJL pour cette t√¢che. La documentation publique fait d√©faut, le [projet SANE](http://www.sane-project.org/sane-backends.html#SCANNERS) a r√©ussi √† r√©tro-ing√©nierer les protocoles pour divers appareils de scan. Sur les MFP Brother, l'op√©rateur PostScript propri√©taire \_brpdfscan pourrait √©ventuellement √™tre utilis√©.

**Comment tester cette attaque ?**

Installez les pilotes d'imprimante pour le mod√®le sp√©cifique et (ab)usez de la fonction de scan.

**Qui peut r√©aliser cette attaque ?**

* Toute personne pouvant imprimer, si la fonctionnalit√© de scan peut √™tre acc√©d√©e via un [contr√¥le d'imprimante](http://hacking-printers.net/wiki/index.php/Fundamentals#Printer_Control_Languages) ou un [langage de description de page](http://hacking-printers.net/wiki/index.php/Fundamentals#Page_Description_Languages)
* Toute personne pouvant acc√©der √† l'interface web, sur les MFP o√π les documents peuvent √™tre scann√©s via l'interface web
* Seuls les attaquants pouvant acc√©der √† certains services r√©seau, si un port TCP s√©par√© est utilis√© pour le scan

# Telefax

Les messages de fax sont transmis sous forme de tonalit√©s de fr√©quence audio. Ils peuvent √™tre envoy√©s √† tout appareil capable de recevoir des fax disponible via le syst√®me t√©l√©phonique. Par cons√©quent, ils pourraient potentiellement √™tre utilis√©s pour contourner les m√©canismes de protection typiques d'une entreprise comme les pare-feu TCP/IP ou les syst√®mes de d√©tection d'intrusion et ex√©cuter des commandes malveillantes sur des imprimantes ou des MFP dans des r√©seaux internes. Au milieu des ann√©es 90, Adobe a introduit le 'fax PostScript' comme un suppl√©ment de langage [\[1\]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1), permettant aux appareils compatibles de recevoir directement des fichiers PostScript via fax. Cela permet √† un attaquant d'utiliser le syst√®me t√©l√©phonique ordinaire comme canal pour d√©ployer du code PostScript malveillant sur une imprimante. Malheureusement, le fax PostScript ne s'est jamais impos√© et n'a √©t√© impl√©ment√© que dans une poign√©e d'appareils. Les messages de fax sont plut√¥t typiquement transmis sous forme d'images graphiques comme [TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag). N√©anmoins, on ne peut exclure que d'autres fournisseurs impl√©mentent des extensions de fax propri√©taires pour recevoir des flux de donn√©es PDL **entrants** au lieu d'images de fax brutes. Th√©oriquement, un 'virus de fax' pourrait √™tre cr√©√© qui se propagerait en infectant d'autres appareils en se basant sur les num√©ros du carnet d'adresses des MFP ou par wardialing traditionnel.

De plus, le fax **sortant** peut souvent √™tre contr√¥l√© par des commandes PJL propri√©taires sur les MFP d'aujourd'hui. Cela peut √™tre utilis√© pour causer une perte financi√®re √† une institution en appelant un num√©ro 0900 (qui peut √™tre enregistr√© par l'attaquant elle-m√™me) ou comme un canal de retour pour fuiter des informations sensibles. Des exemples sp√©cifiques au fournisseur pour envoyer des fax via des flux de donn√©es PDL sont donn√©s ci-dessous.

### HP

Selon [\[1\]](http://hplipopensource.com), le fax peut √™tre acc√©d√© en utilisant PML sur les appareils HP.

### Xerox

Selon [\[2\]](http://www.office.xerox.com/support/dctips/dc02cc0280.pdf), Xerox utilise des commandes PJL propri√©taires : `@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

Selon [\[3\]](http://brother-mfc.sourceforge.net/faxlanguage.txt), Brother utilise le FCL (Fax Control Language) propri√©taire : `<Esc>DIALNUM[ (...) ]`

### Lexmark

Selon [\[4\]](https://www.lexmark.com/publications/pdfs/techref_WB.pdf), Lexmark utilise des commandes PJL propri√©taires : `@PJL LFAX PHONENUMBER="..."`

### Kyocera

Selon [\[5\]](http://material.karlov.mff.cuni.cz/people/hajek/bizhub/femperonpsc200mu.pl), Kyocera utilise des commandes PJL propri√©taires : `@PJL SET FAXTEL = ...`

### Ricoh

Selon [\[6\]](http://www.objectiflune.com/forum2/ubbthreads.php?ubb=showflat\&Number=29462\&page=1), Ricoh utilise des commandes PJL propri√©taires : `@PJL ENTER LANGUAGE=RFAX`

\
**Comment tester cette attaque ?**

Installez les pilotes d'imprimante pour le mod√®le sp√©cifique et (ab)usez de la fonction de fax.


<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
