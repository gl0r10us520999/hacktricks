<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Scanner

O acesso √† funcionalidade de scanner em MFPs (impressoras/perif√©ricos multifuncionais) n√£o √© padronizado e parece que apenas alguns fabricantes aplicam comandos PJL para essa tarefa. Documenta√ß√£o p√∫blica est√° ausente, o [projeto SANE](http://www.sane-project.org/sane-backends.html#SCANNERS) conseguiu engenharia reversa dos protocolos para v√°rios dispositivos de scanner. Em MFPs da Brother, o operador propriet√°rio PostScript \_brpdfscan pode possivelmente ser usado.

**Como testar esse ataque?**

Instale os drivers da impressora para o modelo espec√≠fico e (ab)use da fun√ß√£o de scanner.

**Quem pode realizar esse ataque?**

* Qualquer um que possa imprimir, se a funcionalidade de scanner puder ser acessada atrav√©s de uma [linguagem de controle de impressora](http://hacking-printers.net/wiki/index.php/Fundamentals#Printer_Control_Languages) ou [linguagem de descri√ß√£o de p√°gina](http://hacking-printers.net/wiki/index.php/Fundamentals#Page_Description_Languages)
* Qualquer um que possa acessar a interface web, em MFPs onde documentos podem ser digitalizados usando a interface web
* Apenas atacantes que possam acessar certos servi√ßos de rede, se uma porta TCP separada for usada para digitaliza√ß√£o

# Telefax

Mensagens de fax s√£o transmitidas na forma de tons de frequ√™ncia de √°udio. Elas podem ser enviadas para qualquer dispositivo capaz de telefax dispon√≠vel atrav√©s do sistema telef√¥nico. Portanto, elas poderiam potencialmente ser usadas para contornar mecanismos t√≠picos de prote√ß√£o de empresas como firewalls TCP/IP ou sistemas de detec√ß√£o de intrus√£o e executar comandos maliciosos em impressoras ou MFPs em redes internas. No meio dos anos 90, a Adobe introduziu o ‚Äòfax PostScript‚Äô como um suplemento de linguagem [\[1\]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1), permitindo que dispositivos compat√≠veis recebessem arquivos PostScript diretamente via fax. Isso permite que um atacante use o sistema telef√¥nico comum como um canal para implantar c√≥digo PostScript malicioso em uma impressora. Infelizmente, o fax PostScript nunca se estabeleceu e foi implementado apenas em um punhado de dispositivos. Em vez disso, mensagens de telefax s√£o tipicamente transmitidas como imagens gr√°ficas como [TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag). No entanto, n√£o se pode descartar que outros fabricantes implementem extens√µes propriet√°rias de fax para receber fluxos de dados PDL **inbound** em vez de imagens de fax brutas. Teoricamente, um ‚Äòv√≠rus de fax‚Äô poderia ser criado que se espalharia infectando outros dispositivos com base em n√∫meros da agenda de endere√ßos dos MFPs ou por wardialing tradicional.

Al√©m disso, o fax **outbound** muitas vezes pode ser controlado por comandos PJL propriet√°rios nos MFPs de hoje. Isso pode ser usado para causar perda financeira a uma institui√ß√£o ligando para um n√∫mero 0900 (que pode ser registrado pelo pr√≥prio atacante) ou como um canal de retorno para vazar informa√ß√µes sens√≠veis. Exemplos espec√≠ficos de fabricantes para enviar fax via fluxos de dados PDL s√£o dados abaixo.

### HP

De acordo com [\[1\]](http://hplipopensource.com), o fax pode ser acessado usando PML em dispositivos HP.

### Xerox

De acordo com [\[2\]](http://www.office.xerox.com/support/dctips/dc02cc0280.pdf), a Xerox usa comandos PJL propriet√°rios: `@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

De acordo com [\[3\]](http://brother-mfc.sourceforge.net/faxlanguage.txt), a Brother usa a linguagem propriet√°ria FCL (Fax Control Language): `<Esc>DIALNUM[ (...) ]`

### Lexmark

De acordo com [\[4\]](https://www.lexmark.com/publications/pdfs/techref_WB.pdf), a Lexmark usa comandos PJL propriet√°rios: `@PJL LFAX PHONENUMBER="..."`

### Kyocera

De acordo com [\[5\]](http://material.karlov.mff.cuni.cz/people/hajek/bizhub/femperonpsc200mu.pl), a Kyocera usa comandos PJL propriet√°rios: `@PJL SET FAXTEL = ...`

### Ricoh

De acordo com [\[6\]](http://www.objectiflune.com/forum2/ubbthreads.php?ubb=showflat\&Number=29462\&page=1), a Ricoh usa comandos PJL propriet√°rios: `@PJL ENTER LANGUAGE=RFAX`

\
**Como testar esse ataque?**

Instale os drivers da impressora para o modelo espec√≠fico e (ab)use da fun√ß√£o de fax.


<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
