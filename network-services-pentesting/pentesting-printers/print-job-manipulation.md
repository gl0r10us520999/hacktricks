<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Superposition de contenu

Une mani√®re simple de manipuler l'apparence des impressions est d'**utiliser** des superpositions. \
[**PCL**](./#pcl) a une fonction document√©e pour placer des **macros de superposition** sur un document. Malheureusement, cette fonctionnalit√© est **limit√©e au travail d'impression actuel** et ne peut pas √™tre rendue permanente. \
[**PostScript**](./#postscript-ps) n'offre pas une telle fonctionnalit√© par d√©faut, cependant, elle peut √™tre programm√©e en **red√©finissant l'op√©rateur showpage** qui est contenu dans chaque document PostScript pour imprimer la page actuelle. L'attaquant peut **s'y accrocher**, ex√©cuter son propre code puis appeler la version originale de l'op√©rateur.\
Ainsi, elle peut superposer toutes les pages √† imprimer avec un fichier EPS personnalis√©. Ce hack peut √™tre utilis√© pour **ajouter des graphiques ou des polices arbitraires aux copies papier d'un document** (Il est possible de modifier compl√®tement l'apparence d'un document en superposant une page blanche puis en ajoutant du contenu personnalis√©).\
√âvidemment, une telle approche ne peut √™tre couronn√©e de succ√®s que si PostScript est utilis√© comme pilote d'imprimante et qu'aucun `StartJobPassword` n'est d√©fini.

![](http://hacking-printers.net/wiki/images/thumb/9/93/Overlay.jpg/300px-Overlay.jpg)

**Comment tester cette attaque ?**

Utilisez les commandes `cross` ou `overlay` de [**PRET**](https://github.com/RUB-NDS/PRET) en mode ps, puis d√©connectez-vous et imprimez un document arbitraire :
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> overlay overlays/smiley.eps
printer:/> cross whoa "HACKED"
printer:/> exit
```
# Remplacement de contenu

M√™me si un attaquant peut superposer un calque sur des documents existants, il ne pourra pas **modifier des valeurs sp√©cifiques** dans le document original √† moins d'en conna√Ætre la structure exacte. Parfois, on ne veut pas seulement ajouter du contenu personnalis√©, mais **analyser et remplacer des parties** du document existant. \
Le probl√®me du remplacement de texte dans les fichiers PostScript peut √™tre r√©duit au **probl√®me de l'extraction de cha√Ænes** du document rendu. Ce n'est pas trivial, car les cha√Ænes peuvent √™tre construites dynamiquement par le programme PostScript lui-m√™me. Par cons√©quent, une simple analyse et un remplacement dans le code source du document ne sont pas envisageables.\
Vous pouvez utiliser un **op√©rateur `show` red√©fini**. L'op√©rateur show accepte une cha√Æne en entr√©e, qui est peinte √† un certain emplacement de la page actuelle. En red√©finissant l'op√©rateur, le **texte** peut √™tre **extrait** de mani√®re √©l√©gante. Cette approche peut √©galement √™tre utilis√©e pour **rechercher et remplacer** de mani√®re cibl√©e dans les cha√Ænes imm√©diatement **avant** qu'elles ne soient **peintes**. \
L'approche est **r√©ussie** pour les documents PostScript bas√©s sur **LaTeX** qui sont directement envoy√©s √† l'imprimante alors qu'elle **√©choue** pour les fichiers PostScript g√©n√©r√©s par **GIMP** qui, au lieu de cha√Ænes, **cr√©e des graphiques raster** de leur repr√©sentation. Le m√™me probl√®me se pose pour tout format de document ‚Äì y compris le PostScript lui-m√™me ‚Äì lorsqu'il est trait√© par CUPS. Th√©oriquement, de telles constructions linguistiques pourraient √©galement √™tre analys√©es et devraient faire l'objet de recherches ult√©rieures.

**Comment tester cette attaque ?**

Utilisez la commande `replace` de [**PRET**](https://github.com/RUB-NDS/PRET) en mode ps, puis d√©connectez-vous et imprimez un document PostScript contenant ‚ÄòDEF‚Äô :
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> replace "ABC" "DEF"
printer:/> exit
```
<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
