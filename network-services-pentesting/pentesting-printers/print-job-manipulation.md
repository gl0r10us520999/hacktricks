<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


# Sobreposi√ß√£o de Conte√∫do

Uma maneira simples de manipular a apar√™ncia de impress√µes √© **usar** sobreposi√ß√µes. \
[**PCL**](./#pcl) possui uma fun√ß√£o documentada para colocar **macros de sobreposi√ß√£o** em cima de um documento. Infelizmente, esse recurso √© **limitado ao trabalho de impress√£o atual** e n√£o pode ser tornado permanente. \
[**PostScript**](./#postscript-ps) n√£o oferece tal funcionalidade por padr√£o, no entanto, pode ser programado ao **redefinir o operador showpage** que est√° contido em todo documento PostScript para imprimir a p√°gina atual. O atacante pode **se conectar ali**, executar seu pr√≥prio c√≥digo e depois chamar a vers√£o original do operador.\
Assim, ela pode sobrepor todas as p√°ginas a serem impressas com um arquivo EPS personalizado. Esse hack pode ser usado para **adicionar gr√°ficos ou fontes arbitr√°rios √†s c√≥pias f√≠sicas de um documento** (√â poss√≠vel alterar completamente a apar√™ncia de um documento sobrepondo uma p√°gina em branco e depois adicionando conte√∫do personalizado).\
Obviamente, tal abordagem s√≥ pode ser bem-sucedida se PostScript for usado como driver de impressora e nenhuma `StartJobPassword` estiver definida.

![](http://hacking-printers.net/wiki/images/thumb/9/93/Overlay.jpg/300px-Overlay.jpg)

**Como testar esse ataque?**

Use os comandos `cross` ou `overlay` do [**PRET**](https://github.com/RUB-NDS/PRET) no modo ps, depois desconecte e imprima um documento arbitr√°rio:
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> overlay overlays/smiley.eps
printer:/> cross whoa "HACKED"
printer:/> exit
```
# Substitui√ß√£o de Conte√∫do

Mesmo que um atacante possa colocar uma sobreposi√ß√£o acima de documentos existentes, ela n√£o ser√° capaz de **alterar valores espec√≠ficos** no documento original, a menos que sua estrutura exata seja conhecida. √Äs vezes, n√£o se quer apenas adicionar conte√∫do personalizado, mas **analisar e substituir partes** do documento existente. \
O problema de substituir texto em arquivos PostScript pode ser reduzido ao **problema de extrair strings** do documento renderizado. Isso n√£o √© trivial, porque as strings podem ser constru√≠das dinamicamente pelo pr√≥prio programa PostScript. Portanto, simples an√°lise e substitui√ß√£o dentro do c√≥digo-fonte do documento n√£o s√£o uma op√ß√£o.\
Voc√™ pode usar um **operador `show` redefinido**. O operador show aceita uma string como entrada, que √© pintada em um local espec√≠fico da p√°gina atual. Ao redefinir o operador, o **texto** pode ser elegantemente **extra√≠do**. Essa abordagem tamb√©m pode ser usada para **pesquisar e substituir** de forma direcionada em strings imediatamente **antes** de serem **pintadas**. \
A abordagem √© **bem-sucedida** para documentos PostScript baseados em **LaTeX** que s√£o enviados diretamente para a impressora, enquanto **falha** para arquivos PostScript gerados pelo **GIMP**, que em vez de strings **cria gr√°ficos rasterizados** de sua representa√ß√£o. O mesmo problema ocorre para qualquer formato de documento ‚Äì at√© mesmo o pr√≥prio PostScript ‚Äì quando processado pelo CUPS. Teoricamente, tais constru√ß√µes de linguagem tamb√©m poderiam ser analisadas e devem ser objeto de pesquisa futura.

**Como testar esse ataque?**

Use o comando `replace` do [**PRET**](https://github.com/RUB-NDS/PRET) no modo ps, depois desconecte e imprima um documento PostScript contendo ‚ÄòDEF‚Äô:
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> replace "ABC" "DEF"
printer:/> exit
```
<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
