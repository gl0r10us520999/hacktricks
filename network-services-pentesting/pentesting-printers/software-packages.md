<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**merchandising oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga** me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


Nos √∫ltimos anos, os fornecedores de impressoras come√ßaram a introduzir a **possibilidade de instalar software personalizado em seus dispositivos**. O formato desses 'aplicativos para impressora' √© propriet√°rio e os SDKs n√£o est√£o dispon√≠veis para o p√∫blico. A funcionalidade de escrever software personalizado que roda em impressoras foi planejada e √© reservada para revendedores e contratados, n√£o para usu√°rios finais. Assim, uma frota de impressoras pode ser adaptada √†s necessidades especiais e processos de neg√≥cios de uma empresa; provedores de solu√ß√µes de documentos podem integrar facilmente impressoras em seu software de gest√£o. Um exemplo popular √© o NSi AutoStore [\[1\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-1) que pode ser instalado em muitos MFPs e automaticamente faz upload de documentos digitalizados ou copiados para locais predefinidos. Obviamente, a funcionalidade de executar c√≥digo personalizado em um dispositivo de impressora √© uma potencial amea√ßa √† seguran√ßa. Al√©m disso, a assinatura de c√≥digo de pacotes de software √© potencialmente mais dif√≠cil do que para [firmware](http://hacking-printers.net/wiki/index.php/Firmware_updates) j√° que o software n√£o √© escrito apenas pelo fabricante da impressora, mas por uma gama mais ampla de desenvolvedores que precisam estar na posse da chave secreta para assinar seu software. Portanto, √© l√≥gico incluir a chave secreta em SDKs que s√£o protegidos por estarem dispon√≠veis exclusivamente de plataformas de desenvolvedores. Este artigo √© um esfor√ßo para reunir sistematicamente informa√ß√µes sobre plataformas de software espec√≠ficas de fornecedores/SDKs.

# Fornecedores

A seguir, um esbo√ßo aproximado das plataformas de software fornecidas pelos principais fornecedores de impressoras para estender a funcionalidade de seus dispositivos √© apresentado.

## HP \(Chai/OXP\)

A HP introduziu sua plataforma 'Chai Appliance Platform' em 1999 para executar aplica√ß√µes Java em impressoras LaserJet. Enquanto um SDK estava aberto ao p√∫blico inicialmente [\[2\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-2), o acesso foi posteriormente restrito aos membros da rede de desenvolvedores da HP. Servlets Chai, que v√™m como arquivos `.jar` que originalmente precisavam ser certificados e assinados pela HP antes de serem aceitos por um dispositivo de impressora. [\[3\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-phenoelit2002embedded-3) descobriram uma falha no processo de implanta√ß√£o: instalando o EZloader ‚Äì um software de carregamento alternativo fornecido pela HP que j√° havia sido assinado ‚Äì eles conseguiram fazer upload e executar seus pr√≥prios pacotes Java n√£o assinados. Pelo que parece, a assinatura de c√≥digo foi completamente abandonada pela HP para vers√µes posteriores do Chai: [\[4\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-mueller2016printers-4) conseguiram escrever e executar um malware de impressora de prova de conceito que escuta na porta 9100 e faz upload de documentos recebidos para um servidor FTP antes de imprimi-los. Seu c√≥digo √© baseado em [\[5\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-5) que estendeu o dispositivo para suportar balanceamento de carga e incluiu os arquivos SDK necess√°rios e bibliotecas Java propriet√°rias em sua demonstra√ß√£o. Com as bibliotecas, qualquer c√≥digo Java pode ser compilado e executado em HP LaserJets mais antigos fazendo upload dos arquivos `.jar` para uma URL 'oculta': [`http://printer/hp/device/this.loader`](http://printer/hp/device/this.loader). Este ataque pode ser realizado se ainda n√£o foi definida uma senha para o servidor web embutido. Caso contr√°rio, a senha deve primeiro ser recuperada de `/dev/rdsk_jdi_cfg0` com PostScript \(veja [acesso ao sistema de arquivos](http://hacking-printers.net/wiki/index.php/File_system_access)\) ou contornada redefinindo o dispositivo para [padr√µes de f√°brica](http://hacking-printers.net/wiki/index.php/Factory_defaults). Um atacante web pode fazer upload do arquivo `.jar` usando [CSRF](https://en.wikipedia.org/wiki/Cross-site_request_forgery) se a v√≠tima estiver atualmente logada no servidor web embutido da impressora. Para dispositivos mais novos, a HP usa a plataforma baseada em servi√ßos web 'Open Extensibility Platform' \([OXP](https://developers.hp.com/oxp/)\) em vez de Chai para a qual nenhum SDK est√° dispon√≠vel publicamente.

## Canon \(MEAP\)

A 'Multifunctional Embedded Application Platform' \([MEAP](http://www.developersupport.canon.com/faq/335#t335n18)\) √© uma plataforma de software baseada em Java introduzida pela Canon em 2003 para sua s√©rie imageRunner e estendida para servi√ßos web em 2010. Desenvolvedores terceirizados podem obter o MEAP [SDK](http://developersupport.canon.com/content/meap-sdk-0) por uma taxa de $5,000, o que certamente est√° fora do escopo para fins de pesquisa.

## Xerox/Dell \(EIP\)

A 'Extensible Interface Platform' \([EIP](http://www.office.xerox.com/eip/enus.html)\) [\[6\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-6) foi anunciada em 2006 pela Xerox para v√°rios MFPs. A arquitetura ‚Äì que tamb√©m √© suportada por alguns dispositivos Dell renomeados ‚Äì √© baseada em tecnologia de servi√ßos web. O [SDK](http://www.office.xerox.com/eip/enus.html) est√° dispon√≠vel gratuitamente para desenvolvedores registrados.

## Brother \(BSI\)

A 'Brother Solutions Interface' \([BSI](https://www.brother-usa.com/lp/civ/bsi.aspx)\) √© uma arquitetura web baseada em XML lan√ßada em 2012 para scanners, copiadoras e impressoras. O acesso ao [SDK](https://www.brother-usa.com/lp/civ/home.aspx) est√° dispon√≠vel para desenvolvedores licenciados.

## Lexmark \(eSF\)

O 'Embedded Solution Framework' \([eSF](http://www.lexmark-emea.com/usa/BSD_solution_catalouge.pdf)\) foi lan√ßado em 2006 para MFPs da Lexmark. O SDK para desenvolver aplica√ß√µes Java √© reservado para 'parceiros especialmente qualificados'. De acordo com [\[7\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-7) 'essas aplica√ß√µes devem ser digitalmente assinadas pela Lexmark antes de serem adotadas' usando assinaturas RSA de 2048 bits.

## Samsung \(XOA\)

A 'eXtensible Open Architecture' \([XOA](http://samsungprintingsolutions.com/2015/02/can-samsungs-extensible-open-architecture-xoa/)\) foi introduzida pela Samsung em 2008 e vem em duas vers√µes: a m√°quina virtual Java XOA-E e os servi√ßos web baseados em XOA-Web. O [SDK](http://xoapartnerportal.com/) est√° dispon√≠vel apenas para revendedores da Samsung.

## Ricoh \(ESA\)

A 'Embedded Software Architecture' \([ESA](https://www.ricoh.com/esa/)\) [\[8\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-8) foi lan√ßada pela Ricoh em 2004. O [SDK/J](http://www.ricoh-developer.com/content/device-sdk-type-j-sdkj-overview) baseado em Java est√° dispon√≠vel para desenvolvedores ap√≥s um registro.

## Kyocera/Utax \(HyPAS\)

A 'Hybrid Platform for Advanced Solutions' \([HyPAS](http://usa.kyoceradocumentsolutions.com/americas/jsp/Kyocera/hypas_overview.jsp)\) [\[9\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-9) foi lan√ßada pela Kyocera em 2008. As aplica√ß√µes s√£o baseadas em Java ou em servi√ßos web. O [SDK](https://www.kyoceradocumentsolutions.eu/index/document_solutions/HyPAS/hypas_developer_partner.html) est√° dispon√≠vel apenas para membros do 'Programa de Parceiros de Desenvolvimento HyPAS' e as aplica√ß√µes t√™m que ser aprovadas pela Kyocera.

## Konica Minolta \(bEST\)

A 'bizhub Extended Solution Technology' \([bEST](https://best.kmbs.us/)\) [\[10\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-10) que √© baseada em servi√ßos web foi introduzida pela Konica Minolta em 2009. O acesso ao [SDK](https://best.kmbs.us/pages/levels.php) requer 'n√≠vel de associa√ß√£o platinum' no programa de desenvolvedores por uma taxa de $4,000, o que est√° fora do escopo para pesquisadores independentes.

## Toshiba \(e-BRIDGE\)

A 'e-BRIDGE Open Platform' \([e-BRIDGE](http://www.estudio.com.sg/solutions_ebridge.aspx)\) foi lan√ßada pela Toshiba em 2008 para personalizar seus MFPs de alta gama baseados em tecnologia de servi√ßos web. Um SDK n√£o est√° dispon√≠vel para o p√∫blico em geral.

## Sharp \(OSA\)

A 'Open Systems Architecture' \([OSA](http://siica.sharpusa.com/Document-Systems/Sharp-OSA)\) [\[11\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-11) foi anunciada pela Sharp em 2004. O [SDK](http://sharp-partners.com/us/PartnerPrograms/DeveloperProgram/tabid/722/Default.aspx) usado para desenvolver servi√ßos web √© baseado em taxa e as aplica√ß√µes precisam ser validadas pela Sharp antes de poderem ser instaladas em um MFP.

## Oki \(sXP\)

A 'smart eXtendable Platform' \([sXP](http://www.oki.com/en/press/2014/09/z14053e.html)\) [\[12\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-12) que √© baseada em servi√ßos web foi lan√ßada pela Oki Data em 2013 para seus dispositivos MFP. A Oki n√£o publica nenhuma informa√ß√£o sobre um programa oficial de desenvolvedores ou SDK dispon√≠vel publicamente.

# Resultados

Em impressoras a laser HP mais antigas, bytecode Java arbitr√°rio pode ser executado como demonstrado por [\[3\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-phenoelit2002embedded-3) e [\[4\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-mueller2016printers-4). A seguran√ßa √© baseada na senha do servidor web embutido que pode ser facilmente recuperada com PostScript ou contornada restaurando os padr√µes de f√°brica. √â dif√≠cil fazer uma declara√ß√£o fundamentada sobre a seguran√ßa de outras plataformas de software devido √† falta de acesso ao SDK e/ou documenta√ß√£o t√©cnica adequada. Uma compara√ß√£o das plataformas, tecnologias aplicadas e ‚Äì onde conhecido ‚Äì procedimentos de implanta√ß√£o de pacotes de software √© apresentada abaixo:

| Fornecedor | Plataforma | Java Embutido | Servi√ßos Web | Implanta√ß√£o |
| :--- | :--- | :--- | :--- | :--- |
| HP | Chai/OXP | ‚úî | ‚úî | servidor web |
| Xerox/Dell | EIP |  | ‚úî | desconhecido |
| Canon | MEAP | ‚úî | ‚úî | desconhecido |
| Brother | BSI |  | ‚úî | desconhecido |
| Lexmark | eSF | ‚úî |  | desconhecido |
| Samsung | XOA | ‚úî | ‚úî | servidor web |
| Ricoh | ESA | ‚úî |  | desconhecido |
| Kyocera/Utax | HyPAS | ‚úî | ‚úî | drive USB |
| Konica Minolta | bEST |  | ‚úî | desconhecido |
| Toshiba | e-BRIDGE |  | ‚úî | desconhecido |
| Sharp | OSA |  | ‚úî | desconhecido |
| Oki | sXP |  | ‚úî | desconhecido |

## **Como testar esse ataque?**

Obtenha um SDK e escreva sua pr√≥pria aplica√ß√£o de prova de conceito ou encontre um 'aplicativo para impressora' que j√° fa√ßa o que voc√™ deseja \(por exemplo, fazer upload autom√°tico de documentos digitalizados para FTP\). Verifique tamb√©m quais mecanismos de prote√ß√£o existem para instalar software personalizado no dispositivo.

## **Quem pode realizar esse ataque?**

Dependendo de como os pacotes de software s√£o implantados.



<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**merchandising oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga** me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
