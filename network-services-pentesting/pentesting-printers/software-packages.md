<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel de PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


Au cours des derni√®res ann√©es, les fabricants d'imprimantes ont commenc√© √† introduire la **possibilit√© d'installer des logiciels personnalis√©s sur leurs appareils**. Le format de ces 'applications pour imprimantes' est propri√©taire et les SDK ne sont pas disponibles pour le public. La fonctionnalit√© d'√©crire des logiciels personnalis√©s qui fonctionnent sur les imprimantes √©tait destin√©e et est r√©serv√©e aux revendeurs et aux entrepreneurs, et non aux utilisateurs finaux. Ainsi, une flotte d'imprimantes peut √™tre adapt√©e aux besoins sp√©ciaux et aux processus commerciaux d'une entreprise ; les fournisseurs de solutions documentaires peuvent facilement int√©grer les imprimantes dans leur logiciel de gestion. Un exemple populaire est NSi AutoStore [\[1\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-1) qui peut √™tre install√© sur de nombreux MFP et t√©l√©charge automatiquement les documents scann√©s ou copi√©s vers des emplacements pr√©d√©finis. De toute √©vidence, la fonctionnalit√© d'ex√©cuter du code personnalis√© sur un appareil d'impression est une menace potentielle pour la s√©curit√©. De plus, la signature de code des paquets logiciels est potentiellement plus difficile que pour les [firmware](http://hacking-printers.net/wiki/index.php/Firmware_updates) car les logiciels ne sont pas seulement √©crits par le fabricant de l'imprimante, mais par un √©ventail plus large de d√©veloppeurs qui doivent poss√©der la cl√© secr√®te pour signer leur logiciel. Par cons√©quent, il est logique d'inclure la cl√© secr√®te dans les SDK qui sont prot√©g√©s par leur disponibilit√© exclusive sur les plateformes de d√©veloppeurs. Cet article est un effort pour rassembler syst√©matiquement des informations sur les plateformes logicielles sp√©cifiques aux fournisseurs/SDK.

# Fournisseurs

Dans ce qui suit, un aper√ßu g√©n√©ral des plateformes logicielles fournies par les principaux fabricants d'imprimantes pour √©tendre la fonctionnalit√© de leurs appareils est donn√©.

## HP \(Chai/OXP\)

HP a introduit sa plateforme 'Chai Appliance Platform' en 1999 pour ex√©cuter des applications Java sur les imprimantes LaserJet. Alors qu'un SDK avait d'abord √©t√© ouvert au public [\[2\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-2), l'acc√®s a √©t√© plus tard restreint aux membres du r√©seau de d√©veloppeurs de HP. Les servlets Chai qui viennent sous forme de fichiers `.jar` devaient initialement √™tre certifi√©s et sign√©s par HP avant d'√™tre accept√©s par un appareil d'impression. [\[3\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-phenoelit2002embedded-3) a d√©couvert une faille dans le processus de d√©ploiement : en installant EZloader ‚Äì un logiciel de chargement alternatif fourni par HP qui avait d√©j√† √©t√© sign√© ‚Äì ils ont pu t√©l√©charger et ex√©cuter leurs propres paquets Java non sign√©s. Il semble que la signature de code ait √©t√© compl√®tement abandonn√©e par HP pour les versions ult√©rieures de Chai : [\[4\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-mueller2016printers-4) ont pu √©crire et ex√©cuter un malware d'imprimante de preuve de concept qui √©coute sur le port 9100 et t√©l√©charge les documents entrants sur un serveur FTP avant de les imprimer. Leur code est bas√© sur [\[5\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-5) qui a √©tendu l'appareil pour supporter l'√©quilibrage de charge et a inclus les fichiers SDK requis et les biblioth√®ques Java propri√©taires dans leur d√©monstration. Avec les biblioth√®ques, du code Java arbitraire peut √™tre compil√© et ex√©cut√© sur les anciens HP LaserJets en t√©l√©chargeant les fichiers `.jar` vers une URL 'cach√©e' : [`http://printer/hp/device/this.loader`](http://printer/hp/device/this.loader). Cette attaque peut √™tre men√©e si aucun mot de passe n'a encore √©t√© d√©fini pour le serveur web embarqu√©. Sinon, le mot de passe doit d'abord √™tre r√©cup√©r√© depuis `/dev/rdsk_jdi_cfg0` avec PostScript \(voir [acc√®s au syst√®me de fichiers](http://hacking-printers.net/wiki/index.php/File_system_access)\) ou contourn√© en r√©initialisant l'appareil aux [param√®tres d'usine](http://hacking-printers.net/wiki/index.php/Factory_defaults). Un attaquant web peut t√©l√©charger le fichier `.jar` en utilisant [CSRF](https://en.wikipedia.org/wiki/Cross-site_request_forgery) si la victime est actuellement connect√©e au serveur web embarqu√© de l'imprimante. Pour les appareils plus r√©cents, HP utilise la plateforme 'Open Extensibility Platform' bas√©e sur les services web \([OXP](https://developers.hp.com/oxp/)\) au lieu de Chai pour laquelle aucun SDK n'est disponible publiquement.

## Canon \(MEAP\)

La 'Multifunctional Embedded Application Platform' \([MEAP](http://www.developersupport.canon.com/faq/335#t335n18)\) est une plateforme logicielle bas√©e sur Java introduite par Canon en 2003 pour leur s√©rie imageRunner et √©tendue aux services web en 2010. Les d√©veloppeurs tiers peuvent obtenir le MEAP [SDK](http://developersupport.canon.com/content/meap-sdk-0) moyennant des frais de 5 000 $, ce qui est certainement hors de port√©e pour des fins de recherche.

## Xerox/Dell \(EIP\)

La 'Extensible Interface Platform' \([EIP](http://www.office.xerox.com/eip/enus.html)\) [\[6\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-6) a √©t√© annonc√©e en 2006 par Xerox pour divers MFP. L'architecture ‚Äì qui est √©galement prise en charge par quelques appareils Dell rebadg√©s ‚Äì est bas√©e sur la technologie des services web. Le [SDK](http://www.office.xerox.com/eip/enus.html) est librement disponible pour les d√©veloppeurs enregistr√©s.

## Brother \(BSI\)

L' 'Brother Solutions Interface' \([BSI](https://www.brother-usa.com/lp/civ/bsi.aspx)\) est une architecture web bas√©e sur XML lanc√©e en 2012 pour les scanners, copieurs et imprimantes. L'acc√®s au [SDK](https://www.brother-usa.com/lp/civ/home.aspx) est disponible pour les d√©veloppeurs licenci√©s.

## Lexmark \(eSF\)

Le 'Embedded Solution Framework' \([eSF](http://www.lexmark-emea.com/usa/BSD_solution_catalouge.pdf)\) a √©t√© lanc√© en 2006 pour les MFP Lexmark. Le SDK pour d√©velopper des applications Java est r√©serv√© aux 'partenaires sp√©cialement qualifi√©s'. Selon [\[7\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-7) 'ces applications doivent √™tre num√©riquement sign√©es par Lexmark avant d'√™tre adopt√©es' en utilisant des signatures RSA de 2048 bits.

## Samsung \(XOA\)

L' 'eXtensible Open Architecture' \([XOA](http://samsungprintingsolutions.com/2015/02/can-samsungs-extensible-open-architecture-xoa/)\) a √©t√© introduite par Samsung en 2008 et se d√©cline en deux versions : la machine virtuelle Java XOA-E et les services web bas√©s sur XOA-Web. Le [SDK](http://xoapartnerportal.com/) n'est disponible que pour les revendeurs Samsung.

## Ricoh \(ESA\)

L' 'Embedded Software Architecture' \([ESA](https://www.ricoh.com/esa/)\) [\[8\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-8) a √©t√© lanc√©e par Ricoh en 2004. Le [SDK/J](http://www.ricoh-developer.com/content/device-sdk-type-j-sdkj-overview) bas√© sur Java est disponible pour les d√©veloppeurs apr√®s inscription.

## Kyocera/Utax \(HyPAS\)

La 'Hybrid Platform for Advanced Solutions' \([HyPAS](http://usa.kyoceradocumentsolutions.com/americas/jsp/Kyocera/hypas_overview.jsp)\) [\[9\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-9) a √©t√© publi√©e par Kyocera en 2008. Les applications sont bas√©es soit sur Java, soit sur les services web. Le [SDK](https://www.kyoceradocumentsolutions.eu/index/document_solutions/HyPAS/hypas_developer_partner.html) n'est disponible que pour les membres du 'HyPAS Development Partner Programme' et les applications doivent √™tre approuv√©es par Kyocera.

## Konica Minolta \(bEST\)

La 'bizhub Extended Solution Technology' \([bEST](https://best.kmbs.us/)\) [\[10\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-10) bas√©e sur les services web a √©t√© introduite par Konica Minolta en 2009. L'acc√®s au [SDK](https://best.kmbs.us/pages/levels.php) n√©cessite un 'niveau de membre platinum' dans le programme de d√©veloppeurs moyennant des frais de 4 000 $, ce qui est hors de port√©e pour les chercheurs ind√©pendants.

## Toshiba \(e-BRIDGE\)

L' 'e-BRIDGE Open Platform' \([e-BRIDGE](http://www.estudio.com.sg/solutions_ebridge.aspx)\) a √©t√© publi√©e par Toshiba en 2008 pour personnaliser leurs MFP haut de gamme bas√©s sur la technologie des services web. Un SDK n'est pas disponible pour le grand public.

## Sharp \(OSA\)

L' 'Open Systems Architecture' \([OSA](http://siica.sharpusa.com/Document-Systems/Sharp-OSA)\) [\[11\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-11) a √©t√© annonc√©e par Sharp en 2004. Le [SDK](http://sharp-partners.com/us/PartnerPrograms/DeveloperProgram/tabid/722/Default.aspx) utilis√© pour d√©velopper des services web est payant et les applications doivent √™tre valid√©es par Sharp avant de pouvoir √™tre install√©es sur un MFP.

## Oki \(sXP\)

La 'smart eXtendable Platform' \([sXP](http://www.oki.com/en/press/2014/09/z14053e.html)\) [\[12\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-12) bas√©e sur les services web a √©t√© lanc√©e par Oki Data en 2013 pour leurs appareils MFP. Oki ne publie aucune information concernant un programme de d√©veloppeur officiel ou un SDK disponible publiquement.

# R√©sultats

Sur les anciennes imprimantes laser HP, du bytecode Java arbitraire peut √™tre ex√©cut√© comme d√©montr√© par [\[3\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-phenoelit2002embedded-3) et [\[4\]](http://hacking-printers.net/wiki/index.php/Software_packages#cite_note-mueller2016printers-4). La s√©curit√© est bas√©e sur le mot de passe du serveur web embarqu√© qui peut √™tre facilement r√©cup√©r√© avec PostScript ou contourn√© en r√©tablissant les param√®tres d'usine. Il est difficile de faire une d√©claration raisonn√©e sur la s√©curit√© des autres plateformes logicielles en raison du manque d'acc√®s au SDK et/ou √† une documentation technique appropri√©e. Une comparaison des plateformes, des technologies appliqu√©es et ‚Äì lorsque connues ‚Äì des proc√©dures de d√©ploiement des paquets logiciels est donn√©e ci-dessous :

| Fournisseur | Plateforme | Java embarqu√© | Services web | D√©ploiement |
| :--- | :--- | :--- | :--- | :--- |
| HP | Chai/OXP | ‚úî | ‚úî | serveur web |
| Xerox/Dell | EIP |  | ‚úî | inconnu |
| Canon | MEAP | ‚úî | ‚úî | inconnu |
| Brother | BSI |  | ‚úî | inconnu |
| Lexmark | eSF | ‚úî |  | inconnu |
| Samsung | XOA | ‚úî | ‚úî | serveur web |
| Ricoh | ESA | ‚úî |  | inconnu |
| Kyocera/Utax | HyPAS | ‚úî | ‚úî | cl√© USB |
| Konica Minolta | bEST |  | ‚úî | inconnu |
| Toshiba | e-BRIDGE |  | ‚úî | inconnu |
| Sharp | OSA |  | ‚úî | inconnu |
| Oki | sXP |  | ‚úî | inconnu |

## **Comment tester cette attaque ?**

Obtenez un SDK et √©crivez votre propre application de preuve de concept ou trouvez une 'application pour imprimante' qui fait d√©j√† ce que vous voulez \(par exemple, t√©l√©charger automatiquement des documents scann√©s vers FTP\). V√©rifiez √©galement quels m√©canismes de protection existent pour installer des logiciels personnalis√©s sur l'appareil.

## **Qui peut r√©aliser cette attaque ?**

D√©pend de la mani√®re dont les paquets logiciels sont d√©ploy√©s.



<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel de PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
