# 5353/UDP Multicast DNS (mDNS) e DNS-SD

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}

## **Informa√ß√µes B√°sicas**

**Multicast DNS (mDNS)** permite **opera√ß√µes semelhantes ao DNS** dentro de redes locais sem a necessidade de um servidor DNS tradicional. Ele opera na **porta UDP 5353** e permite que dispositivos descubram uns aos outros e seus servi√ßos, comumente visto em v√°rios dispositivos IoT. **DNS Service Discovery (DNS-SD)**, frequentemente usado junto com mDNS, ajuda a identificar servi√ßos dispon√≠veis na rede atrav√©s de consultas DNS padr√£o.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Opera√ß√£o do mDNS**

Em ambientes sem um servidor DNS padr√£o, o mDNS permite que dispositivos resolvam nomes de dom√≠nio terminando em **.local** consultando o endere√ßo multicast **224.0.0.251** (IPv4) ou **FF02::FB** (IPv6). Aspectos importantes do mDNS incluem um valor de **Time-to-Live (TTL)** que indica a validade do registro e um **bit QU** que distingue entre consultas unicast e multicast. Do ponto de vista da seguran√ßa, √© crucial que as implementa√ß√µes de mDNS verifiquem se o endere√ßo de origem do pacote est√° alinhado com a sub-rede local.

### **Funcionamento do DNS-SD**

O DNS-SD facilita a descoberta de servi√ßos de rede consultando registros de ponteiro (PTR) que mapeiam tipos de servi√ßo para suas inst√¢ncias. Os servi√ßos s√£o identificados usando um padr√£o **_\<Service>.\_tcp ou \_\<Service>.\_udp** dentro do dom√≠nio **.local**, levando √† descoberta de correspondentes **SRV** e **TXT records** que fornecem informa√ß√µes detalhadas sobre o servi√ßo.

### **Explora√ß√£o de Rede**

#### **Uso do nmap**

Um comando √∫til para escanear a rede local em busca de servi√ßos mDNS √©:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Este comando ajuda a identificar portas mDNS abertas e os servi√ßos anunciados por elas.

#### **Enumera√ß√£o de Rede com Pholus**

Para enviar ativamente solicita√ß√µes mDNS e capturar tr√°fego, a ferramenta **Pholus** pode ser utilizada da seguinte forma:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Ataques

### **Explorando a Probing do mDNS**

Um vetor de ataque envolve o envio de respostas falsificadas para as sondas mDNS, sugerindo que todos os nomes potenciais j√° est√£o em uso, dificultando que novos dispositivos selecionem um nome √∫nico. Isso pode ser executado usando:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Esta t√©cnica bloqueia efetivamente novos dispositivos de registrarem seus servi√ßos na rede.

**Em resumo**, entender o funcionamento do mDNS e DNS-SD √© crucial para a gest√£o e seguran√ßa da rede. Ferramentas como **nmap** e **Pholus** oferecem insights valiosos sobre os servi√ßos de rede local, enquanto a conscientiza√ß√£o sobre vulnerabilidades potenciais ajuda a proteger contra ataques.

### Spoofing/MitM

O ataque mais interessante que voc√™ pode realizar sobre este servi√ßo √© executar um **MitM** na **comunica√ß√£o entre o cliente e o servidor real**. Voc√™ pode ser capaz de obter arquivos sens√≠veis (MitM na comunica√ß√£o com a impressora) ou at√© mesmo credenciais (autentica√ß√£o do Windows).\
Para mais informa√ß√µes, consulte:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Refer√™ncias

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Aprenda e pratique Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprenda e pratique Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Confira os [**planos de assinatura**](https://github.com/sponsors/carlospolop)!
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-nos no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
