# 5353/UDP Multicast DNS (mDNS) και DNS-SD

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **Βασικές Πληροφορίες**

**Multicast DNS (mDNS)** επιτρέπει **λειτουργίες παρόμοιες με το DNS** εντός τοπικών δικτύων χωρίς την ανάγκη παραδοσιακού διακομιστή DNS. Λειτουργεί στην **UDP θύρα 5353** και επιτρέπει στις συσκευές να ανακαλύπτουν η μία την άλλη και τις υπηρεσίες τους, κάτι που παρατηρείται συχνά σε διάφορες IoT συσκευές. **DNS Service Discovery (DNS-SD)**, που χρησιμοποιείται συχνά παράλληλα με το mDNS, βοηθά στην αναγνώριση υπηρεσιών που είναι διαθέσιμες στο δίκτυο μέσω τυπικών ερωτημάτων DNS.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Λειτουργία του mDNS**

Σε περιβάλλοντα χωρίς έναν τυπικό διακομιστή DNS, το mDNS επιτρέπει στις συσκευές να επιλύουν ονόματα τομέα που τελειώνουν σε **.local** ερωτώντας τη διεύθυνση multicast **224.0.0.251** (IPv4) ή **FF02::FB** (IPv6). Σημαντικές πτυχές του mDNS περιλαμβάνουν μια τιμή **Time-to-Live (TTL)** που υποδεικνύει την εγκυρότητα της εγγραφής και ένα **QU bit** που διακρίνει μεταξύ unicast και multicast ερωτήσεων. Από πλευράς ασφάλειας, είναι κρίσιμο για τις υλοποιήσεις mDNS να επαληθεύουν ότι η διεύθυνση προέλευσης του πακέτου ευθυγραμμίζεται με το τοπικό υποδίκτυο.

### **Λειτουργία του DNS-SD**

Το DNS-SD διευκολύνει την ανακάλυψη δικτυακών υπηρεσιών ερωτώντας για εγγραφές δείκτη (PTR) που αντιστοιχούν σε τύπους υπηρεσιών και τις περιπτώσεις τους. Οι υπηρεσίες αναγνωρίζονται χρησιμοποιώντας ένα μοτίβο **_\<Service>.\_tcp ή \_\<Service>.\_udp** εντός του τομέα **.local**, οδηγώντας στην ανακάλυψη αντίστοιχων **SRV** και **TXT records** που παρέχουν λεπτομερείς πληροφορίες για την υπηρεσία.

### **Εξερεύνηση Δικτύου**

#### **Χρήση του nmap**

Μια χρήσιμη εντολή για σάρωση του τοπικού δικτύου για υπηρεσίες mDNS είναι:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Αυτή η εντολή βοηθά στην αναγνώριση ανοιχτών θυρών mDNS και των υπηρεσιών που διαφημίζονται μέσω αυτών.

#### **Δικτυακή Αρίθμηση με Pholus**

Για να στείλετε ενεργά αιτήματα mDNS και να καταγράψετε την κίνηση, το εργαλείο **Pholus** μπορεί να χρησιμοποιηθεί ως εξής:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Επιθέσεις

### **Εκμετάλλευση mDNS Probing**

Ένα διακυβερνητικό μέσο περιλαμβάνει την αποστολή ψευδών απαντήσεων σε mDNS probes, υποδεικνύοντας ότι όλα τα πιθανά ονόματα είναι ήδη σε χρήση, εμποδίζοντας έτσι τις νέες συσκευές να επιλέξουν ένα μοναδικό όνομα. Αυτό μπορεί να εκτελεστεί χρησιμοποιώντας:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Αυτή η τεχνική μπλοκάρει αποτελεσματικά τις νέες συσκευές από το να καταχωρούν τις υπηρεσίες τους στο δίκτυο.

**Συνοψίζοντας**, η κατανόηση της λειτουργίας του mDNS και του DNS-SD είναι κρίσιμη για τη διαχείριση και την ασφάλεια του δικτύου. Εργαλεία όπως το **nmap** και το **Pholus** προσφέρουν πολύτιρες πληροφορίες σχετικά με τις τοπικές υπηρεσίες δικτύου, ενώ η επίγνωση των πιθανών ευπαθειών βοηθά στην προστασία από επιθέσεις.

### Spoofing/MitM

Η πιο ενδιαφέρουσα επίθεση που μπορείτε να εκτελέσετε μέσω αυτής της υπηρεσίας είναι να πραγματοποιήσετε ένα **MitM** στην **επικοινωνία μεταξύ του πελάτη και του πραγματικού διακομιστή**. Μπορείτε να αποκτήσετε ευαίσθητα αρχεία (MitM την επικοινωνία με τον εκτυπωτή) ή ακόμα και διαπιστευτήρια (Windows authentication).\
Για περισσότερες πληροφορίες ελέγξτε:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Αναφορές

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Μάθετε & εξασκηθείτε στο AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Μάθετε & εξασκηθείτε στο GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Υποστήριξη HackTricks</summary>

* Ελέγξτε τα [**σχέδια συνδρομής**](https://github.com/sponsors/carlospolop)!
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε κόλπα hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
