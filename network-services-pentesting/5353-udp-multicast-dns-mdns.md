# 5353/UDP Multicast DNS (mDNS) et DNS-SD

{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}

## **Informations de base**

**Multicast DNS (mDNS)** permet des **op√©rations similaires √† DNS** au sein des r√©seaux locaux sans avoir besoin d'un serveur DNS traditionnel. Il fonctionne sur le **port UDP 5353** et permet aux appareils de se d√©couvrir mutuellement et leurs services, couramment observ√© dans divers appareils IoT. **DNS Service Discovery (DNS-SD)**, souvent utilis√© avec mDNS, aide √† identifier les services disponibles sur le r√©seau via des requ√™tes DNS standard.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Fonctionnement de mDNS**

Dans des environnements sans serveur DNS standard, mDNS permet aux appareils de r√©soudre des noms de domaine se terminant par **.local** en interrogeant l'adresse multicast **224.0.0.251** (IPv4) ou **FF02::FB** (IPv6). Les aspects importants de mDNS incluent une valeur **Time-to-Live (TTL)** indiquant la validit√© des enregistrements et un **bit QU** distinguant les requ√™tes unicast et multicast. D'un point de vue s√©curit√©, il est crucial que les impl√©mentations de mDNS v√©rifient que l'adresse source du paquet correspond au sous-r√©seau local.

### **Fonctionnement de DNS-SD**

DNS-SD facilite la d√©couverte de services r√©seau en interrogeant des enregistrements de pointeur (PTR) qui associent les types de services √† leurs instances. Les services sont identifi√©s √† l'aide d'un motif **_\<Service>.\_tcp ou \_\<Service>.\_udp** dans le domaine **.local**, ce qui conduit √† la d√©couverte des **enregistrements SRV** et **TXT** correspondants qui fournissent des informations d√©taill√©es sur le service.

### **Exploration du R√©seau**

#### **Utilisation de nmap**

Une commande utile pour scanner le r√©seau local √† la recherche de services mDNS est :
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Cette commande aide √† identifier les ports mDNS ouverts et les services annonc√©s sur ceux-ci.

#### **√ânum√©ration de R√©seau avec Pholus**

Pour envoyer activement des requ√™tes mDNS et capturer le trafic, l'outil **Pholus** peut √™tre utilis√© comme suit :
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Attaques

### **Exploitation de l'interrogation mDNS**

Un vecteur d'attaque consiste √† envoyer des r√©ponses falsifi√©es aux requ√™tes mDNS, sugg√©rant que tous les noms potentiels sont d√©j√† utilis√©s, entravant ainsi les nouveaux appareils dans le choix d'un nom unique. Cela peut √™tre ex√©cut√© en utilisant :
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Cette technique bloque efficacement les nouveaux appareils de l'enregistrement de leurs services sur le r√©seau.

**En r√©sum√©**, comprendre le fonctionnement de mDNS et DNS-SD est crucial pour la gestion et la s√©curit√© des r√©seaux. Des outils comme **nmap** et **Pholus** offrent des informations pr√©cieuses sur les services de r√©seau local, tandis que la sensibilisation aux vuln√©rabilit√©s potentielles aide √† se prot√©ger contre les attaques.

### Spoofing/MitM

L'attaque la plus int√©ressante que vous pouvez effectuer sur ce service est de r√©aliser un **MitM** dans la **communication entre le client et le v√©ritable serveur**. Vous pourriez √™tre en mesure d'obtenir des fichiers sensibles (MitM la communication avec l'imprimante) ou m√™me des identifiants (authentification Windows).\
Pour plus d'informations, consultez :

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## R√©f√©rences

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
