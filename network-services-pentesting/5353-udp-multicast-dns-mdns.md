# 5353/UDP Multicast DNS (mDNS) —Ç–∞ DNS-SD

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**Multicast DNS (mDNS)** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ **–æ–ø–µ—Ä–∞—Ü—ñ—ó, –ø–æ–¥—ñ–±–Ω—ñ –¥–æ DNS**, —É –ª–æ–∫–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –≤ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–º—É DNS-—Å–µ—Ä–≤–µ—Ä—ñ. –í—ñ–Ω –ø—Ä–∞—Ü—é—î –Ω–∞ **UDP –ø–æ—Ä—Ç—É 5353** —ñ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Å—Ç—Ä–æ—è–º –≤–∏—è–≤–ª—è—Ç–∏ –æ–¥–Ω–µ –æ–¥–Ω–æ–≥–æ —Ç–∞ —Å–≤–æ—ó –ø–æ—Å–ª—É–≥–∏, —â–æ —á–∞—Å—Ç–æ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ —Ä—ñ–∑–Ω–∏—Ö IoT-–ø—Ä–∏—Å—Ç—Ä–æ—è—Ö. **DNS Service Discovery (DNS-SD)**, —è–∫–∏–π —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–∞–∑–æ–º –∑ mDNS, –¥–æ–ø–æ–º–∞–≥–∞—î –≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ—Å–ª—É–≥, –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —É –º–µ—Ä–µ–∂—ñ, —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ DNS-–∑–∞–ø–∏—Ç–∏.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **–û–ø–µ—Ä–∞—Ü—ñ—è mDNS**

–£ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö –±–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ DNS-—Å–µ—Ä–≤–µ—Ä–∞ mDNS –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∏—Å—Ç—Ä–æ—è–º —Ä–æ–∑–≤'—è–∑—É–≤–∞—Ç–∏ –¥–æ–º–µ–Ω–Ω—ñ —ñ–º–µ–Ω–∞, —â–æ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è –Ω–∞ **.local**, –∑–∞–ø–∏—Ç—É—é—á–∏ –º—É–ª—å—Ç–∏–∫–∞—Å—Ç-–∞–¥—Ä–µ—Å—É **224.0.0.251** (IPv4) –∞–±–æ **FF02::FB** (IPv6). –í–∞–∂–ª–∏–≤–∏–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ mDNS —î –∑–Ω–∞—á–µ–Ω–Ω—è **Time-to-Live (TTL)**, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –¥—ñ–π—Å–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Å—É, —Ç–∞ **QU bit**, —â–æ —Ä–æ–∑—Ä—ñ–∑–Ω—è—î —É–Ω—ñicast —Ç–∞ –º—É–ª—å—Ç–∏–∫–∞—Å—Ç –∑–∞–ø–∏—Ç–∏. –ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –±–µ–∑–ø–µ–∫–∏, –≤–∞–∂–ª–∏–≤–æ, —â–æ–± —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó mDNS –ø–µ—Ä–µ–≤—ñ—Ä—è–ª–∏, —â–æ –∞–¥—Ä–µ—Å–∞ –¥–∂–µ—Ä–µ–ª–∞ –ø–∞–∫–µ—Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –ª–æ–∫–∞–ª—å–Ω—ñ–π –ø—ñ–¥–º–µ—Ä–µ–∂—ñ.

### **–§—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è DNS-SD**

DNS-SD –ø–æ–ª–µ–≥—à—É—î –≤–∏—è–≤–ª–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤, –∑–∞–ø–∏—Ç—É—é—á–∏ –∑–∞–ø–∏—Å–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ (PTR), —è–∫—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å —Ç–∏–ø–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤ –Ω–∞ —ó—Ö–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏. –°–µ—Ä–≤—ñ—Å–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —à–∞–±–ª–æ–Ω—É **_\<Service>.\_tcp –∞–±–æ \_\<Service>.\_udp** –≤ –¥–æ–º–µ–Ω—ñ **.local**, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö **SRV** —Ç–∞ **TXT –∑–∞–ø–∏—Å—ñ–≤**, —è–∫—ñ –Ω–∞–¥–∞—é—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Å–µ—Ä–≤—ñ—Å.

### **–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –º–µ—Ä–µ–∂—ñ**

#### **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è nmap**

–ö–æ—Ä–∏—Å–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å mDNS —Å–µ—Ä–≤—ñ—Å—ñ–≤:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
–¶—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∏—è–≤–∏—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏ mDNS —Ç–∞ —Å–µ—Ä–≤—ñ—Å–∏, —è–∫—ñ —Ä–µ–∫–ª–∞–º—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –Ω–∏—Ö.

#### **–ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –º–µ—Ä–µ–∂—ñ –∑ Pholus**

–©–æ–± –∞–∫—Ç–∏–≤–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ mDNS —Ç–∞ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **Pholus** –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## –ê—Ç–∞–∫–∏

### **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è mDNS –ü—Ä–æ–±—É–≤–∞–Ω–Ω—è**

–ê—Ç–∞–∫—É—é—á–∏–π –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—è–≥–∞—î —É –≤—ñ–¥–ø—Ä–∞–≤—Ü—ñ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ mDNS –ø—Ä–æ–±–∏, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –≤—Å—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —ñ–º–µ–Ω–∞ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è, —Ç–∏–º —Å–∞–º–∏–º —É—Å–∫–ª–∞–¥–Ω—é—é—á–∏ –Ω–æ–≤–∏–º –ø—Ä–∏—Å—Ç—Ä–æ—è–º –≤–∏–±—ñ—Ä —É–Ω—ñ–∫–∞–ª—å–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ. –¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫—É—î –Ω–æ–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó –≤—ñ–¥ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Å–≤–æ—ó—Ö –ø–æ—Å–ª—É–≥ —É –º–µ—Ä–µ–∂—ñ.

**–£ –ø—ñ–¥—Å—É–º–∫—É**, —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ mDNS —Ç–∞ DNS-SD —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–µ—Ä–µ–∂–µ—é —Ç–∞ –±–µ–∑–ø–µ–∫–∏. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ **nmap** —Ç–∞ **Pholus**, –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ü—ñ–Ω–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ª–æ–∫–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –ø–æ—Å–ª—É–≥–∏, —Ç–æ–¥—ñ —è–∫ —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –¥–æ–ø–æ–º–∞–≥–∞—î –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏—Å—è –≤—ñ–¥ –∞—Ç–∞–∫.

### Spoofing/MitM

–ù–∞–π—Ü—ñ–∫–∞–≤—ñ—à–∞ –∞—Ç–∞–∫–∞, —è–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ —Ü—é —Å–ª—É–∂–±—É, - —Ü–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ **MitM** —É **–∑–≤'—è–∑–∫—É –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —ñ —Ä–µ–∞–ª—å–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º**. –í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —á—É—Ç–ª–∏–≤—ñ —Ñ–∞–π–ª–∏ (MitM –∑–≤'—è–∑–æ–∫ –∑ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–º) –∞–±–æ –Ω–∞–≤—ñ—Ç—å –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ (–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è Windows).\
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## References

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
