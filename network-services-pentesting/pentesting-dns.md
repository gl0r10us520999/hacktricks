# 53 - Pentesting DNS

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**–û—Ç—Ä–∏–º–∞–π—Ç–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É —Ö–∞–∫–µ—Ä–∞ —â–æ–¥–æ –≤–∞—à–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤, –º–µ—Ä–µ–∂—ñ —Ç–∞ —Ö–º–∞—Ä–∏**

**–ó–Ω–∞–π–¥—ñ—Ç—å —ñ –ø–æ–≤—ñ–¥–æ–º—Ç–µ –ø—Ä–æ –∫—Ä–∏—Ç–∏—á–Ω—ñ, –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∑ —Ä–µ–∞–ª—å–Ω–∏–º –±—ñ–∑–Ω–µ—Å-—ñ–º–ø–∞–∫—Ç–æ–º.** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞—à—ñ 20+ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ—É–≤–∞–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö–Ω—ñ –∞—Ç–∞–∫–∏, –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è –∑–±–æ—Ä—É –≤–∞–∂–ª–∏–≤–∏—Ö –¥–æ–∫–∞–∑—ñ–≤, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –≤–∞—à—É –≤–∞–∂–∫—É –ø—Ä–∞—Ü—é –Ω–∞ –ø–µ—Ä–µ–∫–æ–Ω–ª–∏–≤—ñ –∑–≤—ñ—Ç–∏.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**–°–∏—Å—Ç–µ–º–∞ –¥–æ–º–µ–Ω–Ω–∏—Ö —ñ–º–µ–Ω (DNS)** —Å–ª—É–≥—É—î –∫–∞—Ç–∞–ª–æ–≥–æ–º –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–µ–±-—Å–∞–π—Ç—ñ–≤ —á–µ—Ä–µ–∑ **–ª–µ–≥–∫–æ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É–≤–∞–Ω—ñ –¥–æ–º–µ–Ω–Ω—ñ —ñ–º–µ–Ω–∞** —Ç–∞–∫—ñ —è–∫ google.com –∞–±–æ facebook.com, –∑–∞–º—ñ—Å—Ç—å —á–∏—Å–ª–æ–≤–∏—Ö –∞–¥—Ä–µ—Å –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ—Ç–æ–∫–æ–ª—É (IP). –ü–µ—Ä–µ–∫–ª–∞–¥–∞—é—á–∏ –¥–æ–º–µ–Ω–Ω—ñ —ñ–º–µ–Ω–∞ –≤ IP-–∞–¥—Ä–µ—Å–∏, DNS –∑–∞–±–µ–∑–ø–µ—á—É—î —à–≤–∏–¥–∫–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–∞–º–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Å–ø—Ä–æ—â—É—é—á–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é –≤ –æ–Ω–ª–∞–π–Ω-—Å–≤—ñ—Ç—ñ.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### Different DNS Servers

* **DNS Root Servers**: –¶–µ —Å–µ—Ä–≤–µ—Ä–∏, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –Ω–∞ –≤–µ—Ä—à–∏–Ω—ñ —ñ—î—Ä–∞—Ä—Ö—ñ—ó DNS, –∫–µ—Ä—É—é—á–∏ –¥–æ–º–µ–Ω–∞–º–∏ –≤–µ—Ä—Ö–Ω—å–æ–≥–æ —Ä—ñ–≤–Ω—è —ñ –≤—Ç—Ä—É—á–∞—é—á–∏—Å—å –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä–∏ –Ω–∏–∂—á–æ–≥–æ —Ä—ñ–≤–Ω—è –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å. –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ—è –∑ –ø—Ä–∏—Å–≤–æ—î–Ω–Ω—è —ñ–º–µ–Ω —Ç–∞ –Ω–æ–º–µ—Ä—ñ–≤ (**ICANN**) –∫–æ–Ω—Ç—Ä–æ–ª—é—î —ó—Ö–Ω—é —Ä–æ–±–æ—Ç—É, –∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 13.
* **Authoritative Nameservers**: –¶—ñ —Å–µ—Ä–≤–µ—Ä–∏ –º–∞—é—Ç—å –æ—Å—Ç–∞—Ç–æ—á–Ω–µ —Å–ª–æ–≤–æ –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤ —É —Å–≤–æ—ó—Ö –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –∑–æ–Ω–∞—Ö, –Ω–∞–¥–∞—é—á–∏ –æ—Å—Ç–∞—Ç–æ—á–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –Ø–∫—â–æ –≤–æ–Ω–∏ –Ω–µ –º–æ–∂—É—Ç—å –Ω–∞–¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∑–∞–ø–∏—Ç –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –∫–æ—Ä–µ–Ω–µ–≤–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º.
* **Non-authoritative Nameservers**: –ù–µ –º–∞—é—á–∏ –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ –Ω–∞–¥ –∑–æ–Ω–∞–º–∏ DNS, —Ü—ñ —Å–µ—Ä–≤–µ—Ä–∏ –∑–±–∏—Ä–∞—é—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–æ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç–∏ –¥–æ —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤.
* **Caching DNS Server**: –¶–µ–π —Ç–∏–ø —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ –ø–µ–≤–Ω–∏–π —á–∞—Å, —â–æ–± –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –º–∞–π–±—É—Ç–Ω—ñ –∑–∞–ø–∏—Ç–∏, –ø—Ä–∏ —Ü—å–æ–º—É —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∫–µ—à—É –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º.
* **Forwarding Server**: –í–∏–∫–æ–Ω—É—é—á–∏ –ø—Ä–æ—Å—Ç—É —Ä–æ–ª—å, –ø–µ—Ä–µ—Å–∏–ª–∞–ª—å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—é—Ç—å –∑–∞–ø–∏—Ç–∏ –Ω–∞ —ñ–Ω—à–∏–π —Å–µ—Ä–≤–µ—Ä.
* **Resolver**: –Ü–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω—ñ –≤ –∫–æ–º–ø'—é—Ç–µ—Ä–∏ –∞–±–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏, —Ä–µ–∑–æ–ª–≤–µ—Ä–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è —ñ–º–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ —ñ –Ω–µ –≤–≤–∞–∂–∞—é—Ç—å—Å—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω–∏–º–∏.

## Enumeration

### **Banner Grabbing**

–£ DNS –Ω–µ–º–∞—î –±–∞–Ω–µ—Ä—ñ–≤, –∞–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –º–∞–≥—ñ—á–Ω–∏–π –∑–∞–ø–∏—Ç –¥–ª—è `version.bind. CHAOS TXT`, —è–∫–∏–π –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –Ω–∞ –±—ñ–ª—å—à–æ—Å—Ç—ñ BIND nameserver.\
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ–π –∑–∞–ø–∏—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `dig`:
```bash
dig version.bind CHAOS TXT @DNS
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [`fpdns`](https://github.com/kirei/fpdns) —Ç–∞–∫–æ–∂ –º–æ–∂–µ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –≤—ñ–¥–±–∏—Ç–æ–∫ —Å–µ—Ä–≤–µ—Ä–∞.

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –±–∞–Ω–µ—Ä –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞ **nmap**:
```
--script dns-nsid
```
### **–ë—É–¥—å-—è–∫–∏–π –∑–∞–ø–∏—Å**

–ó–∞–ø–∏—Ç **ANY** –ø–æ–ø—Ä–æ—Å–∏—Ç—å DNS-—Å–µ—Ä–≤–µ—Ä **–ø–æ–≤–µ—Ä–Ω—É—Ç–∏** –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ **–≤—Ö–æ–¥–∏**, —è–∫—ñ **–≤—ñ–Ω –≥–æ—Ç–æ–≤–∏–π —Ä–æ–∑–∫—Ä–∏—Ç–∏**.
```bash
dig any victim.com @<DNS_IP>
```
### **Zone Transfer**

–¶—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —Å–∫–æ—Ä–æ—á–µ–Ω–æ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `Asynchronous Full Transfer Zone` (`AXFR`).
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### –ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è nslookup
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### –ö–æ—Ä–∏—Å–Ω—ñ –º–æ–¥—É–ª—ñ metasploit
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### –ö–æ—Ä–∏—Å–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ nmap
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - –ó–≤–æ—Ä–æ—Ç–Ω–∏–π BF
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
–Ø–∫—â–æ –≤–∞–º –≤–¥–∞—î—Ç—å—Å—è –∑–Ω–∞–π—Ç–∏ –ø—ñ–¥–¥–æ–º–µ–Ω–∏, —â–æ —Ä–æ–∑–≤'—è–∑—É—é—Ç—å—Å—è –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ IP-–∞–¥—Ä–µ—Å–∏, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ä–µ–≤–µ—Ä—Å–Ω–∏–π DNS BF –¥–æ NS –¥–æ–º–µ–Ω—É, –∑–∞–ø–∏—Ç—É—é—á–∏ —Ü–µ–π –¥—ñ–∞–ø–∞–∑–æ–Ω IP.
{% endhint %}

–Ü–Ω—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ü—å–æ–≥–æ: [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ —Ä–µ–≤–µ—Ä—Å–Ω—ñ IP-–¥—ñ–∞–ø–∞–∑–æ–Ω–∏ –Ω–∞ [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#_dns) (—Ü–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ç–∞–∫–æ–∂ –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è BGP).

### DNS - –ü—ñ–¥–¥–æ–º–µ–Ω–∏ BF
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### –°–µ—Ä–≤–µ—Ä–∏ Active Directory
```bash
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com

nslookup -type=srv _kerberos._tcp.<CLIENT_DOMAIN>
nslookup -type=srv _kerberos._tcp.domain.com

nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—ñ–≤ "AAAA" –¥–ª—è –∑–±–æ—Ä—É IPv6 –ø—ñ–¥–¥–æ–º–µ–Ω—ñ–≤.
```bash
dnsdict6 -s -t <domain>
```
–ë—Ä—É—Ç—Ñ–æ—Ä—Å –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ DNS –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º IPv6 –∞–¥—Ä–µ—Å
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNS Recursion DDoS

–Ø–∫—â–æ **–≤–∫–ª—é—á–µ–Ω–∞ —Ä–µ–∫—É—Ä—Å—ñ—è DNS**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ **–ø—ñ–¥—Ä–æ–±–∏—Ç–∏** **–¥–∂–µ—Ä–µ–ª–æ** –≤ UDP-–ø–∞–∫–µ—Ç—ñ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **DNS –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∂–µ—Ä—Ç–≤–∏**. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Å—ñ–≤ **ANY** –∞–±–æ **DNSSEC**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å –±—ñ–ª—å—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.\
–°–ø–æ—Å—ñ–± **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**, —á–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î DNS **—Ä–µ–∫—É—Ä—Å—ñ—é**, - —Ü–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è —Ç–∞ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**, —á–∏ —î **–ø–æ–∑–Ω–∞—á–∫–∞ "ra"** (_—Ä–µ–∫—É—Ä—Å—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∞_) —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
```bash
dig google.com A @<IP>
```
**–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ**:

![](<../.gitbook/assets/image (123).png>)

**–î–æ—Å—Ç—É–ø–Ω–æ**:

![](<../.gitbook/assets/image (146).png>)

<figure><img src="../.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**–û—Ç—Ä–∏–º–∞–π—Ç–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É —Ö–∞–∫–µ—Ä–∞ —â–æ–¥–æ –≤–∞—à–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤, –º–µ—Ä–µ–∂—ñ —Ç–∞ —Ö–º–∞—Ä–∏**

**–ó–Ω–∞–π–¥—ñ—Ç—å —ñ –ø–æ–≤—ñ–¥–æ–º—Ç–µ –ø—Ä–æ –∫—Ä–∏—Ç–∏—á–Ω—ñ, –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∑ —Ä–µ–∞–ª—å–Ω–∏–º –±—ñ–∑–Ω–µ—Å-—ñ–º–ø–∞–∫—Ç–æ–º.** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞—à—ñ 20+ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ—É–≤–∞–Ω–Ω—è –∞—Ç–∞–∫—É—é—á–æ—ó –ø–æ–≤–µ—Ä—Ö–Ω—ñ, –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è –∑–±–æ—Ä—É –≤–∞–∂–ª–∏–≤–∏—Ö –¥–æ–∫–∞–∑—ñ–≤, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –≤–∞—à—É –≤–∞–∂–∫—É –ø—Ä–∞—Ü—é –Ω–∞ –ø–µ—Ä–µ–∫–æ–Ω–ª–∏–≤—ñ –∑–≤—ñ—Ç–∏.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

### –õ–∏—Å—Ç –Ω–∞ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π –∞–∫–∞—É–Ω—Ç

**–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ –Ω–∞ –Ω–µ—ñ—Å–Ω—É—é—á—É –∞–¥—Ä–µ—Å—É** –∑ –¥–æ–º–µ–Ω—É –∂–µ—Ä—Ç–≤–∏ –º–æ–∂–µ —Å–ø–æ–Ω—É–∫–∞—Ç–∏ –∂–µ—Ä—Ç–≤—É –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ–Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç–∞–≤–∫–∏ (NDN), –∑–∞–≥–æ–ª–æ–≤–∫–∏ —è–∫–æ–≥–æ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ —Ü—ñ–∫–∞–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫ **–Ω–∞–∑–≤–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤ —Ç–∞ IP-–∞–¥—Ä–µ—Å–∏**.

## –ü–æ—Å—Ç-–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

* –ü—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞ Bind –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **`allow-transfer`**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∫–∞–∑—É—î, —Ö—Ç–æ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—á—ñ –∑–æ–Ω, –∞ —Ç–∞–∫–æ–∂ **`allow-recursion`** —ñ **`allow-query`**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –≤–∫–∞–∑—É—é—Ç—å, —Ö—Ç–æ –º–æ–∂–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏ —Ç–∞ –∑–∞–ø–∏—Ç–∏ –¥–æ –Ω—å–æ–≥–æ.
* –ù–∞—Å—Ç—É–ø–Ω—ñ —î –Ω–∞–∑–≤–∞–º–∏ —Ñ–∞–π–ª—ñ–≤, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ DNS, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ü—ñ–∫–∞–≤–∏–º–∏ –¥–ª—è –ø–æ—à—É–∫—É –Ω–∞ –º–∞—à–∏–Ω–∞—Ö:
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
## References

* [https://www.myrasecurity.com/en/knowledge-hub/dns/](https://www.myrasecurity.com/en/knowledge-hub/dns/)
* –ö–Ω–∏–≥–∞: **–û—Ü—ñ–Ω–∫–∞ –±–µ–∑–ø–µ–∫–∏ –º–µ—Ä–µ–∂—ñ 3-—Ç—î –≤–∏–¥–∞–Ω–Ω—è**

## HackTricks Automatic Commands
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="../.gitbook/assets/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**–û—Ç—Ä–∏–º–∞–π—Ç–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É —Ö–∞–∫–µ—Ä–∞ —â–æ–¥–æ –≤–∞—à–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤, –º–µ—Ä–µ–∂—ñ —Ç–∞ —Ö–º–∞—Ä–∏**

**–ó–Ω–∞–π–¥—ñ—Ç—å —ñ –ø–æ–≤—ñ–¥–æ–º—Ç–µ –ø—Ä–æ –∫—Ä–∏—Ç–∏—á–Ω—ñ, –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∑ —Ä–µ–∞–ª—å–Ω–∏–º –±—ñ–∑–Ω–µ—Å-—ñ–º–ø–∞–∫—Ç–æ–º.** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞—à—ñ 20+ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ—É–≤–∞–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö–Ω—ñ –∞—Ç–∞–∫–∏, –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∞–º –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è –∑–±–æ—Ä—É –≤–∞–∂–ª–∏–≤–∏—Ö –¥–æ–∫–∞–∑—ñ–≤, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –≤–∞—à—É –≤–∞–∂–∫—É –ø—Ä–∞—Ü—é –Ω–∞ –ø–µ—Ä–µ–∫–æ–Ω–ª–∏–≤—ñ –∑–≤—ñ—Ç–∏.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
