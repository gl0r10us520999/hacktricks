# 111/TCP/UDP - Pentesting Portmapper

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Basic Information

**Portmapper** est un service utilis√© pour mapper les ports de services r√©seau aux num√©ros de programme **RPC** (Remote Procedure Call). Il agit comme un composant critique dans les **syst√®mes bas√©s sur Unix**, facilitant l'√©change d'informations entre ces syst√®mes. Le **port** associ√© √† **Portmapper** est fr√©quemment scann√© par les attaquants car il peut r√©v√©ler des informations pr√©cieuses. Ces informations incluent le type de **syst√®me d'exploitation Unix (OS)** en cours d'ex√©cution et des d√©tails sur les services disponibles sur le syst√®me. De plus, **Portmapper** est couramment utilis√© en conjonction avec **NFS (Network File System)**, **NIS (Network Information Service)**, et d'autres **services bas√©s sur RPC** pour g√©rer efficacement les services r√©seau.

**Port par d√©faut :** 111/TCP/UDP, 32771 dans Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## √ânum√©ration
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Parfois, cela ne vous donne aucune information, d'autres fois vous obtiendrez quelque chose comme ceci :

![](<../.gitbook/assets/image (553).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Si vous trouvez le service NFS, alors vous pourrez probablement lister et t√©l√©charger (et peut-√™tre t√©l√©charger) des fichiers :

![](<../.gitbook/assets/image (872).png>)

Lisez [2049 - Pentesting NFS service](nfs-service-pentesting.md) pour en savoir plus sur la fa√ßon de tester ce protocole.

## NIS

Explorer les vuln√©rabilit√©s **NIS** implique un processus en deux √©tapes, commen√ßant par l'identification du service `ypbind`. La pierre angulaire de cette exploration est de d√©couvrir le **nom de domaine NIS**, sans lequel les progr√®s sont arr√™t√©s.

![](<../.gitbook/assets/image (859).png>)

Le voyage d'exploration commence par l'installation des paquets n√©cessaires (`apt-get install nis`). L'√©tape suivante n√©cessite d'utiliser `ypwhich` pour confirmer la pr√©sence du serveur NIS en le pingant avec le nom de domaine et l'IP du serveur, en s'assurant que ces √©l√©ments sont anonymis√©s pour la s√©curit√©.

L'√©tape finale et cruciale implique la commande `ypcat` pour extraire des donn√©es sensibles, en particulier les mots de passe utilisateurs chiffr√©s. Ces hachages, une fois craqu√©s √† l'aide d'outils comme **John the Ripper**, r√©v√®lent des informations sur l'acc√®s au syst√®me et les privil√®ges.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat ‚Äìd <domain-name> ‚Äìh <server-ip> passwd.byname
```
### Fichiers NIF

| **Fichier ma√Ætre** | **Carte(s)**                | **Remarques**                     |
| ------------------ | --------------------------- | --------------------------------- |
| /etc/hosts         | hosts.byname, hosts.byaddr  | Contient les noms d'h√¥tes et les d√©tails IP |
| /etc/passwd        | passwd.byname, passwd.byuid | Fichier de mots de passe des utilisateurs NIS |
| /etc/group         | group.byname, group.bygid   | Fichier de groupe NIS            |
| /usr/lib/aliases   | mail.aliases                | D√©tails des alias de messagerie   |

## Utilisateurs RPC

Si vous trouvez le service **rusersd** list√© comme ceci :

![](<../.gitbook/assets/image (1041).png>)

Vous pourriez √©num√©rer les utilisateurs de la machine. Pour apprendre comment, lisez [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Contourner le port filtr√© du portmapper

Lors de la r√©alisation d'un **scan nmap** et de la d√©couverte de ports NFS ouverts avec le port 111 √©tant filtr√©, l'exploitation directe de ces ports n'est pas r√©alisable. Cependant, en **simulant un service portmapper localement et en cr√©ant un tunnel depuis votre machine** vers la cible, l'exploitation devient possible en utilisant des outils standards. Cette technique permet de contourner l'√©tat filtr√© du port 111, permettant ainsi l'acc√®s aux services NFS. Pour des conseils d√©taill√©s sur cette m√©thode, r√©f√©rez-vous √† l'article disponible √† [ce lien](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).

## Shodan

* `Portmap`

## Laboratoires pour pratiquer

* Pratiquez ces techniques dans la [**machine Irked HTB**](https://app.hackthebox.com/machines/Irked).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Commandes automatiques HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
{% hint style="success" %}
Apprenez et pratiquez le hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team AWS (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Formation Expert Red Team GCP (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenir HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
{% endhint %}
