# 111/TCP/UDP - Pentesting Portmapper

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Basic Information

**Portmapper** рдПрдХ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рдкреЛрд░реНрдЯ рдХреЛ **RPC** (Remote Procedure Call) рдкреНрд░реЛрдЧреНрд░рд╛рдо рдирдВрдмрд░реЛрдВ рд╕реЗ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред рдпрд╣ **Unix-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо** рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреА рд╣реИ, рдЬреЛ рдЗрди рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдмреАрдЪ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддреА рд╣реИред **Portmapper** рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд **port** рдЕрдХреНрд╕рд░ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕реНрдХреИрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рдЪрд▓ рд░рд╣реЗ **Unix Operating System (OS)** рдХрд╛ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, **Portmapper** рдЖрдорддреМрд░ рдкрд░ **NFS (Network File System)**, **NIS (Network Information Service)**, рдФрд░ рдЕрдиреНрдп **RPC-рдЖрдзрд╛рд░рд┐рдд рд╕реЗрд╡рд╛рдУрдВ** рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**Default port:** 111/TCP/UDP, 32771 in Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## рдЧрдгрдирд╛
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Sometimes it doesn't give you any information, in other occasions you will get something like this:

![](<../.gitbook/assets/image (553).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

рдпрджрд┐ рдЖрдк рд╕реЗрд╡рд╛ NFS рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рд╢рд╛рдпрдж рдЖрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдФрд░ рдбрд╛рдЙрдирд▓реЛрдб (рдФрд░ рд╢рд╛рдпрдж рдЕрдкрд▓реЛрдб) рдХрд░ рд╕рдХреЗрдВрдЧреЗ:

![](<../.gitbook/assets/image (872).png>)

Read[ 2049 - Pentesting NFS service](nfs-service-pentesting.md) to learn more about how to test this protocol.

## NIS

**NIS** рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдПрдХ рджреЛ-рдЪрд░рдгреАрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИ, рдЬреЛ рд╕реЗрд╡рд╛ `ypbind` рдХреА рдкрд╣рдЪрд╛рди рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред рдЗрд╕ рдЦреЛрдЬ рдХрд╛ рдЖрдзрд╛рд░ **NIS рдбреЛрдореЗрди рдирд╛рдо** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рдЧрддрд┐ рд░реБрдХ рдЬрд╛рддреА рд╣реИред

![](<../.gitbook/assets/image (859).png>)

рдЦреЛрдЬ рдпрд╛рддреНрд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди (`apt-get install nis`) рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред рдЕрдЧрд▓рд╛ рдХрджрдо `ypwhich` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рдбреЛрдореЗрди рдирд╛рдо рдФрд░ рд╕рд░реНрд╡рд░ IP рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдкрд┐рдВрдЧ рдХрд░рдХреЗ NIS рд╕рд░реНрд╡рд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреА рдЬрд╛ рд╕рдХреЗ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдпреЗ рддрддреНрд╡ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдЧреБрдордирд╛рдо рд╣реИрдВред

рдЕрдВрддрд┐рдо рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрджрдо `ypcat` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓реЗ рдЬрд╛ рд╕рдХреЗрдВред рдпреЗ рд╣реИрд╢, рдЬреИрд╕реЗ **John the Ripper** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд░реИрдХ рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рд╕рд┐рд╕реНрдЯрдо рдкрд╣реБрдВрдЪ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВред
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat тАУd <domain-name> тАУh <server-ip> passwd.byname
```
### NIF рдлрд╝рд╛рдЗрд▓реЗрдВ

| **рдорд╛рд╕реНрдЯрд░ рдлрд╝рд╛рдЗрд▓**  | **рдореИрдк(рд╕)**                  | **рдиреЛрдЯреНрд╕**                         |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдЖрдИрдкреА рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ |
| /etc/passwd      | passwd.byname, passwd.byuid | NIS рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдлрд╝рд╛рдЗрд▓     |
| /etc/group       | group.byname, group.bygid   | NIS рд╕рдореВрд╣ рдлрд╝рд╛рдЗрд▓                   |
| /usr/lib/aliases | mail.aliases                | рдореЗрд▓ рдЙрдкрдирд╛рдо рд╡рд┐рд╡рд░рдг                  |

## RPC рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛

рдпрджрд┐ рдЖрдк **rusersd** рд╕реЗрд╡рд╛ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реВрдЪреАрдмрджреНрдз рдкрд╛рддреЗ рд╣реИрдВ:

![](<../.gitbook/assets/image (1041).png>)

рддреЛ рдЖрдк рдмреЙрдХреНрд╕ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдкрдврд╝реЗрдВ [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЧрдП рдкреЛрд░реНрдЯрдореИрдкрд░ рдкреЛрд░реНрдЯ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ

рдЬрдм рдЖрдк **nmap рд╕реНрдХреИрди** рдХрд░ рд░рд╣реЗ рд╣реЛрдВ рдФрд░ рдкреЛрд░реНрдЯ 111 рдХреЗ рд╕рд╛рде рдЦреБрд▓реЗ NFS рдкреЛрд░реНрдЯ рдЦреЛрдЬреЗрдВ рдЬреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рддреЛ рдЗрди рдкреЛрд░реНрдЯреЛрдВ рдХрд╛ рдкреНрд░рддреНрдпрдХреНрд╖ рд╢реЛрд╖рдг рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, **рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдПрдХ рдкреЛрд░реНрдЯрдореИрдкрд░ рд╕реЗрд╡рд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдХреЗ рдФрд░ рдЕрдкрдиреЗ рдорд╢реАрди рд╕реЗ рд▓рдХреНрд╖реНрдп рддрдХ рдПрдХ рд╕реБрд░рдВрдЧ рдмрдирд╛рдХрд░**, рд╢реЛрд╖рдг рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдкреЛрд░реНрдЯ 111 рдХреА рдлрд╝рд┐рд▓реНрдЯрд░ рдХреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ NFS рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдВрднрд╡ рд╣реЛрддреА рд╣реИред рдЗрд╕ рд╡рд┐рдзрд┐ рдкрд░ рд╡рд┐рд╕реНрддреГрдд рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП, [рдЗрд╕ рд▓рд┐рдВрдХ](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc) рдкрд░ рдЙрдкрд▓рдмреНрдз рд▓реЗрдЦ рджреЗрдЦреЗрдВред

## Shodan

* `Portmap`

## рдЕрднреНрдпрд╛рд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧрд╢рд╛рд▓рд╛рдПрдБ

* рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ [**Irked HTB рдорд╢реАрди**](https://app.hackthebox.com/machines/Irked).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HackTricks рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЖрджреЗрд╢
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **рд╣рдорд╛рд░реЗ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **рд╣рдореЗрдВ** **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
