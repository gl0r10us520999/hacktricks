# 5671,5672 - Pentesting AMQP

{% hint style="success" %}
Leer & oefen AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Leer & oefen GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Kyk na die [**subskripsie planne**](https://github.com/sponsors/carlospolop)!
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel hacking truuks deur PRs in te dien na die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Van [cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html):

> **RabbitMQ** is 'n **boodskap-ry sagteware** wat ook bekend staan as 'n _boodskap broker_ of _ry bestuurder._ Eenvoudig gestel; dit is sagteware waar rye gedefinieer word, waaraan toepassings koppel om 'n boodskap of boodskappe oor te dra.\
> 'n **Boodskap kan enige soort inligting insluit**. Dit kan byvoorbeeld inligting bevat oor 'n proses of taak wat op 'n ander toepassing (wat selfs op 'n ander bediener kan wees) moet begin, of dit kan net 'n eenvoudige teksboodskap wees. Die ry-bestuurder sagteware stoor die boodskappe totdat 'n ontvangende toepassing koppel en 'n boodskap van die ry neem. Die ontvangende toepassing verwerk dan die boodskap.\
Definisie van .

**Standaard poort**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## Opname

### Handmatig
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### Outomaties
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

* [**AMQP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## Ander RabbitMQ-poorte

In [https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) kan jy vind dat **rabbitmq verskeie poorte gebruik**:

* **1883, 8883**: ([MQTT-klante](http://mqtt.org) sonder en met TLS, indien die [MQTT-inprop](https://www.rabbitmq.com/mqtt.html) geaktiveer is. [**Leer meer oor hoe om MQTT hier te pentest**](1883-pentesting-mqtt-mosquitto.md).
* **4369: epmd**, 'n peer ontdekking diens wat deur RabbitMQ-knope en CLI-gereedskap gebruik word. [**Leer meer oor hoe om hierdie diens hier te pentest**](4369-pentesting-erlang-port-mapper-daemon-epmd.md).
* **5672, 5671**: gebruik deur AMQP 0-9-1 en 1.0 klante sonder en met TLS
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html) klante, [bestuurs UI](https://www.rabbitmq.com/management.html) en [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html) (slegs indien die [bestuurs-inprop](https://www.rabbitmq.com/management.html) geaktiveer is). [**Leer meer oor hoe om hierdie diens hier te pentest**](15672-pentesting-rabbitmq-management.md).
* 15674: STOMP-over-WebSockets klante (slegs indien die [Web STOMP-inprop](https://www.rabbitmq.com/web-stomp.html) geaktiveer is)
* 15675: MQTT-over-WebSockets klante (slegs indien die [Web MQTT-inprop](https://www.rabbitmq.com/web-mqtt.html) geaktiveer is)
* 15692: Prometheus-metrieke (slegs indien die [Prometheus-inprop](https://www.rabbitmq.com/prometheus.html) geaktiveer is)
* 25672: gebruik vir inter-knoop en CLI-gereedskap kommunikasie (Erlang verspreidingsbedienerpoort) en word toegeken uit 'n dinamiese reeks (beperk tot 'n enkele poort per standaard, bereken as AMQP-poort + 20000). Tensy eksterne verbindings op hierdie poorte werklik nodig is (bv. die kluster gebruik [federasie](https://www.rabbitmq.com/federation.html) of CLI-gereedskap word op masjiene buite die subnet gebruik), moet hierdie poorte nie publiek blootgestel word nie. Sien [netwerk gids](https://www.rabbitmq.com/networking.html) vir besonderhede. **Slegs 9 van hierdie poorte is op die internet geopen**.
* 35672-35682: gebruik deur CLI-gereedskap (Erlang verspreidingsklantpoorte) vir kommunikasie met knope en word toegeken uit 'n dinamiese reeks (bereken as bediener verspreidingspoort + 10000 deur bediener verspreidingspoort + 10010). Sien [netwerk gids](https://www.rabbitmq.com/networking.html) vir besonderhede.
* 61613, 61614: [STOMP-klante](https://stomp.github.io/stomp-specification-1.2.html) sonder en met TLS (slegs indien die [STOMP-inprop](https://www.rabbitmq.com/stomp.html) geaktiveer is). Minder as 10 toestelle met hierdie poort oop en meestal UDP vir DHT-knope.

## Shodan

* `AMQP`

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
