# 5671,5672 - Pentesting AMQP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

From [cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html):

> **RabbitMQ** рдПрдХ **рд╕рдВрджреЗрд╢-рд▓рд╛рдЗрди рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░** рд╣реИ рдЬрд┐рд╕реЗ _рд╕рдВрджреЗрд╢ рдмреНрд░реЛрдХрд░_ рдпрд╛ _рдХреНрдпреВ рдкреНрд░рдмрдВрдзрдХ_ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рд░рд▓ рд╢рдмреНрджреЛрдВ рдореЗрдВ; рдпрд╣ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╣реИ рдЬрд╣рд╛рдБ рдХрддрд╛рд░реЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЬрд┐рдирд╕реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
> рдПрдХ **рд╕рдВрджреЗрд╢ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕рдореЗрдВ рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдпрд╛ рдХрд╛рд░реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ (рдЬреЛ рдХрд┐ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рд░реНрд╡рд░ рдкрд░ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ) рдкрд░ рд╢реБрд░реВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдпрд╛ рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдкрд╛рда рд╕рдВрджреЗрд╢ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдХреНрдпреВ-рдкреНрд░рдмрдВрдзрдХ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рддрдм рддрдХ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдПрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рдФрд░ рдХрддрд╛рд░ рд╕реЗ рдПрдХ рд╕рдВрджреЗрд╢ рдирд╣реАрдВ рд▓реЗрддрд╛ред рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдлрд┐рд░ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИред\
Definition from .

**Default port**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## Enumeration

### Manual
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

* [**AMQP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## рдЕрдиреНрдп RabbitMQ рдкреЛрд░реНрдЯ

[https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) рдкрд░ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **rabbitmq рдХрдИ рдкреЛрд░реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ**:

* **1883, 8883**: ([MQTT рдХреНрд▓рд╛рдЗрдВрдЯ](http://mqtt.org) рдмрд┐рдирд╛ рдФрд░ TLS рдХреЗ рд╕рд╛рде, рдпрджрд┐ [MQTT рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/mqtt.html) рд╕рдХреНрд╖рдо рд╣реИред [**рдпрд╣рд╛рдВ MQTT рдХрд╛ pentest рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ**](1883-pentesting-mqtt-mosquitto.md)ред
* **4369: epmd**, рдПрдХ рдкреАрдпрд░ рдбрд┐рд╕реНрдХрд╡рд░реА рд╕реЗрд╡рд╛ рдЬреЛ RabbitMQ рдиреЛрдбреНрд╕ рдФрд░ CLI рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред [**рдпрд╣рд╛рдВ рдЗрд╕ рд╕реЗрд╡рд╛ рдХрд╛ pentest рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ**](4369-pentesting-erlang-port-mapper-daemon-epmd.md)ред
* **5672, 5671**: AMQP 0-9-1 рдФрд░ 1.0 рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрд┐рдирд╛ рдФрд░ TLS рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html) рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕, [рдкреНрд░рдмрдВрдзрди UI](https://www.rabbitmq.com/management.html) рдФрд░ [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html) (рдХреЗрд╡рд▓ рдпрджрд┐ [рдкреНрд░рдмрдВрдзрди рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/management.html) рд╕рдХреНрд╖рдо рд╣реИ)ред [**рдпрд╣рд╛рдВ рдЗрд╕ рд╕реЗрд╡рд╛ рдХрд╛ pentest рдХреИрд╕реЗ рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ**](15672-pentesting-rabbitmq-management.md)ред
* 15674: STOMP-over-WebSockets рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ (рдХреЗрд╡рд▓ рдпрджрд┐ [Web STOMP рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/web-stomp.html) рд╕рдХреНрд╖рдо рд╣реИ)
* 15675: MQTT-over-WebSockets рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ (рдХреЗрд╡рд▓ рдпрджрд┐ [Web MQTT рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/web-mqtt.html) рд╕рдХреНрд╖рдо рд╣реИ)
* 15692: Prometheus рдореЗрдЯреНрд░рд┐рдХреНрд╕ (рдХреЗрд╡рд▓ рдпрджрд┐ [Prometheus рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/prometheus.html) рд╕рдХреНрд╖рдо рд╣реИ)
* 25672: рдЗрдВрдЯрд░-рдиреЛрдб рдФрд░ CLI рдЯреВрд▓реНрд╕ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (Erlang рд╡рд┐рддрд░рдг рд╕рд░реНрд╡рд░ рдкреЛрд░реНрдЯ) рдФрд░ рдЗрд╕реЗ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реЗрдВрдЬ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдПрдХрд▓ рдкреЛрд░реНрдЯ рддрдХ рд╕реАрдорд┐рдд, AMQP рдкреЛрд░реНрдЯ + 20000 рдХреЗ рд░реВрдк рдореЗрдВ рдЧрдгрдирд╛ рдХреА рдЧрдИ)ред рдЬрдм рддрдХ рдЗрди рдкреЛрд░реНрдЯреНрд╕ рдкрд░ рдмрд╛рд╣рд░реА рдХрдиреЗрдХреНрд╢рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИрдВ (рдЬреИрд╕реЗ, рдХреНрд▓рд╕реНрдЯрд░ [рдлреЗрдбрд░реЗрд╢рди](https://www.rabbitmq.com/federation.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ CLI рдЯреВрд▓реНрд╕ рдЙрдк-рдиреЗрдЯ рд╕реЗ рдмрд╛рд╣рд░ рдорд╢реАрдиреЛрдВ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ), рдЗрди рдкреЛрд░реНрдЯреНрд╕ рдХреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдЬрд╛рдЧрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдЧрд╛рдЗрдб](https://www.rabbitmq.com/networking.html) рджреЗрдЦреЗрдВред **рдЗрдирдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ 9 рдкреЛрд░реНрдЯ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЦреБрд▓реЗ рд╣реИрдВ**ред
* 35672-35682: CLI рдЯреВрд▓реНрд╕ (Erlang рд╡рд┐рддрд░рдг рдХреНрд▓рд╛рдЗрдВрдЯ рдкреЛрд░реНрдЯреНрд╕) рджреНрд╡рд╛рд░рд╛ рдиреЛрдбреНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реЗрдВрдЬ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рд╕рд░реНрд╡рд░ рд╡рд┐рддрд░рдг рдкреЛрд░реНрдЯ + 10000 рд╕реЗ рд▓реЗрдХрд░ рд╕рд░реНрд╡рд░ рд╡рд┐рддрд░рдг рдкреЛрд░реНрдЯ + 10010 рддрдХ рдЧрдгрдирд╛ рдХреА рдЧрдИ)ред рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдЧрд╛рдЗрдб](https://www.rabbitmq.com/networking.html) рджреЗрдЦреЗрдВред
* 61613, 61614: [STOMP рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕](https://stomp.github.io/stomp-specification-1.2.html) рдмрд┐рдирд╛ рдФрд░ TLS рдХреЗ рд╕рд╛рде (рдХреЗрд╡рд▓ рдпрджрд┐ [STOMP рдкреНрд▓рдЧрдЗрди](https://www.rabbitmq.com/stomp.html) рд╕рдХреНрд╖рдо рд╣реИ)ред рдЗрд╕ рдкреЛрд░реНрдЯ рдХреЗ рд╕рд╛рде 10 рд╕реЗ рдХрдо рдЙрдкрдХрд░рдг рдЦреБрд▓реЗ рд╣реИрдВ рдФрд░ рдЬреНрдпрд╛рджрд╛рддрд░ DHT рдиреЛрдбреНрд╕ рдХреЗ рд▓рд┐рдП UDP рд╣реИред

## Shodan

* `AMQP`

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
