# 4786 - Cisco Smart Install

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Informaci√≥n B√°sica

**Cisco Smart Install** es un dise√±o de Cisco para automatizar la configuraci√≥n inicial y la carga de una imagen del sistema operativo para nuevo hardware de Cisco. **Por defecto, Cisco Smart Install est√° activo en el hardware de Cisco y utiliza el protocolo de capa de transporte, TCP, con el n√∫mero de puerto 4786.**

**Puerto por defecto:** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Smart Install Exploitation Tool**

**En 2018, se encontr√≥ una vulnerabilidad cr√≠tica, CVE-2018‚Äì0171, en este protocolo. El nivel de amenaza es 9.8 en la escala CVSS.**

**Un paquete especialmente dise√±ado enviado al puerto TCP/4786, donde Cisco Smart Install est√° activo, provoca un desbordamiento de b√∫fer, permitiendo a un atacante:**

* reiniciar forzosamente el dispositivo
* llamar a RCE
* robar configuraciones de equipos de red.

**El** [**SIET**](https://github.com/frostbits-security/SIET) **(Smart Install Exploitation Tool)** fue desarrollado para explotar esta vulnerabilidad, permite abusar de Cisco Smart Install. En este art√≠culo te mostrar√© c√≥mo puedes leer un archivo de configuraci√≥n de hardware de red leg√≠timo. La configuraci√≥n de exfiltraci√≥n puede ser valiosa para un pentester porque aprender√° sobre las caracter√≠sticas √∫nicas de la red. Y esto facilitar√° la vida y permitir√° encontrar nuevos vectores para un ataque.

**El dispositivo objetivo ser√° un switch Cisco Catalyst 2960 "en vivo". Las im√°genes virtuales no tienen Cisco Smart Install, por lo que solo puedes practicar en el hardware real.**

La direcci√≥n del switch objetivo es **10.10.100.10 y CSI est√° activo.** Carga SIET y comienza el ataque. **El argumento -g** significa exfiltraci√≥n de la configuraci√≥n del dispositivo, **el argumento -i** te permite establecer la direcci√≥n IP del objetivo vulnerable.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../.gitbook/assets/image (773).png" alt=""><figcaption></figcaption></figure>

La configuraci√≥n del switch **10.10.100.10** estar√° en la carpeta **tftp/**

<figure><img src="../.gitbook/assets/image (1116).png" alt=""><figcaption></figcaption></figure>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
