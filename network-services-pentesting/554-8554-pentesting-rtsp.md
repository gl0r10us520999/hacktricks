# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informa√ß√µes B√°sicas

De [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> O **Protocolo de Streaming em Tempo Real** (**RTSP**) √© um protocolo de controle de rede projetado para uso em sistemas de entretenimento e comunica√ß√µes para controlar servidores de m√≠dia em streaming. O protocolo √© usado para estabelecer e controlar sess√µes de m√≠dia entre pontos finais. Clientes de servidores de m√≠dia emitem comandos no estilo VHS, como reproduzir, gravar e pausar, para facilitar o controle em tempo real da m√≠dia transmitida do servidor para um cliente (V√≠deo Sob Demanda) ou de um cliente para o servidor (Grava√ß√£o de Voz).
>
> A transmiss√£o de dados de streaming em si n√£o √© uma tarefa do RTSP. A maioria dos servidores RTSP usa o Protocolo de Transporte em Tempo Real (RTP) em conjunto com o Protocolo de Controle em Tempo Real (RTCP) para entrega de fluxo de m√≠dia. No entanto, alguns fornecedores implementam protocolos de transporte propriet√°rios. O software do servidor RTSP da RealNetworks, por exemplo, tamb√©m usou o Transporte de Dados Real Propriet√°rio (RDT) da RealNetworks.

**Portas padr√£o:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Detalhes Chave

**RTSP** √© semelhante ao HTTP, mas projetado especificamente para streaming de m√≠dia. Est√° definido em uma especifica√ß√£o simples que pode ser encontrada aqui:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

Os dispositivos podem permitir acesso **n√£o autenticado** ou **autenticado**. Para verificar, uma solicita√ß√£o "DESCRIBE" √© enviada. Um exemplo b√°sico √© mostrado abaixo:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

Lembre-se, a formata√ß√£o correta inclui um duplo "\r\n" para uma resposta consistente. Uma resposta "200 OK" indica **acesso n√£o autenticado**, enquanto "401 Unauthorized" sinaliza a necessidade de autentica√ß√£o, revelando se a autentica√ß√£o **Basic** ou **Digest** √© necess√°ria.

Para **autentica√ß√£o Basic**, voc√™ codifica o nome de usu√°rio e a senha em base64 e os inclui na solicita√ß√£o assim:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Este exemplo usa "admin" e "1234" para as credenciais. Aqui est√° um **script Python** para enviar tal solicita√ß√£o:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**A autentica√ß√£o b√°sica** √© mais simples e preferida. **A autentica√ß√£o Digest** requer um manuseio cuidadoso dos detalhes de autentica√ß√£o fornecidos na resposta "401 Unauthorized".

Esta vis√£o geral simplifica o processo de acesso a streams RTSP, focando na **autentica√ß√£o b√°sica** por sua simplicidade e praticidade em tentativas iniciais.

## Enumera√ß√£o

Vamos obter informa√ß√µes sobre os m√©todos v√°lidos e URLs suportados e tentar for√ßar o acesso (se necess√°rio) para obter acesso ao conte√∫do.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Outros programas √∫teis**

Para bruteforce: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Detectar hosts RTSP abertos em qualquer alvo acess√≠vel
* Obter suas informa√ß√µes p√∫blicas (nome do host, porta, modelo da c√¢mera, etc.)
* Lan√ßar ataques de dicion√°rio automatizados para obter a rota do stream (por exemplo /live.sdp)
* Lan√ßar ataques de dicion√°rio automatizados para obter o nome de usu√°rio e a senha das c√¢meras
* Gerar miniaturas a partir delas para verificar se os streams s√£o v√°lidos e ter uma pr√©via r√°pida de seu conte√∫do
* Tentar criar um pipeline Gstreamer para verificar se est√£o devidamente codificados
* Imprimir um resumo de todas as informa√ß√µes que o Cameradar conseguiu obter

## Refer√™ncias

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
