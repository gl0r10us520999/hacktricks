# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

–ó [wikipedia](https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol):

> **–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –≤—ñ–¥–µ–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ** (**RTSP**) ‚Äî —Ü–µ –ø—Ä–æ—Ç–æ–∫–æ–ª —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–µ—Ä–µ–∂–µ—é, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–æ–∑–≤–∞–≥ —ñ –∑–≤'—è–∑–∫—É –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é —Å–µ—Ä–≤–µ—Ä—ñ–≤ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –º–µ–¥—ñ–∞. –ü—Ä–æ—Ç–æ–∫–æ–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –º–µ–¥—ñ–∞—Å–µ—Å—ñ–π –º—ñ–∂ –∫—ñ–Ω—Ü–µ–≤–∏–º–∏ —Ç–æ—á–∫–∞–º–∏. –ö–ª—ñ—î–Ω—Ç–∏ –º–µ–¥—ñ–∞—Å–µ—Ä–≤–µ—Ä—ñ–≤ –≤–∏–¥–∞—é—Ç—å –∫–æ–º–∞–Ω–¥–∏ —É —Å—Ç–∏–ª—ñ VHS, —Ç–∞–∫—ñ —è–∫ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è, –∑–∞–ø–∏—Å —ñ –ø–∞—É–∑–∞, –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –º–µ–¥—ñ–∞, —â–æ —Ç—Ä–∞–Ω—Å–ª—é—î—Ç—å—Å—è –∑ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –∫–ª—ñ—î–Ω—Ç–∞ (Video On Demand) –∞–±–æ –∑ –∫–ª—ñ—î–Ω—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (Voice Recording).
>
> –ü–µ—Ä–µ–¥–∞—á–∞ –ø–æ—Ç–æ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —Å–∞–º–∞ –ø–æ —Å–æ–±—ñ –Ω–µ —î –∑–∞–≤–¥–∞–Ω–Ω—è–º RTSP. –ë—ñ–ª—å—à—ñ—Å—Ç—å RTSP-—Å–µ—Ä–≤–µ—Ä—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ü—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–¥–∞—á—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ (RTP) —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –ü—Ä–æ—Ç–æ–∫–æ–ª–æ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ (RTCP) –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –º–µ–¥—ñ–∞–ø–æ—Ç–æ–∫—É. –û–¥–Ω–∞–∫ –¥–µ—è–∫—ñ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å –≤–ª–∞—Å–Ω—ñ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏. –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è RTSP-—Å–µ—Ä–≤–µ—Ä–∞ –≤—ñ–¥ RealNetworks, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç–∞–∫–æ–∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–æ –≤–ª–∞—Å–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª Real Data Transport (RDT) –≤—ñ–¥ RealNetworks.

**Default ports:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## –ö–ª—é—á–æ–≤—ñ –¥–µ—Ç–∞–ª—ñ

**RTSP** –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ HTTP, –∞–ª–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –º–µ–¥—ñ–∞. –í—ñ–Ω –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π —É –ø—Ä–æ—Å—Ç—ñ–π —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —è–∫—É –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ç—É—Ç:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

–ü—Ä–∏—Å—Ç—Ä–æ—ó –º–æ–∂—É—Ç—å –¥–æ–∑–≤–æ–ª—è—Ç–∏ **–Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π** –∞–±–æ **–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π** –¥–æ—Å—Ç—É–ø. –©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Ç "DESCRIBE". –û—Å–Ω–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –Ω–∞–≤–µ–¥–µ–Ω–æ –Ω–∏–∂—á–µ:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2`

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –≤–∫–ª—é—á–∞—î –ø–æ–¥–≤—ñ–π–Ω—É "\r\n" –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –í—ñ–¥–ø–æ–≤—ñ–¥—å "200 OK" –≤–∫–∞–∑—É—î –Ω–∞ **–Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø**, —Ç–æ–¥—ñ —è–∫ "401 Unauthorized" —Å–∏–≥–Ω–∞–ª—ñ–∑—É—î –ø—Ä–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –≤–∫–∞–∑—É—é—á–∏, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ **Basic** –∞–±–æ **Digest authentication**.

–î–ª—è **Basic authentication** –≤–∏ –∫–æ–¥—É—î—Ç–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å —É base64 —ñ –≤–∫–ª—é—á–∞—î—Ç–µ –π–æ–≥–æ –≤ –∑–∞–ø–∏—Ç –æ—Å—å —Ç–∞–∫:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==`

–¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î "admin" —ñ "1234" –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö. –û—Å—å **Python —Å–∫—Ä–∏–ø—Ç** –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Ç–∞–∫–æ–≥–æ –∑–∞–ø–∏—Ç—É:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**–ë–∞–∑–æ–≤–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** —î –ø—Ä–æ—Å—Ç—ñ—à–æ—é —ñ –ø–µ—Ä–µ–≤–∞–∂–Ω–æ—é. **–î–∞–π–¥–∂–µ—Å—Ç-–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** –≤–∏–º–∞–≥–∞—î –æ–±–µ—Ä–µ–∂–Ω–æ–≥–æ –ø–æ–≤–æ–¥–∂–µ–Ω–Ω—è –∑ –¥–µ—Ç–∞–ª—è–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –Ω–∞–¥–∞–Ω–∏–º–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ "401 Unauthorized".

–¶–µ–π –æ–≥–ª—è–¥ —Å–ø—Ä–æ—â—É—î –ø—Ä–æ—Ü–µ—Å –¥–æ—Å—Ç—É–ø—É –¥–æ RTSP –ø–æ—Ç–æ–∫—ñ–≤, –∑–æ—Å–µ—Ä–µ–¥–∂—É—é—á–∏ —É–≤–∞–≥—É –Ω–∞ **–±–∞–∑–æ–≤—ñ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** —á–µ—Ä–µ–∑ —ó—ó –ø—Ä–æ—Å—Ç–æ—Ç—É —Ç–∞ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ—Å—Ç—å —É –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö —Å–ø—Ä–æ–±–∞—Ö.

## –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

–î–∞–≤–∞–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥—ñ–π—Å–Ω—ñ –º–µ—Ç–æ–¥–∏ —Ç–∞ URL-–∞–¥—Ä–µ—Å–∏, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è, —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏ –¥–æ—Å—Ç—É–ø (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ), —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–º—ñ—Å—Ç—É.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-hacking/brute-force.md#rtsp)

### **–Ü–Ω—à—ñ –∫–æ—Ä–∏—Å–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏**

–î–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* –í–∏—è–≤–ª—è—î –≤—ñ–¥–∫—Ä–∏—Ç—ñ RTSP —Ö–æ—Å—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫—ñ–π –¥–æ—Å—Ç—É–ø–Ω—ñ–π —Ü—ñ–ª—ñ
* –û—Ç—Ä–∏–º—É—î —ó—Ö–Ω—é –ø—É–±–ª—ñ—á–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (—ñ–º'—è —Ö–æ—Å—Ç–∞, –ø–æ—Ä—Ç, –º–æ–¥–µ–ª—å –∫–∞–º–µ—Ä–∏ —Ç–æ—â–æ)
* –ó–∞–ø—É—Å–∫–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —Å–ª–æ–≤–Ω–∏–∫–æ–≤—ñ –∞—Ç–∞–∫–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ó—Ö–Ω—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É –ø–æ—Ç–æ–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, /live.sdp)
* –ó–∞–ø—É—Å–∫–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —Å–ª–æ–≤–Ω–∏–∫–æ–≤—ñ –∞—Ç–∞–∫–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—è –∫–∞–º–µ—Ä
* –ì–µ–Ω–µ—Ä—É—î –µ—Å–∫—ñ–∑–∏ –∑ –Ω–∏—Ö, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î –ø–æ—Ç–æ–∫–∏ –¥—ñ–π—Å–Ω–∏–º–∏, —ñ —â–æ–± —à–≤–∏–¥–∫–æ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ó—Ö–Ω—ñ–π –≤–º—ñ—Å—Ç
* –°–ø—Ä–æ–±—É—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–Ω–≤–µ—î—Ä Gstreamer, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤–æ–Ω–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ
* –î—Ä—É–∫—É—î –ø—ñ–¥—Å—É–º–æ–∫ —É—Å—ñ—î—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫—É –º—ñ–≥ –æ—Ç—Ä–∏–º–∞—Ç–∏ Cameradar

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
