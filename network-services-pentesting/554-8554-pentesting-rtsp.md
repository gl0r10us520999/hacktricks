# 554,8554 - Pentesting RTSP

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Informaci√≥n B√°sica

De [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> El **Protocolo de Transmisi√≥n en Tiempo Real** (**RTSP**) es un protocolo de control de red dise√±ado para su uso en sistemas de entretenimiento y comunicaciones para controlar servidores de medios en streaming. El protocolo se utiliza para establecer y controlar sesiones de medios entre puntos finales. Los clientes de los servidores de medios emiten comandos al estilo de VHS, como reproducir, grabar y pausar, para facilitar el control en tiempo real de la transmisi√≥n de medios desde el servidor a un cliente (Video On Demand) o desde un cliente al servidor (Grabaci√≥n de Voz).
>
> La transmisi√≥n de datos en streaming en s√≠ no es una tarea de RTSP. La mayor√≠a de los servidores RTSP utilizan el Protocolo de Transporte en Tiempo Real (RTP) junto con el Protocolo de Control en Tiempo Real (RTCP) para la entrega de flujos de medios. Sin embargo, algunos proveedores implementan protocolos de transporte propietarios. El software del servidor RTSP de RealNetworks, por ejemplo, tambi√©n utiliz√≥ el Transporte de Datos Real (RDT) propietario de RealNetworks.

**Puertos predeterminados:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Detalles Clave

**RTSP** es similar a HTTP pero dise√±ado espec√≠ficamente para la transmisi√≥n de medios. Est√° definido en una especificaci√≥n sencilla que se puede encontrar aqu√≠:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

Los dispositivos pueden permitir acceso **no autenticado** o **autenticado**. Para verificar, se env√≠a una solicitud "DESCRIBE". Un ejemplo b√°sico se muestra a continuaci√≥n:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

Recuerda, el formato correcto incluye un doble "\r\n" para una respuesta consistente. Una respuesta "200 OK" indica **acceso no autenticado**, mientras que "401 Unauthorized" se√±ala la necesidad de autenticaci√≥n, revelando si se requiere **autenticaci√≥n B√°sica** o **Digest**.

Para **autenticaci√≥n B√°sica**, codificas el nombre de usuario y la contrase√±a en base64 e incluyes esto en la solicitud de la siguiente manera:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Este ejemplo utiliza "admin" y "1234" como credenciales. Aqu√≠ hay un **script de Python** para enviar tal solicitud:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**La autenticaci√≥n b√°sica** es m√°s simple y preferida. **La autenticaci√≥n digest** requiere un manejo cuidadoso de los detalles de autenticaci√≥n proporcionados en la respuesta "401 No autorizado".

Esta visi√≥n general simplifica el proceso de acceso a flujos RTSP, centr√°ndose en **la autenticaci√≥n b√°sica** por su simplicidad y practicidad en los intentos iniciales.

## Enumeraci√≥n

Obtenemos informaci√≥n sobre los m√©todos v√°lidos y las URL que son compatibles y tratamos de forzar el acceso (si es necesario) para obtener acceso al contenido.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Fuerza Bruta](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Otros programas √∫tiles**

Para hacer fuerza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Detectar hosts RTSP abiertos en cualquier objetivo accesible
* Obtener su informaci√≥n p√∫blica (nombre de host, puerto, modelo de c√°mara, etc.)
* Lanzar ataques de diccionario automatizados para obtener su ruta de transmisi√≥n (por ejemplo, /live.sdp)
* Lanzar ataques de diccionario automatizados para obtener el nombre de usuario y la contrase√±a de las c√°maras
* Generar miniaturas de ellos para verificar si las transmisiones son v√°lidas y tener una vista previa r√°pida de su contenido
* Intentar crear un pipeline de Gstreamer para verificar si est√°n correctamente codificados
* Imprimir un resumen de toda la informaci√≥n que Cameradar pudo obtener

## Referencias

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

{% hint style="success" %}
Aprende y practica Hacking en AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica Hacking en GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci√≥n**](https://github.com/sponsors/carlospolop)!
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>
{% endhint %}
