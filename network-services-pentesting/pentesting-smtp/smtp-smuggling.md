# SMTP Smuggling

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–¶–µ–π —Ç–∏–ø –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±—É–≤ [**—Å–ø–æ—á–∞—Ç–∫—É –≤–∏—è–≤–ª–µ–Ω–∏–π —É —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/), –¥–µ –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —â–æ –º–æ–∂–ª–∏–≤–æ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –≤ —Ç–æ–º—É, —è–∫ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª SMTP** –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–µ—Ä–µ–ø—Ä–∞–≤–ª—è—Ç–∏ –±—ñ–ª—å—à–µ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤ —É —Ç—ñ–ª—ñ –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–¥–∞–≤–∞—Ç–∏ —Å–µ–±–µ –∑–∞ —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —É—Ä–∞–∂–µ–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É (—Ç–∞–∫–∏—Ö —è–∫ admin@outlook.com), –æ–±—Ö–æ–¥—è—á–∏ —Ç–∞–∫—ñ –∑–∞—Ö–∏—Å—Ç–∏, —è–∫ SPF.

### –ß–æ–º—É

–¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ —Ç–∏–º, —â–æ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ SMTP **–¥–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–º—É –ª–∏—Å—Ç—ñ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º (–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º), —è–∫–∏–π –º–æ–∂–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –¥–∞–Ω—ñ, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—è–º–∏ –≤ –ø–∞—Ä—Å–µ—Ä–∞—Ö, —è–∫—ñ –ø–µ—Ä–µ–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –ª–∏—Å—Ç–∏ –¥–æ –æ—Ç—Ä–∏–º—É–≤–∞—á–∞. –û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ —Ü–∏–º —ñ–ª—é—Å—Ç—Ä–æ–≤–∞–Ω–∏–º –ø—Ä–∏–∫–ª–∞–¥–æ–º –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ—Å—Ç—É:

<figure><img src="../../.gitbook/assets/image (8) (1) (1) (1) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### –Ø–∫

–©–æ–± –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø–æ–≤–∏–Ω–µ–Ω –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–µ—è–∫—ñ –¥–∞–Ω—ñ, —è–∫—ñ **–≤–∏—Ö—ñ–¥–Ω–∏–π SMTP —Å–µ—Ä–≤–µ—Ä –≤–≤–∞–∂–∞—î –ª–∏—à–µ 1 –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–º –ª–∏—Å—Ç–æ–º, –∞–ª–µ –≤—Ö—ñ–¥–Ω–∏–π SMTP —Å–µ—Ä–≤–µ—Ä –≤–≤–∞–∂–∞—î, —â–æ —î –∫—ñ–ª—å–∫–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤**.

–î–æ—Å–ª—ñ–¥–Ω–∏–∫–∏ –≤–∏—è–≤–∏–ª–∏, —â–æ —Ä—ñ–∑–Ω—ñ **–≤—Ö—ñ–¥–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –≤–≤–∞–∂–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –∫—ñ–Ω—Ü–µ–º –¥–∞–Ω–∏—Ö** –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞, —è–∫—ñ –≤–∏—Ö—ñ–¥–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ –Ω–µ –≤–≤–∞–∂–∞—é—Ç—å.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–≤–∏—á–∞–π–Ω–∏–º –∫—ñ–Ω—Ü–µ–º –¥–∞–Ω–∏—Ö —î `\r\n.\r`. –ê–ª–µ —è–∫—â–æ –≤—Ö—ñ–¥–Ω–∏–π SMTP —Å–µ—Ä–≤–µ—Ä —Ç–∞–∫–æ–∂ –ø—ñ–¥—Ç—Ä–∏–º—É—î `\n.`, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—Ç–∏ **—Ü—ñ –¥–∞–Ω—ñ —É —Å–≤—ñ–π –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –ª–∏—Å—Ç —ñ –ø–æ—á–∞—Ç–∏ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ SMTP** –Ω–æ–≤–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤, —â–æ–± –ø–µ—Ä–µ–ø—Ä–∞–≤–∏—Ç–∏ —ó—Ö, —è–∫ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ.

–ó–≤–∏—á–∞–π–Ω–æ, —Ü–µ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ª–∏—à–µ —è–∫—â–æ **–≤–∏—Ö—ñ–¥–Ω–∏–π SMTP —Å–µ—Ä–≤–µ—Ä —Ç–∞–∫–æ–∂ –Ω–µ —Ä–æ–∑–≥–ª—è–¥–∞—î —Ü—ñ –¥–∞–Ω—ñ** —è–∫ –∫—ñ–Ω–µ—Ü—å –¥–∞–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤—ñ–Ω –ø–æ–±–∞—á–∏—Ç—å 2 –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –ª–∏—Å—Ç–∏ –∑–∞–º—ñ—Å—Ç—å –ª–∏—à–µ 1, —Ç–æ–º—É –≤ –∫—ñ–Ω—Ü–µ–≤–æ–º—É –ø—ñ–¥—Å—É–º–∫—É —Ü–µ —î –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—î—é, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Ü—ñ–π –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.

–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó:

* `\n.`
* `\n.\r`

–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ SPF –æ–±—Ö–æ–¥–∏—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ —è–∫—â–æ –≤–∏ –ø–µ—Ä–µ–ø—Ä–∞–≤–ª—è—î—Ç–µ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –ª–∏—Å—Ç –≤—ñ–¥ `admin@outlook.com` –∑ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ –≤—ñ–¥ `user@outlook.com`, **–≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ –≤—Å–µ —â–µ `outlook.com`.**

## **–ü–æ—Å–∏–ª–∞–Ω–Ω—è**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
