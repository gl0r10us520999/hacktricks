# macOS Kernel Extensions & Debugging

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## Basic Information

Kernel extensions (Kexts) **рдкреИрдХреЗрдЬ** рд╣реИрдВ рдЬрд┐рдирдХрд╛ **`.kext`** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реЛрддрд╛ рд╣реИ рдЬреЛ **macOS рдХрд░реНрдиреЗрд▓ рд╕реНрдкреЗрд╕ рдореЗрдВ рд╕реАрдзреЗ рд▓реЛрдб** рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдореБрдЦреНрдп рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

### Requirements

рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдЗрддрдирд╛ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рд╣реИ рдХрд┐ **рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдирд╛ рдЬрдЯрд┐рд▓ рд╣реИ**ред рдпреЗ **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ** рд╣реИрдВ рдЬреЛ рдПрдХ рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрд░реА рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:

* рдЬрдм **рд░рд┐рдХрд╡рд░реА рдореЛрдб рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддреЗ рд╣реИрдВ**, рдХрд░реНрдиреЗрд▓ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**:

<figure><img src="../../../.gitbook/assets/image (327).png" alt=""><figcaption></figcaption></figure>

* рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ **рдХрд░реНрдиреЗрд▓ рдХреЛрдб рд╕рд╛рдЗрдирд┐рдВрдЧ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ** рдХреЗ рд╕рд╛рде **рд╕рд╛рдЗрди** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ **Apple** рджреНрд╡рд╛рд░рд╛ **рдкреНрд░рджрд╛рди** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЬреЛ рдХрдВрдкрдиреА рдФрд░ рдЗрд╕рдХреЗ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреА рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдЧрд╛ред
* рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рднреА **рдиреЛрдЯрд░рд╛рдЗрдЬ** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, Apple рдЗрд╕реЗ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рд╕рдХреЗрдЧрд╛ред
* рдлрд┐рд░, **рд░реВрдЯ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реА **рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд▓реЛрдб** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреИрдХреЗрдЬ рдХреЗ рдЕрдВрджрд░ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ **рд░реВрдЯ** рдХреА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред
* рдЕрдкрд▓реЛрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди, рдкреИрдХреЗрдЬ рдХреЛ **рд╕рдВрд░рдХреНрд╖рд┐рдд рдиреЙрди-рд░реВрдЯ рд╕реНрдерд╛рди** рдореЗрдВ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: `/Library/StagedExtensions` (рдЗрд╕рдХреЗ рд▓рд┐рдП `com.apple.rootless.storage.KernelExtensionManagement` рдЧреНрд░рд╛рдВрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ)ред
* рдЕрдВрдд рдореЗрдВ, рдЬрдм рдЗрд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ [**рдПрдХ рдкреБрд╖реНрдЯрд┐ рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛**](https://developer.apple.com/library/archive/technotes/tn2459/_index.html) рдФрд░, рдпрджрд┐ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛, рддреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЗрд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд░реАрд╕реНрдЯрд╛рд░реНрдЯ** рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

### Loading process

рдХреИрдЯрд╛рд▓рд┐рдирд╛ рдореЗрдВ рдпрд╣ рдЗрд╕ рддрд░рд╣ рдерд╛: рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ **рд╕рддреНрдпрд╛рдкрди** рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рдпреВрдЬрд░рд▓реИрдВрдб** рдореЗрдВ рд╣реЛрддреА рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреЗрд╡рд▓ рд╡реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд┐рдирдХреЗ рдкрд╛рд╕ **`com.apple.private.security.kext-management`** рдЧреНрд░рд╛рдВрдЯ рд╣реИ, рд╡реЗ **рдХрд░реНрдиреЗрд▓ рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**: `kextcache`, `kextload`, `kextutil`, `kextd`, `syspolicyd`

1. **`kextutil`** cli **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рддреНрдпрд╛рдкрди** рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ**
* рдпрд╣ **`kextd`** рд╕реЗ **Mach рд╕реЗрд╡рд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдд рдХрд░реЗрдЧрд╛ред
2. **`kextd`** рдХрдИ рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛, рдЬреИрд╕реЗ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░**
* рдпрд╣ **`syspolicyd`** рд╕реЗ рдмрд╛рдд рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдпрд╣ **рдЬрд╛рдВрдЪ рд╕рдХреЗ** рдХрд┐ рдХреНрдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ **рд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
3. **`syspolicyd`** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рд╕реЗ **рдкреНрд░реЙрдореНрдкреНрдЯ** рдХрд░реЗрдЧрд╛ рдпрджрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкрд╣рд▓реЗ рд▓реЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **`syspolicyd`** рдкрд░рд┐рдгрд╛рдо рдХреЛ **`kextd`** рдХреЛ рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдЧрд╛
4. рдЕрдВрддрддрдГ **`kextd`** рдХрд░реНрдиреЗрд▓ рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдмрддрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛**

рдпрджрд┐ **`kextd`** рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ **`kextutil`** рд╡рд╣реА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Enumeration (loaded kexts)
```bash
# Get loaded kernel extensions
kextstat

# Get dependencies of the kext number 22
kextstat | grep " 22 " | cut -c2-5,50- | cut -d '(' -f1
```
## Kernelcache

{% hint style="danger" %}
рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди `/System/Library/Extensions/` рдореЗрдВ рд╣реЛрдиреЗ рдХреА рдЙрдореНрдореАрдж рд╣реЛрддреА рд╣реИ, рдпрджрд┐ рдЖрдк рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЬрд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ **рдХреЛрдИ рдмрд╛рдЗрдирд░реА рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА**ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг **рдХрд░реНрдиреЗрд▓рдХреИрд╢** рд╣реИ рдФрд░ рдПрдХ `.kext` рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ред
{% endhint %}

**рдХрд░реНрдиреЗрд▓рдХреИрд╢** **XNU рдХрд░реНрдиреЗрд▓ рдХрд╛ рдПрдХ рдкреВрд░реНрд╡-рд╕рдВрдХрд▓рд┐рдд рдФрд░ рдкреВрд░реНрд╡-рд▓рд┐рдВрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдВрд╕реНрдХрд░рдг** рд╣реИ, рд╕рд╛рде рд╣реА рдЖрд╡рд╢реНрдпрдХ рдбрд┐рд╡рд╛рдЗрд╕ **рдбреНрд░рд╛рдЗрд╡рд░** рдФрд░ **рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рднреАред рдЗрд╕реЗ **рд╕рдВрдХреБрдЪрд┐рдд** рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдмреВрдЯ-рдЕрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдореЗрдореЛрд░реА рдореЗрдВ рдЕрдирд╕рдВрдХреБрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрд░реНрдиреЗрд▓рдХреИрд╢ рдПрдХ **рддреЗрдЬрд╝ рдмреВрдЯ рд╕рдордп** рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдХрд░реНрдиреЗрд▓ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХрд╛ рдПрдХ рддреИрдпрд╛рд░-рд╕реЗ-рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╕рдВрд╕реНрдХрд░рдг рдЙрдкрд▓рдмреНрдз рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдмреВрдЯ рд╕рдордп рдкрд░ рдЗрди рдШрдЯрдХреЛрдВ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рд▓реЛрдб рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдмрдЪрдд рд╣реЛрддреА рд╣реИред

### рд╕реНрдерд╛рдиреАрдп рдХрд░реНрдиреЗрд▓рдХреИрд╢

iOS рдореЗрдВ рдпрд╣ **`/System/Library/Caches/com.apple.kernelcaches/kernelcache`** рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ, macOS рдореЗрдВ рдЖрдк рдЗрд╕реЗ рдЗрд╕ рдХрдорд╛рдВрдб рд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: **`find / -name "kernelcache" 2>/dev/null`** \
рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ macOS рдореЗрдВ рдореИрдВрдиреЗ рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд╛рди рдкрд░ рдкрд╛рдпрд╛:

* `/System/Volumes/Preboot/1BAEB4B5-180B-4C46-BD53-51152B7D92DA/boot/DAD35E7BC0CDA79634C20BD1BD80678DFB510B2AAD3D25C1228BB34BCD0A711529D3D571C93E29E1D0C1264750FA043F/System/Library/Caches/com.apple.kernelcaches/kernelcache`

#### IMG4

IMG4 рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рд░реВрдк рдПрдХ рдХрдВрдЯреЗрдирд░ рдкреНрд░рд╛рд░реВрдк рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ Apple рдЕрдкрдиреЗ iOS рдФрд░ macOS рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ **рдлрд░реНрдорд╡реЗрдпрд░** рдШрдЯрдХреЛрдВ (рдЬреИрд╕реЗ **рдХрд░реНрдиреЗрд▓рдХреИрд╢**) рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ **рд╕реНрдЯреЛрд░ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред IMG4 рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдПрдХ рд╣реЗрдбрд░ рдФрд░ рдХрдИ рдЯреИрдЧ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛ рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рд╕рдВрд▓рдЧреНрди рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреЗрд▓реЛрдб (рдЬреИрд╕реЗ рдХрд░реНрдиреЗрд▓ рдпрд╛ рдмреВрдЯрд▓реЛрдбрд░), рдПрдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░, рдФрд░ рдПрдХ рд╕реЗрдЯ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпрд╣ рдкреНрд░рд╛рд░реВрдк рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдлрд░реНрдорд╡реЗрдпрд░ рдШрдЯрдХ рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред

рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдШрдЯрдХреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ:

* **рдкреЗрд▓реЛрдб (IM4P)**:
* рдЕрдХреНрд╕рд░ рд╕рдВрдХреБрдЪрд┐рдд (LZFSE4, LZSS, тАж)
* рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб
* **рдореИрдирд┐рдлреЗрд╕реНрдЯ (IM4M)**:
* рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╢рд╛рдорд┐рд▓ рд╣реИ
* рдЕрддрд┐рд░рд┐рдХреНрдд рдХреБрдВрдЬреА/рдорд╛рди рд╢рдмреНрджрдХреЛрд╢
* **рд░рд┐рд╕реНрдЯреЛрд░ рдЬрд╛рдирдХрд╛рд░реА (IM4R)**:
* APNonce рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ
* рдХреБрдЫ рдЕрдкрдбреЗрдЯ рдХреЗ рдкреБрдирдГ рдЦреЗрд▓рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ
* рд╡реИрдХрд▓реНрдкрд┐рдХ: рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рдирд╣реАрдВ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛

рдХрд░реНрдиреЗрд▓рдХреИрд╢ рдХреЛ рдЕрдирд╕рдВрдХреБрдЪрд┐рдд рдХрд░реЗрдВ:
```bash
# img4tool (https://github.com/tihmstar/img4tool
img4tool -e kernelcache.release.iphone14 -o kernelcache.release.iphone14.e

# pyimg4 (https://github.com/m1stadev/PyIMG4)
pyimg4 im4p extract -i kernelcache.release.iphone14 -o kernelcache.release.iphone14.e
```
### рдбрд╛рдЙрдирд▓реЛрдб&#x20;

* [**KernelDebugKit Github**](https://github.com/dortania/KdkSupportPkg/releases)

[https://github.com/dortania/KdkSupportPkg/releases](https://github.com/dortania/KdkSupportPkg/releases) рдкрд░ рд╕рднреА рдХрд░реНрдиреЗрд▓ рдбрд┐рдмрдЧ рдХрд┐рдЯреНрд╕ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, [Suspicious Package](https://www.mothersruin.com/software/SuspiciousPackage/get.html) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ, **`.kext`** рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред

рд╕рд┐рдВрдмреЙрд▓ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪреЗрдВ:
```bash
nm -a ~/Downloads/Sandbox.kext/Contents/MacOS/Sandbox | wc -l
```
* [**theapplewiki.com**](https://theapplewiki.com/wiki/Firmware/Mac/14.x)**,** [**ipsw.me**](https://ipsw.me/)**,** [**theiphonewiki.com**](https://www.theiphonewiki.com/)

рдХрднреА-рдХрднреА Apple **kernelcache** рдХреЛ **symbols** рдХреЗ рд╕рд╛рде рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЙрди рдкреГрд╖реНрдареЛрдВ рдкрд░ рджрд┐рдП рдЧрдП рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рдХреБрдЫ firmware рдХреЛ symbols рдХреЗ рд╕рд╛рде рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред firmware рдореЗрдВ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде **kernelcache** рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ред

рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **extract** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ `.ipsw` рд╕реЗ `.zip` рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрджрд▓реЗрдВ рдФрд░ рдлрд┐рд░ **unzip** рдХрд░реЗрдВред

Firmware рдХреЛ extract рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдорд┐рд▓реЗрдЧреА рдЬреИрд╕реЗ: **`kernelcache.release.iphone14`**ред рдпрд╣ **IMG4** рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реИ, рдЖрдк рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП:

[**pyimg4**](https://github.com/m1stadev/PyIMG4)**:**

{% code overflow="wrap" %}
```bash
pyimg4 im4p extract -i kernelcache.release.iphone14 -o kernelcache.release.iphone14.e
```
{% endcode %}

[**img4tool**](https://github.com/tihmstar/img4tool)**:**
```bash
img4tool -e kernelcache.release.iphone14 -o kernelcache.release.iphone14.e
```
### Inspecting kernelcache

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ kernelcache рдореЗрдВ рдкреНрд░рддреАрдХ рд╣реИрдВ
```bash
nm -a kernelcache.release.iphone14.e | wc -l
```
рдЗрд╕рдХреЗ рд╕рд╛рде, рд╣рдо рдЕрдм **рд╕рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ **рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ:**
```bash
# List all extensions
kextex -l kernelcache.release.iphone14.e
## Extract com.apple.security.sandbox
kextex -e com.apple.security.sandbox kernelcache.release.iphone14.e

# Extract all
kextex_all kernelcache.release.iphone14.e

# Check the extension for symbols
nm -a binaries/com.apple.security.sandbox | wc -l
```
## рдбрд┐рдмрдЧрд┐рдВрдЧ



## рд╕рдВрджрд░реНрдн

* [https://www.makeuseof.com/how-to-enable-third-party-kernel-extensions-apple-silicon-mac/](https://www.makeuseof.com/how-to-enable-third-party-kernel-extensions-apple-silicon-mac/)
* [https://www.youtube.com/watch?v=hGKOskSiaQo](https://www.youtube.com/watch?v=hGKOskSiaQo)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
