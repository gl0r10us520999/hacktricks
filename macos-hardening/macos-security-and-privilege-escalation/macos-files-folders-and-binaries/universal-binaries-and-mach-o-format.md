# –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ —Ñ–æ—Ä–º–∞—Ç Mach-O

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–®–∫–æ–ª–∞ —Ö–∞–∫—ñ–Ω–≥—É HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–®–∫–æ–ª–∞ —Ö–∞–∫—ñ–Ω–≥—É HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ë—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ Mac OS –∑–∞–∑–≤–∏—á–∞–π –∫–æ–º–ø—ñ–ª—é—é—Ç—å—Å—è —è–∫ **—É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏**. **–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª** –º–æ–∂–µ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä —É –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ**.

–¶—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å **—Å—Ç—Ä—É–∫—Ç—É—Ä—ñ Mach-O**, —è–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑:

* –ó–∞–≥–æ–ª–æ–≤–∫–∞
* –ö–æ–º–∞–Ω–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
* –î–∞–Ω–∏—Ö

![https://alexdremov.me/content/images/2022/10/6XLCD.gif](<../../../.gitbook/assets/image (470).png>)

## Fat Header

–®—É–∫–∞–π—Ç–µ —Ñ–∞–π–ª –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é: `mdfind fat.h | grep -i mach-o | grep -E "fat.h$"`

<pre class="language-c"><code class="lang-c"><strong>#define FAT_MAGIC	0xcafebabe
</strong><strong>#define FAT_CIGAM	0xbebafeca	/* NXSwapLong(FAT_MAGIC) */
</strong>
struct fat_header {
<strong>	uint32_t	magic;		/* FAT_MAGIC or FAT_MAGIC_64 */
</strong><strong>	uint32_t	nfat_arch;	/* number of structs that follow */
</strong>};

struct fat_arch {
cpu_type_t	cputype;	/* cpu specifier (int) */
cpu_subtype_t	cpusubtype;	/* machine specifier (int) */
uint32_t	offset;		/* file offset to this object file */
uint32_t	size;		/* size of this object file */
uint32_t	align;		/* alignment as a power of 2 */
};
</code></pre>

–ó–∞–≥–æ–ª–æ–≤–æ–∫ –º—ñ—Å—Ç–∏—Ç—å **–º–∞–≥—ñ—á–Ω—ñ** –±–∞–π—Ç–∏, –∑–∞ —è–∫–∏–º–∏ —Å–ª—ñ–¥—É—î **–∫—ñ–ª—å–∫—ñ—Å—Ç—å** **–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä**, —è–∫—ñ –º—ñ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª (`nfat_arch`), —ñ –∫–æ–∂–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Ç–∏–º–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `fat_arch`.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

<pre class="language-shell-session"><code class="lang-shell-session">% file /bin/ls
/bin/ls: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e:Mach-O 64-bit executable arm64e]
/bin/ls (for architecture x86_64):	Mach-O 64-bit executable x86_64
/bin/ls (for architecture arm64e):	Mach-O 64-bit executable arm64e

% otool -f -v /bin/ls
Fat headers
fat_magic FAT_MAGIC
<strong>nfat_arch 2
</strong><strong>architecture x86_64
</strong>    cputype CPU_TYPE_X86_64
cpusubtype CPU_SUBTYPE_X86_64_ALL
capabilities 0x0
<strong>    offset 16384
</strong><strong>    size 72896
</strong>    align 2^14 (16384)
<strong>architecture arm64e
</strong>    cputype CPU_TYPE_ARM64
cpusubtype CPU_SUBTYPE_ARM64E
capabilities PTR_AUTH_VERSION USERSPACE 0
<strong>    offset 98304
</strong><strong>    size 88816
</strong>    align 2^14 (16384)
</code></pre>

–∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [Mach-O View](https://sourceforge.net/projects/machoview/):

<figure><img src="../../../.gitbook/assets/image (1094).png" alt=""><figcaption></figcaption></figure>

–Ø–∫ –≤–∏, –º–æ–∂–ª–∏–≤–æ, –º–∏—Å–ª–∏—Ç–µ, –∑–∞–∑–≤–∏—á–∞–π —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –¥–ª—è 2 –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä, **–ø–æ–¥–≤–æ—é—î —Ä–æ–∑–º—ñ—Ä** —Ç–æ–≥–æ, —â–æ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ –ª–∏—à–µ –¥–ª—è 1 –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏.

## **–ó–∞–≥–æ–ª–æ–≤–æ–∫ Mach-O**

–ó–∞–≥–æ–ª–æ–≤–æ–∫ –º—ñ—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ–∞–π–ª, —Ç–∞–∫—É —è–∫ –º–∞–≥—ñ—á–Ω—ñ –±–∞–π—Ç–∏ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –π–æ–≥–æ —è–∫ —Ñ–∞–π–ª—É Mach-O —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ü—ñ–ª—å–æ–≤—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é: `mdfind loader.h | grep -i mach-o | grep -E "loader.h$"`
```c
#define	MH_MAGIC	0xfeedface	/* the mach magic number */
#define MH_CIGAM	0xcefaedfe	/* NXSwapInt(MH_MAGIC) */
struct mach_header {
uint32_t	magic;		/* mach magic number identifier */
cpu_type_t	cputype;	/* cpu specifier (e.g. I386) */
cpu_subtype_t	cpusubtype;	/* machine specifier */
uint32_t	filetype;	/* type of file (usage and alignment for the file) */
uint32_t	ncmds;		/* number of load commands */
uint32_t	sizeofcmds;	/* the size of all the load commands */
uint32_t	flags;		/* flags */
};

#define MH_MAGIC_64 0xfeedfacf /* the 64-bit mach magic number */
#define MH_CIGAM_64 0xcffaedfe /* NXSwapInt(MH_MAGIC_64) */
struct mach_header_64 {
uint32_t	magic;		/* mach magic number identifier */
int32_t		cputype;	/* cpu specifier */
int32_t		cpusubtype;	/* machine specifier */
uint32_t	filetype;	/* type of file */
uint32_t	ncmds;		/* number of load commands */
uint32_t	sizeofcmds;	/* the size of all the load commands */
uint32_t	flags;		/* flags */
uint32_t	reserved;	/* reserved */
};
```
### –¢–∏–ø–∏ —Ñ–∞–π–ª—ñ–≤ Mach-O

–Ü—Å–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ —Ñ–∞–π–ª—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —ó—Ö –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ [**–≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ç—É—Ç**](https://opensource.apple.com/source/xnu/xnu-2050.18.24/EXTERNAL\_HEADERS/mach-o/loader.h). –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à—ñ –∑ –Ω–∏—Ö:

* `MH_OBJECT`: –§–∞–π–ª –æ–±'—î–∫—Ç–∞, —è–∫–∏–π –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–º—ñ—â–∞—Ç–∏ (–ø—Ä–æ–º—ñ–∂–Ω—ñ –ø—Ä–æ–¥—É–∫—Ç–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, —â–µ –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏).
* `MH_EXECUTE`: –í–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏.
* `MH_FVMLIB`: –§–∞–π–ª —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ VM.
* `MH_CORE`: –í—ñ–¥–∫–ª–∞–¥–µ–Ω—ñ –∫–æ–¥–∏
* `MH_PRELOAD`: –ü–µ—Ä–µ–¥–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π —Ñ–∞–π–ª (–±—ñ–ª—å—à–µ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –≤ XNU)
* `MH_DYLIB`: –î–∏–Ω–∞–º—ñ—á–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
* `MH_DYLINKER`: –î–∏–Ω–∞–º—ñ—á–Ω–∏–π –ª—ñ–Ω–∫–µ—Ä
* `MH_BUNDLE`: "–§–∞–π–ª–∏ –ø–ª–∞–≥—ñ–Ω—ñ–≤". –°—Ç–≤–æ—Ä–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é -bundle –≤ gcc —Ç–∞ —è–≤–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `NSBundle` –∞–±–æ `dlopen`.
* `MH_DYSM`: –°—É–ø—É—Ç–Ω—ñ–π —Ñ–∞–π–ª `.dSym` (—Ñ–∞–π–ª –∑ —Å–∏–º–≤–æ–ª–∞–º–∏ –¥–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è).
* `MH_KEXT_BUNDLE`: –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —è–¥—Ä–∞.
```bash
# Checking the mac header of a binary
otool -arch arm64e -hv /bin/ls
Mach header
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64    ARM64          E USR00     EXECUTE    19       1728   NOUNDEFS DYLDLINK TWOLEVEL PIE
```
–ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ [Mach-O View](https://sourceforge.net/projects/machoview/):

<figure><img src="../../../.gitbook/assets/image (1133).png" alt=""><figcaption></figcaption></figure>

## **–ü—Ä–∞–ø–æ—Ä—Ü—ñ Mach-O**

–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —Ç–∞–∫–æ–∂ –≤–∏–∑–Ω–∞—á–∞—î –∫—ñ–ª—å–∫–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ö –ø—Ä–∞–ø–æ—Ä—Ü—ñ–≤ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫:

* `MH_NOUNDEFS`: –ù–µ–º–∞—î –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å (–ø–æ–≤–Ω—ñ—Å—Ç—é –∑–≤'—è–∑–∞–Ω–∏–π)
* `MH_DYLDLINK`: –ü–æ—Å–∏–ª–∞–Ω–Ω—è Dyld
* `MH_PREBOUND`: –î–∏–Ω–∞–º—ñ—á–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–≤'—è–∑–∞–Ω—ñ.
* `MH_SPLIT_SEGS`: –§–∞–π–ª —Ä–æ–∑–¥—ñ–ª—è—î —Å–µ–≥–º–µ–Ω—Ç–∏ r/o —Ç–∞ r/w.
* `MH_WEAK_DEFINES`: –£ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ —î —Å–ª–∞–±–∫—ñ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ —Å–∏–º–≤–æ–ª–∏
* `MH_BINDS_TO_WEAK`: –ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–ª–∞–±–∫—ñ —Å–∏–º–≤–æ–ª–∏
* `MH_ALLOW_STACK_EXECUTION`: –ó—Ä–æ–±–∏—Ç–∏ —Å—Ç–µ–∫ –≤–∏–∫–æ–Ω–∞–≤—á–∏–º
* `MH_NO_REEXPORTED_DYLIBS`: –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥ LC\_REEXPORT
* `MH_PIE`: –í–∏–∫–æ–Ω–∞–≤—á–∏–π —Ñ–∞–π–ª –∑ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –≤—ñ–¥ –ø–æ–ª–æ–∂–µ–Ω–Ω—è –∞–¥—Ä–µ—Å–∏
* `MH_HAS_TLV_DESCRIPTORS`: –Ñ —Ä–æ–∑–¥—ñ–ª –∑—ñ –∑–º—ñ–Ω–Ω–∏–º–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É
* `MH_NO_HEAP_EXECUTION`: –í—ñ–¥—Å—É—Ç–Ω—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∫—É–ø–∏/–¥–∞–Ω–∏—Ö
* `MH_HAS_OBJC`: –£ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ —î —Ä–æ–∑–¥—ñ–ª–∏ oBject-C
* `MH_SIM_SUPPORT`: –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–∞
* `MH_DYLIB_IN_CACHE`: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω–∞ dylibs/frameworks —É —Å–ø—ñ–ª—å–Ω–æ–º—É –∫–µ—à—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫.

## **–ö–æ–º–∞–Ω–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Mach-O**

–¢—É—Ç –≤–∫–∞–∑–∞–Ω–æ **—Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É –≤ –ø–∞–º'—è—Ç—ñ**, –¥–µ—Ç–∞–ª—ñ–∑—É—é—á–∏ **—Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ —Å–∏–º–≤–æ–ª—ñ–≤**, –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É –ø—Ä–∏ –ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ **—Å–ø—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏**. –ù–∞–¥–∞—é—Ç—å—Å—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á–∞ **(dyld)** —â–æ–¥–æ –ø—Ä–æ—Ü–µ—Å—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É –≤ –ø–∞–º'—è—Ç—å.

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É **load\_command**, –≤–∏–∑–Ω–∞—á–µ–Ω—É –≤ –∑–∞–∑–Ω–∞—á–µ–Ω–æ–º—É **`loader.h`**:
```objectivec
struct load_command {
uint32_t cmd;           /* type of load command */
uint32_t cmdsize;       /* total size of command in bytes */
};
```
–Ü—Å–Ω—É—î –±–ª–∏–∑—å–∫–æ **50 —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∫–æ–º–∞–Ω–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**, —è–∫—ñ —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–æ–±–ª—è—î –ø–æ-—Ä—ñ–∑–Ω–æ–º—É. –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ –∑ –Ω–∏—Ö: `LC_SEGMENT_64`, `LC_LOAD_DYLINKER`, `LC_MAIN`, `LC_LOAD_DYLIB` —Ç–∞ `LC_CODE_SIGNATURE`.

### **LC\_SEGMENT/LC\_SEGMENT\_64**

{% hint style="success" %}
–§–∞–∫—Ç–∏—á–Ω–æ, —Ü–µ–π —Ç–∏–ø –∫–æ–º–∞–Ω–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏–∑–Ω–∞—á–∞—î, **—è–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∏ \_\_TEXT** (–≤–∏–∫–æ–Ω–∞–≤—á–∏–π –∫–æ–¥) **—Ç–∞ \_\_DATA** (–¥–∞–Ω—ñ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É) **–∑–≥—ñ–¥–Ω–æ –∑ –≤–∫–∞–∑–∞–Ω–∏–º–∏ –∑–º—ñ—â–µ–Ω–Ω—è–º–∏ –≤ —Ä–æ–∑–¥—ñ–ª—ñ –î–∞–Ω—ñ** –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É.
{% endhint %}

–¶—ñ –∫–æ–º–∞–Ω–¥–∏ **–≤–∏–∑–Ω–∞—á–∞—é—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∏**, —è–∫—ñ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è** –≤ **–≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–º—É –ø—Ä–æ—Å—Ç–æ—Ä—ñ –ø–∞–º'—è—Ç—ñ** –ø—Ä–æ—Ü–µ—Å—É –ø—ñ–¥ —á–∞—Å –π–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

–Ü—Å–Ω—É—é—Ç—å **—Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏** —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, —Ç–∞–∫—ñ —è–∫ —Å–µ–≥–º–µ–Ω—Ç **\_\_TEXT**, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –≤–∏–∫–æ–Ω–∞–≤—á–∏–π –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–∏, —Ç–∞ —Å–µ–≥–º–µ–Ω—Ç **\_\_DATA**, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ –ø—Ä–æ—Ü–µ—Å–æ–º. –¶—ñ **—Å–µ–≥–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ —Ä–æ–∑–¥—ñ–ª—ñ –¥–∞–Ω–∏—Ö** —Ñ–∞–π–ª—É Mach-O.

**–ö–æ–∂–µ–Ω —Å–µ–≥–º–µ–Ω—Ç** –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–¥—ñ–ª–µ–Ω–∏–π –Ω–∞ –∫—ñ–ª—å–∫–∞ **—Å–µ–∫—Ü—ñ–π**. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ **–∫–æ–º–∞–Ω–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –º—ñ—Å—Ç–∏—Ç—å **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é** –ø—Ä–æ **—Ü—ñ —Å–µ–∫—Ü—ñ—ó** —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—ñ.

–£ –∑–∞–≥–æ–ª–æ–≤–∫—É —Å–ø–æ—á–∞—Ç–∫—É –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ **–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–∞**:

<pre class="language-c"><code class="lang-c">struct segment_command_64 { /* –¥–ª—è 64-–±—ñ—Ç–Ω–∏—Ö –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä */
uint32_t	cmd;		/* LC_SEGMENT_64 */
uint32_t	cmdsize;	/* –≤–∫–ª—é—á–∞—î —Ä–æ–∑–º—ñ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä section_64 */
char		segname[16];	/* –Ω–∞–∑–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ */
uint64_t	vmaddr;		/* –∞–¥—Ä–µ—Å–∞ –ø–∞–º'—è—Ç—ñ —Ü—å–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ */
uint64_t	vmsize;		/* —Ä–æ–∑–º—ñ—Ä –ø–∞–º'—è—Ç—ñ —Ü—å–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ */
uint64_t	fileoff;	/* –∑–º—ñ—â–µ–Ω–Ω—è —Ñ–∞–π–ª—É —Ü—å–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ */
uint64_t	filesize;	/* –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ —Ñ–∞–π–ª—É */
int32_t		maxprot;	/* –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –∑–∞—Ö–∏—Å—Ç VM */
int32_t		initprot;	/* –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç VM */
<strong>	uint32_t	nsects;		/* –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—Ü—ñ–π —É —Å–µ–≥–º–µ–Ω—Ç—ñ */
</strong>	uint32_t	flags;		/* –ø—Ä–∞–ø–æ—Ä—Ü—ñ */
};
</code></pre>

–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞:

<figure><img src="../../../.gitbook/assets/image (1126).png" alt=""><figcaption></figcaption></figure>

–¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∑–Ω–∞—á–∞—î **–∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—Ü—ñ–π, –∑–∞–≥–æ–ª–æ–≤–∫–∏ —è–∫–∏—Ö –∑'—è–≤–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è** –Ω—å–æ–≥–æ:
```c
struct section_64 { /* for 64-bit architectures */
char		sectname[16];	/* name of this section */
char		segname[16];	/* segment this section goes in */
uint64_t	addr;		/* memory address of this section */
uint64_t	size;		/* size in bytes of this section */
uint32_t	offset;		/* file offset of this section */
uint32_t	align;		/* section alignment (power of 2) */
uint32_t	reloff;		/* file offset of relocation entries */
uint32_t	nreloc;		/* number of relocation entries */
uint32_t	flags;		/* flags (section type and attributes)*/
uint32_t	reserved1;	/* reserved (for offset or index) */
uint32_t	reserved2;	/* reserved (for count or sizeof) */
uint32_t	reserved3;	/* reserved */
};
```
–ü—Ä–∏–∫–ª–∞–¥ **–∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ä–æ–∑–¥—ñ–ª—É**:

<figure><img src="../../../.gitbook/assets/image (1108).png" alt=""><figcaption></figcaption></figure>

–Ø–∫—â–æ –≤–∏ **–¥–æ–¥–∞—î—Ç–µ** **–∑–º—ñ—â–µ–Ω–Ω—è —Ä–æ–∑–¥—ñ–ª—É** (0x37DC) + **–∑–º—ñ—â–µ–Ω–Ω—è**, –¥–µ **–ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞**, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É `0x18000` --> `0x37DC + 0x18000 = 0x1B7DC`

<figure><img src="../../../.gitbook/assets/image (701).png" alt=""><figcaption></figcaption></figure>

–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏** –∑ **–∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
otool -lv /bin/ls
```
–°–ø—ñ–ª—å–Ω—ñ —Å–µ–≥–º–µ–Ω—Ç–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ü—ñ—î—é –∫–æ–º–∞–Ω–¥–æ—é:

* **`__PAGEZERO`:** –¶–µ –≤–∫–∞–∑—É—î —è–¥—Ä—É **–≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏** **–∞–¥—Ä–µ—Å—É –Ω—É–ª—å**, —â–æ–± —ó—ó **–Ω–µ –º–æ–∂–Ω–∞ –±—É–ª–æ —á–∏—Ç–∞—Ç–∏, –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –∞–±–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏**. –ó–º—ñ–Ω–Ω—ñ maxprot —Ç–∞ minprot —É —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –Ω–∞ –Ω—É–ª—å, —â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏, —â–æ –Ω–∞ —Ü—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ **–Ω–µ–º–∞—î –ø—Ä–∞–≤ –Ω–∞ —á–∏—Ç–∞–Ω–Ω—è-–∑–∞–ø–∏—Å-–≤–∏–∫–æ–Ω–∞–Ω–Ω—è**.
* –¶–µ –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –≤–∞–∂–ª–∏–≤–µ –¥–ª—è **–ø–æ–º'—è–∫—à–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –Ω—É–ª—å–æ–≤–æ–≥–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞**. –¶–µ —Ç–æ–º—É, —â–æ XNU –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∂–æ—Ä—Å—Ç–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É –Ω—É–ª—å, —è–∫–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ (—Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à–∞) –ø–∞–º'—è—Ç—ñ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (–∫—Ä—ñ–º –≤ i386). –ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –º–æ–∂–µ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ —Ü–∏–º –≤–∏–º–æ–≥–∞–º, —Å—Ç–≤–æ—Ä–∏–≤—à–∏ –Ω–µ–≤–µ–ª–∏–∫–∏–π \_\_PAGEZERO (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `-pagezero_size`) –¥–ª—è –æ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–µ—Ä—à–∏—Ö 4 –∫–± —Ç–∞ –∑—Ä–æ–±–∏–≤—à–∏ —Ä–µ—à—Ç—É –ø–∞–º'—è—Ç—ñ 32-–±—ñ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—é —è–∫ —É —Ä–µ–∂–∏–º—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–∞–∫ —ñ –≤ —Ä–µ–∂–∏–º—ñ —è–¥—Ä–∞.
* **`__TEXT`**: –ú—ñ—Å—Ç–∏—Ç—å **–≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π** **–∫–æ–¥** –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ –Ω–∞ **—á–∏—Ç–∞–Ω–Ω—è** —Ç–∞ **–≤–∏–∫–æ–Ω–∞–Ω–Ω—è** (–±–µ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–∞–ø–∏—Å—É)**.** –ó–∞–≥–∞–ª—å–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏ —Ü—å–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞:
* `__text`: –°–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π –∫–æ–¥
* `__const`: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ñ –¥–∞–Ω—ñ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è)
* `__[c/u/os_log]string`: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ —Ä—è–¥–∫—ñ–≤ C, Unicode –∞–±–æ os logs
* `__stubs` —Ç–∞ `__stubs_helper`: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
* `__unwind_info`: –î–∞–Ω—ñ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —Å—Ç–µ–∫—É.
* –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–µ—Å—å —Ü–µ–π –≤–º—ñ—Å—Ç –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π, –∞–ª–µ —Ç–∞–∫–æ–∂ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —è–∫ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π (—Å—Ç–≤–æ—Ä—é—é—á–∏ –±—ñ–ª—å—à–µ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ä–æ–∑–¥—ñ–ª—ñ–≤, —è–∫—ñ –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —Ü—ñ—î—ó –ø—Ä–∏–≤—ñ–ª–µ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ä–æ–∑–¥—ñ–ª—ñ–≤, –ø—Ä–∏—Å–≤—è—á–µ–Ω–∏—Ö —Ä—è–¥–∫–∞–º).
* **`__DATA`**: –ú—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω—ñ, —è–∫—ñ –º–æ–∂–Ω–∞ **—á–∏—Ç–∞—Ç–∏** —Ç–∞ **–ø–∏—Å–∞—Ç–∏** (–±–µ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è)**.**
* `__got:` –ì–ª–æ–±–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑–º—ñ—â–µ–Ω—å
* `__nl_symbol_ptr`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ —Å–∏–º–≤–æ–ª–∏ Non lazy (bind at load)
* `__la_symbol_ptr`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ —Å–∏–º–≤–æ–ª–∏ Lazy (bind on use)
* `__const`: –ü–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –¥–∞–Ω—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (–Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –Ω—ñ)
* `__cfstring`: –°—Ç—Ä–æ–∫–∏ CoreFoundation
* `__data`: –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ (—è–∫—ñ –±—É–ª–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ)
* `__bss`: –°—Ç–∞—Ç–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ (—è–∫—ñ –Ω–µ –±—É–ª–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ)
* `__objc_*` (\_\_objc\_classlist, \_\_objc\_protolist, —Ç–æ—â–æ): –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º –≤–∏–∫–æ–Ω–∞–Ω–Ω—è Objective-C
* **`__DATA_CONST`**: \_\_DATA.\_\_const –Ω–µ –≥–∞—Ä–∞–Ω—Ç—É—î—Ç—å—Å—è, —â–æ –≤–æ–Ω–æ —î –ø–æ—Å—Ç—ñ–π–Ω–∏–º (–ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å), —Ç–∞–∫ —Å–∞–º–æ —è–∫ —ñ —ñ–Ω—à—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ —Ç–∞ —Ç–∞–±–ª–∏—Ü—è GOT. –¶–µ–π —Ä–æ–∑–¥—ñ–ª —Ä–æ–±–∏—Ç—å `__const`, –¥–µ—è–∫—ñ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ç–æ—Ä–∏ —Ç–∞ —Ç–∞–±–ª–∏—Ü—é GOT (–ø—ñ—Å–ª—è –≤–∏—Ä—ñ—à–µ–Ω–Ω—è) **—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `mprotect`.
* **`__LINKEDIT`**: –ú—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è –ª—ñ–Ω–∫–µ—Ä–∞ (dyld), —Ç–∞–∫—É —è–∫, —Å–∏–º–≤–æ–ª–∏, —Ä—è–¥–∫–∏ —Ç–∞ –∑–∞–ø–∏—Å–∏ —Ç–∞–±–ª–∏—Ü—ñ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è. –¶–µ –∑–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–º—ñ—Å—Ç—É, —è–∫–∏–π –Ω–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∞–Ω—ñ –≤ `__TEXT`, –∞–Ω—ñ –≤ `__DATA`, –∞ –π–æ–≥–æ –≤–º—ñ—Å—Ç –æ–ø–∏—Å–∞–Ω–∏–π –≤ —ñ–Ω—à–∏—Ö –∫–æ–º–∞–Ω–¥–∞—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.
* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è dyld: Rebase, –æ–ø–∫–æ–¥–∏ –¥–ª—è –Ω–µ-–ª—ñ–Ω–∏–≤–æ–≥–æ/–ª—ñ–Ω–∏–≤–æ–≥–æ/—Å–ª–∞–±–∫–æ–≥–æ –∑–≤'—è–∑—É–≤–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –µ–∫—Å–ø–æ—Ä—Ç
* –ü–æ—á–∞—Ç–æ–∫ —Ñ—É–Ω–∫—Ü—ñ–π: –¢–∞–±–ª–∏—Ü—è –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –∞–¥—Ä–µ—Å —Ñ—É–Ω–∫—Ü—ñ–π
* –î–∞–Ω—ñ —É –∫–æ–¥—ñ: –î–∞–Ω—ñ –Ω–∞ –æ—Å—Ç—Ä–æ–≤–∞—Ö –≤ \_\_text
* –¢–∞–±–ª–∏—Ü—è —Å–∏–º–≤–æ–ª—ñ–≤: –°–∏–º–≤–æ–ª–∏ –≤ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ
* –¢–∞–±–ª–∏—Ü—è –Ω–µ–ø—Ä—è–º–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤: –í–∫–∞–∑—ñ–≤–Ω–∏–∫–∏/–∑–∞–≥–ª—É—à–∫–∏ —Å–∏–º–≤–æ–ª—ñ–≤
* –¢–∞–±–ª–∏—Ü—è —Ä—è–¥–∫—ñ–≤
* –ü—ñ–¥–ø–∏—Å –∫–æ–¥—É
* **`__OBJC`**: –ú—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º –≤–∏–∫–æ–Ω–∞–Ω–Ω—è Objective-C. –•–æ—á–∞ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ —Å–µ–≥–º–µ–Ω—Ç—ñ \_\_DATA, –≤ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑–¥—ñ–ª–∞—Ö \_\_objc\_\*.
* **`__RESTRICT`**: –°–µ–≥–º–µ–Ω—Ç –±–µ–∑ –≤–º—ñ—Å—Ç—É –∑ –æ–¥–Ω–∏–º —Ä–æ–∑–¥—ñ–ª–æ–º –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **`__restrict`** (—Ç–∞–∫–æ–∂ –ø–æ—Ä–æ–∂–Ω—ñ–π), —è–∫–∏–π –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É –±—É–¥—É—Ç—å —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏—Å—è –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ DYLD.

–Ø–∫ –º–æ–∂–Ω–∞ –±—É–ª–æ –ø–æ–±–∞—á–∏—Ç–∏ –≤ –∫–æ–¥—ñ, **—Å–µ–≥–º–µ–Ω—Ç–∏ —Ç–∞–∫–æ–∂ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø—Ä–∞–ø–æ—Ä—Ü—ñ** (—Ö–æ—á–∞ –≤–æ–Ω–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥—É–∂–µ —á–∞—Å—Ç–æ):

* `SG_HIGHVM`: –¢—ñ–ª—å–∫–∏ –¥–ª—è —è–¥—Ä–∞ (–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è)
* `SG_FVMLIB`: –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è
* `SG_NORELOC`: –°–µ–≥–º–µ–Ω—Ç –Ω–µ –º–∞—î –ø–µ—Ä–µ—Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è
* `SG_PROTECTED_VERSION_1`: –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Finder –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –≤ —Å–µ–≥–º–µ–Ω—Ç—ñ `__TEXT`.

### **`LC_UNIXTHREAD/LC_MAIN`**

**`LC_MAIN`** –º—ñ—Å—Ç–∏—Ç—å —Ç–æ—á–∫—É –≤—Ö–æ–¥—É –≤ –∞—Ç—Ä–∏–±—É—Ç—ñ **entryoff.** –ü—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **dyld** –ø—Ä–æ—Å—Ç–æ **–¥–æ–¥–∞—î** —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ (–≤ –ø–∞–º'—è—Ç—ñ) **–±–∞–∑–∏ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É**, –∞ –ø–æ—Ç—ñ–º **–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å** –¥–æ —Ü—ñ—î—ó —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø–æ—á–∞—Ç–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É.

**`LC_UNIXTHREAD`** –º—ñ—Å—Ç–∏—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—ñ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ —Ä–µ–≥—ñ—Å—Ç—Ä–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –≥–æ–ª–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É. –¶–µ –≤–∂–µ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ, –∞–ª–µ **`dyld`** –≤—Å–µ —â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –π–æ–≥–æ. –ú–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—ñ–≤, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —Ü–∏–º, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
otool -l /usr/lib/dyld
[...]
Load command 13
cmd LC_UNIXTHREAD
cmdsize 288
flavor ARM_THREAD_STATE64
count ARM_THREAD_STATE64_COUNT
x0  0x0000000000000000 x1  0x0000000000000000 x2  0x0000000000000000
x3  0x0000000000000000 x4  0x0000000000000000 x5  0x0000000000000000
x6  0x0000000000000000 x7  0x0000000000000000 x8  0x0000000000000000
x9  0x0000000000000000 x10 0x0000000000000000 x11 0x0000000000000000
x12 0x0000000000000000 x13 0x0000000000000000 x14 0x0000000000000000
x15 0x0000000000000000 x16 0x0000000000000000 x17 0x0000000000000000
x18 0x0000000000000000 x19 0x0000000000000000 x20 0x0000000000000000
x21 0x0000000000000000 x22 0x0000000000000000 x23 0x0000000000000000
x24 0x0000000000000000 x25 0x0000000000000000 x26 0x0000000000000000
x27 0x0000000000000000 x28 0x0000000000000000  fp 0x0000000000000000
lr 0x0000000000000000 sp  0x0000000000000000  pc 0x0000000000004b70
cpsr 0x00000000

[...]
```
### **`LC_CODE_SIGNATURE`**

–ú—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ **–ø—ñ–¥–ø–∏—Å –∫–æ–¥—É —Ñ–∞–π–ª—É Mach-O**. –í—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ **–∑—Å—É–≤**, —è–∫–∏–π **–≤–∫–∞–∑—É—î** –Ω–∞ **–±–ª–æ–± –ø—ñ–¥–ø–∏—Å—É**. –ó–∞–∑–≤–∏—á–∞–π —Ü–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Å–∞–º–æ–º—É –∫—ñ–Ω—Ü—ñ —Ñ–∞–π–ª—É.\
–û–¥–Ω–∞–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ü–µ–π —Ä–æ–∑–¥—ñ–ª —É [**—Ü—å–æ–º—É –¥–æ–ø–∏—Å—ñ —É –±–ª–æ–∑—ñ**](https://davedelong.com/blog/2018/01/10/reading-your-own-entitlements/) —Ç–∞ —É —Ü—å–æ–º—É [**—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ**](https://gist.github.com/carlospolop/ef26f8eb9fafd4bc22e69e1a32b81da4).

### **`LC_ENCRYPTION_INFO[_64]`**

–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ –∫–æ–¥—É. –û–¥–Ω–∞–∫, –∑–≤—ñ—Å–Ω–æ, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–¥–∞—Ç–Ω–∏–π —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å, –≤—ñ–Ω –∑–º–æ–∂–µ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –ø–∞–º'—è—Ç—å –≤ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ.

### **`LC_LOAD_DYLINKER`**

–ú—ñ—Å—Ç–∏—Ç—å **—à–ª—è—Ö –¥–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –∑–≤'—è–∑—É–≤–∞—á–∞**, —è–∫–∏–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å–ø—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –≤ –∞–¥—Ä–µ—Å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä –ø—Ä–æ—Ü–µ—Å—É. **–ó–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≤–∂–¥–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ `/usr/lib/dyld`**. –í–∞–∂–ª–∏–≤–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ –≤ macOS –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è dylib –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤ **—Ä–µ–∂–∏–º—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, –∞ –Ω–µ –≤ —Ä–µ–∂–∏–º—ñ —è–¥—Ä–∞.

### **`LC_IDENT`**

–ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π, –∞–ª–µ —è–∫—â–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –¥–∞–º–ø—ñ–≤ –ø—Ä–∏ –ø–∞–Ω—ñ—Ü—ñ, —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –¥–∞–º–ø —è–¥—Ä–∞ Mach-O, —ñ –≤–µ—Ä—Å—ñ—è —è–¥—Ä–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤ –∫–æ–º–∞–Ω–¥—ñ `LC_IDENT`.

### **`LC_UUID`**

–í–∏–ø–∞–¥–∫–æ–≤–∏–π UUID. –í—ñ–Ω –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è —á–æ–≥–æ –∑–∞–≤–≥–æ–¥–Ω–æ, –∞–ª–µ XNU –∫–µ—à—É—î –π–æ–≥–æ —Ä–∞–∑–æ–º –∑ —ñ–Ω—à–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –ø—Ä–æ—Ü–µ—Å. –í—ñ–Ω –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π —É –∑–≤—ñ—Ç–∞—Ö –ø—Ä–æ –∞–≤–∞—Ä—ñ—ó.

### **`LC_DYLD_ENVIRONMENT`**

–î–æ–∑–≤–æ–ª—è—î –≤–∫–∞–∑–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–ª—è dyld –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –ø—Ä–æ—Ü–µ—Å—É. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ—Ü–µ—Å—É, —Ç–æ–º—É —Ü—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ –≤ dyld, –ø–æ–±—É–¥–æ–≤–∞–Ω–æ–º—É –∑ `#define SUPPORT_LC_DYLD_ENVIRONMENT` —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –æ–±–º–µ–∂—É—î –æ–±—Ä–æ–±–∫—É –ª–∏—à–µ –∑–º—ñ–Ω–Ω–∏—Ö —É —Ñ–æ—Ä–º—ñ `DYLD_..._PATH`, —â–æ –≤–∫–∞–∑—É—é—Ç—å —à–ª—è—Ö–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

### **`LC_LOAD_DYLIB`**

–¶—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–ø–∏—Å—É—î **–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –¥–∏–Ω–∞–º—ñ—á–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏**, —è–∫–∞ **–≤–∫–∞–∑—É—î** **–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á—É** (dyld) **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –∑–≤'—è–∑–∞—Ç–∏ —Ü—é –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É**. –Ü—Å–Ω—É—î –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è `LC_LOAD_DYLIB` **–¥–ª—è –∫–æ–∂–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏**, —è–∫—É –ø–æ—Ç—Ä–µ–±—É—î –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª Mach-O.

* –¶—è –∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é —Ç–∏–ø—É **`dylib_command`** (—è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É dylib, —â–æ –æ–ø–∏—Å—É—î —Ñ–∞–∫—Ç–∏—á–Ω—É –∑–∞–ª–µ–∂–Ω—É –¥–∏–Ω–∞–º—ñ—á–Ω—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É):
```objectivec
struct dylib_command {
uint32_t        cmd;            /* LC_LOAD_{,WEAK_}DYLIB */
uint32_t        cmdsize;        /* includes pathname string */
struct dylib    dylib;          /* the library identification */
};

struct dylib {
union lc_str  name;                 /* library's path name */
uint32_t timestamp;                 /* library's build time stamp */
uint32_t current_version;           /* library's current version number */
uint32_t compatibility_version;     /* library's compatibility vers number*/
};
```
![](<../../../.gitbook/assets/image (486).png>)

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
otool -L /bin/ls
/bin/ls:
/usr/lib/libutil.dylib (compatibility version 1.0.0, current version 1.0.0)
/usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1319.0.0)
```
–î–µ—è–∫—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ —à–∫—ñ–¥–ª–∏–≤–∏–º –ü–ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏:

* **DiskArbitration**: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ USB-–Ω–∞–∫–æ–ø–∏—á—É–≤–∞—á—ñ–≤
* **AVFoundation:** –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –∞—É–¥—ñ–æ —Ç–∞ –≤—ñ–¥–µ–æ
* **CoreWLAN**: –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è Wifi.

{% hint style="info" %}
Mach-O –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –æ–¥–∏–Ω –∞–±–æ **–±—ñ–ª—å—à–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤**, —è–∫—ñ –±—É–¥—É—Ç—å **–≤–∏–∫–æ–Ω–∞–Ω—ñ –ø–µ—Ä–µ–¥** –∞–¥—Ä–µ—Å–æ—é, –≤–∫–∞–∑–∞–Ω–æ—é –≤ **LC\_MAIN**.\
–ó–º—ñ—â–µ–Ω–Ω—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Ä–æ–∑–¥—ñ–ª—ñ **\_\_mod\_init\_func** —Å–µ–≥–º–µ–Ω—Ç–∞ **\_\_DATA\_CONST**.
{% endhint %}

## **–î–∞–Ω—ñ Mach-O**

–£ –æ—Å–Ω–æ–≤—ñ —Ñ–∞–π–ª—É –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –æ–±–ª–∞—Å—Ç—å –¥–∞–Ω–∏—Ö, —è–∫–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –∫—ñ–ª—å–∫–æ—Ö —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ –æ–±–ª–∞—Å—Ç—ñ –∫–æ–º–∞–Ω–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. **–í –∫–æ–∂–Ω–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—ñ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏—Å—è —Ä—ñ–∑–Ω—ñ —Å–µ–∫—Ü—ñ—ó –¥–∞–Ω–∏—Ö**, –ø—Ä–∏—á–æ–º—É –∫–æ–∂–Ω–∞ —Å–µ–∫—Ü—ñ—è **–º—ñ—Å—Ç–∏—Ç—å –∫–æ–¥ –∞–±–æ –¥–∞–Ω—ñ**, —â–æ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è —Ç–∏–ø—É.

{% hint style="success" %}
–î–∞–Ω—ñ - —Ü–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —á–∞—Å—Ç–∏–Ω–∞, —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤—Å—é **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**, —è–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∞–º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **LC\_SEGMENTS\_64**
{% endhint %}

![https://www.oreilly.com/api/v2/epubs/9781785883378/files/graphics/B05055\_02\_38.jpg](<../../../.gitbook/assets/image (507) (3).png>)

–¶–µ –≤–∫–ª—é—á–∞—î:

* **–¢–∞–±–ª–∏—Ü—è —Ñ—É–Ω–∫—Ü—ñ–π:** –Ø–∫–∞ –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–æ–≥—Ä–∞–º–∏.
* **–¢–∞–±–ª–∏—Ü—è —Å–∏–º–≤–æ–ª—ñ–≤**: –Ø–∫–∞ –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–æ–≤–Ω—ñ—à–Ω—é —Ñ—É–Ω–∫—Ü—ñ—é, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—É –±—ñ–Ω–∞—Ä–Ω–∏–º —Ñ–∞–π–ª–æ–º
* –¢–∞–∫–æ–∂ –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –Ω–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö —Ç–∞ —ñ–Ω—à–µ.

–î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—å–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**Mach-O View**](https://sourceforge.net/projects/machoview/):

<figure><img src="../../../.gitbook/assets/image (1120).png" alt=""><figcaption></figcaption></figure>

–ê–±–æ –∑ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞:
```bash
size -m /bin/ls
```
## –ó–∞–≥–∞–ª—å–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏ Objective-C

–£ —Å–µ–≥–º–µ–Ω—Ç—ñ `__TEXT` (r-x):

* `__objc_classname`: –Ü–º–µ–Ω–∞ –∫–ª–∞—Å—ñ–≤ (—Ä—è–¥–∫–∏)
* `__objc_methname`: –ù–∞–∑–≤–∏ –º–µ—Ç–æ–¥—ñ–≤ (—Ä—è–¥–∫–∏)
* `__objc_methtype`: –¢–∏–ø–∏ –º–µ—Ç–æ–¥—ñ–≤ (—Ä—è–¥–∫–∏)

–£ —Å–µ–≥–º–µ–Ω—Ç—ñ `__DATA` (rw-):

* `__objc_classlist`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –Ω–∞ –≤—Å—ñ –∫–ª–∞—Å–∏ Objective-C
* `__objc_nlclslist`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –Ω–∞ –Ω–µ–ª—ñ–Ω–∏–≤—ñ –∫–ª–∞—Å–∏ Objective-C
* `__objc_catlist`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
* `__objc_nlcatlist`: –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ –Ω–µ–ª—ñ–Ω–∏–≤—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
* `__objc_protolist`: –°–ø–∏—Å–æ–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤
* `__objc_const`: –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ñ –¥–∞–Ω—ñ
* `__objc_imageinfo`, `__objc_selrefs`, `objc__protorefs`...

## Swift

* `_swift_typeref`, `_swift3_capture`, `_swift3_assocty`, `_swift3_types, _swift3_proto`, `_swift3_fieldmd`, `_swift3_builtin`, `_swift3_reflstr`
