# macOS Memory Dumping

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Memory Artifacts

### Swap Files

‡§∏‡•ç‡§µ‡•à‡§™ ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø `/private/var/vm/swapfile0`, **‡§≠‡•å‡§§‡§ø‡§ï ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§≠‡§∞ ‡§ú‡§æ‡§®‡•á ‡§™‡§∞ ‡§ï‡•à‡§∂ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç**‡•§ ‡§ú‡§¨ ‡§≠‡•å‡§§‡§ø‡§ï ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§î‡§∞ ‡§ú‡§ó‡§π ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§°‡•á‡§ü‡§æ ‡§è‡§ï ‡§∏‡•ç‡§µ‡•à‡§™ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ‡§®‡•Å‡§∏‡§æ‡§∞ ‡§≠‡•å‡§§‡§ø‡§ï ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§µ‡§æ‡§™‡§∏ ‡§≤‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§ï‡§à ‡§∏‡•ç‡§µ‡•à‡§™ ‡§´‡§º‡§æ‡§á‡§≤‡•á‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§®‡§ï‡•á ‡§®‡§æ‡§Æ ‡§ú‡•à‡§∏‡•á swapfile0, swapfile1, ‡§Ü‡§¶‡§ø ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

### Hibernate Image

‡§´‡§º‡§æ‡§á‡§≤ ‡§ú‡•ã `/private/var/vm/sleepimage` ‡§™‡§∞ ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à, **‡§π‡§æ‡§á‡§¨‡§∞‡§®‡•á‡§∂‡§® ‡§Æ‡•ã‡§°** ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§ **‡§ú‡§¨ OS X ‡§π‡§æ‡§á‡§¨‡§∞‡§®‡•á‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§á‡§∏ ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**‡•§ ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ï‡•ã ‡§ú‡§ó‡§æ‡§®‡•á ‡§™‡§∞, ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§á‡§∏ ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•á ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§°‡•á‡§ü‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§µ‡§π‡•Ä‡§Ç ‡§∏‡•á ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡§π‡§æ‡§Å ‡§â‡§∏‡§®‡•á ‡§õ‡•ã‡§°‡§º‡§æ ‡§•‡§æ‡•§

‡§Ø‡§π ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§®‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï MacOS ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§™‡§∞, ‡§Ø‡§π ‡§´‡§º‡§æ‡§á‡§≤ ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ‡§∞‡§£‡•ã‡§Ç ‡§∏‡•á ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§ø ‡§ï‡§†‡§ø‡§® ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§

* ‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ sleepimage ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à, ‡§ï‡§Æ‡§æ‡§Ç‡§° `sysctl vm.swapusage` ‡§ö‡§≤‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§¶‡§ø‡§ñ‡§æ‡§è‡§ó‡§æ ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§´‡§º‡§æ‡§á‡§≤ ‡§è‡§®‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü‡•á‡§° ‡§π‡•à‡•§

### Memory Pressure Logs

MacOS ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§î‡§∞ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä-‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§´‡§º‡§æ‡§á‡§≤ **‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§™‡•ç‡§∞‡•á‡§∂‡§∞ ‡§≤‡•â‡§ó** ‡§π‡•à‡•§ ‡§Ø‡•á ‡§≤‡•â‡§ó `/var/log` ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•Ä ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó ‡§î‡§∞ ‡§™‡•ç‡§∞‡•á‡§∂‡§∞ ‡§ò‡§ü‡§®‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡•á ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä-‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§®‡§ø‡§¶‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§Ø‡§æ ‡§Ø‡§π ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§π‡•ã ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡§Æ‡§Ø ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§

## Dumping memory with osxpmem

MacOS ‡§Æ‡§∂‡•Ä‡§® ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§ï‡•ã ‡§°‡§Ç‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ [**osxpmem**](https://github.com/google/rekall/releases/download/v1.5.1/osxpmem-2.1.post4.zip) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

**Note**: ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ ‡§ï‡•á‡§µ‡§≤ Intel ‡§Ü‡§∞‡•ç‡§ï‡§ø‡§ü‡•á‡§ï‡•ç‡§ö‡§∞ ‡§µ‡§æ‡§≤‡•á Macs ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á‡•§ ‡§Ø‡§π ‡§â‡§™‡§ï‡§∞‡§£ ‡§Ö‡§¨ ‡§Ü‡§∞‡•ç‡§ï‡§æ‡§á‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∞‡§ø‡§≤‡•Ä‡§ú 2017 ‡§Æ‡•á‡§Ç ‡§•‡•Ä‡•§ ‡§®‡•Ä‡§ö‡•á ‡§¶‡§ø‡§è ‡§ó‡§è ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡•Ä ‡§ó‡§à ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä Intel ‡§ö‡§ø‡§™‡•ç‡§∏ ‡§ï‡•ã ‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø 2017 ‡§Æ‡•á‡§Ç Apple Silicon ‡§®‡§π‡•Ä‡§Ç ‡§•‡§æ‡•§ ‡§Ø‡§π arm64 ‡§Ü‡§∞‡•ç‡§ï‡§ø‡§ü‡•á‡§ï‡•ç‡§ö‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡§Ç‡§ï‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ü‡§™‡§ï‡•ã ‡§∏‡•ç‡§µ‡§Ø‡§Ç ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§
```bash
#Dump raw format
sudo osxpmem.app/osxpmem --format raw -o /tmp/dump_mem

#Dump aff4 format
sudo osxpmem.app/osxpmem -o /tmp/dump_mem.aff4
```
‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ø‡§π ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§™‡§æ‡§§‡•á ‡§π‡•à‡§Ç: `osxpmem.app/MacPmem.kext failed to load - (libkern/kext) authentication failure (file ownership/permissions); check the system/kernel logs for errors or try kextutil(8)` ‡§Ü‡§™ ‡§á‡§∏‡•á ‡§†‡•Ä‡§ï ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```bash
sudo cp -r osxpmem.app/MacPmem.kext "/tmp/"
sudo kextutil "/tmp/MacPmem.kext"
#Allow the kext in "Security & Privacy --> General"
sudo osxpmem.app/osxpmem --format raw -o /tmp/dump_mem
```
**‡§Ö‡§®‡•ç‡§Ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡§Ø‡§æ‡§Å** ‡§ï‡•ã **kext ‡§ï‡•á ‡§≤‡•ã‡§° ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§ï‡§∞** ‡§†‡•Ä‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à "Security & Privacy --> General" ‡§Æ‡•á‡§Ç, ‡§¨‡§∏ **‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç**‡•§

‡§Ü‡§™ ‡§á‡§∏ **oneliner** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, kext ‡§≤‡•ã‡§° ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§°‡§Ç‡§™ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

{% code overflow="wrap" %}
```bash
sudo su
cd /tmp; wget https://github.com/google/rekall/releases/download/v1.5.1/osxpmem-2.1.post4.zip; unzip osxpmem-2.1.post4.zip; chown -R root:wheel osxpmem.app/MacPmem.kext; kextload osxpmem.app/MacPmem.kext; osxpmem.app/osxpmem --format raw -o /tmp/dump_mem
```
{% endcode %}


{% hint style="success" %}
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Å**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**telegram ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§π‡§Æ‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ **‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç**.**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç PRs ‡§ï‡•ã** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á.

</details>
{% endhint %}
