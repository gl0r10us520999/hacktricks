# macOS Keychain

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## –û—Å–Ω–æ–≤–Ω—ñ –∫–ª—é—á–æ–≤—ñ –ª–∞–Ω—Ü—é–≥–∏

* **–ö–ª—é—á–æ–≤–∏–π –ª–∞–Ω—Ü—é–≥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** (`~/Library/Keychains/login.keychain-db`), —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è **–æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —Ç–∞–∫–∏—Ö —è–∫ –ø–∞—Ä–æ–ª—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤, –ø–∞—Ä–æ–ª—ñ –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –ø–∞—Ä–æ–ª—ñ –º–µ—Ä–µ–∂—ñ —Ç–∞ –ø—É–±–ª—ñ—á–Ω—ñ/–ø—Ä–∏–≤–∞—Ç–Ω—ñ –∫–ª—é—á—ñ, —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.
* **–°–∏—Å—Ç–µ–º–Ω–∏–π –∫–ª—é—á–æ–≤–∏–π –ª–∞–Ω—Ü—é–≥** (`/Library/Keychains/System.keychain`), —è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î **—Å–∏—Å—Ç–µ–º–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —Ç–∞–∫—ñ —è–∫ –ø–∞—Ä–æ–ª—ñ WiFi, –∫–æ—Ä–µ–Ω–µ–≤—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ —Å–∏—Å—Ç–µ–º–∏, –ø—Ä–∏–≤–∞—Ç–Ω—ñ –∫–ª—é—á—ñ —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –ø–∞—Ä–æ–ª—ñ –¥–æ–¥–∞—Ç–∫—ñ–≤ —Å–∏—Å—Ç–µ–º–∏.
* –ú–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —ñ–Ω—à—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –≤ `/System/Library/Keychains/*`
* –£ **iOS** —î –ª–∏—à–µ –æ–¥–∏–Ω **–∫–ª—é—á–æ–≤–∏–π –ª–∞–Ω—Ü—é–≥**, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–π —É `/private/var/Keychains/`. –¶—è –ø–∞–ø–∫–∞ —Ç–∞–∫–æ–∂ –º—ñ—Å—Ç–∏—Ç—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –¥–ª—è `TrustStore`, –æ—Ä–≥–∞–Ω—ñ–≤ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (`caissuercache`) —Ç–∞ –∑–∞–ø–∏—Å—ñ–≤ OSCP (`ocspache`).
* –î–æ–¥–∞—Ç–∫–∏ –±—É–¥—É—Ç—å –æ–±–º–µ–∂–µ–Ω—ñ –≤ –∫–ª—é—á–æ–≤–æ–º—É –ª–∞–Ω—Ü—é–∑—ñ –ª–∏—à–µ –¥–æ —ó—Ö –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ó—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –¥–æ–¥–∞—Ç–∫–∞.

### –î–æ—Å—Ç—É–ø –¥–æ –∫–ª—é—á–æ–≤–æ–≥–æ –ª–∞–Ω—Ü—é–≥–∞ –ø–∞—Ä–æ–ª—ñ–≤

–¶—ñ —Ñ–∞–π–ª–∏, —Ö–æ—á–∞ –π –Ω–µ –º–∞—é—Ç—å –≤–±—É–¥–æ–≤–∞–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É —Ç–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ —Ç–∞ –≤–∏–º–∞–≥–∞—é—Ç—å **–ø–ª–æ—Å–∫–æ–≥–æ –ø–∞—Ä–æ–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏**. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç–∞–∫–∏–π —è–∫ [**Chainbreaker**](https://github.com/n0fate/chainbreaker), –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏.

## –ó–∞—Ö–∏—Å—Ç –∑–∞–ø–∏—Å—ñ–≤ –∫–ª—é—á–æ–≤–æ–≥–æ –ª–∞–Ω—Ü—é–≥–∞

### ACLs

–ö–æ–∂–µ–Ω –∑–∞–ø–∏—Å —É –∫–ª—é—á–æ–≤–æ–º—É –ª–∞–Ω—Ü—é–∑—ñ —Ä–µ–≥—É–ª—é—î—Ç—å—Å—è **–°–ø–∏—Å–∫–∞–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É (ACLs)**, —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å, —Ö—Ç–æ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –¥—ñ—ó –Ω–∞–¥ –∑–∞–ø–∏—Å–æ–º –∫–ª—é—á–æ–≤–æ–≥–æ –ª–∞–Ω—Ü—é–≥–∞, –≤–∫–ª—é—á–∞—é—á–∏:

* **ACLAuhtorizationExportClear**: –î–æ–∑–≤–æ–ª—è—î –≤–ª–∞—Å–Ω–∏–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç —Å–µ–∫—Ä–µ—Ç—É.
* **ACLAuhtorizationExportWrapped**: –î–æ–∑–≤–æ–ª—è—î –≤–ª–∞—Å–Ω–∏–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —ñ–Ω—à–∏–º –Ω–∞–¥–∞–Ω–∏–º –ø–∞—Ä–æ–ª–µ–º.
* **ACLAuhtorizationAny**: –î–æ–∑–≤–æ–ª—è—î –≤–ª–∞—Å–Ω–∏–∫—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—É –¥—ñ—é.

ACL —Å—É–ø—Ä–æ–≤–æ–¥–∂—É—é—Ç—å—Å—è **–ø–µ—Ä–µ–ª—ñ–∫–æ–º –¥–æ–≤—ñ—Ä–µ–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤**, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ü—ñ –¥—ñ—ó –±–µ–∑ –∑–∞–ø–∏—Ç—É. –¶–µ –º–æ–∂–µ –±—É—Ç–∏:

* **N`il`** (–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è, **–≤—Å—ñ –¥–æ–≤—ñ—Ä–µ–Ω—ñ**)
* **–ø–æ—Ä–æ–∂–Ω—ñ–π** —Å–ø–∏—Å–æ–∫ (**–Ω—ñ—Ö—Ç–æ** –Ω–µ –¥–æ–≤—ñ—Ä–µ–Ω–∏–π)
* **–°–ø–∏—Å–æ–∫** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö **–¥–æ–¥–∞—Ç–∫—ñ–≤**.

–¢–∞–∫–æ–∂ –∑–∞–ø–∏—Å –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –∫–ª—é—á **`ACLAuthorizationPartitionID`,** —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó **teamid, apple,** —Ç–∞ **cdhash.**

* –Ø–∫—â–æ **teamid** –≤–∫–∞–∑–∞–Ω–æ, —Ç–æ–¥—ñ –¥–ª—è **–¥–æ—Å—Ç—É–ø—É –¥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É** **–±–µ–∑** **–∑–∞–ø–∏—Ç—É** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ **—Ç–æ–π –∂–µ teamid**.
* –Ø–∫—â–æ **apple** –≤–∫–∞–∑–∞–Ω–æ, —Ç–æ–¥—ñ –¥–æ–¥–∞—Ç–æ–∫ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ **–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π** **Apple**.
* –Ø–∫—â–æ **cdhash** –≤–∫–∞–∑–∞–Ω–æ, —Ç–æ–¥—ñ **–¥–æ–¥–∞—Ç–æ–∫** –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π **cdhash**.

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ –∫–ª—é—á–æ–≤–æ–º—É –ª–∞–Ω—Ü—é–∑—ñ

–ö–æ–ª–∏ **–Ω–æ–≤–∏–π** **–∑–∞–ø–∏—Å** —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`Keychain Access.app`**, –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è —Ç–∞–∫—ñ –ø—Ä–∞–≤–∏–ª–∞:

* –£—Å—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å —à–∏—Ñ—Ä—É–≤–∞—Ç–∏.
* **–ñ–æ–¥–µ–Ω –¥–æ–¥–∞—Ç–æ–∫** –Ω–µ –º–æ–∂–µ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏/—Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É–≤–∞—Ç–∏ (–±–µ–∑ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).
* –£—Å—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å –±–∞—á–∏—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ.
* –ñ–æ–¥–µ–Ω –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ ACLs.
* **partitionID** –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞ **`apple`**.

–ö–æ–ª–∏ **–¥–æ–¥–∞—Ç–æ–∫ —Å—Ç–≤–æ—Ä—é—î –∑–∞–ø–∏—Å —É –∫–ª—é—á–æ–≤–æ–º—É –ª–∞–Ω—Ü—é–∑—ñ**, –ø—Ä–∞–≤–∏–ª–∞ —Ç—Ä–æ—Ö–∏ —ñ–Ω—à—ñ:

* –£—Å—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å —à–∏—Ñ—Ä—É–≤–∞—Ç–∏.
* –¢—ñ–ª—å–∫–∏ **–¥–æ–¥–∞—Ç–æ–∫, —â–æ —Å—Ç–≤–æ—Ä—é—î** (–∞–±–æ –±—É–¥—å-—è–∫—ñ —ñ–Ω—à—ñ –¥–æ–¥–∞—Ç–∫–∏, —è–∫—ñ —è–≤–Ω–æ –¥–æ–¥–∞–Ω—ñ) –º–æ–∂—É—Ç—å –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏/—Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É–≤–∞—Ç–∏ (–±–µ–∑ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).
* –£—Å—ñ –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å –±–∞—á–∏—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ.
* –ñ–æ–¥–µ–Ω –¥–æ–¥–∞—Ç–æ–∫ –Ω–µ –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ ACLs.
* **partitionID** –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞ **`teamid:[teamID here]`**.

## –î–æ—Å—Ç—É–ø –¥–æ –∫–ª—é—á–æ–≤–æ–≥–æ –ª–∞–Ω—Ü—é–≥–∞

### `security`
```bash
# List keychains
security list-keychains

# Dump all metadata and decrypted secrets (a lot of pop-ups)
security dump-keychain -a -d

# Find generic password for the "Slack" account and print the secrets
security find-generic-password -a "Slack" -g

# Change the specified entrys PartitionID entry
security set-generic-password-parition-list -s "test service" -a "test acount" -S

# Dump specifically the user keychain
security dump-keychain ~/Library/Keychains/login.keychain-db
```
### APIs

{% hint style="success" %}
–ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ —Ç–∞ –≤–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ –∑ **keychain**, —è–∫—ñ **–Ω–µ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å –∑–∞–ø–∏—Ç**, –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ [**LockSmith**](https://github.com/its-a-feature/LockSmith)

–Ü–Ω—à—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ API –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ [**SecKeyChain.h**](https://opensource.apple.com/source/libsecurity\_keychain/libsecurity\_keychain-55017/lib/SecKeychain.h.auto.html) –≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ.
{% endhint %}

–°–ø–∏—Å–æ–∫ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó** –ø—Ä–æ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Å —É keychain –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Security Framework** –∞–±–æ –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ Apple [**security**](https://opensource.apple.com/source/Security/Security-59306.61.1/SecurityTool/macOS/security.c.auto.html)**.** –î–µ—è–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ API:

* API **`SecItemCopyMatching`** –Ω–∞–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Å, —ñ —î –∫—ñ–ª—å–∫–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä–∏ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ:
* **`kSecReturnData`**: –Ø–∫—â–æ true, –≤—ñ–Ω —Å–ø—Ä–æ–±—É—î —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ (–≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞ false, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö —Å–ø–ª–∏–≤–∞—é—á–∏—Ö –≤—ñ–∫–æ–Ω)
* **`kSecReturnRef`**: –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–∞–∫–æ–∂ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç keychain (–≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞ true, —è–∫—â–æ –ø—ñ–∑–Ω—ñ—à–µ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ, —â–æ –º–æ–∂–µ—Ç–µ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ –±–µ–∑ —Å–ø–ª–∏–≤–∞—é—á–æ–≥–æ –≤—ñ–∫–Ω–∞)
* **`kSecReturnAttributes`**: –û—Ç—Ä–∏–º–∞—Ç–∏ –º–µ—Ç–∞–¥–∞–Ω—ñ –ø—Ä–æ –∑–∞–ø–∏—Å–∏
* **`kSecMatchLimit`**: –°–∫—ñ–ª—å–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏
* **`kSecClass`**: –Ø–∫–∏–π —Ç–∏–ø –∑–∞–ø–∏—Å—É –≤ keychain

–û—Ç—Ä–∏–º–∞—Ç–∏ **ACL** –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É:

* –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é API **`SecAccessCopyACLList`** –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **ACL –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç–∞ keychain**, —ñ –≤—ñ–Ω –ø–æ–≤–µ—Ä–Ω–µ —Å–ø–∏—Å–æ–∫ ACL (—Ç–∞–∫–∏—Ö —è–∫ `ACLAuhtorizationExportClear` —Ç–∞ —ñ–Ω—à—ñ, –∑–≥–∞–¥–∞–Ω—ñ —Ä–∞–Ω—ñ—à–µ), –¥–µ –∫–æ–∂–µ–Ω —Å–ø–∏—Å–æ–∫ –º–∞—î:
* –û–ø–∏—Å
* **–°–ø–∏—Å–æ–∫ –Ω–∞–¥—ñ–π–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤**. –¶–µ –º–æ–∂–µ –±—É—Ç–∏:
* –î–æ–¥–∞—Ç–æ–∫: /Applications/Slack.app
* –ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª: /usr/libexec/airportd
* –ì—Ä—É–ø–∞: group://AirPort

–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ:

* API **`SecKeychainItemCopyContent`** –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Ç–µ–∫—Å—Ç
* API **`SecItemExport`** –µ–∫—Å–ø–æ—Ä—Ç—É—î –∫–ª—é—á—ñ —Ç–∞ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, –∞–ª–µ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—ñ –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É –≤–º—ñ—Å—Ç—É –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ–º—É –≤–∏–≥–ª—è–¥—ñ

–Ü —Ü–µ **–≤–∏–º–æ–≥–∏** –¥–ª—è —Ç–æ–≥–æ, —â–æ–± **–µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç –±–µ–∑ –∑–∞–ø–∏—Ç—É**:

* –Ø–∫—â–æ **1+ –Ω–∞–¥—ñ–π–Ω–∏—Ö** –¥–æ–¥–∞—Ç–∫—ñ–≤ —É —Å–ø–∏—Å–∫—É:
* –ü–æ—Ç—Ä—ñ–±–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó** (**`Nil`**, –∞–±–æ –±—É—Ç–∏ **—á–∞—Å—Ç–∏–Ω–æ—é** –¥–æ–∑–≤–æ–ª–µ–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –¥–æ–¥–∞—Ç–∫—ñ–≤ —É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó)
* –ü–æ—Ç—Ä—ñ–±–µ–Ω –∫–æ–¥ –ø—ñ–¥–ø–∏—Å—É, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ **PartitionID**
* –ü–æ—Ç—Ä—ñ–±–µ–Ω –∫–æ–¥ –ø—ñ–¥–ø–∏—Å—É, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –æ–¥–Ω–æ–º—É **–Ω–∞–¥—ñ–π–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É** (–∞–±–æ –±—É—Ç–∏ —á–ª–µ–Ω–æ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ KeychainAccessGroup)
* –Ø–∫—â–æ **–≤—Å—ñ –¥–æ–¥–∞—Ç–∫–∏ –Ω–∞–¥—ñ–π–Ω—ñ**:
* –ü–æ—Ç—Ä—ñ–±–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ **–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**
* –ü–æ—Ç—Ä—ñ–±–µ–Ω –∫–æ–¥ –ø—ñ–¥–ø–∏—Å—É, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ **PartitionID**
* –Ø–∫—â–æ **–Ω–µ–º–∞—î PartitionID**, —Ç–æ–¥—ñ —Ü–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ

{% hint style="danger" %}
–û—Ç–∂–µ, —è–∫—â–æ —î **1 –¥–æ–¥–∞—Ç–æ–∫ —É —Å–ø–∏—Å–∫—É**, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –∫–æ–¥ —É —Ü–µ–π –¥–æ–¥–∞—Ç–æ–∫**.

–Ø–∫—â–æ **apple** –≤–∫–∞–∑–∞–Ω–æ –≤ **partitionID**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`osascript`**, —Ç–æ–º—É –≤—Å–µ, —â–æ –¥–æ–≤—ñ—Ä—è—î –≤—Å—ñ–º –¥–æ–¥–∞—Ç–∫–∞–º –∑ apple –≤ partitionID. **`Python`** —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Ü—å–æ–≥–æ.
{% endhint %}

### –î–≤–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—Ç—Ä–∏–±—É—Ç–∏

* **–ù–µ–≤–∏–¥–∏–º–∏–π**: –¶–µ –±—É–ª–µ–≤–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è **–ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è** –∑–∞–ø–∏—Å—É –∑ **UI** –¥–æ–¥–∞—Ç–∫—É Keychain
* **–ó–∞–≥–∞–ª—å–Ω–∏–π**: –¶–µ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è **–º–µ—Ç–∞–¥–∞–Ω–∏—Ö** (—Ç–æ–º—É —Ü–µ –ù–ï –ó–ê–®–ò–§–†–û–í–ê–ù–û)
* Microsoft –∑–±–µ—Ä—ñ–≥–∞–≤ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ –≤—Å—ñ —Ç–æ–∫–µ–Ω–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫.

## References

* [**#OBTS v5.0: "Lock Picking the macOS Keychain" - Cody Thomas**](https://www.youtube.com/watch?v=jKE1ZW33JpY)

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
