# –ë–µ–∑–ø–µ–∫–∞ Docker

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security) –¥–ª—è –ª–µ–≥–∫–æ—ó –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–π–±—ñ–ª—å—à **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∏—Ö** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

## **–û—Å–Ω–æ–≤–Ω–∞ –±–µ–∑–ø–µ–∫–∞ Docker Engine**

**–î–≤–∏–≥—É–Ω Docker** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω** —Ç–∞ **Cgroups** —è–¥—Ä–∞ Linux –¥–ª—è —ñ–∑–æ–ª—è—Ü—ñ—ó –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤, —â–æ –Ω–∞–¥–∞—î –±–∞–∑–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏. –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–≤—ñ–¥–º–æ–≤–∏ –≤ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è—Ö**, **Seccomp** —Ç–∞ **SELinux/AppArmor**, –ø–æ–∫—Ä–∞—â—É—é—á–∏ —ñ–∑–æ–ª—è—Ü—ñ—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤. **–ê–≤—Ç–µ–Ω—Ç–∏—á–Ω–∏–π –ø–ª–∞–≥—ñ–Ω** –º–æ–∂–µ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –æ–±–º–µ–∂–∏—Ç–∏ –¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

![–ë–µ–∑–ø–µ–∫–∞ Docker](https://sreeninet.files.wordpress.com/2016/03/dockersec1.png)

### –ë–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ Docker Engine

–î–æ –¥–≤–∏–≥—É–Ω–∞ Docker –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Unix-—Å–æ–∫–µ—Ç, –∞–±–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP. –î–ª—è –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –≤–∞–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ HTTPS —Ç–∞ **TLS** –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ, —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–î–≤–∏–≥—É–Ω Docker –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É—î Unix-—Å–æ–∫–µ—Ç –∑–∞ –∞–¥—Ä–µ—Å–æ—é `unix:///var/run/docker.sock`. –ù–∞ —Å–∏—Å—Ç–µ–º–∞—Ö Ubuntu –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ø—É—Å–∫—É Docker –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –≤ `/etc/default/docker`. –©–æ–± –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ API —Ç–∞ –∫–ª—ñ—î–Ω—Ç–∞ Docker, –≤–∏–∫–ª–∞–¥—ñ—Ç—å –¥–µ–º–æ–Ω–∞ Docker —á–µ—Ä–µ–∑ HTTP-—Å–æ–∫–µ—Ç, –¥–æ–¥–∞–≤—à–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
```bash
DOCKER_OPTS="-D -H unix:///var/run/docker.sock -H tcp://192.168.56.101:2376"
sudo service docker restart
```
–û–¥–Ω–∞–∫, –≤–∏–∫–ª–∞–¥–∞–Ω–Ω—è –¥–µ–º–æ–Ω–∞ Docker —á–µ—Ä–µ–∑ HTTP –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –±–µ–∑–ø–µ–∫–æ—é. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –∑–∞—Ö–∏—Å—Ç –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º HTTPS. –Ü—Å–Ω—É—é—Ç—å –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ –¥–æ –∑–∞—Ö–∏—Å—Ç—É –∑'—î–¥–Ω–∞–Ω–Ω—è:

1. –ö–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞.
2. –Ø–∫ –∫–ª—ñ—î–Ω—Ç, —Ç–∞–∫ —ñ —Å–µ—Ä–≤–µ—Ä –≤–∑–∞—î–º–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –æ–¥–Ω–µ –æ–¥–Ω–æ–≥–æ.

–î–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ —Å–µ—Ä–≤–µ—Ä–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏. –î–ª—è –¥–æ–∫–ª–∞–¥–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –æ–±–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –¥–∏–≤. [**—Ü–µ–π –ø–æ—Å—ñ–±–Ω–∏–∫**](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/).

### –ë–µ–∑–ø–µ–∫–∞ –æ–±—Ä–∞–∑—ñ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤

–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –º–æ–∂—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è —è–∫ —É –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö, —Ç–∞–∫ —ñ —É –ø—É–±–ª—ñ—á–Ω–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è—Ö. Docker –ø—Ä–æ–ø–æ–Ω—É—î –∫—ñ–ª—å–∫–∞ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤:

* [**Docker Hub**](https://hub.docker.com): –ü—É–±–ª—ñ—á–Ω–∏–π —Ä–µ—î—Å—Ç—Ä —Å–µ—Ä–≤—ñ—Å –≤—ñ–¥ Docker.
* [**Docker Registry**](https://github.com/docker/distribution): –ü—Ä–æ–µ–∫—Ç –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –∫–æ–¥–æ–º, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —Ä–æ–∑–º—ñ—â—É–≤–∞—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π —Ä–µ—î—Å—Ç—Ä.
* [**Docker Trusted Registry**](https://www.docker.com/docker-trusted-registry): –ö–æ–º–µ—Ä—Ü—ñ–π–Ω–∏–π —Ä–µ—î—Å—Ç—Ä Docker, —è–∫–∏–π –ø—Ä–æ–ø–æ–Ω—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª–µ–π —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ –∫–∞—Ç–∞–ª–æ–≥–æ–≤–∏–º–∏ —Å–ª—É–∂–±–∞–º–∏ LDAP.

### –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏** —á–µ—Ä–µ–∑ –±–∞–∑–æ–≤–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–±–æ —á–µ—Ä–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–µ –ø–æ–≤–µ—Ä—Ö –±–∞–∑–æ–≤–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. Docker –ø—Ä–∞—Ü—é—î –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **Nautilus**, —è–∫–∏–π —Å–∫–∞–Ω—É—î –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –ø–µ—Ä–µ–ª—ñ—á—É—î –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. Nautilus –ø—Ä–∞—Ü—é—î —à–ª—è—Ö–æ–º –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ —à–∞—Ä—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—î–º –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥—ñ—Ä–æ–∫ –≤ –±–µ–∑–ø–µ—Ü—ñ.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –±—ñ–ª—å—à –¥–æ–∫–ª–∞–¥–Ω–æ—ó [**—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ü–µ**](https://docs.docker.com/engine/scan/).

* **`docker scan`**

–ö–æ–º–∞–Ω–¥–∞ **`docker scan`** –¥–æ–∑–≤–æ–ª—è—î —Å–∫–∞–Ω—É–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è Docker –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–∑–≤–∏ –∞–±–æ ID –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è hello-world:
```bash
docker scan hello-world

Testing hello-world...

Organization:      docker-desktop-test
Package manager:   linux
Project name:      docker-image|hello-world
Docker image:      hello-world
Licenses:          enabled

‚úì Tested 0 dependencies for known issues, no vulnerable paths found.

Note that we do not currently have vulnerability data for your image.
```
* [**`trivy`**](https://github.com/aquasecurity/trivy)
```bash
trivy -q -f json <container_name>:<tag>
```
* [**`snyk`**](https://docs.snyk.io/snyk-cli/getting-started-with-the-cli)
```bash
snyk container test <image> --json-file-output=<output file> --severity-threshold=high
```
* [**`clair-scanner`**](https://github.com/arminc/clair-scanner)
```bash
clair-scanner -w example-alpine.yaml --ip YOUR_LOCAL_IP alpine:3.5
```
### –ü—ñ–¥–ø–∏—Å Docker Image

–ü—ñ–¥–ø–∏—Å Docker image –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ–∫—É —Ç–∞ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω—å, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö. –û—Å—å —Å—Ç–∏—Å–ª–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è:

* **–î–æ–≤—ñ—Ä–∞ –≤–º—ñ—Å—Ç—É Docker** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–æ–µ–∫—Ç Notary, –∑–∞—Å–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ The Update Framework (TUF), –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–æ–º –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–∏–≤. [Notary](https://github.com/docker/notary) —Ç–∞ [TUF](https://theupdateframework.github.io).
* –©–æ–± –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –¥–æ–≤—ñ—Ä—É –≤–º—ñ—Å—Ç—É Docker, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å `export DOCKER_CONTENT_TRUST=1`. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–º–∫–Ω–µ–Ω–∞ –≤ Docker –≤–µ—Ä—Å—ñ—ó 1.10 —Ç–∞ –ø—ñ–∑–Ω—ñ—à–∏—Ö.
* –ó —Ü—ñ—î—é —Ñ—É–Ω–∫—Ü—ñ—î—é –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ—é, –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –ª–∏—à–µ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –ü–µ—Ä—à–∏–π –ø—É—à –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏–º–∞–≥–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ –¥–ª—è –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ —Ç–∞ —Ç–µ–≥–æ–≤–æ–≥–æ –∫–ª—é—á—ñ–≤, –ø—Ä–∏—á–æ–º—É Docker —Ç–∞–∫–æ–∂ –ø—ñ–¥—Ç—Ä–∏–º—É—î Yubikey –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏. –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–µ—Ç–∞–ª—ñ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://blog.docker.com/2015/11/docker-content-trust-yubikey/).
* –°–ø—Ä–æ–±–∞ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –Ω–µ–ø—ñ–¥–ø–∏—Å–∞–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ—é –¥–æ–≤—ñ—Ä–æ—é –≤–º—ñ—Å—Ç—É –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–º–∏–ª–∫–∏ "No trust data for latest".
* –ü—ñ–¥ —á–∞—Å –ø—É—à—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ, Docker –∑–∞–ø–∏—Ç—É—î –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–ª—é—á–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –¥–ª—è –ø—ñ–¥–ø–∏—Å—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.

–î–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤–∞—à–∏—Ö –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –∫–ª—é—á—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:
```bash
tar -zcvf private_keys_backup.tar.gz ~/.docker/trust/private
```
–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –¥–æ –Ω–æ–≤–∏—Ö —Ö–æ—Å—Ç—ñ–≤ Docker –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ –∫–æ—Ä–µ–Ω–µ–≤—ñ —Ç–∞ –∫–ª—é—á—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ—ó —Ä–æ–±–æ—Ç–∏.

***

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security), —â–æ–± –ª–µ–≥–∫–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–π–±—ñ–ª—å—à **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∏—Ö** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

## –§—É–Ω–∫—Ü—ñ—ó –ë–µ–∑–ø–µ–∫–∏ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤

<details>

<summary>–û–≥–ª—è–¥ –§—É–Ω–∫—Ü—ñ–π –ë–µ–∑–ø–µ–∫–∏ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤</summary>

**–û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —ñ–∑–æ–ª—è—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—ñ–≤**

–£ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö —ñ–∑–æ–ª—è—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—ñ–≤ —Ç–∞ —ó—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ —î –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏. –û—Å—å —Å–ø—Ä–æ—â–µ–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü—ñ–π:

**–ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω (Namespaces)**

* **–ú–µ—Ç–∞**: –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —ñ–∑–æ–ª—è—Ü—ñ—ó —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ –ø—Ä–æ—Ü–µ—Å–∏, –º–µ—Ä–µ–∂–∞ —Ç–∞ —Ñ–∞–π–ª–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏. –û—Å–æ–±–ª–∏–≤–æ –≤ Docker, –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω —É—Ç—Ä–∏–º—É—é—Ç—å –ø—Ä–æ—Ü–µ—Å–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–æ –≤—ñ–¥ —Ö–æ—Å—Ç–∞ —Ç–∞ —ñ–Ω—à–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤.
* **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `unshare`**: –ö–æ–º–∞–Ω–¥–∞ `unshare` (–∞–±–æ –±–∞–∑–æ–≤–∏–π —Å–∏—Å—Ç–µ–º–Ω–∏–π –≤–∏–∫–ª–∏–∫) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å —ñ–∑–æ–ª—è—Ü—ñ—ó. –û–¥–Ω–∞–∫, —Ö–æ—á–∞ Kubernetes –Ω–µ –±–ª–æ–∫—É—î —Ü–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, Docker —Ä–æ–±–∏—Ç—å —Ü–µ.
* **–û–±–º–µ–∂–µ–Ω–Ω—è**: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω –Ω–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–æ—Ü–µ—Å—É –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ö–æ—Å—Ç–∞. –î–ª—è –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –≤ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω —Ö–æ—Å—Ç–∞ –∑–∞–∑–≤–∏—á–∞–π –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É `/proc` —Ö–æ—Å—Ç–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `nsenter` –¥–ª—è –≤—Ö–æ–¥—É.

**–ì—Ä—É–ø–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è (CGroups)**

* **–§—É–Ω–∫—Ü—ñ—è**: –í –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Ä–µ—Å—É—Ä—Å—ñ–≤ —Å–µ—Ä–µ–¥ –ø—Ä–æ—Ü–µ—Å—ñ–≤.
* **–ê—Å–ø–µ–∫—Ç –±–µ–∑–ø–µ–∫–∏**: –°–∞–º–∏ CGroups –Ω–µ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –±–µ–∑–ø–µ–∫–æ–≤–æ—ó —ñ–∑–æ–ª—è—Ü—ñ—ó, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º —Ñ—É–Ω–∫—Ü—ñ—ó `release_agent`, —è–∫–∞, —è–∫—â–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.

**–°–∫–∏–¥–∞–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π (Capability Drop)**

* **–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å**: –¶–µ –≤–∞–∂–ª–∏–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è –±–µ–∑–ø–µ–∫–∏ –¥–ª—è —ñ–∑–æ–ª—è—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—ñ–≤.
* **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: –í–æ–Ω–∞ –æ–±–º–µ–∂—É—î –¥—ñ—ó, —è–∫—ñ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –ø—Ä–æ—Ü–µ—Å, –≤—ñ–¥–∫–∏–¥–∞—é—á–∏ –ø–µ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ –ø—Ä–æ—Ü–µ—Å –ø—Ä–∞—Ü—é—î –∑ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ root, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –ø–µ—Ä–µ—à–∫–æ–¥–∂–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—é –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –¥—ñ–π, –æ—Å–∫—ñ–ª—å–∫–∏ —Å–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è –∑ –ø–æ–º–∏–ª–∫–æ—é —á–µ—Ä–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—ñ –ø—Ä–∞–≤–∞.

–û—Å—å **–∑–∞–ª–∏—à–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ** –ø—ñ—Å–ª—è —Å–∫–∏–¥–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤:

{% code overflow="wrap" %}
```
Current: cap_chown,cap_dac_override,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_net_bind_service,cap_net_raw,cap_sys_chroot,cap_mknod,cap_audit_write,cap_setfcap=ep
```
{% endcode %}

**Seccomp**

–í—ñ–Ω —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤ Docker. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î **—â–µ –±—ñ–ª—å—à–µ –æ–±–º–µ–∂–∏—Ç–∏ syscalls**, —è–∫—ñ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å.\
**–ü—Ä–æ—Ñ—ñ–ª—å –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Docker Seccomp** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://github.com/moby/moby/blob/master/profiles/seccomp/default.json](https://github.com/moby/moby/blob/master/profiles/seccomp/default.json)

**AppArmor**

–£ Docker —î —à–∞–±–ª–æ–Ω, —è–∫–∏–π –º–æ–∂–Ω–∞ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏: [https://github.com/moby/moby/tree/master/profiles/apparmor](https://github.com/moby/moby/tree/master/profiles/apparmor)

–¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–º–µ–Ω—à–∏—Ç–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ, syscalls, –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤ —Ç–∞ –ø–∞–ø–æ–∫...

</details>

### –ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω

**–ü—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω** - —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è —è–¥—Ä–∞ Linux, —è–∫–∞ **—Ä–æ–∑–¥—ñ–ª—è—î —Ä–µ—Å—É—Ä—Å–∏ —è–¥—Ä–∞** —Ç–∞–∫, —â–æ –æ–¥–∏–Ω –Ω–∞–±—ñ—Ä **–ø—Ä–æ—Ü–µ—Å—ñ–≤ –±–∞—á–∏—Ç—å** –æ–¥–∏–Ω –Ω–∞–±—ñ—Ä **—Ä–µ—Å—É—Ä—Å—ñ–≤**, —Ç–æ–¥—ñ —è–∫ **—ñ–Ω—à–∏–π** –Ω–∞–±—ñ—Ä **–ø—Ä–æ—Ü–µ—Å—ñ–≤** –±–∞—á–∏—Ç—å **—ñ–Ω—à–∏–π** –Ω–∞–±—ñ—Ä —Ä–µ—Å—É—Ä—Å—ñ–≤. –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–∞—Ü—é—î –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–¥–Ω–æ–≥–æ —ñ —Ç–æ–≥–æ –∂ –ø—Ä–æ—Å—Ç–æ—Ä—É —ñ–º–µ–Ω –¥–ª—è –Ω–∞–±–æ—Ä—É —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ç–∞ –ø—Ä–æ—Ü–µ—Å—ñ–≤, –∞–ª–µ —Ü—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω –ø–æ—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏. –†–µ—Å—É—Ä—Å–∏ –º–æ–∂—É—Ç—å —ñ—Å–Ω—É–≤–∞—Ç–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö.

Docker –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω —è–¥—Ä–∞ Linux –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —ñ–∑–æ–ª—è—Ü—ñ—ó –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤:

* pid namespace
* mount namespace
* network namespace
* ipc namespace
* UTS namespace

–î–ª—è **–¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω** –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É:

{% content-ref url="namespaces/" %}
[namespaces](namespaces/)
{% endcontent-ref %}

### cgroups

–§—É–Ω–∫—Ü—ñ—è —è–¥—Ä–∞ Linux **cgroups** –Ω–∞–¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–æ–±–º–µ–∂—É–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏, —Ç–∞–∫—ñ —è–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å–æ—Ä, –ø–∞–º'—è—Ç—å, –≤–≤–µ–¥–µ–Ω–Ω—è/–≤–∏–≤–µ–¥–µ–Ω–Ω—è, –º–µ—Ä–µ–∂–µ–≤–∞ –ø—Ä–æ–ø—É—Å–∫–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å —Å–µ—Ä–µ–¥** –Ω–∞–±–æ—Ä—É –ø—Ä–æ—Ü–µ—Å—ñ–≤. Docker –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ñ—É–Ω–∫—Ü—ñ—ó cgroup, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.\
–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º –ø–∞–º'—è—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Ä—ñ–≤–Ω—ñ 500 –º–±, –æ–±–º–µ–∂–µ–Ω–Ω—è –ø–∞–º'—è—Ç—ñ —è–¥—Ä–∞ –Ω–∞ —Ä—ñ–≤–Ω—ñ 50 –º–±, —á–∞—Å—Ç–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –Ω–∞ —Ä—ñ–≤–Ω—ñ 512, blkioweight –Ω–∞ —Ä—ñ–≤–Ω—ñ 400. –ß–∞—Å—Ç–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ - —Ü–µ –≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è, —è–∫–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º. –í–æ–Ω–∞ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 1024 —Ç–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω –≤—ñ–¥ 0 –¥–æ 1024. –Ø–∫—â–æ —É —Ç—Ä—å–æ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –æ–¥–Ω–∞–∫–æ–≤–∞ —á–∞—Å—Ç–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ 1024, –∫–æ–∂–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–æ 33% —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –≤ —Ä–∞–∑—ñ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—É —Ä–µ—Å—É—Ä—Å—ñ–≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞. blkio-weight - —Ü–µ –≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è, —è–∫–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –≤–≤–µ–¥–µ–Ω–Ω—è/–≤–∏–≤–µ–¥–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í–æ–Ω–∞ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 500 —Ç–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω –≤—ñ–¥ 10 –¥–æ 1000.
```
docker run -it -m 500M --kernel-memory 50M --cpu-shares 512 --blkio-weight 400 --name ubuntu1 ubuntu bash
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è cgroup –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏:
```bash
docker run -dt --rm denial sleep 1234 #Run a large sleep inside a Debian container
ps -ef | grep 1234 #Get info about the sleep process
ls -l /proc/<PID>/ns #Get the Group and the namespaces (some may be uniq to the hosts and some may be shred with it)
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="cgroups.md" %}
[cgroups.md](cgroups.md)
{% endcontent-ref %}

### –ü—Ä–∞–≤–∞

–ü—Ä–∞–≤–∞ –¥–æ–∑–≤–æ–ª—è—é—Ç—å **–¥–æ—Å—è–≥—Ç–∏ –±—ñ–ª—å—à —Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –ø—Ä–∞–≤–∞–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ root. Docker –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—é –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π —è–¥—Ä–∞ Linux –¥–ª—è **–æ–±–º–µ–∂–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

–ü—ñ–¥ —á–∞—Å –∑–∞–ø—É—Å–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Docker **–ø—Ä–æ—Ü–µ—Å –≤—ñ–¥–º–æ–≤–ª—è—î—Ç—å—Å—è –≤—ñ–¥ —á—É—Ç–ª–∏–≤–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, —è–∫—ñ –ø—Ä–æ—Ü–µ—Å –º—ñ–≥ –±–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–∏—Ö–æ–¥—É –∑ —ñ–∑–æ–ª—è—Ü—ñ—ó**. –¶–µ —Å–ø—Ä–æ–±–∞ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ –ø—Ä–æ—Ü–µ—Å –Ω–µ –∑–º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥—ñ—ó —Ç–∞ –≤–∏—Ö–æ–¥–∏—Ç–∏:

{% content-ref url="../linux-capabilities.md" %}
[linux-capabilities.md](../linux-capabilities.md)
{% endcontent-ref %}

### Seccomp –≤ Docker

–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –±–µ–∑–ø–µ–∫–∏ –¥–æ–∑–≤–æ–ª—è—î Docker **–æ–±–º–µ–∂—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–∫–ª–∏–∫–∏**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

{% content-ref url="seccomp.md" %}
[seccomp.md](seccomp.md)
{% endcontent-ref %}

### AppArmor –≤ Docker

**AppArmor** - —Ü–µ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–¥—Ä–∞ –¥–ª—è –æ–±–º–µ–∂–µ–Ω–Ω—è **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤** –¥–æ **–æ–±–º–µ–∂–µ–Ω–æ–≥–æ** –Ω–∞–±–æ—Ä—É **—Ä–µ—Å—É—Ä—Å—ñ–≤** –∑ **–ø—Ä–æ—Ñ—ñ–ª—è–º–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏**:

{% content-ref url="apparmor.md" %}
[apparmor.md](apparmor.md)
{% endcontent-ref %}

### SELinux –≤ Docker

* **–°–∏—Å—Ç–µ–º–∞ –º—ñ—Ç–æ–∫**: SELinux –ø—Ä–∏—Å–≤–æ—é—î —É–Ω—ñ–∫–∞–ª—å–Ω—É –º—ñ—Ç–∫—É –∫–æ–∂–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ –æ–±'—î–∫—Ç—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏.
* **–ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–æ–ª—ñ—Ç–∏–∫–∏**: –í–æ–Ω–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –ø–æ–ª—ñ—Ç–∏–∫—É –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ –¥—ñ—ó –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –º—ñ—Ç–∫–∞ –ø—Ä–æ—Ü–µ—Å—É —â–æ–¥–æ —ñ–Ω—à–∏—Ö –º—ñ—Ç–æ–∫ —É —Å–∏—Å—Ç–µ–º—ñ.
* **–ú—ñ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—ñ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**: –ö–æ–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ñ –¥–≤–∏–≥—É–Ω–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—å –ø—Ä–æ—Ü–µ—Å–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —ó–º –∑–∞–∑–≤–∏—á–∞–π –ø—Ä–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –æ–±–º–µ–∂–µ–Ω–∞ –º—ñ—Ç–∫–∞ SELinux, –∑–∞–∑–≤–∏—á–∞–π `container_t`.
* **–ú—ñ—Ç–∫–∏ —Ñ–∞–π–ª—ñ–≤ —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö**: –§–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å –º—ñ—Ç–∫—É `container_file_t`.
* **–ü—Ä–∞–≤–∏–ª–∞ –ø–æ–ª—ñ—Ç–∏–∫–∏**: –ü–æ–ª—ñ—Ç–∏–∫–∞ SELinux –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –ø—Ä–æ—Ü–µ—Å–∏ –∑ –º—ñ—Ç–∫–æ—é `container_t` –º–æ–∂—É—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ (—á–∏—Ç–∞—Ç–∏, –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏, –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏) –ª–∏—à–µ –∑ —Ñ–∞–π–ª–∞–º–∏, —è–∫—ñ –º–∞—é—Ç—å –º—ñ—Ç–∫—É `container_file_t`.

–¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –ø—Ä–æ—Ü–µ—Å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π, –≤—ñ–Ω –æ–±–º–µ–∂–µ–Ω–∏–π –≤–∑–∞—î–º–æ–¥—ñ—î—é –ª–∏—à–µ –∑ –æ–±'—î–∫—Ç–∞–º–∏, —è–∫—ñ –º–∞—é—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –º—ñ—Ç–∫–∏, –∑–Ω–∞—á–Ω–æ –æ–±–º–µ–∂—É—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–≤–¥–∞–Ω–Ω—è —à–∫–æ–¥–∏ –≤—ñ–¥ —Ç–∞–∫–∏—Ö –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ–π.

{% content-ref url="../selinux.md" %}
[selinux.md](../selinux.md)
{% endcontent-ref %}

### AuthZ & AuthN

–£ Docker –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–∏–π –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥—ñ–≥—Ä–∞—î –≤–∞–∂–ª–∏–≤—É —Ä–æ–ª—å —É –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—ñ –±–µ–∑–ø–µ–∫–∏, –≤–∏—Ä—ñ—à—É—é—á–∏, —á–∏ —Å–ª—ñ–¥ –¥–æ–∑–≤–æ–ª—è—Ç–∏ —á–∏ –±–ª–æ–∫—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ –¥–µ–º–æ–Ω–∞ Docker. –¶–µ —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –∞–Ω–∞–ª—ñ–∑—É –¥–≤–æ—Ö –∫–ª—é—á–æ–≤–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ–≤:

* **–ö–æ–Ω—Ç–µ–∫—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**: –¶–µ –≤–∫–ª—é—á–∞—î –≤–∏—á–µ—Ä–ø–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–∞–∫—É —è–∫ —Ö—Ç–æ –≤–æ–Ω–∏ —ñ —è–∫ –≤–æ–Ω–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞–ª–∏ —Å–µ–±–µ.
* **–ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥–∏**: –¶–µ –≤–∫–ª—é—á–∞—î –≤—Å—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ –∑–∞–ø–∏—Ç–æ–º, —è–∫–∏–π —Ä–æ–±–∏—Ç—å—Å—è.

–¶—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∏ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –ª–∏—à–µ –∑–∞–∫–æ–Ω–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –±–µ–∑–ø–µ–∫—É –æ–ø–µ—Ä–∞—Ü—ñ–π Docker.

{% content-ref url="authz-and-authn-docker-access-authorization-plugin.md" %}
[authz-and-authn-docker-access-authorization-plugin.md](authz-and-authn-docker-access-authorization-plugin.md)
{% endcontent-ref %}

## DoS –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–Ø–∫—â–æ –≤–∏ –Ω–µ –æ–±–º–µ–∂—É—î—Ç–µ —Ä–µ—Å—É—Ä—Å–∏, —è–∫—ñ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ DoS –Ω–∞ —Ö–æ—Å—Ç—ñ, –¥–µ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î.

* CPU DoS
```bash
# stress-ng
sudo apt-get install -y stress-ng && stress-ng --vm 1 --vm-bytes 1G --verify -t 5m

# While loop
docker run -d --name malicious-container -c 512 busybox sh -c 'while true; do :; done'
```
* –í–∏—Ç—Ä–∞—Ç–∞ –ø—Ä–æ–ø—É—Å–∫–Ω–æ—ó –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ
```bash
nc -lvp 4444 >/dev/null & while true; do cat /dev/urandom | nc <target IP> 4444; done
```
## –¶—ñ–∫–∞–≤—ñ –ü—Ä–∞–ø–æ—Ä—Ü—ñ Docker

### –ü—Ä–∞–ø–æ—Ä–µ—Ü—å --privileged

–ù–∞ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, **—â–æ –æ–∑–Ω–∞—á–∞—î –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `--privileged`**:

{% content-ref url="docker-privileged.md" %}
[docker-privileged.md](docker-privileged.md)
{% endcontent-ref %}

### --security-opt

#### no-new-privileges

–Ø–∫—â–æ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–¥–æ–±—É–≤–∞—î –¥–æ—Å—Ç—É–ø —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏. –Ø–∫—â–æ —É –≤–∞—Å —î **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π suid –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –Ω–∏–º —ñ **–ø—ñ–¥–≤–∏—â—É–≤–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –¶–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –π–æ–º—É –≤—Ç–µ–∫—Ç–∏ –∑ –Ω—å–æ–≥–æ.

–ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑ —É–≤—ñ–º–∫–Ω–µ–Ω–æ—é –æ–ø—Ü—ñ—î—é **`no-new-privileges`** **–∑–∞–ø–æ–±—ñ–≥–∞—Ç–∏–º–µ —Ü—å–æ–º—É –≤–∏–¥—É –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**.
```
docker run -it --security-opt=no-new-privileges:true nonewpriv
```
#### –Ü–Ω—à–µ
```bash
#You can manually add/drop capabilities with
--cap-add
--cap-drop

# You can manually disable seccomp in docker with
--security-opt seccomp=unconfined

# You can manually disable seccomp in docker with
--security-opt apparmor=unconfined

# You can manually disable selinux in docker with
--security-opt label:disable
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ **`--security-opt`** –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ: [https://docs.docker.com/engine/reference/run/#security-configuration](https://docs.docker.com/engine/reference/run/#security-configuration)

## –Ü–Ω—à—ñ –∞—Å–ø–µ–∫—Ç–∏ –±–µ–∑–ø–µ–∫–∏

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏: –ù–∞–π–∫—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏

–í–∞–∂–ª–∏–≤–æ —É–Ω–∏–∫–∞—Ç–∏ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –æ–±—Ä–∞–∑–∏ Docker –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –º–µ—Ç–æ–¥–∏ –≤–∏–∫–ª–∞–¥–∞—é—Ç—å –≤–∞—à—É —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –±—É–¥—å-–∫–æ–º—É, —Ö—Ç–æ –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–∏, —Ç–∞–∫—ñ —è–∫ `docker inspect` –∞–±–æ `exec`.

**–¢–æ–º–∏ Docker** —î –±–µ–∑–ø–µ—á–Ω—ñ—à–æ—é –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ—é, —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ—é –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –á—Ö –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ —Ç–∏–º—á–∞—Å–æ–≤—É —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É –≤ –ø–∞–º'—è—Ç—ñ, —â–æ –∑–º–µ–Ω—à—É—î —Ä–∏–∑–∏–∫–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ `docker inspect` —Ç–∞ –∂—É—Ä–Ω–∞–ª—é–≤–∞–Ω–Ω—è–º. –û–¥–Ω–∞–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –ø—Ä–∞–≤–∞–º–∏ root —Ç–∞ —Ç—ñ, —É —è–∫–∏—Ö —î –¥–æ—Å—Ç—É–ø –¥–æ `exec` –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ, –≤—Å–µ —â–µ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ–∫—Ä–µ—Ç—ñ–≤.

**–°–µ–∫—Ä–µ—Ç–∏ Docker** –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —â–µ –±—ñ–ª—å—à –±–µ–∑–ø–µ—á–Ω–∏–π –º–µ—Ç–æ–¥ –æ–±—Ä–æ–±–∫–∏ —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –î–ª—è –≤–∏–ø–∞–¥–∫—ñ–≤, –∫–æ–ª–∏ —Å–µ–∫—Ä–µ—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—ñ–¥ —á–∞—Å —Ñ–∞–∑–∏ –ø–æ–±—É–¥–æ–≤–∏ –æ–±—Ä–∞–∑—É, **BuildKit** –ø—Ä–æ–ø–æ–Ω—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —Å–µ–∫—Ä–µ—Ç—ñ–≤ –Ω–∞ –µ—Ç–∞–ø—ñ –ø–æ–±—É–¥–æ–≤–∏, –ø–æ–∫—Ä–∞—â—É—é—á–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ –Ω–∞–¥–∞—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó.

–î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è BuildKit –π–æ–≥–æ –º–æ–∂–Ω–∞ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Ç—Ä—å–æ–º–∞ —Å–ø–æ—Å–æ–±–∞–º–∏:

1. –ß–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞: `export DOCKER_BUILDKIT=1`
2. –®–ª—è—Ö–æ–º –ø—Ä–µ—Ñ—ñ–∫—Å—É–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥: `DOCKER_BUILDKIT=1 docker build .`
3. –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Docker: `{ "features": { "buildkit": true } }`, –∑–∞ —è–∫–æ—é —Å–ª—ñ–¥—É—î –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Docker.

BuildKit –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –Ω–∞ –µ—Ç–∞–ø—ñ –ø–æ–±—É–¥–æ–≤–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `--secret`, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏, —â–æ —Ü—ñ —Å–µ–∫—Ä–µ—Ç–∏ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—å—Å—è –≤ –∫–µ—à –ø–æ–±—É–¥–æ–≤–∏ –æ–±—Ä–∞–∑—É –∞–±–æ –≤ –∫—ñ–Ω—Ü–µ–≤–∏–π –æ–±—Ä–∞–∑, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–∞–Ω–¥—É:
```bash
docker build --secret my_key=my_value ,src=path/to/my_secret_file .
```
–î–ª—è —Å–µ–∫—Ä–µ—Ç—ñ–≤, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —É –∑–∞–ø—É—â–µ–Ω–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ, **Docker Compose —Ç–∞ Kubernetes** –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å –Ω–∞–¥—ñ–π–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è. Docker Compose –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–ª—é—á `secrets` —É –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—ñ —Å–µ—Ä–≤—ñ—Å—É –¥–ª—è –≤–∫–∞–∑–∞–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ —É –ø—Ä–∏–∫–ª–∞–¥—ñ `docker-compose.yml`:
```yaml
version: "3.7"
services:
my_service:
image: centos:7
entrypoint: "cat /run/secrets/my_secret"
secrets:
- my_secret
secrets:
my_secret:
file: ./my_secret_file.txt
```
–¶—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É —Å–ª—É–∂–± –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Docker Compose.

–£ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö Kubernetes —Å–µ–∫—Ä–µ—Ç–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ —è–¥—Ä–∞ —ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –∫–µ—Ä–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ [Helm-Secrets](https://github.com/futuresimple/helm-secrets). –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª–µ–π (RBAC) Kubernetes –ø—ñ–¥–≤–∏—â—É—î –±–µ–∑–ø–µ–∫—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç–∞–º–∏, –ø–æ–¥—ñ–±–Ω–æ –¥–æ Docker Enterprise.

### gVisor

**gVisor** - —Ü–µ —è–¥—Ä–æ –¥–æ–¥–∞—Ç–∫—ñ–≤, –Ω–∞–ø–∏—Å–∞–Ω–µ –Ω–∞ –º–æ–≤—ñ Go, —è–∫–µ —Ä–µ–∞–ª—ñ–∑—É—î –∑–Ω–∞—á–Ω—É —á–∞—Å—Ç–∏–Ω—É –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ Linux. –í–æ–Ω–æ –≤–∫–ª—é—á–∞—î —Ä–∞–Ω—Ç–∞–π–º [Open Container Initiative (OCI)](https://www.opencontainers.org) –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `runsc`, —è–∫–∏–π –∑–∞–±–µ–∑–ø–µ—á—É—î **—ñ–∑–æ–ª—è—Ü—ñ–π–Ω—É –º–µ–∂—É –º—ñ–∂ –¥–æ–¥–∞—Ç–∫–æ–º —Ç–∞ —è–¥—Ä–æ–º —Ö–æ—Å—Ç–∞**. –†–∞–Ω—Ç–∞–π–º `runsc` —ñ–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –∑ Docker —Ç–∞ Kubernetes, —â–æ —Å–ø—Ä–æ—â—É—î –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ —É –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ.

{% embed url="https://github.com/google/gvisor" %}

### Kata Containers

**Kata Containers** - —Ü–µ –≤—ñ–¥–∫—Ä–∏—Ç–∞ —Å–ø—ñ–ª—å–Ω–æ—Ç–∞, —è–∫–∞ –ø—Ä–∞—Ü—é—î –Ω–∞–¥ –ø–æ–±—É–¥–æ–≤–æ—é –±–µ–∑–ø–µ—á–Ω–æ–≥–æ —Ä–∞–Ω—Ç–∞–π–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ –∑ –ª–µ–≥–∫–∏–º–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–º–∏ –º–∞—à–∏–Ω–∞–º–∏, —è–∫—ñ –≤—ñ–¥—á—É–≤–∞—é—Ç—å —Å–µ–±–µ —Ç–∞ –ø—Ä–∞—Ü—é—é—Ç—å —è–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, –∞–ª–µ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å **—Å–∏–ª—å–Ω—ñ—à—É —ñ–∑–æ–ª—è—Ü—ñ—é —Ä–æ–±–æ—á–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∞–ø–∞—Ä–∞—Ç–Ω–æ—ó –≤—ñ—Ä—Ç—É–∞–ª—ñ–∑–∞—Ü—ñ—ó** —è–∫ –¥—Ä—É–≥–æ–≥–æ —Ä—ñ–≤–Ω—è –∑–∞—Ö–∏—Å—Ç—É.

{% embed url="https://katacontainers.io/" %}

### –ü—ñ–¥—Å—É–º–∫–æ–≤—ñ –ø–æ—Ä–∞–¥–∏

* **–ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å `--privileged` –∞–±–æ –º–æ–Ω—Ç—É–≤–∞–Ω–Ω—è** [**—Å–æ–∫–µ—Ç—É Docker –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**](https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/)**.** –°–æ–∫–µ—Ç Docker –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, —Ç–æ–º—É —Ü–µ –ª–µ–≥–∫–∏–π —Å–ø–æ—Å—ñ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ö–æ—Å—Ç–æ–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ —ñ–Ω—à–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ –ø—Ä–∞–ø–æ—Ä—Ü–µ–º `--privileged`.
* **–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —è–∫ root –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ** [**—ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**](https://docs.docker.com/develop/develop-images/dockerfile\_best-practices/#user) **—Ç–∞** [**–ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**](https://docs.docker.com/engine/security/userns-remap/)**.** Root —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ —Ç–∞–∫–∏–π —Å–∞–º–∏–π, —è–∫ –Ω–∞ —Ö–æ—Å—Ç—ñ, —è–∫—â–æ –Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤. –í—ñ–Ω –æ–±–º–µ–∂—É—î—Ç—å—Å—è, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É, Linux –ø—Ä–æ—Å—Ç–æ—Ä–∞–º–∏ —ñ–º–µ–Ω, –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏ —Ç–∞ cgroups.
* [**–°–∫–∏–Ω—å—Ç–µ –≤—Å—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ**](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities) **(`--cap-drop=all`) —Ç–∞ –∞–∫—Ç–∏–≤—É–π—Ç–µ –ª–∏—à–µ —Ç—ñ, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ** (`--cap-add=...`). –ë–∞–≥–∞—Ç–æ —Ä–æ–±–æ—á–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –∂–æ–¥–Ω–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, –∞ —ó—Ö –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–±—ñ–ª—å—à—É—î –æ–±—Å—è–≥ –º–æ–∂–ª–∏–≤–æ–≥–æ –∞—Ç–∞–∫–∏.
* [**–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –±–µ–∑–ø–µ–∫–∏ ‚Äúno-new-privileges‚Äù**](https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/) –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å–∞–º –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —á–µ—Ä–µ–∑ suid-–±—ñ–Ω–∞—Ä–Ω–∏–∫–∏.
* [**–û–±–º–µ–∂—Ç–µ —Ä–µ—Å—É—Ä—Å–∏, –¥–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É**](https://docs.docker.com/engine/reference/run/#runtime-constraints-on-resources)**.** –û–±–º–µ–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –º–æ–∂–µ –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –º–∞—à–∏–Ω—É –≤—ñ–¥ –∞—Ç–∞–∫ –Ω–∞ –≤—ñ–¥–º–æ–≤—É –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ.
* **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ** [**seccomp**](https://docs.docker.com/engine/security/seccomp/)**,** [**AppArmor**](https://docs.docker.com/engine/security/apparmor/) **(–∞–±–æ SELinux)** –ø—Ä–æ—Ñ—ñ–ª—ñ –¥–ª—è –æ–±–º–µ–∂–µ–Ω–Ω—è –¥—ñ–π —Ç–∞ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤, –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –¥–æ –º—ñ–Ω—ñ–º—É–º—É, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ–≥–æ.
* **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ** [**–æ—Ñ—ñ—Ü—ñ–π–Ω—ñ –æ–±—Ä–∞–∑–∏ Docker**](https://docs.docker.com/docker-hub/official\_images/) **—Ç–∞ –≤–∏–º–∞–≥–∞–π—Ç–µ –ø—ñ–¥–ø–∏—Å—ñ–≤** –∞–±–æ —Å—Ç–≤–æ—Ä—é–π—Ç–µ –≤–ª–∞—Å–Ω—ñ –Ω–∞ —ó—Ö –æ—Å–Ω–æ–≤—ñ. –ù–µ —É—Å–ø–∞–¥–∫–æ–≤—É–π—Ç–µ –∞–±–æ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [–∑–∞—Ä–∞–∂–µ–Ω—ñ](https://arstechnica.com/information-technology/2018/06/backdoored-images-downloaded-5-million-times-finally-removed-from-docker-hub/) –æ–±—Ä–∞–∑–∏. –¢–∞–∫–æ–∂ –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ –∫–æ—Ä–µ–Ω–µ–≤—ñ –∫–ª—é—á—ñ, –ø–∞—Ä–æ–ª—å –Ω–∞ –±–µ–∑–ø–µ–∫–æ–≤–æ–º—É –º—ñ—Å—Ü—ñ. –£ Docker —î –ø–ª–∞–Ω–∏ –∫–µ—Ä—É–≤–∞—Ç–∏ –∫–ª—é—á–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é UCP.
* **–†–µ–≥—É–ª—è—Ä–Ω–æ** **–ø–µ—Ä–µ–±—É–¥–æ–≤—É–π—Ç–µ** —Å–≤–æ—ó –æ–±—Ä–∞–∑–∏, —â–æ–± **–∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ç—á—ñ –±–µ–∑–ø–µ–∫–∏ –¥–æ —Ö–æ—Å—Ç–∞ —Ç–∞ –æ–±—Ä–∞–∑—ñ–≤.**
* –†–æ–∑—É–º–Ω–æ **–∫–µ—Ä—É–π—Ç–µ —Å–≤–æ—ó–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏**, —â–æ–± –≤–∞–∂–∫–æ –±—É–ª–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ –Ω–∏—Ö –¥–æ—Å—Ç—É–ø.
* –Ø–∫—â–æ –≤–∏ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –¥–µ–º–æ–Ω Docker, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ HTTPS** –∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é –∫–ª—ñ—î–Ω—Ç–∞ —Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞.
* –£ —Å–≤–æ—î–º—É Dockerfile **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ COPY –∑–∞–º—ñ—Å—Ç—å ADD**. ADD –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø–∞–∫–æ–≤—É—î –∞—Ä—Ö—ñ–≤–Ω—ñ —Ñ–∞–π–ª–∏ —Ç–∞ –º–æ–∂–µ –∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –∑ URL-–∞–¥—Ä–µ—Å. COPY –Ω–µ –º–∞—î —Ü–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π. –ö–æ–ª–∏ —Ü–µ –º–æ–∂–ª–∏–≤–æ, —É–Ω–∏–∫–∞–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ADD, —â–æ–± –Ω–µ –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ –∞—Ç–∞–∫ —á–µ—Ä–µ–∑ –≤—ñ–¥–¥–∞–ª–µ–Ω—ñ URL-–∞–¥—Ä–µ—Å–∏ —Ç–∞ ZIP-—Ñ–∞–π–ª–∏.
* –ú–∞—î—Ç–µ **–æ–∫—Ä–µ–º—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –¥–ª—è –∫–æ–∂–Ω–æ—ó –º—ñ–∫—Ä–æ-—Å–ª—É–∂–±–∏**
* **–ù–µ –≤–∫–ª—é—á–∞–π—Ç–µ ssh** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, ‚Äúdocker exec‚Äù –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è ssh –¥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
* –ú–∞—î—Ç–µ **–º–µ–Ω—à—ñ** –æ–±—Ä–∞–∑–∏ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤**

## –í—Ç–µ—á–∞ –∑ Docker / –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤

–Ø–∫—â–æ –≤–∏ **–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ Docker** –∞–±–æ –º–∞—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ **–≥—Ä—É–ø—ñ docker**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–≤—Ç–µ—á—É —Ç–∞ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**:

{% content-ref url="docker-breakout-privilege-escalation/" %}
[docker-breakout-privilege-escalation](docker-breakout-privilege-escalation/)
{% endcontent-ref %}

## –û–±—Ö—ñ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó Docker Plugin

–Ø–∫—â–æ —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø –¥–æ —Å–æ–∫–µ—Ç—É Docker –∞–±–æ —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ **–≥—Ä—É–ø—ñ docker, –∞–ª–µ –≤–∞—à—ñ –¥—ñ—ó –æ–±–º–µ–∂—É—é—Ç—å—Å—è –ø–ª–∞–≥—ñ–Ω–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó Docker**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ **–π–æ–≥–æ –æ–±—ñ–π—Ç–∏:**

{% content-ref url="authz-and-authn-docker-access-authorization-plugin.md" %}
[authz-and-authn-docker-access-authorization-plugin.md](authz-and-authn-docker-access-authorization-plugin.md)
{% endcontent-ref %}

## –ó–∞—Ö–∏—Å—Ç Docker

* –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**docker-bench-security**](https://github.com/docker/docker-bench-security) - —Ü–µ —Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –ø–µ—Ä–µ–≤—ñ—Ä—è—î –¥–µ—Å—è—Ç–∫–∏ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –Ω–∞–π–∫—Ä–∞—â–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —â–æ–¥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤ Docker —É –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤—ñ. –¢–µ—Å—Ç–∏ —î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–º–∏ —ñ –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ [CIS Docker Benchmark v1.3.1](https://www.cisecurity.org/benchmark/docker/).\
–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑ —Ö–æ—Å—Ç–∞, –Ω–∞ —è–∫–æ–º—É –ø—Ä–∞—Ü—é—î Docker, –∞–±–æ –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑ –¥–æ—Å—Ç–∞—Ç–Ω—ñ–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏. –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è, **—è–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –π–æ–≥–æ –≤ README:** [**https://github.com/docker/docker-bench-security**](https://github.com/docker/docker-bench-security).

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/](https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/)
* [https://twitter.com/\_fel1x/status/1151487051986087936](https://twitter.com/\_fel1x/status/1151487051986087936)
* [https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html](https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-1overview/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-1overview/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-2docker-engine/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-2docker-engine/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-4container-image/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-4container-image/)
* [https://en.wikipedia.org/wiki/Linux\_namespaces](https://en.wikipedia.org/wiki/Linux\_namespaces)
* [https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57](https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57)
* [https://www.redhat.com/sysadmin/privileged-flag-container-engines](https://www.redhat.com/sysadmin/privileged-flag-container-engines)
* [https://docs.docker.com/engine/extend/plugins\_authorization](https://docs.docker.com/engine/extend/plugins\_authorization)
* [https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57](https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57)
* [https://resources.experfy.com/bigdata-cloud/top-20-docker-security-tips/](https://resources.experfy.com/bigdata-cloud/top-20-docker-security-tips/)

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security), —â–æ–± –ª–µ–≥–∫–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ä–æ–±–æ—á—ñ –ø—Ä–æ—Ü–µ—Å–∏** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–π–±—ñ–ª—å—à —Ä–æ–∑–≤–∏–Ω—É—Ç–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ —É —Å–≤—ñ—Ç—ñ.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

{% hint style="success" %}
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º AWS: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í–∏–≤—á–∞–π—Ç–µ —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –≤–∑–ª–æ–º GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**–ù–∞–≤—á–∞–Ω–Ω—è HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ—à–∏—Ä—é–π—Ç–µ —Ö–∞–∫–µ—Ä—Å—å–∫—ñ —Ç—Ä—é–∫–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
{% endhint %}
