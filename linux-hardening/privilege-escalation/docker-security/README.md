# Docker Security

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security) to easily build and **automate workflows** powered by the world's **most advanced** community tools.\
Get Access Today:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

## **Basic Docker Engine Security**

**Docker рдЗрдВрдЬрди** рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдХреЗ **Namespaces** рдФрд░ **Cgroups** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдПрдХ рдмреБрдирд┐рдпрд╛рджреА рдкрд░рдд рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред **Capabilities dropping**, **Seccomp**, рдФрд░ **SELinux/AppArmor** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдХрдВрдЯреЗрдирд░ рдЕрд▓рдЧрд╛рд╡ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред рдПрдХ **auth plugin** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

![Docker Security](https://sreeninet.files.wordpress.com/2016/03/dockersec1.png)

### Secure Access to Docker Engine

Docker рдЗрдВрдЬрди рдХреЛ рдпрд╛ рддреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдПрдХ Unix рд╕реЙрдХреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╛ HTTP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рджреВрд░рд╕реНрде рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП, рдЧреЛрдкрдиреАрдпрддрд╛, рдЕрдЦрдВрдбрддрд╛ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTPS рдФрд░ **TLS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

Docker рдЗрдВрдЬрди, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, `unix:///var/run/docker.sock` рдкрд░ Unix рд╕реЙрдХреЗрдЯ рдкрд░ рд╕реБрдирддрд╛ рд╣реИред рдЙрдмрдВрдЯреВ рд╕рд┐рд╕реНрдЯрдо рдкрд░, Docker рдХреЗ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╡рд┐рдХрд▓реНрдк `/etc/default/docker` рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред Docker API рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рджреВрд░рд╕реНрде рдкрд╣реБрдВрдЪ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, HTTP рд╕реЙрдХреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Docker рдбреЗрдорди рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдЬреЛрдбрд╝реЗрдВ:
```bash
DOCKER_OPTS="-D -H unix:///var/run/docker.sock -H tcp://192.168.56.101:2376"
sudo service docker restart
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Docker рдбреЗрдорди рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рдЪрд┐рдВрддрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рдЕрдиреБрд╢рдВрд╕рд┐рдд рдирд╣реАрдВ рд╣реИред рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЛ HTTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИред рдХрдиреЗрдХреНрд╢рди рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рдореБрдЦреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВ:

1. рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрд╡рд░ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИред
2. рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдПрдХ-рджреВрд╕рд░реЗ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЖрдкрд╕реА рдкреБрд╖реНрдЯрд┐ рдХрд░рддреЗ рд╣реИрдВред

рд╕рд░реНрд╡рд░ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рджреЛрдиреЛрдВ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд╡рд┐рд╕реНрддреГрдд рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП, [**рдЗрд╕ рдЧрд╛рдЗрдб**](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/) рдХреЛ рджреЗрдЦреЗрдВред

### рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛

рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдирд┐рдЬреА рдпрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рднрдВрдбрд╛рд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Docker рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрдИ рднрдВрдбрд╛рд░рдг рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* [**Docker Hub**](https://hub.docker.com): Docker рд╕реЗ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗрд╡рд╛ред
* [**Docker Registry**](https://github.com/docker/distribution): рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдкрдиреА рдЦреБрдж рдХреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣реЛрд╕реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* [**Docker Trusted Registry**](https://www.docker.com/docker-trusted-registry): Docker рдХрд╛ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкреНрд░рд╕реНрддрд╛рд╡, рдЬрд┐рд╕рдореЗрдВ рднреВрдорд┐рдХрд╛-рдЖрдзрд╛рд░рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ LDAP рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИред

### рдЫрд╡рд┐ рд╕реНрдХреИрдирд┐рдВрдЧ

рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ **рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпрд╛рдБ** рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рддреЛ рдЖрдзрд╛рд░ рдЫрд╡рд┐ рдХреЗ рдХрд╛рд░рдг рдпрд╛ рдЖрдзрд╛рд░ рдЫрд╡рд┐ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рдХрд╛рд░рдгред Docker рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕реЗ **Nautilus** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рддрд╛ рд╣реИред Nautilus рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐ рдкрд░рдд рдХреА рддреБрд▓рдирд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рднрдВрдбрд╛рд░ рд╕реЗ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдЫрд┐рджреНрд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗред

рдЕрдзрд┐рдХ [**рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдкрдврд╝реЗрдВ**](https://docs.docker.com/engine/scan/)ред

* **`docker scan`**

**`docker scan`** рдХрдорд╛рдВрдб рдЖрдкрдХреЛ рдЫрд╡рд┐ рдирд╛рдо рдпрд╛ ID рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореМрдЬреВрджрд╛ Docker рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, hello-world рдЫрд╡рд┐ рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдБ:
```bash
docker scan hello-world

Testing hello-world...

Organization:      docker-desktop-test
Package manager:   linux
Project name:      docker-image|hello-world
Docker image:      hello-world
Licenses:          enabled

тЬУ Tested 0 dependencies for known issues, no vulnerable paths found.

Note that we do not currently have vulnerability data for your image.
```
* [**`trivy`**](https://github.com/aquasecurity/trivy)
```bash
trivy -q -f json <container_name>:<tag>
```
* [**`snyk`**](https://docs.snyk.io/snyk-cli/getting-started-with-the-cli)
```bash
snyk container test <image> --json-file-output=<output file> --severity-threshold=high
```
* [**`clair-scanner`**](https://github.com/arminc/clair-scanner)
```bash
clair-scanner -w example-alpine.yaml --ip YOUR_LOCAL_IP alpine:3.5
```
### Docker Image Signing

Docker рдЗрдореЗрдЬ рд╕рд╛рдЗрдирд┐рдВрдЧ рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЗрдореЗрдЬреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИ:

* **Docker Content Trust** Notary рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ The Update Framework (TUF) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЗрдореЗрдЬ рд╕рд╛рдЗрдирд┐рдВрдЧ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рджреЗрдЦреЗрдВ [Notary](https://github.com/docker/notary) рдФрд░ [TUF](https://theupdateframework.github.io)ред
* Docker рдХрдВрдЯреЗрдВрдЯ рдЯреНрд░рд╕реНрдЯ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реЗрдЯ рдХрд░реЗрдВ `export DOCKER_CONTENT_TRUST=1`ред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ Docker рд╕рдВрд╕реНрдХрд░рдг 1.10 рдФрд░ рдмрд╛рдж рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдмрдВрдж рд╣реИред
* рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде, рдХреЗрд╡рд▓ рд╕рд╛рдЗрди рдХреА рдЧрдИ рдЗрдореЗрдЬреЛрдВ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЗрдореЗрдЬ рдкреБрд╢ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рдФрд░ рдЯреИрдЧрд┐рдВрдЧ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рдлрд╝реНрд░реЗрдЬрд╝ рд╕реЗрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, Docker Yubikey рдХреЛ рднреА рдмреЗрд╣рддрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг [рдпрд╣рд╛рдБ](https://blog.docker.com/2015/11/docker-content-trust-yubikey/) рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред
* рдХрдВрдЯреЗрдВрдЯ рдЯреНрд░рд╕реНрдЯ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдкрд░ рдПрдХ рдЕрд╕рд╛рдЗрди рдХреА рдЧрдИ рдЗрдореЗрдЬ рдХреЛ рдЦреАрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдкрд░ "No trust data for latest" рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИред
* рдкрд╣рд▓реЗ рдХреЗ рдмрд╛рдж рдЗрдореЗрдЬ рдкреБрд╢ рдХреЗ рд▓рд┐рдП, Docker рдЗрдореЗрдЬ рдХреЛ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреБрдВрдЬреА рдХреЗ рдкрд╛рд╕рдлрд╝реНрд░реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИред

рдЕрдкрдиреЗ рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдмреИрдХрдЕрдк рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП, рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```bash
tar -zcvf private_keys_backup.tar.gz ~/.docker/trust/private
```
рдЬрдм рдбреЙрдХрд░ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрд╡рд┐рдЪ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрдЪрд╛рд▓рди рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рдФрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

***

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдпрд╛ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

## рдХрдВрдЯреЗрдирд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

<details>

<summary>рдХрдВрдЯреЗрдирд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢</summary>

**рдореБрдЦреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреГрдердХреНрдХрд░рдг рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ**

рдХрдВрдЯреЗрдирд░рд╛рдЗрдЬреНрдб рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдФрд░ рдЙрдирдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдЕрддреНрдпрдВрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдпрд╣рд╛рдБ рдкреНрд░рдореБрдЦ рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХрд╛ рдПрдХ рд╕рд░рд▓ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рд╣реИ:

**рдиреЗрдорд╕реНрдкреЗрд╕**

* **рдЙрджреНрджреЗрд╢реНрдп**: рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЬреИрд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдкреГрдердХреНрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдбреЙрдХрд░ рдореЗрдВ, рдиреЗрдорд╕реНрдкреЗрд╕ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╣реЛрд╕реНрдЯ рдФрд░ рдЕрдиреНрдп рдХрдВрдЯреЗрдирд░реЛрдВ рд╕реЗ рдЕрд▓рдЧ рд░рдЦрддреЗ рд╣реИрдВред
* **`unshare` рдХрд╛ рдЙрдкрдпреЛрдЧ**: `unshare` рдХрдорд╛рдВрдб (рдпрд╛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд syscall) рдХрд╛ рдЙрдкрдпреЛрдЧ рдирдП рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдкреГрдердХреНрдХрд░рдг рдХреА рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкрд░рдд рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЬрдмрдХрд┐ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдЕрд╡рд░реБрджреНрдз рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдбреЙрдХрд░ рдРрд╕рд╛ рдХрд░рддрд╛ рд╣реИред
* **рд╕реАрдорд╛**: рдирдП рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рдиреЗ рд╕реЗ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╣реЛрд╕реНрдЯ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдорд┐рд▓рддреА рд╣реИред рд╣реЛрд╕реНрдЯ рдХреЗ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдорддреМрд░ рдкрд░ рд╣реЛрд╕реНрдЯ рдХреЗ `/proc` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рддрдХ рдкрд╣реБрдБрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдкреНрд░рд╡реЗрд╢ рдХреЗ рд▓рд┐рдП `nsenter` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред

**рдХрдВрдЯреНрд░реЛрд▓ рдЧреНрд░реБрдкреНрд╕ (CGroups)**

* **рдХрд╛рд░реНрдп**: рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмреАрдЪ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╕реБрд░рдХреНрд╖рд╛ рдкрд╣рд▓реВ**: CGroups рд╕реНрд╡рдпрдВ рдкреГрдердХреНрдХрд░рдг рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд╕рд┐рд╡рд╛рдп `release_agent` рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ, рдЬреЛ рдпрджрд┐ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рд╣реЛ, рддреЛ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╢реЛрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред

**рдХреНрд╖рдорддрд╛ рдбреНрд░реЙрдк**

* **рдорд╣рддреНрд╡**: рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреГрдердХреНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИред
* **рдХрд╛рд░реНрдпрд╛рддреНрдордХрддрд╛**: рдпрд╣ рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреБрдЫ рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдбреНрд░реЙрдк рдХрд░рдХреЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рднрд▓реЗ рд╣реА рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реЛ, рдЖрд╡рд╢реНрдпрдХ рдХреНрд╖рдорддрд╛рдУрдВ рдХреА рдХрдореА рдЗрд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ syscalls рдЕрдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред

рдпреЗ рд╣реИрдВ **рдмрдЪреА рд╣реБрдИ рдХреНрд╖рдорддрд╛рдПрдБ** рдЬрдм рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдиреНрдп рдХреЛ рдбреНрд░реЙрдк рдХрд░рддреА рд╣реИ:

{% code overflow="wrap" %}
```
Current: cap_chown,cap_dac_override,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_net_bind_service,cap_net_raw,cap_sys_chroot,cap_mknod,cap_audit_write,cap_setfcap=ep
```
{% endcode %}

**Seccomp**

рдпрд╣ рдбреЙрдХрд░ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рд╣реИред рдпрд╣ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ syscalls рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред**\
**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдбреЙрдХрд░ рд╕реЗрдХреЙрдореНрдк рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** [https://github.com/moby/moby/blob/master/profiles/seccomp/default.json](https://github.com/moby/moby/blob/master/profiles/seccomp/default.json) рдкрд░ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред

**AppArmor**

рдбреЙрдХрд░ рдХреЗ рдкрд╛рд╕ рдПрдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/moby/moby/tree/master/profiles/apparmor](https://github.com/moby/moby/tree/master/profiles/apparmor)

рдпрд╣ рдХреНрд╖рдорддрд╛рдУрдВ, syscalls, рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛...

</details>

### Namespaces

**Namespaces** рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ **рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреА рд╣реИ** рддрд╛рдХрд┐ рдПрдХ рд╕реЗрдЯ рдХреЗ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдПрдХ рд╕реЗрдЯ рдХреЗ **рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреЛ **рджреЗрдЦреЗрдВ** рдЬрдмрдХрд┐ **рджреВрд╕рд░рд╛** рд╕реЗрдЯ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдПрдХ **рдЕрд▓рдЧ** рд╕реЗрдЯ рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рджреЗрдЦрддреА рд╣реИрдВред рдпрд╣ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдПрдХ рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди namespace рд╣реЛрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрд╛рдо рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЙрди namespaces рдХрд╛ рд╕рдВрджрд░реНрдн рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдУрд░ рд╣реЛрддрд╛ рд╣реИред рд╕рдВрд╕рд╛рдзрди рдХрдИ рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдЕрд▓рдЧрд╛рд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ namespaces рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* pid namespace
* mount namespace
* network namespace
* ipc namespace
* UTS namespace

**Namespaces рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рджреЗрдЦреЗрдВ:

{% content-ref url="namespaces/" %}
[namespaces](namespaces/)
{% endcontent-ref %}

### cgroups

рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ **cgroups** рдПрдХ рд╕реЗрдЯ рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмреАрдЪ **cpu, memory, io, network bandwidth рдЬреИрд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред** рдбреЙрдХрд░ cgroup рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП рд╕рдВрд╕рд╛рдзрди рдирд┐рдпрдВрддреНрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХ рдХрдВрдЯреЗрдирд░ рд╣реИ рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд╛рди рдореЗрдореЛрд░реА рдХреЛ 500m, рдХрд░реНрдиреЗрд▓ рдореЗрдореЛрд░реА рдХреЛ 50m, cpu рд╢реЗрдпрд░ рдХреЛ 512, blkioweight рдХреЛ 400 рдкрд░ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред CPU рд╢реЗрдпрд░ рдПрдХ рдЕрдиреБрдкрд╛рдд рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдХреЗ CPU рдЙрдкрдпреЛрдЧ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди 1024 рд╣реИ рдФрд░ рдпрд╣ 0 рд╕реЗ 1024 рдХреЗ рдмреАрдЪ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рддреАрди рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ CPU рд╢реЗрдпрд░ 1024 рд╣реИ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ CPU рд╕рдВрд╕рд╛рдзрди рд╡рд┐рд╡рд╛рдж рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ CPU рдХрд╛ 33% рддрдХ рд▓реЗ рд╕рдХрддрд╛ рд╣реИред blkio-weight рдПрдХ рдЕрдиреБрдкрд╛рдд рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдХреЗ IO рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди 500 рд╣реИ рдФрд░ рдпрд╣ 10 рд╕реЗ 1000 рдХреЗ рдмреАрдЪ рд╣реЛрддрд╛ рд╣реИред
```
docker run -it -m 500M --kernel-memory 50M --cpu-shares 512 --blkio-weight 400 --name ubuntu1 ubuntu bash
```
рдХрд┐рд╕реА рдХрдВрдЯреЗрдирд░ рдХрд╛ cgroup рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
docker run -dt --rm denial sleep 1234 #Run a large sleep inside a Debian container
ps -ef | grep 1234 #Get info about the sleep process
ls -l /proc/<PID>/ns #Get the Group and the namespaces (some may be uniq to the hosts and some may be shred with it)
```
For more information check:

{% content-ref url="cgroups.md" %}
[cgroups.md](cgroups.md)
{% endcontent-ref %}

### Capabilities

Capabilities allow **root рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдордд рдХреНрд╖рдорддрд╛рдУрдВ рдкрд░ рдЕрдзрд┐рдХ рдирд┐рдпрдВрддреНрд░рдг**ред Docker Linux kernel capability feature рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ **рдЬрд┐рд╕рд╕реЗ Container рдХреЗ рдЕрдВрджрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**, рдЪрд╛рд╣реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкреНрд░рдХрд╛рд░ рдХреЛрдИ рднреА рд╣реЛред

рдЬрдм рдПрдХ docker container рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрддреА рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрд▓рдЧрд╛рд╡ рд╕реЗ рднрд╛рдЧрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреА рд╣реИ**ред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░рдиреЗ рдФрд░ рднрд╛рдЧрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рди рд╣реЛ:

{% content-ref url="../linux-capabilities.md" %}
[linux-capabilities.md](../linux-capabilities.md)
{% endcontent-ref %}

### Seccomp in Docker

рдпрд╣ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ Docker рдХреЛ **syscalls рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

{% content-ref url="seccomp.md" %}
[seccomp.md](seccomp.md)
{% endcontent-ref %}

### AppArmor in Docker

**AppArmor** рдПрдХ kernel enhancement рд╣реИ рдЬреЛ **containers** рдХреЛ **рд╕реАрдорд┐рдд** рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ **рдПрдХ рд╕реАрдорд┐рдд** рд╕реЗрдЯ рдореЗрдВ **рдкреНрд░рддрд┐-рдХрд╛рд░реНрдпрдХреНрд░рдо рдкреНрд░реЛрдлрд╛рдЗрд▓** рдХреЗ рд╕рд╛рде рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред:

{% content-ref url="apparmor.md" %}
[apparmor.md](apparmor.md)
{% endcontent-ref %}

### SELinux in Docker

* **рд▓реЗрдмрд▓рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо**: SELinux рд╣рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдФрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рд▓реЗрдмрд▓ рдЕрд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИред
* **рдиреАрддрд┐ рдкреНрд░рд╡рд░реНрддрди**: рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд▓реЗрдмрд▓ рдЕрдиреНрдп рд▓реЗрдмрд▓ рдкрд░ рдХреНрдпрд╛ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреА рд╣реИред
* **рдХрдВрдЯреЗрдирд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд▓реЗрдмрд▓**: рдЬрдм рдХрдВрдЯреЗрдирд░ рдЗрдВрдЬрди рдХрдВрдЯреЗрдирд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЖрд░рдВрдн рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╕реАрдорд┐рдд SELinux рд▓реЗрдмрд▓, рд╕рд╛рдорд╛рдиреНрдпрддрдГ `container_t` рдЕрд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рднреАрддрд░ рдлрд╝рд╛рдЗрд▓ рд▓реЗрдмрд▓рд┐рдВрдЧ**: рдХрдВрдЯреЗрдирд░ рдХреЗ рднреАрддрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЖрдорддреМрд░ рдкрд░ `container_file_t` рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрдмрд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВред
* **рдиреАрддрд┐ рдирд┐рдпрдо**: SELinux рдиреАрддрд┐ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ `container_t` рд▓реЗрдмрд▓ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреЗрд╡рд▓ `container_file_t` рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрдмрд▓ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд╕рдХрддреА рд╣реИрдВ (рдкрдврд╝рдирд╛, рд▓рд┐рдЦрдирд╛, рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛)ред

рдпрд╣ рддрдВрддреНрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдХрдВрдЯреЗрдирд░ рдХреЗ рднреАрддрд░ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреЗрд╡рд▓ рдЙрди рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рддрдХ рд╕реАрдорд┐рдд рд╣реИ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рд╕рдВрдмрдВрдзрд┐рдд рд▓реЗрдмрд▓ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдРрд╕реЗ рд╕рдордЭреМрддреЛрдВ рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рдиреБрдХрд╕рд╛рди рдХреЛ рдХрд╛рдлреА рд╣рдж рддрдХ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% content-ref url="../selinux.md" %}
[selinux.md](../selinux.md)
{% endcontent-ref %}

### AuthZ & AuthN

Docker рдореЗрдВ, рдПрдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд▓рдЧрдЗрди рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИ рдпрд╣ рддрдп рдХрд░рддреЗ рд╣реБрдП рдХрд┐ Docker daemon рдХреЛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдП рдпрд╛ рдмреНрд▓реЙрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдпрд╣ рдирд┐рд░реНрдгрдп рджреЛ рдкреНрд░рдореБрдЦ рд╕рдВрджрд░реНрднреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

* **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдВрджрд░реНрдн**: рдЗрд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡реНрдпрд╛рдкрдХ рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд╡реЗ рдХреМрди рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЦреБрдж рдХреЛ рдХреИрд╕реЗ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд┐рдпрд╛ рд╣реИред
* **рдХрдорд╛рдВрдб рд╕рдВрджрд░реНрдн**: рдЗрд╕рдореЗрдВ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред

рдпреЗ рд╕рдВрджрд░реНрдн рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреЗрд╡рд▓ рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рд╡реИрдз рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЬрд┐рд╕рд╕реЗ Docker рд╕рдВрдЪрд╛рд▓рди рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рддреА рд╣реИред

{% content-ref url="authz-and-authn-docker-access-authorization-plugin.md" %}
[authz-and-authn-docker-access-authorization-plugin.md](authz-and-authn-docker-access-authorization-plugin.md)
{% endcontent-ref %}

## DoS from a container

рдпрджрд┐ рдЖрдк рдПрдХ рдХрдВрдЯреЗрдирд░ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдареАрдХ рд╕реЗ рд╕реАрдорд┐рдд рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдПрдХ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрдВрдЯреЗрдирд░ рдЙрд╕ рд╣реЛрд╕реНрдЯ рдХреЛ DoS рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдпрд╣ рдЪрд▓ рд░рд╣рд╛ рд╣реИред

* CPU DoS
```bash
# stress-ng
sudo apt-get install -y stress-ng && stress-ng --vm 1 --vm-bytes 1G --verify -t 5m

# While loop
docker run -d --name malicious-container -c 512 busybox sh -c 'while true; do :; done'
```
* рдмреИрдВрдбрд╡рд┐рдбреНрде DoS
```bash
nc -lvp 4444 >/dev/null & while true; do cat /dev/urandom | nc <target IP> 4444; done
```
## рджрд┐рд▓рдЪрд╕реНрдк Docker рдлреНрд▓реИрдЧ

### --privileged рдлреНрд▓реИрдЧ

рдЕрдЧрд▓реА рдкреГрд╖реНрда рдкрд░ рдЖрдк **`--privileged` рдлреНрд▓реИрдЧ рдХрд╛ рдХреНрдпрд╛ рдЕрд░реНрде рд╣реИ** рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="docker-privileged.md" %}
[docker-privileged.md](docker-privileged.md)
{% endcontent-ref %}

### --security-opt

#### no-new-privileges

рдпрджрд┐ рдЖрдк рдПрдХ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛ рд░рд╣реЗ рд╣реИрдВ рдЬрд╣рд╛рдБ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдирд┐рдореНрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ suid рдмрд╛рдЗрдирд░реА** рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЬрд┐рд╕рд╕реЗ, рд╡рд╣ рдЗрд╕рд╕реЗ рднрд╛рдЧрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

**`no-new-privileges`** рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдиреЗ рд╕реЗ **рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ рдХреЛ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗрдЧрд╛**ред
```
docker run -it --security-opt=no-new-privileges:true nonewpriv
```
#### рдЕрдиреНрдп
```bash
#You can manually add/drop capabilities with
--cap-add
--cap-drop

# You can manually disable seccomp in docker with
--security-opt seccomp=unconfined

# You can manually disable seccomp in docker with
--security-opt apparmor=unconfined

# You can manually disable selinux in docker with
--security-opt label:disable
```
For more **`--security-opt`** options check: [https://docs.docker.com/engine/reference/run/#security-configuration](https://docs.docker.com/engine/reference/run/#security-configuration)

## рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдЪрд╛рд░

### рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди: рд╕рд░реНрд╡реЛрддреНрддрдо рдкреНрд░рдерд╛рдПрдБ

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рд╕реАрдзреЗ Docker рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рдпрд╛ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рд╕реЗ рдмрдЪреЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпреЗ рддрд░реАрдХреЗ рдЖрдкрдХреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ `docker inspect` рдпрд╛ `exec` рдЬреИрд╕реЗ рдХрдорд╛рдВрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдЯреЗрдирд░ рддрдХ рдкрд╣реБрдБрдЪ рд░рдЦрддрд╛ рд╣реИред

**Docker рд╡реЙрд▓реНрдпреВрдо** рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрдиреНрд╣реЗрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд░реВрдк рдореЗрдВ рдореЗрдореЛрд░реА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ `docker inspect` рдФрд░ рд▓реЙрдЧрд┐рдВрдЧ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЬреЛрдЦрд┐рдореЛрдВ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐, рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдХрдВрдЯреЗрдирд░ рддрдХ `exec` рдкрд╣реБрдБрдЪ рд╣реИ, рд╡реЗ рдЕрднреА рднреА рд░рд╣рд╕реНрдпреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред

**Docker рд░рд╣рд╕реНрдп** рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдЙрди рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд┐рдиреНрд╣реЗрдВ рдЫрд╡рд┐ рдирд┐рд░реНрдорд╛рдг рдЪрд░рдг рдХреЗ рджреМрд░рд╛рди рд░рд╣рд╕реНрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, **BuildKit** рдПрдХ рдХреБрд╢рд▓ рд╕рдорд╛рдзрд╛рди рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдирд┐рд░реНрдорд╛рдг-рд╕рдордп рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдирд┐рд░реНрдорд╛рдг рдЧрддрд┐ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

BuildKit рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рддреАрди рддрд░реАрдХреЛрдВ рд╕реЗ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

1. рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ: `export DOCKER_BUILDKIT=1`
2. рдХрдорд╛рдВрдб рдХреЛ рдкреВрд░реНрд╡рд╡рд░реНрддреА рдХрд░рдХреЗ: `DOCKER_BUILDKIT=1 docker build .`
3. Docker рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рдХрд░рдХреЗ: `{ "features": { "buildkit": true } }`, рдЗрд╕рдХреЗ рдмрд╛рдж Docker рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред

BuildKit `--secret` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдирд┐рд░реНрдорд╛рдг-рд╕рдордп рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдпреЗ рд░рд╣рд╕реНрдп рдЫрд╡рд┐ рдирд┐рд░реНрдорд╛рдг рдХреИрд╢ рдпрд╛ рдЕрдВрддрд┐рдо рдЫрд╡рд┐ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐:
```bash
docker build --secret my_key=my_value ,src=path/to/my_secret_file .
```
рд░рдирд┐рдВрдЧ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, **Docker Compose рдФрд░ Kubernetes** рдордЬрдмреВрдд рд╕рдорд╛рдзрд╛рди рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред Docker Compose рд╕реЗрд╡рд╛ рдкрд░рд┐рднрд╛рд╖рд╛ рдореЗрдВ рд░рд╣рд╕реНрдпреЛрдВ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `secrets` рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ `docker-compose.yml` рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```yaml
version: "3.7"
services:
my_service:
image: centos:7
entrypoint: "cat /run/secrets/my_secret"
secrets:
- my_secret
secrets:
my_secret:
file: ./my_secret_file.txt
```
рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди Docker Compose рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдПрдБ рд╢реБрд░реВ рдХрд░рддреЗ рд╕рдордп рд░рд╣рд╕реНрдпреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

Kubernetes рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ, рд░рд╣рд╕реНрдп рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рд╕рдорд░реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ [Helm-Secrets](https://github.com/futuresimple/helm-secrets) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред Kubernetes рдХреА рднреВрдорд┐рдХрд╛ рдЖрдзрд╛рд░рд┐рдд рдкрд╣реБрдБрдЪ рдирд┐рдпрдВрддреНрд░рдг (RBAC) рд░рд╣рд╕реНрдп рдкреНрд░рдмрдВрдзрди рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, рдЬреЛ Docker Enterprise рдХреЗ рд╕рдорд╛рди рд╣реИред

### gVisor

**gVisor** рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд░реНрдиреЗрд▓ рд╣реИ, рдЬреЛ Go рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ Linux рд╕рд┐рд╕реНрдЯрдо рд╕рддрд╣ рдХреЗ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдПрдХ [Open Container Initiative (OCI)](https://www.opencontainers.org) рд░рдирдЯрд╛рдЗрдо рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕реЗ `runsc` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рд╣реЛрд╕реНрдЯ рдХрд░реНрдиреЗрд▓ рдХреЗ рдмреАрдЪ рдПрдХ рдЕрд▓рдЧрд╛рд╡ рд╕реАрдорд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред `runsc` рд░рдирдЯрд╛рдЗрдо Docker рдФрд░ Kubernetes рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХрд┐рдП рдЧрдП рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рдЪрд▓рд╛рдирд╛ рд╕рд░рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

{% embed url="https://github.com/google/gvisor" %}

### Kata Containers

**Kata Containers** рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рд╕рдореБрджрд╛рдп рд╣реИ рдЬреЛ рд╣рд▓реНрдХреЗ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрдиреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рддрд░рд╣ рдорд╣рд╕реВрд╕ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди **рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬреЗрд╢рди** рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдордЬрдмреВрдд рдХрд╛рд░реНрдпрднрд╛рд░ рдЕрд▓рдЧрд╛рд╡** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

{% embed url="https://katacontainers.io/" %}

### рд╕рд╛рд░рд╛рдВрд╢ рдЯрд┐рдкреНрд╕

* **`--privileged` рдзреНрд╡рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ рдпрд╛** [**рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ Docker рд╕реЙрдХреЗрдЯ рдорд╛рдЙрдВрдЯ рди рдХрд░реЗрдВ**](https://raesene.github.io/blog/2016/03/06/The-Dangers-Of-Docker.sock/)**ред** Docker рд╕реЙрдХреЗрдЯ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рд╕реНрдкреЙрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╣реЛрд╕реНрдЯ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `--privileged` рдзреНрд╡рдЬ рдХреЗ рд╕рд╛рде рдПрдХ рдФрд░ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдХрд░ред
* **рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рди рдЪрд▓рд╛рдПрдБред рдПрдХ** [**рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛**](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#user) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░** [**рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдорд╕реНрдерд╛рди**](https://docs.docker.com/engine/security/userns-remap/)**ред** рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд░реВрдЯ рд╡рд╣реА рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рд╣реЛрд╕реНрдЯ рдкрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдЗрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдорд╕реНрдерд╛рди рдХреЗ рд╕рд╛рде рдкреБрдирдГ рдореИрдк рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ред рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ Linux рдирд╛рдорд╕реНрдерд╛рди, рдХреНрд╖рдорддрд╛рдУрдВ рдФрд░ cgroups рджреНрд╡рд╛рд░рд╛ рд╣рд▓реНрдХреЗ рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИред
* [**рд╕рднреА рдХреНрд╖рдорддрд╛рдПрдБ рд╣рдЯрд╛ рджреЗрдВ**](https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities) **(`--cap-drop=all`) рдФрд░ рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рдХреНрд╖рдорддрд╛рдПрдБ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ** (`--cap-add=...`)ред рдХрдИ рдХрд╛рд░реНрдпрднрд╛рд░ рдХреЛ рдХрд┐рд╕реА рднреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓реЗ рдХрд╛ рджрд╛рдпрд░рд╛ рдмрдврд╝ рдЬрд╛рддрд╛ рд╣реИред
* [**тАЬno-new-privilegesтАЭ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ**](https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/) рддрд╛рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рди рдХрд░ рд╕рдХреЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, suid рдмрд╛рдЗрдирд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред
* [**рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реАрдорд┐рдд рдХрд░реЗрдВ**](https://docs.docker.com/engine/reference/run/#runtime-constraints-on-resources)**ред** рд╕рдВрд╕рд╛рдзрди рд╕реАрдорд╛рдПрдБ рдорд╢реАрди рдХреЛ рд╕реЗрд╡рд╛ рд╕реЗ рдЗрдирдХрд╛рд░ рдХреЗ рд╣рдорд▓реЛрдВ рд╕реЗ рдмрдЪрд╛ рд╕рдХрддреА рд╣реИрдВред
* **seccomp** [**рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ**](https://docs.docker.com/engine/security/seccomp/)**,** [**AppArmor**](https://docs.docker.com/engine/security/apparmor/) **(рдпрд╛ SELinux)** рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЛ рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдиреНрдпреВрдирддрдо рдХреНрд░рд┐рдпрд╛рдУрдВ рдФрд░ syscalls рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* **рдЖрдзрд┐рдХрд╛рд░рд┐рдХ Docker рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** [**рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд░реЗрдВ**](https://docs.docker.com/docker-hub/official_images/) рдпрд╛ рдЙрдирдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдкрдиреА рдЦреБрдж рдХреА рдмрдирд╛рдПрдВред [рдмреИрдХрдбреЛрд░](https://arstechnica.com/information-technology/2018/06/backdoored-images-downloaded-5-million-times-finally-removed-from-docker-hub/) рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рди рд▓реЗрдВ рдпрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред рд░реВрдЯ рдХреБрдВрдЬреА, рдкрд╛рд╕рдлрд╝реНрд░реЗрдЬрд╝ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдкрд░ рднреА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВред Docker рдХреА UCP рдХреЗ рд╕рд╛рде рдХреБрдВрдЬреА рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛рдПрдБ рд╣реИрдВред
* **рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ** **рдЕрдкрдиреА рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рдмрдирд╛рдПрдВ рддрд╛рдХрд┐** **рд╣реЛрд╕реНрдЯ рдФрд░ рдЫрд╡рд┐рдпреЛрдВ рдкрд░ рд╕реБрд░рдХреНрд╖рд╛ рдкреИрдЪ рд▓рд╛рдЧреВ рд╣реЛ рд╕рдХреЗрдВред**
* рдЕрдкрдиреЗ **рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдмреБрджреНрдзрд┐рдорд╛рдиреА рд╕реЗ рдкреНрд░рдмрдВрдзрди рдХрд░реЗрдВ** рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░рдирд╛ рдХрдард┐рди рд╣реЛред
* рдпрджрд┐ рдЖрдк **Docker рдбреЗрдорди рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рддреЛ HTTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд╕рд╛рдеред
* рдЕрдкрдиреЗ Dockerfile рдореЗрдВ, **ADD рдХреЗ рдмрдЬрд╛рдп COPY рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВ**ред ADD рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ рдФрд░ URLs рд╕реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдХреЙрдкреА рдХрд░ рд╕рдХрддрд╛ рд╣реИред COPY рдореЗрдВ рдпреЗ рдХреНрд╖рдорддрд╛рдПрдБ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВред рдЬрдм рднреА рд╕рдВрднрд╡ рд╣реЛ, ADD рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдмрдЪреЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреВрд░рд╕реНрде URLs рдФрд░ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рди рд╣реЛрдВред
* рдкреНрд░рддреНрдпреЗрдХ рдорд╛рдЗрдХреНрд░реЛ-рд╕рд░реНрд╡рд┐рд╕ рдХреЗ рд▓рд┐рдП **рдЕрд▓рдЧ рдХрдВрдЯреЗрдирд░ рд░рдЦреЗрдВ**
* **рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ ssh рди рд░рдЦреЗрдВ**, "docker exec" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдВрдЯреЗрдирд░ рдореЗрдВ ssh рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдЫреЛрдЯреЗ** рдХрдВрдЯреЗрдирд░ **рдЫрд╡рд┐рдпрд╛рдБ** рд░рдЦреЗрдВ

## Docker рдмреНрд░реЗрдХрдЖрдЙрдЯ / рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐

рдпрджрд┐ рдЖрдк **Docker рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ** рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ **Docker рд╕рдореВрд╣ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ, рддреЛ рдЖрдк **рднрд╛рдЧрдиреЗ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="docker-breakout-privilege-escalation/" %}
[docker-breakout-privilege-escalation](docker-breakout-privilege-escalation/)
{% endcontent-ref %}

## Docker рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд▓рдЧрдЗрди рдмрд╛рдпрдкрд╛рд╕

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Docker рд╕реЙрдХреЗрдЯ рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ **Docker рд╕рдореВрд╣ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ рд▓реЗрдХрд┐рди рдЖрдкрдХреА рдХреНрд░рд┐рдпрд╛рдПрдБ рдПрдХ Docker рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд▓рдЧрдЗрди рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реИрдВ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЗрд╕реЗ **рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

{% content-ref url="authz-and-authn-docker-access-authorization-plugin.md" %}
[authz-and-authn-docker-access-authorization-plugin.md](authz-and-authn-docker-access-authorization-plugin.md)
{% endcontent-ref %}

## Docker рдХреЛ рдордЬрдмреВрдд рдХрд░рдирд╛

* рдЙрдкрдХрд░рдг [**docker-bench-security**](https://github.com/docker/docker-bench-security) рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ рдЬреЛ рдЙрддреНрдкрд╛рджрди рдореЗрдВ Docker рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рд╕рд╛рдорд╛рдиреНрдп рд╕рд░реНрд╡реЛрддреНрддрдо рдкреНрд░рдерд╛рдУрдВ рдХреА рджрд░реНрдЬрдиреЛрдВ рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред рдкрд░реАрдХреНрд╖рдг рд╕рднреА рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ [CIS Docker Benchmark v1.3.1](https://www.cisecurity.org/benchmark/docker/) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдкрдХреЛ рдЗрд╕реЗ Docker рдЪрд▓рд╛ рд░рд╣реЗ рд╣реЛрд╕реНрдЯ рд╕реЗ рдпрд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡рд╛рд▓реЗ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реЛрдЧрд╛ред рдЬрд╛рдиреЗрдВ **README рдореЗрдВ рдЗрд╕реЗ рдХреИрд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реИ:** [**https://github.com/docker/docker-bench-security**](https://github.com/docker/docker-bench-security).

## рд╕рдВрджрд░реНрдн

* [https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/](https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/)
* [https://twitter.com/_fel1x/status/1151487051986087936](https://twitter.com/_fel1x/status/1151487051986087936)
* [https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html](https://ajxchapman.github.io/containers/2020/11/19/privileged-container-escape.html)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-1overview/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-1overview/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-2docker-engine/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-2docker-engine/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-3engine-access/)
* [https://sreeninet.wordpress.com/2016/03/06/docker-security-part-4container-image/](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-4container-image/)
* [https://en.wikipedia.org/wiki/Linux_namespaces](https://en.wikipedia.org/wiki/Linux_namespaces)
* [https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57](https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57)
* [https://www.redhat.com/sysadmin/privileged-flag-container-engines](https://www.redhat.com/sysadmin/privileged-flag-container-engines)
* [https://docs.docker.com/engine/extend/plugins_authorization](https://docs.docker.com/engine/extend/plugins_authorization)
* [https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57](https://towardsdatascience.com/top-20-docker-security-tips-81c41dd06f57)
* [https://resources.experfy.com/bigdata-cloud/top-20-docker-security-tips/](https://resources.experfy.com/bigdata-cloud/top-20-docker-security-tips/)

<figure><img src="../../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=docker-security) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХреЗрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=docker-security" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рдЬрд╛рдВрдЪреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)**ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ PR рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
