{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
{% endhint %}
{% endhint %}


# Περίληψη

Τι μπορείτε να κάνετε αν ανακαλύψετε μέσα στο `/etc/ssh_config` ή μέσα στο `$HOME/.ssh/config` αυτή τη ρύθμιση:
```
ForwardAgent yes
```
Αν είστε root μέσα στη μηχανή, μπορείτε πιθανώς **να έχετε πρόσβαση σε οποιαδήποτε ssh σύνδεση έχει γίνει από οποιονδήποτε agent** που μπορείτε να βρείτε στον _/tmp_ φάκελο

Προσωποποιήστε τον Bob χρησιμοποιώντας έναν από τους ssh-agent του Bob:
```bash
SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston
```
## Γιατί λειτουργεί αυτό;

Όταν ορίζετε τη μεταβλητή `SSH_AUTH_SOCK`, έχετε πρόσβαση στα κλειδιά του Bob που έχουν χρησιμοποιηθεί στη σύνδεση ssh του Bob. Στη συνέχεια, αν το ιδιωτικό του κλειδί είναι ακόμα εκεί (κανονικά θα είναι), θα μπορείτε να έχετε πρόσβαση σε οποιονδήποτε host χρησιμοποιώντας το.

Καθώς το ιδιωτικό κλειδί αποθηκεύεται στη μνήμη του agent χωρίς κρυπτογράφηση, υποθέτω ότι αν είστε ο Bob αλλά δεν γνωρίζετε τον κωδικό πρόσβασης του ιδιωτικού κλειδιού, μπορείτε ακόμα να έχετε πρόσβαση στον agent και να το χρησιμοποιήσετε.

Μια άλλη επιλογή είναι ότι ο χρήστης που είναι ο ιδιοκτήτης του agent και ο root μπορεί να έχει πρόσβαση στη μνήμη του agent και να εξάγει το ιδιωτικό κλειδί.

# Μακροχρόνια εξήγηση και εκμετάλλευση

**Δείτε την [αρχική έρευνα εδώ](https://www.clockwork.com/insights/ssh-agent-hijacking/)**
{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
</details>
{% endhint %}
</details>
{% endhint %}
